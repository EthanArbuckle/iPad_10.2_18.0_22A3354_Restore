@implementation DisplaySetProperty

void __DisplaySetProperty_block_invoke(uint64_t a1)
{
  int v1;
  int v2;
  NSObject *v3;
  const char *v4;
  int v5;
  int v6;
  const char *v7;
  double v8;
  float v9;
  const char *v10;
  float v11;
  float v12;
  float v13;
  NSObject *v14;
  const char *v15;
  int v16;
  int v17;
  double v18;
  double v19;
  double v20;
  const __CFString *v21;
  float v22;
  const char *v23;
  float v24;
  float v25;
  int v26;
  int v27;
  int v28;
  int v29;
  float v30;
  float v31;
  int v32;
  int v33;
  int v34;
  double v35;
  uint64_t v36;
  NSObject *v37;
  CFTypeID v38;
  _BYTE *v39;
  CFTypeID v40;
  CFTypeID v41;
  CFTypeID v42;
  CFTypeID v43;
  uint64_t v44;
  NSObject *v45;
  CFTypeID v46;
  uint64_t v47;
  NSObject *v48;
  CFTypeID v49;
  CFTypeID v50;
  CFTypeID v51;
  NSObject *v52;
  os_log_type_t v53;
  uint64_t v54;
  NSObject *v55;
  uint64_t v56;
  NSObject *v57;
  const __CFAllocator *v58;
  uint64_t v59;
  NSObject *v60;
  CFTypeID v61;
  uint64_t v62;
  NSObject *v63;
  CFTypeID v64;
  CFTypeID v65;
  CFTypeID v66;
  CFTypeID v67;
  CFTypeID v68;
  CFTypeID v69;
  CFTypeID v70;
  uint64_t v71;
  NSObject *v72;
  uint64_t v73;
  NSObject *v74;
  uint64_t v75;
  NSObject *v76;
  CFIndex v77;
  CFTypeID v78;
  CFTypeID v79;
  CFTypeID v80;
  CFTypeID v81;
  CFTypeID v82;
  CFTypeID v83;
  CFTypeID v84;
  CFTypeID v85;
  CFTypeID v86;
  NSObject *v87;
  os_log_type_t v88;
  uint64_t v89;
  NSObject *v90;
  int v91;
  float v92;
  int v93;
  float v94;
  CFTypeID v95;
  CFTypeID v96;
  CFTypeID v97;
  CFTypeID v98;
  void *v99;
  int v100;
  CFTypeID v101;
  CFTypeID v102;
  uint64_t v103;
  NSObject *v104;
  CFTypeID v105;
  CFTypeID v106;
  uint64_t v107;
  NSObject *v108;
  CFTypeID v109;
  uint64_t v110;
  NSObject *v111;
  CFTypeID v112;
  const __CFAllocator *v113;
  uint64_t v114;
  NSObject *v115;
  CFTypeID v116;
  CFTypeID v117;
  CFTypeID v118;
  const __CFAllocator *allocator;
  uint64_t v120;
  NSObject *v121;
  uint64_t v122;
  NSObject *v123;
  CFTypeID v124;
  uint64_t v125;
  NSObject *v126;
  CFTypeID v127;
  uint64_t v128;
  NSObject *v129;
  CFTypeID v130;
  uint64_t v131;
  NSObject *v132;
  CFTypeID v133;
  uint64_t v134;
  NSObject *v135;
  CFTypeID v136;
  uint64_t v137;
  NSObject *v138;
  CFTypeID v139;
  uint64_t v140;
  NSObject *v141;
  CFTypeID v142;
  uint64_t v143;
  NSObject *v144;
  CFTypeID v145;
  uint64_t v146;
  NSObject *v147;
  CFTypeID v148;
  uint64_t v149;
  NSObject *v150;
  CFTypeID v151;
  uint64_t v152;
  NSObject *v153;
  CFTypeID v154;
  uint64_t v155;
  NSObject *v156;
  CFTypeID v157;
  uint64_t v158;
  NSObject *v159;
  CFTypeID v160;
  CFTypeID v161;
  CFTypeID v162;
  uint64_t v163;
  NSObject *v164;
  CFTypeID v165;
  uint64_t v166;
  NSObject *v167;
  CFTypeID v168;
  uint64_t v169;
  NSObject *v170;
  CFTypeID v171;
  uint64_t v172;
  NSObject *v173;
  CFTypeID v174;
  uint64_t v175;
  NSObject *v176;
  uint64_t v177;
  float v178;
  CFTypeID v179;
  uint64_t v180;
  NSObject *v181;
  uint64_t v182;
  float v183;
  CFTypeID v184;
  CFTypeID v185;
  CFTypeID v186;
  CFTypeID v187;
  CFTypeID v188;
  CFTypeID v189;
  uint64_t v190;
  NSObject *v191;
  uint64_t v192;
  NSObject *v193;
  uint64_t v194;
  float v195;
  CFTypeID v196;
  float v197;
  uint64_t v198;
  NSObject *v199;
  CFTypeID v200;
  CFTypeID v201;
  NSObject *v202;
  os_log_type_t v203;
  uint64_t v204;
  NSObject *v205;
  float v206;
  double v207;
  int v208;
  CFTypeID v209;
  CFTypeID v210;
  CFTypeID v211;
  uint64_t v212;
  NSObject *v213;
  CFTypeID v214;
  uint64_t v215;
  NSObject *v216;
  CFTypeID v217;
  uint64_t v218;
  NSObject *v219;
  uint64_t v220;
  NSObject *v221;
  CFTypeID v222;
  CFTypeID v223;
  CFTypeID v224;
  CFTypeID v225;
  uint64_t v226;
  NSObject *v227;
  __CFDictionary *theDict;
  NSObject *v229;
  os_log_type_t v230;
  uint64_t v231;
  NSObject *v232;
  char CFBooleanValue;
  NSObject *v234;
  os_log_type_t v235;
  uint64_t v236;
  NSObject *v237;
  uint64_t v238;
  NSObject *v239;
  float v240;
  uint64_t v241;
  NSObject *v242;
  CFTypeID v243;
  CFTypeID v244;
  CFTypeID v245;
  uint64_t v246;
  NSObject *v247;
  CFTypeID v248;
  CFTypeID v249;
  uint64_t v250;
  NSObject *v251;
  CFTypeID v252;
  uint64_t v253;
  NSObject *v254;
  CFTypeID v255;
  CFTypeID v256;
  uint64_t v257;
  NSObject *v258;
  CFTypeID v259;
  uint64_t v260;
  NSObject *v261;
  CFTypeID v262;
  CFTypeID v263;
  CFTypeID v264;
  uint64_t v265;
  NSObject *v266;
  CFTypeID v267;
  uint64_t v268;
  NSObject *v269;
  uint64_t v270;
  NSObject *v271;
  CFTypeID v272;
  CFTypeID v273;
  CFTypeID v274;
  uint64_t inited;
  NSObject *v276;
  CFTypeID TypeID;
  float v279;
  uint64_t v280;
  uint64_t v281;
  id v282;
  id v283;
  id v284;
  id v285;
  float v286;
  os_log_type_t v287;
  os_log_t v288;
  os_log_type_t v289;
  os_log_t oslog;
  id v291;
  id v292;
  id v293;
  id v294;
  uint8_t v295[7];
  os_log_type_t v296;
  NSObject *v297;
  os_log_type_t v298;
  os_log_t v299;
  int v300;
  int v301;
  float v302;
  float v303;
  id v304;
  id v305;
  id v306;
  CFNumberRef v307;
  int v308;
  os_log_type_t v309;
  os_log_t v310;
  float v311;
  os_log_type_t v312;
  os_log_t v313;
  float v314;
  float GlobalScalarFromDictionary;
  int v316;
  int v317;
  float v318;
  CFNumberRef v319;
  __CFDictionary *Mutable;
  os_log_type_t v321;
  os_log_t v322;
  os_log_type_t v323;
  os_log_t v324;
  CFBooleanRef v325;
  BOOL v326;
  float v327;
  _BOOL4 v328;
  os_log_type_t v329;
  os_log_t v330;
  CFTypeRef v331;
  CFIndex j;
  char v333;
  CFIndex i;
  const void *ValueAtIndex;
  CFIndex v336;
  CFArrayRef v337;
  uint64_t v338;
  CFIndex Count;
  int v340;
  BOOL v341;
  const __CFNumber *v342;
  int v343;
  int v344;
  char v345;
  BOOL v346;
  uint8_t v347[15];
  char v348;
  NSObject *v349;
  int v350;
  float v351;
  float v352;
  CFNumberRef v353;
  int v354;
  float v355;
  int v356;
  float v357;
  CFNumberRef v358;
  int v359;
  CFNumberRef v360;
  int v361;
  float v362;
  char v363;
  char v364;
  CFTypeRef v365;
  CFDictionaryRef v366;
  id v367;
  id v368;
  id v369;
  int v370;
  int v371;
  os_log_type_t v372;
  os_log_t v373;
  CFTypeRef v374;
  os_log_type_t v375;
  os_log_t v376;
  float v377;
  float v378;
  float v379;
  os_log_type_t v380;
  os_log_t v381;
  float v382;
  CFDictionaryRef v383;
  float v384;
  os_log_type_t v385;
  os_log_t v386;
  CFTypeRef v387;
  float v388;
  CFTypeRef v389;
  BOOL v390;
  float v391;
  CFNumberRef v392;
  uint64_t v393;
  int v394;
  int v395;
  void (*v396)(uint64_t);
  void *v397;
  uint64_t v398;
  CFDictionaryRef v399;
  CFDictionaryRef v400;
  os_log_type_t v401;
  os_log_t v402;
  int v403;
  float v404;
  os_log_type_t v405;
  os_log_t v406;
  float v407;
  os_log_type_t v408;
  os_log_t v409;
  float v410;
  os_log_type_t v411;
  os_log_t v412;
  float v413;
  os_log_type_t v414;
  os_log_t v415;
  float v416;
  os_log_type_t v417;
  os_log_t v418;
  float v419;
  os_log_type_t v420;
  os_log_t v421;
  BOOL v422;
  uint64_t v423;
  os_log_type_t v424;
  os_log_t v425;
  BOOL v426;
  uint64_t v427;
  os_log_type_t v428;
  os_log_t v429;
  float v430;
  uint64_t v431;
  os_log_type_t v432;
  os_log_t v433;
  float v434;
  uint64_t v435;
  os_log_type_t v436;
  os_log_t v437;
  float v438;
  os_log_type_t v439;
  os_log_t v440;
  float v441;
  os_log_type_t v442;
  os_log_t v443;
  float v444;
  os_log_type_t v445;
  os_log_t v446;
  float v447;
  float v448;
  int v449;
  os_log_type_t v450;
  os_log_t v451;
  float v452;
  os_log_type_t v453;
  os_log_t v454;
  int v455;
  _BOOL4 v456;
  os_log_type_t v457;
  os_log_t v458;
  int v459;
  os_log_type_t v460;
  os_log_t v461;
  os_log_type_t v462;
  os_log_t v463;
  BOOL v464;
  os_log_type_t v465;
  os_log_t v466;
  BOOL v467;
  const __CFNumber *v468;
  const __CFNumber *v469;
  const __CFNumber *v470;
  const __CFNumber *v471;
  float v472;
  float v473;
  os_log_type_t v474;
  os_log_t v475;
  os_log_type_t v476;
  os_log_t v477;
  float v478;
  float v479;
  int v480;
  float v481;
  os_log_type_t v482;
  os_log_t v483;
  int v484;
  double v485;
  os_log_type_t v486;
  os_log_t v487;
  uint8_t v488[7];
  char v489;
  NSObject *v490;
  float v491;
  float v492;
  int v493;
  os_log_type_t v494;
  os_log_t v495;
  os_log_type_t v496;
  os_log_t v497;
  os_log_type_t v498;
  os_log_t v499;
  os_log_type_t v500;
  os_log_t v501;
  unsigned int v502;
  const __CFNumber *v503;
  int v504;
  const __CFNumber *v505;
  const __CFBoolean *v506;
  Boolean v507;
  float v508;
  os_log_type_t v509;
  os_log_t v510;
  float v511;
  uint8_t v512[15];
  char v513;
  NSObject *v514;
  uint8_t v516[7];
  os_log_type_t v517;
  NSObject *v518;
  os_log_type_t v519;
  os_log_t v520;
  float v521;
  float v522;
  os_log_type_t v523;
  os_log_t v524;
  const __CFNumber *v525;
  float v526;
  const __CFNumber *v527;
  int v528;
  os_log_type_t v529;
  os_log_t v530;
  const void *v531;
  CFTypeRef v532;
  os_log_type_t v533;
  os_log_t v534;
  os_log_type_t v535;
  os_log_t v536;
  int v537;
  CFNumberRef v538;
  uint64_t v539;
  int v540;
  int v541;
  uint64_t (*v542)(_QWORD *);
  void *v543;
  uint64_t *v544;
  _QWORD *v545;
  uint64_t v546;
  _QWORD v547[2];
  int v548;
  int v549;
  uint64_t v550;
  uint64_t v551;
  uint64_t *v552;
  int v553;
  int v554;
  uint64_t v555;
  _BOOL4 v556;
  os_log_type_t v557;
  os_log_t v558;
  os_log_type_t v559;
  os_log_t v560;
  float v561;
  float v562;
  CFTypeRef v563;
  const void *v564;
  CFTypeRef v565;
  os_log_type_t v566;
  os_log_t v567;
  os_log_type_t v568;
  os_log_t v569;
  float v570;
  float v571;
  float v572;
  float v573;
  int v574;
  os_log_type_t v575;
  os_log_t v576;
  float v577;
  _DWORD v578[3];
  float v579;
  CFTypeRef v580;
  const void *v581;
  CFTypeRef Value;
  float v583;
  _DWORD v584[3];
  os_log_type_t v585;
  os_log_t v586;
  float v587;
  uint64_t v588;
  uint64_t v589;
  uint8_t v590[32];
  uint8_t v591[32];
  uint8_t v592[32];
  uint8_t v593[16];
  uint8_t v594[16];
  uint8_t v595[16];
  uint8_t v596[16];
  uint8_t v597[32];
  __int128 v598;
  int v599;
  __int128 v600;
  int v601;
  __int128 v602;
  int v603;
  __int128 v604;
  int v605;
  uint8_t v606[16];
  uint8_t v607[32];
  uint8_t v608[32];
  uint8_t v609[16];
  CFNumberRef v610;
  CFNumberRef v611;
  __int128 v612;
  uint8_t v613[32];
  CFNumberRef v614;
  __CFString *v615;
  uint8_t v616[16];
  uint8_t v617[16];
  uint8_t v618[32];
  uint8_t v619[32];
  uint8_t v620[32];
  uint8_t v621[32];
  uint8_t v622[32];
  uint8_t v623[32];
  uint8_t v624[32];
  uint8_t v625[32];
  uint8_t v626[32];
  uint8_t v627[32];
  uint8_t v628[32];
  uint8_t v629[32];
  uint8_t v630[16];
  uint8_t v631[16];
  uint8_t v632[32];
  uint8_t v633[32];
  uint8_t v634[32];
  uint8_t v635[32];
  uint8_t v636[32];
  uint8_t v637[48];
  uint8_t v638[16];
  uint8_t v639[16];
  uint8_t v640[32];
  uint8_t v641[32];
  uint8_t v642[16];
  uint8_t v643[64];
  uint8_t v644[32];
  uint8_t v645[32];
  uint8_t v646[32];
  uint8_t v647[32];
  uint8_t v648[32];
  uint8_t v649[16];
  uint8_t v650[32];
  uint8_t v651[32];
  uint8_t v652[32];
  uint8_t v653[48];
  uint8_t v654[32];
  uint8_t v655[24];
  uint64_t v656;

  v656 = *MEMORY[0x1E0C80C00];
  v589 = a1;
  v588 = a1;
  v587 = 0.0;
  if (*(_QWORD *)(a1 + 40) && CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightness")))
  {
    TypeID = CFNumberGetTypeID();
    if (TypeID == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v587 = *(float *)(*(_QWORD *)(a1 + 56) + 336);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
      v586 = 0;
      if (_logHandle)
      {
        v276 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          inited = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          inited = init_default_corebrightness_log();
        v276 = inited;
      }
      v586 = v276;
      v585 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v276, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v655, (uint64_t)"DisplayBrightness", COERCE__INT64(v587));
        _os_log_debug_impl(&dword_1B5291000, v586, v585, "DisplaySetProperty: %s = %f\n", v655, 0x16u);
      }
      v584[0] = 1;
      *(float *)&v584[1] = v587;
      __DisplayUpdateAAPStateInternal(*(_QWORD *)(a1 + 56), (uint64_t)v584, 1);
      v583 = 0.0;
      v583 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), v587);
      if (v583 > *(float *)(*(_QWORD *)(a1 + 56) + 528))
        _DisplaySetBrightnessWeakCapWithFade(*(_BYTE **)(a1 + 56), 0, v583, 0.0);
      __DisplaySetBrightnessWithFade(*(_QWORD *)(a1 + 56), 12296, v587, 0.0);
    }
    else
    {
      v274 = CFDictionaryGetTypeID();
      if (v274 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        Value = 0;
        Value = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("Brightness"));
        v581 = 0;
        v581 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("Commit"));
        v580 = 0;
        v580 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("Period"));
        if (Value)
        {
          v273 = CFGetTypeID(Value);
          if (v273 == CFNumberGetTypeID())
          {
            v579 = 0.0;
            v579 = *(float *)(*(_QWORD *)(a1 + 56) + 276);
            if (v580)
            {
              v272 = CFGetTypeID(v580);
              if (v272 == CFNumberGetTypeID())
              {
                if (CFNumberIsFloatType((CFNumberRef)v580))
                  CFNumberGetValue((CFNumberRef)v580, kCFNumberFloat32Type, &v579);
              }
            }
            v587 = *(float *)(*(_QWORD *)(a1 + 56) + 336);
            CFNumberGetValue((CFNumberRef)Value, kCFNumberFloatType, &v587);
            v578[0] = 1;
            *(float *)&v578[1] = v587;
            __DisplayUpdateAAPStateInternal(*(_QWORD *)(a1 + 56), (uint64_t)v578, v581 == (const void *)*MEMORY[0x1E0C9AE50]);
            v577 = 0.0;
            v577 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), v587);
            if (v577 > *(float *)(*(_QWORD *)(a1 + 56) + 528))
              _DisplaySetBrightnessWeakCapWithFade(*(_BYTE **)(a1 + 56), 0, v577, v579);
            v576 = 0;
            if (_logHandle)
            {
              v271 = _logHandle;
            }
            else
            {
              if (_COREBRIGHTNESS_LOG_DEFAULT)
                v270 = _COREBRIGHTNESS_LOG_DEFAULT;
              else
                v270 = init_default_corebrightness_log();
              v271 = v270;
            }
            v576 = v271;
            v575 = OS_LOG_TYPE_DEBUG;
            if (os_log_type_enabled(v271, OS_LOG_TYPE_DEBUG))
            {
              __os_log_helper_16_2_3_8_32_8_0_8_0((uint64_t)v654, (uint64_t)"DisplayBrightness", COERCE__INT64(v587), COERCE__INT64(v577));
              _os_log_debug_impl(&dword_1B5291000, v576, v575, "DisplaySetProperty: %s = %f (nits=%f)\n", v654, 0x20u);
            }
            if (v581 == (const void *)*MEMORY[0x1E0C9AE50])
              __DisplayReportCommit(*(NSObject ***)(a1 + 56), v587);
            v574 = 0;
            if (v581 == (const void *)*MEMORY[0x1E0C9AE50])
              v1 = 12296;
            else
              v1 = 8200;
            v574 = v1;
            if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 323) & 1) != 0)
            {
              v573 = v579;
              v572 = 0.0;
              v572 = _DisplayLuminanceToPerceptualLuminanceInternal(*(_QWORD *)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 1256));
              v571 = 0.0;
              v571 = _DisplayLuminanceToPerceptualLuminanceInternal(*(_QWORD *)(a1 + 56), v577);
              v570 = v571 - v572;
              if ((float)(v571 - v572) < 0.0 && v573 <= 0.0)
                v573 = 0.4;
              if (v573 <= 0.0)
              {
                *(float *)(*(_QWORD *)(a1 + 56) + 280) = -1.0;
              }
              else
              {
                v570 = fminf(fmaxf(fabsf(v570), 0.0), 1.0);
                *(float *)(*(_QWORD *)(a1 + 56) + 280) = v587;
                v574 |= 0x80u;
                v579 = v573 * v570;
              }
            }
            __DisplaySetBrightnessWithFade(*(_QWORD *)(a1 + 56), v574, v587, v579);
            if (v581 == (const void *)*MEMORY[0x1E0C9AE50])
            {
              v569 = 0;
              if (_logHandle)
              {
                v269 = _logHandle;
              }
              else
              {
                v268 = _COREBRIGHTNESS_LOG_DEFAULT ? _COREBRIGHTNESS_LOG_DEFAULT : init_default_corebrightness_log();
                v269 = v268;
              }
              v569 = v269;
              v568 = OS_LOG_TYPE_DEFAULT;
              if (os_log_type_enabled(v269, OS_LOG_TYPE_DEFAULT))
              {
                __os_log_helper_16_2_5_8_32_8_0_8_0_8_0_4_0((uint64_t)v653, (uint64_t)"User change", COERCE__INT64(v587), COERCE__INT64(v577), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 1260)), v581 == (const void *)*MEMORY[0x1E0C9AE50]);
                _os_log_impl(&dword_1B5291000, v569, v568, "[BRT update: %s]: slider value = %f, nits = %f, nits physical = %f, commit = %d", v653, 0x30u);
              }
            }
          }
        }
      }
    }
    *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
  }
  else if (*(_QWORD *)(a1 + 40) && CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayNitsKey")))
  {
    v267 = CFNumberGetTypeID();
    if (v267 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v587 = *(float *)(*(_QWORD *)(a1 + 56) + 1256);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
      v567 = 0;
      if (_logHandle)
      {
        v266 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v265 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v265 = init_default_corebrightness_log();
        v266 = v265;
      }
      v567 = v266;
      v566 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v266, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v652, (uint64_t)"DisplayNitsKey", COERCE__INT64(v587));
        _os_log_debug_impl(&dword_1B5291000, v567, v566, "DisplaySetProperty: %s = %f\n", v652, 0x16u);
      }
      _DisplaySetLogicalBrightnessWithFade(*(_QWORD *)(a1 + 56), 12296, 0, 0, v587, 0.0);
    }
    else
    {
      v264 = CFDictionaryGetTypeID();
      if (v264 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v565 = 0;
        v565 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("Brightness"));
        v564 = 0;
        v564 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("Commit"));
        v563 = 0;
        v563 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("Period"));
        if (v565)
        {
          v263 = CFGetTypeID(v565);
          if (v263 == CFNumberGetTypeID())
          {
            v562 = 0.0;
            v562 = *(float *)(*(_QWORD *)(a1 + 56) + 276);
            if (v563)
            {
              v262 = CFGetTypeID(v563);
              if (v262 == CFNumberGetTypeID())
              {
                if (CFNumberIsFloatType((CFNumberRef)v563))
                  CFNumberGetValue((CFNumberRef)v563, kCFNumberFloat32Type, &v562);
              }
            }
            v587 = *(float *)(*(_QWORD *)(a1 + 56) + 1256);
            CFNumberGetValue((CFNumberRef)v565, kCFNumberFloatType, &v587);
            if (v564 == (const void *)*MEMORY[0x1E0C9AE50])
            {
              v561 = 0.0;
              v561 = _DisplayLogicalToSliderBrightnessInternal(*(_QWORD *)(a1 + 56), v587);
              __DisplayReportCommit(*(NSObject ***)(a1 + 56), v561);
            }
            v560 = 0;
            if (_logHandle)
            {
              v261 = _logHandle;
            }
            else
            {
              if (_COREBRIGHTNESS_LOG_DEFAULT)
                v260 = _COREBRIGHTNESS_LOG_DEFAULT;
              else
                v260 = init_default_corebrightness_log();
              v261 = v260;
            }
            v560 = v261;
            v559 = OS_LOG_TYPE_DEBUG;
            if (os_log_type_enabled(v261, OS_LOG_TYPE_DEBUG))
            {
              __os_log_helper_16_2_2_8_32_8_0((uint64_t)v651, (uint64_t)"DisplayNitsKey", COERCE__INT64(v587));
              _os_log_debug_impl(&dword_1B5291000, v560, v559, "DisplaySetProperty: %s = %f\n", v651, 0x16u);
            }
            if (v564 == (const void *)*MEMORY[0x1E0C9AE50])
              v2 = 12296;
            else
              v2 = 8200;
            _DisplaySetLogicalBrightnessWithFade(*(_QWORD *)(a1 + 56), v2, 0, 0, v587, v562);
          }
        }
      }
    }
    *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("kIOHIDDisplaySliderMovementFadePeriodKey")))
  {
    v259 = CFNumberGetTypeID();
    if (v259 == CFGetTypeID(*(CFTypeRef *)(a1 + 40))
      && CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587))
    {
      *(float *)(*(_QWORD *)(a1 + 56) + 276) = v587;
      v558 = 0;
      if (_logHandle)
      {
        v258 = _logHandle;
      }
      else
      {
        v257 = _COREBRIGHTNESS_LOG_DEFAULT ? _COREBRIGHTNESS_LOG_DEFAULT : init_default_corebrightness_log();
        v258 = v257;
      }
      v558 = v258;
      v557 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v258, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v650, (uint64_t)"kIOHIDDisplaySliderMovementFadePeriodKey", COERCE__INT64(v587));
        _os_log_debug_impl(&dword_1B5291000, v558, v557, "DisplaySetProperty: %s = %f\n", v650, 0x16u);
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CPMSToggleHDRCap")))
  {
    v256 = CFBooleanGetTypeID();
    if (v256 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v556 = 0;
      v556 = *(_QWORD *)(a1 + 40) == *MEMORY[0x1E0C9AE50];
      if (v556)
      {
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 12081) = 0;
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 12082) = 0;
        __DisplayStartAPLCPMSTimer(*(dispatch_object_t **)(a1 + 56), 1.0);
      }
      else if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12112))
      {
        __DisplayProcessHDRStatusForCoreAnalytics(*(_QWORD *)(a1 + 56));
        dispatch_release(*(dispatch_object_t *)(*(_QWORD *)(a1 + 56) + 12112));
        *(_QWORD *)(*(_QWORD *)(a1 + 56) + 12112) = 0;
        *(_QWORD *)(*(_QWORD *)(a1 + 56) + 12088) = 0;
        *(_QWORD *)(*(_QWORD *)(a1 + 56) + 12096) = 0;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CPMSPowerAccumulator")))
  {
    v551 = 0;
    v552 = &v551;
    v553 = 0x20000000;
    v554 = 32;
    v555 = 0;
    if ((DisplayHasDCP(*(_QWORD *)(a1 + 56)) & 1) != 0)
    {
      v547[0] = 0;
      v547[1] = v547;
      v548 = 0x20000000;
      v549 = 32;
      v550 = 0;
      v3 = *(NSObject **)(*(_QWORD *)(a1 + 56) + 152);
      v539 = MEMORY[0x1E0C809B0];
      v540 = -1073741824;
      v541 = 0;
      v542 = __DisplaySetProperty_block_invoke_319;
      v543 = &unk_1E68EB500;
      v544 = &v551;
      v546 = *(_QWORD *)(a1 + 56);
      v545 = v547;
      dispatch_sync(v3, &v539);
      _Block_object_dispose(v547, 8);
    }
    else
    {
      v552[3] = __DisplayGetPowerAccumulator(*(_QWORD *)(a1 + 56));
    }
    v538 = 0;
    v538 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberLongLongType, v552 + 3);
    if (v538)
    {
      CFDictionarySetValue(*(CFMutableDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), CFSTR("CPMSPowerAccumulatorValue"), v538);
      CFRelease(v538);
    }
    _Block_object_dispose(&v551, 8);
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CoreBrightnessBDMEnabled")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v255 = CFNumberGetTypeID();
      if (v255 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v537 = 0;
        v537 = *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1176) & 1;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v537);
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1176) = v537 != 0;
        v536 = 0;
        if (_logHandle)
        {
          v254 = _logHandle;
        }
        else
        {
          v253 = _COREBRIGHTNESS_LOG_DEFAULT ? _COREBRIGHTNESS_LOG_DEFAULT : init_default_corebrightness_log();
          v254 = v253;
        }
        v536 = v254;
        v535 = OS_LOG_TYPE_DEBUG;
        if (os_log_type_enabled(v254, OS_LOG_TYPE_DEBUG))
        {
          if (v537)
            v4 = "enabled";
          else
            v4 = "disabled";
          __os_log_helper_16_2_1_8_32((uint64_t)v649, (uint64_t)v4);
          _os_log_debug_impl(&dword_1B5291000, v536, v535, "BrightDotMitigation %s", v649, 0xCu);
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayInitialBrightness")))
  {
    v252 = CFNumberGetTypeID();
    if (v252 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v587 = *(float *)(*(_QWORD *)(a1 + 56) + 336);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
      v534 = 0;
      if (_logHandle)
      {
        v251 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v250 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v250 = init_default_corebrightness_log();
        v251 = v250;
      }
      v534 = v251;
      v533 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v251, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v648, (uint64_t)"DisplayInitialBrightness", COERCE__INT64(v587));
        _os_log_debug_impl(&dword_1B5291000, v534, v533, "DisplaySetProperty: %s = %f\n", v648, 0x16u);
      }
      if (*(float *)(*(_QWORD *)(a1 + 56) + 348) == 0.0)
      {
        _DisplaySetBrightness(*(_QWORD *)(a1 + 56), v587);
      }
      else if (*(double *)(*(_QWORD *)(a1 + 56) + 1384) != 0.0 && *(float *)(*(_QWORD *)(a1 + 56) + 1400) == 0.0)
      {
        *(float *)(*(_QWORD *)(a1 + 56) + 12496) = v587;
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12500) = 4096;
      }
    }
    else
    {
      v249 = CFDictionaryGetTypeID();
      if (v249 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v532 = 0;
        v532 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("Brightness"));
        v531 = 0;
        v531 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("Commit"));
        if (v532)
        {
          v248 = CFGetTypeID(v532);
          if (v248 == CFNumberGetTypeID())
          {
            v587 = *(float *)(*(_QWORD *)(a1 + 56) + 336);
            CFNumberGetValue((CFNumberRef)v532, kCFNumberFloatType, &v587);
            v530 = 0;
            if (_logHandle)
            {
              v247 = _logHandle;
            }
            else
            {
              if (_COREBRIGHTNESS_LOG_DEFAULT)
                v246 = _COREBRIGHTNESS_LOG_DEFAULT;
              else
                v246 = init_default_corebrightness_log();
              v247 = v246;
            }
            v530 = v247;
            v529 = OS_LOG_TYPE_DEBUG;
            if (os_log_type_enabled(v247, OS_LOG_TYPE_DEBUG))
            {
              __os_log_helper_16_2_2_8_32_8_0((uint64_t)v647, (uint64_t)"DisplayInitialBrightness", COERCE__INT64(v587));
              _os_log_debug_impl(&dword_1B5291000, v530, v529, "DisplaySetProperty: %s = %f\n", v647, 0x16u);
            }
            if (*(float *)(*(_QWORD *)(a1 + 56) + 348) == 0.0)
            {
              if (v531 == (const void *)*MEMORY[0x1E0C9AE50])
                v5 = 4096;
              else
                v5 = 0;
              __DisplaySetBrightness(*(_QWORD *)(a1 + 56), v5, v587);
            }
            else if (*(double *)(*(_QWORD *)(a1 + 56) + 1384) != 0.0
                   && *(float *)(*(_QWORD *)(a1 + 56) + 1400) == 0.0)
            {
              *(float *)(*(_QWORD *)(a1 + 56) + 12496) = v587;
              if (v531 == (const void *)*MEMORY[0x1E0C9AE50])
                v6 = 4096;
              else
                v6 = 0;
              *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12500) = v6;
            }
          }
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AmbientAdaptiveDimming")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v245 = CFDictionaryGetTypeID();
      if (v245 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v528 = 0;
        v527 = 0;
        v527 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("AmbientAdaptiveDimmingEnable"));
        if (v527)
        {
          v244 = CFNumberGetTypeID();
          if (v244 == CFGetTypeID(v527))
            CFNumberGetValue(v527, kCFNumberIntType, &v528);
        }
        v526 = 0.0;
        v525 = 0;
        v525 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("AmbientAdaptiveDimmingPeriod"));
        if (v525)
        {
          v243 = CFNumberGetTypeID();
          if (v243 == CFGetTypeID(v525))
            CFNumberGetValue(v525, kCFNumberFloatType, &v526);
        }
        v524 = 0;
        if (_logHandle)
        {
          v242 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v241 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v241 = init_default_corebrightness_log();
          v242 = v241;
        }
        v524 = v242;
        v523 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v242, OS_LOG_TYPE_DEFAULT))
        {
          __os_log_helper_16_0_2_4_0_8_0((uint64_t)v646, v528, COERCE__INT64(v526));
          _os_log_impl(&dword_1B5291000, v524, v523, "AutoDim request received with enable:%i, period:%f", v646, 0x12u);
        }
        if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 228) != v528)
        {
          *(_DWORD *)(*(_QWORD *)(a1 + 56) + 228) = v528;
          v522 = 0.0;
          if (v528)
            v240 = 100.0;
          else
            v240 = *(float *)(*(_QWORD *)(a1 + 56) + 1312);
          v522 = v240;
          _DisplaySetAdaptiveDimmingLimitWithFade(*(_QWORD *)(a1 + 56), v240, v526);
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("UserInteractedWithUI")))
  {
    if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
    {
      __DisplayUpdateAmbientProperties(*(_QWORD *)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 336));
      v521 = 0.0;
      v521 = __DisplayCalculateBrightnessAtAmbient(*(float **)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 1184));
      __DisplaySetLogicalBrightnessLegacy(*(float **)(a1 + 56), 2u, v521, -1.0);
      v520 = 0;
      if (_logHandle)
      {
        v239 = _logHandle;
      }
      else
      {
        v238 = _COREBRIGHTNESS_LOG_DEFAULT ? _COREBRIGHTNESS_LOG_DEFAULT : init_default_corebrightness_log();
        v239 = v238;
      }
      v520 = v239;
      v519 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v239, OS_LOG_TYPE_DEBUG))
      {
        if (*(float *)(*(_QWORD *)(a1 + 56) + 1204) == 0.0)
          v7 = "false";
        else
          v7 = "true";
        __os_log_helper_16_2_2_8_32_8_32((uint64_t)v645, (uint64_t)"UserInteractedWithUI", (uint64_t)v7);
        _os_log_debug_impl(&dword_1B5291000, v520, v519, "DisplaySetProperty: %s = %s\n", v645, 0x16u);
      }
    }
    *(_BYTE *)(*(_QWORD *)(a1 + 56) + 584) = 1;
    v518 = 0;
    if (_logHandle)
    {
      v237 = _logHandle;
    }
    else
    {
      if (_COREBRIGHTNESS_LOG_DEFAULT)
        v236 = _COREBRIGHTNESS_LOG_DEFAULT;
      else
        v236 = init_default_corebrightness_log();
      v237 = v236;
    }
    v518 = v237;
    v517 = OS_LOG_TYPE_DEFAULT;
    if (os_log_type_enabled(v237, OS_LOG_TYPE_DEFAULT))
    {
      v234 = v518;
      v235 = v517;
      __os_log_helper_16_0_0(v516);
      _os_log_impl(&dword_1B5291000, v234, v235, "Weak cap: user interacted\n", v516, 2u);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessAuto")))
  {
    CFBooleanValue = GetCFBooleanValue(*(const __CFNumber **)(a1 + 40));
    v8 = 1.0;
    if (!CFBooleanValue)
      v8 = 0.0;
    v9 = v8;
    v587 = v9;
    if (v9 == 1.0 && !(MGGetBoolAnswer() & 1))
    {
      v514 = 0;
      if (_logHandle)
      {
        v232 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v231 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v231 = init_default_corebrightness_log();
        v232 = v231;
      }
      v514 = v232;
      v513 = 16;
      if (os_log_type_enabled(v232, OS_LOG_TYPE_ERROR))
      {
        v229 = v514;
        v230 = v513;
        __os_log_helper_16_0_0(v512);
        _os_log_error_impl(&dword_1B5291000, v229, v230, "Refuse to turn on AAB without ALS", v512, 2u);
      }
      v587 = 0.0;
      *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
    }
    if (v587 != *(float *)(*(_QWORD *)(a1 + 56) + 1204))
    {
      theDict = *(__CFDictionary **)(*(_QWORD *)(a1 + 56) + 192);
      if (v587 == 0.0)
        CFDictionarySetValue(theDict, CFSTR("DisplayBrightnessAuto"), (const void *)*MEMORY[0x1E0C9AE40]);
      else
        CFDictionarySetValue(theDict, CFSTR("DisplayBrightnessAuto"), (const void *)*MEMORY[0x1E0C9AE50]);
      *(float *)(*(_QWORD *)(a1 + 56) + 1204) = v587;
      __DisplayUpdateAmbientProperties(*(_QWORD *)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 336));
      if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
      {
        v511 = 0.0;
        v511 = __DisplayCalculateBrightnessAtAmbient(*(float **)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 1184));
        __DisplaySetLogicalBrightnessLegacy(*(float **)(a1 + 56), 2u, v511, -1.0);
        v510 = 0;
        if (_logHandle)
        {
          v227 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v226 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v226 = init_default_corebrightness_log();
          v227 = v226;
        }
        v510 = v227;
        v509 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v227, OS_LOG_TYPE_DEFAULT))
        {
          if (*(float *)(*(_QWORD *)(a1 + 56) + 1204) == 0.0)
            v10 = "false";
          else
            v10 = "true";
          __os_log_helper_16_2_2_8_32_8_32((uint64_t)v644, (uint64_t)"DisplayBrightnessAuto", (uint64_t)v10);
          _os_log_impl(&dword_1B5291000, v510, v509, "DisplaySetProperty: %s = %s\n", v644, 0x16u);
        }
      }
      else
      {
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 40) = v587 < 1.0;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("kCoreBrightnessDisplayPresetNitsOverride")))
  {
    v508 = 0.0;
    objc_msgSend(*(id *)(a1 + 40), "floatValue");
    v508 = v11;
    if (v11 == 0.0)
    {
      *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1144) = 0;
    }
    else
    {
      *(float *)(*(_QWORD *)(a1 + 56) + 1148) = v508;
      *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1144) = 1;
      __DisplaySetLogicalBrightnessInternal(*(const void **)(a1 + 56), 28682, *(float *)(*(_QWORD *)(a1 + 56) + 1256));
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("ClientBrightnessOverride")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v225 = CFDictionaryGetTypeID();
      if (v225 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v507 = 0;
        v506 = 0;
        v506 = (const __CFBoolean *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("ClientBrightnessOverrideEnable"));
        if (v506)
        {
          v224 = CFBooleanGetTypeID();
          if (v224 == CFGetTypeID(v506))
            v507 = CFBooleanGetValue(v506);
        }
        v505 = 0;
        v505 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("ClientBrightnessOverrideNits"));
        if (v505)
        {
          v223 = CFNumberGetTypeID();
          if (v223 == CFGetTypeID(v505))
            CFNumberGetValue(v505, kCFNumberFloatType, &v587);
        }
        v504 = 0;
        v503 = 0;
        v503 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("ClientBrightnessOverrideType"));
        if (v503)
        {
          v222 = CFNumberGetTypeID();
          if (v222 == CFGetTypeID(v503))
            CFNumberGetValue(v503, kCFNumberIntType, &v504);
        }
        setClientOverrideState(*(_QWORD *)(a1 + 56), v504, v507 != 0);
        if (v504)
        {
          if (v504 == 1)
            *(float *)(*(_QWORD *)(a1 + 56) + 968) = v587;
        }
        else
        {
          *(float *)(*(_QWORD *)(a1 + 56) + 964) = v587;
        }
        v502 = 0;
        v502 = evaluateClientOverrides(*(_QWORD *)(a1 + 56));
        if (v502 <= 3uLL)
          __asm { BR              X8 }
        __DisplaySetLogicalBrightnessInternal(*(const void **)(a1 + 56), 12298, *(float *)(*(_QWORD *)(a1 + 56) + 1256));
        v501 = 0;
        if (_logHandle)
        {
          v221 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v220 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v220 = init_default_corebrightness_log();
          v221 = v220;
        }
        v501 = v221;
        v500 = OS_LOG_TYPE_DEBUG;
        if (os_log_type_enabled(v221, OS_LOG_TYPE_DEBUG))
        {
          __os_log_helper_16_2_6_8_32_4_0_8_0_8_0_8_0_8_0((uint64_t)v643, (uint64_t)"ClientBrightnessOverride", *(unsigned __int8 *)(*(_QWORD *)(a1 + 56) + 960), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 964)), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 968)), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 396)), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 400)));
          _os_log_debug_impl(&dword_1B5291000, v501, v500, "DisplaySetProperty: %s activeFlags = %#x overrideL = %f overrideLmin = %f Lmin = %f LminCurrent = %f", v643, 0x3Au);
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("ForceModuleUpdate")))
  {
    v499 = 0;
    if (_logHandle)
    {
      v219 = _logHandle;
    }
    else
    {
      if (_COREBRIGHTNESS_LOG_DEFAULT)
        v218 = _COREBRIGHTNESS_LOG_DEFAULT;
      else
        v218 = init_default_corebrightness_log();
      v219 = v218;
    }
    v499 = v219;
    v498 = OS_LOG_TYPE_DEBUG;
    if (os_log_type_enabled(v219, OS_LOG_TYPE_DEBUG))
    {
      __os_log_helper_16_2_1_8_32((uint64_t)v642, (uint64_t)"ForceModuleUpdate");
      _os_log_debug_impl(&dword_1B5291000, v499, v498, "DisplaySetProperty: %s\n", v642, 0xCu);
    }
    __DisplaySetLogicalBrightnessInternal(*(const void **)(a1 + 56), 12298, *(float *)(*(_QWORD *)(a1 + 56) + 1256));
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessMin")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 340);
    v217 = CFNumberGetTypeID();
    if (v217 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
    if (v587 != *(float *)(*(_QWORD *)(a1 + 56) + 340))
    {
      *(float *)(*(_QWORD *)(a1 + 56) + 340) = v587;
      v497 = 0;
      if (_logHandle)
      {
        v216 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v215 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v215 = init_default_corebrightness_log();
        v216 = v215;
      }
      v497 = v216;
      v496 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v216, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v641, (uint64_t)"DisplayBrightnessMin", COERCE__INT64(v587));
        _os_log_debug_impl(&dword_1B5291000, v497, v496, "DisplaySetProperty: %s = %f\n", v641, 0x16u);
      }
      _DisplaySetBrightness(*(_QWORD *)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 336));
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessMax")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 344);
    v214 = CFNumberGetTypeID();
    if (v214 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
    if (v587 != *(float *)(*(_QWORD *)(a1 + 56) + 344))
    {
      *(float *)(*(_QWORD *)(a1 + 56) + 344) = v587;
      v495 = 0;
      if (_logHandle)
      {
        v213 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v212 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v212 = init_default_corebrightness_log();
        v213 = v212;
      }
      v495 = v213;
      v494 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v213, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v640, (uint64_t)"DisplayBrightnessMax", COERCE__INT64(v587));
        _os_log_debug_impl(&dword_1B5291000, v495, v494, "DisplaySetProperty: %s = %f\n", v640, 0x16u);
      }
      _DisplaySetBrightness(*(_QWORD *)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 336));
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessAutoWeightMax")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 1200);
    v211 = CFNumberGetTypeID();
    if (v211 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
    if (v587 != *(float *)(*(_QWORD *)(a1 + 56) + 1200))
    {
      *(float *)(*(_QWORD *)(a1 + 56) + 1200) = v587;
      __DisplayUpdateAmbientProperties(*(_QWORD *)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 336));
      _DisplaySetAmbient(*(_QWORD *)(a1 + 56), 0, *(float *)(*(_QWORD *)(a1 + 56) + 1184));
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessAutoWeightMin")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 1196);
    v210 = CFNumberGetTypeID();
    if (v210 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
    if (v587 != *(float *)(*(_QWORD *)(a1 + 56) + 1196))
    {
      *(float *)(*(_QWORD *)(a1 + 56) + 1196) = v587;
      __DisplayUpdateAmbientProperties(*(_QWORD *)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 336));
      _DisplaySetAmbient(*(_QWORD *)(a1 + 56), 0, *(float *)(*(_QWORD *)(a1 + 56) + 1184));
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("IOHIDDisplayHandleAmbient")))
  {
    *(_DWORD *)(*(_QWORD *)(a1 + 56) + 36) = GetCFBooleanValue(*(const __CFNumber **)(a1 + 40));
    if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
      pthread_once(&__displayThreadInit, (void (*)(void))__DisplayBrightnessThreadInit);
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("EcoMode")))
  {
    if (!*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
    {
      v209 = CFBooleanGetTypeID();
      if (v209 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v493 = 0;
        v493 = CFBooleanGetValue(*(CFBooleanRef *)(a1 + 40));
        if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 220) != v493)
        {
          *(_DWORD *)(*(_QWORD *)(a1 + 56) + 220) = v493;
          v208 = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 640);
          if (v208)
          {
            if (v208 == 1)
            {
              v492 = 0.0;
              if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 220))
                v207 = *(double *)(*(_QWORD *)(a1 + 56) + 656);
              else
                v207 = 1.0;
              v12 = v207;
              v492 = v12;
              _DisplaySetBrightnessEcoModeFactorWithFade(*(_QWORD *)(a1 + 56), v12, 0.5);
            }
            else if (v208 == 2)
            {
              v491 = 0.0;
              if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 220))
                v206 = *(float *)(*(_QWORD *)(a1 + 56) + 776);
              else
                v206 = *(float *)(*(_QWORD *)(a1 + 56) + 1312);
              v491 = v206;
              _DisplaySetBrightnessEcoModeLimitWithFade(*(_QWORD *)(a1 + 56), v206, 0.5);
            }
            else
            {
              v487 = (os_log_t)_logHandle;
              v486 = OS_LOG_TYPE_FAULT;
              if (os_log_type_enabled((os_log_t)_logHandle, OS_LOG_TYPE_FAULT))
              {
                __os_log_helper_16_0_1_4_0((uint64_t)v639, *(_DWORD *)(*(_QWORD *)(a1 + 56) + 640));
                _os_log_fault_impl(&dword_1B5291000, v487, v486, "Unexpected eco mode behaviour = %d, ignoring", v639, 8u);
              }
            }
          }
          else
          {
            v490 = 0;
            if (_logHandle)
            {
              v205 = _logHandle;
            }
            else
            {
              if (_COREBRIGHTNESS_LOG_DEFAULT)
                v204 = _COREBRIGHTNESS_LOG_DEFAULT;
              else
                v204 = init_default_corebrightness_log();
              v205 = v204;
            }
            v490 = v205;
            v489 = 2;
            if (os_log_type_enabled(v205, OS_LOG_TYPE_DEBUG))
            {
              v202 = v490;
              v203 = v489;
              __os_log_helper_16_0_0(v488);
              _os_log_debug_impl(&dword_1B5291000, v202, v203, "Eco mode is not enabled on this device - ignoring", v488, 2u);
            }
          }
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("EcoModeFactorUpdate")))
  {
    if (!*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
    {
      if (*(_QWORD *)(a1 + 40))
      {
        v201 = CFNumberGetTypeID();
        if (v201 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
        {
          v485 = 0.0;
          CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberDoubleType, &v485);
          *(double *)(*(_QWORD *)(a1 + 56) + 656) = 1.0 - v485 / 100.0;
          if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 220))
          {
            v13 = *(double *)(*(_QWORD *)(a1 + 56) + 656);
            _DisplaySetBrightnessEcoModeFactorWithFade(*(_QWORD *)(a1 + 56), v13, 0.5);
          }
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DominoStateUpdate")))
  {
    v200 = CFBooleanGetTypeID();
    if (v200 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v484 = 0;
      v484 = CFBooleanGetValue(*(CFBooleanRef *)(a1 + 40));
      if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 224) != v484)
      {
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 224) = v484;
        v483 = 0;
        if (_logHandle)
        {
          v199 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v198 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v198 = init_default_corebrightness_log();
          v199 = v198;
        }
        v483 = v199;
        v482 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v199, OS_LOG_TYPE_DEFAULT))
        {
          __os_log_helper_16_0_1_4_0((uint64_t)v638, v484);
          _os_log_impl(&dword_1B5291000, v483, v482, "Domino State Change: %d", v638, 8u);
        }
        v481 = 0.0;
        if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 224))
          v197 = *(float *)(*(_QWORD *)(a1 + 56) + 720);
        else
          v197 = *(float *)(*(_QWORD *)(a1 + 56) + 1312);
        v481 = v197;
        _DisplaySetBrightnessDominoModeLimitWithFade(*(_QWORD *)(a1 + 56), v197, 0.5);
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessFactor")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 348);
    v196 = CFNumberGetTypeID();
    if (v196 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
    __DisplayCancelFactorFade(*(_QWORD *)(a1 + 56));
    if (v587 != *(float *)(*(_QWORD *)(a1 + 56) + 348))
    {
      _DisplayUpdateWeakCapOnFactorChange(*(_QWORD *)(a1 + 56), v587);
      _DisplaySetBrightnessFactor(*(_QWORD *)(a1 + 56), v587);
      if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
      {
        v194 = *(_QWORD *)(a1 + 56);
        v195 = __DisplayCalculateBrightnessFromFactorChange(v194, *(_DWORD *)(v194 + 204));
        __DisplaySetLogicalBrightnessLegacy((float *)v194, 7u, v195, 0.0);
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 356) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 352);
      }
      else
      {
        v480 = 4098;
        if (*(float *)(*(_QWORD *)(a1 + 56) + 348) == 1.0)
          v480 |= 8u;
        v479 = 0.0;
        v479 = *(float *)(*(_QWORD *)(a1 + 56) + 1252);
        v478 = 0.0;
        v478 = *(float *)(*(_QWORD *)(a1 + 56) + 1492);
        if (*(float *)(*(_QWORD *)(a1 + 56) + 348) <= 0.0)
        {
          if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 12282) & 1) != 0)
            __DisplayCancelAAPFade(*(_BYTE **)(a1 + 56));
          else
            __DisplayCancelReflectedBrightnessFadeInternal(*(_QWORD *)(a1 + 56));
          *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12300) = 0;
        }
        else
        {
          v479 = fmaxf(v479, *(float *)(*(_QWORD *)(a1 + 56) + 1320));
          v478 = fmaxf(v478, *(float *)(*(_QWORD *)(a1 + 56) + 1320));
          *(float *)(*(_QWORD *)(a1 + 56) + 1488) = v478;
        }
        v477 = 0;
        if (_logHandle)
        {
          v193 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v192 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v192 = init_default_corebrightness_log();
          v193 = v192;
        }
        v477 = v193;
        v476 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v193, OS_LOG_TYPE_DEFAULT))
        {
          __os_log_helper_16_2_4_8_32_8_0_8_0_8_0((uint64_t)v637, (uint64_t)"DisplayBrightnessFactor", COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 348)), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 1252)), COERCE__INT64(v479));
          _os_log_impl(&dword_1B5291000, v477, v476, "%s = %f Lpending: %f L_logical: %f", v637, 0x2Au);
        }
        __DisplaySetLogicalBrightnessWithFadeInternal(*(_QWORD *)(a1 + 56), v480 | 0x2000, 0, 0, v479, 0.0);
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12392) = 0;
        v475 = 0;
        if (_logHandle)
        {
          v191 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v190 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v190 = init_default_corebrightness_log();
          v191 = v190;
        }
        v475 = v191;
        v474 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v191, OS_LOG_TYPE_DEFAULT))
        {
          __os_log_helper_16_2_3_8_32_8_0_8_0((uint64_t)v636, (uint64_t)"Factor", COERCE__INT64(v587), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 1260)));
          _os_log_impl(&dword_1B5291000, v475, v474, "[BRT update: %s]: value = %f, nits = %f", v636, 0x20u);
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("MinNits")))
  {
    v189 = CFDictionaryGetTypeID();
    if (v189 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v473 = 0.0;
      v473 = *(float *)(*(_QWORD *)(a1 + 56) + 1256);
      v472 = 0.0;
      v471 = 0;
      v471 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("period"));
      if (v471)
      {
        v188 = CFNumberGetTypeID();
        if (v188 == CFGetTypeID(v471))
          CFNumberGetValue(v471, kCFNumberFloatType, &v472);
      }
      v470 = 0;
      v470 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("nits"));
      if (v470)
      {
        v187 = CFNumberGetTypeID();
        if (v187 == CFGetTypeID(v470))
          CFNumberGetValue(v470, kCFNumberFloatType, &v473);
      }
      if (getClientOverrideState(*(_QWORD *)(a1 + 56), 1))
        v473 = fmaxf(v473, *(float *)(*(_QWORD *)(a1 + 56) + 968));
      _DisplaySetBrightnessMinPhysicalWithFade(*(_QWORD *)(a1 + 56), v473, v472);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessFactorWithFade")))
  {
    kdebug_trace();
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 348);
    v186 = CFDictionaryGetTypeID();
    if (v186 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v469 = 0;
      v469 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("DisplayBrightnessFadePeriod"));
      if (v469)
      {
        v185 = CFNumberGetTypeID();
        if (v185 == CFGetTypeID(v469))
          CFNumberGetValue(v469, kCFNumberFloat32Type, (void *)(*(_QWORD *)(a1 + 56) + 372));
      }
      v468 = 0;
      v468 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("DisplayBrightnessFactor"));
      if (v468)
      {
        v184 = CFNumberGetTypeID();
        if (v184 == CFGetTypeID(v468))
        {
          CFNumberGetValue(v468, kCFNumberFloat32Type, &v587);
          v467 = 0;
          v467 = *(double *)(*(_QWORD *)(a1 + 56) + 1384) > 0.0;
          if (v587 != *(float *)(*(_QWORD *)(a1 + 56) + 348) || v467)
          {
            if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
            {
              _DisplaySetBrightnessFactor(*(_QWORD *)(a1 + 56), v587);
              v182 = *(_QWORD *)(a1 + 56);
              v183 = __DisplayCalculateBrightnessFromFactorChange(v182, *(_DWORD *)(v182 + 204));
              __DisplaySetLogicalBrightnessLegacy((float *)v182, 6u, v183, *(float *)(*(_QWORD *)(a1 + 56) + 372));
              *(_DWORD *)(*(_QWORD *)(a1 + 56) + 356) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 352);
            }
            else
            {
              if (v587 == 0.0)
              {
                if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 12282) & 1) != 0)
                  __DisplayCancelAAPFade(*(_BYTE **)(a1 + 56));
                else
                  __DisplayCancelReflectedBrightnessFadeInternal(*(_QWORD *)(a1 + 56));
                if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 12282) & 1) == 0)
                  *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12392) = 0;
                *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12300) = 0;
              }
              _DisplayUpdateWeakCapOnFactorChange(*(_QWORD *)(a1 + 56), v587);
              _DisplaySetFactorWithFade(*(_QWORD *)(a1 + 56), v587, *(float *)(*(_QWORD *)(a1 + 56) + 372));
              v466 = 0;
              if (_logHandle)
              {
                v181 = _logHandle;
              }
              else
              {
                if (_COREBRIGHTNESS_LOG_DEFAULT)
                  v180 = _COREBRIGHTNESS_LOG_DEFAULT;
                else
                  v180 = init_default_corebrightness_log();
                v181 = v180;
              }
              v466 = v181;
              v465 = OS_LOG_TYPE_DEFAULT;
              if (os_log_type_enabled(v181, OS_LOG_TYPE_DEFAULT))
              {
                __os_log_helper_16_2_3_8_32_8_0_8_0((uint64_t)v635, (uint64_t)"Factor", COERCE__INT64(v587), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 372)));
                _os_log_impl(&dword_1B5291000, v466, v465, "[BRT update: %s]: value = %f with fade period = %f", v635, 0x20u);
              }
            }
            *(_DWORD *)(*(_QWORD *)(a1 + 56) + 356) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 352);
            CFDictionarySetValue(*(CFMutableDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), CFSTR("DisplayBrightnessFactor"), v468);
          }
        }
      }
    }
    else
    {
      v179 = CFNumberGetTypeID();
      if (v179 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
        v464 = 0;
        v464 = *(double *)(*(_QWORD *)(a1 + 56) + 1384) > 0.0;
        if (v587 != *(float *)(*(_QWORD *)(a1 + 56) + 348) || v464)
        {
          if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
          {
            _DisplaySetBrightnessFactor(*(_QWORD *)(a1 + 56), v587);
            v177 = *(_QWORD *)(a1 + 56);
            v178 = __DisplayCalculateBrightnessFromFactorChange(v177, *(_DWORD *)(v177 + 204));
            __DisplaySetLogicalBrightnessLegacy((float *)v177, 6u, v178, *(float *)(*(_QWORD *)(a1 + 56) + 372));
            *(_DWORD *)(*(_QWORD *)(a1 + 56) + 356) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 352);
          }
          else
          {
            if (v587 == 0.0)
            {
              if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 12282) & 1) != 0)
                __DisplayCancelAAPFade(*(_BYTE **)(a1 + 56));
              else
                __DisplayCancelReflectedBrightnessFadeInternal(*(_QWORD *)(a1 + 56));
              *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12300) = 0;
              if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 12282) & 1) == 0)
                *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12392) = 0;
            }
            _DisplayUpdateWeakCapOnFactorChange(*(_QWORD *)(a1 + 56), v587);
            _DisplaySetFactorWithFade(*(_QWORD *)(a1 + 56), v587, *(float *)(*(_QWORD *)(a1 + 56) + 372));
            v463 = 0;
            if (_logHandle)
            {
              v176 = _logHandle;
            }
            else
            {
              if (_COREBRIGHTNESS_LOG_DEFAULT)
                v175 = _COREBRIGHTNESS_LOG_DEFAULT;
              else
                v175 = init_default_corebrightness_log();
              v176 = v175;
            }
            v463 = v176;
            v462 = OS_LOG_TYPE_DEFAULT;
            if (os_log_type_enabled(v176, OS_LOG_TYPE_DEFAULT))
            {
              __os_log_helper_16_2_3_8_32_8_0_8_0((uint64_t)v634, (uint64_t)"Factor", COERCE__INT64(v587), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 372)));
              _os_log_impl(&dword_1B5291000, v463, v462, "[BRT update: %s]: value = %f with fade period = %f", v634, 0x20u);
            }
          }
          *(_DWORD *)(*(_QWORD *)(a1 + 56) + 356) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 352);
          CFDictionarySetValue(*(CFMutableDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), CFSTR("DisplayBrightnessFactor"), *(const void **)(a1 + 40));
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessFadePeriod")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 372);
    v174 = CFNumberGetTypeID();
    if (v174 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
    *(float *)(*(_QWORD *)(a1 + 56) + 372) = v587;
    v461 = 0;
    if (_logHandle)
    {
      v173 = _logHandle;
    }
    else
    {
      if (_COREBRIGHTNESS_LOG_DEFAULT)
        v172 = _COREBRIGHTNESS_LOG_DEFAULT;
      else
        v172 = init_default_corebrightness_log();
      v173 = v172;
    }
    v461 = v173;
    v460 = OS_LOG_TYPE_DEBUG;
    if (os_log_type_enabled(v173, OS_LOG_TYPE_DEBUG))
    {
      __os_log_helper_16_2_2_8_32_8_0((uint64_t)v633, (uint64_t)"DisplayBrightnessFadePeriod", COERCE__INT64(v587));
      _os_log_debug_impl(&dword_1B5291000, v461, v460, "DisplaySetProperty: %s = %f\n", v633, 0x16u);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("LogLevel")))
  {
    v459 = 0;
    v459 = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 200);
    v171 = CFNumberGetTypeID();
    if (v171 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v459);
    v458 = 0;
    if (_logHandle)
    {
      v170 = _logHandle;
    }
    else
    {
      if (_COREBRIGHTNESS_LOG_DEFAULT)
        v169 = _COREBRIGHTNESS_LOG_DEFAULT;
      else
        v169 = init_default_corebrightness_log();
      v170 = v169;
    }
    v458 = v170;
    v457 = OS_LOG_TYPE_DEFAULT;
    if (os_log_type_enabled(v170, OS_LOG_TYPE_DEFAULT))
    {
      __os_log_helper_16_2_2_8_32_4_0((uint64_t)v632, (uint64_t)"LogLevel", v459);
      _os_log_impl(&dword_1B5291000, v458, v457, "DisplaySetProperty: %s = %x\n", v632, 0x12u);
    }
    if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 200) != v459)
      *(_DWORD *)(*(_QWORD *)(a1 + 56) + 200) = v459;
    __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), *(const __CFString **)(a1 + 48), *(const void **)(a1 + 40));
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("PLCEnable")))
  {
    v456 = 0;
    v456 = (*(_BYTE *)(*(_QWORD *)(a1 + 56) + 288) & 1) != 0;
    v168 = CFNumberGetTypeID();
    if (v168 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v456);
    if (v456)
    {
      if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 284)
        && *(float *)(*(_QWORD *)(a1 + 56) + 1260) > (float)*(unsigned int *)(*(_QWORD *)(a1 + 56) + 284))
      {
        __DisplaySendPLCUpdate(*(_QWORD *)(a1 + 56), 1);
      }
    }
    else if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 289) & 1) != 0)
    {
      __DisplaySendPLCUpdate(*(_QWORD *)(a1 + 56), 0);
      v455 = 0;
      v455 = (int)(*(float *)(*(_QWORD *)(a1 + 56) + 1260) * 65536.0);
      SetBLDriverNitsValueIfNotInLPM(*(_QWORD *)(a1 + 56), v455);
    }
    *(_BYTE *)(*(_QWORD *)(a1 + 56) + 288) = v456;
    v454 = 0;
    if (_logHandle)
    {
      v167 = _logHandle;
    }
    else
    {
      if (_COREBRIGHTNESS_LOG_DEFAULT)
        v166 = _COREBRIGHTNESS_LOG_DEFAULT;
      else
        v166 = init_default_corebrightness_log();
      v167 = v166;
    }
    v454 = v167;
    v453 = OS_LOG_TYPE_DEFAULT;
    if (os_log_type_enabled(v167, OS_LOG_TYPE_DEFAULT))
    {
      __os_log_helper_16_0_1_4_0((uint64_t)v631, *(_BYTE *)(*(_QWORD *)(a1 + 56) + 288) & 1);
      _os_log_impl(&dword_1B5291000, v454, v453, "PLCEnabled=%d", v631, 8u);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessFadeSlope")))
  {
    v165 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v165 == CFNumberGetTypeID())
    {
      v452 = 0.0;
      v452 = *(float *)(*(_QWORD *)(a1 + 56) + 1228);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v452);
      v451 = 0;
      if (_logHandle)
      {
        v164 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v163 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v163 = init_default_corebrightness_log();
        v164 = v163;
      }
      v451 = v164;
      v450 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v164, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_0_1_8_0((uint64_t)v630, COERCE__INT64(v452));
        _os_log_debug_impl(&dword_1B5291000, v451, v450, "display->brightness.als.duration.customSlope = %f\n", v630, 0xCu);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 1228) = v452;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayMedianFilterLength")))
  {
    v162 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v162 == CFNumberGetTypeID())
    {
      v449 = 0;
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v449);
      if (v449 <= 50)
      {
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12736) = v449;
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12732) = 0;
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12728) = 0;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CabalFactorOverride")))
  {
    v161 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v161 == CFNumberGetTypeID())
    {
      v448 = -1.0;
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v448);
      DisplaySetCabalFactorOverride(*(_QWORD *)(a1 + 56), v448);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayAAPFactor")))
  {
    v160 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v160 == CFNumberGetTypeID())
    {
      v447 = 0.0;
      v447 = *(float *)(*(_QWORD *)(a1 + 56) + 12392);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v447);
      v446 = 0;
      if (_logHandle)
      {
        v159 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v158 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v158 = init_default_corebrightness_log();
        v159 = v158;
      }
      v446 = v159;
      v445 = OS_LOG_TYPE_DEFAULT;
      if (os_log_type_enabled(v159, OS_LOG_TYPE_DEFAULT))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v629, (uint64_t)"DisplayAAPFactor", COERCE__INT64(v447));
        _os_log_impl(&dword_1B5291000, v446, v445, "%s = %f\n", v629, 0x16u);
      }
      __DisplaySetAAPFactor(*(_BYTE **)(a1 + 56), v447);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayAAPFactorMin")))
  {
    v157 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v157 == CFNumberGetTypeID())
    {
      v444 = 0.0;
      v444 = *(float *)(*(_QWORD *)(a1 + 56) + 12456);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v444);
      v443 = 0;
      if (_logHandle)
      {
        v156 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v155 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v155 = init_default_corebrightness_log();
        v156 = v155;
      }
      v443 = v156;
      v442 = OS_LOG_TYPE_DEFAULT;
      if (os_log_type_enabled(v156, OS_LOG_TYPE_DEFAULT))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v628, (uint64_t)"DisplayAAPFactorMin", COERCE__INT64(v444));
        _os_log_impl(&dword_1B5291000, v443, v442, "%s = %f\n", v628, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12456) = v444;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayAAPFactorMax")))
  {
    v154 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v154 == CFNumberGetTypeID())
    {
      v441 = 0.0;
      v441 = *(float *)(*(_QWORD *)(a1 + 56) + 12460);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v441);
      v440 = 0;
      if (_logHandle)
      {
        v153 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v152 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v152 = init_default_corebrightness_log();
        v153 = v152;
      }
      v440 = v153;
      v439 = OS_LOG_TYPE_DEFAULT;
      if (os_log_type_enabled(v153, OS_LOG_TYPE_DEFAULT))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v627, (uint64_t)"DisplayAAPFactorMax", COERCE__INT64(v441));
        _os_log_impl(&dword_1B5291000, v440, v439, "%s = %f\n", v627, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12460) = v441;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPDBMin")))
  {
    v151 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v151 == CFNumberGetTypeID())
    {
      v438 = 0.0;
      v438 = *(float *)(*(_QWORD *)(a1 + 56) + 12256);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v438);
      v437 = 0;
      if (_logHandle)
      {
        v150 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v149 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v149 = init_default_corebrightness_log();
        v150 = v149;
      }
      v437 = v150;
      v436 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v150, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v626, (uint64_t)"AAPDBMin", COERCE__INT64(v438));
        _os_log_debug_impl(&dword_1B5291000, v437, v436, "%s = %f\n", v626, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12256) = v438;
      v435 = 1;
      HIDWORD(v435) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12304);
      __DisplayUpdateAAPStateInternal(*(_QWORD *)(a1 + 56), (uint64_t)&v435, 0);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPK_0")))
  {
    v148 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v148 == CFNumberGetTypeID())
    {
      v434 = 0.0;
      v434 = *(float *)(*(_QWORD *)(a1 + 56) + 12260);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v434);
      v433 = 0;
      if (_logHandle)
      {
        v147 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v146 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v146 = init_default_corebrightness_log();
        v147 = v146;
      }
      v433 = v147;
      v432 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v147, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v625, (uint64_t)"AAPK_0", COERCE__INT64(v434));
        _os_log_debug_impl(&dword_1B5291000, v433, v432, "%s = %f\n", v625, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12260) = v434;
      v431 = 2;
      HIDWORD(v431) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12300);
      __DisplayUpdateAAPStateInternal(*(_QWORD *)(a1 + 56), (uint64_t)&v431, 0);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPK_1")))
  {
    v145 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v145 == CFNumberGetTypeID())
    {
      v430 = 0.0;
      v430 = *(float *)(*(_QWORD *)(a1 + 56) + 12264);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v430);
      v429 = 0;
      if (_logHandle)
      {
        v144 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v143 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v143 = init_default_corebrightness_log();
        v144 = v143;
      }
      v429 = v144;
      v428 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v144, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v624, (uint64_t)"AAPK_1", COERCE__INT64(v430));
        _os_log_debug_impl(&dword_1B5291000, v429, v428, "%s = %f\n", v624, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12264) = v430;
      v427 = 2;
      HIDWORD(v427) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12300);
      __DisplayUpdateAAPStateInternal(*(_QWORD *)(a1 + 56), (uint64_t)&v427, 0);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPManualB")))
  {
    v142 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v142 == CFNumberGetTypeID())
    {
      v426 = 0;
      v426 = CFBooleanGetValue(*(CFBooleanRef *)(a1 + 40)) != 0;
      v425 = 0;
      if (_logHandle)
      {
        v141 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v140 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v140 = init_default_corebrightness_log();
        v141 = v140;
      }
      v425 = v141;
      v424 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v141, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_4_0((uint64_t)v623, (uint64_t)"AAPManualB", v426);
        _os_log_debug_impl(&dword_1B5291000, v425, v424, "%s = %d\n", v623, 0x12u);
      }
      *(_BYTE *)(*(_QWORD *)(a1 + 56) + 12284) = v426;
      v423 = 0;
      BYTE4(v423) = *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1232) & 1;
      __DisplayUpdateAAPStateInternal(*(_QWORD *)(a1 + 56), (uint64_t)&v423, 0);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPHDRMode")))
  {
    v139 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v139 == CFBooleanGetTypeID())
    {
      v422 = 0;
      v422 = CFBooleanGetValue(*(CFBooleanRef *)(a1 + 40)) != 0;
      v421 = 0;
      if (_logHandle)
      {
        v138 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v137 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v137 = init_default_corebrightness_log();
        v138 = v137;
      }
      v421 = v138;
      v420 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v138, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_4_0((uint64_t)v622, (uint64_t)"AAPHDRMode", v422);
        _os_log_debug_impl(&dword_1B5291000, v421, v420, "%s = %d\n", v622, 0x12u);
      }
      *(_BYTE *)(*(_QWORD *)(a1 + 56) + 12292) = v422;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPLuxDelta")))
  {
    v136 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v136 == CFNumberGetTypeID())
    {
      v419 = 0.0;
      v419 = *(float *)(*(_QWORD *)(a1 + 56) + 12268);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v419);
      v418 = 0;
      if (_logHandle)
      {
        v135 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v134 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v134 = init_default_corebrightness_log();
        v135 = v134;
      }
      v418 = v135;
      v417 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v135, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v621, (uint64_t)"AAPLuxDelta", COERCE__INT64(v419));
        _os_log_debug_impl(&dword_1B5291000, v418, v417, "%s = %f\n", v621, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12268) = v419;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPRampUpTime")))
  {
    v133 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v133 == CFNumberGetTypeID())
    {
      v416 = 0.0;
      v416 = *(float *)(*(_QWORD *)(a1 + 56) + 12272);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v416);
      v415 = 0;
      if (_logHandle)
      {
        v132 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v131 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v131 = init_default_corebrightness_log();
        v132 = v131;
      }
      v415 = v132;
      v414 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v132, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v620, (uint64_t)"AAPRampUpTime", COERCE__INT64(v416));
        _os_log_debug_impl(&dword_1B5291000, v415, v414, "%s = %f\n", v620, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12272) = v416;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPRampDownTime")))
  {
    v130 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v130 == CFNumberGetTypeID())
    {
      v413 = 0.0;
      v413 = *(float *)(*(_QWORD *)(a1 + 56) + 12276);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v413);
      v412 = 0;
      if (_logHandle)
      {
        v129 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v128 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v128 = init_default_corebrightness_log();
        v129 = v128;
      }
      v412 = v129;
      v411 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v129, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v619, (uint64_t)"AAPRampDownTime", COERCE__INT64(v413));
        _os_log_debug_impl(&dword_1B5291000, v412, v411, "%s = %f\n", v619, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12276) = v413;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AAPRampDisableTime")))
  {
    v127 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v127 == CFNumberGetTypeID())
    {
      v410 = 0.0;
      v410 = *(float *)(*(_QWORD *)(a1 + 56) + 12252);
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v410);
      v409 = 0;
      if (_logHandle)
      {
        v126 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v125 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v125 = init_default_corebrightness_log();
        v126 = v125;
      }
      v409 = v126;
      v408 = OS_LOG_TYPE_DEBUG;
      if (os_log_type_enabled(v126, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v618, (uint64_t)"AAPRampDisableTime", COERCE__INT64(v410));
        _os_log_debug_impl(&dword_1B5291000, v409, v408, "%s = %f\n", v618, 0x16u);
      }
      *(float *)(*(_QWORD *)(a1 + 56) + 12252) = v410;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("MaxBrightness")))
  {
    v124 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v124 == CFNumberGetTypeID())
    {
      v407 = 100.0;
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v407);
      v407 = v407 / 100.0;
      v406 = 0;
      if (_logHandle)
      {
        v123 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v122 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v122 = init_default_corebrightness_log();
        v123 = v122;
      }
      v406 = v123;
      v405 = OS_LOG_TYPE_DEFAULT;
      if (os_log_type_enabled(v123, OS_LOG_TYPE_DEFAULT))
      {
        __os_log_helper_16_0_1_8_0((uint64_t)v617, COERCE__INT64(v407));
        _os_log_impl(&dword_1B5291000, v406, v405, "Set MaxBrightness=%f", v617, 0xCu);
      }
      if (v407 >= 0.0)
      {
        v404 = 0.0;
        if (_DisplayCLTMRev2Applicable(*(_QWORD *)(a1 + 56)))
        {
          v403 = 0;
          if (v407 <= 0.95)
          {
            if (v407 <= 0.15)
              v403 = 2;
            else
              v403 = 1;
          }
          else
          {
            v403 = 0;
          }
          v402 = 0;
          if (_logHandle)
          {
            v121 = _logHandle;
          }
          else
          {
            if (_COREBRIGHTNESS_LOG_DEFAULT)
              v120 = _COREBRIGHTNESS_LOG_DEFAULT;
            else
              v120 = init_default_corebrightness_log();
            v121 = v120;
          }
          v402 = v121;
          v401 = OS_LOG_TYPE_DEFAULT;
          if (os_log_type_enabled(v121, OS_LOG_TYPE_DEFAULT))
          {
            __os_log_helper_16_0_1_4_0((uint64_t)v616, v403);
            _os_log_impl(&dword_1B5291000, v402, v401, "CLTM mode=%d", v616, 8u);
          }
          if (v403 != *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1560))
          {
            v615 = CFSTR("BrightnessCLTMMode");
            v614 = 0;
            v614 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberIntType, &v403);
            if (v615)
            {
              if (v614)
              {
                v400 = 0;
                allocator = CFGetAllocator(*(CFTypeRef *)(a1 + 56));
                v400 = CFDictionaryCreate(allocator, (const void **)&v615, (const void **)&v614, 1, MEMORY[0x1E0C9B390], MEMORY[0x1E0C9B3A0]);
                if (v400)
                {
                  v14 = *(NSObject **)(*(_QWORD *)(a1 + 56) + 144);
                  v393 = MEMORY[0x1E0C809B0];
                  v394 = -1073741824;
                  v395 = 0;
                  v396 = __DisplaySetProperty_block_invoke_419;
                  v397 = &__block_descriptor_48_e5_v8__0l;
                  v398 = *(_QWORD *)(a1 + 56);
                  v399 = v400;
                  dispatch_async(v14, &v393);
                }
              }
            }
            if (v614)
              CFRelease(v614);
          }
          *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1560) = v403;
          v392 = 0;
          v392 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberIntType, (const void *)(*(_QWORD *)(a1 + 56) + 1560));
          if (v392)
          {
            CFDictionarySetValue(*(CFMutableDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), CFSTR("BrightnessCLTMMode"), v392);
            CFRelease(v392);
          }
          *(float *)(*(_QWORD *)(a1 + 56) + 1552) = v407;
          if (v407 == 0.0)
          {
            v404 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), v407);
            _DisplaySetBrightnessMaxPhysicalZeroWithFade(*(_QWORD *)(a1 + 56), (uint64_t)_DisplayRampDoneCallback, *(_QWORD *)(a1 + 56), v404, 4.0);
          }
          else
          {
            v404 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), v407);
            _DisplaySetBrightnessMaxPhysicalWithFade(*(_QWORD *)(a1 + 56), v404, 4.0);
          }
        }
        else
        {
          v404 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), v407);
          _DisplaySetBrightnessMaxPhysicalWithFade(*(_QWORD *)(a1 + 56), v404, 0.0);
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("BrightnessCLTM")))
  {
    if (_DisplayCLTMRev2Applicable(*(_QWORD *)(a1 + 56)))
    {
      v118 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v118 == CFDictionaryGetTypeID())
      {
        v391 = 0.0;
        v390 = 1;
        v389 = 0;
        v389 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("BrightnessCLTMEnable"));
        if (v389)
        {
          v117 = CFGetTypeID(v389);
          if (v117 == CFBooleanGetTypeID())
            v390 = CFBooleanGetValue((CFBooleanRef)v389) != 0;
        }
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1556) = v390;
        v388 = 0.0;
        v387 = 0;
        v387 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("BrightnessCLTMRampRate"));
        if (v387)
        {
          v116 = CFGetTypeID(v387);
          if (v116 == CFNumberGetTypeID())
            CFNumberGetValue((CFNumberRef)v387, kCFNumberFloatType, &v388);
        }
        v386 = 0;
        if (_logHandle)
        {
          v115 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v114 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v114 = init_default_corebrightness_log();
          v115 = v114;
        }
        v386 = v115;
        v385 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v115, OS_LOG_TYPE_DEFAULT))
        {
          if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 1556))
            v15 = "Enable";
          else
            v15 = "Disable";
          __os_log_helper_16_2_2_8_32_8_0((uint64_t)v613, (uint64_t)v15, COERCE__INT64(v388));
          _os_log_impl(&dword_1B5291000, v386, v385, "%s CLTM with period %f", v613, 0x16u);
        }
        if (v390)
        {
          v391 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), *(float *)(*(_QWORD *)(a1 + 56) + 1552));
          if (*(float *)(*(_QWORD *)(a1 + 56) + 1552) == 0.0)
            _DisplaySetBrightnessMaxPhysicalZeroWithFade(*(_QWORD *)(a1 + 56), (uint64_t)_DisplayRampDoneCallback, *(_QWORD *)(a1 + 56), v391, v388);
          else
            _DisplaySetBrightnessMaxPhysicalWithFade(*(_QWORD *)(a1 + 56), v391, v388);
        }
        else
        {
          v384 = 0.0;
          v384 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), 1.0);
          _DisplaySetBrightnessMaxPhysicalWithFade(*(_QWORD *)(a1 + 56), v384, v388);
        }
        v612 = xmmword_1E68EB528;
        v610 = 0;
        v611 = 0;
        v610 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberIntType, (const void *)(*(_QWORD *)(a1 + 56) + 1556));
        v611 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberFloatType, &v388);
        v383 = 0;
        v113 = CFGetAllocator(*(CFTypeRef *)(a1 + 56));
        v383 = CFDictionaryCreate(v113, (const void **)&v612, (const void **)&v610, 2, MEMORY[0x1E0C9B390], MEMORY[0x1E0C9B3A0]);
        if (v383)
        {
          CFDictionarySetValue(*(CFMutableDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), CFSTR("BrightnessCLTM"), v383);
          CFRelease(v383);
        }
        if (v610)
          CFRelease(v610);
        if (v611)
          CFRelease(v611);
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("BrightnessWeakCap")))
  {
    v112 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
    if (v112 == CFNumberGetTypeID())
    {
      v382 = 100.0;
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v382);
      v382 = v382 / 100.0;
      v381 = 0;
      if (_logHandle)
      {
        v111 = _logHandle;
      }
      else
      {
        if (_COREBRIGHTNESS_LOG_DEFAULT)
          v110 = _COREBRIGHTNESS_LOG_DEFAULT;
        else
          v110 = init_default_corebrightness_log();
        v111 = v110;
      }
      v381 = v111;
      v380 = OS_LOG_TYPE_DEFAULT;
      if (os_log_type_enabled(v111, OS_LOG_TYPE_DEFAULT))
      {
        __os_log_helper_16_0_1_8_0((uint64_t)v609, COERCE__INT64(v382));
        _os_log_impl(&dword_1B5291000, v381, v380, "Set BrightnessWeakCap=%f", v609, 0xCu);
      }
      if (v382 >= 0.0)
      {
        v379 = 0.0;
        v379 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), v382);
        v378 = 0.0;
        if (v379 < *(float *)(*(_QWORD *)(a1 + 56) + 528))
          v378 = 7.0;
        else
          v378 = 2.5;
        _DisplaySetBrightnessWeakCapWithFade(*(_BYTE **)(a1 + 56), 1, v379, v378);
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("BrightnessMinPhysicalWithFade")))
  {
    if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 320) & 1) != 0)
    {
      v109 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v109 == CFNumberGetTypeID())
      {
        v377 = 0.0;
        v377 = *(float *)(*(_QWORD *)(a1 + 56) + 396);
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v377);
        v376 = 0;
        if (_logHandle)
        {
          v108 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v107 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v107 = init_default_corebrightness_log();
          v108 = v107;
        }
        v376 = v108;
        v375 = OS_LOG_TYPE_DEBUG;
        if (os_log_type_enabled(v108, OS_LOG_TYPE_DEBUG))
        {
          __os_log_helper_16_2_2_8_32_8_0((uint64_t)v608, (uint64_t)"BrightnessMinPhysicalWithFade", COERCE__INT64(v377));
          _os_log_debug_impl(&dword_1B5291000, v376, v375, "DisplaySetProperty: %s = %f\n", v608, 0x16u);
        }
        if (getClientOverrideState(*(_QWORD *)(a1 + 56), 1))
          v377 = fmaxf(v377, *(float *)(*(_QWORD *)(a1 + 56) + 968));
        _DisplaySetBrightnessMinPhysicalWithFade(*(_QWORD *)(a1 + 56), v377, *(float *)(*(_QWORD *)(a1 + 56) + 372));
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessFactorRamp")))
  {
    v106 = CFDictionaryGetTypeID();
    if (v106 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v374 = 0;
      v374 = CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("DisplayBrightnessFactorCoeffA"));
      if (v374)
      {
        v105 = CFGetTypeID(v374);
        if (v105 == CFNumberGetTypeID())
        {
          v587 = *(float *)(*(_QWORD *)(a1 + 56) + 1420);
          CFNumberGetValue((CFNumberRef)v374, kCFNumberFloatType, &v587);
          *(float *)(*(_QWORD *)(a1 + 56) + 1420) = v587;
          *(float *)(*(_QWORD *)(a1 + 56) + 1416) = 1.0 - *(float *)(*(_QWORD *)(a1 + 56) + 1420);
          *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1412) = 0;
          v373 = 0;
          if (_logHandle)
          {
            v104 = _logHandle;
          }
          else
          {
            v103 = _COREBRIGHTNESS_LOG_DEFAULT ? _COREBRIGHTNESS_LOG_DEFAULT : init_default_corebrightness_log();
            v104 = v103;
          }
          v373 = v104;
          v372 = OS_LOG_TYPE_DEBUG;
          if (os_log_type_enabled(v104, OS_LOG_TYPE_DEBUG))
          {
            __os_log_helper_16_0_3_8_0_8_0_8_0((uint64_t)v607, COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 1420)), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 1416)), COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 1412)));
            _os_log_debug_impl(&dword_1B5291000, v373, v372, "DisplaySetProperty: Changing Factor ramp to: %fx^2 + %fx + %f\n", v607, 0x20u);
          }
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("PreStrobeDimPeriod")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v102 = CFNumberGetTypeID();
      if (v102 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v371 = 0;
        v371 = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 244);
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v371);
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 244) = v371;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CBSoftWakeActive")))
  {
    *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
    if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 328))
    {
      if (*(_QWORD *)(a1 + 40))
      {
        objc_opt_class();
        if ((objc_opt_isKindOfClass() & 1) != 0)
        {
          v370 = 0;
          v370 = objc_msgSend(*(id *)(a1 + 40), "intValue");
          if (!objc_msgSend(*(id *)(*(_QWORD *)(a1 + 56) + 328), "action:", v370))
          {
            __DisplaySetLogicalBrightnessInternal(*(const void **)(a1 + 56), 4098, *(float *)(*(_QWORD *)(a1 + 56) + 1256));
            *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 1;
          }
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CBSoftWakeFactorWithFadeKey")))
  {
    if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 328))
    {
      if ((objc_msgSend(*(id *)(*(_QWORD *)(a1 + 56) + 328), "isActive") & 1) != 0)
      {
        if (*(_QWORD *)(a1 + 40))
        {
          v101 = CFDictionaryGetTypeID();
          if (v101 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
          {
            v369 = 0;
            v369 = *(id *)(a1 + 40);
            v368 = (id)objc_msgSend(v369, "objectForKeyedSubscript:", CFSTR("DisplayBrightnessFactor"));
            v367 = (id)objc_msgSend(v369, "objectForKeyedSubscript:", CFSTR("DisplayBrightnessFadePeriod"));
            if (v368)
            {
              if (v367)
              {
                v99 = *(void **)(*(_QWORD *)(a1 + 56) + 328);
                objc_msgSend(v368, "floatValue");
                v100 = v16;
                objc_msgSend(v367, "floatValue");
                LODWORD(v18) = v17;
                LODWORD(v19) = v100;
                if (!objc_msgSend(v99, "setFactor:withFade:", v19, v18))
                {
                  LODWORD(v20) = 1015580809;
                  __DisplayStartFade(*(_BYTE **)(a1 + 56), v20);
                }
              }
            }
          }
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("PreStrobeConfig")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v98 = CFDictionaryGetTypeID();
      if (v98 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v366 = 0;
        v366 = *(CFDictionaryRef *)(a1 + 40);
        if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 248))
        {
          v364 = 0;
          v363 = 0;
          v365 = CFDictionaryGetValue(v366, CFSTR("PreStrobeConfigCurrent"));
          if (v365 && (v97 = CFNumberGetTypeID(), v97 == CFGetTypeID(v365)))
          {
            v364 = 1;
            v363 = 1;
          }
          else
          {
            v365 = CFDictionaryGetValue(v366, CFSTR("PreStrobeConfigNits"));
            if (v365)
            {
              v96 = CFNumberGetTypeID();
              if (v96 == CFGetTypeID(v365))
                v363 = 1;
            }
          }
          if ((v363 & 1) != 0)
          {
            v362 = -1.0;
            if (CFNumberGetValue((CFNumberRef)v365, kCFNumberFloatType, &v362))
            {
              v361 = (int)(float)(v362 * 65536.0);
              v360 = 0;
              v360 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberIntType, &v361);
              if (v360)
              {
                if ((v364 & 1) != 0)
                  v21 = CFSTR("PreStrobeConfigCurrent");
                else
                  v21 = CFSTR("PreStrobeConfigNits");
                __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), v21, v360);
                if ((v364 & 1) == 0)
                  *(_DWORD *)(*(_QWORD *)(a1 + 56) + 256) = v361;
                CFRelease(v360);
              }
            }
          }
          else
          {
            *(_DWORD *)(*(_QWORD *)(a1 + 56) + 256) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 252);
            v359 = -1;
            v358 = 0;
            v358 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberIntType, &v359);
            if (v358)
            {
              __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), CFSTR("PreStrobeConfigCurrent"), v358);
              CFRelease(v358);
            }
          }
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("PreStrobe")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v95 = CFNumberGetTypeID();
      if (v95 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v357 = 0.0;
        v357 = *(float *)(*(_QWORD *)(a1 + 56) + 244);
        v356 = 0;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v356);
        v355 = 0.0;
        if (v356)
          v94 = 0.0;
        else
          v94 = fmaxf(0.0, v357);
        v355 = v94;
        if (v357 >= 0.0)
        {
          v351 = 0.0;
          if (v356)
            v92 = *(float *)(*(_QWORD *)(a1 + 56) + 1312);
          else
            v92 = 0.0;
          v351 = v92;
          if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 248))
          {
            __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), CFSTR("PreStrobe"), *(const void **)(a1 + 40));
            SetPreStrobeState(*(_BYTE **)(a1 + 56), v356 != 0);
          }
          v350 = 0;
          if (v356)
            v91 = (int)(float)(*(float *)(*(_QWORD *)(a1 + 56) + 1312) * 65536.0);
          else
            v91 = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1128);
          v350 = v91;
          v349 = 0;
          if (_logHandle)
          {
            v90 = _logHandle;
          }
          else
          {
            if (_COREBRIGHTNESS_LOG_DEFAULT)
              v89 = _COREBRIGHTNESS_LOG_DEFAULT;
            else
              v89 = init_default_corebrightness_log();
            v90 = v89;
          }
          v349 = v90;
          v348 = 2;
          if (os_log_type_enabled(v90, OS_LOG_TYPE_DEBUG))
          {
            v87 = v349;
            v88 = v348;
            __os_log_helper_16_0_0(v347);
            _os_log_debug_impl(&dword_1B5291000, v87, v88, "SetBLDriverNitsCap for preStrobe", v347, 2u);
          }
          SetBLDriverNitsCapIfNotInLPM(*(_QWORD *)(a1 + 56), v350);
          _DisplaySetBrightnessMinPhysicalWithFade(*(_QWORD *)(a1 + 56), v351, v355);
        }
        else
        {
          if (v356 && *(int *)(*(_QWORD *)(a1 + 56) + 252) > 0)
          {
            v354 = 0;
            v93 = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 256) < *(_DWORD *)(*(_QWORD *)(a1 + 56) + 252)
                ? 44236800
                : *(_DWORD *)(*(_QWORD *)(a1 + 56) + 252);
            v354 = v93;
            if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 260) != v93)
            {
              *(_DWORD *)(*(_QWORD *)(a1 + 56) + 256) = v354;
              *(_DWORD *)(*(_QWORD *)(a1 + 56) + 260) = v354;
              v353 = 0;
              v353 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberIntType, &v354);
              if (v353)
              {
                __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), CFSTR("PreStrobeConfigNits"), v353);
                CFRelease(v353);
                v352 = 0.0;
                v352 = (float)v354 / (float)*(int *)(*(_QWORD *)(a1 + 56) + 252);
                v353 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberFloatType, &v352);
                if (v353)
                {
                  CFDictionarySetValue(*(CFMutableDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), CFSTR("PreStrobeBrightnessRatio"), v353);
                  CFRelease(v353);
                }
              }
            }
          }
          __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), CFSTR("PreStrobe"), *(const void **)(a1 + 40));
          SetPreStrobeState(*(_BYTE **)(a1 + 56), v356 != 0);
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("ColorFadesEnabled")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v346 = 0;
      v345 = 0;
      v86 = CFNumberGetTypeID();
      if (v86 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v344 = 0;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v344);
        v346 = v344 != 0;
        v345 = 1;
      }
      else
      {
        v85 = CFBooleanGetTypeID();
        if (v85 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
        {
          v346 = CFBooleanGetValue(*(CFBooleanRef *)(a1 + 40)) != 0;
          v345 = 1;
        }
      }
      if ((v345 & 1) == 1 && *(_QWORD *)(*(_QWORD *)(a1 + 56) + 12504))
        CFXEnableFades(*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12504), v346);
      else
        *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CarryLogEnabled")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v84 = CFNumberGetTypeID();
      if (v84 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v343 = 0;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v343);
        CFXEnableLog(*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12504), v343 != 0);
        if (CFPreferencesAppSynchronize((CFStringRef)*MEMORY[0x1E0C9B248]))
          CFPreferencesSetAppValue(CFSTR("CBCarryLogEnabled"), *(CFPropertyListRef *)(a1 + 40), (CFStringRef)*MEMORY[0x1E0C9B248]);
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CarryLogComment")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v83 = CFStringGetTypeID();
      if (v83 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
        CFXStoreComment(*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12504), *(const __CFString **)(a1 + 40));
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CarryLogCommit")))
  {
    CFXForceLogCommit(*(FILE **)(*(_QWORD *)(a1 + 56) + 12504));
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("FreezeBrightness")))
  {
    if (*(_DWORD *)(*(_QWORD *)(a1 + 56) + 36))
    {
      *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
    }
    else if (*(_QWORD *)(a1 + 40))
    {
      v82 = CFDictionaryGetTypeID();
      if (v82 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      {
        v342 = 0;
        v342 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("FreezeBrightnessPeriod"));
        if (v342)
        {
          v81 = CFNumberGetTypeID();
          if (v81 == CFGetTypeID(v342))
            CFNumberGetValue(v342, kCFNumberFloatType, (void *)(*(_QWORD *)(a1 + 56) + 12544));
        }
        v341 = 0;
        v342 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("FreezeBrightnessEnable"));
        if (v342 && (v80 = CFNumberGetTypeID(), v80 == CFGetTypeID(v342)))
        {
          v340 = 0;
          CFNumberGetValue(v342, kCFNumberIntType, &v340);
          v341 = v340 != 0;
        }
        else if (v342)
        {
          v79 = CFBooleanGetTypeID();
          if (v79 == CFGetTypeID(v342))
            v341 = CFBooleanGetValue(v342) != 0;
        }
        Count = 0;
        if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12536))
          Count = CFArrayGetCount(*(CFArrayRef *)(*(_QWORD *)(a1 + 56) + 12536));
        v338 = Count;
        if (Count > 0 || v341)
        {
          v342 = (const __CFNumber *)CFDictionaryGetValue(*(CFDictionaryRef *)(a1 + 40), CFSTR("FreezeBrightnessRequestors"));
          if (v342)
          {
            v78 = CFArrayGetTypeID();
            if (v78 == CFGetTypeID(v342))
            {
              v337 = v342;
              v336 = CFArrayGetCount(v342);
              if (v336 > 0)
              {
                if (v341 && !*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12536))
                  *(_QWORD *)(*(_QWORD *)(a1 + 56) + 12536) = CFArrayCreateMutable((CFAllocatorRef)*MEMORY[0x1E0C9AE00], v336, MEMORY[0x1E0C9B378]);
                if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12536))
                {
                  ValueAtIndex = 0;
                  for (i = 0; i < v336; ++i)
                  {
                    ValueAtIndex = CFArrayGetValueAtIndex(v337, i);
                    if (ValueAtIndex)
                    {
                      v333 = 0;
                      Count = CFArrayGetCount(*(CFArrayRef *)(*(_QWORD *)(a1 + 56) + 12536));
                      for (j = 0; j < Count; ++j)
                      {
                        v331 = 0;
                        v331 = CFArrayGetValueAtIndex(*(CFArrayRef *)(*(_QWORD *)(a1 + 56) + 12536), j);
                        if (CFEqual(ValueAtIndex, v331))
                        {
                          v333 = 1;
                          if (!v341)
                          {
                            CFArrayRemoveValueAtIndex(*(CFMutableArrayRef *)(*(_QWORD *)(a1 + 56) + 12536), j);
                            break;
                          }
                        }
                      }
                      if (v341 && (v333 & 1) == 0)
                        CFArrayAppendValue(*(CFMutableArrayRef *)(*(_QWORD *)(a1 + 56) + 12536), ValueAtIndex);
                    }
                  }
                }
              }
            }
          }
        }
        if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12536))
          v77 = CFArrayGetCount(*(CFArrayRef *)(*(_QWORD *)(a1 + 56) + 12536));
        else
          v77 = 0;
        Count = v77;
        if (v338 || Count <= 0)
        {
          if (v338 > 0 && !Count)
          {
            *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1256) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12556);
            *(_BYTE *)(*(_QWORD *)(a1 + 56) + 12548) = 0;
            v328 = 0;
            v328 = *(float *)(*(_QWORD *)(a1 + 56) + 12552) >= *(float *)(*(_QWORD *)(a1 + 56) + 1256);
            v327 = 0.0;
            v22 = 2.5;
            if (!v328)
              v22 = 5.0;
            v327 = v22;
            v604 = xmmword_1B546248C;
            v605 = -1820426635;
            v602 = xmmword_1B54624A0;
            v603 = -937652876;
            v326 = (MGIsDeviceOneOfType() & 1) != 0;
            v600 = xmmword_1B54624B4;
            v601 = 1874287171;
            v598 = xmmword_1B54624C8;
            v599 = -781324731;
            if ((MGIsDeviceOneOfType() & 1) != 0)
              v326 = 1;
            if (v326)
            {
              v325 = 0;
              v325 = (CFBooleanRef)CFDictionaryGetValue(*(CFDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), CFSTR("CBStoreDemoModeIsPresent"));
              if (v325)
              {
                if (CFBooleanGetValue(v325))
                {
                  v324 = 0;
                  if (_logHandle)
                  {
                    v74 = _logHandle;
                  }
                  else
                  {
                    if (_COREBRIGHTNESS_LOG_DEFAULT)
                      v73 = _COREBRIGHTNESS_LOG_DEFAULT;
                    else
                      v73 = init_default_corebrightness_log();
                    v74 = v73;
                  }
                  v324 = v74;
                  v323 = OS_LOG_TYPE_DEFAULT;
                  if (os_log_type_enabled(v74, OS_LOG_TYPE_DEFAULT))
                  {
                    __os_log_helper_16_0_2_8_0_8_0((uint64_t)v597, COERCE__INT64(v327), 0);
                    _os_log_impl(&dword_1B5291000, v324, v323, "Store Demo is present! The unfreeze period will be altered: %f -> %f.", v597, 0x16u);
                  }
                  v327 = 0.0;
                }
              }
            }
            v322 = 0;
            if (_logHandle)
            {
              v72 = _logHandle;
            }
            else
            {
              if (_COREBRIGHTNESS_LOG_DEFAULT)
                v71 = _COREBRIGHTNESS_LOG_DEFAULT;
              else
                v71 = init_default_corebrightness_log();
              v72 = v71;
            }
            v322 = v72;
            v321 = OS_LOG_TYPE_DEFAULT;
            if (os_log_type_enabled(v72, OS_LOG_TYPE_DEFAULT))
            {
              __os_log_helper_16_0_1_8_0((uint64_t)v596, COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 12552)));
              _os_log_impl(&dword_1B5291000, v322, v321, "The brightness has been unfrozen. L cached = %f", v596, 0xCu);
            }
            _DisplaySetLogicalBrightnessWithFade(*(_QWORD *)(a1 + 56), 74, 0, 0, *(float *)(*(_QWORD *)(a1 + 56) + 12552), v327);
          }
        }
        else
        {
          *(_BYTE *)(*(_QWORD *)(a1 + 56) + 12548) = 1;
          *(_DWORD *)(*(_QWORD *)(a1 + 56) + 12556) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1256);
          v330 = 0;
          if (_logHandle)
          {
            v76 = _logHandle;
          }
          else
          {
            if (_COREBRIGHTNESS_LOG_DEFAULT)
              v75 = _COREBRIGHTNESS_LOG_DEFAULT;
            else
              v75 = init_default_corebrightness_log();
            v76 = v75;
          }
          v330 = v76;
          v329 = OS_LOG_TYPE_DEFAULT;
          if (os_log_type_enabled(v76, OS_LOG_TYPE_DEFAULT))
          {
            __os_log_helper_16_0_1_8_0((uint64_t)v606, COERCE__INT64(*(float *)(*(_QWORD *)(a1 + 56) + 12556)));
            _os_log_impl(&dword_1B5291000, v330, v329, "The brightness has been frozen. L = %f", v606, 0xCu);
          }
        }
        Mutable = 0;
        Mutable = CFDictionaryCreateMutable((CFAllocatorRef)*MEMORY[0x1E0C9AE00], 2, MEMORY[0x1E0C9B390], MEMORY[0x1E0C9B3A0]);
        if (Mutable)
        {
          if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12536)
            && CFArrayGetCount(*(CFArrayRef *)(*(_QWORD *)(a1 + 56) + 12536)) > 0)
          {
            CFDictionarySetValue(Mutable, CFSTR("FreezeBrightnessRequestors"), *(const void **)(*(_QWORD *)(a1 + 56) + 12536));
          }
          v319 = 0;
          v319 = CFNumberCreate((CFAllocatorRef)*MEMORY[0x1E0C9AE00], kCFNumberFloatType, (const void *)(*(_QWORD *)(a1 + 56) + 12544));
          if (v319)
          {
            CFDictionarySetValue(Mutable, CFSTR("FreezeBrightnessPeriod"), v319);
            CFRelease(v319);
          }
          CFDictionarySetValue(*(CFMutableDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), *(const void **)(a1 + 48), Mutable);
          CFRelease(Mutable);
        }
        *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("PowerLogReportInterval")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v70 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v70 == CFNumberGetTypeID())
      {
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, (void *)(*(_QWORD *)(a1 + 56) + 12584));
        *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 1;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("ColorRampPeriodOverride")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v69 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v69 == CFNumberGetTypeID())
      {
        v318 = -1.0;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v318);
        CFXOverrideRampPeriod(*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12504), v318);
        *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 1;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DynamicSliderEnable")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v68 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v68 == CFNumberGetTypeID())
      {
        v317 = 1;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v317);
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1048) = v317 == 0;
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1120) = v317 == 0;
        if (!v317)
        {
          if (*(double *)(*(_QWORD *)(a1 + 56) + 1064) > 0.0)
          {
            *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1056) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1080);
            *(_QWORD *)(*(_QWORD *)(a1 + 56) + 1064) = 0;
          }
          if (*(double *)(*(_QWORD *)(a1 + 56) + 992) > 0.0)
          {
            *(_DWORD *)(*(_QWORD *)(a1 + 56) + 984) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1008);
            *(_QWORD *)(*(_QWORD *)(a1 + 56) + 992) = 0;
          }
        }
        __DisplaySetLogicalBrightnessInternal(*(const void **)(a1 + 56), 12290, *(float *)(*(_QWORD *)(a1 + 56) + 1256));
        *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 1;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessForceUpdates")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v67 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v67 == CFNumberGetTypeID())
      {
        v316 = 1;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberIntType, &v316);
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1284) = v316 != 0;
        *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 1;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("BrightnessGlobalScalar")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v66 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v66 == CFDictionaryGetTypeID())
      {
        GlobalScalarFromDictionary = 0.0;
        GlobalScalarFromDictionary = _DisplayGetGlobalScalarFromDictionary(*(_QWORD *)(a1 + 56), *(_DWORD *)(*(_QWORD *)(a1 + 56) + 80), *(const __CFDictionary **)(a1 + 40));
        if (GlobalScalarFromDictionary > 0.0)
          *(float *)(*(_QWORD *)(a1 + 56) + 1140) = GlobalScalarFromDictionary;
        *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
      }
    }
  }
  else if (*(_QWORD *)(a1 + 40) && CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("ProductTypeAccessory")))
  {
    v65 = CFBooleanGetTypeID();
    if (v65 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      *(_BYTE *)(*(_QWORD *)(a1 + 56) + 312) = CFBooleanGetValue(*(CFBooleanRef *)(a1 + 40)) != 0;
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("PCCEnable")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v64 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v64 == CFNumberGetTypeID())
      {
        v314 = -1.0;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v314);
        if (v314 >= 0.0)
          __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), CFSTR("pcc-enable"), (const void *)*MEMORY[0x1E0C9AE50]);
        else
          __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), CFSTR("pcc-enable"), (const void *)*MEMORY[0x1E0C9AE40]);
        v313 = 0;
        if (_logHandle)
        {
          v63 = _logHandle;
        }
        else
        {
          v62 = _COREBRIGHTNESS_LOG_DEFAULT ? _COREBRIGHTNESS_LOG_DEFAULT : init_default_corebrightness_log();
          v63 = v62;
        }
        v313 = v63;
        v312 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v63, OS_LOG_TYPE_DEFAULT))
        {
          if (v314 == 0.0)
            v23 = "disabled";
          else
            v23 = "enabled";
          __os_log_helper_16_2_1_8_32((uint64_t)v595, (uint64_t)v23);
          _os_log_impl(&dword_1B5291000, v313, v312, "PCC %s", v595, 0xCu);
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("PCCBrightness")))
  {
    if (*(_QWORD *)(a1 + 40))
    {
      v61 = CFGetTypeID(*(CFTypeRef *)(a1 + 40));
      if (v61 == CFNumberGetTypeID())
      {
        v311 = -1.0;
        CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v311);
        if (v311 >= 0.0)
        {
          v310 = 0;
          if (_logHandle)
          {
            v60 = _logHandle;
          }
          else
          {
            if (_COREBRIGHTNESS_LOG_DEFAULT)
              v59 = _COREBRIGHTNESS_LOG_DEFAULT;
            else
              v59 = init_default_corebrightness_log();
            v60 = v59;
          }
          v310 = v60;
          v309 = OS_LOG_TYPE_DEFAULT;
          if (os_log_type_enabled(v60, OS_LOG_TYPE_DEFAULT))
          {
            __os_log_helper_16_0_1_8_0((uint64_t)v594, COERCE__INT64(v311));
            _os_log_impl(&dword_1B5291000, v310, v309, "Set PCC brightness = %f", v594, 0xCu);
          }
          v308 = (int)(float)(v311 * 65536.0);
          v307 = 0;
          v58 = CFGetAllocator(*(CFTypeRef *)(a1 + 56));
          v307 = CFNumberCreate(v58, kCFNumberSInt32Type, &v308);
          if (v307)
          {
            __DisplaySetBLDriverProperty(*(_QWORD *)(a1 + 56), CFSTR("pcc-brightness"), v307);
            CFRelease(v307);
          }
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CoreBrightnessFeaturesDisabled")))
  {
    v306 = 0;
    v306 = *(id *)(a1 + 40);
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) != 0)
    {
      if (objc_msgSend(v306, "objectForKey:", CFSTR("OverrideBrightnessWithFixedNits"))
        || objc_msgSend(v306, "objectForKey:", CFSTR("OverrideBrightnessWithFixedSliderPosition")))
      {
        v305 = (id)objc_msgSend(v306, "objectForKey:", CFSTR("OverrideBrightnessWithFixedNits"));
        v304 = (id)objc_msgSend(v306, "objectForKey:", CFSTR("OverrideBrightnessWithFixedSliderPosition"));
        v303 = 0.0;
        objc_opt_class();
        if ((objc_opt_isKindOfClass() & 1) != 0)
        {
          objc_msgSend(v305, "floatValue");
          v303 = v24;
        }
        else
        {
          v302 = 1.0;
          objc_opt_class();
          if ((objc_opt_isKindOfClass() & 1) != 0)
          {
            objc_msgSend(v304, "floatValue");
            v302 = v25;
          }
          else
          {
            v302 = 1.0;
          }
          v303 = _DisplaySliderToLogicalBrightnessInternal(*(_QWORD *)(a1 + 56), v302);
        }
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1504) = 1;
        v301 = 0;
        v301 = (int)(float)(*(float *)(*(_QWORD *)(a1 + 56) + 1312) * 65536.0);
        SetBLDriverNitsCap(*(const void **)(a1 + 56), v301);
        v300 = (int)(float)(v303 * 65536.0);
        v299 = 0;
        if (_logHandle)
        {
          v57 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v56 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v56 = init_default_corebrightness_log();
          v57 = v56;
        }
        v299 = v57;
        v298 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v57, OS_LOG_TYPE_DEFAULT))
        {
          __os_log_helper_16_0_1_8_0((uint64_t)v593, COERCE__INT64(v303));
          _os_log_impl(&dword_1B5291000, v299, v298, "Display.m CoreBrightnessFeaturesDisabled overriden brightness, desired fixed brightness is = %f", v593, 0xCu);
        }
        SetBLDriverNitsValue(*(float **)(a1 + 56), v300);
      }
      else
      {
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 1504) = 0;
        SetBLDriverNitsCapIfNotInLPM(*(_QWORD *)(a1 + 56), *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1512));
        SetBLDriverNitsValueIfNotInLPM(*(_QWORD *)(a1 + 56), *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1508));
        v297 = 0;
        if (_logHandle)
        {
          v55 = _logHandle;
        }
        else
        {
          if (_COREBRIGHTNESS_LOG_DEFAULT)
            v54 = _COREBRIGHTNESS_LOG_DEFAULT;
          else
            v54 = init_default_corebrightness_log();
          v55 = v54;
        }
        v297 = v55;
        v296 = OS_LOG_TYPE_DEFAULT;
        if (os_log_type_enabled(v55, OS_LOG_TYPE_DEFAULT))
        {
          v52 = v297;
          v53 = v296;
          __os_log_helper_16_0_0(v295);
          _os_log_impl(&dword_1B5291000, v52, v53, "Display.m CoreBrightnessFeaturesDisabled brightness override off", v295, 2u);
        }
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("BrightDotsMitigationParameters")))
  {
    v294 = 0;
    v294 = *(id *)(a1 + 40);
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) != 0)
    {
      if (objc_msgSend(v294, "objectForKey:", CFSTR("brightDotsMitigationLux1"))
        && objc_msgSend(v294, "objectForKey:", CFSTR("brightDotsMitigationLux2"))
        && objc_msgSend(v294, "objectForKey:", CFSTR("brightDotsMitigationNits1"))
        && objc_msgSend(v294, "objectForKey:", CFSTR("brightDotsMitigationNits2")))
      {
        objc_msgSend((id)objc_msgSend(v294, "objectForKey:", CFSTR("brightDotsMitigationLux1")), "floatValue");
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1152) = v26;
        objc_msgSend((id)objc_msgSend(v294, "objectForKey:", CFSTR("brightDotsMitigationLux2")), "floatValue");
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1160) = v27;
        objc_msgSend((id)objc_msgSend(v294, "objectForKey:", CFSTR("brightDotsMitigationNits1")), "floatValue");
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1156) = v28;
        objc_msgSend((id)objc_msgSend(v294, "objectForKey:", CFSTR("brightDotsMitigationNits2")), "floatValue");
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1164) = v29;
      }
      if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 192))
      {
        v293 = 0;
        v293 = *(id *)(*(_QWORD *)(a1 + 56) + 192);
        objc_msgSend(v293, "setObject:forKey:", v294, CFSTR("BrightDotsMitigationParameters"));
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("FullBrightnessRangeOverrideEnabled")))
  {
    v292 = 0;
    v292 = *(id *)(a1 + 40);
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) != 0)
    {
      if (objc_msgSend(v292, "objectForKey:", CFSTR("Status"))
        && (objc_msgSend((id)objc_msgSend(v292, "objectForKey:", CFSTR("Status")), "BOOLValue") & 1) != 0)
      {
        DisplayEnableFullBrightnessRangeAccessOverride(*(_QWORD *)(a1 + 56), 1);
      }
      else
      {
        DisplayEnableFullBrightnessRangeAccessOverride(*(_QWORD *)(a1 + 56), 0);
      }
      if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 192))
      {
        v291 = 0;
        v291 = *(id *)(*(_QWORD *)(a1 + 56) + 192);
        objc_msgSend(v291, "setObject:forKey:", v292, CFSTR("FullBrightnessRangeOverrideEnabled"));
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplaySyncBrightnessTransactions")))
  {
    v51 = CFBooleanGetTypeID();
    if (v51 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      *(_BYTE *)(*(_QWORD *)(a1 + 56) + 321) = CFBooleanGetValue(*(CFBooleanRef *)(a1 + 40)) != 0;
      if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 321) & 1) != 0)
      {
        *(_DWORD *)(*(_QWORD *)(a1 + 56) + 136) = 0;
        *(_QWORD *)(*(_QWORD *)(a1 + 56) + 208) = -[CBFrameLink initWithDisplay:andQueue:]([CBFrameLink alloc], "initWithDisplay:andQueue:", *(_QWORD *)(a1 + 56), *(_QWORD *)(*(_QWORD *)(a1 + 56) + 144));
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayFasterEDREngaged")))
  {
    v50 = CFBooleanGetTypeID();
    if (v50 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)) && (*(_BYTE *)(*(_QWORD *)(a1 + 56) + 321) & 1) != 0)
    {
      *(_BYTE *)(*(_QWORD *)(a1 + 56) + 322) = CFBooleanGetValue(*(CFBooleanRef *)(a1 + 40)) != 0;
      if ((*(_BYTE *)(*(_QWORD *)(a1 + 56) + 322) & 1) != 0)
      {
        __DisplayStartAPLCPMSTimer(*(dispatch_object_t **)(a1 + 56), 1.0);
      }
      else if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 12112))
      {
        __DisplayProcessHDRStatusForCoreAnalytics(*(_QWORD *)(a1 + 56));
        dispatch_release(*(dispatch_object_t *)(*(_QWORD *)(a1 + 56) + 12112));
        *(_QWORD *)(*(_QWORD *)(a1 + 56) + 12112) = 0;
        *(_QWORD *)(*(_QWORD *)(a1 + 56) + 12088) = 0;
        *(_QWORD *)(*(_QWORD *)(a1 + 56) + 12096) = 0;
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessMinRefreshRate")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 384);
    v49 = CFNumberGetTypeID();
    if (v49 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
    *(float *)(*(_QWORD *)(a1 + 56) + 384) = v587;
    oslog = 0;
    if (_logHandle)
    {
      v48 = _logHandle;
    }
    else
    {
      if (_COREBRIGHTNESS_LOG_DEFAULT)
        v47 = _COREBRIGHTNESS_LOG_DEFAULT;
      else
        v47 = init_default_corebrightness_log();
      v48 = v47;
    }
    oslog = v48;
    v289 = OS_LOG_TYPE_DEBUG;
    if (os_log_type_enabled(v48, OS_LOG_TYPE_DEBUG))
    {
      __os_log_helper_16_2_2_8_32_8_0((uint64_t)v592, (uint64_t)"DisplayBrightnessMinRefreshRate", COERCE__INT64(v587));
      _os_log_debug_impl(&dword_1B5291000, oslog, v289, "MinRefreshRate: %s = %f\n", v592, 0x16u);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessMaxRefreshRate")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 388);
    v46 = CFNumberGetTypeID();
    if (v46 != CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
      return;
    CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v587);
    *(float *)(*(_QWORD *)(a1 + 56) + 388) = v587;
    v288 = 0;
    if (_logHandle)
    {
      v45 = _logHandle;
    }
    else
    {
      if (_COREBRIGHTNESS_LOG_DEFAULT)
        v44 = _COREBRIGHTNESS_LOG_DEFAULT;
      else
        v44 = init_default_corebrightness_log();
      v45 = v44;
    }
    v288 = v45;
    v287 = OS_LOG_TYPE_DEBUG;
    if (os_log_type_enabled(v45, OS_LOG_TYPE_DEBUG))
    {
      __os_log_helper_16_2_2_8_32_8_0((uint64_t)v591, (uint64_t)"DisplayBrightnessMaxRefreshRate", COERCE__INT64(v587));
      _os_log_debug_impl(&dword_1B5291000, v288, v287, "MaxRefreshRate: %s = %f\n", v591, 0x16u);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AuroraRamp")))
  {
    v587 = *(float *)(*(_QWORD *)(a1 + 56) + 12944);
    v286 = 0.0;
    v285 = 0;
    v285 = *(id *)(a1 + 40);
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) != 0)
    {
      v284 = (id)objc_msgSend(v285, "objectForKey:", CFSTR("Factor"));
      if (v284)
      {
        objc_opt_class();
        if ((objc_opt_isKindOfClass() & 1) != 0)
        {
          objc_msgSend(v284, "floatValue");
          v587 = v30;
        }
      }
      v283 = (id)objc_msgSend(v285, "objectForKey:", CFSTR("Period"));
      if (v283)
      {
        objc_opt_class();
        if ((objc_opt_isKindOfClass() & 1) != 0)
        {
          objc_msgSend(v283, "floatValue");
          v286 = v31;
        }
      }
      _DisplaySetAuroraFactorWithFade(*(_QWORD *)(a1 + 56), v587, v286);
      if (*(_QWORD *)(*(_QWORD *)(a1 + 56) + 192))
      {
        v282 = 0;
        v282 = *(id *)(*(_QWORD *)(a1 + 56) + 192);
        objc_msgSend(v282, "setObject:forKey:", v285, CFSTR("AuroraRamp"));
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AuroraCLTMActivationThreshold")))
  {
    v43 = CFNumberGetTypeID();
    if (v43 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      objc_msgSend(*(id *)(a1 + 40), "floatValue");
      *(_DWORD *)(*(_QWORD *)(a1 + 56) + 13016) = v32;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AuroraRampUpTimeSecondsPerStop")))
  {
    v42 = CFNumberGetTypeID();
    if (v42 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      objc_msgSend(*(id *)(a1 + 40), "floatValue");
      *(_DWORD *)(*(_QWORD *)(a1 + 56) + 13020) = v33;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("AuroraRampDownTimeSecondsPerStop")))
  {
    v41 = CFNumberGetTypeID();
    if (v41 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      objc_msgSend(*(id *)(a1 + 40), "floatValue");
      *(_DWORD *)(*(_QWORD *)(a1 + 56) + 13024) = v34;
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("ExternalRampIsRunning")))
  {
    v281 = 0;
    v281 = *(_QWORD *)(a1 + 40);
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) != 0)
      objc_msgSend(*(id *)(*(_QWORD *)(a1 + 56) + 264), "handleRampStart:", v281);
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("ExternalRampHasFinished")))
  {
    v280 = 0;
    v280 = *(_QWORD *)(a1 + 40);
    objc_opt_class();
    if ((objc_opt_isKindOfClass() & 1) != 0)
      objc_msgSend(*(id *)(*(_QWORD *)(a1 + 56) + 264), "handleRampEnd:", v280);
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayDisplayStartFade")))
  {
    v40 = CFNumberGetTypeID();
    if (v40 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      v39 = *(_BYTE **)(a1 + 56);
      objc_msgSend(*(id *)(a1 + 40), "floatValue");
      __DisplayStartFade(v39, v35);
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayBrightnessFadePeriodOverride")))
  {
    v279 = 0.0;
    v279 = *(float *)(*(_QWORD *)(a1 + 56) + 376);
    v38 = CFNumberGetTypeID();
    if (v38 == CFGetTypeID(*(CFTypeRef *)(a1 + 40)))
    {
      CFNumberGetValue(*(CFNumberRef *)(a1 + 40), kCFNumberFloatType, &v279);
      if (v279 < 0.0)
      {
        *(float *)(*(_QWORD *)(a1 + 56) + 376) = v279;
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 380) = 0;
      }
      else
      {
        *(float *)(*(_QWORD *)(a1 + 56) + 376) = v279;
        *(_BYTE *)(*(_QWORD *)(a1 + 56) + 380) = 1;
      }
      if (_logHandle)
      {
        v37 = _logHandle;
      }
      else
      {
        v36 = _COREBRIGHTNESS_LOG_DEFAULT ? _COREBRIGHTNESS_LOG_DEFAULT : init_default_corebrightness_log();
        v37 = v36;
      }
      if (os_log_type_enabled(v37, OS_LOG_TYPE_DEBUG))
      {
        __os_log_helper_16_2_2_8_32_8_0((uint64_t)v590, (uint64_t)"DisplayBrightnessFadePeriodOverride", COERCE__INT64(v279));
        _os_log_debug_impl(&dword_1B5291000, v37, OS_LOG_TYPE_DEBUG, "FadePeriodOverride: %s = %f\n", v590, 0x16u);
      }
    }
  }
  else if (CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("DisplayPowerOff")))
  {
    __ShortcutAllRamps(*(_BYTE **)(a1 + 56));
    if (*(float *)(*(_QWORD *)(a1 + 56) + 1204) > 0.0)
      *(_DWORD *)(*(_QWORD *)(a1 + 56) + 1256) = 0;
  }
  else if (!CFEqual(*(CFTypeRef *)(a1 + 48), CFSTR("CBStoreDemoModeIsPresent")))
  {
    *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 0;
  }
  if (*(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) == 1 && *(_QWORD *)(a1 + 40))
    CFDictionarySetValue(*(CFMutableDictionaryRef *)(*(_QWORD *)(a1 + 56) + 192), *(const void **)(a1 + 48), *(const void **)(a1 + 40));
  if (*(float *)(*(_QWORD *)(a1 + 56) + 348) == 0.0)
    *(_DWORD *)(*(_QWORD *)(a1 + 56) + 356) = *(_DWORD *)(*(_QWORD *)(a1 + 56) + 336);
  *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 8) + 24) = 1;
}

uint64_t __DisplaySetProperty_block_invoke_319(_QWORD *a1)
{
  uint64_t result;

  result = __DisplayGetPowerAccumulatorDCP(a1[6], (_QWORD *)(*(_QWORD *)(a1[5] + 8) + 24));
  *(_QWORD *)(*(_QWORD *)(a1[4] + 8) + 24) = result;
  return result;
}

void __DisplaySetProperty_block_invoke_419(uint64_t a1)
{
  if (*(_QWORD *)(*(_QWORD *)(a1 + 32) + 16))
    (*(void (**)(_QWORD, const __CFString *, _QWORD))(*(_QWORD *)(a1 + 32) + 16))(*(_QWORD *)(*(_QWORD *)(a1 + 32) + 24), CFSTR("BrightnessCLTMMode"), *(_QWORD *)(a1 + 40));
  CFRelease(*(CFTypeRef *)(a1 + 40));
}

@end
