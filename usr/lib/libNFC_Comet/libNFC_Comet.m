uint64_t sub_21984E8F8(uint64_t a1, int a2, unsigned __int8 *a3, uint64_t a4)
{
  unsigned int *v8;
  uint64_t v9;
  int v10;
  int v11;
  uint64_t v12;
  uint64_t v13;
  int v14;
  uint64_t v15;
  int v16;
  const char *v17;
  uint64_t v18;
  unsigned __int8 *v19;
  int v20;
  uint64_t v21;
  uint64_t v22;
  uint64_t v23;
  uint64_t v24;
  const char *v26;
  _BYTE *v27;
  unsigned int v28;
  unsigned __int8 *v29;
  int *v30;
  unsigned int v31;
  unsigned __int8 *v32;
  uint64_t v33;
  unsigned int v34;
  int *v35;
  int v36;
  int *v37;
  unsigned __int8 *v38;
  char v39;
  int v40;
  _QWORD *v41;
  uint64_t v42;
  unsigned __int8 *v43;
  const char *v44;
  uint64_t v45;
  const char *v46;
  const char *v47;
  char v48;
  uint64_t (**v49)();
  uint64_t (*v50)();
  uint64_t Memory;
  uint64_t v52;
  char v53;
  uint64_t (**v54)();
  uint64_t (*v55)();
  int v56;
  int v57;
  uint64_t (**v58)();
  uint64_t (*v59)();
  unsigned int v60;
  __int128 v61;
  __int128 v62;
  uint64_t v63;

  v63 = 0;
  v61 = 0u;
  v62 = 0u;
  v60 = 162;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SENtfHandler");
  if (!a1)
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Invalid Context Param received!!");
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SENtfHandler");
  }
  v8 = (unsigned int *)(a1 + 19368);
  phOsalNfc_SetMemory();
  switch(a2)
  {
    case 1:
      v9 = *((_QWORD *)a3 + 1);
      v10 = a3[1];
      if (v10 != 2 && v10 != 192 && (v10 != 129 || *(_BYTE *)(a1 + 2936) != 1))
      {
        v9 = 0;
        v11 = 1;
        goto LABEL_68;
      }
      if (*a3 == 1)
      {
        sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE Disc Ntf Connected ID = ");
        v9 = 0;
        v11 = 0;
LABEL_68:
        v12 = 6;
        goto LABEL_139;
      }
      LODWORD(v61) = 15;
      if (v9 && *(_BYTE *)(v9 + 24))
        sub_2198E0330((unsigned int *)a1, (uint64_t)&v61, v9);
      v11 = 1;
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE removed Ntf received with reason code");
      if (*(_QWORD *)(a1 + 6696))
      {
        v20 = sub_2198DD268(a1);
        if (sub_2198D23DC(*(_QWORD *)(a1 + 19360)) == 4
          || sub_2198D23DC(*(_QWORD *)(a1 + 19360)) == 8
          || sub_2198D23DC(*(_QWORD *)(a1 + 19360)) == 7
          || (v21 = a4, v20 == 111))
        {
          v21 = a4;
          if (!sub_2198D2574(*(_QWORD *)(a1 + 19360)))
          {
            v21 = a4;
            if (!*(_BYTE *)(a1 + 507))
            {
              v21 = a4;
              if (!*(_BYTE *)(a1 + 2944))
              {
                v21 = a4;
                if (!*(_QWORD *)(a1 + 6680))
                {
                  sub_2198D27D4(*(_QWORD *)(a1 + 19360), 1);
                  v21 = 131;
                }
              }
            }
          }
        }
        sub_219853E34(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_SENtfHandler :NFCEE Removed Ntf");
        v12 = 16;
        (*(void (**)(_QWORD, _QWORD, uint64_t, uint64_t, __int128 *, uint64_t))(a1 + 6696))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6704), 16, v9, &v61, v21);
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"eSE NFCEE Disc Ntf pSeListenerNtfCb invoked");
        v11 = 0;
      }
      else
      {
        v12 = 16;
      }
LABEL_139:
      sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateSeInfo");
      if ((_DWORD)a4)
      {
        sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phLibNfc_UpdateSeInfo:Invalid Input Parameters");
LABEL_141:
        sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateSeInfo");
        v11 = 0;
        goto LABEL_96;
      }
      v27 = *(_BYTE **)(a1 + 464);
      if (*a3 || !v27)
      {
        if (*a3 != 1)
          goto LABEL_141;
        v31 = a3[1];
        if (v31 <= 0x80)
        {
          if (v31 == 1)
          {
            if (*(_BYTE *)(a1 + 696) == 1)
            {
              phOsalNfc_SetMemory();
              *(_QWORD *)(a1 + 344) = *((_QWORD *)a3 + 1);
              *(_QWORD *)(a1 + 512) = a1 + 344;
              *(_BYTE *)(a1 + 315) = 1;
              *(_DWORD *)(a1 + 352) = 4;
              *(_WORD *)(a1 + 321) = 260;
              if (*(_QWORD *)(a1 + 464))
              {
                phOsalNfc_SetMemory();
                sub_21988FBB0(*v8, (uint64_t)v27);
                v41 = *(_QWORD **)(a1 + 464);
                v41[99] = *(_QWORD *)(a1 + 3040);
                v41[120] = a1;
                v42 = *(_QWORD *)(a1 + 344);
                v41[100] = v42;
              }
              else
              {
                Memory = phOsalNfc_GetMemory();
                if (Memory)
                {
                  v52 = Memory;
                  phOsalNfc_SetMemory();
                  sub_21988FBB0(*v8, v52);
                  *(_QWORD *)(v52 + 792) = *(_QWORD *)(a1 + 3040);
                  *(_QWORD *)(v52 + 960) = a1;
                  *(_QWORD *)(a1 + 464) = v52;
                  *(_QWORD *)(v52 + 152) = 0;
                  v42 = *(_QWORD *)(a1 + 344);
                  *(_QWORD *)(v52 + 800) = v42;
                  *(_BYTE *)(v52 + 968) = 1;
                  *(_BYTE *)(v52 + 1235) = 0;
                }
                else
                {
                  if (!*(_QWORD *)(a1 + 464))
                    goto LABEL_254;
                  v42 = *(_QWORD *)(a1 + 344);
                }
              }
              *(_WORD *)(a1 + 504) = 0;
              *(_BYTE *)(a1 + 506) = 0;
              *(_QWORD *)(a1 + 472) = v42;
              ++*(_BYTE *)(a1 + 314);
              *(_QWORD *)(a1 + 2912) = off_2550A36D8;
              *(_BYTE *)(a1 + 2904) = 0;
              *(_BYTE *)(a1 + 2906) = 0;
              v53 = (char)off_2550A36D8[0];
              if (off_2550A36D8[0])
              {
                v53 = 0;
                v54 = off_2550A36E8;
                do
                {
                  ++v53;
                  v55 = *v54;
                  v54 += 2;
                }
                while (v55);
              }
              *(_BYTE *)(a1 + 2905) = v53;
              if (sub_2198655FC(a1, 0, 0) != 13)
              {
                sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Hci init sequence could not start!");
                sub_2198DC7F0(a1);
              }
              goto LABEL_253;
            }
            v44 = "NFCEE DISC NTF(HCI N/W,Connected)Received and Dropped";
            goto LABEL_214;
          }
          if (v31 == 2)
          {
            if (*(_BYTE *)(a1 + 696) == 1)
            {
              if (*(_BYTE *)(a1 + 317) == 1)
                goto LABEL_141;
              *(_BYTE *)(a1 + 505) = 0;
              ++*(_BYTE *)(a1 + 314);
              v32 = (unsigned __int8 *)*((_QWORD *)a3 + 1);
              *(_QWORD *)(a1 + 376) = v32;
              if (!v32)
              {
LABEL_254:
                v56 = (*(_BYTE *)(a1 + 318) & 3) << 22;
                v57 = (*(_BYTE *)(a1 + 317) & 3) << 20;
                if (*v8)
                {
                  dword_253E4715C = v56 | dword_253E4715C & 0xFF0FFFFF | v57;
                  if (*(_BYTE *)(a1 + 2936) == 1)
                    dword_253E47158 = dword_253E47158 & 0xFFFFFFCF | (16 * (*(_BYTE *)(a1 + 319) & 3));
                  else
                    dword_253E47158 &= 0xFFFFFFCF;
                }
                else
                {
                  dword_253E47074 = v56 | dword_253E47074 & 0xFF0FFFFF | v57;
                  if (*(_BYTE *)(a1 + 2936) == 1)
                    dword_253E47070 = dword_253E47070 & 0xFFFFFFCF | (16 * (*(_BYTE *)(a1 + 319) & 3));
                  else
                    dword_253E47070 &= 0xFFFFFFCF;
                }
                goto LABEL_141;
              }
              *(_BYTE *)(a1 + 317) = 1;
              *(_DWORD *)(a1 + 388) = *(_DWORD *)(*((_QWORD *)a3 + 1) + 4) != 1;
              *(_DWORD *)(a1 + 384) = 2;
              if (*(_BYTE *)(a1 + 322) == 2)
              {
                if (sub_2198E0040(a1, 2u) != 13)
                  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"UICC init sequence could not start!");
                *(_BYTE *)(a1 + 321) = 2;
                goto LABEL_254;
              }
LABEL_253:
              sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_UpdateSeInfo:Initialization in Progress for:");
              goto LABEL_254;
            }
            v44 = "NFCEE DISC NTF(UICC,Connected)Received and Dropped";
LABEL_214:
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)v44);
            goto LABEL_141;
          }
LABEL_205:
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_UpdateSeInfo:Unkown Nfcee Id");
          *(_WORD *)(a1 + 321) = 0;
          goto LABEL_141;
        }
        if (v31 == 129)
        {
          if (*(_BYTE *)(a1 + 696) != 1)
          {
            v44 = "NFCEE DISC NTF(SE2 Connected)Received and Dropped";
            goto LABEL_214;
          }
          if (*(_BYTE *)(a1 + 2936) != 1 || *(_BYTE *)(a1 + 319) == 1)
            goto LABEL_254;
          *(_BYTE *)(a1 + 506) = 0;
          ++*(_BYTE *)(a1 + 314);
          v43 = (unsigned __int8 *)*((_QWORD *)a3 + 1);
          *(_QWORD *)(a1 + 408) = v43;
          if (v43)
          {
            *(_BYTE *)(a1 + 319) = 1;
            *(_DWORD *)(a1 + 420) = *(_DWORD *)(*((_QWORD *)a3 + 1) + 4) != 1;
            *(_DWORD *)(a1 + 416) = 7;
          }
          if (*(_BYTE *)(a1 + 322) != 2)
            goto LABEL_253;
          if (sub_2198E0040(a1, 4u) != 13)
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"UICC init sequence could not start!");
          v39 = 7;
        }
        else
        {
          if (v31 != 192)
            goto LABEL_205;
          if (*v8)
            v37 = &dword_253E47158;
          else
            v37 = &dword_253E47070;
          v37[1] &= ~0x80000000;
          if (*(_BYTE *)(a1 + 696) != 1)
          {
            v44 = "NFCEE DISC NTF(eSE,Connected)Received and Dropped";
            goto LABEL_214;
          }
          if (*(_BYTE *)(a1 + 318) == 1 || *(_BYTE *)(a1 + 507))
            goto LABEL_141;
          *(_BYTE *)(a1 + 504) = 0;
          ++*(_BYTE *)(a1 + 314);
          v38 = (unsigned __int8 *)*((_QWORD *)a3 + 1);
          *(_QWORD *)(a1 + 392) = v38;
          if (!v38)
            goto LABEL_254;
          *(_BYTE *)(a1 + 318) = 1;
          *(_DWORD *)(a1 + 400) = 1;
          *(_DWORD *)(a1 + 404) = *(_DWORD *)(*((_QWORD *)a3 + 1) + 4) != 1;
          if (*(_BYTE *)(a1 + 322) != 2)
            goto LABEL_253;
          if (sub_2198E0040(a1, 3u) != 13)
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)" eSE init sequence could not start!");
          v39 = 1;
        }
        *(_BYTE *)(a1 + 321) = v39;
        goto LABEL_254;
      }
      v28 = a3[1];
      if (v28 <= 0x80)
      {
        if (v28 == 1)
        {
          if (*(_BYTE *)(a1 + 321) == 4)
            *(_BYTE *)(a1 + 321) = 4;
          goto LABEL_141;
        }
        if (v28 == 2)
        {
          *(_QWORD *)(a1 + 376) = *((_QWORD *)a3 + 1);
          sub_2198D2A2C(*(_QWORD *)(a1 + 19360), 2u, 5);
          *(_QWORD *)(a1 + 384) = 0x400000002;
          v27[834] = -1;
          *(_BYTE *)(a1 + 505) = 0;
          v29 = (unsigned __int8 *)*((_QWORD *)a3 + 1);
          *(_QWORD *)(a1 + 376) = v29;
          *(_BYTE *)(a1 + 317) = 2;
          if (*v8)
            v30 = &dword_253E47158;
          else
            v30 = &dword_253E47070;
          v30[1] = v30[1] & 0xFFCFFFFF | 0x200000;
          sub_21989AABC(a1);
          goto LABEL_265;
        }
LABEL_188:
        sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_UpdateSeInfo:Unknown NFCEE ID");
        goto LABEL_141;
      }
      if (v28 != 129)
      {
        if (v28 != 192)
          goto LABEL_188;
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"######## Received eSE Removed Notification ##########");
        v33 = a1 + 392;
        *(_DWORD *)(a1 + 700) = *(_DWORD *)(a1 + 404);
        *(_QWORD *)(a1 + 400) = 0x400000001;
        sub_2198D2A2C(*(_QWORD *)(a1 + 19360), 1u, 5);
        sub_219886108(*(_QWORD *)(a1 + 19360), 214);
        v34 = *v8;
        v35 = &dword_253E47158;
        if (!*v8)
          v35 = &dword_253E47070;
        v35[1] |= 0x80000000;
        *(_BYTE *)(a1 + 504) = 0;
        v27[818] = -1;
        v27[816] = -1;
        v29 = (unsigned __int8 *)*((_QWORD *)a3 + 1);
        *(_QWORD *)(a1 + 392) = v29;
        *(_BYTE *)(a1 + 318) = 2;
        v36 = (*(_BYTE *)(a1 + 317) & 3) << 20;
        if (v34)
        {
          dword_253E4715C = v36 | dword_253E4715C & 0xFF0FFFFF | 0x800000;
          if (*(_BYTE *)(a1 + 2936) == 1)
            dword_253E47158 = dword_253E47158 & 0xFFFFFFCF | (16 * (*(_BYTE *)(a1 + 319) & 3));
          else
            dword_253E47158 &= 0xFFFFFFCF;
        }
        else
        {
          dword_253E47074 = v36 | dword_253E47074 & 0xFF0FFFFF | 0x800000;
          if (*(_BYTE *)(a1 + 2936) == 1)
            dword_253E47070 = dword_253E47070 & 0xFFFFFFCF | (16 * (*(_BYTE *)(a1 + 319) & 3));
          else
            dword_253E47070 &= 0xFFFFFFCF;
        }
        v45 = sub_2198DD268(a1);
        if ((sub_2198D23DC(*(_QWORD *)(a1 + 19360)) == 4
           || sub_2198D23DC(*(_QWORD *)(a1 + 19360)) == 8
           || sub_2198D23DC(*(_QWORD *)(a1 + 19360)) == 7)
          && !*(_BYTE *)(a1 + 507)
          && sub_2198D2BCC(*(_QWORD *)(a1 + 19360), 1u) != 1)
        {
          if (*(_QWORD *)(a1 + 6248))
          {
            v47 = "SE Removed while Discovery API ongoing, ignored";
LABEL_234:
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)v47);
            sub_2198D27D4(*(_QWORD *)(a1 + 19360), 0);
LABEL_265:
            sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateSeInfo");
LABEL_266:
            a4 = 0;
            v12 = 16;
            v9 = (uint64_t)v29;
            goto LABEL_96;
          }
          if (*(_BYTE *)(a1 + 2944) != 1)
          {
            sub_2198DFE2C(a1);
            *(_BYTE *)(a1 + 507) = 1;
            *(_QWORD *)(a1 + 512) = v33;
            *(_DWORD *)(a1 + 520) = 0;
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_UpdateSeInfo- Virtual Mode = Recovery Started");
            *(_QWORD *)(a1 + 2912) = off_2550A39C8;
            *(_BYTE *)(a1 + 2904) = 0;
            *(_BYTE *)(a1 + 2906) = 0;
            v48 = (char)off_2550A39C8[0];
            if (off_2550A39C8[0])
            {
              v48 = 0;
              v58 = off_2550A39D8;
              do
              {
                ++v48;
                v59 = *v58;
                v58 += 2;
              }
              while (v59);
            }
            goto LABEL_264;
          }
        }
        else
        {
          if ((_DWORD)v45 != 111 || *(_BYTE *)(a1 + 507))
          {
            if (*(_QWORD *)(a1 + 6664) || *(_QWORD *)(a1 + 6104))
              goto LABEL_265;
            if (*(_QWORD *)(a1 + 6056))
            {
              ++*(_BYTE *)(a1 + 314);
              *(_QWORD *)(a1 + 392) = *((_QWORD *)a3 + 1);
              *(_DWORD *)(a1 + 400) = 1;
              *(_BYTE *)(a1 + 318) = 2;
              *(_BYTE *)(a1 + 704) = 1;
              if (*(_BYTE *)(a1 + 705) != 1 || (*(_DWORD *)(a1 + 440) & 0xB) != 2)
                goto LABEL_265;
              sub_219898B20(*(_QWORD *)(a1 + 536), a1);
              v46 = "phLibNfc_NfceeNtfDelayCb: Timer stopped due to eSE removed Notification";
              goto LABEL_269;
            }
            if (*(_QWORD *)(a1 + 6680))
            {
              *(_QWORD *)(a1 + 2912) = 0;
              *(_WORD *)(a1 + 2904) = 0;
              *(_BYTE *)(a1 + 2906) = 0;
              sub_2198655FC(a1, v45, 0);
              sub_2198D27D4(*(_QWORD *)(a1 + 19360), 0);
              sub_2198AC900(*(_QWORD *)(a1 + 3040));
              sub_2198ACA18(*(_QWORD *)(a1 + 3040));
              sub_2199004B4(*(_QWORD *)(a1 + 3040), 3);
              sub_2198FBBC4(*(_QWORD *)(a1 + 3040));
              sub_2198DED7C(a1, 67);
              goto LABEL_265;
            }
            if (*(_BYTE *)(a1 + 507) == 1)
            {
              v46 = "phLibNfc_UpdateSeInfo- Second Removed while recovery in Progress Ignored";
LABEL_269:
              sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)v46);
              goto LABEL_265;
            }
            v47 = "SE Removed notification, ignored";
            goto LABEL_234;
          }
          if (*(_BYTE *)(a1 + 2944) != 1)
          {
            sub_2198DFE2C(a1);
            sub_21988925C(*(_QWORD *)(a1 + 464));
            *(_BYTE *)(a1 + 507) = 1;
            *(_BYTE *)(a1 + 1) = *(_BYTE *)(a1 + 2) & 1;
            *(_QWORD *)(a1 + 512) = v33;
            *(_DWORD *)(a1 + 520) = 0;
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_UpdateSeInfo- Wired Mode = Recovery Started");
            *(_QWORD *)(a1 + 2912) = off_2550A38F8;
            *(_BYTE *)(a1 + 2904) = 0;
            *(_BYTE *)(a1 + 2906) = 0;
            v48 = (char)off_2550A38F8[0];
            if (off_2550A38F8[0])
            {
              v48 = 0;
              v49 = off_2550A3908;
              do
              {
                ++v48;
                v50 = *v49;
                v49 += 2;
              }
              while (v50);
            }
LABEL_264:
            *(_BYTE *)(a1 + 2905) = v48;
            sub_2198655FC(a1, 0, 0);
            goto LABEL_265;
          }
        }
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"eSE Removed Ntf status propogated to host!!");
        *(_DWORD *)(a1 + 404) = 4;
        sub_2198D2A2C(*(_QWORD *)(a1 + 19360), 1u, 5);
        sub_2198D2AFC(*(_QWORD *)(a1 + 19360), 1u, 0);
        sub_2198D27D4(*(_QWORD *)(a1 + 19360), 0);
        sub_2198DFF6C(a1, 214);
        goto LABEL_265;
      }
      v40 = *(unsigned __int8 *)(a1 + 2936);
      if (v40 == 1)
      {
        *(_QWORD *)(a1 + 408) = *((_QWORD *)a3 + 1);
        sub_2198D2A2C(*(_QWORD *)(a1 + 19360), 3u, 5);
        *(_QWORD *)(a1 + 416) = 0x400000007;
        v27[834] = -1;
        *(_BYTE *)(a1 + 506) = 0;
        v29 = (unsigned __int8 *)*((_QWORD *)a3 + 1);
        *(_QWORD *)(a1 + 408) = v29;
        *(_BYTE *)(a1 + 319) = 2;
        if (*v8)
          dword_253E47158 = dword_253E47158 & 0xFFFFFFCF | 0x20;
        else
          dword_253E47070 = dword_253E47070 & 0xFFFFFFCF | 0x20;
      }
      else
      {
        sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_UpdateSeInfo:Unknown NFCEE ID");
        v29 = 0;
      }
      sub_21989AABC(a1);
      sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateSeInfo");
      if (v40 == 1)
        goto LABEL_266;
      v11 = 0;
      a4 = 0;
LABEL_96:
      if ((*(_BYTE *)(a1 + 1012) & 7) == 0 || (*(_BYTE *)(a1 + 1012) & 0x38) != 0)
      {
        if ((_DWORD)v12 != 24)
          goto LABEL_124;
      }
      else
      {
        if (!*(_BYTE *)(a1 + 1400) && (_DWORD)v12 == 24 && *(_BYTE *)(a1 + 1401) == 1)
        {
          if (*(_BYTE *)(a1 + 2937) == 1
            || *(_BYTE *)(a1 + 2938) == 1
            || *(_BYTE *)(a1 + 2939) == 1
            || *(_BYTE *)(a1 + 2944) == 1
            || *(_BYTE *)(a1 + 2936) == 1)
          {
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Vas Inversion Timer Stopped");
            phOsalNfc_Timer_Stop();
            sub_21988629C(1, (unsigned int *)(a1 + 19368), *(_QWORD *)(a1 + 720), 4u, 4u, (uint64_t)"phLibNfc_SENtfHandler");
            v24 = *(_QWORD *)(a1 + 720);
            if (v24 && v24 != 0xFFFFFFFFFFFFLL)
            {
              phOsalNfc_Timer_Delete();
              *(_QWORD *)(a1 + 720) = 0xFFFFFFFFFFFFLL;
            }
            goto LABEL_110;
          }
        }
        else
        {
          if ((_DWORD)v12 != 24)
            goto LABEL_124;
          if (*(_BYTE *)(a1 + 2937) == 1)
          {
LABEL_104:
            v22 = *(_QWORD *)(a1 + 720);
            if (v22 != 0xFFFFFFFFFFFFLL && v22)
            {
              phOsalNfc_Timer_Stop();
              sub_21988629C(1, (unsigned int *)(a1 + 19368), *(_QWORD *)(a1 + 720), 4u, 4u, (uint64_t)"phLibNfc_SENtfHandler");
              v23 = *(_QWORD *)(a1 + 720);
              if (!v23)
              {
LABEL_123:
                v11 = 1;
                sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Timer Create Failed for VAS NTF timer");
                *(_QWORD *)(a1 + 720) = 0xFFFFFFFFFFFFLL;
                a4 = 12;
LABEL_124:
                if (!v11)
                  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SENtfHandler");
                goto LABEL_125;
              }
            }
            else
            {
              v23 = phOsalNfc_Timer_Create();
              *(_QWORD *)(a1 + 720) = v23;
              if (!v23)
                goto LABEL_123;
            }
            if (v23 != 0xFFFFFFFFFFFFLL)
            {
              if (!phOsalNfc_Timer_Start())
              {
                sub_21988629C(1, (unsigned int *)(a1 + 19368), *(_QWORD *)(a1 + 720), 4u, 4u, (uint64_t)"phLibNfc_SENtfHandler");
                *(_DWORD *)(a1 + 1360) = v61;
                return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SENtfHandler");
              }
              sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Timer Start Failed for VAS NTF timer");
              phOsalNfc_Timer_Delete();
              *(_QWORD *)(a1 + 720) = 0xFFFFFFFFFFFFLL;
              a4 = 255;
              goto LABEL_125;
            }
            goto LABEL_123;
          }
        }
        if (*(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2944) == 1 || *(_BYTE *)(a1 + 2936) == 1)
          goto LABEL_104;
      }
      if ((*(_BYTE *)(a1 + 1012) & 0x10) == 0)
        goto LABEL_124;
LABEL_110:
      phOsalNfc_MemCopy();
      phOsalNfc_SetMemory();
      *(_BYTE *)(a1 + 1401) = 0;
LABEL_125:
      if (*(_QWORD *)(a1 + 6696))
      {
        sub_219853E34(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_SENtfHandler :SE NTF Cb Event");
        (*(void (**)(_QWORD, _QWORD, uint64_t, uint64_t, __int128 *, uint64_t))(a1 + 6696))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6704), v12, v9, &v61, a4);
      }
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SENtfHandler");
    case 2:
      if ((_DWORD)a4)
      {
        v9 = 0;
        v12 = 6;
LABEL_19:
        v11 = 1;
        goto LABEL_96;
      }
      sub_2198DFCC4(a1, a3);
      v19 = (unsigned __int8 *)*((_QWORD *)a3 + 1);
      BYTE4(v61) = v19[1];
      if (BYTE4(v61) == 192 && (*(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2937) == 1 || *(_BYTE *)(a1 + 2944) == 1))
      {
        if (*v19 > 1u)
        {
          LODWORD(v61) = 255;
          v26 = "Dropping eNciNfc_NfceeDiscReqNtf: phNfc_SE_Rdr_Invalid";
        }
        else
        {
          LODWORD(v61) = *v19;
          if (*((_DWORD *)v19 + 1) > 1u)
          {
            DWORD2(v61) = 255;
            v26 = "Dropping eNciNfc_NfceeDiscReqNtf: phNfc_NFC_Invalid TechMode";
          }
          else
          {
            DWORD2(v61) = *((_DWORD *)v19 + 1);
            if (*((_DWORD *)v19 + 2) == 4)
            {
              v9 = 0;
              a4 = 0;
              HIDWORD(v61) = 4;
              v12 = 25;
              goto LABEL_19;
            }
            HIDWORD(v61) = 0;
            v26 = "Dropping eNciNfc_NfceeDiscReqNtf:                                                            phNfc_e_R"
                  "fProtocolsUnknownProtocol";
          }
        }
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)v26);
      }
      v11 = 0;
      v9 = 0;
      a4 = 0;
      v12 = 25;
      goto LABEL_96;
    case 3:
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE Notification Type: ACTION");
      if (*(_BYTE *)(a1 + 486))
        *(_BYTE *)(a1 + 486) |= 2u;
      v13 = *(_QWORD *)a3;
      v9 = *(_QWORD *)(*(_QWORD *)a3 + 272);
      v14 = *(_DWORD *)(*(_QWORD *)a3 + 4);
      v12 = 6;
      v11 = 1;
      if (v14 <= 1)
      {
        if (v14)
        {
          if (v14 == 1)
          {
            *(_QWORD *)&v62 = v13 + 12;
            DWORD2(v62) = *(unsigned __int8 *)(v13 + 8);
            v12 = 11;
          }
        }
        else
        {
          *(_QWORD *)&v61 = v13 + 12;
          DWORD2(v61) = *(unsigned __int8 *)(v13 + 8);
          v12 = 14;
        }
      }
      else
      {
        switch(v14)
        {
          case 2:
            *(_QWORD *)&v62 = v13 + 12;
            DWORD2(v62) = *(unsigned __int8 *)(v13 + 8);
            v12 = 10;
            break;
          case 16:
            *(_QWORD *)&v62 = v13 + 12;
            DWORD2(v62) = *(unsigned __int8 *)(v13 + 8);
            v12 = 13;
            break;
          case 32:
            *(_QWORD *)&v61 = v13 + 12;
            DWORD2(v61) = *(unsigned __int8 *)(v13 + 8);
            v12 = 20;
            break;
        }
      }
      goto LABEL_96;
    case 4:
    case 7:
    case 8:
    case 9:
    case 10:
    case 11:
    case 12:
    case 13:
    case 14:
    case 16:
    case 17:
    case 19:
    case 24:
    case 25:
    case 26:
    case 27:
      goto LABEL_16;
    case 5:
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE Notification Type: ACTIVATED");
      v9 = *(_QWORD *)a3;
      v15 = *(_QWORD *)a3;
      if (*(_BYTE *)(a1 + 486))
      {
        *(_BYTE *)(a1 + 486) |= 2u;
        v15 = *(_QWORD *)a3;
      }
      v16 = sub_2198D1B2C(*(_QWORD *)(a1 + 19360), 149, 0, v15, 0);
      if (v16)
      {
        v11 = 1;
        if (v16 == 111)
        {
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"State machine has returned NFCSTATUS_BUSY ");
          a4 = 111;
        }
        else
        {
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"State machine has returned NFCSTATUS_FAILED ");
          a4 = 255;
        }
      }
      else
      {
        v11 = 1;
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"State machine has returned NFCSTATUS_SUCCESS ");
        a4 = 0;
      }
      v12 = 15;
      goto LABEL_96;
    case 6:
      v11 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE Notification Type: RF Field Info");
      v9 = *((_QWORD *)a3 + 1);
      if (!*(_DWORD *)a3)
      {
        *(_BYTE *)(a1 + 1400) = 0;
        goto LABEL_81;
      }
      if (*(_DWORD *)a3 != 1)
        goto LABEL_81;
      *(_BYTE *)(a1 + 1400) = 1;
      v12 = 5;
      goto LABEL_96;
    case 15:
      v11 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE Notification Type: eNciNfc_NciRfRapduSentNtf");
      v12 = 18;
      v9 = (uint64_t)a3;
      goto LABEL_96;
    case 18:
      if (*(_BYTE *)(a1 + 507) == 1)
      {
        v11 = 0;
      }
      else
      {
        if (*(_QWORD *)a3 && *((_DWORD *)a3 + 2))
          *(_DWORD *)(a1 + 528) = **(unsigned __int8 **)a3;
        v11 = 1;
      }
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE Notification Type: eNciNfc_NciNfceePowerOffNtf");
      v9 = 0;
      v12 = 19;
      goto LABEL_96;
    case 20:
      *(_WORD *)(a1 + 1400) = 0;
      if (*(_BYTE *)(a1 + 1424) == 1)
      {
        sub_21986538C(*(_QWORD *)(a1 + 3040), (*(unsigned __int8 *)(a1 + 1012) >> 4) & 1);
        sub_2198C0850(a1);
        *(_BYTE *)(a1 + 1424) = 0;
      }
      if (*(_BYTE *)(a1 + 697) == 1 && !sub_2198D0DC0(*(_QWORD *)(a1 + 19360), 1))
      {
        *(_QWORD *)(a1 + 512) = a1 + 392;
        *(_DWORD *)(a1 + 524) = 0;
        sub_2198E03D8((unsigned int *)a1, 1, 0, (int *)&v60);
        sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v60, 0, 0, 0);
        *(_BYTE *)(a1 + 697) = 0;
      }
      if (*(_BYTE *)(a1 + 2936) == 1)
        v9 = *(_QWORD *)(a1 + 392);
      else
        v9 = 0;
      v18 = *(_QWORD *)(a1 + 720);
      if (v18 && v18 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 720) = 0xFFFFFFFFFFFFLL;
      }
      v11 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE Notification Type: eNciNfc_NciSuicaTxNtf");
      v12 = 21;
      goto LABEL_96;
    case 21:
      *(_BYTE *)(a1 + 1400) = 0;
      *(_BYTE *)(a1 + 1424) = 0;
      if (*(_BYTE *)(a1 + 2936) == 1)
        v9 = *(_QWORD *)(a1 + 392);
      else
        v9 = 0;
      v11 = 1;
      LODWORD(v61) = 1;
      v17 = "NFCEE Notification Type: eNciNfc_NciSuicaModeStartedNtf";
      goto LABEL_95;
    case 22:
      *(_BYTE *)(a1 + 1400) = 0;
      *(_BYTE *)(a1 + 1424) = 0;
      v9 = *(_QWORD *)(a1 + 392);
      LODWORD(v61) = 2;
      v17 = "NFCEE Notification Type: eNciNfc_NciExpressModeStartedNtf";
      goto LABEL_51;
    case 23:
      *(_BYTE *)(a1 + 1400) = 0;
      v9 = *(_QWORD *)(a1 + 392);
      LODWORD(v61) = 3;
      v17 = "NFCEE Notification Type: eNciNfc_NciGenericAExpModeStartedNtf";
      goto LABEL_51;
    case 28:
      v9 = *(_QWORD *)(a1 + 392);
      v11 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NFCEE Notification Type: phLibNfc_eSE_EvtSwitchedOff");
      v12 = 22;
      goto LABEL_96;
    default:
      if (a2 == 35)
      {
        *(_BYTE *)(a1 + 1400) = 0;
        *(_BYTE *)(a1 + 1424) = 0;
        v9 = *(_QWORD *)(a1 + 392);
        LODWORD(v61) = 4;
        v17 = "NFCEE Notification Type: eNciNfc_NciVasExOnlyAModeStartedNtf";
LABEL_51:
        v11 = 1;
      }
      else
      {
        if (a2 != 36)
        {
LABEL_16:
          v11 = 1;
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"NFCEE Notification Type: UNKNOWN");
          v9 = 0;
LABEL_81:
          v12 = 6;
          goto LABEL_96;
        }
        if (sub_2198D0CBC(*(_QWORD *)(a1 + 19360), 1))
        {
          if (sub_2198D0DC0(*(_QWORD *)(a1 + 19360), 1))
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"SE is not active in VAS Express+HCE mode");
          *(_BYTE *)(a1 + 697) = 0;
        }
        else
        {
          *(_QWORD *)(a1 + 512) = a1 + 392;
          *(_BYTE *)(a1 + 697) = 1;
          *(_DWORD *)(a1 + 524) = 2;
          sub_2198E03D8((unsigned int *)a1, 1, 2, (int *)&v60);
          sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v60, 0, 0, 0);
        }
        v11 = 1;
        *(_BYTE *)(a1 + 1424) = 1;
        *(_BYTE *)(a1 + 1400) = 0;
        v9 = *(_QWORD *)(a1 + 392);
        LODWORD(v61) = 5;
        v17 = "NFCEE Notification Type: eNciNfc_NciExpressModeHceWiredStartedNtf";
      }
LABEL_95:
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)v17);
      v12 = 24;
      goto LABEL_96;
  }
}

uint64_t sub_219850068(uint64_t a1, unsigned __int8 *a2, unsigned int a3)
{
  uint64_t v6;
  unsigned int v7;
  unsigned int v8;
  int v9;
  unsigned __int8 v10;
  unsigned int v11;
  int v12;
  char v13;
  unint64_t v14;
  int v15;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;
  uint64_t v20;
  uint64_t v21;

  v17 = 0;
  v18 = 0;
  v19 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsUpdatePktInfo");
  v6 = 1;
  if (a1 && a2)
  {
    if (a2[2] + 3 == a3)
    {
      v7 = *a2;
      v8 = v7 >> 5;
      if ((v7 >> 5) - 2 >= 2)
      {
        if (v8)
        {
          sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Invalid message type");
          v6 = 250;
          goto LABEL_38;
        }
        *(_BYTE *)(a1 + 924) = v7 & 0xF;
        *(_QWORD *)(a1 + 916) = 0;
        goto LABEL_11;
      }
      v9 = v7 & 0xF;
      v10 = a2[1];
      v21 = *(_QWORD *)(a1 + 632);
      sub_219850718(0, (unsigned int *)&v21, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateGID");
      if (((1 << v9) & 0x8007) == 0)
      {
        sub_219850808(0, (unsigned int *)&v21, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateGID");
        sub_219851790(3, (unsigned int *)a1, 3u, 1u, (uint64_t)"Unknown GID received");
        v15 = 2;
LABEL_36:
        LODWORD(v17) = v15;
        goto LABEL_37;
      }
      v11 = v10 & 0x3F;
      sub_219850808(0, (unsigned int *)&v21, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateGID");
      v20 = *(_QWORD *)(a1 + 632);
      sub_219850718(0, (unsigned int *)&v20, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateCtrlPktOID");
      if (v8 == 2)
      {
        v12 = sub_21988C2EC(v20, v9, v11);
LABEL_32:
        sub_219850808(0, (unsigned int *)&v20, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateCtrlPktOID");
        if (v12)
        {
          LODWORD(v17) = 3;
LABEL_37:
          v18 = *(_QWORD *)(a1 + 2336);
          LODWORD(v19) = *(unsigned __int16 *)(a1 + 2344);
          v6 = 245;
          sub_219859E40(*(_QWORD *)a1, (uint64_t)&v17, 245);
          goto LABEL_38;
        }
        if (sub_219850EA0((unsigned int *)a1, a2, a3))
        {
          v15 = 4;
          goto LABEL_36;
        }
        *(_DWORD *)(a1 + 916) = v9;
        *(_DWORD *)(a1 + 920) = v11;
        *(_BYTE *)(a1 + 924) = 0;
LABEL_11:
        v6 = 0;
        *(_DWORD *)(a1 + 912) = v8;
        goto LABEL_38;
      }
      v21 = v20;
      sub_219850718(0, (unsigned int *)&v21, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateNtfPktOID");
      v12 = 255;
      if (v9 > 1)
      {
        if (v9 != 2)
        {
          if (v9 != 15)
          {
LABEL_31:
            sub_219850808(0, (unsigned int *)&v21, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateNtfPktOID");
            goto LABEL_32;
          }
          v13 = v11 - 3;
          if (v11 - 3 < 0x3C)
          {
            v14 = 0x8BC880BB2316603;
LABEL_21:
            if (((v14 >> v13) & 1) != 0)
              goto LABEL_30;
          }
LABEL_29:
          sub_219851790(0, (unsigned int *)&v21, 3u, 1u, (uint64_t)"Unknown OID received");
          goto LABEL_30;
        }
        if (v11)
          goto LABEL_29;
      }
      else
      {
        if (v9)
        {
          v13 = v11 - 2;
          if (v11 - 2 < 0x2F)
          {
            v14 = 0x4CCFC00001FBLL;
            goto LABEL_21;
          }
          goto LABEL_29;
        }
        v12 = 0;
        if (v11 - 6 < 3 || !v11)
          goto LABEL_31;
        if (v11 != 52)
          goto LABEL_29;
        sub_219851790(0, (unsigned int *)&v21, 3u, 4u, (uint64_t)"AMS Init MisMatch NTF Not Expected");
      }
LABEL_30:
      v12 = 0;
      goto LABEL_31;
    }
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Incorrect payload length");
    v6 = 246;
  }
LABEL_38:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsUpdatePktInfo");
  return v6;
}

uint64_t sub_219850404(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  void (*v7)(uint64_t, uint64_t *);
  unsigned __int16 v9;
  uint64_t v10;
  __int16 v11;
  void (*v12)(uint64_t, uint64_t);
  void (*v13)(uint64_t, uint64_t);
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;

  v14 = 0;
  v15 = 0;
  v16 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TmlReadCommonCb");
  if (a1)
  {
    v4 = 0;
    v5 = 0;
    do
    {
      v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
      if ((v4 & 1) != 0)
        break;
      v4 = 1;
      v5 = 1;
    }
    while (v6 != a1);
    if (v6 == a1)
    {
      if (a2 && !*(_WORD *)a2)
      {
        v9 = *(_WORD *)(a2 + 16) + *(_WORD *)(a1 + 2442);
        *(_BYTE *)(a1 + 2465) = 1;
        if (*(unsigned __int16 *)(a1 + 2440) <= v9)
        {
          sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"TmlReadCommonCb: Full read length received");
          v13 = *(void (**)(uint64_t, uint64_t))(a1 + 2448);
          *(_QWORD *)(a1 + 2448) = 0;
          *(_DWORD *)(a1 + 2440) = 0;
          if (v13)
          {
            sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"TmlReadCommonCb: Invoking proc function");
            *(_QWORD *)(a2 + 8) = a1 + 640;
            *(_WORD *)(a2 + 16) = v9;
            v13(a1, a2);
          }
        }
        else
        {
          sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"TmlReadCommonCb: Partial read length received, Placing new read req");
          v10 = *(unsigned __int16 *)(a2 + 16);
          v11 = *(_WORD *)(a1 + 2442) + v10;
          *(_WORD *)(a1 + 2442) = v11;
          if (sub_219851ED0(a1, *(_QWORD *)(a2 + 8) + v10, (unsigned __int16)(*(_WORD *)(a1 + 2440) - v11)) != 13)
          {
            sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"TmlReadCommonCb: Failed to place new TML read request");
            v12 = *(void (**)(uint64_t, uint64_t))(a1 + 2448);
            *(_QWORD *)(a1 + 2448) = 0;
            *(_QWORD *)(a2 + 8) = 0;
            *(_WORD *)(a2 + 16) = 0;
            *(_WORD *)a2 = 255;
            *(_DWORD *)(a1 + 2440) = 0;
            v12(a1, a2);
          }
        }
      }
      else
      {
        v7 = *(void (**)(uint64_t, uint64_t *))(a1 + 2448);
        *(_QWORD *)(a1 + 2448) = 0;
        v15 = 0;
        LOWORD(v16) = 0;
        LOWORD(v14) = 255;
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"TmlReadCommonCb: Received either invalid 'pInfo' or TML Read                                    call back with status failed");
        *(_DWORD *)(a1 + 2440) = 0;
        v7(a1, &v14);
      }
    }
  }
  return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TmlReadCommonCb");
}

uint64_t sub_219850628(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5)
{
  uint64_t result;
  uint64_t v9;
  uint64_t v10;
  unsigned int v11;
  unsigned int v15;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result != 1)
  {
    if ((_DWORD)result)
    {
      if (qword_253E467C0)
        v10 = qword_253E467C0 + 32;
      else
        v10 = 0;
      if ((_DWORD)result != 255)
        goto LABEL_23;
      v9 = qword_253E46750;
      if (!qword_253E46750)
        goto LABEL_23;
    }
    else
    {
      v9 = qword_253E46750;
      if (!qword_253E46750)
        return result;
      v10 = 0;
    }
    v11 = *(_DWORD *)(v9 + 4 * a3 + 32);
    if (v11 >= a4 && v11 != 0 && a5 != 0 && v11 < 6)
      return phOsalNfc_LogStr();
LABEL_23:
    if (!v10 || (_DWORD)result != 255)
      return result;
    goto LABEL_25;
  }
  if (!qword_253E467C0)
    return result;
  v10 = qword_253E467C0 + 32;
LABEL_25:
  v15 = *(_DWORD *)(v10 + 4 * a3);
  if (v15 >= a4 && v15 != 0 && a5 != 0 && v15 <= 5)
    return phOsalNfc_LogStr();
  return result;
}

uint64_t sub_219850718(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5)
{
  uint64_t result;
  uint64_t v9;
  uint64_t v10;
  unsigned int v11;
  unsigned int v15;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result != 1)
  {
    if ((_DWORD)result)
    {
      if (qword_253E467C0)
        v10 = qword_253E467C0 + 32;
      else
        v10 = 0;
      if ((_DWORD)result != 255)
        goto LABEL_23;
      v9 = qword_253E46750;
      if (!qword_253E46750)
        goto LABEL_23;
    }
    else
    {
      v9 = qword_253E46750;
      if (!qword_253E46750)
        return result;
      v10 = 0;
    }
    v11 = *(_DWORD *)(v9 + 4 * a3 + 32);
    if (v11 >= a4 && v11 != 0 && a5 != 0 && v11 < 6)
      return phOsalNfc_LogFunc();
LABEL_23:
    if (!v10 || (_DWORD)result != 255)
      return result;
    goto LABEL_25;
  }
  if (!qword_253E467C0)
    return result;
  v10 = qword_253E467C0 + 32;
LABEL_25:
  v15 = *(_DWORD *)(v10 + 4 * a3);
  if (v15 >= a4 && v15 != 0 && a5 != 0 && v15 <= 5)
    return phOsalNfc_LogFunc();
  return result;
}

uint64_t sub_219850808(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5)
{
  uint64_t result;
  uint64_t v9;
  uint64_t v10;
  unsigned int v11;
  unsigned int v15;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result != 1)
  {
    if ((_DWORD)result)
    {
      if (qword_253E467C0)
        v10 = qword_253E467C0 + 32;
      else
        v10 = 0;
      if ((_DWORD)result != 255)
        goto LABEL_23;
      v9 = qword_253E46750;
      if (!qword_253E46750)
        goto LABEL_23;
    }
    else
    {
      v9 = qword_253E46750;
      if (!qword_253E46750)
        return result;
      v10 = 0;
    }
    v11 = *(_DWORD *)(v9 + 4 * a3 + 32);
    if (v11 >= a4 && v11 != 0 && a5 != 0 && v11 < 6)
      return phOsalNfc_LogFunc();
LABEL_23:
    if (!v10 || (_DWORD)result != 255)
      return result;
    goto LABEL_25;
  }
  if (!qword_253E467C0)
    return result;
  v10 = qword_253E467C0 + 32;
LABEL_25:
  v15 = *(_DWORD *)(v10 + 4 * a3);
  if (v15 >= a4 && v15 != 0 && a5 != 0 && v15 <= 5)
    return phOsalNfc_LogFunc();
  return result;
}

uint64_t sub_2198508F8(int a1, unsigned int *a2, int a3)
{
  uint64_t v3;
  char i;
  char v5;
  uint64_t result;
  char v7;
  uint64_t v8;
  unsigned int *v9;
  char v10;
  uint64_t v11;
  unsigned int *v12;
  char v13;
  uint64_t v14;
  char v15;
  uint64_t v16;
  unsigned int *v17;
  char v18;
  uint64_t v19;
  unsigned int *v20;
  char v21;
  char v22;
  char v23;
  char v24;
  char v25;
  uint64_t v26;
  unsigned int *v27;
  char v28;
  uint64_t v29;
  unsigned int *v30;
  char v31;
  uint64_t v32;
  unsigned int *v33;
  char v34;
  uint64_t v35;
  char v36;
  uint64_t v37;
  char v38;
  char v39;
  uint64_t v40;
  char v41;
  uint64_t v42;
  uint64_t v43;
  char v44;
  char v45;
  char v46;
  uint64_t v47;
  char v48;
  uint64_t v49;
  char v50;
  uint64_t v51;
  char v52;
  uint64_t v53;

  if (!a2)
    return 255;
  if (a1 == 1)
    return *a2;
  if (a1)
  {
    switch(a3)
    {
      case 3:
        switch(a1)
        {
          case 2:
            v7 = 0;
            v8 = 0;
            do
            {
              v9 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v8 + 4);
              if ((v7 & 1) != 0)
                break;
              v7 = 1;
              v8 = 1;
            }
            while (v9 != a2);
            goto LABEL_88;
          case 3:
            v31 = 0;
            v32 = 0;
            do
            {
              v33 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v32 + 5);
              if ((v31 & 1) != 0)
                break;
              v31 = 1;
              v32 = 1;
            }
            while (v33 != a2);
            goto LABEL_93;
          case 4:
            v34 = 0;
            v35 = 0;
            do
            {
              v30 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v35 + 12);
              if ((v34 & 1) != 0)
                break;
              v34 = 1;
              v35 = 1;
            }
            while (v30 != a2);
            goto LABEL_64;
          case 5:
            v36 = 0;
            v37 = 0;
            do
            {
              v17 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v37 + 8);
              if ((v36 & 1) != 0)
                break;
              v36 = 1;
              v37 = 1;
            }
            while (v17 != a2);
            goto LABEL_103;
          default:
            return 255;
        }
      case 4:
        if (a1 != 3)
        {
          if (a1 == 2)
          {
            v10 = 0;
            v11 = 0;
            do
            {
              v12 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v11 + 2);
              if ((v10 & 1) != 0)
                break;
              v10 = 1;
              v11 = 1;
            }
            while (v12 != a2);
LABEL_25:
            if (v12 == a2)
              return a2[4842];
          }
          return 255;
        }
        v3 = 0;
        v23 = 1;
        result = 255;
        do
        {
          v24 = v23;
          if (*((_QWORD *)&unk_253E46700 + 14 * v3) == *((_QWORD *)a2 + 1))
            return *((unsigned int *)&unk_253E46700 + 28 * v3 + 2);
          v23 = 0;
          v3 = 1;
        }
        while ((v24 & 1) != 0);
        return result;
      case 5:
        switch(a1)
        {
          case 2:
            v13 = 0;
            v14 = 0;
            do
            {
              v12 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v14 + 2);
              if ((v13 & 1) != 0)
                break;
              v13 = 1;
              v14 = 1;
            }
            while (v12 != a2);
            goto LABEL_25;
          case 3:
            v46 = 0;
            v47 = 0;
            do
            {
              v9 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v47 + 4);
              if ((v46 & 1) != 0)
                break;
              v46 = 1;
              v47 = 1;
            }
            while (v9 != a2);
LABEL_88:
            if (v9 != a2)
              return 255;
            result = a2[1619];
            break;
          case 4:
            v48 = 0;
            v49 = 0;
            do
            {
              v33 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v49 + 5);
              if ((v48 & 1) != 0)
                break;
              v48 = 1;
              v49 = 1;
            }
            while (v33 != a2);
LABEL_93:
            if (v33 != a2)
              return 255;
            result = a2[617];
            break;
          case 5:
            v50 = 0;
            v51 = 0;
            do
            {
              v27 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v51 + 6);
              if ((v50 & 1) != 0)
                break;
              v50 = 1;
              v51 = 1;
            }
            while (v27 != a2);
            goto LABEL_98;
          case 6:
            v52 = 0;
            v53 = 0;
            do
            {
              v17 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v53 + 8);
              if ((v52 & 1) != 0)
                break;
              v52 = 1;
              v53 = 1;
            }
            while (v17 != a2);
            goto LABEL_103;
          default:
            return 255;
        }
        return result;
      case 6:
        switch(a1)
        {
          case 2:
            v25 = 0;
            v26 = 0;
            do
            {
              v27 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v26 + 6);
              if ((v25 & 1) != 0)
                break;
              v25 = 1;
              v26 = 1;
            }
            while (v27 != a2);
LABEL_98:
            if (v27 == a2)
              return a2[12];
            break;
          case 3:
            v28 = 0;
            v29 = 0;
            do
            {
              v30 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v29 + 12);
              if ((v28 & 1) != 0)
                break;
              v28 = 1;
              v29 = 1;
            }
            while (v30 != a2);
LABEL_64:
            if (v30 == a2)
              return a2[2123];
            break;
          case 4:
            v15 = 0;
            v16 = 0;
            do
            {
              v17 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v16 + 8);
              if ((v15 & 1) != 0)
                break;
              v15 = 1;
              v16 = 1;
            }
            while (v17 != a2);
LABEL_103:
            if (v17 == a2)
              return a2[342];
            break;
        }
        return 255;
      case 7:
        if (a1 != 2)
          return 255;
        v18 = 0;
        v19 = 0;
        do
        {
          v20 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v19 + 13);
          if ((v18 & 1) != 0)
            break;
          v18 = 1;
          v19 = 1;
        }
        while (v20 != a2);
        if (v20 != a2)
          return 255;
        return a2[239];
      case 8:
        switch(a1)
        {
          case 2:
            v3 = 0;
            v21 = 1;
            result = 255;
            while (1)
            {
              v22 = v21;
              if (*((_QWORD *)&unk_253E46700 + 14 * v3) == *((_QWORD *)a2 + 339))
                break;
              v21 = 0;
              v3 = 1;
              if ((v22 & 1) == 0)
                return result;
            }
            return *((unsigned int *)&unk_253E46700 + 28 * v3 + 2);
          case 3:
            v3 = 0;
            v38 = 1;
            result = 255;
            while (1)
            {
              v39 = v38;
              if (*((_QWORD *)&unk_253E46700 + 14 * v3) == *((_QWORD *)a2 + 51))
                break;
              v38 = 0;
              v3 = 1;
              if ((v39 & 1) == 0)
                return result;
            }
            return *((unsigned int *)&unk_253E46700 + 28 * v3 + 2);
          case 4:
            v40 = *((_QWORD *)a2 + 32);
            if (!v40)
              return 255;
            v41 = 0;
            v42 = 0;
            do
            {
              v43 = *((_QWORD *)&unk_253E46700 + 14 * v42 + 2);
              if ((v41 & 1) != 0)
                break;
              v41 = 1;
              v42 = 1;
            }
            while (v43 != v40);
            if (v43 != v40)
              return 255;
            return *(unsigned int *)(v40 + 19368);
          case 5:
            v3 = 0;
            v44 = 1;
            result = 255;
            break;
          default:
            return 255;
        }
        break;
      default:
        return 255;
    }
    while (1)
    {
      v45 = v44;
      if (*((_QWORD *)&unk_253E46700 + 14 * v3) == *((_QWORD *)a2 + 329))
        break;
      v44 = 0;
      v3 = 1;
      if ((v45 & 1) == 0)
        return result;
    }
  }
  else
  {
    v3 = 0;
    for (i = 1; ; i = 0)
    {
      v5 = i;
      if (*((_QWORD *)&unk_253E46700 + 14 * v3) == *(_QWORD *)a2)
        break;
      v3 = 1;
      if ((v5 & 1) == 0)
        return 255;
    }
  }
  return *((unsigned int *)&unk_253E46700 + 28 * v3 + 2);
}

uint64_t sub_219850EA0(unsigned int *a1, unsigned __int8 *a2, unsigned int a3)
{
  unsigned int v6;
  unsigned int v7;
  int v8;
  int v9;
  uint64_t v10;
  BOOL v11;
  BOOL v12;
  uint64_t v13;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValRspLen");
  v6 = *a2;
  v7 = v6 >> 5;
  v8 = v6 & 0xF;
  v9 = a2[1] & 0x3F;
  if (v7 != 3)
  {
    if (v7 == 2)
    {
      v10 = 255;
      if (v8 <= 1)
      {
        if (!v8)
        {
          if ((a2[1] & 0x3F) == 0)
          {
            if (a3 < 3)
              goto LABEL_64;
            v11 = a2[2] == 3;
            goto LABEL_46;
          }
LABEL_35:
          v10 = 0;
          goto LABEL_64;
        }
        goto LABEL_45;
      }
      if (v8 == 2)
      {
        if (v9 != 1)
          goto LABEL_35;
        if (a3 < 3)
          goto LABEL_64;
      }
      else
      {
        if (v8 != 15)
          goto LABEL_64;
        if (v9 != 33)
        {
          if (v9 != 60)
            goto LABEL_35;
          if (a3 >= 4)
          {
            if (a2[2] <= 3u)
              v10 = 255;
            else
              v10 = 0;
          }
          goto LABEL_64;
        }
        if (a3 < 4)
          goto LABEL_64;
      }
      v8 = a2[2];
LABEL_45:
      v11 = v8 == 1;
LABEL_46:
      if (v11)
        v10 = 0;
      else
        v10 = 255;
      goto LABEL_64;
    }
LABEL_63:
    v10 = 255;
    goto LABEL_64;
  }
  v10 = 255;
  if (v8 <= 1)
  {
    if (!v8)
      goto LABEL_35;
    if (v9 == 40)
      goto LABEL_13;
    if (v9 != 37)
    {
      if (v9 != 33)
        goto LABEL_35;
LABEL_13:
      v12 = a2[2] == 0;
      goto LABEL_66;
    }
    goto LABEL_42;
  }
  v13 = *(_QWORD *)a1;
  if (v8 == 2)
  {
    if ((a2[1] & 0x3F) != 0)
      sub_219851790(2, (unsigned int *)v13, 3u, 1u, (uint64_t)"Unknown OID received");
    goto LABEL_35;
  }
  if (v8 != 15)
    goto LABEL_64;
  v10 = 0;
  if ((a2[1] & 0x3Fu) > 0x31)
  {
    if (v9 != 50)
    {
      if (v9 != 56)
      {
        if (v9 == 58)
        {
          if (a2[2] <= 3u)
            v10 = 255;
          else
            v10 = 0;
        }
        goto LABEL_64;
      }
      v12 = a2[2] == 10;
LABEL_66:
      if (v12)
        v10 = 0;
      else
        v10 = 255;
      goto LABEL_64;
    }
LABEL_42:
    v12 = a2[2] == 3;
    goto LABEL_66;
  }
  switch(v9)
  {
    case 19:
      v10 = 255;
      if (a3 < 3)
        break;
      v11 = a2[2] == 4;
      goto LABEL_46;
    case 24:
      if (a3 >= 3)
      {
        if (*(_BYTE *)(v13 + 4795) == 1 && !a2[2]
          || *(_BYTE *)(v13 + 4794) == 1 && !a2[2]
          || *(_BYTE *)(v13 + 4793) == 1 && !a2[2]
          || *(_BYTE *)(v13 + 4788) == 1 && !a2[2]
          || !*(_BYTE *)(v13 + 4795) && a2[2] == 1)
        {
          goto LABEL_35;
        }
        sub_219850628(1, (unsigned int *)(v13 + 6476), 3u, 1u, (uint64_t)"Length Check for ModeSet Disable Ntf Failed");
      }
      goto LABEL_63;
    case 32:
      v10 = 255;
      if (a3 >= 3)
      {
        v11 = a2[2] == 2;
        goto LABEL_46;
      }
      break;
  }
LABEL_64:
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValRspLen");
  return v10;
}

uint64_t sub_219851150(uint64_t a1, unsigned __int16 *a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  char v8;
  uint64_t v9;
  uint64_t v10;
  unsigned int v12;

  v12 = 5;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvCb");
  if (a1)
  {
    v4 = 0;
    v5 = 0;
    do
    {
      v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
      if ((v4 & 1) != 0)
        break;
      v4 = 1;
      v5 = 1;
    }
    while (v6 != a1);
    if (a2 && v6 == a1 && !sub_219852CDC(*(_QWORD *)(a1 + 632), *a2, &v12))
    {
      v7 = *((_QWORD *)a2 + 1);
      *(_QWORD *)(a1 + 2336) = v7;
      *(_WORD *)(a1 + 2344) = a2[8] + 3;
      *(_WORD *)(a1 + 2328) = *a2;
      *(_WORD *)(a1 + 2288) = 0;
      sub_219853B08(*(unsigned int *)(a1 + 2468), 3u, 3u, (uint64_t)"Read", v7);
      sub_219851FF8(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Response packet:", *(_QWORD *)(a1 + 2336));
      sub_219851308(a1, v12);
    }
    v8 = 0;
    v9 = 0;
    do
    {
      v10 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 5);
      if ((v8 & 1) != 0)
        break;
      v8 = 1;
      v9 = 1;
    }
    while (v10 != a1);
    if (v10 == a1)
    {
      if (*(_BYTE *)(a1 + 2352) == 1)
      {
        if (*(_QWORD *)a1)
          sub_2198AE9A8(*(unsigned int **)a1);
      }
      else if (sub_219851DC0(a1, 0, 3) != 13)
      {
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Tml Read request failed!");
      }
    }
  }
  return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvCb");
}

uint64_t sub_219851308(uint64_t a1, unsigned int a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  unsigned __int16 v7;
  uint64_t v9;
  unsigned int v10;
  char v11;
  uint64_t v12;
  int v13;
  uint64_t (*v14)(uint64_t);
  uint64_t (**v15)(uint64_t);
  uint64_t (**v16)(uint64_t);
  unsigned __int16 v17;
  char v18;
  uint64_t v19;
  uint64_t v20;
  uint64_t (*v21)(uint64_t);
  char v22;
  uint64_t v23;
  uint64_t v24;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RecvStateHandler");
  if (!a1)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a1);
  if (v6 != a1)
  {
LABEL_6:
    v7 = 0;
    goto LABEL_7;
  }
  if (a2 > 3 || (v9 = *(unsigned int *)(a1 + 2256), v9 > 2))
  {
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Unknown Current State or Event!");
    sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Receive State Machine: Invalid TrgtState");
    sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Receive State Machine: Result");
    sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Receive State Machine: Index");
    v7 = 17;
    goto LABEL_42;
  }
  v7 = 0;
  v10 = dword_21990AB80[4 * v9 + a2];
  do
  {
    while ((v10 & 0xFFFFFFFC) == 4)
    {
      v11 = v10 - 4;
      v12 = (v10 - 4);
      v13 = (*(uint64_t (**)(uint64_t))(*(_QWORD *)(a1 + 2264) + 8 * v12))(a1);
      v7 = v13;
      if (v13)
      {
        v10 = dword_21990ABB0[8 * v9 + 1 + 2 * v12];
        goto LABEL_16;
      }
      v10 = dword_21990ABB0[8 * v9 + 2 * (v11 & 0x7F)];
      if (v10 <= 2)
        goto LABEL_25;
    }
    if (v10 >= 9)
    {
      sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Receive State Machine: Invalid TrgtState");
      sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Receive State Machine: Result");
      sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Receive State Machine: Index");
      goto LABEL_42;
    }
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Continue... ");
LABEL_16:
    ;
  }
  while (v10 > 2);
  if (v7 == 2)
  {
    v7 = 2;
    goto LABEL_42;
  }
  LOWORD(v13) = v7;
LABEL_25:
  v14 = *(uint64_t (**)(uint64_t))(*(_QWORD *)(a1 + 2272) + 16 * v9 + 8);
  v7 = v13;
  if (v14)
    v7 = v14(a1);
  if ((_DWORD)v9 == v10)
  {
    if ((_DWORD)v9 == 1)
    {
      sub_219851888(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Recv CurrState = ");
      sub_219851888(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Recv TrgtState = ");
      v15 = (uint64_t (**)(uint64_t))&unk_2550A2AE0;
      LODWORD(v9) = 1;
      goto LABEL_33;
    }
    goto LABEL_36;
  }
  v16 = (uint64_t (**)(uint64_t))((char *)&unk_2550A2AC0 + 24 * v9 + 8 * v10);
  if (!*v16)
  {
LABEL_35:
    LODWORD(v9) = v10;
    goto LABEL_36;
  }
  sub_219851888(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Recv CurrState = ");
  sub_219851888(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Recv TrgtState = ");
  *(_DWORD *)(a1 + 2256) = v10;
  v17 = (*v16)(a1);
  if (v10 != 2)
  {
    v7 = v17;
    goto LABEL_35;
  }
  LODWORD(v9) = sub_219853424((unsigned int *)a1) > 1;
  *(_DWORD *)(a1 + 2256) = v9;
  v15 = (uint64_t (**)(uint64_t))((char *)&unk_2550A2AC0 + 8 * v9 + 48);
LABEL_33:
  v7 = (*v15)(a1);
LABEL_36:
  v18 = 0;
  v19 = 0;
  do
  {
    v20 = *((_QWORD *)&unk_253E46700 + 14 * v19 + 5);
    if ((v18 & 1) != 0)
      break;
    v18 = 1;
    v19 = 1;
  }
  while (v20 != a1);
  if (v20 == a1)
  {
    v21 = *(uint64_t (**)(uint64_t))(*(_QWORD *)(a1 + 2272) + 16 * v9);
    if (v21)
      v7 = v21(a1);
  }
LABEL_42:
  v22 = 0;
  v23 = 0;
  do
  {
    v24 = *((_QWORD *)&unk_253E46700 + 14 * v23 + 5);
    if ((v22 & 1) != 0)
      break;
    v22 = 1;
    v23 = 1;
  }
  while (v24 != a1);
  if (v24 == a1)
  {
    sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"NCI Receive Current State");
    sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"NCI Receive Target State");
  }
LABEL_7:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RecvStateHandler");
  return v7;
}

uint64_t sub_219851790(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5)
{
  uint64_t result;
  uint64_t v9;
  uint64_t v10;
  unsigned int v11;
  unsigned int v15;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result != 1)
  {
    if ((_DWORD)result)
    {
      if (qword_253E467C0)
        v10 = qword_253E467C0 + 32;
      else
        v10 = 0;
      if ((_DWORD)result != 255)
        goto LABEL_23;
      v9 = qword_253E46750;
      if (!qword_253E46750)
        goto LABEL_23;
    }
    else
    {
      v9 = qword_253E46750;
      if (!qword_253E46750)
        return result;
      v10 = 0;
    }
    v11 = *(_DWORD *)(v9 + 4 * a3 + 32);
    if (v11 >= a4 && v11 != 0 && a5 != 0 && v11 < 6)
      return phOsalNfc_LogU32();
LABEL_23:
    if (!v10 || (_DWORD)result != 255)
      return result;
    goto LABEL_25;
  }
  if (!qword_253E467C0)
    return result;
  v10 = qword_253E467C0 + 32;
LABEL_25:
  v15 = *(_DWORD *)(v10 + 4 * a3);
  if (v15 >= a4 && v15 != 0 && a5 != 0 && v15 <= 5)
    return phOsalNfc_LogU32();
  return result;
}

uint64_t sub_219851888(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5)
{
  uint64_t result;
  uint64_t v9;
  uint64_t v10;
  unsigned int v11;
  unsigned int v15;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result != 1)
  {
    if ((_DWORD)result)
    {
      if (qword_253E467C0)
        v10 = qword_253E467C0 + 32;
      else
        v10 = 0;
      if ((_DWORD)result != 255)
        goto LABEL_23;
      v9 = qword_253E46750;
      if (!qword_253E46750)
        goto LABEL_23;
    }
    else
    {
      v9 = qword_253E46750;
      if (!qword_253E46750)
        return result;
      v10 = 0;
    }
    v11 = *(_DWORD *)(v9 + 4 * a3 + 32);
    if (v11 >= a4 && v11 != 0 && a5 != 0 && v11 < 6)
      return phOsalNfc_LogX32();
LABEL_23:
    if (!v10 || (_DWORD)result != 255)
      return result;
    goto LABEL_25;
  }
  if (!qword_253E467C0)
    return result;
  v10 = qword_253E467C0 + 32;
LABEL_25:
  v15 = *(_DWORD *)(v10 + 4 * a3);
  if (v15 >= a4 && v15 != 0 && a5 != 0 && v15 <= 5)
    return phOsalNfc_LogX32();
  return result;
}

uint64_t sub_219851980(unsigned int *a1)
{
  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateIdle2Dummy");
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateIdle2Dummy");
  return 0;
}

uint64_t sub_2198519D8(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  int v8;
  int v9;
  int v10;
  int *v11;
  _QWORD v12[2];

  v12[0] = 0;
  v12[1] = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StateDummy2Idle");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 != a1)
  {
LABEL_6:
    sub_219850628(3, (unsigned int *)a1, 3u, 1u, (uint64_t)"Invalid core context!");
    v5 = 0;
    goto LABEL_7;
  }
  v7 = *(_QWORD *)a1;
  *(_BYTE *)(a1 + 2464) = 0;
  if (*(_BYTE *)(a1 + 992) == 1)
  {
    v8 = *(_DWORD *)(a1 + 968);
    if (v8 == *(_DWORD *)(a1 + 912))
    {
      if ((v8 - 2) >= 2)
      {
        if (!v8)
        {
          v9 = *(unsigned __int8 *)(a1 + 980);
          v10 = *(unsigned __int8 *)(a1 + 924);
LABEL_15:
          if (v9 == v10)
          {
            phOsalNfc_Timer_Stop();
            *(_BYTE *)(v7 + 6464) = 0;
            *(_BYTE *)(a1 + 992) = 0;
            *(_BYTE *)(a1 + 2464) = 1;
            v11 = &dword_253E47158;
            if (!*(_DWORD *)(a1 + 2468))
              v11 = &dword_253E47070;
            v11[1] &= ~0x10u;
          }
        }
      }
      else if (*(_DWORD *)(a1 + 972) == *(_DWORD *)(a1 + 916))
      {
        v9 = *(_DWORD *)(a1 + 976);
        v10 = *(_DWORD *)(a1 + 920);
        goto LABEL_15;
      }
    }
  }
  v5 = *(unsigned __int16 *)(a1 + 2288);
  phOsalNfc_MemCopy();
  if (LODWORD(v12[0]) <= 3 && LODWORD(v12[0]) != 1)
    sub_21985210C(a1, v5, (uint64_t)v12, v12[0]);
LABEL_7:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StateDummy2Idle");
  return v5;
}

uint64_t sub_219851B94(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  const char *v7;
  int v8;
  unsigned int *v9;
  unsigned int *v11;
  int v12;
  uint64_t v13;
  int v14;
  int v15;
  char v16;
  uint64_t v17;
  uint64_t v18;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvNciHeaderCb");
  if (!a1)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a1);
  if (v6 != a1 || (v11 = *(unsigned int **)a1) == 0)
  {
LABEL_6:
    v7 = "phNciNfc_CoreRecvNciHeaderCb: Received invalid NCI context, Stopping TML Read";
    v8 = 2;
    v9 = (unsigned int *)a1;
    goto LABEL_7;
  }
  if (a2)
  {
    v12 = 1;
    sub_219851FF8(1, v11 + 1619, 3u, 4u, (uint64_t)"Pkt Header<-<-", *(_QWORD *)(a2 + 8));
    if (*(_WORD *)(a2 + 16) == 3)
    {
      v13 = *(_QWORD *)(a2 + 8);
      if (v13)
      {
        if (!*(_WORD *)a2)
        {
          v14 = *((unsigned __int8 *)v11 + 6241);
          v15 = *(unsigned __int8 *)(v13 + 2);
          if (v15 | v14)
          {
            sub_219851DC0(a1, 1, v15 + 2 * (v14 != 0));
            v12 = 0;
          }
          else
          {
            *(_QWORD *)(a1 + 2336) = v13;
            *(_WORD *)(a1 + 2344) = 3;
            *(_WORD *)(a1 + 2328) = 0;
            *(_WORD *)(a1 + 2288) = 0;
            sub_219853B08(*(unsigned int *)(a1 + 2468), 3u, 3u, (uint64_t)"Read", v13);
            sub_219851FF8(1, v11 + 1619, 3u, 4u, (uint64_t)"Response packet:", *(_QWORD *)(a1 + 2336));
            sub_219851308(a1, 0);
          }
        }
      }
    }
  }
  else
  {
    v12 = 1;
  }
  v16 = 0;
  v17 = 0;
  do
  {
    v18 = *((_QWORD *)&unk_253E46700 + 14 * v17 + 5);
    if ((v16 & 1) != 0)
      break;
    v16 = 1;
    v17 = 1;
  }
  while (v18 != a1);
  if (v18 == a1)
  {
    if (*(_BYTE *)(a1 + 2352) == 1)
    {
      if (*(_QWORD *)a1)
        sub_2198AE9A8(*(unsigned int **)a1);
      return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvNciHeaderCb");
    }
    if (!v12 || sub_219851DC0(a1, 0, 3) == 13)
      return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvNciHeaderCb");
    v9 = (unsigned int *)(a1 + 2468);
    v7 = "Tml Read request failed!";
    v8 = 1;
LABEL_7:
    sub_219850628(v8, v9, 3u, 1u, (uint64_t)v7);
  }
  return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvNciHeaderCb");
}

uint64_t sub_219851DC0(uint64_t a1, int a2, int a3)
{
  uint64_t v6;
  void *v7;
  uint64_t v8;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReqNciPkt");
  if (a1 && a3)
  {
    *(_WORD *)(a1 + 2440) = a3;
    *(_WORD *)(a1 + 2442) = 0;
    *(_BYTE *)(a1 + 2465) = 0;
    if (a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"phNciNfc_CoreReqNciPkt: Requesting Nci Pkt Payload");
      v6 = a1 + 643;
      v7 = sub_219851150;
    }
    else
    {
      v6 = a1 + 640;
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"phNciNfc_CoreReqNciPkt: Requesting Nci Pkt Header");
      v7 = sub_219851B94;
    }
    *(_QWORD *)(a1 + 2448) = v7;
    v8 = sub_219851ED0(a1, v6, a3);
  }
  else
  {
    v8 = 1;
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"Invalid input parameter");
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReqNciPkt");
  return v8;
}

uint64_t sub_219851ED0(uint64_t a1, uint64_t a2, int a3)
{
  char v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRequestTmlRead");
  if (!a1)
    goto LABEL_10;
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = *((_QWORD *)&unk_253E46700 + 14 * v7 + 5);
    if ((v6 & 1) != 0)
      break;
    v6 = 1;
    v7 = 1;
  }
  while (v8 != a1);
  if (a2 && a3 && v8 == a1)
  {
    if (phTmlNfc_Read() == 13)
    {
      v9 = 13;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Tml read request failed");
      sub_219886108(*(_QWORD *)(a1 + 632), 195);
      v9 = 255;
    }
  }
  else
  {
LABEL_10:
    v9 = 1;
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"Invalid input parameter");
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRequestTmlRead");
  return v9;
}

uint64_t sub_219851FF8(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5, uint64_t a6)
{
  uint64_t result;
  uint64_t v11;
  uint64_t v12;
  unsigned int v13;
  unsigned int v18;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result != 1)
  {
    if ((_DWORD)result)
    {
      if (qword_253E467C0)
        v12 = qword_253E467C0 + 32;
      else
        v12 = 0;
      if ((_DWORD)result != 255)
        goto LABEL_26;
      v11 = qword_253E46750;
      if (!qword_253E46750)
        goto LABEL_26;
    }
    else
    {
      v11 = qword_253E46750;
      if (!qword_253E46750)
        return result;
      v12 = 0;
    }
    v13 = *(_DWORD *)(v11 + 4 * a3 + 32);
    if (v13 >= a4 && v13 != 0 && a6 != 0 && a5 != 0 && v13 < 6)
      return phOsalNfc_LogHexData();
LABEL_26:
    if (!v12 || (_DWORD)result != 255)
      return result;
    goto LABEL_28;
  }
  if (!qword_253E467C0)
    return result;
  v12 = qword_253E467C0 + 32;
LABEL_28:
  v18 = *(_DWORD *)(v12 + 4 * a3);
  if (v18 >= a4 && v18 != 0 && a6 != 0 && a5 != 0 && v18 <= 5)
    return phOsalNfc_LogHexData();
  return result;
}

uint64_t sub_21985210C(uint64_t a1, uint64_t a2, uint64_t a3, int a4)
{
  uint64_t v8;
  uint64_t v9;
  _BYTE *v10;
  uint64_t v11;
  const char *v12;
  _BYTE *v13;
  uint64_t v14;
  int v15;
  _BYTE *Memory;
  int v17;
  BOOL v18;
  uint64_t v19;
  const char *v20;
  int v21;
  unsigned int v22;
  uint64_t v23;
  void (*v24)(uint64_t, uint64_t *, uint64_t);
  uint64_t v25;
  uint64_t v26;
  _QWORD *v27;
  const char *v28;
  unsigned int v29;
  unsigned int v30;
  void (*v31)(uint64_t, uint64_t *, uint64_t);
  uint64_t v32;
  _QWORD *v33;
  uint64_t v34;
  char v35;
  uint64_t v36;
  uint64_t v37;
  _BYTE *v38;
  char v39;
  uint64_t v40;
  uint64_t v41;
  uint64_t v42;
  uint64_t v44;
  unsigned __int8 *v45;
  unsigned int v46;
  int *v47;
  const char *v48;
  int v49;
  int v50;
  int v51;
  const char *v52;
  int *v53;
  char v54;
  unsigned __int16 v55;
  unsigned int v56;
  _QWORD v57[3];
  uint64_t v58;
  _BYTE *v59;
  uint64_t v60;
  unsigned __int8 v61;

  v58 = 0;
  v59 = 0;
  v60 = 0;
  v56 = 0;
  v55 = 0;
  v54 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvManager");
  v8 = 1;
  if (!a1)
    goto LABEL_83;
  if (!a3)
    goto LABEL_83;
  v9 = *(_QWORD *)a1;
  if (!*(_QWORD *)a1)
    goto LABEL_83;
  v10 = (_BYTE *)(v9 + 4769);
  memset(v57, 0, sizeof(v57));
  if ((a4 & 0xFFFFFFFE) == 2)
  {
    if (a4 == 2)
    {
      v11 = *(_QWORD *)(a1 + 2456);
      if (v11 && v11 != 0xFFFFFFFFFFFFLL && *(_BYTE *)(a1 + 2464) == 1
        || *(_BYTE *)(a1 + 2464) != 1
        || *(_BYTE *)(v9 + 6568) == 1
        || !sub_2198B00C4(*(_QWORD *)(a1 + 632), 20))
      {
        v8 = 0;
      }
      else
      {
        if (sub_21988F5D4(*(_QWORD *)(a1 + 632), &v54))
        {
          v8 = 255;
          v12 = "phNciNfc_CoreSend2-Failed to retrieve bIgnoreWkUpRet";
        }
        else
        {
          v8 = 0;
          if (v54)
            goto LABEL_21;
          v12 = "phNciNfc_CoreRecvManager1-Failed to De-Assert Wake Up Line";
        }
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)v12);
      }
LABEL_21:
      v15 = *(_DWORD *)(a3 + 8);
      BYTE1(v57[0]) = *(_DWORD *)(a3 + 4);
      BYTE2(v57[0]) = v15;
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Invoke response call back func if registered");
      v14 = a1 + 1008;
LABEL_22:
      if (!(_DWORD)v8)
      {
LABEL_25:
        v59 = 0;
        LODWORD(v60) = 0;
        if ((_DWORD)a2)
        {
LABEL_26:
          *(_DWORD *)(a1 + 544) = 0;
          goto LABEL_27;
        }
        v8 = sub_2198536D4(a1, (int *)&v56, (__int16 *)&v55);
        if ((_DWORD)v8)
        {
LABEL_82:
          sub_219853908(a1);
          goto LABEL_83;
        }
        sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Message size received: ");
        if (v55 == 1)
        {
          Memory = (_BYTE *)(*(_QWORD *)(a1 + 8 * *(unsigned __int8 *)(a1 + 952) + 928) + 3);
          v59 = Memory;
        }
        else
        {
          Memory = (_BYTE *)phOsalNfc_GetMemory();
          v59 = Memory;
          if (!Memory)
            goto LABEL_26;
        }
        LODWORD(v60) = v56;
        v44 = sub_2198535EC(a1, (uint64_t)Memory, v56);
        if ((_DWORD)v44)
        {
          v8 = v44;
          goto LABEL_79;
        }
        if (!v56)
          goto LABEL_26;
        v45 = *(unsigned __int8 **)(a1 + 2336);
        if (!v45)
          goto LABEL_26;
        v46 = *v45;
        if (v46 >> 5 == 3)
        {
          if ((v46 & 0xF) == 0 && (v45[1] & 0x3F) == 8)
          {
            sub_219851FF8(1, (unsigned int *)(a1 + 2468), 3u, 2u, (uint64_t)"Core interface error in Ntf packet", (uint64_t)v45);
            goto LABEL_27;
          }
        }
        else if (v46 >> 5 == 2)
        {
          if (sub_21988C2EC(*(_QWORD *)(a1 + 632), v46 & 0xF, v45[1] & 0x3F) || *Memory != 5)
          {
            if (*(_DWORD *)(a1 + 2468))
              v53 = &dword_253E47158;
            else
              v53 = &dword_253E47070;
            v53[1] &= ~0x10000000u;
          }
          else
          {
            if (*(_DWORD *)(a1 + 2468))
              v47 = &dword_253E47158;
            else
              v47 = &dword_253E47070;
            v47[1] |= 0x10000000u;
            if (!v10[1823])
            {
              sub_219851FF8(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Syntax error received in response packet", *(_QWORD *)(a1 + 2336));
              if (sub_2198B017C((unsigned int *)a1, 1u) == 13)
              {
                v8 = 13;
                goto LABEL_79;
              }
            }
          }
          goto LABEL_26;
        }
        if ((v46 & 0xFFFFFFEF) != 0x60)
          goto LABEL_26;
        v50 = v45[1] & 0x3F;
        if (v50 == 6)
        {
          v52 = "Core credit Ntf packet received";
        }
        else
        {
          if (v50 != 7)
            goto LABEL_26;
          v51 = v45[3];
          if (v51 == 240)
          {
            v10[1475] = 1;
LABEL_27:
            v61 = 0;
            sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreInvokeCb");
            if ((a4 | 2) != 2)
            {
              v21 = 0;
              if (!sub_219852A68((unsigned int *)a1, 0, v14, (unsigned __int8 *)v57, a4, &v61))
              {
                v29 = 0;
                do
                {
                  v30 = v61;
                  v31 = *(void (**)(uint64_t, uint64_t *, uint64_t))(v14 + 24 * v61 + 16);
                  if (v31)
                  {
                    v32 = v14 + 24 * v61;
                    v34 = *(_QWORD *)(v32 + 8);
                    v33 = (_QWORD *)(v32 + 8);
                    v31(v34, &v58, a2);
                    sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"Registered Ntf call back function invoked");
                    v35 = 0;
                    v36 = 0;
                    do
                    {
                      v37 = *((_QWORD *)&unk_253E46700 + 14 * v36 + 5);
                      if ((v35 & 1) != 0)
                        break;
                      v35 = 1;
                      v36 = 1;
                    }
                    while (v37 != a1);
                    if (v37 != a1)
                      goto LABEL_77;
                    v38 = (_BYTE *)(v14 + 24 * v30);
                    if (*v38 == 1)
                    {
                      *v38 = 0;
                      *(_WORD *)(v14 + 24 * v30 + 1) = 3843;
                      *v33 = 0;
                      v33[1] = 0;
                      sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"Notification call back de-registered as auto de-register is enabled");
                    }
                    v21 = 1;
                  }
                  else
                  {
                    sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"Registered Ntf call back function invok failed-Invalid fnc pointer");
                    v39 = 0;
                    v40 = 0;
                    do
                    {
                      v41 = *((_QWORD *)&unk_253E46700 + 14 * v40 + 5);
                      if ((v39 & 1) != 0)
                        break;
                      v39 = 1;
                      v40 = 1;
                    }
                    while (v41 != a1);
                    if (v41 != a1)
                      goto LABEL_49;
                    v21 = 0;
                  }
                  v61 = v30 + 1;
                  if ((v30 + 1) == 48 || v29 >= 0x2F)
                    goto LABEL_48;
                  ++v29;
                }
                while (!sub_219852A68((unsigned int *)a1, 0, v14, (unsigned __int8 *)v57, a4, &v61));
              }
              sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"End of list reached");
LABEL_48:
              if (!v21)
              {
LABEL_49:
                v8 = 255;
                goto LABEL_78;
              }
LABEL_77:
              v8 = 0;
              goto LABEL_78;
            }
            if (sub_219852A68((unsigned int *)a1, 0, v14, (unsigned __int8 *)v57, a4, &v61))
            {
              sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"Response/Data call back not registered");
LABEL_30:
              v8 = 255;
LABEL_78:
              sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreInvokeCb");
              Memory = v59;
LABEL_79:
              if (Memory && v55 >= 2u)
              {
                phOsalNfc_FreeMemory();
                v59 = 0;
                LODWORD(v60) = 0;
              }
              goto LABEL_82;
            }
            v22 = v61;
            v23 = v14 + 24 * v61;
            if (a4 == 2)
            {
              v24 = *(void (**)(uint64_t, uint64_t *, uint64_t))(v23 + 16);
              if (v24)
              {
                v25 = v14 + 24 * v61;
                v27 = (_QWORD *)(v25 + 8);
                v26 = *(_QWORD *)(v25 + 8);
                sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"Registered Rsp call back function invoked");
                if (*(_BYTE *)v25 == 1)
                {
                  *(_BYTE *)v25 = 0;
                  *(_WORD *)(v14 + 24 * v22 + 1) = 3843;
                  v28 = "Response call back de-registered as auto de-register is enabled";
LABEL_75:
                  *v27 = 0;
                  v27[1] = 0;
                  sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)v28);
                  goto LABEL_76;
                }
                goto LABEL_76;
              }
              v48 = "Registered Rsp call back function invoke failed-Invalid fnc pointer!";
            }
            else
            {
              v24 = *(void (**)(uint64_t, uint64_t *, uint64_t))(v23 + 16);
              if (v24)
              {
                v42 = v14 + 24 * v61;
                v27 = (_QWORD *)(v42 + 8);
                v26 = *(_QWORD *)(v42 + 8);
                sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"Registered Data call back function invoked");
                if (*(_BYTE *)v42 == 1)
                {
                  *(_BYTE *)v42 = 0;
                  *(_BYTE *)(v14 + 24 * v22 + 1) = 0;
                  v28 = "Data call back de-registered as auto de-register is enabled";
                  goto LABEL_75;
                }
LABEL_76:
                v24(v26, &v58, a2);
                goto LABEL_77;
              }
              v48 = "Registered Data call back function invoke failed-Invalid fnc pointer!";
            }
            sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)v48);
            goto LABEL_30;
          }
          if (v51 != 5)
            goto LABEL_26;
          *v10 = 1;
          v52 = "Core generic error in Ntf packet before very first reset";
        }
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)v52);
        goto LABEL_27;
      }
      goto LABEL_83;
    }
    v13 = *(_BYTE **)(a1 + 2336);
    if ((*v13 & 0xF) != 0 || ((v17 = v13[1] & 0x3F, v17 != 8) ? (v18 = v17 == 6) : (v18 = 1), !v18))
    {
      v8 = 0;
LABEL_19:
      BYTE1(v57[0]) = *(_BYTE *)(a3 + 4);
      BYTE2(v57[0]) = *(_BYTE *)(a3 + 8);
      dword_253E47070 = dword_253E47070 & 0xFFFFFFF | (sub_219852BC4((unsigned int *)v9, BYTE1(v57[0]), BYTE2(v57[0])) << 28);
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Invoke notification call back func if registered");
      v14 = a1 + 1032;
      goto LABEL_22;
    }
    v8 = 0;
    v19 = *(_QWORD *)(a1 + 2456);
    if (!v19 || v19 == 0xFFFFFFFFFFFFLL)
      goto LABEL_19;
    if (*(_BYTE *)(a1 + 2464) == 1)
    {
      if (phOsalNfc_Timer_Stop())
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"phNciNfc_CoreRecvManager-Failed to Stop De-Assert Wake Up Line Timer");
      v8 = phOsalNfc_Timer_Delete();
      if (!(_DWORD)v8)
        goto LABEL_113;
      v20 = "phNciNfc_CoreRecvManager-Failed to Delete De-Assert Wake Up Line Timer";
    }
    else
    {
      if (phOsalNfc_Timer_Stop())
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"phNciNfc_CoreRecvManager-Failed to Delete De-Assert Wake Up Line Timer");
      v49 = phOsalNfc_Timer_Delete();
      if (v49)
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"phNciNfc_CoreRecvManager-Failed to Delete De-Assert Wake Up Line Timer");
      if (*(_BYTE *)(v9 + 6568) != 1)
        v49 = sub_2198B00C4(*(_QWORD *)(a1 + 632), 20);
      v8 = 0;
      if (!v49)
        goto LABEL_113;
      v20 = "phNciNfc_CoreRecvManager2-Fialed to Stop De-Assert Wake Up Line";
    }
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)v20);
LABEL_113:
    *(_QWORD *)(a1 + 2456) = 0xFFFFFFFFFFFFLL;
    goto LABEL_19;
  }
  if (!a4)
  {
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Invoke data call back func if registered");
    v14 = a1 + 2184;
    BYTE3(v57[0]) = *(_BYTE *)(a3 + 12);
    goto LABEL_25;
  }
  sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Invalid message type!");
LABEL_83:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvManager");
  return v8;
}

uint64_t sub_219852A68(unsigned int *a1, int a2, uint64_t a3, unsigned __int8 *a4, int a5, _BYTE *a6)
{
  unsigned int v12;
  unsigned int v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;
  _BOOL4 v18;
  unsigned __int8 *v19;
  _BYTE *v20;
  int v21;
  int v22;
  uint64_t v23;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreGetIndex");
  v12 = a5 & 0xFFFFFFFE;
  if (a5 == 2)
    v13 = 1;
  else
    v13 = 48;
  if (v12 == 2)
  {
    v14 = a3;
  }
  else
  {
    v13 = 3;
    v14 = 0;
  }
  if (v12 == 2)
    v15 = 0;
  else
    v15 = a3;
  v16 = *a6;
  if (v13 > v16)
  {
    v18 = v12 == 2 && v14 != 0;
    v19 = (unsigned __int8 *)(v14 + 24 * v16 + 1);
    v20 = (_BYTE *)(v15 + 24 * v16);
    do
    {
      if (a2)
      {
        if (v18)
        {
          if (!*(v19 - 1))
            goto LABEL_36;
        }
        else if (v15 && !*v20)
        {
LABEL_36:
          v23 = 0;
          *a6 = v16;
          goto LABEL_35;
        }
      }
      else
      {
        if (v18)
        {
          if (!*(v19 - 1) || a4[1] != *v19)
            goto LABEL_33;
          v21 = a4[2];
          v22 = v19[1];
        }
        else
        {
          if (!v15 || !*v20)
            goto LABEL_33;
          v21 = a4[3];
          v22 = v20[1];
        }
        if (v21 == v22)
          goto LABEL_36;
      }
LABEL_33:
      LODWORD(v16) = v16 + 1;
      v19 += 24;
      v20 += 24;
    }
    while (v13 > v16);
  }
  v23 = 255;
LABEL_35:
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreGetIndex");
  return v23;
}

uint64_t sub_219852BC4(unsigned int *a1, int a2, unsigned int a3)
{
  uint64_t v6;
  unsigned int v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetNciNtfId");
  if (a2 == 1)
  {
    v8 = a3 - 2;
    v6 = 0;
    switch(v8)
    {
      case 0u:
        v6 = 5;
        break;
      case 1u:
        v6 = 6;
        break;
      case 2u:
        break;
      case 3u:
        v6 = 7;
        break;
      case 4u:
        v6 = 8;
        break;
      case 5u:
        v6 = 9;
        break;
      case 6u:
        v6 = 10;
        break;
      case 7u:
        v6 = 11;
        break;
      case 8u:
        v6 = 12;
        break;
      default:
        v6 = 0;
        break;
    }
  }
  else if (a2 || a3 >= 9)
  {
    v6 = 0;
  }
  else
  {
    v6 = byte_21990A2F0[(char)a3];
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetNciNtfId");
  return v6;
}

uint64_t sub_219852CDC(uint64_t a1, uint64_t a2, _DWORD *a3)
{
  uint64_t v6;

  v6 = a1;
  sub_219850718(0, (unsigned int *)&v6, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvConvertStatus2Evt");
  if (a3)
  {
    if ((_DWORD)a2)
    {
      sub_219850628(0, (unsigned int *)&v6, 3u, 1u, (uint64_t)"Unknown Event");
      a2 = 255;
    }
    else
    {
      *a3 = 0;
    }
  }
  else
  {
    a2 = 1;
    sub_219850628(0, (unsigned int *)&v6, 3u, 1u, (uint64_t)"Invalid parameter!");
  }
  sub_219850808(0, (unsigned int *)&v6, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvConvertStatus2Evt");
  return a2;
}

uint64_t sub_219852D98(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  uint64_t v6;
  int v7;
  unsigned int *v8;
  unsigned __int8 *v9;
  unsigned int v10;
  int v12;
  _BYTE *v14;
  int *v15;
  char v16;
  char v17;
  int v18;
  int *v19;
  char v20;
  char v21;
  unsigned int v22;
  uint64_t v23;
  uint64_t v24;
  uint64_t v25;
  int *v26;
  char v27;
  char v28;
  unsigned int v29;
  uint64_t v30;
  char v31;
  uint64_t v32;
  uint64_t v33;
  uint64_t v34;
  uint64_t v35;
  uint64_t v36;

  v34 = 0;
  v35 = 0;
  v36 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvChkPktType");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 != a1)
  {
LABEL_6:
    v5 = "Critical failure: Invalid Nci Core context!";
    v6 = 1;
    v7 = 3;
    v8 = (unsigned int *)a1;
LABEL_11:
    sub_219850628(v7, v8, 3u, 1u, (uint64_t)v5);
    goto LABEL_12;
  }
  v9 = *(unsigned __int8 **)(a1 + 2336);
  if (!v9 || (v10 = *(unsigned __int16 *)(a1 + 2344), !*(_WORD *)(a1 + 2344)) || *(_WORD *)(a1 + 2328))
  {
    v8 = (unsigned int *)(a1 + 2468);
    v5 = "Critical failure: Invalid Tml buffer received or length of payload in                               tml buffer "
         "is 0 or Tml read is not success!";
    v6 = 1;
    v7 = 1;
    goto LABEL_11;
  }
  v12 = *v9 >> 5;
  if ((v12 - 2) < 2 || v12 == 0)
  {
    v14 = (_BYTE *)(*(_QWORD *)a1 + 6241);
    if (*v14)
    {
      LOWORD(v10) = v10 - 2;
      *(_WORD *)(a1 + 2344) = v10;
    }
    if (!sub_219850068(a1, v9, (unsigned __int16)v10))
    {
      if (*v14
        && v14[1] != 1
        && (v24 = sub_2198531C4(a1, *(unsigned __int8 **)(a1 + 2336), (unsigned __int16)(*(_WORD *)(a1 + 2344) + 2)),
            (_DWORD)v24))
      {
        sub_219859F08(*(_QWORD *)a1, 0, v24);
        v6 = 2;
        v18 = 34;
      }
      else
      {
        v18 = 0;
        v6 = 0;
      }
      goto LABEL_60;
    }
    if (*(_DWORD *)(a1 + 2468))
      v15 = &dword_253E47158;
    else
      v15 = &dword_253E47070;
    v15[1] |= 2u;
    v16 = 1;
    sub_219851FF8(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Received packet validation failed", *(_QWORD *)(a1 + 2336));
    v6 = 0;
    while (*((_QWORD *)&unk_253E46700 + 14 * v6) != *(_QWORD *)(a1 + 632))
    {
      v17 = v16;
      v16 = 0;
      v6 = 1;
      if ((v17 & 1) == 0)
      {
        v18 = 245;
        goto LABEL_60;
      }
    }
    goto LABEL_38;
  }
  if (v12 == 1)
  {
    if (*(_DWORD *)(a1 + 2468))
      v19 = &dword_253E47158;
    else
      v19 = &dword_253E47070;
    v19[1] |= 2u;
    if (v10 <= 0xFF)
      sub_219851FF8(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"NFCC Sends Command Packet Type, droping...", (uint64_t)v9);
    v6 = 0;
    v20 = 1;
    while (1)
    {
      v21 = v20;
      if (*((_QWORD *)&unk_253E46700 + 14 * v6) == *(_QWORD *)(a1 + 632))
        break;
      v20 = 0;
      v6 = 1;
      if ((v21 & 1) == 0)
        goto LABEL_59;
    }
LABEL_38:
    v22 = *((_DWORD *)&unk_253E46700 + 28 * v6 + 2);
    if (v22 <= 1)
    {
      v23 = *((_QWORD *)&unk_253E46700 + 14 * v22 + 10);
      if (v23)
        *(_WORD *)(v23 + 152) = 80;
    }
    v6 = 1;
    goto LABEL_59;
  }
  v25 = 0;
  if (*(_DWORD *)(a1 + 2468))
    v26 = &dword_253E47158;
  else
    v26 = &dword_253E47070;
  v26[1] |= 2u;
  v27 = 1;
  while (1)
  {
    v28 = v27;
    if (*((_QWORD *)&unk_253E46700 + 14 * v25) == *(_QWORD *)(a1 + 632))
      break;
    v27 = 0;
    v25 = 1;
    if ((v28 & 1) == 0)
      goto LABEL_57;
  }
  v29 = *((_DWORD *)&unk_253E46700 + 28 * v25 + 2);
  if (v29 <= 1)
  {
    v30 = *((_QWORD *)&unk_253E46700 + 14 * v29 + 10);
    if (v30)
      *(_WORD *)(v30 + 152) = 80;
  }
LABEL_57:
  v6 = 1;
  if (v10 <= 0xFF)
  {
    sub_219851FF8(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"NFCC Sends Unknown Packet Type, droping...", (uint64_t)v9);
    LODWORD(v34) = 1;
    v35 = *(_QWORD *)(a1 + 2336);
    LODWORD(v36) = *(unsigned __int16 *)(a1 + 2344);
    v18 = 245;
    sub_219859E40(*(_QWORD *)a1, (uint64_t)&v34, 245);
    goto LABEL_60;
  }
LABEL_59:
  v18 = 245;
LABEL_60:
  v31 = 0;
  v32 = 0;
  do
  {
    v33 = *((_QWORD *)&unk_253E46700 + 14 * v32 + 5);
    if ((v31 & 1) != 0)
      break;
    v31 = 1;
    v32 = 1;
  }
  while (v33 != a1);
  if (v33 == a1 && (v18 == 245 || v18 == 34))
  {
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 2u, (uint64_t)"Rxd corrupted pkt from TML,Flush TML TxRx buffs and place hdr read req");
    phTmlNfc_ReadAbort();
    phTmlNfc_FlushTxRxBuffers();
  }
LABEL_12:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvChkPktType");
  return v6;
}

uint64_t sub_2198531C4(uint64_t a1, unsigned __int8 *a2, unsigned int a3)
{
  uint64_t v6;
  int v7;
  uint64_t v8;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsVerifyCrc");
  if (a1 && a2 && a3)
  {
    v6 = a3 - 2;
    v7 = a2[a3 - 1] | (a2[v6] << 8);
    if (v7 == sub_219853A48(*(_QWORD *)(a1 + 632), a2, (unsigned __int16)v6))
    {
      v8 = 0;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Incorrect CRC ");
      sub_219851888(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Received CRC: ");
      sub_219851888(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Calculated CRC: ");
      v8 = 34;
    }
  }
  else
  {
    sub_219850628(3, (unsigned int *)a1, 3u, 2u, (uint64_t)"Invalid parameter received");
    v8 = 1;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsVerifyCrc");
  return v8;
}

uint64_t sub_2198532FC(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvChkPbfAndUpdate");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"NCI Receive Connector - Check PBF & Update");
    if ((**(_BYTE **)(a1 + 2336) & 0x10) != 0)
    {
      sub_2198C680C(a1);
      v5 = 1;
    }
    else if (sub_219853424((unsigned int *)a1))
    {
      sub_2198C680C(a1);
      v5 = 0;
    }
    else
    {
      v5 = 0;
      *(_QWORD *)(a1 + 928) = a1 + 640;
      *(_BYTE *)(a1 + 952) = 0;
    }
    sub_2198534E8(a1, *(_WORD *)(a1 + 2344));
  }
  else
  {
LABEL_6:
    sub_219850628(3, (unsigned int *)a1, 3u, 1u, (uint64_t)"Critical failure: Invalid Core context handle!");
    v5 = 0;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvChkPbfAndUpdate");
  return v5;
}

uint64_t sub_219853424(unsigned int *a1)
{
  char v2;
  uint64_t v3;
  unsigned int *v4;
  unsigned __int8 v5;
  unsigned int v6;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_GetActiveHeadCount");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    v6 = 0;
    v5 = 0;
    do
    {
      if (*(_QWORD *)&a1[2 * v5 + 232])
        ++v5;
    }
    while (v6++ < 2);
  }
  else
  {
LABEL_6:
    v5 = 0;
  }
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_GetActiveHeadCount");
  return v5;
}

uint64_t sub_2198534E8(uint64_t a1, __int16 a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  const char *v7;
  unsigned int *v8;
  uint64_t v10;
  uint64_t v11;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUpdatePacketLen");
  if (!a1)
  {
    v7 = "NULL Nci Core context!";
    v8 = 0;
    goto LABEL_8;
  }
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a1);
  if (v6 != a1)
  {
    v7 = "INVALID Nci Core context!";
    v8 = (unsigned int *)a1;
LABEL_8:
    sub_219850628(3, v8, 3u, 1u, (uint64_t)v7);
    return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUpdatePacketLen");
  }
  v10 = *(_QWORD *)(a1 + 8 * *(unsigned __int8 *)(a1 + 952) + 928);
  if (v10)
  {
    do
    {
      v11 = v10;
      v10 = *(_QWORD *)(v10 + 264);
    }
    while (v10);
    *(_WORD *)(v11 + 260) = a2;
  }
  else
  {
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 2u, (uint64_t)"List is empty, can not update length");
  }
  return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUpdatePacketLen");
}

uint64_t sub_2198535EC(uint64_t a1, uint64_t a2, unsigned int a3)
{
  uint64_t v6;
  uint64_t v7;
  BOOL v8;
  unsigned int v10;
  unsigned __int16 v12;
  unsigned int v13;

  v13 = 0;
  v12 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreGetData");
  v6 = 1;
  if (a1 && a2)
  {
    v7 = *(_QWORD *)(a1 + 8 * *(unsigned __int8 *)(a1 + 952) + 928);
    sub_2198536D4(a1, (int *)&v13, (__int16 *)&v12);
    if (v7)
      v8 = v13 == 0;
    else
      v8 = 1;
    if (v8 || v12 == 0)
    {
      v6 = 0;
    }
    else
    {
      v6 = 8 * (v13 > a3);
      if (v13 >= a3)
        v10 = a3;
      else
        v10 = v13;
      sub_2198537E0((unsigned int *)a1, v7, v12, a2, v10);
    }
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreGetData");
  return v6;
}

uint64_t sub_2198536D4(uint64_t a1, int *a2, __int16 *a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  int v9;
  __int16 v10;
  int v11;
  int v12;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreGetDataLength");
  v6 = 1;
  if (a1 && a2 && a3)
  {
    v7 = *(_QWORD *)(a1 + 8 * *(unsigned __int8 *)(a1 + 952) + 928);
    if (v7)
    {
      v8 = *(_QWORD *)(v7 + 264);
      if (v8)
      {
        v9 = 0;
        v10 = 1;
        do
        {
          v11 = *(unsigned __int16 *)(v7 + 260);
          v7 = v8;
          ++v10;
          v9 += v11;
          v8 = *(_QWORD *)(v8 + 264);
        }
        while (v8);
        v6 = 0;
        v12 = v9 - (unsigned __int16)(3 * v10) + *(unsigned __int16 *)(v7 + 260);
      }
      else
      {
        v6 = 0;
        v12 = *(unsigned __int16 *)(v7 + 260) - 3;
        v10 = 1;
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 2u, (uint64_t)"Invalid Data in Head!!!");
      v12 = 0;
      v10 = 0;
      v6 = 255;
    }
    *a2 = v12;
    *a3 = v10;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreGetDataLength");
  return v6;
}

uint64_t sub_2198537E0(unsigned int *a1, uint64_t a2, unsigned int a3, uint64_t a4, unsigned int a5)
{
  uint64_t v10;
  int i;
  unsigned int v12;
  unsigned int v13;
  uint64_t v14;
  unsigned int v16;

  v16 = 255;
  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreExtractData");
  if (a1)
    v16 = a1[617];
  v10 = 0;
  if (a3 && a2 && a4)
  {
    v10 = 0;
    for (i = 0; a3 > i; ++i)
    {
      v12 = *(unsigned __int16 *)(a2 + 260) - 3;
      if (*(_WORD *)(a2 + 260) != 3)
      {
        v13 = a5 - v10;
        if (a5 <= v10)
        {
          sub_219850628(1, &v16, 3u, 4u, (uint64_t)"Reached end of user buffer");
          break;
        }
        if (v13 >= v12)
          v14 = v12;
        else
          v14 = v13;
        phOsalNfc_MemCopy();
        a2 = *(_QWORD *)(a2 + 264);
        v10 = (v14 + v10);
        if (!a2)
          break;
        a4 += v14;
      }
    }
  }
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreExtractData");
  return v10;
}

uint64_t sub_219853908(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t i;
  uint64_t v7;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreDeleteList");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    v5 = *(_QWORD *)(a1 + 640 + 8 * *(unsigned __int8 *)(a1 + 952) + 288);
    if (v5 != a1 + 640)
    {
      if (v5)
      {
        for (i = *(_QWORD *)(v5 + 264); i; i = *(_QWORD *)(v7 + 264))
        {
          v7 = i;
          phOsalNfc_FreeMemory();
        }
        phOsalNfc_FreeMemory();
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"List is empty");
      }
    }
    *(_QWORD *)(a1 + 8 * *(unsigned __int8 *)(a1 + 952) + 928) = 0;
    *(_BYTE *)(a1 + 952) = 0;
    *(_QWORD *)(a1 + 904) = 0;
    *(_WORD *)(a1 + 900) = 0;
  }
  else
  {
LABEL_6:
    sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"Invalid Core context passed");
  }
  return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreDeleteList");
}

uint64_t sub_219853A48(uint64_t a1, unsigned __int8 *a2, unsigned int a3)
{
  uint64_t v5;
  unsigned __int16 v6;
  int v7;
  uint64_t v9;

  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 3u, 5u, (uint64_t)"phNciNfc_CalcCrc16");
  if (a2 && a3)
  {
    v5 = a3;
    v6 = -1;
    do
    {
      v7 = *a2++;
      v6 = word_21990A968[v7 ^ ((unsigned __int16)(v6 & 0xFF00) >> 8)] ^ (v6 << 8);
      --v5;
    }
    while (v5);
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v9, 3u, 1u, (uint64_t)"Invalid Params supplied!!");
    v6 = -1;
  }
  sub_219850808(0, (unsigned int *)&v9, 3u, 5u, (uint64_t)"phNciNfc_CalcCrc16");
  return v6;
}

uint64_t sub_219853B08(uint64_t result, unsigned int a2, unsigned int a3, uint64_t a4, uint64_t a5)
{
  _BYTE *v5;
  uint64_t v10;
  unsigned int v11;
  unsigned int v16;
  int v18;
  BOOL v19;
  _BOOL4 v20;

  if (result <= 1)
  {
    v5 = (_BYTE *)*((_QWORD *)&unk_253E46700 + 14 * result + 10);
    if (v5)
    {
      v10 = a2;
      v11 = v5[a2 + 16];
      if (v11 >= a3 && a5 != 0 && a4 != 0 && a2 == 1 && v11 == 3)
        result = phOsalNfc_SignPostLogHexData();
      v16 = *(_DWORD *)&v5[4 * v10 + 32];
      if (v16 >= a3 && v16 - 1 <= 4)
      {
        v18 = *v5;
        if (a2 == 1 && !*v5 || a2 == 3 && v18 == 1 || a2 == 6 && v18 == 2)
        {
          if (a4 && a5)
            return phOsalNfc_LogHexData();
        }
        else if (v18 == 3)
        {
          v19 = a2 == 6 || a2 == 3;
          v20 = v19;
          if (a5 && v20 && a4)
            return phOsalNfc_LogHexData();
        }
      }
    }
  }
  return result;
}

uint64_t sub_219853C54(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  void (*v7)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;

  v9 = 0;
  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSwioPadSensrNtf");
  v6 = 1;
  if (a2 && a1 && *(_QWORD *)(a2 + 8))
  {
    v9 = *(_QWORD *)(a2 + 8);
    LODWORD(v10) = *(_DWORD *)(a2 + 16);
    v7 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 568);
    if (v7)
      v7(*(_QWORD *)(a1 + 560), 37, &v9, 0);
    else
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_ProcessSwioPadSensrNtf:pPropSwioPadNtfCb call back is not registered so dropped at NCI");
    v6 = a3;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSwioPadSensrNtf");
  return v6;
}

uint64_t sub_219853D30(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned __int8 *v6;
  unsigned int v7;
  _BOOL4 v8;
  const char *v9;
  void (*v10)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;

  v12 = 0;
  v13 = 0;
  v14 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfFieldInfoNtfHandler");
  if (a1)
  {
    if (a2 && (v6 = *(unsigned __int8 **)(a2 + 8)) != 0)
    {
      if (*(_DWORD *)(a2 + 16) == 1)
      {
        v7 = *v6;
        if (v7 <= 1)
        {
          v8 = v7 != 0;
          if (v7)
            v9 = "RF Field ON";
          else
            v9 = "RF Field OFF";
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)v9);
          LODWORD(v12) = v8;
          v13 = a1 + 3968;
          v10 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 232);
          if (v10)
            v10(*(_QWORD *)(a1 + 224), 6, &v12, 0);
        }
      }
    }
    else
    {
      a3 = 1;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfFieldInfoNtfHandler");
  return a3;
}

uint64_t sub_219853E34(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5)
{
  uint64_t result;
  unsigned int v9;
  unsigned int v11;
  BOOL v12;
  BOOL v13;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result != 1)
  {
    if ((_DWORD)result || !qword_253E46750 || !a5)
      return result;
    v9 = *(unsigned __int8 *)(qword_253E46750 + a3 + 16);
    if (v9 < a4 || v9 - 6 < 0xFFFFFFFB)
      return result;
    return phOsalNfc_SignPostLogStr();
  }
  if (qword_253E467C0)
  {
    v11 = *(unsigned __int8 *)(qword_253E467C0 + a3 + 16);
    v12 = *(_BYTE *)(qword_253E467C0 + a3 + 16) && v11 >= a4;
    v13 = !v12 || a5 == 0;
    if (!v13 && v11 <= 5)
      return phOsalNfc_SignPostLogStr();
  }
  return result;
}

uint64_t sub_219853EE0(uint64_t a1, int a2, unsigned __int8 **a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t, uint64_t *);
  uint64_t v7;
  unsigned __int8 *v8;
  int v9;
  int v10;
  __int16 v11;
  const char *v12;
  int v13;
  unsigned int *v14;
  uint64_t v16;

  v16 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SwioPadNtfHandler");
  if (a2 != 37 || !a1 || !a3)
  {
    v12 = "phLibNfc_SwioPadNtfHandler: Can not process SWIO Pad Ntf - Invalid input parameters";
    v13 = 2;
    v14 = (unsigned int *)a1;
LABEL_13:
    sub_219850628(v13, v14, 4u, 2u, (uint64_t)v12);
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SwioPadNtfHandler");
  }
  v6 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t *))(a1 + 6568);
  v7 = *(_QWORD *)(a1 + 6576);
  phOsalNfc_SetMemory();
  v8 = *a3;
  if (!*a3 || (v9 = *v8, (v9 - 17) > 1))
  {
    v12 = "phLibNfc_SwioPadNtfHandler: Info buffer not valid";
    v13 = 1;
    v14 = (unsigned int *)(a1 + 19368);
    goto LABEL_13;
  }
  if (v9 == 17)
    v10 = 1;
  else
    v10 = 2;
  LODWORD(v16) = v10;
  v11 = v8[1];
  WORD2(v16) = v11;
  WORD2(v16) = v11 | (v8[2] << 8);
  if (v6)
    v6(*(_QWORD *)(a1 + 19360), v7, 76, &v16);
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SwioPadNtfHandler");
}

uint64_t phLibNfc_Mgt_ConfigureDiscovery(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  uint64_t v11;
  int v12;
  int v13;
  uint64_t v14;
  uint64_t v15;
  char v16;
  const char *v17;
  char v19;
  uint64_t v20;
  uint64_t v21;
  uint64_t v22;
  int v23;
  char v24;
  uint64_t v25;
  uint64_t v26;
  uint64_t v27;
  int v28;
  uint64_t v29;

  v29 = a1;
  v28 = a2;
  v27 = 0;
  sub_219885F70(0, (unsigned int *)&v29, 4u, 114, (uint64_t)"phLibNfc_Mgt_ConfigureDiscovery");
  sub_219850718(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureDiscovery");
  v9 = sub_21987AB04(v29, &v27);
  if ((_DWORD)v9 != 111 && (_DWORD)v9 != 0)
  {
    v14 = v9;
    LODWORD(v15) = 143;
    goto LABEL_18;
  }
  if (!a4)
  {
    v14 = 1;
LABEL_45:
    sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureDiscovery");
    sub_219885F70(0, (unsigned int *)&v29, 4u, 114, (uint64_t)"phLibNfc_Mgt_ConfigureDiscovery");
LABEL_46:
    LODWORD(v15) = 136;
LABEL_47:
    sub_2198D2284(v29, v15);
    sub_219886108(v29, v14);
    return v14;
  }
  v11 = v27;
  if (*(_BYTE *)(v27 + 2946) == 1
    || (v12 = *(_DWORD *)a3, (*(_DWORD *)a3 & 0x38000) != 0)
    && *(_BYTE *)(v27 + 2944) != 1
    && *(_BYTE *)(v27 + 2942) != 1
    && *(_BYTE *)(v27 + 2943) != 1
    && (*(_BYTE *)(v27 + 2939) != 1 || *(_BYTE *)(v27 + 3088) != 2))
  {
LABEL_44:
    v14 = 51;
    goto LABEL_45;
  }
  v13 = *(unsigned __int8 *)(v27 + 2937);
  if ((v12 & 0x800) != 0)
  {
    if (v13 == 1)
      goto LABEL_29;
    if (*(_BYTE *)(v27 + 2936) != 1 && *(_BYTE *)(v27 + 2944) != 1 && *(_BYTE *)(v27 + 2938) != 1)
      goto LABEL_44;
  }
  if ((v12 & 0x6000) != 0)
  {
    if (v13 != 1)
    {
      if (*(_BYTE *)(v27 + 2938) != 1)
      {
        if (*(_BYTE *)(v27 + 2944) != 1)
          goto LABEL_44;
LABEL_31:
        if (*(_BYTE *)(v27 + 2944) != 1)
        {
          if (*(_BYTE *)(a3 + 84) == 1)
          {
            v17 = "LPCD Assistance mode is not applicable for this platform";
LABEL_43:
            sub_219850628(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)v17);
            goto LABEL_44;
          }
          if (*(_BYTE *)(a3 + 85) == 1)
          {
            v17 = "LPCD Assistance Exit Notification is not applicable for this platform";
            goto LABEL_43;
          }
        }
      }
LABEL_39:
      v16 = 0;
      goto LABEL_40;
    }
  }
  else if (v13 != 1)
  {
    if (*(_BYTE *)(v27 + 2938) != 1)
      goto LABEL_31;
    goto LABEL_39;
  }
LABEL_29:
  v16 = 1;
LABEL_40:
  if (a2 == 3 && *(_BYTE *)(v27 + 2939) != 1)
  {
    v17 = "MultiTag feature is not applicable for this platform";
    goto LABEL_43;
  }
  if (a2 || (*(_DWORD *)(a3 + 88) - 1) > 2 || *(_BYTE *)(v27 + 2938) == 1 || *(_BYTE *)(v27 + 2944) == 1)
  {
    v19 = *(_BYTE *)(a3 + 12);
    if ((v19 & 8) == 0)
      goto LABEL_62;
    if ((v16 & 1) == 0 && *(_BYTE *)(v27 + 2938) != 1 && *(_BYTE *)(v27 + 2944) != 1 && *(_BYTE *)(v27 + 2936) != 1)
    {
      v19 &= ~8u;
      *(_BYTE *)(a3 + 12) = v19;
      goto LABEL_62;
    }
    goto LABEL_61;
  }
  if ((v16 & 1) == 0)
  {
    v17 = "Enable/Disable SE based Reader Mode feature is not applicable for this platform";
    goto LABEL_43;
  }
  v19 = *(_BYTE *)(a3 + 12);
  if ((v19 & 8) != 0)
  {
LABEL_61:
    *(_BYTE *)(a3 + 9) |= 1u;
    v19 &= 0xF8u;
    *(_BYTE *)(a3 + 12) = v19;
    v12 &= 0xFFF3FFFF;
    *(_DWORD *)a3 = v12;
  }
LABEL_62:
  if ((v19 & 7) != 0)
  {
    v12 |= 0x80000u;
    *(_DWORD *)a3 = v12;
  }
  if ((v12 & 0x800) != 0
    || (v12 & 0x1000) != 0
    && (*(_BYTE *)(v11 + 2936) == 1
     || *(_BYTE *)(v11 + 2937) == 1
     || *(_BYTE *)(v11 + 2938) == 1
     || *(_BYTE *)(v11 + 2939) == 1
     || *(_BYTE *)(v11 + 2944) == 1))
  {
    v12 |= 1u;
  }
  *(_DWORD *)a3 = v12 & 0xFFFFFFBF;
  *(_DWORD *)(v11 + 1360) = 6;
  *(_WORD *)(v11 + 1400) = 0;
  *(_WORD *)(v11 + 1422) = 0;
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  v20 = v27;
  *(_BYTE *)(v27 + 19354) = 0;
  *(_BYTE *)(v20 + 1426) = 0;
  sub_219865494(*(_QWORD *)(v20 + 3040), 0);
  sub_219902558(*(_QWORD *)(v27 + 3040));
  v21 = v27;
  v22 = *(_QWORD *)(v27 + 720);
  if (v22 && v22 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Delete();
    v21 = v27;
    *(_QWORD *)(v27 + 720) = 0xFFFFFFFFFFFFLL;
  }
  v23 = sub_2198D6F20(v21, a3);
  if (a2 == 3)
  {
    v24 = 0;
    v15 = 138;
  }
  else if (v23)
  {
    v24 = 0;
    if (*(_DWORD *)(a3 + 88) == 3)
      v15 = 46;
    else
      v15 = 137;
  }
  else
  {
    v15 = 136;
    v24 = 1;
  }
  phOsalNfc_MemCopy();
  v14 = sub_2198D1B2C(v29, v15, 0, (uint64_t)&v28, v27 + 1096);
  if ((_DWORD)v14 == 13)
  {
    v25 = v27;
    *(_QWORD *)(v27 + 6248) = a4;
    *(_QWORD *)(v25 + 6256) = a5;
    if (v28 != 1)
    {
      phOsalNfc_MemCopy();
      v25 = v27;
    }
    v26 = *(_QWORD *)(v25 + 3040);
    if (v26)
      *(_BYTE *)(v26 + 6466) = v24;
    sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureDiscovery");
    return 13;
  }
LABEL_18:
  sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureDiscovery");
  if ((_DWORD)v14 != 13)
  {
    sub_219885F70(0, (unsigned int *)&v29, 4u, 114, (uint64_t)"phLibNfc_Mgt_ConfigureDiscovery");
    if ((_DWORD)v14)
    {
      if ((_DWORD)v15 != 143)
        goto LABEL_47;
      goto LABEL_46;
    }
  }
  return v14;
}

uint64_t sub_219854554(uint64_t a1)
{
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_Reset");
  *(_BYTE *)(a1 + 254) = 1;
  phOsalNfc_SetMemory();
  phOsalNfc_MemCopy();
  phOsalNfc_MemCopy();
  phOsalNfc_MemCopy();
  phOsalNfc_MemCopy();
  phOsalNfc_SetMemory();
  *(_BYTE *)(a1 + 299) = 0;
  *(_BYTE *)(a1 + 380) = 0;
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_Reset");
}

uint64_t sub_2198546A4(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_Format");
  if (a2)
  {
    v4 = 0;
    *(_BYTE *)(a1 + 380) = 0;
    do
    {
      *(_BYTE *)(a1 + v4 + 248) = *(_BYTE *)(a2 + v4);
      ++v4;
    }
    while (v4 != 6);
    *(_BYTE *)(a1 + 25) = 1;
    *(_WORD *)(a1 + 256) = 3;
    *(_BYTE *)(a1 + 254) = 0;
    v5 = sub_21985474C(a1);
  }
  else
  {
    v5 = 1;
  }
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_Format");
  return v5;
}

uint64_t sub_21985474C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_WrRdAuth");
  sub_219855468(a1, *(_WORD *)(a1 + 256));
  v2 = sub_2198557D8(a1);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_WrRdAuth");
  return v2;
}

uint64_t sub_2198547C4(uint64_t a1, int a2)
{
  int v4;
  uint64_t v5;
  uint64_t v6;

  *(_WORD *)(a1 + 106) = a2;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_Process");
  v4 = *(unsigned __int8 *)(a1 + 25);
  if (!a2)
  {
    v6 = 0;
    switch(*(_BYTE *)(a1 + 25))
    {
      case 1:
        v5 = sub_2198548FC(a1);
        goto LABEL_18;
      case 2:
        v5 = sub_219854A14(a1);
        goto LABEL_18;
      case 3:
        v5 = sub_219854A94(a1);
        goto LABEL_18;
      case 5:
        v5 = sub_219854BBC(a1);
        goto LABEL_18;
      case 6:
        v5 = sub_219854DA8(a1);
        goto LABEL_18;
      case 7:
        goto LABEL_20;
      case 8:
        v5 = sub_219854F1C(a1);
        goto LABEL_18;
      case 9:
        v5 = sub_219854FF0(a1);
        goto LABEL_18;
      default:
        v6 = 245;
        goto LABEL_20;
    }
  }
  switch(v4)
  {
    case 6:
      v5 = sub_219855260(a1);
      break;
    case 5:
      v5 = sub_2198552E8(a1);
      break;
    case 1:
      v5 = sub_2198550E8(a1);
      break;
    default:
      v6 = *(unsigned __int16 *)(a1 + 106);
      goto LABEL_19;
  }
LABEL_18:
  v6 = v5;
LABEL_19:
  if ((_DWORD)v6 != 13)
LABEL_20:
    sub_219890E88(a1, v6);
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_Process");
}

uint64_t sub_2198548FC(uint64_t a1)
{
  int v2;
  int v3;
  __int16 v4;
  int v5;
  char v6;
  uint64_t v7;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProAuth");
  v2 = *(unsigned __int8 *)(a1 + 254);
  if (v2 == 4 || v2 == 3)
  {
    v5 = *(unsigned __int8 *)(a1 + 380);
    if ((v5 - 64) >= 3 && (v5 - 1) > 1)
    {
      *(_BYTE *)(a1 + 380) = 0;
LABEL_17:
      v6 = 6;
      goto LABEL_18;
    }
    *(_WORD *)(a1 + 256) = v5;
    v6 = 9;
  }
  else
  {
    if (!*(_BYTE *)(a1 + 254))
    {
      v3 = *(unsigned __int16 *)(a1 + 256);
      if (v3 == 67)
      {
        if (!*(_BYTE *)(a1 + 299))
        {
          v4 = 64;
          goto LABEL_20;
        }
      }
      else if (v3 == 3 && !*(_BYTE *)(a1 + 299))
      {
        v4 = 1;
LABEL_20:
        *(_WORD *)(a1 + 256) = v4;
        v6 = 8;
        goto LABEL_18;
      }
      *(_BYTE *)(a1 + 299) = 0;
      goto LABEL_17;
    }
    if ((*(unsigned __int8 *)(a1 + 380) | 0x40) == 0x42)
    {
      *(_BYTE *)(a1 + 380) = 0;
      v6 = 7;
    }
    else
    {
      v6 = 5;
    }
  }
LABEL_18:
  *(_BYTE *)(a1 + 25) = v6;
  v7 = sub_21985474C(a1);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProAuth");
  return v7;
}

uint64_t sub_219854A14(uint64_t a1)
{
  uint64_t v2;

  *(_BYTE *)(a1 + 25) = 3;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_CallCon");
  v2 = sub_2198BB9D0(*(_QWORD *)a1, (_OWORD *)(a1 + 64), *(_QWORD *)(a1 + 16), *(_QWORD *)(a1 + 216));
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_CallCon");
  return v2;
}

uint64_t sub_219854A94(uint64_t a1)
{
  int v2;
  uint64_t v3;
  unint64_t v4;
  int v5;
  uint64_t v6;
  unsigned __int8 v9;

  v9 = 1;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProCon");
  sub_219855914(a1);
  v2 = *(unsigned __int8 *)(a1 + 24);
  if (v2 == 3)
  {
    if (*(unsigned __int16 *)(a1 + 256) < 0x100u)
      goto LABEL_4;
  }
  else if (v2 != 2 || *(unsigned __int16 *)(a1 + 256) <= 0x3Fu)
  {
    goto LABEL_4;
  }
  sub_219855A0C((unsigned int *)a1, v2, a1 + 259);
  v4 = 1;
  do
  {
    v5 = sub_219855BB8((unsigned int *)a1, &v9, (unsigned __int8 *)(a1 + v4 + 259), 1);
    if (v4 == 15)
      v6 = 2;
    else
      v6 = 1;
    v4 += v6;
  }
  while (v4 <= 0x27 && v5 != 0);
  if (v5)
  {
    v3 = 35;
    goto LABEL_17;
  }
  sub_219855C78(a1);
  *(_WORD *)(a1 + 256) = 1;
  *(_BYTE *)(a1 + 380) = 1;
  *(_BYTE *)(a1 + 254) = 4;
LABEL_4:
  *(_BYTE *)(a1 + 25) = 1;
  v3 = sub_21985474C(a1);
LABEL_17:
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProCon");
  return v3;
}

uint64_t sub_219854BBC(uint64_t a1)
{
  unsigned int v2;
  unsigned __int8 v3;
  int v4;
  uint64_t v5;
  unsigned __int8 *v6;
  int v7;
  unsigned int v8;
  __int16 v9;
  unsigned __int16 v10;
  int v11;
  unint64_t v12;
  int v13;
  uint64_t v14;
  uint64_t v16;
  unsigned __int8 v18;

  v18 = 1;
  v2 = *(unsigned __int16 *)(a1 + 256);
  if (v2 <= 0x7F)
    v3 = v2 >> 2;
  else
    v3 = ((v2 + 3968) >> 4) + 32;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProRdSectTr");
  v4 = *(unsigned __int16 *)(a1 + 256);
  v5 = *(_QWORD *)(a1 + 96);
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ChkAcsBit");
  if ((v4 & 0xFFFFFFBF) == 3)
    v6 = (unsigned __int8 *)(a1 + 242);
  else
    v6 = (unsigned __int8 *)(a1 + 245);
  v7 = sub_219855BB8((unsigned int *)a1, (unsigned __int8 *)(v5 + 6), v6, 3);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ChkAcsBit");
  *(_BYTE *)(a1 + 259 + v3) = v7 == 0;
  v8 = *(unsigned __int16 *)(a1 + 256);
  if (v8 <= 0x7E)
    v9 = 4;
  else
    v9 = 16;
  v10 = v9 + v8;
  *(_WORD *)(a1 + 256) = v10;
  v11 = *(unsigned __int8 *)(a1 + 24);
  if ((v11 != 2 || v10 <= 0x3Fu) && (v11 != 3 || v10 < 0x100u))
  {
    *(_BYTE *)(a1 + 25) = 1;
    *(_BYTE *)(a1 + 254) = 0;
    goto LABEL_28;
  }
  sub_219855A0C((unsigned int *)a1, v11, a1 + 259);
  if (!v7)
    goto LABEL_26;
  v12 = 1;
  do
  {
    v13 = sub_219855BB8((unsigned int *)a1, &v18, (unsigned __int8 *)(a1 + v12 + 259), 1);
    if (v12 == 15)
      v14 = 2;
    else
      v14 = 1;
    v12 += v14;
  }
  while (v12 <= 0x27 && v13 != 0);
  if (!v13)
  {
LABEL_26:
    sub_219855C78(a1);
    *(_WORD *)(a1 + 256) = 1;
    *(_BYTE *)(a1 + 380) = 1;
    *(_BYTE *)(a1 + 254) = 4;
    *(_BYTE *)(a1 + 25) = 1;
LABEL_28:
    v16 = sub_21985474C(a1);
    goto LABEL_29;
  }
  v16 = 35;
LABEL_29:
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProRdSectTr");
  return v16;
}

uint64_t sub_219854DA8(uint64_t a1)
{
  unsigned int v2;
  unsigned __int8 v3;
  unsigned int v4;
  __int16 v5;
  unsigned __int16 v6;
  int v7;
  unint64_t v8;
  int v9;
  uint64_t v10;
  uint64_t v12;
  unsigned __int8 v14;

  v14 = 1;
  v2 = *(unsigned __int16 *)(a1 + 256);
  if (v2 <= 0x7F)
    v3 = v2 >> 2;
  else
    v3 = ((v2 + 3968) >> 4) + 32;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProWrSectTr");
  *(_BYTE *)(a1 + 259 + v3) = *(_WORD *)(a1 + 106) == 0;
  v4 = *(unsigned __int16 *)(a1 + 256);
  if (v4 <= 0x7E)
    v5 = 4;
  else
    v5 = 16;
  v6 = v5 + v4;
  *(_WORD *)(a1 + 256) = v6;
  v7 = *(unsigned __int8 *)(a1 + 24);
  if ((v7 != 2 || v6 <= 0x3Fu) && (v7 != 3 || v6 < 0x100u))
  {
    *(_BYTE *)(a1 + 25) = 1;
    *(_BYTE *)(a1 + 254) = 0;
LABEL_24:
    v12 = sub_21985474C(a1);
    goto LABEL_25;
  }
  sub_219855A0C((unsigned int *)a1, v7, a1 + 259);
  v8 = 1;
  do
  {
    v9 = sub_219855BB8((unsigned int *)a1, &v14, (unsigned __int8 *)(a1 + v8 + 259), 1);
    if (v8 == 15)
      v10 = 2;
    else
      v10 = 1;
    v8 += v10;
  }
  while (v8 <= 0x27 && v9 != 0);
  if (!v9)
  {
    sub_219855C78(a1);
    *(_WORD *)(a1 + 256) = 1;
    *(_BYTE *)(a1 + 380) = 1;
    *(_BYTE *)(a1 + 254) = 4;
    *(_BYTE *)(a1 + 25) = 1;
    goto LABEL_24;
  }
  v12 = 35;
LABEL_25:
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProWrSectTr");
  return v12;
}

uint64_t sub_219854F1C(uint64_t a1)
{
  char v2;
  unsigned int v3;
  __int16 v4;
  uint64_t v5;

  v2 = 8;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProWrMADBlk");
  v3 = *(unsigned __int16 *)(a1 + 256);
  if (v3 <= 0x3F)
  {
    if (v3 == 1)
    {
      v4 = 2;
      goto LABEL_12;
    }
    if (v3 == 2)
    {
      *(_BYTE *)(a1 + 299) = 1;
      v4 = 3;
LABEL_9:
      v2 = 6;
      goto LABEL_12;
    }
LABEL_8:
    *(_BYTE *)(a1 + 299) = 1;
    v4 = 67;
    goto LABEL_9;
  }
  if (v3 == 64)
  {
    v4 = 65;
    goto LABEL_12;
  }
  if (v3 != 65)
    goto LABEL_8;
  v4 = 66;
LABEL_12:
  *(_BYTE *)(a1 + 25) = v2;
  *(_WORD *)(a1 + 256) = v4;
  v5 = sub_21985474C(a1);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProWrMADBlk");
  return v5;
}

uint64_t sub_219854FF0(uint64_t a1)
{
  unsigned int v2;
  __int16 v3;
  char v4;
  uint64_t v5;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProUpdMADBlk");
  v2 = *(unsigned __int8 *)(a1 + 380);
  if (v2 > 0x3F)
  {
    if (v2 == 64)
    {
      v3 = 65;
      goto LABEL_12;
    }
    if (v2 != 66)
      goto LABEL_4;
  }
  else
  {
    if (v2 == 1)
    {
      v3 = 2;
      goto LABEL_12;
    }
    if (v2 != 2)
    {
LABEL_4:
      v3 = 66;
LABEL_12:
      *(_BYTE *)(a1 + 380) = v3;
      *(_WORD *)(a1 + 256) = v3;
      goto LABEL_15;
    }
  }
  if (*(_BYTE *)(a1 + 24) == 2 || *(_WORD *)(a1 + 256) == 66)
  {
    sub_219855D74(a1);
    v4 = 1;
    *(_BYTE *)(a1 + 25) = 1;
  }
  else
  {
    *(_BYTE *)(a1 + 380) = 64;
    *(_WORD *)(a1 + 256) = 64;
    *(_BYTE *)(a1 + 25) = 1;
    v4 = 4;
  }
  *(_BYTE *)(a1 + 254) = v4;
LABEL_15:
  v5 = sub_21985474C(a1);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProUpdMADBlk");
  return v5;
}

uint64_t sub_2198550E8(uint64_t a1)
{
  uint64_t v2;
  unsigned int v3;
  unint64_t v4;
  int v5;
  uint64_t v6;
  uint64_t v8;
  unsigned __int8 v10;

  v2 = *(unsigned __int16 *)(a1 + 106);
  v10 = 1;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProErrAuth");
  v3 = *(unsigned __int16 *)(a1 + 256);
  if (v3 != 67)
  {
    if (v3 < 4)
    {
      if (v3 != 3)
        goto LABEL_21;
      if (*(unsigned __int8 *)(a1 + 254) > 3u)
      {
        phOsalNfc_SetMemory();
        goto LABEL_21;
      }
    }
    else if (*(_BYTE *)(a1 + 254) == 4)
    {
      goto LABEL_21;
    }
    goto LABEL_19;
  }
  if (*(_BYTE *)(a1 + 254) != 4)
  {
LABEL_19:
    v8 = sub_219855898(a1);
LABEL_20:
    v2 = v8;
    goto LABEL_21;
  }
  phOsalNfc_SetMemory();
  sub_219855A0C((unsigned int *)a1, *(unsigned __int8 *)(a1 + 24), a1 + 259);
  v4 = 1;
  do
  {
    v5 = sub_219855BB8((unsigned int *)a1, &v10, (unsigned __int8 *)(a1 + v4 + 259), 1);
    if (v4 == 15)
      v6 = 2;
    else
      v6 = 1;
    v4 += v6;
  }
  while (v4 <= 0x27 && v5 != 0);
  if (!v5)
  {
    sub_219855C78(a1);
    *(_WORD *)(a1 + 256) = 1;
    *(_BYTE *)(a1 + 380) = 1;
    *(_BYTE *)(a1 + 254) = 4;
    *(_BYTE *)(a1 + 25) = 1;
    v8 = sub_21985474C(a1);
    goto LABEL_20;
  }
  v2 = 35;
LABEL_21:
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ProErrAuth");
  return v2;
}

uint64_t sub_219855260(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ErrWrSectTr");
  if (*(_BYTE *)(a1 + 254))
  {
    v2 = sub_219854DA8(a1);
  }
  else
  {
    *(_BYTE *)(a1 + 25) = 1;
    *(_BYTE *)(a1 + 254) = 3;
    v2 = sub_21985474C(a1);
  }
  v3 = v2;
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ErrWrSectTr");
  return v3;
}

uint64_t sub_2198552E8(uint64_t a1)
{
  unsigned int v2;
  unsigned int v3;
  __int16 v4;
  unsigned __int16 v5;
  int v6;
  BOOL v7;
  unint64_t v8;
  int v9;
  uint64_t v10;
  uint64_t v12;
  unsigned __int8 v14;

  v14 = 1;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ErrRdSectTr");
  if (!*(_BYTE *)(a1 + 254))
  {
    *(_BYTE *)(a1 + 25) = 1;
    *(_BYTE *)(a1 + 254) = 3;
LABEL_27:
    v12 = sub_21985474C(a1);
    goto LABEL_28;
  }
  v2 = *(unsigned __int16 *)(a1 + 256);
  v3 = ((v2 + 3968) >> 4) + 32;
  if (v2 <= 0x7F)
    LOBYTE(v3) = v2 >> 2;
  *(_BYTE *)(a1 + 259 + v3) = *(_WORD *)(a1 + 106) == 0;
  if (v2 <= 0x7E)
    v4 = 4;
  else
    v4 = 16;
  v5 = v4 + v2;
  *(_WORD *)(a1 + 256) = v5;
  v6 = *(unsigned __int8 *)(a1 + 24);
  v7 = v5 >= 0x40u && v6 == 2;
  if (!v7 && (v5 < 0x100u || v6 != 3))
  {
    *(_BYTE *)(a1 + 25) = 1;
    *(_BYTE *)(a1 + 254) = 0;
    goto LABEL_27;
  }
  sub_219855A0C((unsigned int *)a1, v6, a1 + 259);
  v8 = 1;
  do
  {
    v9 = sub_219855BB8((unsigned int *)a1, &v14, (unsigned __int8 *)(a1 + v8 + 259), 1);
    if (v8 == 15)
      v10 = 2;
    else
      v10 = 1;
    v8 += v10;
  }
  while (v8 <= 0x27 && v9 != 0);
  if (!v9)
  {
    sub_219855C78(a1);
    *(_WORD *)(a1 + 256) = 1;
    *(_BYTE *)(a1 + 380) = 1;
    *(_BYTE *)(a1 + 254) = 4;
    *(_BYTE *)(a1 + 25) = 1;
    goto LABEL_27;
  }
  v12 = 35;
LABEL_28:
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ErrRdSectTr");
  return v12;
}

uint64_t sub_219855468(uint64_t a1, char a2)
{
  int v3;
  __int16 v4;

  **(_BYTE **)(a1 + 96) = a2;
  **(_WORD **)(a1 + 88) = 252;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_FillSendBuf");
  switch(*(_BYTE *)(a1 + 25))
  {
    case 1:
      switch(*(_BYTE *)(a1 + 254))
      {
        case 0:
        case 3:
          phOsalNfc_SetMemory();
          if (*(_BYTE *)(a1 + 254))
            v3 = 97;
          else
            v3 = 96;
          break;
        case 4:
          phOsalNfc_MemCopy();
          v3 = 97;
          break;
        default:
          phOsalNfc_MemCopy();
          v3 = 96;
          break;
      }
      *(_DWORD *)(a1 + 80) = v3;
      v4 = 7;
      goto LABEL_15;
    case 5:
      *(_DWORD *)(a1 + 80) = 48;
      v4 = 1;
      goto LABEL_15;
    case 6:
      *(_DWORD *)(a1 + 80) = 160;
      phOsalNfc_MemCopy();
      goto LABEL_11;
    case 7:
      *(_DWORD *)(a1 + 80) = 160;
      goto LABEL_11;
    case 8:
      *(_DWORD *)(a1 + 80) = 160;
LABEL_11:
      phOsalNfc_MemCopy();
      v4 = 17;
LABEL_15:
      *(_WORD *)(a1 + 104) = v4;
      break;
    default:
      *(_DWORD *)(a1 + 80) = 160;
      *(_WORD *)(a1 + 104) = 17;
      phOsalNfc_MemCopy();
      break;
  }
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_FillSendBuf");
}

uint64_t sub_2198557D8(uint64_t a1)
{
  uint64_t v2;
  _BYTE *v3;
  unsigned __int16 *v4;
  uint64_t v5;

  v2 = a1 + 8;
  *(_BYTE *)(a1 + 8) &= 0xFCu;
  *(_BYTE *)(a1 + 12) = 0;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_Transceive");
  *(_QWORD *)(a1 + 64) = sub_2198911F8;
  *(_QWORD *)(a1 + 72) = a1;
  v4 = *(unsigned __int16 **)(a1 + 88);
  v3 = *(_BYTE **)(a1 + 96);
  *v4 = 252;
  v5 = sub_2198BB544(*(_QWORD *)a1, (_OWORD *)(a1 + 64), *(_QWORD *)(a1 + 16), *(_DWORD *)(a1 + 80), v2, v3, *(unsigned __int16 *)(a1 + 104), (uint64_t)v3, v4);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_Transceive");
  return v5;
}

uint64_t sub_219855898(uint64_t a1)
{
  uint64_t v2;

  *(_BYTE *)(a1 + 25) = 2;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_CallDisCon");
  v2 = sub_2198BB850(*(_QWORD *)a1, (_OWORD *)(a1 + 64), *(_QWORD *)(a1 + 16));
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_CallDisCon");
  return v2;
}

uint64_t sub_219855914(uint64_t a1)
{
  char v2;
  unsigned int v3;
  char v4;
  char v5;
  unsigned int v6;
  unsigned int v7;
  __int16 v8;

  v2 = 3;
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ChangeAuthSt");
  switch(*(_BYTE *)(a1 + 254))
  {
    case 0:
      v3 = *(unsigned __int16 *)(a1 + 256);
      if (v3 >= 0x43)
        v4 = 1;
      else
        v4 = 2;
      if (v3 >= 0x40)
        v5 = v4;
      else
        v5 = 1;
      if (v3 >= 4)
        v2 = v5;
      else
        v2 = 2;
      break;
    case 1:
      break;
    case 2:
      v2 = 1;
      break;
    case 3:
      v2 = 4;
      break;
    case 4:
      v6 = *(unsigned __int16 *)(a1 + 256);
      v7 = ((v6 + 3968) >> 4) + 32;
      if (v6 <= 0x7F)
        LOBYTE(v7) = v6 >> 2;
      *(_BYTE *)(a1 + v7 + 259) = 0;
      if (v6 <= 0x7E)
        v8 = 4;
      else
        v8 = 16;
      *(_WORD *)(a1 + 256) = v8 + v6;
      goto LABEL_19;
    default:
LABEL_19:
      v2 = 0;
      break;
  }
  *(_BYTE *)(a1 + 254) = v2;
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_ChangeAuthSt");
}

uint64_t sub_219855A0C(unsigned int *a1, int a2, uint64_t a3)
{
  int v6;
  unsigned __int8 v7;
  int v8;
  unsigned __int8 v9;
  int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  unsigned __int8 v15;
  int v16;
  BOOL v18;
  BOOL v19;
  int v20;
  int v21;

  sub_219850718(3, a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_NdefComplSect");
  if (a2 == 2)
    v6 = 16;
  else
    v6 = 40;
  if ((a2 & 0xFE) == 2)
  {
    v7 = 0;
    v8 = 0;
    v9 = 0;
    v10 = 1;
    v11 = 1;
    do
    {
      v12 = *(unsigned __int8 *)(a3 + v10);
      v13 = (v10 + 1);
      if (v13 == 16)
        v14 = 17;
      else
        v14 = v10 + 1;
      v15 = v9;
      if (v7 <= v9)
      {
        v16 = v8;
      }
      else
      {
        v15 = v7;
        v16 = v11;
      }
      if (v13 == 16)
        v10 = 17;
      else
        ++v10;
      if (v12)
      {
        v10 = v14;
      }
      else
      {
        v9 = v15;
        v8 = v16;
        v11 = v10;
      }
      if (!v12)
        v7 = 0;
      v18 = a2 == 2 && v10 < 0x10u;
      v19 = v10 < 0x28u && a2 == 3;
      ++v7;
    }
    while (v19 || v18);
  }
  else
  {
    v9 = 0;
    LOBYTE(v8) = 0;
    v7 = 0;
    LOBYTE(v11) = 1;
  }
  if (v7 <= v9)
    v20 = v9;
  else
    v20 = v7;
  if (v7 > v9)
    LOBYTE(v8) = v11;
  if (a2 == 2 && v6 - 1 > v20)
  {
    if (!(_BYTE)v8)
      return sub_219850808(3, a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_NdefComplSect");
    v21 = v6 - 2;
  }
  else
  {
    if (a2 != 3)
      return sub_219850808(3, a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_NdefComplSect");
    v21 = v6 - 2;
    if (v6 - 2 <= v20 || !(_BYTE)v8)
      return sub_219850808(3, a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_NdefComplSect");
  }
  if (v21 > v8)
  {
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
  }
  return sub_219850808(3, a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_NdefComplSect");
}

uint64_t sub_219855BB8(unsigned int *a1, unsigned __int8 *a2, unsigned __int8 *a3, int a4)
{
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  BOOL v13;
  uint64_t v14;

  sub_219850718(3, a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_MemCompare");
  if (!a2 || !a3)
  {
    sub_219850628(3, a1, 8u, 1u, (uint64_t)"NULL pointer passed to memcompare");
    goto LABEL_10;
  }
  if (!a4)
  {
LABEL_10:
    v14 = 0;
    goto LABEL_11;
  }
  v8 = a4 - 1;
  do
  {
    v10 = *a2++;
    v9 = v10;
    v12 = *a3++;
    v11 = v12;
    v13 = v8-- != 0;
  }
  while (v13 && v9 == v11);
  v14 = (char)(v9 - v11);
LABEL_11:
  sub_219850808(3, a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_MemCompare");
  return v14;
}

uint64_t sub_219855C78(uint64_t a1)
{
  int v2;
  unsigned int v3;
  unsigned __int8 v4;
  _BOOL4 v6;
  int v7;
  uint64_t v8;
  BOOL v9;
  char v10;
  char v11;
  unsigned int v12;
  char v13;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_StrNdefData");
  phOsalNfc_SetMemory();
  *(_WORD *)(a1 + 300) = 276;
  v2 = *(unsigned __int8 *)(a1 + 24);
  if (v2 == 3)
    *(_WORD *)(a1 + 332) = 488;
  v3 = 1;
  v4 = 2;
  do
  {
    v6 = v2 == 2 && v3 < 0x10;
    if (v2 != 3 && !v6)
      break;
    v7 = *(unsigned __int8 *)(a1 + v3 + 259);
    v8 = a1 + 300;
    v9 = v7 == 1;
    v10 = v7 == 1 ? 3 : 0;
    v11 = v9 ? -31 : 0;
    *(_BYTE *)(v8 + v4) = v10;
    *(_BYTE *)(v8 + (v4 | 1u)) = v11;
    v12 = v3 + 1;
    if (v3 == 15)
      v3 = 17;
    else
      ++v3;
    v13 = v12 == 16 ? 4 : 2;
    v4 += v13;
  }
  while (v3 < 0x28);
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_StrNdefData");
}

uint64_t sub_219855D74(uint64_t a1)
{
  int v2;
  __int16 v3;
  __int16 v4;
  uint64_t i;
  BOOL v6;
  BOOL v7;
  __int16 v8;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_BlkNoToWrTLV");
  v2 = *(unsigned __int8 *)(a1 + 24);
  v3 = 4;
  v4 = 16;
  for (i = 260; i != 299; ++i)
  {
    v6 = v2 != 2 || (unint64_t)(i - 259) > 0xF;
    v7 = v6;
    if (v2 != 3 && v7)
      break;
    if (*(_BYTE *)(a1 + i) == 1)
    {
      v8 = (v4 & 0x1F0) + 128;
      if ((((_BYTE)i - 3) & 0xE0) != 0)
        v3 = v8;
      *(_WORD *)(a1 + 256) = v3;
      return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_BlkNoToWrTLV");
    }
    v3 += 4;
    v4 += 16;
  }
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfStd_H_BlkNoToWrTLV");
}

uint64_t sub_219855E2C(uint64_t a1)
{
  char v2;
  uint64_t v3;
  __int16 v5;
  __int128 v6;
  __int128 v7;

  v6 = 0u;
  v7 = 0u;
  v5 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReadSwioPadVoltageCmd");
  if (a1 && *(unsigned __int8 *)(a1 + 4840) - 1 <= 1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v6 = 0xF00000001;
    DWORD2(v6) = 50;
    if (*(_BYTE *)(a1 + 4840) == 1)
      v2 = 17;
    else
      v2 = 18;
    LOBYTE(v5) = v2;
    HIBYTE(v5) = 34;
    *(_QWORD *)&v7 = &v5;
    DWORD2(v7) = 2;
    v3 = sub_2198F2D0C(a1 + 888, (uint64_t)&v6, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    v3 = 1;
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciNfc_ReadSwioPadVoltageCmd: Invalid input parameter");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReadSwioPadVoltageCmd");
  return v3;
}

uint64_t sub_219855F50(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReadSwioPadVoltageRsp");
  if (a1)
  {
    v4 = *(_BYTE **)(a1 + 3760);
    if (v4 && !*v4 && *(_DWORD *)(a1 + 3768) == 3)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Read SWIO voltage Info Successful");
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Read SWIO voltage Info failed!");
      *(_DWORD *)(a1 + 3768) = 0;
      a2 = 255;
    }
  }
  else
  {
    a2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Read SWIO voltage Info: Invalid context");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReadSwioPadVoltageRsp");
  return a2;
}

uint64_t sub_21985603C(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ReadInternalRegSeqComplete");
  if (a1)
    sub_2198E23C4((uint64_t)a1, a2, (uint64_t)(a1 + 940));
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ReadInternalRegSeqComplete");
  return a2;
}

uint64_t sub_2198560AC(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReadIntRegCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 50;
    *(_BYTE *)(a1 + 3704) = 20;
    *(_BYTE *)(a1 + 3708) = 1;
    *(_QWORD *)&v5 = a1 + 3704;
    DWORD2(v5) = 1;
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"phNciNfc_ReadIntRegCmd: Invalid input parameter");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReadIntRegCmd");
  return v2;
}

uint64_t sub_2198561A4(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReadIntRegRsp");
  if (a1)
  {
    v4 = *(_BYTE **)(a1 + 3760);
    if (v4 && !*v4 && *(_DWORD *)(a1 + 3768) == 3)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Read Internal Register Successful");
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Read Internal Register failed!");
      *(_DWORD *)(a1 + 3768) = 0;
      a2 = 255;
    }
  }
  else
  {
    a2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Read Internal Register Info: Invalid context");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReadIntRegRsp");
  return a2;
}

uint64_t sub_219856290(uint64_t a1)
{
  uint64_t v2;
  _DWORD *v3;
  _DWORD v5[2];
  __int128 v6;
  __int128 v7;

  v6 = 0u;
  v7 = 0u;
  memset(v5, 0, 5);
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetEraseCounterCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v6 = 0xF00000001;
    DWORD2(v6) = 16;
    v2 = 1;
    if (!*(_BYTE *)(a1 + 3672))
    {
      v3 = (_DWORD *)(a1 + 3672);
      goto LABEL_7;
    }
    if (*(_BYTE *)(a1 + 3672) == 1)
    {
      LOBYTE(v5[0]) = 1;
      *(_DWORD *)((char *)v5 + 1) = *(_DWORD *)(a1 + 3674);
      LODWORD(v2) = 5;
      v3 = v5;
LABEL_7:
      *(_QWORD *)&v7 = v3;
      DWORD2(v7) = v2;
      v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v6, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
    }
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"phNciNfc_GetEraseCounterCmd: Invalid input parameter");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetEraseCounterCmd");
  return v2;
}

uint64_t sub_2198563B0(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetEraseCounterRsp");
  if (a1)
  {
    v4 = *(_BYTE **)(a1 + 3760);
    if (v4 && *(_DWORD *)(a1 + 3768) && !*v4)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Get erase counter Info Successful");
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Get erase counter Info failed!");
      *(_DWORD *)(a1 + 3768) = 0;
      a2 = 255;
    }
  }
  else
  {
    a2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Get erase counter  Info: Invalid context");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetEraseCounterRsp");
  return a2;
}

uint64_t sub_219856498(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetEraseCounterSeqComplete");
  if (a1)
    sub_2198E23C4((uint64_t)a1, a2, (uint64_t)(a1 + 940));
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetEraseCounterSeqComplete");
  return a2;
}

uint64_t sub_219856508(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 13;
    *(_QWORD *)&v5 = 0;
    DWORD2(v5) = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"phNciNfc_GetProhibitTimerStsCmd: Invalid input parameter");
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsCmd");
  return v2;
}

uint64_t sub_2198565EC(uint64_t a1, uint64_t a2)
{
  unsigned __int8 *v4;
  int v5;
  unsigned int *v6;
  const char *v7;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsRsp");
  if (a1)
  {
    if (!(_DWORD)a2)
    {
      v4 = *(unsigned __int8 **)(a1 + 3760);
      if (v4 && *(_DWORD *)(a1 + 3768) == 1)
      {
        v5 = *v4;
        if (v5 == 1)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_GetProhibitTimerStsRsp: rejected by NFCC");
          a2 = 147;
          goto LABEL_12;
        }
        if (!v5)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_GetProhibitTimerStsRsp: Successful");
          a2 = 0;
          goto LABEL_12;
        }
        v6 = (unsigned int *)(a1 + 6476);
        v7 = "phNciNfc_GetProhibitTimerStsRsp: failed!";
      }
      else
      {
        v6 = (unsigned int *)(a1 + 6476);
        v7 = "phNciNfc_GetProhibitTimerStsRsp: invalid payload length";
      }
      sub_219850628(1, v6, 3u, 1u, (uint64_t)v7);
      a2 = 255;
      goto LABEL_12;
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_GetProhibitTimerStsRsp: received with failure status");
  }
  else
  {
    a2 = 1;
  }
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsRsp");
  return a2;
}

uint64_t sub_219856728(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  const char *v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsSeqComplete");
  if (a1)
  {
    if (!(_DWORD)a2)
    {
      v4 = *(_QWORD *)(a1 + 4832);
      if (v4 && v4 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Stop();
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 4832) = 0xFFFFFFFFFFFFLL;
      }
      v5 = phOsalNfc_Timer_Create();
      *(_QWORD *)(a1 + 4832) = v5;
      a2 = 12;
      v6 = "phNciNfc_GetProhibitTimerStsSeqComplete: Timer Create failed!!";
      if (v5 && v5 != 0xFFFFFFFFFFFFLL)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_GetProhibitTimerStsSeqComplete: Timer Created Successfully");
        phOsalNfc_SetMemory();
        a2 = phOsalNfc_Timer_Start();
        if (!(_DWORD)a2)
        {
          sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4832), 3u, 4u, (uint64_t)"phNciNfc_GetProhibitTimerStsSeqComplete");
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_GetProhibitTimerStsSeqComplete: Notification timer started\n");
          goto LABEL_12;
        }
        phOsalNfc_Timer_Stop();
        *(_BYTE *)(a1 + 6464) = 0;
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 4832) = 0xFFFFFFFFFFFFLL;
        v6 = "phNciNfc_GetProhibitTimerStsSeqComplete: Notification timer start FAILED\n\n";
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v6);
    }
    *(_QWORD *)(a1 + 808) = 0;
    *(_QWORD *)(a1 + 800) = 0;
    sub_2198E23C4(a1, a2, a1 + 4824);
  }
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsSeqComplete");
  return a2;
}

uint64_t sub_2198568F4(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 46;
    *(_QWORD *)&v5 = 0;
    DWORD2(v5) = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"phNciNfc_GetPwrTrackDataCmd: Invalid input parameter");
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataCmd");
  return v2;
}

uint64_t sub_2198569D8(uint64_t a1, uint64_t a2)
{
  const char *v4;
  _BYTE *v5;
  int v6;
  int v7;
  int v8;
  int v9;
  unsigned int v10;
  int v11;
  int v12;
  unsigned int v13;
  const char *v14;
  int v16;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataRsp");
  if (a1)
  {
    if ((_DWORD)a2)
    {
      v4 = "Get Pwr Track Data resposne received with failure status";
LABEL_4:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)v4);
    }
    else
    {
      phOsalNfc_SetMemory();
      v5 = *(_BYTE **)(a1 + 3760);
      if (v5)
      {
        v6 = *(unsigned __int8 *)(a1 + 4795);
        v7 = v6 == 1 ? 7 : 9;
        if (v7 == *(_DWORD *)(a1 + 3768))
        {
          switch(*v5)
          {
            case 0:
              v8 = v5[1];
              *(_DWORD *)(a1 + 4796) = v8;
              v9 = v8 | (v5[2] << 8);
              *(_DWORD *)(a1 + 4796) = v9;
              v10 = v9 | (v5[3] << 16);
              *(_DWORD *)(a1 + 4796) = v10;
              v11 = v5[4];
              *(_DWORD *)(a1 + 4800) = v11;
              v12 = v11 | (v5[5] << 8);
              *(_DWORD *)(a1 + 4800) = v12;
              v13 = v12 | (v5[6] << 16);
              *(_DWORD *)(a1 + 4800) = v13;
              if (v6 == 1)
              {
                *(_DWORD *)(a1 + 4804) = 0;
              }
              else
              {
                v16 = v5[7];
                *(_DWORD *)(a1 + 4804) = v16;
                *(_DWORD *)(a1 + 4804) = v16 | (v5[8] << 8);
              }
              if (v10 >> 18 || v13 >= 0x40000)
                goto LABEL_25;
              a2 = 0;
              goto LABEL_16;
            case 1:
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Get Pwr Track Data command rejected by NFCC");
              goto LABEL_20;
            case 6:
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get Pwr Track Data command Semantic error received");
LABEL_20:
              a2 = 147;
              goto LABEL_16;
            case 9:
LABEL_25:
              v4 = "Get Pwr Track Data response Invalid parameter received";
              a2 = 1;
              goto LABEL_4;
            default:
              v14 = "Get Pwr Track Data failed!";
              goto LABEL_15;
          }
        }
      }
      v14 = "Get Pwr Track Data response received with invalid payload length";
LABEL_15:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)v14);
      a2 = 255;
    }
  }
  else
  {
    a2 = 1;
  }
LABEL_16:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataRsp");
  return a2;
}

uint64_t sub_219856BD8(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  const char *v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataSeqComplete");
  if (a1)
  {
    if (!(_DWORD)a2)
    {
      if (*(_BYTE *)(a1 + 4794) == 1 || *(_BYTE *)(a1 + 4788) == 1 || *(_BYTE *)(a1 + 4793) == 1)
      {
        v4 = phOsalNfc_Timer_Create();
        *(_QWORD *)(a1 + 6456) = v4;
        a2 = 12;
        v5 = "Get Power Track data Notification Timer Create failed!!";
        if (v4 && v4 != 0xFFFFFFFFFFFFLL)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Get Power Track data Notification Timer Created Successfully");
          a2 = phOsalNfc_Timer_Start();
          if (!(_DWORD)a2)
          {
            sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 6456), 3u, 4u, (uint64_t)"phNciNfc_GetPwrTrackDataSeqComplete");
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Get Power Track data Notification timer started\n");
            *(_QWORD *)(a1 + 784) = *(_QWORD *)(a1 + 3384);
            *(_QWORD *)(a1 + 792) = *(_QWORD *)(a1 + 3712);
            goto LABEL_12;
          }
          phOsalNfc_Timer_Stop();
          *(_BYTE *)(a1 + 6464) = 0;
          phOsalNfc_Timer_Delete();
          *(_QWORD *)(a1 + 6456) = 0xFFFFFFFFFFFFLL;
          v5 = "Get Power Track data Notification timer start FAILED\n\n";
        }
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v5);
      }
      else
      {
        a2 = 0;
      }
    }
    *(_QWORD *)(a1 + 792) = 0;
    *(_QWORD *)(a1 + 784) = 0;
    sub_2198E23C4(a1, a2, a1 + 4796);
  }
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataSeqComplete");
  return a2;
}

uint64_t sub_219856DA0(unsigned int *a1)
{
  uint64_t v2;
  char v4;
  __int128 v5;
  __int128 v6;

  v5 = 0u;
  v6 = 0u;
  v4 = 0;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetSmbLogCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v5 = 0xF00000001;
    DWORD2(v5) = 37;
    *(_QWORD *)&v6 = &v4;
    DWORD2(v6) = 1;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v5, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 2u, (uint64_t)"phNciNfc_GetSmbLogCmd: Invalid input parameter");
    v2 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetSmbLogCmd");
  return v2;
}

uint64_t sub_219856E90(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  const char *v5;
  _BYTE *v6;
  int v7;
  uint64_t v8;
  unsigned int *v9;
  const char *v10;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetSmbLogRsp");
  if (a1)
  {
    if ((_DWORD)a2)
    {
      v4 = (unsigned int *)(a1 + 6476);
      v5 = "SMB Get Logging resposne received with failure status";
LABEL_4:
      sub_219850628(1, v4, 3u, 2u, (uint64_t)v5);
    }
    else
    {
      v6 = *(_BYTE **)(a1 + 3760);
      if (v6 && *(_DWORD *)(a1 + 3768) == 2)
      {
        switch(*v6)
        {
          case 0:
            v7 = v6[1];
            *(_DWORD *)(a1 + 6248) = v7;
            if (v7)
            {
              v8 = phOsalNfc_Timer_Create();
              *(_QWORD *)(a1 + 6424) = v8;
              if (v8 != 0xFFFFFFFFFFFFLL && v8)
              {
                a2 = phOsalNfc_Timer_Start();
                if ((_DWORD)a2)
                {
                  phOsalNfc_Timer_Delete();
                  *(_QWORD *)(a1 + 6424) = 0xFFFFFFFFFFFFLL;
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"SMB Notification timer start FAILED");
                }
                else
                {
                  sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 6424), 3u, 4u, (uint64_t)"phNciNfc_GetSmbLogRsp");
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"SMB ntf timer started");
                }
              }
              else
              {
                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"SMB Notification Timer Create failed!!");
                a2 = 12;
              }
            }
            else
            {
              a2 = 0;
            }
            break;
          case 1:
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"SMB Get Logging command rejected by NFCC");
            goto LABEL_19;
          case 6:
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"SMB Get Logging command Semantic error received");
LABEL_19:
            a2 = 147;
            break;
          case 9:
            v4 = (unsigned int *)(a1 + 6476);
            v5 = "SMB Get Logging response Invalid parameter received";
            a2 = 1;
            goto LABEL_4;
          default:
            v9 = (unsigned int *)(a1 + 6476);
            v10 = "SMB Get Logging failed!";
            goto LABEL_14;
        }
      }
      else
      {
        v9 = (unsigned int *)(a1 + 6476);
        v10 = "SMB Get Logging response received with invalid payload length";
LABEL_14:
        sub_219850628(1, v9, 3u, 2u, (uint64_t)v10);
        a2 = 255;
      }
    }
  }
  else
  {
    a2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetSmbLogRsp");
  return a2;
}

uint64_t sub_2198570FC(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetSmbLogSeqComplete");
  if (a1)
  {
    if ((_DWORD)a2)
    {
      v4 = 255;
    }
    else
    {
      if (a1[1562])
        goto LABEL_6;
      v4 = 0;
    }
    sub_2198E23C4((uint64_t)a1, v4, 0);
  }
LABEL_6:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetSmbLogSeqComplete");
  return a2;
}

uint64_t sub_219857184(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetGenDbgLogCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 31;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 2u, (uint64_t)"phNciNfc_GetGenDbgLogCmd: Invalid input parameter");
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetGenDbgLogCmd");
  return v2;
}

uint64_t sub_219857270(uint64_t a1, uint64_t a2)
{
  unsigned __int8 *v4;
  int v5;
  uint64_t v6;
  int v7;
  uint64_t Memory;
  uint64_t v9;
  const char *v10;
  unsigned int *v11;
  const char *v12;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetGenDbgLogRsp");
  if (!a1)
  {
    a2 = 1;
    goto LABEL_18;
  }
  if ((_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_GetGenDbgLogRsp: Response received with failure status");
    goto LABEL_18;
  }
  v4 = *(unsigned __int8 **)(a1 + 3760);
  if (!v4)
    goto LABEL_16;
  v5 = *(_DWORD *)(a1 + 3768);
  if (v5 == 1)
  {
    if (*v4 == 9)
    {
      a2 = 0;
      *(_QWORD *)(a1 + 6408) = 0;
      *(_WORD *)(a1 + 6402) = 0;
      goto LABEL_18;
    }
    goto LABEL_16;
  }
  if (v5 != 3)
  {
LABEL_16:
    v11 = (unsigned int *)(a1 + 6476);
    v12 = "phNciNfc_GetGenDbgLogRsp: Response received with invalid payload length";
LABEL_17:
    sub_219850628(1, v11, 3u, 2u, (uint64_t)v12);
    a2 = 255;
    goto LABEL_18;
  }
  switch(*v4)
  {
    case 0u:
      *(_BYTE *)(a1 + 6400) = v4[1] >> 7;
      *(_BYTE *)(a1 + 6401) = (v4[1] & 0x40) != 0;
      v4[1] &= ~0x80u;
      *(_BYTE *)(*(_QWORD *)(a1 + 3760) + 1) &= ~0x40u;
      v6 = *(_QWORD *)(a1 + 3760);
      v7 = *(unsigned __int8 *)(v6 + 2);
      *(_WORD *)(a1 + 6402) = v7;
      LODWORD(v6) = *(unsigned __int8 *)(v6 + 1);
      *(_WORD *)(a1 + 6402) = v7 | ((_WORD)v6 << 8);
      *(_WORD *)(a1 + 6416) = 0;
      if (!(v7 | ((_DWORD)v6 << 8)))
        goto LABEL_26;
      Memory = phOsalNfc_GetMemory();
      *(_QWORD *)(a1 + 6408) = Memory;
      if (!Memory)
      {
        v10 = "phNciNfc_GetGenDbgLogRsp: allocate memory failed";
        goto LABEL_28;
      }
      v9 = phOsalNfc_Timer_Create();
      *(_QWORD *)(a1 + 6424) = v9;
      if (v9 == 0xFFFFFFFFFFFFLL || !v9)
      {
        v10 = "phNciNfc_GetGenDbgLogRsp: Notification Timer Create failed!!";
LABEL_28:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v10);
        a2 = 12;
        break;
      }
      a2 = phOsalNfc_Timer_Start();
      if ((_DWORD)a2)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 6424) = 0xFFFFFFFFFFFFLL;
        if (*(_QWORD *)(a1 + 6408))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(a1 + 6408) = 0;
        }
        *(_WORD *)(a1 + 6402) = 0;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic DEBUG Notification timer start FAILED");
      }
      else
      {
        sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 6424), 3u, 4u, (uint64_t)"phNciNfc_GetGenDbgLogRsp");
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Generic DEBUG ntf timer started");
      }
      break;
    case 1u:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_GetGenDbgLogRsp: command rejected by NFCC");
      goto LABEL_24;
    case 2u:
    case 3u:
    case 4u:
    case 5u:
    case 7u:
    case 8u:
      goto LABEL_21;
    case 6u:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_GetGenDbgLogRsp: Semantic error received");
LABEL_24:
      a2 = 147;
      break;
    case 9u:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_GetGenDbgLogRsp: Invalid parameter status received - No data present in the buffer");
LABEL_26:
      a2 = 0;
      break;
    default:
      if (*v4 == 243)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_GetGenDbgLogRsp: Corrupted CRC error");
        a2 = 84;
        break;
      }
LABEL_21:
      v11 = (unsigned int *)(a1 + 6476);
      v12 = "phNciNfc_GetGenDbgLogRsp: failed!";
      goto LABEL_17;
  }
LABEL_18:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetGenDbgLogRsp");
  return a2;
}

uint64_t sub_2198575BC(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetGenDbgLogSeqComplete");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
    }
    if ((_DWORD)a2)
    {
      v4 = a1;
      v5 = 255;
      v6 = 0;
    }
    else
    {
      if (*(_WORD *)(a1 + 6402))
        goto LABEL_8;
      v6 = a1 + 6400;
      v4 = a1;
      v5 = 0;
    }
    sub_2198E23C4(v4, v5, v6);
  }
LABEL_8:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetGenDbgLogSeqComplete");
  return a2;
}

uint64_t sub_219857664(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TriggerNfccAssertCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 59;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 2u, (uint64_t)"phNciNfc_TriggerNfccAssertCmd: Invalid input parameter");
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TriggerNfccAssertCmd");
  return v2;
}

uint64_t sub_219857750(uint64_t a1, int a2)
{
  uint64_t v4;
  _BYTE *v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessCommonNciRsp1");
  if (a1)
  {
    if (a2 || (v6 = *(_BYTE **)(a1 + 3760)) == 0 || *(_DWORD *)(a1 + 3768) != 1 || *v6)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_ProcessCommonNciRsp1 - Response received with invalid status/payload");
      *(_DWORD *)(a1 + 3768) = 0;
      v4 = 255;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_ProcessCommonNciRsp1 - Response Successful");
      v4 = 0;
    }
  }
  else
  {
    v4 = 1;
    sub_219850628(1, (unsigned int *)0x194C, 3u, 2u, (uint64_t)"phNciNfc_ProcessCommonNciRsp1 - Invalid NCI Context");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessCommonNciRsp1");
  return v4;
}

uint64_t sub_219857844(uint64_t a1, uint64_t a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TriggerNfccAssertSeqComplete");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
    }
    if ((_DWORD)a2)
      v4 = 255;
    else
      v4 = 0;
    sub_2198E23C4(a1, v4, 0);
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TriggerNfccAssertSeqComplete");
  return a2;
}

uint64_t sub_2198578D0(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetLpcdCountCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 29;
    *(_QWORD *)&v5 = 0;
    DWORD2(v5) = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 2u, (uint64_t)"phNciNfc_GetLpcdCountCmd: Invalid input parameter");
    v2 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetLpcdCountCmd");
  return v2;
}

uint64_t sub_2198579B4(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetLpcdCountRsp");
  if (a1)
  {
    if ((_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get LPCD false positive counter resposne received with failure status");
    }
    else
    {
      v4 = *(_BYTE **)(a1 + 3760);
      if (v4 && *(_DWORD *)(a1 + 3768) == 7 && !*v4)
      {
        phOsalNfc_MemCopy();
        a2 = 0;
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get LPCD false positive counter response received with invalid payload length");
        a2 = 255;
      }
    }
  }
  else
  {
    a2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetLpcdCountRsp");
  return a2;
}

uint64_t sub_219857AA4(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetLpcdCountSeqComplete");
  if (a1)
    sub_2198E23C4((uint64_t)a1, a2, (uint64_t)(a1 + 1609));
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetLpcdCountSeqComplete");
  return a2;
}

uint64_t sub_219857B18(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwTypeCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 6;
    *(_QWORD *)&v5 = 0;
    DWORD2(v5) = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 2u, (uint64_t)"phNciNfc_GetFwTypeCmd: Invalid input parameter");
    v2 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwTypeCmd");
  return v2;
}

uint64_t sub_219857BFC(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;
  unsigned int v5;
  _DWORD *v7;
  _BYTE *v8;
  unsigned int v9;
  unsigned __int8 v10;
  __int16 v11;
  char v12;
  __int16 v13;
  int v14;
  int v15;
  int v16;
  int v17;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwTypeRsp");
  if (!a1)
  {
    a2 = 1;
    goto LABEL_14;
  }
  phOsalNfc_SetMemory();
  if (!(_DWORD)a2)
  {
    v4 = *(_BYTE **)(a1 + 3760);
    if (!v4)
      goto LABEL_12;
    v5 = *(_DWORD *)(a1 + 3768);
    if (v5 == 2)
    {
      if (!*v4)
      {
        phOsalNfc_MemCopy();
        a2 = 0;
        goto LABEL_14;
      }
      goto LABEL_11;
    }
    if (v5 < 0x16)
    {
LABEL_12:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get FW Info response received with invalid payload length");
      goto LABEL_13;
    }
    if (*v4)
    {
LABEL_11:
      sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get FW Info response Failed with Status");
LABEL_13:
      a2 = 255;
      goto LABEL_14;
    }
    v7 = (_DWORD *)(a1 + 4789);
    *(_BYTE *)(a1 + 6468) = v4[1];
    phOsalNfc_MemCopy();
    v8 = *(_BYTE **)(a1 + 3760);
    *(_BYTE *)a1 = v8[6];
    *(_BYTE *)(a1 + 1) = v8[7];
    *(_BYTE *)(a1 + 2) = v8[8];
    *(_BYTE *)(a1 + 3) = v8[9];
    v9 = v8[10];
    *(_BYTE *)(a1 + 4) = v9;
    if (v9)
    {
      if (v9 > 8)
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received number of RF interface supported exceeded max number of RF interfaces");
      else
        phOsalNfc_MemCopy();
      v10 = *(_BYTE *)(a1 + 4) + 11;
      v8 = *(_BYTE **)(a1 + 3760);
    }
    else
    {
      v10 = 11;
    }
    *(_BYTE *)(a1 + 13) = v8[v10];
    v11 = v8[(v10 + 1)];
    *(_WORD *)(a1 + 14) = v11;
    *(_WORD *)(a1 + 14) = v11 | (v8[(v10 + 2)] << 8);
    v12 = v8[(v10 + 3)];
    *(_BYTE *)(a1 + 16) = v12;
    v13 = v8[(v10 + 4)];
    *(_WORD *)(a1 + 18) = v13;
    *(_WORD *)(a1 + 18) = v13 | (v8[(v10 + 5)] << 8);
    v14 = v8[(v10 + 6)];
    *(_BYTE *)(a1 + 20) = v14;
    if (v14)
    {
      v15 = v8[(v10 + 7)];
      *(_BYTE *)(a1 + 21) = v15;
      *(_BYTE *)(a1 + 22) = v8[(v10 + 8)];
      *(_BYTE *)(a1 + 23) = v8[(v10 + 9)];
      *(_BYTE *)(a1 + 24) = v8[(v10 + 10)];
    }
    else
    {
      v15 = *(unsigned __int8 *)(a1 + 21);
    }
    *(_DWORD *)(a1 + 4792) = 0;
    *v7 = 0;
    if ((v15 - 162) <= 0x18)
    {
      v16 = 1 << (v15 + 94);
      if ((v16 & 7) != 0)
      {
        *(_BYTE *)(a1 + 4794) = 1;
LABEL_38:
        a2 = sub_2198F31D0(a1 + 888, v12);
        goto LABEL_14;
      }
      if ((v16 & 0x1018000) != 0)
      {
        *(_BYTE *)(a1 + 4793) = 1;
        v17 = *(unsigned __int8 *)(a1 + 3);
        if (v15 == 186)
        {
          if (v17 == 18)
            *(_BYTE *)(a1 + 4790) = 1;
          else
            *(_BYTE *)v7 = 1;
        }
        else if (v17 == 4)
        {
          *(_BYTE *)(a1 + 4792) = 1;
        }
        else if (v17 == 3)
        {
          *(_BYTE *)(a1 + 4791) = 1;
        }
        goto LABEL_38;
      }
    }
    if (v15 == 66)
      *(_BYTE *)(a1 + 4795) = 1;
    goto LABEL_38;
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get FW Info resposne received with failure status");
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwTypeRsp");
  return a2;
}

uint64_t sub_219857F58(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwTypeSeqComplete");
  if (a1)
  {
    if ((_DWORD)a2)
    {
      if (*(_BYTE *)(a1 + 6448))
      {
        *(_BYTE *)(a1 + 6448) = 0;
      }
      else
      {
        a2 = 0;
        *(_BYTE *)(a1 + 6468) = 3;
      }
    }
    *(_QWORD *)(a1 + 6648) = a1 + 6468;
    *(_DWORD *)(a1 + 6656) = 5;
    sub_2198E23C4(a1, a2, a1 + 6648);
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwTypeSeqComplete");
  return a2;
}

uint64_t sub_219858008(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_DetTagRemCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 28;
    *(_QWORD *)&v5 = 0;
    DWORD2(v5) = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 2u, (uint64_t)"phNciNfc_DetTagRemCmd: Invalid input parameter");
    v2 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_DetTagRemCmd");
  return v2;
}

uint64_t sub_2198580EC(uint64_t a1, uint64_t a2)
{
  const char *v4;
  _BYTE *v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DetTagRemRsp");
  if (a1)
  {
    if ((_DWORD)a2)
    {
      v4 = "Detect Tag removal response received with failure status";
    }
    else
    {
      v5 = *(_BYTE **)(a1 + 3760);
      if (v5 && *(_DWORD *)(a1 + 3768) == 1 && !*v5)
      {
        a2 = 0;
        goto LABEL_10;
      }
      a2 = 255;
      v4 = "Detect Tag removal response received with invalid payload";
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)v4);
  }
  else
  {
    a2 = 1;
  }
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DetTagRemRsp");
  return a2;
}

uint64_t sub_2198581AC(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessCommonNciCompleteSeq1");
  if (a1)
    sub_2198E23C4((uint64_t)a1, a2, 0);
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessCommonNciCompleteSeq1");
  return a2;
}

uint64_t sub_21985821C(uint64_t a1)
{
  _BYTE *v2;
  int v3;
  unsigned __int8 v4;
  uint64_t v5;
  char v6;
  unsigned __int8 v7;
  char v8;
  unsigned __int8 v9;
  char v10;
  unsigned __int8 v11;
  unsigned __int8 v12;
  unsigned __int8 v13;
  __int128 v15;
  __int128 v16;
  _OWORD v17[8];
  __int16 v18;
  uint64_t v19;

  v19 = *MEMORY[0x24BDAC8D0];
  v15 = 0u;
  v16 = 0u;
  v18 = 0;
  memset(v17, 0, sizeof(v17));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetVasCodeCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v15 = 0xF00000001;
    DWORD2(v15) = 7;
    v2 = *(_BYTE **)(a1 + 3392);
    v3 = v2[10];
    LOBYTE(v17[0]) = (v2[9] << 6) | (v2[8] << 7) | v3;
    if (v3)
    {
      phOsalNfc_MemCopy();
      v2 = *(_BYTE **)(a1 + 3392);
      v4 = v2[10] + 1;
    }
    else
    {
      v4 = 1;
    }
    v6 = v4 + 1;
    *((_BYTE *)v17 + v4) = v2[32] | (v2[31] << 6) | (v2[30] << 7);
    if (v2[32])
    {
      phOsalNfc_MemCopy();
      v2 = *(_BYTE **)(a1 + 3392);
      v7 = v2[32] + v6;
    }
    else
    {
      v7 = v4 + 1;
    }
    v8 = v7 + 1;
    *((_BYTE *)v17 + v7) = v2[54] | (v2[53] << 6) | (v2[52] << 7);
    if (v2[54])
    {
      phOsalNfc_MemCopy();
      v2 = *(_BYTE **)(a1 + 3392);
      v9 = v2[54] + v8;
    }
    else
    {
      v9 = v7 + 1;
    }
    v10 = v9 + 1;
    *((_BYTE *)v17 + v9) = v2[76] | (v2[75] << 6) | (v2[74] << 7);
    if (v2[76])
    {
      phOsalNfc_MemCopy();
      v2 = *(_BYTE **)(a1 + 3392);
      v11 = v2[76] + v10;
    }
    else
    {
      v11 = v9 + 1;
    }
    v12 = v11 + 1;
    *((_BYTE *)v17 + v11) = v2[98] | (v2[97] << 6) | (v2[96] << 7);
    if (v2[98])
    {
      phOsalNfc_MemCopy();
      v2 = *(_BYTE **)(a1 + 3392);
      v12 += v2[98];
    }
    v13 = v12 + 1;
    *((_BYTE *)v17 + v12) = v2[120] | (v2[119] << 6) | (v2[118] << 7);
    if (v2[120])
    {
      phOsalNfc_MemCopy();
      v13 += *(_BYTE *)(*(_QWORD *)(a1 + 3392) + 120);
    }
    DWORD2(v16) = v13;
    *(_QWORD *)&v16 = v17;
    v5 = sub_2198F2D0C(a1 + 888, (uint64_t)&v15, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    v5 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"phNciNfc_SetVasCodeCmd: Invalid input parameter");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetVasCodeCmd");
  return v5;
}

uint64_t sub_21985851C(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetVasCodeRsp");
  if (a1)
  {
    if ((_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Set VAS Code response resposne received with failure status");
    }
    else
    {
      v4 = *(_BYTE **)(a1 + 3760);
      if (v4 && *(_DWORD *)(a1 + 3768))
      {
        if (!*v4)
        {
          a2 = 0;
          goto LABEL_11;
        }
        sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Set VAS Code response Failed with Status");
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Set VAS Code response received with invalid payload length");
      }
      a2 = 255;
    }
  }
  else
  {
    a2 = 1;
  }
LABEL_11:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetVasCodeRsp");
  return a2;
}

uint64_t sub_219858614(uint64_t a1)
{
  uint64_t v2;
  int v3;
  unsigned int *v4;
  _DWORD v6[2];
  __int128 v7;
  __int128 v8;

  v7 = 0u;
  v8 = 0u;
  *(_DWORD *)((char *)v6 + 3) = 0;
  v6[0] = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RFParaUpdateCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v7 = 0x100000001;
    DWORD2(v7) = 11;
    LOWORD(v6[0]) = 258;
    BYTE2(v6[0]) = 1;
    if (!sub_21985E2F8((unsigned int *)a1, *(_DWORD *)(*(_QWORD *)(a1 + 3392) + 8), (_BYTE *)v6 + 3))
    {
      LOWORD(v6[1]) = 258;
      if (!sub_21985E2F8((unsigned int *)a1, *(_DWORD *)(*(_QWORD *)(a1 + 3392) + 12), (_BYTE *)&v6[1] + 2))
      {
        DWORD2(v8) = 7;
        *(_QWORD *)&v8 = v6;
        v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v7, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
        goto LABEL_7;
      }
    }
    v2 = 1;
    v3 = 1;
    v4 = (unsigned int *)(a1 + 6476);
  }
  else
  {
    v2 = 1;
    v3 = 2;
    v4 = 0;
  }
  sub_219850628(v3, v4, 3u, 1u, (uint64_t)"phNciNfc_RFParaUpdateCmd: Invalid input parameter");
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RFParaUpdateCmd");
  return v2;
}

uint64_t sub_219858774(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;
  unsigned int v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RFParaUpdateRes");
  if (!a1)
  {
    a2 = 1;
    goto LABEL_13;
  }
  if (!(_DWORD)a2)
  {
    v4 = *(_BYTE **)(a1 + 3760);
    if (!v4 || !*(_DWORD *)(a1 + 3768))
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"RF parameter update response received with invalid payload length");
LABEL_12:
      a2 = 255;
      goto LABEL_13;
    }
    v5 = *v4;
    if (v5 > 8)
    {
      if (v5 != 9)
      {
        if (v5 == 241)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Express mode has enabled");
          a2 = 81;
          goto LABEL_13;
        }
        goto LABEL_19;
      }
    }
    else
    {
      if (!*v4)
      {
        a2 = 0;
        goto LABEL_13;
      }
      if (v5 != 6)
      {
LABEL_19:
        sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"RF parameter update response ");
        goto LABEL_12;
      }
    }
    sub_219851FF8(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Unsupported Tag IDs ", (uint64_t)v4);
    a2 = 147;
    goto LABEL_13;
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"RF parameter update response received with failure status");
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RFParaUpdateRes");
  return a2;
}

uint64_t sub_2198588E4(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetVasCodeCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 8;
    DWORD2(v5) = 0;
    *(_QWORD *)&v5 = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"phNciNfc_GetVasCodeCmd: Invalid input parameter");
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetVasCodeCmd");
  return v2;
}

uint64_t sub_2198589C8(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;
  int v5;
  unsigned int v7;
  unsigned __int8 v8;
  uint64_t v9;
  char v10;
  char v11;
  uint64_t v12;
  char v13;
  char v14;
  uint64_t v15;
  char v16;
  char v17;
  uint64_t v18;
  char v19;
  char v20;
  uint64_t v21;
  unsigned int v22;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetVasCodeRsp");
  if (!a1)
  {
    a2 = 1;
    goto LABEL_11;
  }
  phOsalNfc_SetMemory();
  *(_DWORD *)(a1 + 3400) = 4;
  if ((_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get VAS Code response resposne received with failure status");
    goto LABEL_11;
  }
  v4 = *(_BYTE **)(a1 + 3760);
  if (!v4 || (v5 = *(_DWORD *)(a1 + 3768)) == 0)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get VAS Code response received with invalid payload length");
    goto LABEL_10;
  }
  if (*v4)
  {
    sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Get VAS Code response Failed with Status");
LABEL_10:
    a2 = 255;
    goto LABEL_11;
  }
  v7 = v4[1] & 0x3F;
  *(_BYTE *)(a1 + 3410) = v7;
  *(_BYTE *)(a1 + 3409) = (v4[1] & 0x40) != 0;
  *(_BYTE *)(a1 + 3408) = v4[1] >> 7;
  if (v7)
  {
    if (v7 > 0x13)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received VAScode length exceeded max VAScode len");
      a2 = 255;
    }
    else
    {
      phOsalNfc_MemCopy();
      a2 = 0;
    }
    v8 = *(_BYTE *)(a1 + 3410) + 2;
  }
  else
  {
    a2 = 0;
    v8 = 2;
  }
  if (v5 >= v8 + 2)
  {
    v9 = *(_QWORD *)(a1 + 3760);
    v10 = *(_BYTE *)(v9 + v8);
    v11 = v8 + 1;
    *(_BYTE *)(a1 + 3432) = v10 & 0x3F;
    *(_BYTE *)(a1 + 3431) = (*(_BYTE *)(v9 + v8) & 0x40) != 0;
    *(_BYTE *)(a1 + 3430) = *(_BYTE *)(v9 + v8) >> 7;
    if ((v10 & 0x3F) != 0)
    {
      if ((v10 & 0x3Fu) > 0x13)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received VAScode length exceeded max VAScode len");
        a2 = 255;
      }
      else
      {
        phOsalNfc_MemCopy();
      }
      v8 = *(_BYTE *)(a1 + 3432) + v11;
    }
    else
    {
      ++v8;
    }
  }
  if (v5 >= v8 + 2)
  {
    v12 = *(_QWORD *)(a1 + 3760);
    v13 = *(_BYTE *)(v12 + v8);
    v14 = v8 + 1;
    *(_BYTE *)(a1 + 3454) = v13 & 0x3F;
    *(_BYTE *)(a1 + 3453) = (*(_BYTE *)(v12 + v8) & 0x40) != 0;
    *(_BYTE *)(a1 + 3452) = *(_BYTE *)(v12 + v8) >> 7;
    if ((v13 & 0x3F) != 0)
    {
      if ((v13 & 0x3Fu) > 0x13)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received VAScode length exceeded max VAScode len");
        a2 = 255;
      }
      else
      {
        phOsalNfc_MemCopy();
      }
      v8 = *(_BYTE *)(a1 + 3454) + v14;
    }
    else
    {
      ++v8;
    }
  }
  if (v5 >= v8 + 2)
  {
    v15 = *(_QWORD *)(a1 + 3760);
    v16 = *(_BYTE *)(v15 + v8);
    v17 = v8 + 1;
    *(_BYTE *)(a1 + 3476) = v16 & 0x3F;
    *(_BYTE *)(a1 + 3475) = (*(_BYTE *)(v15 + v8) & 0x40) != 0;
    *(_BYTE *)(a1 + 3474) = *(_BYTE *)(v15 + v8) >> 7;
    if ((v16 & 0x3F) != 0)
    {
      if ((v16 & 0x3Fu) > 0x13)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received VAScode length exceeded max VAScode len");
        a2 = 255;
      }
      else
      {
        phOsalNfc_MemCopy();
      }
      v8 = *(_BYTE *)(a1 + 3476) + v17;
    }
    else
    {
      ++v8;
    }
  }
  if (v5 >= v8 + 2)
  {
    v18 = *(_QWORD *)(a1 + 3760);
    v19 = *(_BYTE *)(v18 + v8);
    v20 = v8 + 1;
    *(_BYTE *)(a1 + 3498) = v19 & 0x3F;
    *(_BYTE *)(a1 + 3497) = (*(_BYTE *)(v18 + v8) & 0x40) != 0;
    *(_BYTE *)(a1 + 3496) = *(_BYTE *)(v18 + v8) >> 7;
    if ((v19 & 0x3F) != 0)
    {
      if ((v19 & 0x3Fu) > 0x13)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received VAScode length exceeded max VAScode len");
        a2 = 255;
      }
      else
      {
        phOsalNfc_MemCopy();
      }
      v8 = *(_BYTE *)(a1 + 3498) + v20;
    }
    else
    {
      ++v8;
    }
  }
  if (v5 >= v8 + 2)
  {
    v21 = *(_QWORD *)(a1 + 3760);
    v22 = *(_BYTE *)(v21 + v8) & 0x3F;
    *(_BYTE *)(a1 + 3520) = v22;
    *(_BYTE *)(a1 + 3519) = (*(_BYTE *)(v21 + v8) & 0x40) != 0;
    *(_BYTE *)(a1 + 3518) = *(_BYTE *)(v21 + v8) >> 7;
    if (v22)
    {
      if (v22 <= 0x13)
      {
        phOsalNfc_MemCopy();
        goto LABEL_11;
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received VAScode length exceeded max VAScode len");
      goto LABEL_10;
    }
  }
LABEL_11:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetVasCodeRsp");
  return a2;
}

uint64_t sub_219858E30(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetVasCodeSeqComplete");
  if (a1)
  {
    if ((_DWORD)a2)
    {
      v4 = (uint64_t)a1;
      v5 = a2;
      v6 = 0;
    }
    else
    {
      v6 = (uint64_t)(a1 + 850);
      v4 = (uint64_t)a1;
      v5 = 0;
    }
    sub_2198E23C4(v4, v5, v6);
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetVasCodeSeqComplete");
  return a2;
}

uint64_t sub_219858EB4(uint64_t a1)
{
  uint64_t v2;
  unsigned int v3;
  char v4;
  uint64_t v5;
  int v6;
  uint64_t v7;
  __int16 v9;
  __int128 v10;
  __int128 v11;

  v10 = 0u;
  v11 = 0u;
  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetChipScopeCmd");
  if (a1 && *(_QWORD *)(a1 + 3392))
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v10 = 0xF00000001;
    DWORD2(v10) = 34;
    v2 = *(_QWORD *)(a1 + 3392);
    v3 = *(_DWORD *)(v2 + 8);
    if (v3 > 2)
    {
      v7 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_SetChipScopeCmd: Invalid Config");
    }
    else
    {
      if (v3 == 2
        || (*(_BYTE *)(a1 + 4788) != 1 ? (v4 = 1) : (v4 = -127),
            LOBYTE(v9) = v4,
            HIBYTE(v9) = v3,
            DWORD2(v11) = 2,
            *(_QWORD *)&v11 = &v9,
            *(_DWORD *)(v2 + 8) == 2))
      {
        v5 = *(_QWORD *)(v2 + 16);
        if (v5)
        {
          if (*(_QWORD *)v5)
          {
            v6 = *(_DWORD *)(v5 + 8);
            if (v6)
            {
              DWORD2(v11) = v6;
              *(_QWORD *)&v11 = **(_QWORD **)(v2 + 16);
            }
          }
        }
      }
      v7 = sub_2198F2D0C(a1 + 888, (uint64_t)&v10, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
    }
  }
  else
  {
    v7 = 1;
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciNfc_SetChipScopeCmd: Invalid input parameter");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetChipScopeCmd");
  return v7;
}

uint64_t sub_219859038(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetChipScopeRsp");
  if (!a1)
  {
LABEL_9:
    a2 = 255;
    goto LABEL_10;
  }
  if (!(_DWORD)a2)
  {
    v4 = *(_BYTE **)(a1 + 3760);
    if (v4 && *(_DWORD *)(a1 + 3768) == 1)
    {
      if (!*v4)
      {
        a2 = 0;
        goto LABEL_10;
      }
      sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_SetChipScopeRsp : Chip scope response Failed with Status");
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_SetChipScopeRsp : Chipscope response with invalid payload length");
    }
    goto LABEL_9;
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_SetChipScopeRsp : Chip scope response received with failure status");
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetChipScopeRsp");
  return a2;
}

uint64_t sub_21985912C(unsigned int *a1, unsigned int a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateRfInterface");
  if (a2 < 4 || (v4 = 1, a2 - 128 <= 3) && a2 != 130)
    v4 = 0;
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateRfInterface");
  return v4;
}

uint64_t sub_2198591B4(unsigned int *a1, int a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateRfProtocol");
  if ((a2 - 1) < 6
    || (v4 = 1, (a2 - 128) <= 0x20) && ((1 << (a2 + 0x80)) & 0x100000401) != 0)
  {
    v4 = 0;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateRfProtocol");
  return v4;
}

uint64_t sub_219859250(unsigned int *a1, unsigned int a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateRfTechMode");
  v4 = 1;
  if (a2 <= 0xC && ((1 << a2) & 0x1C6F) != 0 || a2 - 128 <= 5 && a2 != 132)
    v4 = 0;
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateRfTechMode");
  return v4;
}

uint64_t sub_2198592E8(unsigned int *a1, int a2, int a3, _DWORD *a4, int *a5)
{
  int v10;
  int v11;
  int v12;
  const char *v13;
  int v14;
  const char *v15;
  int v16;
  int v18;
  const char *v19;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
  if (!a4 || !a5)
  {
    v13 = "Invalid Input Parameter";
LABEL_11:
    sub_219850628(2, a1, 3u, 1u, (uint64_t)v13);
    return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
  }
  v10 = a4[5];
  if (!v10)
  {
    if (!a3)
    {
      *a5 = 19;
      v15 = " Type 1 Tag detected..";
      goto LABEL_22;
    }
    v14 = a4[3];
    if (v14 == 1)
    {
      v12 = a4[4];
      if (v12 != 4)
      {
LABEL_31:
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"SAK Received");
        if (a2 > 31)
        {
          if (a2 <= 95)
          {
            if (a2 > 39)
            {
              if (a2 != 40)
              {
                if (a2 != 56)
                  goto LABEL_79;
LABEL_72:
                *a5 = 11;
                v15 = " Mifare4k tag detected..";
                goto LABEL_22;
              }
LABEL_73:
              if (a4[3] == 2 && a4[4] == 4)
              {
                *a5 = 3;
                v15 = "4A tag detected..";
              }
              else
              {
                *a5 = 9;
                v15 = " Mifare1k tag detected..";
              }
              goto LABEL_22;
            }
            if (a2 == 32 || a2 == 36)
              goto LABEL_69;
          }
          else
          {
            if (a2 > 135)
            {
              if (a2 != 136)
              {
                if (a2 != 152 && a2 != 184)
                  goto LABEL_79;
                goto LABEL_72;
              }
              goto LABEL_73;
            }
            if (a2 == 96 || a2 == 104)
            {
LABEL_69:
              *a5 = 3;
              v15 = " 4A tag detected..";
              goto LABEL_22;
            }
          }
LABEL_79:
          v18 = a4[4];
          switch(v18)
          {
            case 128:
              *a5 = 14;
              v19 = "Tag with MFC protocol and Unknown SAK detected..";
              break;
            case 4:
              *a5 = 3;
              v19 = "Tag with ISODEP protocol and Unknown SAK detected..";
              break;
            case 2:
              *a5 = 4;
              v15 = "Tag with T2t protocol and Unknown SAK detected..";
              goto LABEL_22;
            default:
              *a5 = 0;
              v19 = " Unknown tag detected..";
              break;
          }
          sub_219850628(2, a1, 3u, 2u, (uint64_t)v19);
          return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
        }
        if (a2 <= 15)
        {
          switch(a2)
          {
            case 0:
              *a5 = 8;
              v15 = " MifareUL tag detected..";
              goto LABEL_22;
            case 1:
            case 8:
              goto LABEL_73;
            case 9:
              *a5 = 12;
              v15 = " Mifare Mini tag detected..";
              goto LABEL_22;
            default:
              goto LABEL_79;
          }
        }
        if ((a2 - 16) < 2)
        {
          *a5 = 13;
          v15 = " Mifare Plus tag detected..";
          goto LABEL_22;
        }
        if (a2 == 24)
          goto LABEL_72;
        if (a2 != 25)
          goto LABEL_79;
        *a5 = 10;
        v15 = " Mifare2k tag detected..";
LABEL_22:
        sub_219850628(2, a1, 3u, 4u, (uint64_t)v15);
        return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
      }
    }
    else
    {
      if (v14 != 3 || a4[4] != 5)
        goto LABEL_31;
LABEL_20:
      v12 = 23;
    }
LABEL_65:
    *a5 = v12;
    return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
  }
  v11 = a4[4];
  if (a2 == 32 && v11 == 4)
  {
    switch(v10)
    {
      case 12:
        v12 = 7;
        break;
      case 11:
        v12 = 6;
        break;
      case 10:
        v12 = 5;
        break;
      default:
        v12 = 26;
        break;
    }
    goto LABEL_65;
  }
  if (v10 <= 111)
  {
    switch(v10)
    {
      case 1:
        if ((a2 & 1) != 0 && ((v16 = a4[3], v16 == 131) || v16 == 2) && v11 == 4)
        {
          sub_219850628(2, a1, 3u, 4u, (uint64_t)" 4B tag detected..");
          v12 = 16;
        }
        else
        {
          v12 = 25;
        }
        goto LABEL_65;
      case 2:
      case 3:
      case 5:
        if (v11 == 5)
          goto LABEL_20;
        return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
      case 6:
        if (v11 != 6)
          return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
        v12 = 20;
        break;
      default:
        return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
    }
    goto LABEL_65;
  }
  if (v10 > 130)
  {
    if (v10 == 133 || v10 == 131)
    {
LABEL_43:
      if (v11 == 5 && a4[3] == 3)
      {
        v12 = 24;
        goto LABEL_65;
      }
      v13 = "Nfc-A Listen mode notification - unknown";
      goto LABEL_11;
    }
  }
  else
  {
    if (v10 != 112)
    {
      if (v10 != 128)
        return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
      goto LABEL_43;
    }
    if (v11 == 138)
    {
      sub_219850628(2, a1, 3u, 4u, (uint64_t)" Kovio tag detected..");
      v12 = 22;
      goto LABEL_65;
    }
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfDevType");
}

uint64_t sub_219859754(unsigned int *a1, _BYTE *a2, unsigned int a3)
{
  uint64_t v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateIntfActvdNtf");
  v6 = 1;
  if (a2 && a3 >= 0xB)
  {
    if (a2[1])
    {
      if (a2[6] + a2[a2[6] + 10] + 11 == a3)
        v6 = sub_21985980C(a1, a2, a3);
    }
    else
    {
      v6 = 0;
    }
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateIntfActvdNtf");
  return v6;
}

uint64_t sub_21985980C(unsigned int *a1, _BYTE *a2, int a3)
{
  uint64_t v6;
  const char *v7;
  unsigned __int8 v8;
  unsigned int v9;
  unsigned int v10;
  unsigned int v11;
  unsigned __int8 *v12;
  unsigned int v13;
  unsigned int v14;
  unsigned int v15;
  const char *v16;
  const char *v17;
  const char *v18;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateIfActParams");
  v6 = 1;
  if (a2 && a3)
  {
    if ((*a2 + 1) <= 1u)
    {
      v7 = "Invalid RfDiscId!";
LABEL_53:
      sub_219850628(2, a1, 3u, 1u, (uint64_t)v7);
      goto LABEL_54;
    }
    v8 = a2[1];
    if ((v8 & 0x7C) != 0)
    {
      v7 = "Invalid RfInterface!";
      goto LABEL_53;
    }
    v9 = a2[2];
    v10 = a2[3];
    v11 = a2[4];
    v12 = &a2[a2[6]];
    v13 = v12[7];
    v14 = v12[8];
    v15 = v12[9];
    if ((char)v9 >= -117 && v9 - 7 <= 0xFFFFFFF9)
    {
      if (sub_21985B90C(a1, a2) == 255)
      {
LABEL_10:
        v7 = "Invalid RfProtocol!";
LABEL_52:
        v6 = 1;
        goto LABEL_53;
      }
LABEL_14:
      if (v13 >= 0x71)
      {
        if ((char)v13 >= -125)
        {
          if ((v13 + 125) >= 3u)
          {
            v7 = "Invalid DataXchg Actv Rf Tech and mode received!";
            goto LABEL_52;
          }
          v17 = "Valid DataXchg Actv Rf Tech and mode received (3)...";
        }
        else
        {
          v17 = "Valid DataXchg Actv Rf Tech and mode received (2)...";
        }
      }
      else
      {
        v17 = "Valid DataXchg Actv Rf Tech and mode received (1)...";
      }
      sub_219850628(2, a1, 3u, 4u, (uint64_t)v17);
      if (v11 <= 0x1F)
      {
        if (v11)
        {
          v7 = "Invalid Max Data packet Payload!";
          goto LABEL_52;
        }
        sub_219850628(2, a1, 3u, 1u, (uint64_t)"Received invalid Max data packet payload size. Applying work around");
        a2[4] = -4;
      }
      if (v14 >= 7 && v14 != 128 || v15 >= 7 && v15 != 128)
      {
        v7 = "Invalid BitRate!";
        goto LABEL_52;
      }
      if (v8 == 2 && v9 != 4)
      {
        v7 = "ISO DEP interface mapped to wrong protocol!";
        goto LABEL_52;
      }
      if (v8 == 1)
      {
        if ((v9 > 6 || ((1 << v9) & 0x5E) == 0) && v9 != 138 && v9 != 130)
        {
          if (sub_21985B90C(a1, a2) == 255)
            goto LABEL_10;
LABEL_57:
          v6 = 0;
          goto LABEL_54;
        }
        v18 = "Valid Frame-RF interface to protocol mapping!";
      }
      else
      {
        if (v8 == 128)
        {
          if (v9 != 1 && v9 != 128)
          {
            v7 = "TagCmd interface mapped to wrong protocol!";
            goto LABEL_52;
          }
        }
        else if (v8 == 3 && v9 != 5)
        {
          v7 = "NFC DEP interface mapped to wrong protocol!";
          goto LABEL_52;
        }
        v18 = "Interface activated ntf parameter validation success";
      }
      sub_219850628(2, a1, 3u, 4u, (uint64_t)v18);
      goto LABEL_57;
    }
    if (v10 >= 3)
    {
      if (a2[3] > 5u)
      {
        if (v10 == 112)
        {
          v16 = "Kovio poll Techn and mode received";
          goto LABEL_13;
        }
        if (v10 == 6)
        {
          v16 = "ISO15693 passive poll Techn and mode received";
          goto LABEL_13;
        }
      }
      else
      {
        v16 = " Nfc-A and Nfc-F active Rf tech and mode sent ";
        if (v10 == 3 || v10 == 5)
          goto LABEL_13;
      }
      if ((char)v10 >= -125)
      {
        if (a2[3] <= 0xBu)
        {
          if (v10 == 10)
          {
            v16 = "type A silent NTAG poll phase Techn and mode received";
            goto LABEL_13;
          }
          if (v10 == 11)
          {
            v16 = "type A silent TAG1 poll phase Techn and mode received";
            goto LABEL_13;
          }
        }
        else
        {
          if (v10 == 12)
          {
            v16 = "type A silent TAG2 poll phase Techn and mode received";
            goto LABEL_13;
          }
          v16 = "  Nfc-A and Nfc-F active listen  Rf tech and mode sent ";
          if (v10 == 131 || v10 == 133)
            goto LABEL_13;
        }
        v7 = "Invalid Actv Rf Tech and mode received!";
        goto LABEL_52;
      }
      v16 = "Valid Actv Rf Tech and mode received (2)...";
    }
    else
    {
      v16 = "Valid Actv Rf Tech and mode received (1)...";
    }
LABEL_13:
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v16);
    goto LABEL_14;
  }
LABEL_54:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateIfActParams");
  return v6;
}

uint64_t sub_219859BD8(uint64_t a1)
{
  uint64_t v2;
  unsigned int *v3;
  const char *v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetConnCredentials");
  if (a1)
  {
    v2 = sub_219878B08(a1, 2, *(unsigned __int8 *)(*(_QWORD *)(a1 + 4512) + 8), *(_QWORD *)(a1 + 4512));
    v3 = (unsigned int *)(a1 + 6476);
    if (!(_DWORD)v2)
    {
      sub_219850628(1, v3, 3u, 4u, (uint64_t)"Conn Credentials updated successfully..");
      goto LABEL_7;
    }
    v4 = "Conn Credentials update failed!!..";
    v5 = 1;
  }
  else
  {
    v4 = " Invalid Context Param..";
    v2 = 1;
    v5 = 2;
    v3 = 0;
  }
  sub_219850628(v5, v3, 3u, 1u, (uint64_t)v4);
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetConnCredentials");
  return v2;
}

uint64_t sub_219859CA4(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v6;
  void (*v7)(_QWORD, uint64_t, int *, _QWORD);
  uint64_t v8;
  int v10;

  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LpcdTraceNtfHandler");
  v6 = 1;
  if (a1 && a2)
  {
    if (*(_QWORD *)(a2 + 8) && !a3 && *(_DWORD *)(a2 + 16) == 4)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"RF_LPCD_TRACE_NTF Received");
      v10 = **(_DWORD **)(a2 + 8);
      sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Reference value");
      sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Measurement Value");
      v7 = *(void (**)(_QWORD, uint64_t, int *, _QWORD))(a1 + 408);
      if (v7)
        v7(*(_QWORD *)(a1 + 400), 24, &v10, 0);
      v6 = 0;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed to process LPCD Trace Ntf");
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid buffer or incorrect payload length or Tml receive failed");
      v8 = *(_QWORD *)(a2 + 8);
      if (v8)
        sub_219851FF8(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Data received is", v8);
      v6 = 255;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LpcdTraceNtfHandler");
  return v6;
}

uint64_t sub_219859E40(uint64_t a1, uint64_t a2, int a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t, uint64_t);
  const char *v7;
  int v8;
  unsigned int *v9;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_InvokeUartCommnErrNtf");
  if (!a1)
  {
    v7 = "Can not process Generic Error Ntf - Invalid input parameters";
    v8 = 2;
    v9 = 0;
LABEL_7:
    sub_219850628(v8, v9, 3u, 1u, (uint64_t)v7);
    goto LABEL_8;
  }
  if (a3 != 245)
  {
    v9 = (unsigned int *)(a1 + 6476);
    v7 = "UNKOWN UART ERROR";
    v8 = 1;
    goto LABEL_7;
  }
  v6 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t))(a1 + 264);
  if (v6)
    v6(*(_QWORD *)(a1 + 256), 46, a2, 80);
LABEL_8:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_InvokeUartCommnErrNtf");
  return 0;
}

uint64_t sub_219859F08(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD, uint64_t);
  char v6;
  uint64_t v7;
  uint64_t v8;
  int *v9;
  uint64_t v10;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_InvokeCrcErrNtf");
  if (!a1)
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Can not process Crc Error Ntf - Invalid input parameters");
LABEL_13:
    v10 = 0;
    goto LABEL_14;
  }
  *(_BYTE *)(a1 + 6244) = 0;
  sub_219886108(*(_QWORD *)(a1 + 6480), a3);
  v5 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(a1 + 440);
  if (v5)
    v5(*(_QWORD *)(a1 + 432), 26, 0, a3);
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = *((_QWORD *)&unk_253E46700 + 14 * v7 + 4);
    if ((v6 & 1) != 0)
      break;
    v6 = 1;
    v7 = 1;
  }
  while (v8 != a1);
  if (v8 != a1 || *(_BYTE *)(a1 + 1880) != 1)
    goto LABEL_13;
  phOsalNfc_Timer_Stop();
  *(_BYTE *)(a1 + 6464) = 0;
  *(_BYTE *)(a1 + 1880) = 0;
  v9 = &dword_253E47158;
  if (!*(_DWORD *)(a1 + 3356))
    v9 = &dword_253E47070;
  v9[1] &= ~0x10u;
  v10 = sub_21985A05C(a1, 0, 255);
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_InvokeCrcErrNtf");
  return v10;
}

uint64_t sub_21985A05C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GenericSequence");
  if (a1 && a2)
  {
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GenericSequence");
  return v6;
}

uint64_t sub_21985A0EC(uint64_t a1, uint64_t a2, int a3)
{
  unsigned __int8 *v6;
  int v7;
  uint64_t v8;
  int v9;
  uint64_t v10;
  void (*v11)(_QWORD, uint64_t, _QWORD, _QWORD);
  void (*v12)(_QWORD, uint64_t, _QWORD *, uint64_t);
  int v14;
  __int16 v15;
  uint64_t v16;
  __int16 *v17;
  uint64_t v18;
  _QWORD v19[3];

  memset(v19, 0, sizeof(v19));
  v16 = 0;
  v17 = 0;
  v18 = 0;
  v15 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGenericErrNtf");
  if (!a1 || !a2)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"Can not process Generic Error Ntf - Invalid input parameters");
    goto LABEL_10;
  }
  phOsalNfc_Timer_Stop();
  *(_BYTE *)(a1 + 6464) = 0;
  sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_ProcessGenericErrNtf");
  v6 = *(unsigned __int8 **)(a2 + 8);
  if (!v6 || a3 || *(_DWORD *)(a2 + 16) != 1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed to process Generic Error Ntf");
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid buffer or incorrect payload length or                                  Tml receive failed receive failed");
    v8 = 255;
    goto LABEL_43;
  }
  v7 = *v6;
  if (v7 <= 159)
  {
    switch(v7)
    {
      case 1:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_REJECTED");
        v8 = 0;
        LODWORD(v19[0]) = 1;
        break;
      case 2:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_RF_FRAME_CORRUPTED");
        v8 = 0;
        v9 = 2;
        goto LABEL_40;
      case 3:
        LODWORD(v19[0]) = 3;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_FAILED");
        v8 = 0;
        break;
      case 4:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_NOT_INITIALIZED");
        v8 = 0;
        v9 = 4;
        goto LABEL_40;
      case 5:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_SYNTAX_ERROR");
        v8 = 0;
        LODWORD(v19[0]) = 5;
        *(_WORD *)(a1 + 4768) = 0;
        break;
      case 6:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_SEMANTIC_ERROR");
        v8 = 0;
        v9 = 6;
        goto LABEL_40;
      case 9:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_INVALID_PARAM");
        v8 = 0;
        v9 = 7;
        goto LABEL_40;
      case 10:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_MESSAGE_SIZE_EXCEEDED");
        v8 = 0;
        v9 = 8;
        goto LABEL_40;
      default:
        goto LABEL_44;
    }
    goto LABEL_41;
  }
  if (v7 > 236)
  {
    if (v7 > 246)
    {
      if (v7 != 247)
      {
        if (v7 == 248)
        {
          LODWORD(v18) = 2;
          v17 = &v15;
          v8 = sub_219885604(a1, (uint64_t)&v16, 0);
          goto LABEL_43;
        }
        goto LABEL_44;
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_SMB_TX_BLOCKED");
      v8 = 0;
      v9 = 247;
LABEL_40:
      LODWORD(v19[0]) = v9;
      goto LABEL_41;
    }
    if (v7 == 237)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_CUST_TRIM_ERROR");
      LODWORD(v19[0]) = 237;
      v8 = 154;
      goto LABEL_41;
    }
    if (v7 != 240)
      goto LABEL_44;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_CRC_ERROR");
    LODWORD(v19[0]) = 240;
    if (*(_BYTE *)(a1 + 6433) == 1)
    {
      sub_2198799F4((unsigned int *)a1, *(unsigned __int8 *)(a1 + 6434), 1);
      *(_BYTE *)(a1 + 6433) = 0;
    }
    sub_219859F08(a1, v10, 33);
LABEL_10:
    v8 = 0;
    goto LABEL_43;
  }
  if (v7 <= 161)
  {
    if (v7 == 160)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_DISCOVERY_ALREADY_STARTED");
      v8 = 0;
      v9 = 9;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_DISCOVERY_TARGET_ACTIVATION_FAILED");
      sub_219853E34(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"ErrNtf: Generic error received: PH_NCINFC_STATUS_DISCOVERY_TARGET_ACTIVATION_FAILED");
      v8 = 0;
      v9 = 10;
    }
    goto LABEL_40;
  }
  if (v7 == 162)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_DISCOVERY_TEAR_DOWN");
    v8 = 0;
    v9 = 11;
    goto LABEL_40;
  }
  if (v7 == 235)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Generic error received: PH_NCINFC_STATUS_GPADC_LOW_TEMPERATURE");
    v11 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 232);
    if (v11)
      v11(*(_QWORD *)(a1 + 224), 28, 0, 0);
    goto LABEL_45;
  }
LABEL_44:
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Generic error received: Unknown error code");
LABEL_45:
  LODWORD(v19[0]) = 256;
  v14 = **(unsigned __int8 **)(a2 + 8);
  *(_DWORD *)(a1 + 6444) = v14;
  HIDWORD(v19[0]) = v14;
  v8 = 133;
LABEL_41:
  v12 = *(void (**)(_QWORD, uint64_t, _QWORD *, uint64_t))(a1 + 248);
  if (v12)
    v12(*(_QWORD *)(a1 + 240), 46, v19, v8);
LABEL_43:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGenericErrNtf");
  return v8;
}

uint64_t sub_21985A618(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  int v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  void (*v14)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;

  v15 = 0;
  v16 = 0;
  v17 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSysEoOpNtf");
  if (a1 && a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received System End of operation notification from NFCC");
    if (*(_QWORD *)(a1 + 768) && *(_BYTE *)(a1 + 6432) == 1)
    {
      v6 = *(_QWORD *)(a1 + 3952);
      *(_BYTE *)(a1 + 6664) = 0;
      if (v6)
      {
        v7 = *(unsigned __int8 *)(v6 + 1);
        if (v7 != 1 && (v7 != **(unsigned __int8 **)(a2 + 8) || !*(_DWORD *)(a1 + 3948)))
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_ProcessSysEoOpNtf: EoOp Ntf is dropped");
          goto LABEL_19;
        }
      }
      v8 = *(_QWORD *)(a1 + 4664);
      if (v8 && v8 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Stop();
        sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4664), 3u, 4u, (uint64_t)"phNciNfc_ProcessSysEoOpNtf");
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 4664) = 0xFFFFFFFFFFFFLL;
      }
      v9 = *(_QWORD *)(a2 + 8);
      if (v9 && *(_DWORD *)(a2 + 16))
        *(_BYTE *)(a1 + 6664) = *(_BYTE *)(v9 + 1);
      *(_QWORD *)(a1 + 768) = 0;
      *(_QWORD *)(a1 + 776) = 0;
      v10 = a1;
      v11 = a3;
      v12 = a1 + 6664;
    }
    else
    {
      if (!(_DWORD)a3)
      {
        v14 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 392);
        if (v14)
        {
          v15 = *(_QWORD *)(a2 + 8);
          LODWORD(v16) = *(_DWORD *)(a2 + 16);
          v14(*(_QWORD *)(a1 + 384), 19, &v15, 0);
          goto LABEL_19;
        }
      }
      v10 = a1;
      v11 = 255;
      v12 = 0;
    }
    sub_2198E23C4(v10, v11, v12);
  }
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSysEoOpNtf");
  return a3;
}

uint64_t sub_21985A7FC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _BYTE *v6;
  int v7;
  uint64_t v8;
  void (*v9)(uint64_t, uint64_t, uint64_t *, uint64_t);
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;

  v17 = 0;
  v18 = 0;
  v19 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessModeSetDisableNtf");
  if (!a1 || !a2)
    goto LABEL_24;
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received NFCEE Power OFF notification from NFCC");
  v6 = *(_BYTE **)(a2 + 8);
  if (v6)
    v7 = *(_DWORD *)(a2 + 16);
  else
    v7 = 0;
  v17 = *(_QWORD *)(a2 + 8);
  LODWORD(v18) = v7;
  if (!*(_QWORD *)(a1 + 768) || *(_BYTE *)(a1 + 6432) != 1)
  {
    if (!(_DWORD)a3)
    {
      v9 = *(void (**)(uint64_t, uint64_t, uint64_t *, uint64_t))(a1 + 232);
      if (v9)
      {
        v10 = *(_QWORD *)(a1 + 224);
        v11 = 0;
        goto LABEL_16;
      }
    }
    v12 = a1;
    v13 = 255;
    v14 = 0;
LABEL_23:
    sub_2198E23C4(v12, v13, v14);
    goto LABEL_24;
  }
  v8 = *(_QWORD *)(a1 + 3952);
  *(_BYTE *)(a1 + 6664) = 0;
  if (!v8 || !*(_DWORD *)(a1 + 3948))
  {
    v15 = *(_QWORD *)(a1 + 4664);
    if (v15 && v15 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4664), 3u, 4u, (uint64_t)"phNciNfc_ProcessModeSetDisableNtf");
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 4664) = 0xFFFFFFFFFFFFLL;
      v6 = *(_BYTE **)(a2 + 8);
    }
    if (v6)
      *(_BYTE *)(a1 + 6664) = *v6;
    *(_QWORD *)(a1 + 768) = 0;
    *(_QWORD *)(a1 + 776) = 0;
    v12 = a1;
    v13 = a3;
    v14 = a1 + 6664;
    goto LABEL_23;
  }
  v9 = *(void (**)(uint64_t, uint64_t, uint64_t *, uint64_t))(a1 + 232);
  if (v9)
  {
    v10 = *(_QWORD *)(a1 + 224);
    v11 = a3;
LABEL_16:
    v9(v10, 18, &v17, v11);
  }
LABEL_24:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessModeSetDisableNtf");
  return a3;
}

uint64_t sub_21985A9C4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessExpModeTxNtf");
  if (a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received Suica Transaction Happened notification from NFCC");
    if (!(_DWORD)a3)
    {
      v5 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 232);
      if (v5)
        v5(*(_QWORD *)(a1 + 224), 20, 0, 0);
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessExpModeTxNtf");
  return a3;
}

uint64_t sub_21985AA64(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, _QWORD, _QWORD);
  int v7;
  uint64_t v8;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessExpModeStartedNtf");
  if (!a1)
    goto LABEL_19;
  if (!a2)
    goto LABEL_19;
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received Express Mode started notification from NFCC");
  if ((_DWORD)a3)
    goto LABEL_19;
  v6 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 232);
  if (!v6)
  {
LABEL_11:
    a3 = 0;
    goto LABEL_19;
  }
  v7 = *(_DWORD *)(a2 + 16);
  if (v7 != 1)
  {
    a3 = 0;
    if (v7 || *(_BYTE *)(a1 + 4795) != 1)
      goto LABEL_19;
    v6(*(_QWORD *)(a1 + 224), 21, 0, 0);
    goto LABEL_11;
  }
  a3 = 0;
  v8 = 21;
  switch(**(_BYTE **)(a2 + 8))
  {
    case 1:
      break;
    case 2:
      a3 = 0;
      v8 = 22;
      break;
    case 3:
      a3 = 0;
      v8 = 23;
      break;
    case 4:
      a3 = 0;
      v8 = 35;
      break;
    case 5:
      if (sub_21986514C(a1, a2, 0))
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"HCE Activation in Express mode failed");
        v8 = 36;
        a3 = 255;
      }
      else
      {
        a3 = 0;
        v8 = 36;
      }
      break;
    default:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received INVALID notification from NFCC");
      a3 = 0;
      v8 = 46;
      break;
  }
  (*(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(a1 + 232))(*(_QWORD *)(a1 + 224), v8, 0, a3);
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessExpModeStartedNtf");
  return a3;
}

uint64_t sub_21985AC18(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;

  v8 = 0;
  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSysL1DbgMsgNtf");
  if (a1)
  {
    if (a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received System L1 logging notification from NFCC");
      if (!(_DWORD)a3)
      {
        v6 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 296);
        if (v6)
        {
          v8 = *(_QWORD *)(a2 + 8);
          LODWORD(v9) = *(_DWORD *)(a2 + 16);
          v6(*(_QWORD *)(a1 + 288), 8, &v8, 0);
        }
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSysL1DbgMsgNtf");
  return a3;
}

uint64_t sub_21985ACE8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;

  v8 = 0;
  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSysL2DbgMsgNtf");
  if (a1)
  {
    if (a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received System L2 logging notification from NFCC");
      if (!(_DWORD)a3)
      {
        v6 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 296);
        if (v6)
        {
          v8 = *(_QWORD *)(a2 + 8);
          LODWORD(v9) = *(_DWORD *)(a2 + 16);
          v6(*(_QWORD *)(a1 + 288), 9, &v8, 0);
        }
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSysL2DbgMsgNtf");
  return a3;
}

uint64_t sub_21985ADB8(uint64_t a1, uint64_t a2, int a3)
{
  unsigned __int8 *v6;
  void (*v7)(_QWORD, uint64_t, _QWORD);
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGenericErrNtfMFC");
  if (!a1 || !a2)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"NtfMFC: Can not process Generic Error Ntf - Invalid input parameters");
LABEL_13:
    v8 = 0;
    goto LABEL_14;
  }
  phOsalNfc_Timer_Stop();
  *(_BYTE *)(a1 + 6464) = 0;
  sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_ProcessGenericErrNtfMFC");
  v6 = *(unsigned __int8 **)(a2 + 8);
  if (v6 && !a3 && *(_DWORD *)(a2 + 16) == 1)
  {
    if (*v6 == 161)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"NtfMFC: Generic error received: PH_NCINFC_STATUS_DISCOVERY_TARGET_ACTIVATION_FAILED");
      sub_219853E34(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"NtfMFC-ConnctCb: Generic error received: PH_NCINFC_STATUS_DISCOVERY_TARGET_ACTIVATION_FAILED");
      phOsalNfc_Timer_Stop();
      *(_BYTE *)(a1 + 6464) = 0;
      v7 = *(void (**)(_QWORD, uint64_t, _QWORD))(a1 + 720);
      if (v7)
      {
        *(_QWORD *)(a1 + 720) = 0;
        v7(*(_QWORD *)(a1 + 728), 146, 0);
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"NtfMFC: Generic error received: Unknown error code");
    }
    v10 = 3;
    LODWORD(v11) = 7;
    sub_2198F3088((unsigned int *)(a1 + 888), (uint64_t)&v10, (uint64_t)sub_21985ADB8);
    goto LABEL_13;
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"NtfMFC: Failed to process Generic Error Ntf");
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"NtfMFC: Invalid buffer or incorrect payload length or                                  Tml receive failed receive failed");
  v8 = 255;
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGenericErrNtfMFC");
  return v8;
}

uint64_t sub_21985AFBC(uint64_t a1, uint64_t a2, int a3)
{
  unsigned int *v6;
  unsigned __int8 *v7;
  unsigned int *v8;
  int v9;
  unsigned int v12;
  const char *v13;
  __int16 v14;
  const char *v15;
  uint64_t v16;
  int v17;
  unsigned int *v18;
  int v20;
  unsigned int v21;
  int v22;
  int v23;
  _BYTE *v24;
  unsigned int v25;
  unsigned int *v26;
  unsigned __int8 *v27;
  uint64_t v28;
  int *v29;
  void (*v30)(_QWORD, uint64_t, _QWORD, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessIntfErrNtf");
  v6 = sub_2198C82D4((unsigned int *)a1);
  if (a1 && a2)
  {
    *(_WORD *)(a1 + 6570) = 0;
    v7 = *(unsigned __int8 **)(a2 + 8);
    if (!v7 || a3 || *(_DWORD *)(a2 + 16) != 2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"IntfErrNtf: Failed to process Intf Error Ntf");
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"IntfErrNtf: Invalid buffer or incorrect payload length or                                  Tml receive failed receive failed");
      v16 = 255;
      goto LABEL_21;
    }
    v8 = v6;
    v9 = *v7;
    if (((v9 - 176) > 0x13 || ((1 << (v9 + 80)) & 0xFC00F) == 0) && v9 != 2)
    {
      v20 = 255;
      LOBYTE(v21) = 15;
      goto LABEL_39;
    }
    v21 = v7[1];
    sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Interface err received over connection ID");
    if (v21 > 0xF)
    {
      v20 = 255;
      goto LABEL_39;
    }
    v12 = **(unsigned __int8 **)(a2 + 8);
    if (v12 > 0xBD)
    {
      if (v12 == 190)
      {
        v13 = "PH_NCINFC_STATUS_HRM_SE_INIT_REQUIRED status received by NFCC during Data Exchange ";
        v14 = 187;
      }
      else
      {
        if (v12 != 191)
        {
LABEL_33:
          if (*(_BYTE *)(a1 + 1880) == 1)
          {
            if (*(_DWORD *)(a1 + 1856)
              || (sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Deleting response timer"),
                  v21 != *(unsigned __int8 *)(a1 + 1868)))
            {
              v22 = 0;
            }
            else
            {
              phOsalNfc_Timer_Stop();
              *(_BYTE *)(a1 + 6464) = 0;
              *(_BYTE *)(a1 + 1880) = 0;
              v22 = 0;
              if (*(_DWORD *)(a1 + 3356))
                dword_253E4715C &= ~0x10u;
              else
                dword_253E47074 &= ~0x10u;
            }
            v20 = 10;
            goto LABEL_49;
          }
          v20 = 10;
LABEL_39:
          v22 = *(_DWORD *)(a1 + 6476);
          if (*(_DWORD *)(a1 + 1456))
          {
            if (v22)
            {
              v22 = 0;
              dword_253E4715C &= ~0x20000000u;
            }
            else
            {
              dword_253E47074 &= ~0x20000000u;
            }
          }
          else
          {
            if (v22)
              dword_253E4715C |= 0x20000000u;
            else
              dword_253E47074 |= 0x20000000u;
            v22 = 1;
          }
LABEL_49:
          v23 = *(unsigned __int8 *)(a1 + 3320);
          if (v23 == 1 || *(_BYTE *)(a1 + 3321) == 1)
          {
            v24 = *(_BYTE **)(a2 + 8);
            v25 = v24[1];
            if (v25 <= 0xF && (*v24 + 76) <= 0xBu)
            {
              v26 = (unsigned int *)(a1 + 6476);
              sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Interface err received over connection ID");
              *(_WORD *)(a1 + 6570) = 185;
              sub_219886108(*(_QWORD *)(a1 + 6480), **(unsigned __int8 **)(a2 + 8));
              LOBYTE(v21) = v25;
LABEL_59:
              sub_219850628(1, v26, 3u, 2u, (uint64_t)"UNKNOWN ERROR Detected by NFCC during Data Exchange ");
LABEL_60:
              sub_21987FEF8((unsigned int *)a1);
              *((_QWORD *)v8 + 4) = 0;
              *((_BYTE *)v8 + 64) = 0;
              v28 = *((_QWORD *)v8 + 7);
              if (v28 && v28 != 0xFFFFFFFFFFFFLL)
              {
                phOsalNfc_Timer_Stop();
                phOsalNfc_Timer_Delete();
              }
              *(_BYTE *)(a1 + 6465) = 0;
              *((_QWORD *)v8 + 7) = 0;
              *((_BYTE *)v8 + 49) = 0;
              v29 = &dword_253E47158;
              if (!*(_DWORD *)(a1 + 6476))
                v29 = &dword_253E47070;
              v29[1] &= ~8u;
              *(_DWORD *)(a1 + 1800) = 0;
              *(_BYTE *)(a1 + 1812) = v21;
              *(_WORD *)(a1 + 3176) = 10;
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Interface err received, initiating RecvStateHandler with 'NFCSTATUS_RF_ERROR' status");
              sub_219851308(a1 + 888, 2u);
              v30 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 584);
              if (!v30 || *(_BYTE *)(a1 + 3321) != 1)
              {
                v16 = 1;
                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_ProcessIntfErrNtf:pRfIntfErrNtfCb call back is not registered so dropped at NCI");
                goto LABEL_21;
              }
              *(_BYTE *)(a1 + 3321) = 0;
              v30(*(_QWORD *)(a1 + 576), 38, 0, *(unsigned __int16 *)(a1 + 6570));
              goto LABEL_68;
            }
          }
          if (v20 == 10)
            goto LABEL_60;
          v27 = *(unsigned __int8 **)(a2 + 8);
          v21 = v27[1];
          if (v21 <= 0xF && (v23 == 1 || *(_BYTE *)(a1 + 3321) == 1))
          {
            *(_WORD *)(a1 + 6570) = 185;
            sub_219886108(*(_QWORD *)(a1 + 6480), *v27);
            v26 = (unsigned int *)(a1 + 6476);
            goto LABEL_59;
          }
          if (v22)
          {
            if (*(_BYTE *)(a1 + 6467))
            {
              sub_219850628(1, (unsigned int *)(a1 + 3356), 3u, 2u, (uint64_t)"Interface err received, retransmit not done as no API waiting");
            }
            else if (sub_2198B017C((unsigned int *)(a1 + 888), 0) == 13)
            {
LABEL_68:
              v16 = 1;
              goto LABEL_21;
            }
            *(_DWORD *)(a1 + 1800) = *(_DWORD *)(a1 + 1456);
            *(_BYTE *)(a1 + 1812) = *(_BYTE *)(a1 + 1468);
            *(_DWORD *)(a1 + 1432) = 0;
            *(_WORD *)(a1 + 3176) = 196;
            v16 = 1;
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Interface err limit reached, initiating RecvStateHandler with error status");
            sub_219851308(a1 + 888, 2u);
            goto LABEL_21;
          }
          v18 = (unsigned int *)(a1 + 6476);
          v15 = "phNciNfc_ProcessIntfErrNtf:Interface err received Not Handled";
          v16 = 1;
          v17 = 1;
          goto LABEL_19;
        }
        v13 = "PH_NCINFC_STATUS_HRM_TIMER_RUNNING status received by NFCC during Data Exchange ";
        v14 = 186;
      }
    }
    else
    {
      switch(**(_BYTE **)(a2 + 8))
      {
        case 0xB0:
          v13 = "PH_NCINFC_STATUS_RF_TRANSMISSION_ERROR Detected by NFCC during Data Exchange ";
          v14 = 182;
          break;
        case 0xB1:
          v13 = "PH_NCINFC_STATUS_RF_PROTOCOL_ERROR Detected by NFCC during Data Exchange ";
          v14 = 183;
          break;
        case 0xB2:
          v13 = "PH_NCINFC_STATUS_RF_TIMEOUT_ERROR Detected by NFCC during Data Exchange ";
          v14 = 178;
          break;
        case 0xB3:
          v13 = "PH_NCINFC_STATUS_RF_UNEXPECTED_DAT Detected by NFCC during Data Exchange ";
          v14 = 184;
          break;
        default:
          if (v12 != 2)
            goto LABEL_33;
          v13 = "PH_NCINFC_STATUS_RF_FRAME_CORRUPTED Detected by NFCC during Data Exchange ";
          v14 = 181;
          break;
      }
    }
    *(_WORD *)(a1 + 6570) = v14;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)v13);
    goto LABEL_33;
  }
  v15 = "IntfErrNtf: Can not process Intf Error Ntf - Invalid input parameters";
  v16 = 1;
  v17 = 2;
  v18 = (unsigned int *)a1;
LABEL_19:
  sub_219850628(v17, v18, 3u, 1u, (uint64_t)v15);
LABEL_21:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessIntfErrNtf");
  return v16;
}

uint64_t sub_21985B5BC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v8;
  int v9;

  v9 = 0;
  v8 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RssiStatsHandler");
  if (a2 && a1 && !(_DWORD)a3 && *(_QWORD *)(a2 + 8) && *(_DWORD *)(a2 + 16) == 10)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received RSSI Statistic NTF from NFCC");
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    v6 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 424);
    if (v6)
      v6(*(_QWORD *)(a1 + 416), 25, &v8, 0);
  }
  else
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciNfc_RssiStatsHandler: Can not process RSSI Stats NTF - Invalid input parameters");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RssiStatsHandler");
  return a3;
}

uint64_t sub_21985B708(uint64_t a1)
{
  const char *v2;
  uint64_t v3;
  uint64_t v5;
  uint64_t v6;
  char v7;

  v7 = 0;
  v5 = 0;
  v6 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DummyReadReq");
  if (a1)
  {
    if (sub_219878C88((unsigned int *)a1, *(_QWORD *)(a1 + 4512), &v7))
    {
      v2 = "Get Logical Conn ID failed!";
    }
    else
    {
      if (*(_QWORD *)(a1 + 3296))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 3296) = 0;
        *(_DWORD *)(a1 + 3304) = 0;
      }
      *(_BYTE *)(a1 + 3288) = 0;
      BYTE5(v6) = 1;
      BYTE4(v6) = v7;
      LODWORD(v5) = 0;
      if (!sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v5, (uint64_t)sub_21985B810, a1))
      {
        v3 = 0;
        goto LABEL_10;
      }
      v2 = "Dummy receive call back registration failed!";
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v2);
  }
  v3 = 255;
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DummyReadReq");
  return v3;
}

uint64_t sub_21985B810(uint64_t a1, uint64_t a2, int a3)
{
  __int16 v6;
  uint64_t Memory;
  unsigned int *v8;
  const char *v9;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReceiveDataBufferCb");
  if (a1 && a2)
  {
    *(_BYTE *)(a1 + 3288) = 1;
    *(_WORD *)(a1 + 3306) = a3;
    *(_QWORD *)(a1 + 3296) = 0;
    *(_WORD *)(a1 + 3304) = 0;
    if (!a3 && (v6 = *(_WORD *)(a2 + 16)) != 0 && *(_QWORD *)(a2 + 8))
    {
      Memory = phOsalNfc_GetMemory();
      if (Memory)
      {
        *(_QWORD *)(a1 + 3296) = Memory;
        *(_WORD *)(a1 + 3304) = v6;
        phOsalNfc_MemCopy();
        goto LABEL_10;
      }
      v8 = (unsigned int *)(a1 + 6476);
      v9 = "Failed to allocate temporary buffer for                     storing the received data message";
    }
    else
    {
      v8 = (unsigned int *)(a1 + 6476);
      v9 = "Data receive failed!";
    }
    sub_219850628(1, v8, 3u, 1u, (uint64_t)v9);
  }
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReceiveDataBufferCb");
  return 0;
}

uint64_t sub_21985B90C(unsigned int *a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_CheckFor14443_3BPICC");
  if (a2[3] != 1)
    goto LABEL_5;
  if (a2[7] - 11 > 1)
  {
LABEL_6:
    v4 = 255;
    goto LABEL_7;
  }
  if ((a2[17] & 1) != 0)
  {
LABEL_5:
    sub_219850628(2, a1, 3u, 1u, (uint64_t)"Frame-RF interface mapped to wrong protocol!");
    goto LABEL_6;
  }
  v4 = 0;
LABEL_7:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_CheckFor14443_3BPICC");
  return v4;
}

uint64_t sub_21985B9B4(uint64_t a1, uint64_t (**a2)())
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetNciSeqId");
  if (a2)
  {
    if (a2 == off_2550A2A40)
    {
      v4 = 1;
    }
    else
    {
      v4 = 2;
      if (a2 != off_2550A0C38 && a2 != off_2550A0C68)
      {
        if (a2 == off_2550A0C88)
        {
          v4 = 3;
        }
        else if (a2 == off_2550A0CA8)
        {
          v4 = 4;
        }
        else if (a2 == off_2550A0948)
        {
          v4 = 6;
        }
        else if (a2 == off_2550A2A60)
        {
          v4 = 7;
        }
        else if (a2 == off_2550A0CC8)
        {
          v4 = 9;
        }
        else if (a2 == off_2550A0CE8)
        {
          v4 = 10;
        }
        else if (a2 == off_2550A0D08)
        {
          v4 = 12;
        }
        else if (a2 == off_2550A0D28)
        {
          v4 = 11;
        }
        else if (a2 == off_2550A0968)
        {
          v4 = 13;
        }
        else if (a2 == off_2550A0988)
        {
          v4 = 14;
        }
        else if (a2 == off_2550A3FD8)
        {
          v4 = 15;
        }
        else if (a2 == off_2550A3FF8)
        {
          v4 = 16;
        }
        else if (a2 == off_2550A4018)
        {
          v4 = 17;
        }
        else if (a2 == off_2550A4038)
        {
          v4 = 18;
        }
        else if (a2 == off_2550A4058)
        {
          v4 = 19;
        }
        else if (a2 == off_2550A4078)
        {
          v4 = 21;
        }
        else if (*(uint64_t (***)())(a1 + 4760) == a2)
        {
          v4 = 22;
        }
        else if (a2 == off_2550A3F18)
        {
          v4 = 23;
        }
        else if (a2 == off_2550A3F38)
        {
          v4 = 50;
        }
        else if (a2 == off_2550A3F58)
        {
          v4 = 51;
        }
        else if (a2 == off_2550A3F98)
        {
          v4 = 24;
        }
        else if (a2 == off_2550A3FB8)
        {
          v4 = 25;
        }
        else if (a2 == off_2550A3F78)
        {
          v4 = 26;
        }
        else if (a2 == off_2550A0D48)
        {
          v4 = 27;
        }
        else if (a2 == off_2550A0D68)
        {
          v4 = 29;
        }
        else if (a2 == off_2550A2F78)
        {
          v4 = 30;
        }
        else if (a2 == off_2550A2F98)
        {
          v4 = 31;
        }
        else if (a2 == off_2550A2A80)
        {
          v4 = 32;
        }
        else if (a2 == off_2550A4098)
        {
          v4 = 33;
        }
        else if (a2 == off_2550A41B0)
        {
          v4 = 34;
        }
        else if (a2 == off_2550A07A8)
        {
          v4 = 35;
        }
        else if (a2 == off_2550A07C8)
        {
          v4 = 36;
        }
        else if (a2 == off_2550A07E8)
        {
          v4 = 37;
        }
        else if (a2 == off_2550A0768)
        {
          v4 = 38;
        }
        else if (a2 == off_2550A0788)
        {
          v4 = 39;
        }
        else if (a2 == off_2550A0808)
        {
          v4 = 40;
        }
        else if (a2 == off_2550A0828)
        {
          v4 = 41;
        }
        else if (a2 == off_2550A0848)
        {
          v4 = 42;
        }
        else if (a2 == off_2550A0868)
        {
          v4 = 43;
        }
        else if (a2 == off_2550A0888)
        {
          v4 = 44;
        }
        else if (a2 == off_2550A08C8)
        {
          v4 = 45;
        }
        else if (a2 == off_2550A0908)
        {
          v4 = 46;
        }
        else if (a2 == off_2550A08A8)
        {
          v4 = 48;
        }
        else if (a2 == off_2550A0928)
        {
          v4 = 47;
        }
        else if (a2 == off_2550A08E8)
        {
          v4 = 49;
        }
        else if (a2 == off_2550A40B8)
        {
          v4 = 52;
        }
        else if (a2 == off_2550A09A8)
        {
          v4 = 53;
        }
        else if (a2 == off_2550A09D8)
        {
          v4 = 54;
        }
        else if (a2 == off_2550A0A08)
        {
          v4 = 55;
        }
        else if (a2 == off_2550A0A28)
        {
          v4 = 56;
        }
        else
        {
          v4 = 0;
        }
      }
    }
  }
  else
  {
    v4 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetNciSeqId");
  return v4;
}

uint64_t sub_21985BF08(unsigned int *a1, unsigned __int8 *a2)
{
  unsigned int v4;
  uint64_t v5;
  int v6;
  uint64_t v7;
  unsigned int v9;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetNciCommandId");
  if (!a2)
    goto LABEL_8;
  v4 = *a2;
  if (v4 >> 5 != 1)
  {
    v5 = v4 >> 5 == 0;
    goto LABEL_9;
  }
  v5 = 0;
  v6 = v4 & 0xF;
  v7 = a2[1] & 0x3F;
  if (v6 > 1)
  {
    if (v6 == 2)
    {
      if ((_DWORD)v7 == 1)
        v9 = 17;
      else
        v9 = 0;
      if ((a2[1] & 0x3F) != 0)
        v5 = v9;
      else
        v5 = 16;
    }
    else if (v6 == 15)
    {
      v5 = 0;
      if ((a2[1] & 0x3Fu) > 0x20)
      {
        if ((a2[1] & 0x3Fu) <= 0x28)
        {
          if ((_DWORD)v7 == 33)
          {
            v5 = 26;
          }
          else if ((_DWORD)v7 == 40)
          {
            v5 = 23;
          }
        }
        else
        {
          switch((_DWORD)v7)
          {
            case ')':
              v5 = 24;
              break;
            case '3':
              v5 = 27;
              break;
            case ';':
              v5 = 25;
              break;
          }
        }
      }
      else if ((a2[1] & 0x3Fu) <= 2)
      {
        if ((a2[1] & 0x3F) != 0)
        {
          if ((_DWORD)v7 == 2)
            v5 = 19;
        }
        else
        {
          v5 = 18;
        }
      }
      else
      {
        switch((_DWORD)v7)
        {
          case 3:
            v5 = 20;
            break;
          case 0x10:
            v5 = 21;
            break;
          case 0x11:
            v5 = 22;
            break;
        }
      }
    }
  }
  else
  {
    if (v6)
    {
      if (v7 < 0xC)
      {
        v5 = byte_21990A2E4[v7];
        goto LABEL_9;
      }
LABEL_8:
      v5 = 0;
      goto LABEL_9;
    }
    if (v7 >= 6)
      v5 = 0;
    else
      v5 = (v7 + 2);
  }
LABEL_9:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetNciCommandId");
  return v5;
}

uint64_t sub_21985C0C4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  int v7;
  void (*v8)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;

  v10 = 0;
  v11 = 0;
  v12 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfPropReaderInfoNtfHandler");
  v6 = 1;
  if (a2 && a1 && *(_QWORD *)(a2 + 8))
  {
    v7 = *(_DWORD *)(a2 + 16);
    if (v7)
    {
      v10 = *(_QWORD *)(a2 + 8);
      LODWORD(v11) = v7;
      v8 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 312);
      if (v8)
        v8(*(_QWORD *)(a1 + 304), 10, &v10, 0);
      else
        sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)"phNciNfc_RfPropReaderInfoNtfHandler:Dropped at NCI");
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_RfPropReaderInfoNtfHandler:Invalid Lenght");
    }
    v6 = a3;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfPropReaderInfoNtfHandler");
  return v6;
}

uint64_t sub_21985C1C4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfVasLongCWDetectedNtfHandler");
  if (a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received VAS CW notification from NFCC");
    v5 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 376);
    if (v5)
      v5(*(_QWORD *)(a1 + 368), 41, 0, 0);
    else
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_RfVasLongCWDetectedNtfHandler:Dropped at NCI");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfVasLongCWDetectedNtfHandler");
  return a3;
}

uint64_t sub_21985C28C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;

  v8 = 0;
  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGpadcDebugNtf");
  if (a2 && a1 && *(_QWORD *)(a2 + 8))
  {
    v6 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 600);
    if (v6)
    {
      v8 = *(_QWORD *)(a2 + 8);
      LODWORD(v9) = *(_DWORD *)(a2 + 16);
      v6(*(_QWORD *)(a1 + 592), 39, &v8, 0);
    }
    else
    {
      sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)"phNciNfc_ProcessGpadcDebugNtf - Ntf dropped at NCI layer as there is no registration");
    }
  }
  else
  {
    a3 = 1;
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciNfc_ProcessGpadcDebugNtf - Can not process Gpadc Debug Ntf - Invalid input parameters");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGpadcDebugNtf");
  return a3;
}

uint64_t sub_21985C380(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;

  v7 = 0;
  v8 = 0;
  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessEraseCntExceedLimitNtf");
  if (a2 && a1 && *(_QWORD *)(a2 + 8))
  {
    if (*(_QWORD *)(a1 + 616))
    {
      phOsalNfc_SetMemory();
      v7 = *(_QWORD *)(a2 + 8);
      LODWORD(v8) = *(_DWORD *)(a2 + 16);
      (*(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 616))(*(_QWORD *)(a1 + 608), 40, &v7, 0);
    }
    else
    {
      sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)"phNciNfc_ProcessEraseCntExceedLimitNtf - Ntf dropped at NCI layer as there is no registration");
    }
  }
  else
  {
    a3 = 1;
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciNfc_ProcessEraseCntExceedLimitNtf - Can not process erase counter Ntf - Invalid input parameters");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessEraseCntExceedLimitNtf");
  return a3;
}

uint64_t sub_21985C490(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  void (*v7)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;

  v9 = 0;
  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_MuliTagStatusNtfHandler");
  v6 = 1;
  if (a2 && a1 && *(_QWORD *)(a2 + 8))
  {
    v9 = *(_QWORD *)(a2 + 8);
    LODWORD(v10) = *(_DWORD *)(a2 + 16);
    v7 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 552);
    if (v7)
      v7(*(_QWORD *)(a1 + 544), 33, &v9, 0);
    else
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_MuliTagStatusNtfHandler:Dropped at NCI");
    v6 = a3;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_MuliTagStatusNtfHandler");
  return v6;
}

uint64_t sub_21985C56C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfPllUnlockedNtfHandler");
  if (a1)
  {
    v5 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 328);
    if (v5)
      v5(*(_QWORD *)(a1 + 320), 11, 0, 0);
    else
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_RfPllUnlockedNtfHandler:Dropped at NCI");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfPllUnlockedNtfHandler");
  return a3;
}

uint64_t sub_21985C60C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfPlllostlockNtfHandler");
  if (a1)
  {
    v5 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 344);
    if (v5)
      v5(*(_QWORD *)(a1 + 336), 12, 0, 0);
    else
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_RfPlllostlockNtfHandler:Dropped at NCI");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfPlllostlockNtfHandler");
  return a3;
}

uint64_t sub_21985C6AC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(uint64_t, uint64_t, uint64_t *, _QWORD);
  int v7;
  uint64_t v8;
  uint64_t *v9;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;

  v11 = 0;
  v12 = 0;
  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfTxldoErrNtfHandler");
  if (a1 && !(_DWORD)a3)
  {
    v6 = *(void (**)(uint64_t, uint64_t, uint64_t *, _QWORD))(a1 + 360);
    if (v6)
    {
      if (a2 && *(_QWORD *)(a2 + 8) && (v7 = *(_DWORD *)(a2 + 16)) != 0)
      {
        v11 = *(_QWORD *)(a2 + 8);
        LODWORD(v12) = v7;
        v8 = *(_QWORD *)(a1 + 352);
        v9 = &v11;
      }
      else
      {
        v8 = *(_QWORD *)(a1 + 352);
        v9 = 0;
      }
      v6(v8, 13, v9, 0);
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_RfTxldoErrNtfHandler:Dropped at NCI");
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfTxldoErrNtfHandler");
  return a3;
}

uint64_t sub_21985C798(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfExtTempNormalNtfHandler");
  if (a1)
  {
    v5 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 648);
    if (v5)
      v5(*(_QWORD *)(a1 + 640), 14, 0, 0);
    else
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_RfExtTempNormalNtfHandler:Dropped at NCI");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfExtTempNormalNtfHandler");
  return a3;
}

uint64_t sub_21985C838(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfXtalErrNtfHandler");
  if (a1)
  {
    v5 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 664);
    if (v5)
      v5(*(_QWORD *)(a1 + 656), 16, 0, 0);
    else
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_RfXtalErrNtfHandler:Dropped at NCI");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfXtalErrNtfHandler");
  return a3;
}

uint64_t sub_21985C8D8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned __int8 *v6;
  __int16 v7;
  void (*v9)(_QWORD, uint64_t, _QWORD *, uint64_t);
  _QWORD v10[3];

  memset(v10, 0, sizeof(v10));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TotalPollDurationNtfHandler");
  if (a1)
  {
    if (a2 && *(_QWORD *)(a2 + 8) && *(_DWORD *)(a2 + 16) == 3)
    {
      phOsalNfc_SetMemory();
      v6 = *(unsigned __int8 **)(a2 + 8);
      LOBYTE(v10[0]) = *v6;
      if (*v6 > 1u)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_TotalPollDurationNtfHandler:Error in Compensation Status");
        a3 = 255;
      }
      else
      {
        v7 = v6[1];
        WORD1(v10[0]) = v7;
        WORD1(v10[0]) = v7 | (v6[2] << 8);
      }
      v9 = *(void (**)(_QWORD, uint64_t, _QWORD *, uint64_t))(a1 + 672);
      if (v9)
        v9(*(_QWORD *)(a1 + 680), 17, v10, a3);
      else
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_TotalPollDurationNtfHandler:Dropped at NCI");
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_TotalPollDurationNtfHandler: Invalid Payload");
      a3 = 255;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TotalPollDurationNtfHandler");
  return a3;
}

uint64_t sub_21985CA3C(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  _BYTE *v8;
  uint64_t v9;
  void (*v10)(uint64_t, uint64_t, uint64_t);
  uint64_t v11;

  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsTimeOutHandler");
  if (!a2)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 4);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a2);
  if (v6 == a2)
  {
    v8 = (_BYTE *)(a2 + 6464);
    if (!*(_BYTE *)(a2 + 6464))
    {
      phOsalNfc_Timer_Stop();
      if (!phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"Get Prohibit timer status info Notification timer restarted for extended time\n");
        *v8 = 1;
        return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsTimeOutHandler");
      }
      sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 1u, (uint64_t)"Get Prohibit Timer status Notification timer failed to restart for extended time\n\n");
    }
    sub_21988629C(2, (unsigned int *)a2, a1, 3u, 4u, (uint64_t)"phNciNfc_GetProhibitTimerStsTimeOutHandler");
    *v8 = 0;
    sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 2u, (uint64_t)"#######Get Prohibit timer status notification TIMEOUT########\n");
    v9 = *(_QWORD *)(a2 + 4832);
    if (v9 && v9 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 4832) = 0xFFFFFFFFFFFFLL;
    }
    phOsalNfc_SetMemory();
    v10 = *(void (**)(uint64_t, uint64_t, uint64_t))(a2 + 800);
    if (v10)
    {
      v11 = *(_QWORD *)(a2 + 808);
      *(_QWORD *)(a2 + 800) = 0;
      *(_QWORD *)(a2 + 808) = 0;
      v10(v11, 47, a2 + 4824);
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 3u, 1u, (uint64_t)"Nci context null (phNciNfc_GetProhibitTimerStsTimeOutHandler)\n");
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GetProhibitTimerStsTimeOutHandler");
}

uint64_t sub_21985CC38(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  _BYTE *v8;
  uint64_t v9;
  void (*v10)(uint64_t, uint64_t, uint64_t);
  uint64_t v11;

  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataTimeOutHandler");
  if (!a2)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 4);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a2);
  if (v6 == a2)
  {
    v8 = (_BYTE *)(a2 + 6464);
    if (!*(_BYTE *)(a2 + 6464))
    {
      phOsalNfc_Timer_Stop();
      if (!phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"Get Power Track data Notification timer restarted for extended time\n");
        *v8 = 1;
        return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataTimeOutHandler");
      }
      sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 1u, (uint64_t)"Get Power Track data Notification timer failed to restart for extended time\n\n");
    }
    sub_21988629C(2, (unsigned int *)a2, a1, 3u, 4u, (uint64_t)"phNciNfc_GetPwrTrackDataTimeOutHandler");
    *v8 = 0;
    sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 2u, (uint64_t)"#######Get Power Track data notification TIMEOUT########\n");
    v9 = *(_QWORD *)(a2 + 6456);
    if (v9 && v9 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 6456) = 0xFFFFFFFFFFFFLL;
    }
    phOsalNfc_SetMemory();
    v10 = *(void (**)(uint64_t, uint64_t, uint64_t))(a2 + 784);
    if (v10)
    {
      v11 = *(_QWORD *)(a2 + 792);
      *(_QWORD *)(a2 + 784) = 0;
      *(_QWORD *)(a2 + 792) = 0;
      v10(v11, 47, a2 + 4796);
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 3u, 1u, (uint64_t)"Nci context null (phNciNfc_GetPwrTrackDataTimeOutHandler)\n");
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GetPwrTrackDataTimeOutHandler");
}

uint64_t sub_21985CE34(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  _BYTE *v8;
  unsigned int *v9;
  __int16 v10;
  __int16 v11;
  void (*v12)(uint64_t, uint64_t, uint64_t);
  uint64_t v13;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGetProhibitTimerStsNtf");
  if (a1)
  {
    v6 = *(_QWORD *)(a1 + 4832);
    if (v6 && v6 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      *(_BYTE *)(a1 + 6464) = 0;
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 4832) = 0xFFFFFFFFFFFFLL;
      v7 = 255;
      if (a2)
      {
        if (!(_DWORD)a3)
        {
          v8 = *(_BYTE **)(a2 + 8);
          if (v8)
          {
            if (*(_DWORD *)(a2 + 16) == 6)
            {
              v9 = (unsigned int *)(a1 + 6476);
              if (**(_BYTE **)(a1 + 3760) == 1)
              {
                sub_219850628(1, v9, 3u, 1u, (uint64_t)"Get Prohibit Timer Status Ntf received with rejected from NFCC");
                v7 = 147;
              }
              else if (**(_BYTE **)(a1 + 3760))
              {
                sub_219851888(1, v9, 3u, 2u, (uint64_t)"Get Prohibit - Status failed!, status byte:");
              }
              else
              {
                v7 = 0;
                *(_BYTE *)(a1 + 4824) = v8[1];
                v10 = v8[2];
                *(_WORD *)(a1 + 4826) = v10 << 8;
                *(_WORD *)(a1 + 4826) = v8[3] | (unsigned __int16)(v10 << 8);
                v11 = v8[4];
                *(_WORD *)(a1 + 4828) = v11 << 8;
                *(_WORD *)(a1 + 4828) = v8[5] | (unsigned __int16)(v11 << 8);
              }
            }
          }
        }
      }
      v12 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 800);
      if (v12)
      {
        v13 = *(_QWORD *)(a1 + 808);
        *(_QWORD *)(a1 + 800) = 0;
        *(_QWORD *)(a1 + 808) = 0;
        v12(v13, v7, a1 + 4824);
      }
      a3 = v7;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"phNciNfc_ProcessGetProhibitTimerStsNtf: dropping ...");
    }
  }
  else
  {
    a3 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGetProhibitTimerStsNtf");
  return a3;
}

uint64_t sub_21985CFE8(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v6;
  uint64_t v7;
  _BYTE *v8;
  int v9;
  char v10;
  void (*v11)(uint64_t, uint64_t, uint64_t);
  uint64_t v12;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGetPwrTrackDataNtf");
  if (!a1)
  {
    v7 = 49;
    goto LABEL_19;
  }
  v6 = *(_QWORD *)(a1 + 6456);
  if (v6 && v6 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    *(_BYTE *)(a1 + 6464) = 0;
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(a1 + 6456) = 0xFFFFFFFFFFFFLL;
  }
  v7 = 255;
  if (a2)
  {
    if (!a3)
    {
      v8 = *(_BYTE **)(a2 + 8);
      if (v8)
      {
        v9 = *(_DWORD *)(a2 + 16);
        if (v9 == 22 || v9 == 5)
        {
          *(_BYTE *)(a1 + 4808) = *v8 & 1;
          *(_BYTE *)(a1 + 4809) = (*v8 & 2) != 0;
          *(_BYTE *)(a1 + 4810) = *v8 >> 7;
          phOsalNfc_MemCopy();
          if (*(_DWORD *)(a2 + 16) != 22)
            goto LABEL_15;
          v10 = v8[21];
          if ((v10 & 1) != 0)
          {
            if ((v8[21] & 2) == 0)
              goto LABEL_13;
          }
          else
          {
            *(_DWORD *)(a1 + 4812) = 0;
            v10 = v8[21];
            if ((v10 & 2) == 0)
            {
LABEL_13:
              if ((v10 & 4) != 0)
LABEL_14:
                phOsalNfc_MemCopy();
LABEL_15:
              v7 = 0;
              goto LABEL_16;
            }
          }
          phOsalNfc_MemCopy();
          if ((v8[21] & 4) == 0)
            goto LABEL_15;
          goto LABEL_14;
        }
      }
    }
  }
LABEL_16:
  v11 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 784);
  if (v11)
  {
    v12 = *(_QWORD *)(a1 + 792);
    *(_QWORD *)(a1 + 784) = 0;
    *(_QWORD *)(a1 + 792) = 0;
    v11(v12, v7, a1 + 4796);
  }
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessGetPwrTrackDataNtf");
  return v7;
}

uint64_t sub_21985D190(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  _BYTE *v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  int v12;
  uint64_t v13;
  uint64_t *v14;
  uint64_t Memory;
  unint64_t v16;
  int v17;
  uint64_t v18;
  int v19;
  unsigned int v20;
  uint64_t v21;
  unsigned int v22;
  uint64_t v23;

  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SmbNtfTimeOutHandler");
  if (!a2)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 4);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a2);
  if (v6 == a2)
  {
    v8 = (_BYTE *)(a2 + 6464);
    if (!*(_BYTE *)(a2 + 6464))
    {
      phOsalNfc_Timer_Stop();
      if (!phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"SMB ntf timer restarted for extended time");
        *v8 = 1;
        return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SmbNtfTimeOutHandler");
      }
      sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 1u, (uint64_t)"SMB Notification timer failred to restart for extended time");
    }
    sub_21988629C(2, (unsigned int *)a2, a1, 3u, 4u, (uint64_t)"phNciNfc_SmbNtfTimeOutHandler");
    *v8 = 0;
    sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"####### SMB notification TIMEOUT ########");
    v9 = *(_QWORD *)(a2 + 6424);
    if (v9 && v9 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 6424) = 0xFFFFFFFFFFFFLL;
    }
    v10 = *(unsigned int *)(a2 + 6252);
    if ((_DWORD)v10)
    {
      v11 = 0;
      v12 = 0;
      *(_DWORD *)(a2 + 6392) = 0;
      v13 = 16 * v10;
      do
      {
        v12 += *(_DWORD *)(a2 + v11 + 6264);
        *(_DWORD *)(a2 + 6392) = v12;
        v11 += 16;
      }
      while (v13 != v11);
      v14 = (uint64_t *)(a2 + 6384);
      if (*(_QWORD *)(a2 + 6384))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a2 + 6384) = 0;
      }
      Memory = phOsalNfc_GetMemory();
      *v14 = Memory;
      if (Memory && *(_DWORD *)(a2 + 6252))
      {
        v16 = 0;
        v17 = 0;
        v18 = a2 + 6256;
        do
        {
          phOsalNfc_MemCopy();
          v19 = *(_DWORD *)(v18 + 8);
          if (*(_QWORD *)v18)
          {
            phOsalNfc_FreeMemory();
            *(_QWORD *)v18 = 0;
          }
          v17 += v19;
          v18 += 16;
          ++v16;
        }
        while (v16 < *(unsigned int *)(a2 + 6252));
      }
      sub_2198E23C4(a2, 0, a2 + 6384);
      if (*(_QWORD *)(a2 + 6384))
      {
        phOsalNfc_FreeMemory();
        *v14 = 0;
      }
      *(_QWORD *)(a2 + 6248) = 0;
      sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"phNciNfc_SmbLogNtf: Received SMB Logging notification from NFCC");
    }
    else
    {
      v20 = *(_DWORD *)(a2 + 6248);
      v21 = *(_QWORD *)(a2 + 6384);
      if (v20)
      {
        v22 = 0;
        v23 = *(_QWORD *)(a2 + 6384);
        do
        {
          if (v23)
          {
            phOsalNfc_FreeMemory();
            v21 = 0;
            *(_QWORD *)(a2 + 6384) = 0;
            v20 = *(_DWORD *)(a2 + 6248);
          }
          v23 = 0;
          ++v22;
        }
        while (v22 < v20);
      }
      if (v21)
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a2 + 6384) = 0;
      }
      sub_2198E23C4(a2, 47, 0);
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 3u, 1u, (uint64_t)"Nci context null (phNciNfc_NfceeMgmtSetModeTimeOutHandler)\n");
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SmbNtfTimeOutHandler");
}

uint64_t sub_21985D4D0(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  int v7;
  void (*v8)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t Memory;
  uint64_t *v13;
  uint64_t v14;
  int v15;
  int *v16;
  int v17;
  uint64_t v18;
  unint64_t v19;
  int v20;
  uint64_t v21;
  int v22;
  uint64_t v24;
  uint64_t v25;
  uint64_t v26;

  v24 = 0;
  v25 = 0;
  v26 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SmbLogNtf");
  if (a1 && a2)
  {
    v6 = *(_QWORD *)(a1 + 6424);
    if (v6 && v6 != 0xFFFFFFFFFFFFLL)
    {
      v9 = *(unsigned int *)(a1 + 6252);
      v10 = a1 + 16 * v9;
      *(_DWORD *)(a1 + 6252) = v9 + 1;
      *(_DWORD *)(v10 + 6264) = *(_DWORD *)(a2 + 16);
      v11 = v10 + 6264;
      Memory = phOsalNfc_GetMemory();
      *(_QWORD *)(v11 - 8) = Memory;
      if (Memory)
      {
        phOsalNfc_MemCopy();
        if (!(_DWORD)a3)
        {
          if (*(_DWORD *)(a1 + 6248) == *(_DWORD *)(a1 + 6252))
          {
            phOsalNfc_Timer_Stop();
            *(_BYTE *)(a1 + 6464) = 0;
            sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 6424), 3u, 4u, (uint64_t)"phNciNfc_SmbLogNtf");
            phOsalNfc_Timer_Delete();
            *(_QWORD *)(a1 + 6424) = 0xFFFFFFFFFFFFLL;
            v13 = (uint64_t *)(a1 + 6384);
            *(_DWORD *)(a1 + 6392) = 0;
            v14 = *(unsigned int *)(a1 + 6248);
            if ((_DWORD)v14)
            {
              v15 = 0;
              v16 = (int *)(a1 + 6264);
              do
              {
                v17 = *v16;
                v16 += 4;
                v15 += v17;
                *(_DWORD *)(a1 + 6392) = v15;
                --v14;
              }
              while (v14);
            }
            if (*v13)
            {
              phOsalNfc_FreeMemory();
              *(_QWORD *)(a1 + 6384) = 0;
            }
            v18 = phOsalNfc_GetMemory();
            *v13 = v18;
            if (v18 && *(_DWORD *)(a1 + 6248))
            {
              v19 = 0;
              v20 = 0;
              v21 = a1 + 6256;
              do
              {
                phOsalNfc_MemCopy();
                v22 = *(_DWORD *)(v21 + 8);
                if (*(_QWORD *)v21)
                {
                  phOsalNfc_FreeMemory();
                  *(_QWORD *)v21 = 0;
                }
                v20 += v22;
                v21 += 16;
                ++v19;
              }
              while (v19 < *(unsigned int *)(a1 + 6248));
            }
            sub_2198E23C4(a1, 0, a1 + 6384);
            if (*(_QWORD *)(a1 + 6384))
            {
              phOsalNfc_FreeMemory();
              *v13 = 0;
            }
            *(_QWORD *)(a1 + 6248) = 0;
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_SmbLogNtf: Received SMB Logging notification from NFCC");
          }
          goto LABEL_29;
        }
      }
      else
      {
        a3 = 12;
      }
    }
    else if (!(_DWORD)a3)
    {
      if (*(_QWORD *)(a2 + 8))
      {
        v7 = *(_DWORD *)(a2 + 16);
        if (v7)
        {
          v8 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 536);
          if (v8)
          {
            v24 = *(_QWORD *)(a2 + 8);
            LODWORD(v25) = v7;
            v8(*(_QWORD *)(a1 + 528), 42, &v24, 0);
          }
        }
      }
LABEL_29:
      a3 = 0;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SmbLogNtf");
  return a3;
}

uint64_t sub_21985D780(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t *, _QWORD);
  int v7;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;

  v9 = 0;
  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TrimmingFailureNtf");
  if (!a1 || (_DWORD)a3)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciNfc_TrimmingFailureNtf: Dropped at NCI");
  }
  else if (a2)
  {
    v6 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 696);
    if (v6)
    {
      if (*(_QWORD *)(a2 + 8))
      {
        v7 = *(_DWORD *)(a2 + 16);
        if (v7)
        {
          v9 = *(_QWORD *)(a2 + 8);
          LODWORD(v10) = v7;
          v6(*(_QWORD *)(a1 + 688), 44, &v9, 0);
        }
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TrimmingFailureNtf");
  return a3;
}

uint64_t sub_21985D858(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, _QWORD, _QWORD);
  _QWORD v8[3];

  memset(v8, 0, sizeof(v8));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NotifySpmiRegInfo");
  if (!a1 || (_DWORD)a3)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciNfc_NotifySpmiRegInfo: Dropped at NCI");
  }
  else
  {
    v6 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 712);
    if (v6)
    {
      if (a2)
      {
        phOsalNfc_MemCopy();
        (*(void (**)(_QWORD, uint64_t, _QWORD *, _QWORD))(a1 + 712))(*(_QWORD *)(a1 + 688), 45, v8, 0);
      }
      else
      {
        v6(*(_QWORD *)(a1 + 688), 45, 0, 0);
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NotifySpmiRegInfo");
  return a3;
}

uint64_t sub_21985D940(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  _BYTE *v6;

  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GenDbgLogNtfTimeOutHandler");
  if (!a2)
    goto LABEL_6;
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 4);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != a2);
  if (v5 == a2)
  {
    v6 = (_BYTE *)(a2 + 6464);
    if (!*(_BYTE *)(a2 + 6464))
    {
      phOsalNfc_Timer_Stop();
      if (!phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"Generic Debug Log ntf timer started for extended time ");
        *v6 = 1;
        return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GenDbgLogNtfTimeOutHandler");
      }
      sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 1u, (uint64_t)"Generic Debug Log Notification timer FAILED to start for extended time");
    }
    *v6 = 0;
    sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"####### Generic Debug Log notification TIMEOUT ########");
    sub_2198E23C4(a2, 47, 0);
    sub_21985DC44(a2);
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 3u, 1u, (uint64_t)"Nci context null (phNciNfc_GenDbgLogNtfTimeOutHandler)\n");
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_GenDbgLogNtfTimeOutHandler");
}

uint64_t sub_21985DAB4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  unsigned __int16 v8;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GenDbgLogNtf");
  if (a1 && a2 && (v6 = *(_QWORD *)(a1 + 6424)) != 0 && v6 != 0xFFFFFFFFFFFFLL)
  {
    if (*(unsigned __int16 *)(a1 + 6402) < *(unsigned __int16 *)(a1 + 6416))
    {
      a3 = 255;
      goto LABEL_6;
    }
    phOsalNfc_MemCopy();
    v8 = *(_WORD *)(a1 + 6416) + *(_WORD *)(a2 + 16);
    *(_WORD *)(a1 + 6416) = v8;
    if ((_DWORD)a3)
      goto LABEL_6;
    if (*(unsigned __int16 *)(a1 + 6402) == v8)
    {
      phOsalNfc_Timer_Stop();
      *(_BYTE *)(a1 + 6464) = 0;
      sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 6424), 3u, 4u, (uint64_t)"phNciNfc_GenDbgLogNtf");
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 6424) = 0xFFFFFFFFFFFFLL;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_GenDbgLogNtf: Received HLM debug Logs notification from NFCC");
      sub_2198E23C4(a1, 0, a1 + 6400);
      sub_21985DC44(a1);
    }
    a3 = 0;
  }
  else if ((_DWORD)a3)
  {
LABEL_6:
    sub_2198E23C4(a1, a3, 0);
    sub_21985DC44(a1);
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GenDbgLogNtf");
  return a3;
}

uint64_t sub_21985DC44(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ClearHlmDbgInfoData");
  if (a1)
  {
    v2 = 0;
    v3 = 0;
    do
    {
      v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
      if ((v2 & 1) != 0)
        break;
      v2 = 1;
      v3 = 1;
    }
    while (v4 != a1);
    if (v4 == a1)
    {
      v5 = *(_QWORD *)(a1 + 6424);
      if (v5 && v5 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Stop();
        *(_BYTE *)(a1 + 6464) = 0;
        sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 6424), 3u, 4u, (uint64_t)"phNciNfc_ClearHlmDbgInfoData");
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 6424) = 0xFFFFFFFFFFFFLL;
      }
      if (*(_QWORD *)(a1 + 6384))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 6384) = 0;
      }
      phOsalNfc_SetMemory();
      if (*(_QWORD *)(a1 + 6408))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 6408) = 0;
      }
      *(_WORD *)(a1 + 6402) = 0;
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ClearHlmDbgInfoData");
}

uint64_t sub_21985DD88(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  int v6;
  unsigned int v7;
  unsigned __int16 v8;
  double v9;
  int v10;
  int v11;
  int *v12;
  int *v13;
  uint64_t v14;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_WtxNtfHandler");
  if (!a1)
    goto LABEL_31;
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_WtxNtfHandler: Received WTX_NTF");
  v5 = *(_QWORD *)(a1 + 4512);
  if (v5)
  {
    v6 = *(_DWORD *)(v5 + 4);
    if ((v6 - 5) < 3)
      goto LABEL_6;
    if (v6 == 16)
    {
      v7 = *(unsigned __int8 *)(v5 + 109);
      goto LABEL_9;
    }
    if (v6 == 3)
    {
LABEL_6:
      v7 = *(unsigned __int8 *)(v5 + 108);
LABEL_9:
      v9 = (double)(1 << (v7 >> 4)) * 302.064897 / 1000.0;
      if ((int)v9 >= 0x54)
        v10 = 19796;
      else
        v10 = 4 * (unsigned __int16)(59 * (int)v9);
      if (((v10 + 100) & 0xFFF0u) >= 0x7D0)
        v8 = v10 + 100;
      else
        v8 = 2000;
      goto LABEL_15;
    }
  }
  v8 = 0;
LABEL_15:
  if (*(_BYTE *)(a1 + 6435) == 1 && *(_BYTE *)(a1 + 1880) == 1)
  {
    phOsalNfc_Timer_Stop();
    *(_BYTE *)(a1 + 6464) = 0;
    if (v8 <= 0x1388u)
      v11 = 5000;
    else
      v11 = v8;
    *(_DWORD *)(a1 + 1508) = v11;
    sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_WtxNtfHandler: Timer started for Transceive timeout value  ");
    v12 = &dword_253E47158;
    if (!*(_DWORD *)(a1 + 3356))
      v12 = &dword_253E47070;
    v12[1] &= ~0x10u;
    a3 = phOsalNfc_Timer_Start();
  }
  if (*(_BYTE *)(a1 + 6552) == 1)
  {
    sub_21988C4AC(*(_DWORD *)(a1 + 3356), *(_QWORD *)(a1 + 6544));
    *(_BYTE *)(a1 + 6465) = 0;
    sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_WtxNtfHandler : Timer started for Credit timeout value  ");
    v13 = &dword_253E47158;
    if (!*(_DWORD *)(a1 + 3356))
      v13 = &dword_253E47070;
    v13[1] &= ~8u;
    if (phOsalNfc_Timer_Start())
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed to start credit ntf wait timer!");
      v14 = *(_QWORD *)(a1 + 6544);
      a3 = 255;
      if (v14 && v14 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 6544) = 0;
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Credit wait timer started..");
      a3 = 0;
      *(_BYTE *)(a1 + 6552) = 1;
      *(_BYTE *)(a1 + 6537) = 1;
    }
  }
LABEL_31:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_WtxNtfHandler");
  return a3;
}

uint64_t sub_21985E078(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD, uint64_t);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DetTagRemNtfHandler");
  if (a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_DetTagRemNtfHandler: Received Tag Removal Detect Notification");
    if (!(_DWORD)a3)
    {
      *(_DWORD *)(a1 + 172) = 3;
      sub_2198636E8(a1);
      sub_2198F32D8(a1 + 888);
      a3 = 120;
    }
    v5 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(a1 + 472);
    if (v5)
      v5(*(_QWORD *)(a1 + 464), 30, 0, a3);
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DetTagRemNtfHandler");
  return a3;
}

uint64_t sub_21985E13C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v7)(_QWORD, uint64_t, uint64_t *, _QWORD);
  int v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;

  v9 = 0;
  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSysLpcdDbgMsgNtf");
  if (a1)
  {
    if (a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received System LPCD logging notification from NFCC");
      if (!(_DWORD)a3)
      {
        v7 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 488);
        if (v7)
        {
          if (*(_QWORD *)(a2 + 8))
          {
            v8 = *(_DWORD *)(a2 + 16);
            if (v8)
            {
              v9 = *(_QWORD *)(a2 + 8);
              LODWORD(v10) = v8;
              v7(*(_QWORD *)(a1 + 480), 31, &v9, 0);
            }
          }
        }
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSysLpcdDbgMsgNtf");
  return a3;
}

uint64_t sub_21985E218(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v7)(_QWORD, uint64_t, _QWORD, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessLpcdAssistExitNtf");
  if (a1 && a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received Successful LPCD Assistance Exit from NFCC");
    if ((_DWORD)a3
      || (v7 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD))(a1 + 504)) == 0
      || *(_DWORD *)(a2 + 16))
    {
      sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Droping LPCD Assistance Exit Ntf, pTransInfo->wLength");
    }
    else
    {
      v7(*(_QWORD *)(a1 + 496), 43, 0, 0);
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessLpcdAssistExitNtf");
  return a3;
}

uint64_t sub_21985E2F8(unsigned int *a1, unsigned int a2, _BYTE *a3)
{
  uint64_t v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_MapBitRate");
  if (a3)
  {
    if (a2 > 3)
    {
      v6 = 255;
    }
    else
    {
      v6 = 0;
      *a3 = 0x1000605u >> (8 * a2);
    }
  }
  else
  {
    v6 = 0;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_MapBitRate");
  return v6;
}

uint64_t sub_21985E394(uint64_t a1, uint64_t a2, uint64_t a3)
{
  char v6;
  uint64_t v7;
  uint64_t v8;
  int v10;
  void (*v11)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;

  v12 = 0;
  v13 = 0;
  v14 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessRfMgtRelaydetectionNtf");
  if (!a1)
    goto LABEL_6;
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = *((_QWORD *)&unk_253E46700 + 14 * v7 + 4);
    if ((v6 & 1) != 0)
      break;
    v6 = 1;
    v7 = 1;
  }
  while (v8 != a1);
  if (v8 == a1)
  {
    if (a2 && !(_DWORD)a3 && *(_QWORD *)(a2 + 8) && (v10 = *(_DWORD *)(a2 + 16)) != 0)
    {
      v11 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 632);
      if (v11)
      {
        v12 = *(_QWORD *)(a2 + 8);
        LODWORD(v13) = v10;
        v11(*(_QWORD *)(a1 + 512), 34, &v12, 0);
      }
      a3 = 0;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_ProcessRfMgtRelaydetectionNtf:Dropped at NCI");
    }
  }
  else
  {
LABEL_6:
    a3 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessRfMgtRelaydetectionNtf");
  return a3;
}

uint64_t sub_21985E4B4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v6;
  void (*v7)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessChipScopeLoggingNtf");
  if (a1)
  {
    if (*(_BYTE *)(a1 + 4794) == 1 || *(_BYTE *)(a1 + 4788) == 1 || *(_BYTE *)(a1 + 4793) == 1)
    {
      if (a2 && !(_DWORD)a3)
      {
        if (*(_QWORD *)(a2 + 8))
        {
          v6 = *(_DWORD *)(a2 + 16);
          if (v6)
          {
            v7 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 520);
            if (v7)
            {
              v9 = *(_QWORD *)(a2 + 8);
              LODWORD(v10) = v6;
              v7(*(_QWORD *)(a1 + 512), 32, &v9, 0);
            }
          }
        }
        a3 = 0;
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"ProcessChipScopeLoggingNtf : Chip scope Ntf received on non supported platform");
    }
  }
  else
  {
    a3 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessChipScopeLoggingNtf");
  return a3;
}

uint64_t sub_21985E5C4(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  const char *v5;
  unsigned __int8 *v7;
  int v8;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessCommonNciRsp2");
  if (a1)
  {
    if (!(_DWORD)a2 && (v7 = *(unsigned __int8 **)(a1 + 3760)) != 0 && *(_DWORD *)(a1 + 3768) == 1)
    {
      v8 = *v7;
      if (v8 == 241)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_ProcessCommonNciRsp2 - suica/VAS express enabled/transaction ongoing");
        a2 = 81;
        goto LABEL_5;
      }
      if (!v8)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_ProcessCommonNciRsp2 - Response Successful");
        a2 = 0;
        goto LABEL_5;
      }
      v4 = (unsigned int *)(a1 + 6476);
      v5 = "phNciNfc_ProcessCommonNciRsp2  - failed status received in response!";
    }
    else
    {
      v4 = (unsigned int *)(a1 + 6476);
      v5 = "Response received with failure status";
    }
    sub_219850628(1, v4, 3u, 2u, (uint64_t)v5);
    *(_DWORD *)(a1 + 3768) = 0;
    a2 = 255;
  }
LABEL_5:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessCommonNciRsp2");
  return a2;
}

uint64_t sub_21985E6D8(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessCommonNciCompleteSeq");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
      *(_DWORD *)(a1 + 856) = 0;
    }
    sub_2198E23C4(a1, a2, 0);
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessCommonNciCompleteSeq");
  return a2;
}

uint64_t sub_21985E760(unsigned int *a1, int a2, int a3)
{
  char v6;
  uint64_t v7;
  unsigned int *v8;
  const char *v9;
  uint64_t v10;
  int v11;
  unsigned int *v12;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_CreditsUpdateCB");
  if (!a1)
    goto LABEL_6;
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v7 + 4);
    if ((v6 & 1) != 0)
      break;
    v6 = 1;
    v7 = 1;
  }
  while (v8 != a1);
  if (v8 == a1)
  {
    if (a2 && !a3)
    {
      v10 = 2;
      goto LABEL_8;
    }
    v12 = a1 + 1619;
    v9 = "Credits Update from LogConn Module Failed";
    v10 = 3;
    v11 = 1;
  }
  else
  {
LABEL_6:
    v9 = "Invalid Core context passed from LogConn Module!";
    v10 = 3;
    v11 = 2;
    v12 = a1;
  }
  sub_219850628(v11, v12, 3u, 1u, (uint64_t)v9);
LABEL_8:
  sub_21987D1CC(a1, v10, 0);
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_CreditsUpdateCB");
}

uint64_t sub_21985E858(uint64_t a1, uint64_t a2, _DWORD *a3, unsigned int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  unsigned int v13;
  BOOL v14;
  int v15;
  uint64_t v17;
  uint64_t v19;
  uint64_t v20;

  v19 = 0;
  v20 = a1;
  sub_219850718(0, (unsigned int *)&v20, 8u, 5u, (uint64_t)"phFriNfc_Desfire_RdNdef");
  sub_21988EF68(v20, &v19);
  v11 = 1;
  if (a4 <= 1)
  {
    if (a3)
    {
      if (a2)
      {
        if (a5)
        {
          v12 = v19;
          if (v19)
          {
            if (a4 == 1 || *(_BYTE *)(v19 + 540) != 3)
            {
              *(_QWORD *)(v19 + 16) = a5;
              *(_QWORD *)(v12 + 40) = a6;
              if (a4 == 1)
              {
                *(_WORD *)(v12 + 252) = 0;
                v13 = *(_DWORD *)(*(_QWORD *)(v12 + 224) + 4);
                v14 = v13 > 0x13;
                v15 = (1 << v13) & 0x8E800;
                if (!v14 && v15 != 0)
                {
                  *(_DWORD *)(v12 + 664) = 0;
                  **(_DWORD **)(v12 + 672) = 0;
                }
              }
              *(_BYTE *)(v12 + 547) = 2;
              *(_DWORD *)(v12 + 248) = *a3;
              *(_QWORD *)(v12 + 552) = a3;
              *a3 = 0;
              *(_BYTE *)(v12 + 560) = a4;
              if (a4 || **(_DWORD **)(v12 + 672) != *(_DWORD *)(v12 + 660))
              {
                *(_WORD *)(v12 + 668) = 0;
                *(_BYTE *)(v12 + 642) = 2;
                *(_QWORD *)(v12 + 240) = a2;
                *(_BYTE *)(v12 + 540) = 2;
                if (*(_BYTE *)(v12 + 65))
                {
                  if (*(_BYTE *)(v12 + 544) == 6)
                    v17 = sub_21985ECD4(v12);
                  else
                    v17 = sub_21985EE50(v12);
                }
                else if (a4 != 1 || *(_DWORD *)(v12 + 664) || **(_DWORD **)(v12 + 672))
                {
                  v17 = sub_21985EABC(v12);
                }
                else
                {
                  v17 = sub_21985EA08(v12);
                }
                v11 = v17;
              }
              else
              {
                v11 = 26;
              }
            }
            else
            {
              v11 = 245;
            }
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v20, 8u, 5u, (uint64_t)"phFriNfc_Desfire_RdNdef");
  return v11;
}

uint64_t sub_21985EA08(uint64_t a1)
{
  int v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ReadBinary_NdefLen");
  if (a1)
  {
    *(_DWORD *)(a1 + 266) = 45056;
    if (*(_BYTE *)(a1 + 64) == 6)
      v2 = 4;
    else
      v2 = 2;
    *(_BYTE *)(a1 + 669) = 0;
    *(_BYTE *)(a1 + 270) = v2;
    *(_WORD *)(a1 + 526) = 5;
    *(_BYTE *)a1 = 9;
    v3 = sub_21985F814(a1, (v2 + 2));
  }
  else
  {
    v3 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ReadBinary_NdefLen");
  return v3;
}

uint64_t sub_21985EABC(uint64_t a1)
{
  _DWORD *v2;
  int v3;
  unsigned __int16 v5;
  unsigned int v6;
  int v7;
  unsigned int v8;
  unsigned int v9;
  unsigned int v10;
  int v11;
  __int16 v12;
  char v13;
  unsigned int v14;
  __int16 v15;
  uint64_t v16;

  v2 = (_DWORD *)(a1 + 266);
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ReadBinary");
  v3 = *(unsigned __int8 *)(a1 + 642);
  if (v3 != 4 && v3 != 7)
  {
    *(_WORD *)(a1 + 266) = -20480;
    v6 = **(_DWORD **)(a1 + 672);
    if (v6)
    {
      v7 = *(unsigned __int8 *)(a1 + 64);
      v8 = v6 + 4;
      if (v7 == 4)
        v6 += 2;
      if (v7 == 6)
        v6 = v8;
      if (v6 >= 0x7FFF)
      {
        *(_DWORD *)((char *)v2 + 1) = 83886257;
        *(_WORD *)(a1 + 271) = 852;
        *(_BYTE *)(a1 + 273) = BYTE2(v6);
        *(_BYTE *)(a1 + 274) = BYTE1(v6);
        *(_BYTE *)(a1 + 275) = v6;
        v9 = 10;
        goto LABEL_19;
      }
      *(_WORD *)(a1 + 268) = bswap32(v6) >> 16;
    }
    else
    {
      *(_BYTE *)(a1 + 268) = 0;
      if (*(_BYTE *)(a1 + 680) == 1 && !*(_BYTE *)(a1 + 65))
      {
        *(_BYTE *)(a1 + 680) = 0;
        *(_BYTE *)(a1 + 269) = 2;
      }
      else
      {
        *(_BYTE *)(a1 + 269) = 0;
      }
    }
    v9 = 4;
LABEL_19:
    v10 = *(_DWORD *)(a1 + 2744);
    if (v10)
      *(_DWORD *)(a1 + 2744) = 0;
    else
      v10 = sub_219860864(a1);
    if (*(_BYTE *)(a1 + 560) == 1)
    {
      v11 = *(unsigned __int8 *)(a1 + 64);
      if (v11 == 6)
      {
        if (v10 - 1 < 4)
        {
          v12 = 4;
          goto LABEL_29;
        }
      }
      else if (v11 == 4 && v10 - 1 < 2)
      {
        v12 = 2;
LABEL_29:
        if (*(_BYTE *)(a1 + 669) != 1)
          v12 = 0;
        LOWORD(v10) = v12 + v10;
        goto LABEL_34;
      }
    }
    if (v10 >= 0x100)
    {
      v13 = 0;
      v14 = v9 | 1;
      *(_BYTE *)(a1 + 266 + v9) = 0;
      v15 = v9 + 3;
      v9 += 2;
      *(_BYTE *)(a1 + 266 + v14) = BYTE1(v10);
LABEL_35:
      *(_BYTE *)(a1 + v9 + 266) = v13;
      *(_WORD *)(a1 + 526) = v15;
      *(_BYTE *)a1 = 8;
      v5 = v10 + 2;
      goto LABEL_36;
    }
LABEL_34:
    v15 = v9 | 1;
    v13 = v10;
    goto LABEL_35;
  }
  *v2 = 45056;
  *(_BYTE *)(a1 + 270) = 15;
  *(_WORD *)(a1 + 526) = 5;
  *(_BYTE *)a1 = 7;
  v5 = 252;
LABEL_36:
  v16 = sub_21985F814(a1, v5);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ReadBinary");
  return v16;
}

uint64_t sub_21985ECD4(uint64_t a1)
{
  int v2;
  uint64_t v3;
  int v4;
  unsigned int v5;
  __int16 v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_SelectFile");
  v2 = *(unsigned __int8 *)(a1 + 642);
  v3 = 29;
  switch(*(_BYTE *)(a1 + 642))
  {
    case 2:
      if (!*(_BYTE *)(a1 + 65))
        goto LABEL_2;
      *(_DWORD *)(a1 + 266) = 33599488;
      v4 = *(_DWORD *)(a1 + 660);
      goto LABEL_3;
    case 3:
      if (!*(_BYTE *)(a1 + 65))
        goto LABEL_2;
      *(_QWORD *)(a1 + 266) = 0xD00300050000D600;
      *(_WORD *)(a1 + 274) = 0;
      v5 = 10;
      goto LABEL_4;
    case 4:
    case 5:
    case 7:
LABEL_2:
      *(_DWORD *)(a1 + 266) = 41984;
      LOBYTE(v4) = 2;
LABEL_3:
      *(_BYTE *)(a1 + 270) = v4;
      v5 = 5;
LABEL_4:
      if (*(_BYTE *)(a1 + 544) == 6 && ((v2 & 0xFE) != 2 || !*(_BYTE *)(a1 + 65)))
        *(_BYTE *)(a1 + 269) = 12;
      if (v2 == 7 || v2 == 4)
      {
        *(_BYTE *)(a1 + v5 + 266) = -31;
        LOBYTE(v6) = 3;
LABEL_11:
        v7 = v5 + 1;
        LOWORD(v5) = v5 + 2;
        *(_BYTE *)(a1 + v7 + 266) = v6;
        goto LABEL_12;
      }
      if ((v2 & 0xFE) != 2 || !*(_BYTE *)(a1 + 65))
      {
        v6 = *(_WORD *)(a1 + 644);
        *(_BYTE *)(a1 + v5 + 266) = HIBYTE(v6);
        goto LABEL_11;
      }
LABEL_12:
      *(_WORD *)(a1 + 526) = v5;
      *(_BYTE *)a1 = 6;
      v3 = sub_21985F814(a1, 2);
LABEL_13:
      sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_SelectFile");
      return v3;
    default:
      goto LABEL_13;
  }
}

uint64_t sub_21985EE50(uint64_t a1)
{
  __int16 v2;
  char v3;
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_SelectSmartTag");
  *(_QWORD *)(a1 + 266) = 0x76D2070004A400;
  *(_WORD *)(a1 + 274) = -31488;
  *(_BYTE *)(a1 + 276) = 1;
  if (*(_BYTE *)(a1 + 642) != 4)
  {
    if (*(_BYTE *)(a1 + 544) != 6)
      goto LABEL_3;
LABEL_5:
    *(_WORD *)(a1 + 277) = 1;
    v2 = 13;
    v3 = 4;
    goto LABEL_6;
  }
  if (!*(_BYTE *)(a1 + 544))
    goto LABEL_5;
LABEL_3:
  *(_BYTE *)(a1 + 277) = 0;
  v2 = 12;
  v3 = 5;
LABEL_6:
  *(_BYTE *)a1 = v3;
  *(_WORD *)(a1 + 526) = v2;
  v4 = sub_21985F814(a1, 2);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_SelectSmartTag");
  return v4;
}

uint64_t sub_21985EF20(uint64_t a1, uint64_t a2, _DWORD *a3, char a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  int v13;
  uint64_t v14;
  _DWORD *v15;
  int v16;
  int v17;
  unsigned int v18;
  uint64_t v19;
  uint64_t v20;
  uint64_t v21;
  uint64_t v23;
  uint64_t v24;

  v23 = 0;
  v24 = a1;
  sub_219850718(0, (unsigned int *)&v24, 8u, 5u, (uint64_t)"phFriNfc_Desfire_WrNdef");
  sub_21988EF68(v24, &v23);
  v11 = 1;
  if (a3 && a5 && v23 && *(_DWORD *)(v23 + 216) <= 1u)
  {
    phOsalNfc_MemCopy();
    v12 = v23;
    *(_DWORD *)(v23 + 2740) = 3;
    *(_QWORD *)(v12 + 24) = a5;
    *(_QWORD *)(v12 + 40) = a6;
    *(_BYTE *)(v12 + 547) = 3;
    *(_WORD *)(v12 + 252) = 0;
    **(_WORD **)(v12 + 528) = 0;
    v13 = *a3;
    v14 = v23;
    v15 = (_DWORD *)(v23 + 2740);
    if (*a3)
      v15 = a3;
    *(_DWORD *)(v23 + 248) = *v15;
    *(_QWORD *)(v14 + 256) = v15;
    *v15 = 0;
    v16 = *(unsigned __int8 *)(v14 + 64);
    if (v16 == 4)
      v17 = 2;
    else
      v17 = 4 * (v16 == 6);
    v18 = **(_DWORD **)(v14 + 672);
    if (v18 >= sub_21985F0C4((unsigned int *)v14, v17))
    {
      v11 = 26;
    }
    else
    {
      v19 = v14 + 2736;
      if (v13)
        v19 = a2;
      v20 = v23;
      *(_BYTE *)(v23 + 642) = 3;
      *(_BYTE *)(v20 + 540) = 3;
      *(_BYTE *)(v20 + 560) = a4;
      *(_QWORD *)(v20 + 240) = v19;
      if (*(_BYTE *)(v20 + 65))
      {
        if (*(_BYTE *)(v20 + 544) == 6)
          v21 = sub_21985ECD4(v20);
        else
          v21 = sub_21985EE50(v20);
      }
      else
      {
        *(_BYTE *)(v20 + 669) = 0;
        v21 = sub_21985F134(v20);
      }
      v11 = v21;
    }
  }
  sub_219850808(0, (unsigned int *)&v24, 8u, 5u, (uint64_t)"phFriNfc_Desfire_WrNdef");
  return v11;
}

uint64_t sub_21985F0C4(unsigned int *a1, int a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_NdefFileSize");
  if (a1)
    v4 = a1[162] - a2;
  else
    v4 = 0;
  sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_NdefFileSize");
  return v4;
}

uint64_t sub_21985F134(uint64_t a1)
{
  int v2;
  int v3;
  unsigned int v4;
  unsigned int v5;
  unsigned int v6;
  unsigned int v7;
  int v8;
  unsigned int *v9;
  int v10;
  int v11;
  int v12;
  int v13;
  uint64_t v14;
  uint64_t v15;
  unsigned int v16;
  unsigned int v17;
  int v18;
  unsigned int v19;
  unsigned int v20;
  int v21;
  unsigned int v22;
  uint64_t v23;
  unsigned int v24;
  unsigned int v25;
  unsigned int v26;
  char v27;
  _BYTE *v28;
  unsigned int v29;
  uint64_t v30;
  unsigned int v31;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_UpdateBinary");
  v2 = *(unsigned __int8 *)(a1 + 64);
  if (v2 == 4)
    v3 = 2;
  else
    v3 = 4 * (v2 == 6);
  v4 = **(_DWORD **)(a1 + 672);
  if (v4 < sub_21985F0C4((unsigned int *)a1, v3))
  {
    v5 = *(_DWORD *)(a1 + 664);
    v6 = *(_DWORD *)(a1 + 248);
    v7 = v6 - v5;
    if (v6 > v5)
    {
      v8 = sub_21985F0C4((unsigned int *)a1, v3);
      v9 = *(unsigned int **)(a1 + 672);
      if (v7 <= v8 - *v9)
      {
        v12 = *(_DWORD *)(a1 + 248);
        v11 = *(_DWORD *)(a1 + 664);
      }
      else
      {
        v10 = sub_21985F0C4((unsigned int *)a1, v3);
        v9 = *(unsigned int **)(a1 + 672);
        v11 = *(_DWORD *)(a1 + 664);
        v12 = v10 - (*v9 + v11);
        *(_DWORD *)(a1 + 248) = v12;
      }
      *(_WORD *)(a1 + 266) = -10752;
      v16 = v12 - v11;
      v17 = *(unsigned __int16 *)(a1 + 656);
      v18 = *(unsigned __int8 *)(a1 + 669);
      if (v16 >= v17)
      {
        LOWORD(v16) = *(_WORD *)(a1 + 656);
        if (v18 != 1)
        {
          if (*(_DWORD *)(a1 + 216))
            LOWORD(v16) = 0;
          else
            LOWORD(v16) = v17 - v3;
          goto LABEL_22;
        }
      }
      else if (v18 != 1)
      {
        if (*(_DWORD *)(a1 + 216))
          LOWORD(v16) = 0;
LABEL_22:
        v19 = *v9;
        if (!(*v9 | v18))
        {
          *(_WORD *)(a1 + 268) = 0;
          if (*(_BYTE *)(a1 + 560) == 1)
          {
            v20 = 0;
            v21 = *(unsigned __int8 *)(a1 + 64);
            v22 = 4;
LABEL_47:
            if (v21 == 6)
            {
              v20 = (unsigned __int16)v16 + 4;
            }
            else if (v21 == 4)
            {
              v20 = (unsigned __int16)v16 + 2;
            }
            v28 = (_BYTE *)(a1 + v22 + 266);
            if (v20 >= 0x100)
            {
              v29 = v22 + 1;
              v22 += 2;
              *(_BYTE *)(a1 + 266 + v29) = BYTE1(v20);
              *(_BYTE *)(a1 + 266 + v22) = v20;
              LOBYTE(v20) = 0;
            }
            *v28 = v20;
            v26 = v22 + 1;
            if (v21 == 6)
            {
              v27 = 0;
              *(_BYTE *)(a1 + 266 + v26) = 0;
              *(_BYTE *)(a1 + 266 + v22 + 2) = 0;
              v31 = v22 + 3;
              LOWORD(v26) = v22 + 5;
              v22 += 4;
              *(_BYTE *)(a1 + 266 + v31) = 0;
              goto LABEL_59;
            }
            if (v21 == 4)
            {
              v27 = 0;
              v30 = a1 + v26;
              LOWORD(v26) = v22 + 3;
              v22 += 2;
              *(_BYTE *)(v30 + 266) = 0;
LABEL_59:
              *(_BYTE *)(a1 + v22 + 266) = v27;
            }
LABEL_60:
            phOsalNfc_MemCopy();
            *(_WORD *)(a1 + 526) = v16 + v26;
            *(_WORD *)(a1 + 212) = v16;
            *(_BYTE *)(a1 + 669) = 1;
            *(_BYTE *)a1 = 60;
            v14 = sub_21985F814(a1, 2);
            goto LABEL_61;
          }
          v22 = 4;
          goto LABEL_46;
        }
LABEL_25:
        v21 = *(unsigned __int8 *)(a1 + 64);
        if (v21 == 6)
        {
          v19 += 4;
        }
        else if (v21 == 4)
        {
          v19 += 2;
        }
        if (v19 < 0x7FFF)
        {
          v20 = 0;
          *(_BYTE *)(a1 + 268) = BYTE1(v19);
          v22 = 4;
          v23 = 3;
          goto LABEL_42;
        }
        *(_WORD *)(a1 + 267) = 215;
        *(_BYTE *)(a1 + 269) = 0;
        if ((unsigned __int16)v16 < 0x100u)
        {
          if ((unsigned __int16)v16 + 7 > v17)
            LOWORD(v16) = v16 - 7;
          v20 = (unsigned __int16)v16 + 7;
          if ((unsigned __int16)v16 < 0xF9u)
          {
            *(_BYTE *)(a1 + 270) = v16 + 7;
            v24 = 5;
            goto LABEL_41;
          }
        }
        else
        {
          if ((unsigned __int16)v16 + 9 > v17)
            LOWORD(v16) = v16 - 9;
          v20 = (unsigned __int16)v16 + 9;
        }
        *(_BYTE *)(a1 + 270) = 0;
        *(_BYTE *)(a1 + 271) = BYTE1(v20);
        *(_BYTE *)(a1 + 272) = v20;
        v24 = 7;
LABEL_41:
        *(_BYTE *)(a1 + 266 + v24) = 84;
        *(_BYTE *)(a1 + 266 + v24 + 1) = 3;
        *(_BYTE *)(a1 + 266 + v24 + 2) = BYTE2(v19);
        *(_BYTE *)(a1 + 266 + v24 + 3) = BYTE1(v19);
        v23 = v24 + 5;
        *(_BYTE *)(a1 + 266 + v24 + 4) = v19;
        v22 = v24 + 6;
        LOBYTE(v19) = 83;
LABEL_42:
        *(_BYTE *)(a1 + v23 + 266) = v19;
        if (*(_BYTE *)(a1 + 560) == 1)
        {
          if (v18 == 1)
          {
            if ((unsigned __int16)v16 < 0x100u)
            {
              LOWORD(v26) = v22 + 1;
            }
            else
            {
              v25 = v22 + 1;
              *(_BYTE *)(a1 + 266 + v22) = 0;
              LOWORD(v26) = v22 + 3;
              v22 += 2;
              *(_BYTE *)(a1 + 266 + v25) = BYTE1(v16);
            }
            v27 = v16;
            goto LABEL_59;
          }
          goto LABEL_47;
        }
LABEL_46:
        *(_BYTE *)(a1 + 266 + v22) = 0;
        *(_BYTE *)(a1 + 266 + v22 + 1) = BYTE1(v16);
        LOWORD(v26) = v22 + 3;
        *(_BYTE *)(a1 + 266 + v22 + 2) = v16;
        goto LABEL_60;
      }
      v19 = *v9;
      v18 = 1;
      goto LABEL_25;
    }
  }
  v13 = **(_DWORD **)(a1 + 672);
  if (v13 == sub_21985F0C4((unsigned int *)a1, v3) || *(_DWORD *)(a1 + 664) == *(_DWORD *)(a1 + 248))
  {
    v14 = sub_21985F70C(a1);
LABEL_61:
    v15 = v14;
    goto LABEL_62;
  }
  *(_DWORD *)(a1 + 664) = 0;
  *(_BYTE *)(a1 + 540) = 0;
  v15 = 255;
  sub_21985FAC8(a1, 255);
LABEL_62:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_UpdateBinary");
  return v15;
}

uint64_t sub_21985F594(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ChkNdef");
  sub_21988EF68(v9, &v8);
  v5 = 1;
  if (a3)
  {
    if (a2)
    {
      v6 = v8;
      if (v8)
      {
        *(_QWORD *)(v8 + 8) = a2;
        *(_QWORD *)(v6 + 40) = a3;
        *(_BYTE *)(v6 + 547) = 1;
        *(_WORD *)(v6 + 2748) = 0;
        *(_BYTE *)(v6 + 544) = 0;
        *(_BYTE *)(v6 + 642) = 4;
        v5 = sub_21985EE50(v6);
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ChkNdef");
  return v5;
}

uint64_t sub_21985F64C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ConvertToReadOnly");
  sub_21988EF68(v10, &v9);
  v5 = 1;
  if (a2)
  {
    v6 = v9;
    if (v9)
    {
      *(_QWORD *)(v9 + 32) = a2;
      *(_QWORD *)(v6 + 40) = a3;
      *(_BYTE *)(v6 + 547) = 6;
      *(_BYTE *)(v6 + 642) = 7;
      *(_BYTE *)(v6 + 540) = 6;
      if (*(_BYTE *)(v6 + 544) == 6)
        v7 = sub_21985ECD4(v6);
      else
        v7 = sub_21985EE50(v6);
      v5 = v7;
    }
  }
  sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ConvertToReadOnly");
  return v5;
}

uint64_t sub_21985F70C(uint64_t a1)
{
  uint64_t v2;
  int v3;
  _DWORD *v4;
  __int16 v5;
  uint64_t v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HSetGet_NLEN");
  if (*(_BYTE *)(a1 + 642) != 5)
  {
    *(_DWORD *)(a1 + 266) = 54784;
    v3 = *(unsigned __int8 *)(a1 + 64);
    if (v3 == 6)
    {
      *(_BYTE *)(a1 + 270) = 4;
      v6 = *(_QWORD *)(a1 + 672);
      *(_BYTE *)(a1 + 271) = *(_BYTE *)(v6 + 3);
      *(_BYTE *)(a1 + 272) = *(_WORD *)(v6 + 2);
      *(_BYTE *)(a1 + 273) = BYTE1(*(_DWORD *)v6);
      *(_BYTE *)(a1 + 274) = *(_DWORD *)v6;
      v5 = 9;
    }
    else
    {
      if (v3 != 4)
      {
LABEL_8:
        *(_BYTE *)a1 = 61;
        v2 = sub_21985F814(a1, 2);
        goto LABEL_9;
      }
      *(_BYTE *)(a1 + 270) = 2;
      v4 = *(_DWORD **)(a1 + 672);
      *(_BYTE *)(a1 + 271) = BYTE1(*v4);
      *(_BYTE *)(a1 + 272) = *v4;
      v5 = 7;
    }
    *(_WORD *)(a1 + 526) = v5;
    goto LABEL_8;
  }
  v2 = sub_21985EE50(a1);
LABEL_9:
  v7 = v2;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HSetGet_NLEN");
  return v7;
}

uint64_t sub_21985F814(uint64_t a1, __int16 a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HSendTransCmd");
  *(_DWORD *)(a1 + 232) = 0;
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_QWORD *)(a1 + 48) = sub_219860110;
  *(_QWORD *)(a1 + 56) = a1;
  *(_WORD *)(a1 + 264) = a2;
  v4 = sub_219888630(a1, (uint64_t)sub_2198609B8);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HSendTransCmd");
  return v4;
}

uint64_t sub_21985F8AC(uint64_t a1)
{
  int v2;
  int v3;
  unsigned int v4;
  int v5;
  int v6;
  unsigned int v7;
  int v8;
  unsigned int v9;
  unsigned int v10;
  uint64_t v11;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HProcReadData");
  if (*(_BYTE *)(a1 + 560) != 1)
  {
    phOsalNfc_MemCopy();
    v5 = *(unsigned __int16 *)(a1 + 264) - 2;
    **(_DWORD **)(a1 + 552) += v5;
    **(_DWORD **)(a1 + 672) += v5;
    v6 = *(_DWORD *)(a1 + 664) + v5;
LABEL_18:
    *(_DWORD *)(a1 + 664) = v6;
    goto LABEL_19;
  }
  if (*(_BYTE *)(a1 + 65) != 1)
    goto LABEL_8;
  v2 = *(unsigned __int8 *)(a1 + 64);
  if (v2 == 6)
  {
    v3 = 4 * (*(_BYTE *)(a1 + 668) != 1);
    if (!**(_DWORD **)(a1 + 672))
    {
      v4 = bswap32(*(_DWORD *)(a1 + 266));
      goto LABEL_12;
    }
    goto LABEL_10;
  }
  if (v2 != 4)
  {
LABEL_8:
    v3 = 0;
    goto LABEL_13;
  }
  v3 = 2 * (*(_BYTE *)(a1 + 668) != 1);
  if (**(_DWORD **)(a1 + 672))
  {
LABEL_10:
    v4 = *(_DWORD *)(a1 + 660);
    goto LABEL_12;
  }
  v4 = __rev16(*(unsigned __int16 *)(a1 + 266));
LABEL_12:
  *(_DWORD *)(a1 + 660) = v4;
LABEL_13:
  v7 = *(_DWORD *)(a1 + 660);
  if (v7)
  {
    if (v7 >= *(unsigned __int16 *)(a1 + 264) - v3 - 2)
      v8 = *(unsigned __int16 *)(a1 + 264) - v3 - 2;
    else
      v8 = *(_DWORD *)(a1 + 660);
    phOsalNfc_MemCopy();
    **(_DWORD **)(a1 + 552) += v8;
    **(_DWORD **)(a1 + 672) += v8;
    v6 = *(_DWORD *)(a1 + 664) + v8;
    goto LABEL_18;
  }
  *(_BYTE *)(a1 + 545) = 0;
  sub_21985FAC8(a1, 26);
LABEL_19:
  v9 = **(_DWORD **)(a1 + 672);
  v10 = *(_DWORD *)(a1 + 660);
  if (v9 < v10)
  {
    if (*(_DWORD *)(a1 + 248) != *(_DWORD *)(a1 + 664))
    {
      *(_BYTE *)(a1 + 668) = 1;
      v11 = sub_21985EABC(a1);
      if (v11 == 13)
        return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HProcReadData");
      goto LABEL_27;
    }
    goto LABEL_25;
  }
  if (v9 == v10)
  {
LABEL_25:
    v11 = 0;
    goto LABEL_26;
  }
  *(_BYTE *)(a1 + 540) = 0;
  v11 = 255;
LABEL_26:
  *(_DWORD *)(a1 + 664) = 0;
LABEL_27:
  sub_21985FAC8(a1, v11);
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HProcReadData");
}

uint64_t sub_21985FAC8(uint64_t a1, uint64_t a2)
{
  unsigned int v4;
  uint64_t v5;
  int v6;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  int v11;

  v11 = 0;
  v9 = 0;
  v10 = 0;
  v8 = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HCrHandler");
  if (a1)
  {
    *(_BYTE *)a1 = 0;
    switch(*(_BYTE *)(a1 + 547))
    {
      case 1:
        if ((_DWORD)a2)
        {
          *(_BYTE *)(a1 + 546) = 0;
          LOBYTE(v10) = 3;
          if (((1 << a2) & 0x24480000) != 0)
            v4 = 152;
          else
            v4 = a2;
          if (a2 <= 0x1Du)
            v5 = v4;
          else
            v5 = a2;
        }
        else
        {
          v5 = 0;
          *(_BYTE *)(a1 + 546) = 1;
          v6 = *(_DWORD *)(a1 + 648) - 2;
          HIDWORD(v10) = *(_DWORD *)(a1 + 660);
          v11 = v6;
          LOBYTE(v10) = *(_BYTE *)(a1 + 545);
        }
        (*(void (**)(_QWORD, uint64_t, uint64_t *))(a1 + 8))(*(_QWORD *)(a1 + 40), v5, &v10);
        break;
      case 2:
        if ((_DWORD)a2 == 24 || !(_DWORD)a2)
        {
          LODWORD(v9) = **(_DWORD **)(a1 + 552);
          v8 = *(_QWORD *)(a1 + 240);
        }
        (*(void (**)(_QWORD, uint64_t, uint64_t *))(a1 + 16))(*(_QWORD *)(a1 + 40), a2, &v8);
        break;
      case 3:
        (*(void (**)(_QWORD, uint64_t))(a1 + 24))(*(_QWORD *)(a1 + 40), a2);
        break;
      case 6:
        (*(void (**)(_QWORD, uint64_t))(a1 + 32))(*(_QWORD *)(a1 + 40), a2);
        break;
      default:
        return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HCrHandler");
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HCrHandler");
}

uint64_t sub_21985FC20(uint64_t a1, int a2)
{
  int v4;
  uint64_t v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ReadRemCCBytes");
  if (a1 && a2)
  {
    v4 = *(unsigned __int8 *)(a1 + 642);
    if (v4 == 7 || v4 == 4)
    {
      *(_WORD *)(a1 + 266) = -20480;
      *(_BYTE *)(a1 + 268) = *(_BYTE *)(a1 + 2748);
      *(_BYTE *)(a1 + 269) = 0;
      *(_BYTE *)(a1 + 270) = a2;
      *(_WORD *)(a1 + 526) = 5;
      v6 = sub_21985F814(a1, (unsigned __int16)(a2 + 2));
      if (v6 != 13)
      {
        v7 = v6;
        phOsalNfc_SetMemory();
        *(_WORD *)(a1 + 2748) = 0;
        sub_21985FAC8(a1, v7);
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ReadRemCCBytes");
}

uint64_t sub_21985FCF0(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  unsigned int v6;
  unsigned int v7;
  unsigned int v8;
  int v9;
  char v10;
  char v11;
  char v12;
  int v13;
  uint64_t v14;
  int v15;
  int v16;
  int v18;
  int v19;
  int v20;
  unsigned __int8 v21;
  _QWORD v22[3];

  v22[2] = *MEMORY[0x24BDAC8D0];
  *(_QWORD *)((char *)v22 + 7) = 0;
  v22[0] = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ProcReadCapCont");
  if (!a1)
    return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ProcReadCapCont");
  if (*(_BYTE *)(a1 + 642) != 7)
  {
    v21 = 0;
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Update_SmartTagCapContainer");
    v6 = __rev16(*(unsigned __int16 *)(a1 + 266));
    if (v6 < 0xF || v6 == 0xFFFF || sub_21988B8FC(a1, 2u))
      goto LABEL_52;
    v7 = __rev16(*(unsigned __int16 *)(a1 + 269));
    if (v7 >= 0xFF)
      LOWORD(v7) = 255;
    *(_WORD *)(a1 + 654) = v7;
    v8 = __rev16(*(unsigned __int16 *)(a1 + 271));
    if (v8 >= 0xFA)
      LOWORD(v8) = 250;
    *(_WORD *)(a1 + 656) = v8;
    if (!*(_BYTE *)(a1 + 65)
      && !sub_2198DB79C(*(_QWORD *)(a1 + 2712), &v21)
      && v21
      && *(unsigned __int16 *)(a1 + 656) > v21)
    {
      *(_WORD *)(a1 + 656) = v21 - 5;
    }
    if (*(unsigned __int16 *)(a1 + 654) < 0xFu || !*(_WORD *)(a1 + 656))
      goto LABEL_52;
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HChkAndParseTLV");
    v9 = *(unsigned __int8 *)(a1 + 273);
    if ((v9 - 7) < 0xFFFFFFFD)
    {
      sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HChkAndParseTLV");
LABEL_52:
      sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Update_SmartTagCapContainer");
      v5 = a1;
      v4 = 22;
      goto LABEL_53;
    }
    if (v9 == 6)
      v10 = 6;
    else
      v10 = 5;
    if (v9 == 4)
      v11 = 4;
    else
      v11 = v10;
    *(_BYTE *)(a1 + 64) = v11;
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HChkAndParseTLV");
    v12 = *(_BYTE *)(a1 + 64);
    if (v12 != 6)
    {
      if (v12 == 5)
        goto LABEL_36;
      if (v12 != 4)
        goto LABEL_52;
    }
    v13 = *(unsigned __int8 *)(a1 + 274);
    if (*(_BYTE *)(a1 + 274)
      && v13 != 255
      && (*(_BYTE *)(a1 + 64) == 4 && v13 == 6 || *(_BYTE *)(a1 + 64) == 6 && v13 == 8))
    {
      v15 = __rev16(*(unsigned __int16 *)(a1 + 275));
      *(_WORD *)(a1 + 644) = v15;
      if (v15 <= 57601)
      {
        if (v15 == 16128)
          goto LABEL_52;
        v16 = 0x3FFF;
      }
      else
      {
        if ((v15 - 57602) < 2)
          goto LABEL_52;
        v16 = 0xFFFF;
      }
      if (v15 == v16)
        goto LABEL_52;
      v18 = *(unsigned __int8 *)(a1 + 277);
      v19 = *(unsigned __int8 *)(a1 + 278);
      v20 = v13 == 6
          ? v19 | (v18 << 8)
          : (v18 << 24) | (v19 << 16) | (*(unsigned __int8 *)(a1 + 279) << 8) | *(unsigned __int8 *)(a1 + 280);
      *(_DWORD *)(a1 + 648) = v20;
      if ((v20 - 2) < 5)
        goto LABEL_52;
      if (v20 == 0xFFFF)
      {
        if (v12 == 4)
          goto LABEL_52;
      }
      else if (v12 == 6 && v20 == -3)
      {
        goto LABEL_52;
      }
      *(_WORD *)(a1 + 652) = *(_WORD *)(a1 + 279);
      sub_219860934(a1);
    }
LABEL_36:
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Update_SmartTagCapContainer");
    *(_BYTE *)(a1 + 642) = 5;
    if (*(_BYTE *)(a1 + 65) && *(_BYTE *)(a1 + 544) != 6)
      v14 = sub_21985F70C(a1);
    else
      v14 = sub_21985ECD4(a1);
    v4 = v14;
    if (v14 != 13)
      goto LABEL_8;
    return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ProcReadCapCont");
  }
  *(_BYTE *)a1 = 62;
  phOsalNfc_MemCopy();
  if (sub_21987BA3C(*(_QWORD *)(a1 + 2712)) == 1)
    v2 = 0;
  else
    v2 = -1;
  BYTE6(v22[1]) = v2;
  *(_DWORD *)(a1 + 266) = 54784;
  *(_BYTE *)(a1 + 270) = 15;
  phOsalNfc_MemCopy();
  *(_WORD *)(a1 + 526) = 20;
  v3 = sub_21985F814(a1, 2);
  if (v3 != 13)
  {
    v4 = v3;
LABEL_8:
    v5 = a1;
LABEL_53:
    sub_21985FAC8(v5, v4);
  }
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_ProcReadCapCont");
}

uint64_t sub_219860110(uint64_t a1, unsigned __int8 *a2, uint64_t a3)
{
  _DWORD *v5;
  unsigned int v6;
  unsigned __int8 *v7;
  uint64_t v8;
  unsigned __int8 *v9;
  uint64_t v10;
  uint64_t v11;
  int v12;
  unsigned __int16 v13;
  unsigned int v14;
  unsigned int v15;
  int v16;
  unsigned int v17;
  int v18;
  int v19;
  uint64_t v20;
  int v22;
  int v23;
  int v25;
  int v26;
  int v27;
  unsigned __int8 *v28;
  int v29;
  unsigned int v30;
  unsigned int v31;
  _DWORD *v32;
  int v33;
  char v34;
  int v35;
  unsigned __int8 *v36;
  unsigned int v37;
  int v38;
  unsigned int v39;
  unsigned int v40;
  int v41;
  unsigned int v42;
  uint64_t v43;

  v43 = a1;
  sub_219850718(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
  if ((_DWORD)a3)
  {
    if (a2)
    {
      if (*a2 == 8)
      {
        v5 = (_DWORD *)*((_QWORD *)a2 + 84);
        if (*v5)
        {
          *v5 = 0;
          *((_DWORD *)a2 + 166) = 0;
          a3 = 24;
        }
      }
    }
LABEL_43:
    v10 = (uint64_t)a2;
    v8 = a3;
    goto LABEL_44;
  }
  v6 = *a2;
  if (v6 > 0x3B)
  {
    switch(v6)
    {
      case '<':
        if (a2[266] == 144 && !a2[267])
        {
          v33 = *((unsigned __int16 *)a2 + 106);
          **((_DWORD **)a2 + 84) += v33;
          *((_DWORD *)a2 + 166) += v33;
          **((_DWORD **)a2 + 32) += v33;
          sub_21985F134((uint64_t)a2);
          return sub_219850808(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
        }
        *((_DWORD *)a2 + 166) = 0;
        v10 = (uint64_t)a2;
        v8 = 21;
        goto LABEL_44;
      case '=':
        if (a2[266] == 144 && !a2[267])
        {
          v8 = 0;
          v34 = a2[545];
          if (!v34)
            v34 = 2;
          a2[545] = v34;
          *((_DWORD *)a2 + 165) = **((unsigned __int16 **)a2 + 32);
        }
        else
        {
          a2[540] = 0;
          v8 = 21;
        }
LABEL_85:
        *((_DWORD *)a2 + 166) = 0;
        break;
      case '>':
        if (a2[266] == 144 && !a2[267])
        {
          v8 = 0;
          a2[545] = 1;
        }
        else
        {
          a2[540] = 0;
          v8 = 21;
        }
        break;
      default:
LABEL_52:
        v10 = (uint64_t)a2;
        v8 = 245;
LABEL_44:
        sub_21985FAC8(v10, v8);
        return sub_219850808(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
    }
LABEL_86:
    v10 = (uint64_t)a2;
    goto LABEL_44;
  }
  switch(*a2)
  {
    case 4u:
      v7 = &a2[*((unsigned __int16 *)a2 + 132)];
      if (v7[264] != 144 || v7[265])
      {
        a2[544] = 2;
        sub_21985EE50(a2);
        return sub_219850808(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
      }
      a2[544] = 6;
LABEL_88:
      v11 = sub_21985ECD4((uint64_t)a2);
      goto LABEL_89;
    case 5u:
      v9 = &a2[*((unsigned __int16 *)a2 + 132)];
      if (v9[264] == 144 && !v9[265])
        goto LABEL_88;
      a2[544] = 0;
      v10 = (uint64_t)a2;
      v8 = 19;
      goto LABEL_44;
    case 6u:
      if (a2[266] != 144 || a2[267])
        goto LABEL_59;
      switch(a2[642])
      {
        case 2u:
          if (a2[65] || a2[560] != 1 || *((_DWORD *)a2 + 166) || **((_DWORD **)a2 + 84))
            goto LABEL_23;
          v11 = sub_21985EA08((uint64_t)a2);
          break;
        case 3u:
          v11 = sub_21985F134((uint64_t)a2);
          goto LABEL_89;
        case 4u:
        case 5u:
        case 7u:
          goto LABEL_23;
        default:
          goto LABEL_59;
      }
      goto LABEL_89;
    case 7u:
      v12 = *((unsigned __int16 *)a2 + 132);
      if (v12 < 3)
      {
        if (v12 == 2)
        {
          v22 = a2[266];
          if (v22 == 108 || v22 == 97)
          {
            v23 = a2[267];
            if (a2[267])
            {
              if (15 - *((unsigned __int16 *)a2 + 1374) > v23)
              {
LABEL_119:
                sub_21985FC20((uint64_t)a2, v23);
                return sub_219850808(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
              }
            }
          }
        }
      }
      else if (17 - *((unsigned __int16 *)a2 + 1374) >= v12 && a2[v12 - 2 + 266] == 144 && !a2[v12 - 1 + 266])
      {
        phOsalNfc_MemCopy();
        v13 = *((_WORD *)a2 + 132) + *((_WORD *)a2 + 1374) - 2;
        *((_WORD *)a2 + 1374) = v13;
        if (v13 == 15)
        {
          phOsalNfc_MemCopy();
          *(_WORD *)(a2 + 281) = 144;
          *((_WORD *)a2 + 132) = *((_WORD *)a2 + 1374) + 2;
          phOsalNfc_SetMemory();
          *((_WORD *)a2 + 1374) = 0;
          sub_21985FCF0((uint64_t)a2);
          return sub_219850808(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
        }
        v23 = 15 - v13;
        goto LABEL_119;
      }
      phOsalNfc_SetMemory();
      *((_WORD *)a2 + 1374) = 0;
      goto LABEL_59;
    case 8u:
      *((_DWORD *)a2 + 686) = 0;
      v14 = sub_219860864((uint64_t)a2);
      v15 = *((unsigned __int16 *)a2 + 132);
      if (a2[669] == 1)
      {
        v16 = a2[64];
        v17 = v14 - 1;
        if (v16 == 4 && v17 <= 1)
        {
          v14 += 2;
        }
        else if (v17 < 4 && v16 == 6)
        {
          v14 += 4;
        }
      }
      if (v14 < (unsigned __int16)(v15 - 2) || v15 < 3)
      {
        if (v15 == 2)
        {
          v29 = a2[266];
          if (v29 == 108 || v29 == 97)
          {
            v30 = a2[267];
            v31 = 20;
            if (a2[267] && v14 > v30)
            {
              *((_DWORD *)a2 + 686) = v30;
              sub_21985EABC((uint64_t)a2);
              return sub_219850808(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
            }
            goto LABEL_81;
          }
        }
      }
      else if (a2[v15 + 264] == 144 && !a2[v15 + 265])
      {
        v25 = a2[642];
        if (v25 == 2)
        {
          sub_21985F8AC((uint64_t)a2);
          return sub_219850808(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
        }
        if (v25 != 5)
        {
LABEL_59:
          v10 = (uint64_t)a2;
          v8 = 29;
          goto LABEL_44;
        }
        v26 = a2[64];
        if (v26 == 6)
        {
          v27 = (a2[266] << 24) | (a2[267] << 16) | (a2[268] << 8);
          v28 = a2 + 269;
        }
        else
        {
          if (v26 != 4)
          {
            v40 = 0;
LABEL_125:
            if (v26 == 4)
              v41 = 2;
            else
              v41 = 4 * (v26 == 6);
            v42 = sub_21985F0C4((unsigned int *)a2, v41);
            v31 = 22;
            if (v40 != 0xFFFF && v40 <= v42)
            {
              *((_DWORD *)a2 + 165) = v40;
              v8 = sub_21988B840((uint64_t)a2, v40);
              if (!(_DWORD)v8)
              {
                *a2 = 10;
                **((_DWORD **)a2 + 84) = 0;
                *((_DWORD *)a2 + 166) = 0;
                a2[642] = 4;
              }
              goto LABEL_86;
            }
LABEL_81:
            v32 = (_DWORD *)*((_QWORD *)a2 + 84);
            if (*v32)
              v8 = 24;
            else
              v8 = v31;
            *v32 = 0;
            goto LABEL_85;
          }
          v27 = a2[266] << 8;
          v28 = a2 + 267;
        }
        v40 = v27 | *v28;
        goto LABEL_125;
      }
      v31 = 20;
      goto LABEL_81;
    case 9u:
      sub_219850718(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Validate_NdefRdLen");
      v18 = a2[64];
      if (v18 == 6)
        v19 = 4;
      else
        v19 = 2;
      a2[669] = 0;
      v20 = *((unsigned __int16 *)a2 + 132);
      if (v19 != (unsigned __int16)(v20 - 2) || a2[v20 + 264] != 144 || a2[v20 + 265])
      {
        a3 = 20;
LABEL_41:
        **((_DWORD **)a2 + 84) = 0;
        *((_DWORD *)a2 + 166) = 0;
LABEL_42:
        sub_219850808(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Validate_NdefRdLen");
        goto LABEL_43;
      }
      if (v18 == 6)
      {
        v35 = (a2[266] << 24) | (a2[267] << 16) | (a2[268] << 8);
        v36 = a2 + 269;
        goto LABEL_106;
      }
      if (v18 == 4)
      {
        v35 = a2[266] << 8;
        v36 = a2 + 267;
LABEL_106:
        v37 = v35 | *v36;
        goto LABEL_108;
      }
      v37 = 0;
LABEL_108:
      if (v18 == 4)
        v38 = 2;
      else
        v38 = 4 * (v18 == 6);
      v39 = sub_21985F0C4((unsigned int *)a2, v38);
      a3 = 22;
      if (v37 == 0xFFFF || v37 > v39)
        goto LABEL_41;
      if (!v37)
      {
        a3 = 157;
        goto LABEL_41;
      }
      *((_DWORD *)a2 + 165) = v37;
      a3 = sub_21988B840((uint64_t)a2, v37);
      if ((_DWORD)a3)
        goto LABEL_42;
      **((_DWORD **)a2 + 84) = 0;
      *((_DWORD *)a2 + 166) = 0;
      if (!a2[65])
      {
        a2[680] = 1;
        a2[668] = 1;
      }
      sub_219850808(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Validate_NdefRdLen");
LABEL_23:
      v11 = sub_21985EABC((uint64_t)a2);
LABEL_89:
      if (v11 != 13)
      {
        v8 = v11;
        goto LABEL_86;
      }
      return sub_219850808(0, (unsigned int *)&v43, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Process");
    default:
      goto LABEL_52;
  }
}

uint64_t sub_219860864(uint64_t a1)
{
  int v2;
  BOOL v3;
  uint64_t v4;
  unsigned int v5;
  int v6;
  unsigned int v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HGetLeBytes");
  v2 = *(unsigned __int8 *)(a1 + 642);
  if (v2 == 5)
  {
    v3 = 0;
    if (*(_BYTE *)(a1 + 64) == 6)
      v4 = 4;
    else
      v4 = 2;
  }
  else
  {
    v5 = *(_DWORD *)(a1 + 248) - *(_DWORD *)(a1 + 664);
    v6 = **(_DWORD **)(a1 + 672);
    v7 = *(_DWORD *)(a1 + 660) - v6;
    if (v5 >= *(unsigned __int16 *)(a1 + 654))
      v5 = *(unsigned __int16 *)(a1 + 654);
    if (v5 >= v7)
      v4 = v7;
    else
      v4 = v5;
    v3 = (v2 != 2 || *(_BYTE *)(a1 + 65) != 0) && *(_BYTE *)(a1 + 560) == 1 && v6 == 0;
  }
  *(_BYTE *)(a1 + 669) = v3;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HGetLeBytes");
  return v4;
}

uint64_t sub_219860934(uint64_t a1)
{
  char v3;
  char v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HChkNDEFFileAccessRights");
  if (*(char *)(a1 + 653) < -1 || *(_BYTE *)(a1 + 653) == 0)
    v3 = 2;
  else
    v3 = 1;
  if (*(char *)(a1 + 652) < -1 || *(_BYTE *)(a1 + 652) == 0)
    v5 = v3;
  else
    v5 = 3;
  *(_BYTE *)(a1 + 545) = v5;
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_HChkNDEFFileAccessRights");
}

uint64_t sub_2198609B8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 8u, 5u, (uint64_t)"phFriNfc_Desfire_CB_Transceive");
  sub_21988EF68(v8, &v7);
  v5 = v7;
  if (v7)
  {
    if (a4)
      *(_WORD *)(v7 + 264) = *(_DWORD *)(a4 + 8);
    (*(void (**)(uint64_t))(v5 + 48))(v8);
  }
  return sub_219850808(0, (unsigned int *)&v8, 8u, 5u, (uint64_t)"phFriNfc_Desfire_CB_Transceive");
}

uint64_t sub_219860A4C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrInit");
  if (a1)
  {
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
    v2 = 0;
    *(_QWORD *)(a1 + 904) = 0;
    *(_WORD *)(a1 + 900) = 0;
    *(_QWORD *)(a1 + 928) = 0;
    *(_QWORD *)(a1 + 944) = 0;
    *(_QWORD *)(a1 + 936) = 0;
    *(_BYTE *)(a1 + 952) = 0;
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrInit");
  return v2;
}

uint64_t sub_219860B08(unsigned int *a1)
{
  uint64_t v2;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrRelease");
  if (a1)
  {
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
    v2 = 0;
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrRelease");
  return v2;
}

uint64_t sub_219860BAC(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v6;
  const char *v7;
  const char *v8;
  uint64_t v9;
  int v10;
  unsigned int *v11;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrRegisterCb");
  if (!a1 || !a2)
  {
    v8 = "Invalid input parameters";
    v9 = 1;
    v10 = 3;
    v11 = (unsigned int *)a1;
LABEL_15:
    sub_219850628(v10, v11, 3u, 1u, (uint64_t)v8);
    goto LABEL_16;
  }
  if (!*(_QWORD *)(a2 + 16))
  {
    v11 = (unsigned int *)(a1 + 2468);
    v8 = "Invalid call back function pointer to register";
LABEL_14:
    v9 = 1;
    v10 = 1;
    goto LABEL_15;
  }
  if (!a3)
  {
    v6 = a1 + 2184;
    v7 = "Registering for data message...";
    goto LABEL_12;
  }
  if (a3 == 3)
  {
    v6 = a1 + 1032;
    v7 = "Registering for notification message...";
    goto LABEL_12;
  }
  if (a3 != 2)
  {
    v11 = (unsigned int *)(a1 + 2468);
    v8 = "Invalid message type";
    goto LABEL_14;
  }
  v6 = a1 + 1008;
  v7 = "Registering for response message...";
LABEL_12:
  sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)v7);
  v9 = sub_219860CDC(*(_QWORD *)(a1 + 632), v6, a2, a3);
LABEL_16:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrRegisterCb");
  return v9;
}

uint64_t sub_219860CDC(uint64_t a1, uint64_t a2, uint64_t a3, int a4)
{
  uint64_t v7;
  unsigned int *v8;
  unsigned int v9;
  uint64_t v10;
  _OWORD *v11;
  const char *v12;
  uint64_t v13;
  uint64_t v14;
  _BYTE *v16;
  unsigned int *v17;
  unsigned __int8 v18;
  uint64_t v19;
  uint64_t v20;

  v19 = a1;
  v18 = 0;
  v17 = 0;
  sub_219850718(0, (unsigned int *)&v19, 3u, 5u, (uint64_t)"phNciNfc_CoreRegister");
  if (a4 == 2)
  {
    v9 = 0;
  }
  else
  {
    if (a4 == 3)
    {
      v20 = v19;
      sub_219850718(0, (unsigned int *)&v20, 3u, 5u, (uint64_t)"phNciNfc_CheckNtfRegistration");
      if (a2)
      {
        v7 = 0;
        while (!*(_BYTE *)(a2 + v7)
             || *(unsigned __int8 *)(a3 + 1) != *(unsigned __int8 *)(a2 + v7 + 1)
             || *(unsigned __int8 *)(a3 + 2) != *(unsigned __int8 *)(a2 + v7 + 2)
             || *(_QWORD *)(a3 + 16) != *(_QWORD *)(a2 + v7 + 16))
        {
          v7 += 24;
          if (v7 == 1152)
            goto LABEL_10;
        }
        sub_219850808(0, (unsigned int *)&v20, 3u, 5u, (uint64_t)"phNciNfc_CheckNtfRegistration");
        v12 = "Notification registration entry already exists, skip registration";
        goto LABEL_17;
      }
LABEL_10:
      sub_219850808(0, (unsigned int *)&v20, 3u, 5u, (uint64_t)"phNciNfc_CheckNtfRegistration");
    }
    if (sub_21988F19C(v19, &v17))
    {
      sub_219850628(0, (unsigned int *)&v19, 3u, 2u, (uint64_t)"phNciNfc_CoreRegister: Nci Core context not valid");
      v8 = 0;
      v17 = 0;
    }
    else
    {
      v8 = v17;
    }
    v14 = sub_219852A68(v8, 1, a2, (unsigned __int8 *)a3, a4, &v18);
    if ((_DWORD)v14)
    {
      v13 = v14;
      sub_219850628(0, (unsigned int *)&v19, 3u, 1u, (uint64_t)"No free slots available, registraiton failed!");
      goto LABEL_21;
    }
    if (!a4)
    {
      v16 = (_BYTE *)(a2 + 24 * v18);
      *v16 = *(_BYTE *)a3;
      v16[1] = *(_BYTE *)(a3 + 3);
      v11 = v16 + 8;
      goto LABEL_15;
    }
    if (a4 != 3)
      goto LABEL_16;
    v9 = v18;
  }
  v10 = a2 + 24 * v9;
  *(_BYTE *)v10 = *(_BYTE *)a3;
  *(_WORD *)(v10 + 1) = *(_WORD *)(a3 + 1);
  v11 = (_OWORD *)(v10 + 8);
LABEL_15:
  *v11 = *(_OWORD *)(a3 + 8);
LABEL_16:
  v12 = "Registration success";
LABEL_17:
  sub_219850628(0, (unsigned int *)&v19, 3u, 4u, (uint64_t)v12);
  v13 = 0;
LABEL_21:
  sub_219850808(0, (unsigned int *)&v19, 3u, 5u, (uint64_t)"phNciNfc_CoreRegister");
  return v13;
}

uint64_t sub_219860F20(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v6;
  const char *v7;
  const char *v8;
  uint64_t v9;
  int v10;
  unsigned int *v11;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrDeRegisterCb");
  if (!a1 || !a2)
  {
    v8 = "Invalid input parameters";
    v9 = 1;
    v10 = 3;
    v11 = (unsigned int *)a1;
LABEL_15:
    sub_219850628(v10, v11, 3u, 1u, (uint64_t)v8);
    goto LABEL_16;
  }
  if (!*(_QWORD *)(a2 + 16))
  {
    v11 = (unsigned int *)(a1 + 2468);
    v8 = "Invalid call back function pointer to register";
LABEL_14:
    v9 = 1;
    v10 = 1;
    goto LABEL_15;
  }
  if (!a3)
  {
    v6 = a1 + 2184;
    v7 = "De-registering data message call back...";
    goto LABEL_12;
  }
  if (a3 == 3)
  {
    v6 = a1 + 1032;
    v7 = "De-registering notification message  call back...";
    goto LABEL_12;
  }
  if (a3 != 2)
  {
    v11 = (unsigned int *)(a1 + 2468);
    v8 = "Invalid message type";
    goto LABEL_14;
  }
  v6 = a1 + 1008;
  v7 = "De-registering response message call back...";
LABEL_12:
  sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)v7);
  v9 = sub_219861050(*(_QWORD *)(a1 + 632), v6, a2, a3);
LABEL_16:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrDeRegisterCb");
  return v9;
}

uint64_t sub_219861050(uint64_t a1, uint64_t a2, uint64_t a3, int a4)
{
  uint64_t v7;
  const char *v8;
  unsigned int v9;
  uint64_t v11;
  uint64_t v12;
  const char *v13;
  uint64_t v14;
  unsigned int *v16;
  unsigned __int8 v17;
  uint64_t v18;

  v18 = a1;
  v17 = 0;
  v16 = 0;
  sub_219850718(0, (unsigned int *)&v18, 3u, 5u, (uint64_t)"phNciNfc_CoreDeRegister");
  if (sub_21988F19C(v18, &v16))
    sub_219850628(0, (unsigned int *)&v18, 3u, 2u, (uint64_t)"phNciNfc_CoreDeRegister: Nci Core context not valid");
  if ((a4 | 2) == 2)
  {
    if (sub_219852A68(v16, 0, a2, (unsigned __int8 *)a3, a4, &v17))
    {
      v7 = 52;
      v8 = "Response/Data call back de-registration failed";
    }
    else if (a4 == 2)
    {
      v7 = 0;
      v11 = a2 + 24 * v17;
      *(_WORD *)v11 = 768;
      *(_BYTE *)(v11 + 2) = 15;
      *(_QWORD *)(v11 + 8) = 0;
      *(_QWORD *)(v11 + 16) = 0;
      v8 = "Response call back de-registration success";
    }
    else
    {
      v7 = 0;
      v12 = a2 + 24 * v17;
      *(_WORD *)v12 = 0;
      *(_QWORD *)(v12 + 8) = 0;
      *(_QWORD *)(v12 + 16) = 0;
      v8 = "Data call back de-registration success";
    }
  }
  else
  {
    v9 = 0;
    while (1)
    {
      if (sub_219852A68(v16, 0, a2, (unsigned __int8 *)a3, a4, &v17))
      {
        v13 = "End of list reached2";
        goto LABEL_19;
      }
      if (*(_QWORD *)(a3 + 16) == *(_QWORD *)(a2 + 24 * v17 + 16))
      {
        v7 = 0;
        v14 = a2 + 24 * v17;
        *(_WORD *)v14 = 768;
        *(_BYTE *)(v14 + 2) = 15;
        *(_QWORD *)(v14 + 8) = 0;
        *(_QWORD *)(v14 + 16) = 0;
        v8 = "Notification call back de-registration success";
        goto LABEL_20;
      }
      if (++v17 == 48)
        break;
      if (v9++ > 0x2E)
      {
        v7 = 52;
        goto LABEL_21;
      }
    }
    v13 = "End of list reached1";
LABEL_19:
    sub_219850628(0, (unsigned int *)&v18, 3u, 4u, (uint64_t)v13);
    v7 = 52;
    v8 = "Notification call back de-registration failed";
  }
LABEL_20:
  sub_219850628(0, (unsigned int *)&v18, 3u, 4u, (uint64_t)v8);
LABEL_21:
  sub_219850808(0, (unsigned int *)&v18, 3u, 5u, (uint64_t)"phNciNfc_CoreDeRegister");
  return v7;
}

uint64_t sub_219861274(unsigned int *a1, int a2)
{
  uint64_t i;
  unsigned int *v5;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrDeRegDataCb");
  if (a1)
  {
    for (i = 0; i != 18; i += 6)
    {
      v5 = &a1[i];
      if (*(_QWORD *)&a1[i + 550] && *((unsigned __int8 *)v5 + 2185) == a2)
      {
        *((_WORD *)v5 + 1092) = 0;
        *(_OWORD *)&a1[i + 548] = 0u;
        sub_219851790(1, a1 + 617, 3u, 4u, (uint64_t)"Deregistered data call back fun registered on                                logical connection");
      }
    }
  }
  return sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvMgrDeRegDataCb");
}

uint64_t sub_21986133C(uint64_t a1)
{
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreDeRegNciRes");
  if (a1)
  {
    *(_WORD *)(a1 + 1008) = 768;
    *(_BYTE *)(a1 + 1010) = 15;
    *(_QWORD *)(a1 + 1024) = 0;
    *(_QWORD *)(a1 + 1016) = 0;
  }
  return sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreDeRegNciRes");
}

uint64_t sub_2198613A8(uint64_t a1, uint64_t a2, _BYTE *a3, int a4)
{
  uint64_t v8;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ListenMgmt");
  if (!a2 || !a3 || !a1 || !a4)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)"Invalid input parameters");
    goto LABEL_8;
  }
  if (sub_21986147C((unsigned int *)a1, a2, a3, a4))
  {
LABEL_8:
    v8 = 1;
    goto LABEL_9;
  }
  *(_QWORD *)(a1 + 4512) = a2;
  v8 = sub_219859BD8(a1);
LABEL_9:
  sub_2198830EC((unsigned int *)a1, a2);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ListenMgmt");
  return v8;
}

uint64_t sub_21986147C(unsigned int *a1, uint64_t a2, _BYTE *a3, int a4)
{
  int v8;
  uint64_t v9;
  uint64_t v10;
  unsigned __int8 *v11;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateLstnMgmtRemDevInfo");
  if (a2 && a3 && a4)
  {
    *(_BYTE *)(a2 + 8) = *a3;
    v8 = a3[1];
    *(_DWORD *)(a2 + 12) = v8;
    if (v8)
    {
      v9 = 0;
      *(_DWORD *)(a2 + 16) = a3[2];
      *(_DWORD *)(a2 + 20) = a3[3];
      *(_BYTE *)(a2 + 24) = a3[4];
      *(_BYTE *)(a2 + 25) = a3[5];
      v10 = a3[6];
      *(_BYTE *)(a2 + 26) = v10;
      v11 = &a3[v10];
      *(_DWORD *)(a2 + 28) = v11[7];
      *(_BYTE *)(a2 + 32) = v11[8];
      *(_BYTE *)(a2 + 33) = v11[9];
    }
    else
    {
      sub_219850628(2, a1, 3u, 2u, (uint64_t)"Interface is NFCEE Direct RF,subsequent payload contents ignored..");
      v9 = 0;
    }
  }
  else
  {
    v9 = 1;
    sub_219850628(2, a1, 3u, 1u, (uint64_t)" Invalid Param(s)..");
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateLstnMgmtRemDevInfo");
  return v9;
}

uint64_t sub_219861598(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  unsigned int *v9;
  const char *v10;
  char v11;
  uint64_t v12;
  char v14;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReceiveData");
  if (!a1)
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Stack not initialized");
    v8 = 49;
    goto LABEL_22;
  }
  if (!a2)
  {
    v8 = 1;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid input parameter (Nci Context)!");
    goto LABEL_22;
  }
  *(_QWORD *)(a1 + 3384) = a2;
  *(_QWORD *)(a1 + 3712) = a3;
  if (*(_BYTE *)(a1 + 3288) != 1)
  {
    v14 = 0;
    if (sub_219878C88((unsigned int *)a1, *(_QWORD *)(a1 + 4512), &v14))
    {
      *(_QWORD *)(a1 + 3384) = 0;
      *(_QWORD *)(a1 + 3712) = 0;
      v9 = (unsigned int *)(a1 + 6476);
      v10 = "Couldn't Get ConnId!";
    }
    else
    {
      v11 = v14;
      BYTE4(v16) = v14;
      LODWORD(v15) = 0;
      sub_2198F3088((unsigned int *)(a1 + 888), (uint64_t)&v15, (uint64_t)sub_21985B810);
      BYTE5(v16) = 1;
      LODWORD(v15) = 0;
      BYTE4(v16) = v11;
      if (!sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v15, (uint64_t)sub_219861918, a1))
      {
        *(_BYTE *)(a1 + 3320) = 1;
        goto LABEL_21;
      }
      *(_QWORD *)(a1 + 3384) = 0;
      *(_QWORD *)(a1 + 3712) = 0;
      v9 = (unsigned int *)(a1 + 6476);
      v10 = "Data message call back registration failed!";
    }
    sub_219850628(1, v9, 3u, 1u, (uint64_t)v10);
    v8 = 255;
    goto LABEL_22;
  }
  v6 = phOsalNfc_Timer_Create();
  if (v6)
  {
    v7 = v6;
    if (v6 != 0xFFFFFFFFFFFFLL)
    {
      v12 = phOsalNfc_Timer_Start();
      if ((_DWORD)v12)
      {
        v8 = v12;
        phOsalNfc_Timer_Delete();
        goto LABEL_16;
      }
      *(_QWORD *)(a1 + 3312) = v7;
      *(_BYTE *)(a1 + 3320) = 1;
      *(_BYTE *)(a1 + 3288) = 0;
LABEL_21:
      v8 = 13;
      goto LABEL_22;
    }
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed to create Timer!");
  v8 = 255;
LABEL_16:
  *(_BYTE *)(a1 + 3288) = 0;
  *(_QWORD *)(a1 + 3384) = 0;
  *(_QWORD *)(a1 + 3712) = 0;
  if (*(_QWORD *)(a1 + 3296))
  {
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 3296) = 0;
  }
  *(_DWORD *)(a1 + 3304) = 16711680;
LABEL_22:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReceiveData");
  return v8;
}

uint64_t sub_2198617E8(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  void (*v10)(uint64_t, uint64_t, uint64_t *);
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;

  v12 = 0;
  v13 = 0;
  v14 = 0;
  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_TempReceiveCb");
  if (a2)
  {
    v3 = 0;
    v4 = 0;
    do
    {
      v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 4);
      if ((v3 & 1) != 0)
        break;
      v3 = 1;
      v4 = 1;
    }
    while (v5 != a2);
    if (v5 == a2)
    {
      *(_BYTE *)(a2 + 3320) = 0;
      v7 = *(_QWORD *)(a2 + 3312);
      if (v7)
      {
        if (v7 != 0xFFFFFFFFFFFFLL)
        {
          phOsalNfc_Timer_Stop();
          phOsalNfc_Timer_Delete();
          *(_QWORD *)(a2 + 3312) = 0xFFFFFFFFFFFFLL;
          v8 = *(_QWORD *)(a2 + 3296);
          v13 = v8;
          LODWORD(v14) = *(unsigned __int16 *)(a2 + 3304);
          v9 = *(unsigned __int16 *)(a2 + 3306);
          v10 = *(void (**)(uint64_t, uint64_t, uint64_t *))(a2 + 3384);
          v11 = *(_QWORD *)(a2 + 3712);
          *(_QWORD *)(a2 + 3384) = 0;
          *(_QWORD *)(a2 + 3712) = 0;
          if (v10)
          {
            v10(v11, v9, &v12);
            v8 = *(_QWORD *)(a2 + 3296);
          }
          if (v8)
          {
            phOsalNfc_FreeMemory();
            *(_QWORD *)(a2 + 3296) = 0;
          }
          *(_DWORD *)(a2 + 3304) = 16711680;
        }
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_TempReceiveCb");
}

uint64_t sub_219861918(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReceiveCb");
  if (a1)
  {
    *(_BYTE *)(a1 + 3320) = 0;
    v6 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 3384);
    if (v6)
      v6(*(_QWORD *)(a1 + 3712), a3, a2);
  }
  else
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Invalid context received from RecvMgrHdlr!");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReceiveCb");
  return a3;
}

uint64_t sub_2198619C0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8;
  __int128 v10;
  __int128 v11;

  v10 = 0u;
  v11 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendData");
  if (!a1)
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Stack not initialized");
    v8 = 49;
    goto LABEL_13;
  }
  if (!a2 || !a4)
  {
    v8 = 1;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid input parameter!");
    goto LABEL_13;
  }
  if (!*(_DWORD *)(a4 + 8) || !*(_QWORD *)a4)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid Send buffer!");
    goto LABEL_12;
  }
  *(_QWORD *)(a1 + 3384) = 0;
  *(_QWORD *)(a1 + 3712) = 0;
  phOsalNfc_SetMemory();
  LODWORD(v10) = 0;
  if (sub_219878C88((unsigned int *)a1, *(_QWORD *)(a1 + 4512), (_BYTE *)((unint64_t)&v10 | 0xC)))
  {
LABEL_12:
    v8 = 255;
    goto LABEL_13;
  }
  *(_QWORD *)&v11 = *(_QWORD *)a4;
  DWORD2(v11) = *(_DWORD *)(a4 + 8);
  v8 = sub_2198F2E28(a1 + 888, &v10, (uint64_t)sub_219861B50, a1);
  if ((_DWORD)v8 == 13)
  {
    *(_BYTE *)(a1 + 3321) = 1;
    *(_QWORD *)(a1 + 3384) = a2;
    *(_QWORD *)(a1 + 3712) = a3;
  }
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendData");
  return v8;
}

uint64_t sub_219861B50(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, _QWORD);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendCb");
  if (a1)
  {
    *(_BYTE *)(a1 + 3321) = 0;
    sub_21985B708(a1);
    v5 = *(void (**)(_QWORD, uint64_t, _QWORD))(a1 + 3384);
    if (v5)
      v5(*(_QWORD *)(a1 + 3712), a3, 0);
    if (*(_QWORD *)(a1 + 4600))
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"De-allocating Send Request Payload Buffer...");
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 4600) = 0;
      *(_DWORD *)(a1 + 4608) = 0;
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Invalid context received from RecvMgrHdlr!");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendCb");
  return a3;
}

uint64_t sub_219861C30(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, char a6, int a7)
{
  uint64_t v14;
  unsigned int v16;
  _OWORD v17[10];
  __int128 v18;
  uint64_t v19;
  _OWORD v20[2];

  memset(v20, 0, sizeof(v20));
  v19 = 0;
  v18 = 0u;
  memset(v17, 0, sizeof(v17));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SeSendData");
  if (a1)
  {
    if (a3 && a2 && a4)
    {
      phOsalNfc_SetMemory();
      *(_QWORD *)&v20[0] = 0;
      DWORD2(v20[0]) = 0;
      if (sub_219878C88((unsigned int *)a1, a3, (_BYTE *)((unint64_t)v20 | 0xC)))
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)" Couldn't Get ConnId!");
        v14 = 255;
      }
      else
      {
        phOsalNfc_SetMemory();
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
        BYTE14(v18) = 1;
        *(_BYTE *)(a1 + 6568) = a6;
        if (a7 == 3)
          v16 = 3;
        else
          v16 = 1;
        v14 = sub_21987EC70(a1, v16, (uint64_t)v17, (uint64_t)sub_219861E34, a1);
        if ((_DWORD)v14 == 13)
        {
          *(_QWORD *)(a1 + 3720) = a4;
          *(_QWORD *)(a1 + 3728) = a5;
        }
        else
        {
          *(_BYTE *)(a1 + 6568) = 0;
        }
      }
    }
    else
    {
      v14 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid input parameter!");
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Stack not initialized");
    v14 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SeSendData");
  return v14;
}

uint64_t sub_219861E34(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(uint64_t, uint64_t, _QWORD);
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SeSendCb");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 4600))
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"De-allocating Send Request Payload Buffer...");
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 4600) = 0;
      *(_DWORD *)(a1 + 4608) = 0;
    }
    v5 = *(void (**)(uint64_t, uint64_t, _QWORD))(a1 + 3720);
    v6 = *(_QWORD *)(a1 + 3728);
    *(_OWORD *)(a1 + 3720) = 0u;
    if (v5)
      v5(v6, a3, 0);
  }
  else
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Invalid context received from RecvMgrHdlr!");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SeSendCb");
  return a3;
}

uint64_t sub_219861F14(uint64_t a1, uint64_t a2)
{
  int v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ListenMgmt_DeActivate");
  if (a1)
  {
    if (a2)
    {
      v4 = *(_DWORD *)(a2 + 20);
      if (((v4 - 128) < 4 || v4 == 133) && *(_BYTE *)(a1 + 3288) == 1)
      {
        *(_BYTE *)(a1 + 3288) = 0;
        if (*(_QWORD *)(a1 + 3296))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(a1 + 3296) = 0;
        }
        *(_DWORD *)(a1 + 3304) = 9568256;
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ListenMgmt_DeActivate");
}

uint64_t sub_219861FB4(uint64_t a1, uint64_t a2, uint64_t a3, int a4)
{
  uint64_t v8;
  int v9;
  uint64_t v10;
  int v11;
  uint64_t v12;
  char v13;
  int v14;
  uint64_t (**v15)(uint64_t);
  uint64_t (*v16)(uint64_t);
  uint64_t (*v17)(uint64_t, int);
  uint64_t v18;
  unsigned int v19;
  uint64_t v20;
  unsigned int v21;
  char v22;
  uint64_t v23;
  char v24;
  unsigned int v25;
  unsigned int v26;
  uint64_t v27;
  int v29;

  v29 = 26;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RdrAInit");
  if (a1 && a2 && a3 && a4)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" NFC-A Passive Poll Mode Info being captured..");
    v8 = *(unsigned __int8 *)(a3 + 6);
    if (*(_DWORD *)(a2 + 20) == 128)
    {
      v9 = 0;
      LODWORD(v10) = 0;
      v11 = 0;
      goto LABEL_19;
    }
    v10 = *(unsigned __int8 *)(a3 + 9);
    if (v10 <= 0xA && (v13 = 1, ((1 << v10) & 0x491) != 0))
    {
      v12 = 0;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid Nfc-A UID length");
      v13 = 0;
      v12 = 255;
    }
    v11 = 0;
    if (v10 > 0xA)
      goto LABEL_18;
    v9 = 0;
    if (((1 << v10) & 0x491) == 0)
      goto LABEL_16;
    v11 = *(unsigned __int8 *)(a3 + v10 + 10);
    if (*(_BYTE *)(a3 + v10 + 10))
    {
      if (v11 == 1)
      {
        v9 = *(unsigned __int8 *)(a3 + v10 + 11);
LABEL_16:
        if ((v13 & 1) == 0)
          goto LABEL_24;
LABEL_19:
        sub_2198592E8((unsigned int *)a1, v9, v11, (_DWORD *)a2, &v29);
        v14 = v29;
        *(_DWORD *)(a2 + 4) = v29;
        if ((v14 - 3) >= 0xC)
        {
          if (v14 != 19)
          {
            v12 = 0;
LABEL_30:
            switch(v14)
            {
              case 3:
              case 5:
              case 6:
              case 7:
                if ((_DWORD)v12)
                  goto LABEL_54;
                if (*(_DWORD *)(a2 + 12) == 2
                  && (v18 = v8 + a3, v19 = *(unsigned __int8 *)(v8 + a3 + 10), *(_BYTE *)(v8 + a3 + 10)))
                {
                  v21 = *(unsigned __int8 *)(v18 + 11);
                  v20 = v18 + 11;
                  *(_BYTE *)(a2 + 104) = v21;
                  if (v19 <= v21)
                  {
                    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid RATS Resp Recvd!!");
                    v12 = 255;
                  }
                  else
                  {
                    phOsalNfc_SetMemory();
                    if (*(_BYTE *)(a2 + 104))
                    {
                      v23 = v20 + 1;
                      v22 = *(_BYTE *)(v20 + 1);
                      *(_BYTE *)(a2 + 105) = v22;
                      *(_BYTE *)(a2 + 106) = sub_219862404((unsigned int *)a1, v22 & 0xF);
                      v24 = *(_BYTE *)(a2 + 105);
                      v25 = *(unsigned __int8 *)(a2 + 104);
                      v26 = 1;
                      if ((v24 & 0x10) != 0 && v25 >= 2)
                      {
                        *(_BYTE *)(a2 + 107) = *(_BYTE *)(v20 + 2);
                        v26 = 2;
                      }
                      if ((v24 & 0x20) != 0 && v25 > v26)
                        *(_BYTE *)(a2 + 108) = *(_BYTE *)(v23 + v26++);
                      if ((v24 & 0x40) != 0 && v25 > v26)
                      {
                        *(_BYTE *)(a2 + 109) = *(_BYTE *)(v23 + v26);
                        LOBYTE(v26) = v26 + 1;
                      }
                      phOsalNfc_MemCopy();
                      *(_BYTE *)(a2 + 125) = *(_BYTE *)(a2 + 104) - v26;
                    }
                    v12 = 0;
                    *(_BYTE *)(a2 + 100) = *(_BYTE *)(a2 + 108);
                  }
                }
                else
                {
                  v12 = 0;
                }
                v15 = *(uint64_t (***)(uint64_t))(a1 + 4760);
                v16 = sub_2198DB9A8;
                v17 = sub_2198DB87C;
                goto LABEL_51;
              case 4:
              case 8:
              case 9:
              case 10:
              case 11:
              case 12:
              case 13:
              case 14:
                if ((_DWORD)v12)
                  goto LABEL_54;
                v15 = *(uint64_t (***)(uint64_t))(a1 + 4760);
                v16 = sub_2198ACB0C;
                v17 = sub_2198AD2CC;
                goto LABEL_51;
              case 19:
                if ((_DWORD)v12)
                {
LABEL_54:
                  v12 = 1;
                }
                else
                {
                  v12 = sub_21988B150(*(_QWORD *)(a1 + 6480), (_BYTE *)(a2 + 47));
                  v15 = *(uint64_t (***)(uint64_t))(a1 + 4760);
                  v16 = sub_21988B55C;
                  v17 = sub_21988B1D0;
LABEL_51:
                  *v15 = v16;
                  v15[1] = (uint64_t (*)(uint64_t))v17;
                }
                break;
              default:
                goto LABEL_55;
            }
            goto LABEL_55;
          }
          if (!(_DWORD)v10)
            goto LABEL_22;
        }
        else if ((_DWORD)v10)
        {
          *(_BYTE *)(a2 + 46) = v10;
          *(_BYTE *)(a2 + 103) = v11;
          *(_BYTE *)(a2 + 96) = v9;
          phOsalNfc_MemCopy();
          phOsalNfc_SetMemory();
LABEL_22:
          phOsalNfc_MemCopy();
          v12 = 0;
LABEL_29:
          v14 = *(_DWORD *)(a2 + 4);
          goto LABEL_30;
        }
        v12 = 1;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid UID Length received");
        goto LABEL_29;
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid Nfc-A SEL_RES length");
      v12 = 255;
    }
    else
    {
LABEL_18:
      v9 = v11;
      if ((v13 & 1) != 0)
        goto LABEL_19;
    }
LABEL_24:
    *(_DWORD *)(a2 + 4) = 26;
LABEL_55:
    v27 = *(_QWORD *)(a1 + 4760);
    *(_QWORD *)(v27 + 16) = 0;
    *(_QWORD *)(v27 + 24) = sub_2198F14B0;
    goto LABEL_56;
  }
  sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)" Invalid Params..");
  v12 = 1;
LABEL_56:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RdrAInit");
  return v12;
}

uint64_t sub_219862404(unsigned int *a1, unsigned int a2)
{
  unsigned __int8 v4;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_H_CalcFSC");
  if (a2 >= 8)
    v4 = -3;
  else
    v4 = 0x7D5D3D2D251D150DuLL >> (8 * a2);
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_H_CalcFSC");
  return v4;
}

uint64_t sub_21986248C(unsigned int *a1, uint64_t a2, uint64_t a3, int a4)
{
  uint64_t v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_RdrKovioInit");
  if (a2 && a3 && a4)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)" NFC-A Passive Poll Mode Info being captured..");
    if (*(_BYTE *)(a3 + 6) == 16)
    {
      *(_DWORD *)(a2 + 4) = 22;
      *(_BYTE *)(a2 + 36) = 16;
      phOsalNfc_SetMemory();
      phOsalNfc_MemCopy();
    }
    else
    {
      sub_219850628(2, a1, 3u, 4u, (uint64_t)" Invalid Params: Kovio TagId < 16 Bytes..");
    }
    v8 = 0;
  }
  else
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)" Invalid Params..");
    v8 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_RdrKovioInit");
  return v8;
}

uint64_t sub_2198625B4(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  int v7;
  uint64_t v8;
  int v9;
  uint64_t v10;
  _BYTE *v11;
  int v12;
  uint64_t v13;
  int v14;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_Iso15693Map");
  if (*(_DWORD *)a2 >= 2u)
  {
    if (*(_DWORD *)a2 != 32)
    {
      v10 = 1;
      sub_219850628(2, a1, 4u, 1u, (uint64_t)"Error: Iso15693 command not defined");
      goto LABEL_15;
    }
    v11 = *(_BYTE **)(a2 + 32);
    if (v11)
    {
      v12 = *(_DWORD *)(a2 + 40);
      if (v12)
      {
        v13 = *(_QWORD *)(a2 + 48);
        if (v13)
        {
          v14 = *(_DWORD *)(a2 + 56);
          if (v14)
          {
            v10 = 0;
            *(_QWORD *)(a3 + 16) = v11;
            *(_QWORD *)(a3 + 32) = v13;
            *(_DWORD *)(a3 + 24) = v12;
            *(_DWORD *)(a3 + 40) = v14;
            *(_DWORD *)a3 = 0;
            *v11 |= 2u;
            goto LABEL_15;
          }
        }
      }
    }
LABEL_13:
    v10 = 1;
    goto LABEL_15;
  }
  v6 = *(_QWORD *)(a2 + 32);
  if (!v6)
    goto LABEL_13;
  v7 = *(_DWORD *)(a2 + 40);
  if (!v7)
    goto LABEL_13;
  v8 = *(_QWORD *)(a2 + 48);
  if (!v8)
    goto LABEL_13;
  v9 = *(_DWORD *)(a2 + 56);
  if (!v9)
    goto LABEL_13;
  v10 = 0;
  *(_QWORD *)(a3 + 16) = v6;
  *(_QWORD *)(a3 + 32) = v8;
  *(_DWORD *)(a3 + 24) = v7;
  *(_DWORD *)(a3 + 40) = v9;
  *(_DWORD *)a3 = *(_DWORD *)a2;
  *(_WORD *)(a3 + 8) = *(_WORD *)(a2 + 8);
LABEL_15:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_Iso15693Map");
  return v10;
}

uint64_t sub_2198626E8(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemoteDevIso15693");
  if (a1 && a2 && a3)
  {
    if (*(_BYTE *)(a3 + 8) == 8)
      sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"Valid ISO15693 UID length received");
    else
      sub_219850628(1, a1 + 4842, 4u, 1u, (uint64_t)"Invalid ISO15693 UID length");
    if (*(unsigned __int8 *)(a3 + 8) >= 9u)
    {
      v6 = 1;
    }
    else
    {
      phOsalNfc_MemCopy();
      v6 = 0;
      *(_BYTE *)(a2 + 8) = *(_BYTE *)(a3 + 8);
    }
    *(_BYTE *)(a2 + 11) = *(_BYTE *)(a3 + 11);
    *(_WORD *)(a2 + 9) = *(_WORD *)(a3 + 9);
    sub_219851FF8(1, a1 + 4842, 4u, 4u, (uint64_t)"Received UID", a2);
    sub_219851888(1, a1 + 4842, 4u, 4u, (uint64_t)"UID length");
    sub_219851888(1, a1 + 4842, 4u, 4u, (uint64_t)"AFI");
    sub_219851888(1, a1 + 4842, 4u, 4u, (uint64_t)"DSFID");
    sub_219851888(1, a1 + 4842, 4u, 4u, (uint64_t)"Flags");
  }
  else
  {
    v6 = 1;
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"Invalid input parameter!");
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemoteDevIso15693");
  return v6;
}

uint64_t sub_2198628BC(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendDiscSelCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0x100000001;
    DWORD2(v4) = 4;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 160);
    DWORD2(v5) = *(unsigned __int8 *)(a1 + 168);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21986323C, a1);
    if ((_DWORD)v2 == 13)
      *(_BYTE *)(a1 + 177) = 1;
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendDiscSelCmd");
  return v2;
}

uint64_t sub_219862998(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v6;
  uint64_t v7;

  v6 = 0;
  v7 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteDiscSelSequence");
  if (a1)
  {
    *(_BYTE *)(a1 + 177) = 0;
    if (*(_QWORD *)(a1 + 160))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 160) = 0;
      *(_BYTE *)(a1 + 168) = 0;
    }
    if (!(_DWORD)a2)
    {
      *(_QWORD *)(a1 + 720) = *(_QWORD *)(a1 + 3384);
      *(_QWORD *)(a1 + 728) = *(_QWORD *)(a1 + 3712);
      v6 = 3;
      LODWORD(v7) = 7;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v6, (uint64_t)sub_21985ADB8, a1);
      v4 = *(_QWORD *)(a1 + 4656);
      if (v4 != 0xFFFFFFFFFFFFLL)
      {
        sub_21988C4AC(*(_DWORD *)(a1 + 6476), v4);
        *(_BYTE *)(a1 + 6464) = 0;
        a2 = phOsalNfc_Timer_Start();
        if ((_DWORD)a2)
          goto LABEL_11;
        sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_CompleteDiscSelSequence");
        *(_QWORD *)(a1 + 3384) = 0;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Select ntf timer started\n");
      }
      a2 = 0;
      goto LABEL_11;
    }
    sub_2198E23C4(a1, a2, 0);
  }
  else
  {
    a2 = 255;
  }
LABEL_11:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteDiscSelSequence");
  return a2;
}

uint64_t sub_219862B18(uint64_t a1)
{
  int v2;
  uint64_t v3;
  __int128 v5;
  __int128 v6;

  v5 = 0u;
  v6 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_EnableDiscovery");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v5 = 0x100000001;
    DWORD2(v5) = 3;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Building Header bytes for Discover Command");
    *(_QWORD *)&v6 = *(_QWORD *)(a1 + 160);
    v2 = *(unsigned __int8 *)(a1 + 168);
    DWORD2(v6) = v2;
    sub_219880628((unsigned int *)a1, (unsigned __int8 *)v6, v2);
    v3 = sub_2198F2D0C(a1 + 888, (uint64_t)&v5, a1 + 3760, 2000, (uint64_t)sub_2198631AC, a1);
  }
  else
  {
    v3 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_EnableDiscovery");
  return v3;
}

uint64_t sub_219862C18(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteDiscSequence");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 160))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 160) = 0;
    }
    if (!(_DWORD)a2 && *(unsigned __int8 *)(a1 + 168) >= 2u)
      *(_BYTE *)(a1 + 176) = 1;
    sub_2198E23C4(a1, a2, 0);
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteDiscSequence");
  return a2;
}

uint64_t sub_219862CBC(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DeActivateRemDev");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0x100000001;
    DWORD2(v4) = 6;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Building Header bytes for Deactivate Command");
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21986311C, a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Invalid input parameter");
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DeActivateRemDev");
  return v2;
}

uint64_t sub_219862DC8(uint64_t a1, uint64_t a2)
{
  unsigned __int8 *v4;
  int v5;
  uint64_t v6;
  unsigned int *v7;
  const char *v8;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DeActivateRsp");
  if (!a1 || (_DWORD)a2)
    goto LABEL_14;
  v4 = *(unsigned __int8 **)(a1 + 3760);
  if (!v4 || *(_DWORD *)(a1 + 3768) != 1)
  {
    v7 = (unsigned int *)(a1 + 6476);
    v8 = "Invalid parameters (phNciNfc_DeActivateRsp)\n";
LABEL_13:
    sub_219850628(1, v7, 3u, 1u, (uint64_t)v8);
    a2 = 255;
    goto LABEL_14;
  }
  v5 = *v4;
  if (v5 == 241)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Suica express transaction ongoing");
    a2 = 81;
    goto LABEL_14;
  }
  if (v5 == 6)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"NFCC is in RFST_IDLE state");
    a2 = 58;
    goto LABEL_14;
  }
  if (v5)
  {
    v7 = (unsigned int *)(a1 + 6476);
    v8 = "Invalid response (phNciNfc_DeActivateRsp)\n";
    goto LABEL_13;
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Deactivate process success");
  if (*(_BYTE *)(a1 + 6473) == 1)
  {
    v6 = *(_QWORD *)(a1 + 3384);
    if (v6)
    {
      *(_QWORD *)(a1 + 736) = v6;
      *(_QWORD *)(a1 + 744) = *(_QWORD *)(a1 + 3712);
    }
    a2 = 0;
    *(_BYTE *)(a1 + 6473) = 0;
  }
  else
  {
    a2 = 0;
  }
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DeActivateRsp");
  return a2;
}

uint64_t sub_219862F3C(uint64_t a1, uint64_t a2)
{
  _QWORD *v4;
  uint64_t v5;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteDeactivate");
  if (!a1)
  {
    a2 = 255;
    goto LABEL_8;
  }
  if (*(_QWORD *)(a1 + 848))
  {
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 848) = 0;
    *(_DWORD *)(a1 + 856) = 0;
  }
  v4 = (_QWORD *)(a1 + 736);
  if (!(_DWORD)a2)
  {
    if (!*v4)
    {
      sub_2198636E8(a1);
      *(_WORD *)(a1 + 6666) = 0;
      sub_2198E23C4(a1, 0, a1 + 6666);
      a2 = 0;
      goto LABEL_8;
    }
    v7 = *(_QWORD *)(a1 + 4656);
    if (v7 == 0xFFFFFFFFFFFFLL)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Timer Create had failed\n#\n");
      v5 = a1 + 6666;
      *v4 = 0;
      *(_QWORD *)(a1 + 744) = 0;
      a2 = 255;
      goto LABEL_6;
    }
    sub_21988C4AC(*(_DWORD *)(a1 + 6476), v7);
    *(_BYTE *)(a1 + 6464) = 0;
    a2 = phOsalNfc_Timer_Start();
    if (!(_DWORD)a2)
    {
      sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_CompleteDeactivate");
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Deactivate ntf timer started\n");
      *(_QWORD *)(a1 + 3384) = 0;
      goto LABEL_8;
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Deactivate ntf timer start FAILED\n\n");
  }
  v5 = a1 + 6666;
  *v4 = 0;
  *(_QWORD *)(a1 + 744) = 0;
LABEL_6:
  *(_WORD *)(a1 + 6666) = a2;
  sub_2198E23C4(a1, 0, v5);
LABEL_8:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteDeactivate");
  return a2;
}

uint64_t sub_21986311C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DeactivateSequence");
  if (a1 && a2)
  {
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DeactivateSequence");
  return v6;
}

uint64_t sub_2198631AC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DiscoverSequence");
  if (a1 && a2)
  {
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DiscoverSequence");
  return v6;
}

uint64_t sub_21986323C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DiscSelSequence");
  if (a1 && a2)
  {
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DiscSelSequence");
  return v6;
}

uint64_t sub_2198632CC(unsigned int *a1, uint64_t a2, int a3)
{
  uint64_t v6;
  int v7;
  unsigned int v8;
  BOOL v9;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateSuppDeActvType");
  v6 = 0;
  if (a3 && a3 != 3)
  {
    v7 = *(_DWORD *)(a2 + 12);
    if (v7 > 2)
    {
      if (v7 != 128)
      {
        if (v7 != 3)
          goto LABEL_20;
        if (a3 == 2 && *(_DWORD *)(a2 + 20) < 3u)
          goto LABEL_25;
LABEL_16:
        v9 = a3 == 4;
LABEL_17:
        if (v7 == 2 && v9)
          v6 = 0;
        else
          v6 = 255;
        goto LABEL_26;
      }
    }
    else
    {
      if (v7 < 2)
        goto LABEL_25;
      if (v7 != 2)
      {
LABEL_20:
        v9 = a3 == 4;
        if (a3 != 4 || v7 != 131)
          goto LABEL_17;
LABEL_25:
        v6 = 0;
        goto LABEL_26;
      }
    }
    v8 = *(_DWORD *)(a2 + 20);
    if (v8 <= 0xB && ((1 << v8) & 0xC07) != 0)
    {
      if (a3 == 1)
        goto LABEL_25;
    }
    else if (a3 == 1 && v8 == 12)
    {
      goto LABEL_25;
    }
    goto LABEL_16;
  }
LABEL_26:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateSuppDeActvType");
  return v6;
}

uint64_t sub_219863404(uint64_t a1, uint64_t a2, int a3, int *a4)
{
  uint64_t v8;
  _DWORD *v10;
  int v11;
  uint64_t v12;
  uint64_t v13;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateDeActvType");
  if (*(_DWORD *)(a1 + 200) != 1 && *(_BYTE *)(a1 + 6609) != 1)
  {
    v11 = *(_DWORD *)(a2 + 24);
    v10 = (_DWORD *)(a2 + 24);
    if (!v11)
    {
      if (a3)
      {
        *a4 = a3;
        v12 = *(_QWORD *)(a1 + 3384);
        *(_QWORD *)(a1 + 744) = *(_QWORD *)(a1 + 3712);
      }
      else
      {
        v12 = 0;
        *a4 = 0;
      }
      *(_QWORD *)(a1 + 736) = v12;
      if (!*v10)
      {
        v8 = 0;
        goto LABEL_5;
      }
    }
    v13 = 0;
    if (sub_219863550((unsigned int *)a1, v10, 0, &v13, 1))
    {
      v8 = 0;
      *a4 = a3;
    }
    else
    {
      v8 = sub_2198632CC((unsigned int *)a1, v13, a3);
      if ((_DWORD)v8)
        goto LABEL_5;
      if (a3 != 4)
      {
        v8 = 0;
        *a4 = a3;
        goto LABEL_4;
      }
      v8 = 0;
      *a4 = 4;
    }
    *(_QWORD *)(a1 + 736) = 0;
    goto LABEL_5;
  }
  v8 = 0;
LABEL_4:
  *(_QWORD *)(a1 + 736) = *(_QWORD *)(a1 + 3384);
  *(_QWORD *)(a1 + 744) = *(_QWORD *)(a1 + 3712);
LABEL_5:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateDeActvType");
  return v8;
}

uint64_t sub_219863550(unsigned int *a1, _DWORD *a2, int a3, _QWORD *a4, int a5)
{
  uint64_t i;
  _BYTE *v11;
  uint64_t v12;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_RetrieveRemDevInfo");
  if (*a2)
  {
    for (i = 2; i != 22; i += 2)
    {
      v11 = *(_BYTE **)&a2[i];
      if (v11)
      {
        if (a5 == 1)
        {
          if (*v11 == 1)
            goto LABEL_10;
        }
        else if (v11[8] == a3)
        {
LABEL_10:
          v12 = 0;
          *a4 = v11;
          goto LABEL_11;
        }
      }
    }
  }
  v12 = 255;
LABEL_11:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_RetrieveRemDevInfo");
  return v12;
}

uint64_t sub_21986361C(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;

  v6 = 0;
  v7 = 0;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_HandlePriorityDeactv");
  if (a1 && a2)
  {
    if (*(_DWORD *)(a2 + 24))
    {
      v8 = 0;
      if (sub_219863550(a1, (_DWORD *)(a2 + 24), 0, &v8, 1))
        return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_HandlePriorityDeactv");
      v4 = v8;
    }
    else
    {
      v4 = *(_QWORD *)(a2 + 32);
      if (!v4)
        return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_HandlePriorityDeactv");
    }
    if (*(_DWORD *)(v4 + 4) == 23)
    {
      BYTE4(v7) = 0;
      LODWORD(v6) = 0;
      sub_2198F3088(a1 + 222, (uint64_t)&v6, (uint64_t)sub_2198F135C);
    }
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_HandlePriorityDeactv");
}

uint64_t sub_2198636E8(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  _BYTE *v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessDeActvState");
  if (a1)
  {
    phOsalNfc_MemCopy();
    if (*(_BYTE *)(a1 + 176) == 1)
    {
      if (*(_DWORD *)(a1 + 72))
      {
        v2 = 255;
        goto LABEL_11;
      }
      sub_219863C78(a1);
      v2 = 0;
      if (*(_BYTE *)(a1 + 176))
      {
LABEL_11:
        if (*(_DWORD *)(a1 + 72))
        {
          v6 = 0;
          v3 = sub_219863550((unsigned int *)a1, (_DWORD *)(a1 + 72), 0, &v6, 1);
          if (!(_DWORD)v3)
          {
            v4 = sub_219863B80(a1, v6);
            goto LABEL_16;
          }
          v2 = v3;
          if (!*(_DWORD *)(a1 + 172))
          {
            sub_219863C78(a1);
            v4 = sub_2198F13EC(a1);
LABEL_16:
            v2 = v4;
          }
        }
        phOsalNfc_MemCopy();
        goto LABEL_18;
      }
    }
    else
    {
      v2 = 255;
      if (*(_BYTE *)(a1 + 176))
        goto LABEL_11;
    }
    if (!*(_DWORD *)(a1 + 72))
      v2 = sub_2198ABA50((unsigned int *)a1, (unsigned __int8 *)(a1 + 3944));
    goto LABEL_11;
  }
  v2 = 255;
LABEL_18:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessDeActvState");
  return v2;
}

uint64_t sub_21986383C(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  _BYTE *v8;
  void (*v9)(_QWORD, _QWORD, uint64_t);

  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_DeactNtfTimeoutHandler");
  if (!a2)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 4);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a2);
  if (v6 == a2)
  {
    v8 = (_BYTE *)(a2 + 6464);
    if (!*(_BYTE *)(a2 + 6464))
    {
      phOsalNfc_Timer_Stop();
      if (!phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"Deactivate ntf timer restarted for extended time\n");
        *v8 = 1;
        return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_DeactNtfTimeoutHandler");
      }
      sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 1u, (uint64_t)"Deactivate ntf timer failed to start for extended time\n\n");
    }
    sub_21988629C(2, (unsigned int *)a2, a1, 3u, 4u, (uint64_t)"phNciNfc_DeactNtfTimeoutHandler");
    sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"#######Deactivate notification TIMEOUT########\n");
    phOsalNfc_Timer_Stop();
    *v8 = 0;
    v9 = *(void (**)(_QWORD, _QWORD, uint64_t))(a2 + 736);
    if (v9)
    {
      *(_QWORD *)(a2 + 736) = 0;
      *(_WORD *)(a2 + 6666) = 47;
      v9(*(_QWORD *)(a2 + 744), 0, a2 + 6666);
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 3u, 1u, (uint64_t)"Nci context null (phNciNfc_DeactNtfTimeoutHandler)\n");
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_DeactNtfTimeoutHandler");
}

uint64_t sub_219863A04(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  _BYTE *v7;
  void (*v8)(_QWORD, uint64_t, _QWORD);

  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SelectNtfTimeoutHandler");
  if (a2)
  {
    v4 = 0;
    v5 = 0;
    do
    {
      v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 4);
      if ((v4 & 1) != 0)
        break;
      v4 = 1;
      v5 = 1;
    }
    while (v6 != a2);
    if (v6 == a2)
    {
      v7 = (_BYTE *)(a2 + 6464);
      if (!*(_BYTE *)(a2 + 6464))
      {
        phOsalNfc_Timer_Stop();
        if (!phOsalNfc_Timer_Start())
        {
          sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"Select ntf timer restarted for extended time\n");
          *v7 = 1;
          return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SelectNtfTimeoutHandler");
        }
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"Select ntf timer failed to start for extended time\n");
      }
      sub_21988629C(2, (unsigned int *)a2, a1, 3u, 4u, (uint64_t)"phNciNfc_SelectNtfTimeoutHandler");
      phOsalNfc_Timer_Stop();
      *v7 = 0;
      v8 = *(void (**)(_QWORD, uint64_t, _QWORD))(a2 + 720);
      if (v8)
      {
        *(_QWORD *)(a2 + 720) = 0;
        v8(*(_QWORD *)(a2 + 728), 255, 0);
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SelectNtfTimeoutHandler");
}

uint64_t sub_219863B80(uint64_t a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessActivatedIfDeActv");
  if (a1)
  {
    sub_219861F14(a1, (uint64_t)a2);
    v4 = 0;
    switch(*(_DWORD *)(a1 + 172))
    {
      case 0:
        v4 = sub_2198F13EC(a1);
        sub_219863C78(a1);
        break;
      case 1:
      case 2:
        *a2 = 0;
        v4 = sub_2198F13EC(a1);
        break;
      case 3:
        if (sub_2198F13EC(a1))
          goto LABEL_7;
        sub_219863C78(a1);
        v4 = 0;
        *(_BYTE *)(a1 + 176) = 1;
        break;
      case 4:
        break;
      default:
LABEL_7:
        v4 = 255;
        break;
    }
  }
  else
  {
    v4 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessActivatedIfDeActv");
  return v4;
}

uint64_t sub_219863C78(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ClearDiscContext");
  if (a1)
  {
    v2 = 0;
    v3 = a1 + 80;
    do
    {
      if (*(_QWORD *)(v3 + v2))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v3 + v2) = 0;
      }
      v2 += 8;
    }
    while (v2 != 80);
    *(_QWORD *)(a1 + 4512) = 0;
    if (*(_QWORD *)(a1 + 160))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 160) = 0;
    }
    phOsalNfc_SetMemory();
  }
  else
  {
    sub_219850628(1, (unsigned int *)0x194C, 3u, 1u, (uint64_t)"phNciNfc_ClearDiscContext: NULL NCI context");
  }
  return sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ClearDiscContext");
}

uint64_t sub_219863D4C(unsigned int *a1, _DWORD *a2, uint64_t a3, int a4)
{
  uint64_t v8;
  uint64_t v9;
  BOOL v10;
  uint64_t v11;
  int v12;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateNtfList");
  if (a4 == 1 && *a2 > 9u)
  {
LABEL_12:
    v11 = 255;
    goto LABEL_15;
  }
  v8 = 2;
  while (1)
  {
    v9 = *(_QWORD *)&a2[v8];
    if (a4 != 1)
      break;
    if (!v9)
    {
      v12 = 1;
      goto LABEL_14;
    }
LABEL_11:
    v8 += 2;
    if (v8 == 22)
      goto LABEL_12;
  }
  if (v9)
    v10 = v9 == a3;
  else
    v10 = 0;
  if (!v10)
    goto LABEL_11;
  a3 = 0;
  v12 = -1;
LABEL_14:
  v11 = 0;
  *a2 += v12;
  *(_QWORD *)&a2[v8] = a3;
LABEL_15:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateNtfList");
  return v11;
}

uint64_t sub_219863E28(uint64_t a1, _BYTE *a2)
{
  int v4;
  unsigned int v5;
  uint64_t v6;
  uint64_t v7;
  int v8;
  char v9;
  uint64_t v10;
  uint64_t v11;
  char v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;
  uint64_t v21;
  uint64_t v22;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateDiscConfigParams");
  v4 = (char)a2[18];
  v5 = 1;
  if ((v4 & 0x80000000) == 0)
  {
    if ((v4 & 0x20) == 0)
      goto LABEL_4;
    goto LABEL_3;
  }
  *(_BYTE *)(*(_QWORD *)(a1 + 160) + 1) = -1;
  *(_BYTE *)(*(_QWORD *)(a1 + 160) + 2) = 1;
  v5 = 3;
  if ((a2[18] & 0x20) != 0)
  {
LABEL_3:
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 3;
    v6 = *(_QWORD *)(a1 + 160) + v5;
    v5 += 2;
    *(_BYTE *)(v6 + 1) = 1;
  }
LABEL_4:
  if ((*a2 & 1) != 0)
  {
    if (a2[1] - 1 > 9)
    {
      v9 = 0;
      v8 = 1;
      goto LABEL_15;
    }
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 0;
    v7 = *(_QWORD *)(a1 + 160) + v5;
    v5 += 2;
    *(_BYTE *)(v7 + 1) = *(_BYTE *)(a1 + 49);
  }
  if ((a2[2] & 1) != 0)
  {
    v8 = 1;
    if (a2[3] - 1 > 9)
    {
      v9 = 0;
    }
    else
    {
      *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 1;
      v10 = *(_QWORD *)(a1 + 160) + v5;
      v5 += 2;
      *(_BYTE *)(v10 + 1) = *(_BYTE *)(a1 + 51);
      v9 = 1;
      v8 = 0;
    }
  }
  else
  {
    v8 = 0;
    v9 = 1;
  }
LABEL_15:
  if ((a2[18] & 0x40) != 0)
  {
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 5;
    v11 = *(_QWORD *)(a1 + 160) + v5;
    v5 += 2;
    *(_BYTE *)(v11 + 1) = 1;
  }
  v12 = v9 ^ 1;
  if ((a2[4] & 1) == 0)
    v12 = 1;
  if ((v12 & 1) == 0)
  {
    if (a2[5] - 1 > 9)
      goto LABEL_43;
    v8 = 0;
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 2;
    v13 = *(_QWORD *)(a1 + 160) + v5;
    v5 += 2;
    *(_BYTE *)(v13 + 1) = *(_BYTE *)(a1 + 53);
  }
  if (!v8 && (a2[12] & 1) != 0)
  {
    if (a2[13] - 1 > 9)
      goto LABEL_43;
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 114;
    v14 = *(_QWORD *)(a1 + 160) + v5;
    v5 += 2;
    *(_BYTE *)(v14 + 1) = *(_BYTE *)(a1 + 61);
  }
  if (!v8 && (a2[14] & 1) != 0)
  {
    if (a2[15] - 1 > 9)
      goto LABEL_43;
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 6;
    v15 = *(_QWORD *)(a1 + 160) + v5;
    LOBYTE(v5) = v5 + 2;
    *(_BYTE *)(v15 + 1) = *(_BYTE *)(a1 + 63);
  }
  if (!v8 && (a2[10] & 1) != 0)
  {
    if (a2[11] - 1 > 9)
      goto LABEL_43;
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 10;
    v16 = *(_QWORD *)(a1 + 160) + v5;
    LOBYTE(v5) = v5 + 2;
    *(_BYTE *)(v16 + 1) = *(_BYTE *)(a1 + 59);
  }
  if (!v8 && (a2[6] & 1) != 0)
  {
    if (a2[7] - 1 > 9)
      goto LABEL_43;
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 11;
    v17 = *(_QWORD *)(a1 + 160) + v5;
    LOBYTE(v5) = v5 + 2;
    *(_BYTE *)(v17 + 1) = *(_BYTE *)(a1 + 55);
  }
  if (v8 || (a2[8] & 1) == 0)
  {
    if (!v8)
    {
LABEL_45:
      LODWORD(v21) = (char)a2[18];
      if ((v21 & 0x80000000) != 0)
      {
LABEL_51:
        v19 = 0;
        goto LABEL_44;
      }
      if ((v21 & 1) != 0)
      {
        *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 0x80;
        v21 = *(_QWORD *)(a1 + 160) + v5;
        LOBYTE(v5) = v5 + 2;
        *(_BYTE *)(v21 + 1) = 1;
        LOBYTE(v21) = a2[18];
        if ((v21 & 8) == 0)
        {
LABEL_48:
          if ((v21 & 2) == 0)
            goto LABEL_49;
          goto LABEL_54;
        }
      }
      else if ((v21 & 8) == 0)
      {
        goto LABEL_48;
      }
      *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = -125;
      v21 = *(_QWORD *)(a1 + 160) + v5;
      LOBYTE(v5) = v5 + 2;
      *(_BYTE *)(v21 + 1) = 1;
      LOBYTE(v21) = a2[18];
      if ((v21 & 2) == 0)
      {
LABEL_49:
        if ((v21 & 4) == 0)
          goto LABEL_50;
        goto LABEL_55;
      }
LABEL_54:
      *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = -127;
      v21 = *(_QWORD *)(a1 + 160) + v5;
      LOBYTE(v5) = v5 + 2;
      *(_BYTE *)(v21 + 1) = 1;
      LOBYTE(v21) = a2[18];
      if ((v21 & 4) == 0)
      {
LABEL_50:
        if ((v21 & 0x10) == 0)
          goto LABEL_51;
LABEL_56:
        v19 = 0;
        *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = -123;
        *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5 + 1) = 1;
        goto LABEL_44;
      }
LABEL_55:
      *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = -126;
      v22 = *(_QWORD *)(a1 + 160) + v5;
      LOBYTE(v5) = v5 + 2;
      *(_BYTE *)(v22 + 1) = 1;
      if ((a2[18] & 0x10) == 0)
        goto LABEL_51;
      goto LABEL_56;
    }
  }
  else if (a2[9] - 1 <= 9)
  {
    *(_BYTE *)(*(_QWORD *)(a1 + 160) + v5) = 12;
    v18 = *(_QWORD *)(a1 + 160) + v5;
    LOBYTE(v5) = v5 + 2;
    *(_BYTE *)(v18 + 1) = *(_BYTE *)(a1 + 57);
    goto LABEL_45;
  }
LABEL_43:
  v19 = 1;
LABEL_44:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateDiscConfigParams");
  return v19;
}

uint64_t sub_21986423C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  const char *v6;
  unsigned __int8 *v7;
  unsigned int v8;
  unsigned int *v9;
  int v10;
  uint64_t Memory;
  uint64_t v13;
  int v14;
  unsigned int v15;
  unsigned __int8 *v16;
  uint64_t v17;
  unsigned int v18;
  _DWORD *v19;
  int v20;
  unsigned int v21;
  int v22;
  int v23;
  int v24;
  unsigned __int8 v25;
  int v26;
  unsigned int v27;
  int v28;
  unsigned int v29;
  char v30;
  unsigned int v31;
  char v32;
  const char *v33;
  int v34;
  const char *v35;
  unsigned __int8 v37;
  unsigned __int8 v38;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessDiscNtf");
  if ((_DWORD)a3)
  {
    v6 = "Received Erroneous Notification(phNciNfc_ProcessDiscNtf)\n";
    goto LABEL_3;
  }
  a3 = 1;
  v6 = "Invalid input parameter (phNciNfc_ProcessDiscNtf)\n";
  if (a1 && a2)
  {
    v7 = *(unsigned __int8 **)(a2 + 8);
    if (!v7 || (v8 = *(_DWORD *)(a2 + 16)) == 0)
    {
      v10 = 2;
      v9 = (unsigned int *)a1;
      goto LABEL_13;
    }
    if (v8 <= 4)
    {
      v9 = (unsigned int *)(a1 + 6476);
      v6 = "Failed, Ntf Length is less than minimum (phNciNfc_ProcessDiscNtf)\n";
      v10 = 1;
LABEL_13:
      sub_219850628(v10, v9, 3u, 1u, (uint64_t)v6);
LABEL_14:
      sub_2198649A0(a1, a3);
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed,phNciNfc_ProcessDiscNtf()");
      sub_219863C78(a1);
      goto LABEL_15;
    }
    sub_2198F32D8(a1 + 888);
    Memory = phOsalNfc_GetMemory();
    if (!Memory)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Memory allocation for Remotedevice information failed");
      a3 = 12;
      goto LABEL_14;
    }
    v13 = Memory;
    phOsalNfc_SetMemory();
    sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreRemDevInfo");
    sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreDiscNtfParams");
    v14 = *v7;
    if (!*v7
      || v14 == 255
      || ((*(_BYTE *)(v13 + 8) = v14, sub_2198591B4((unsigned int *)a1, v7[1]))
       || sub_219859250((unsigned int *)a1, v7[2]))
      && sub_21985B90C((unsigned int *)a1, v7))
    {
      sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreDiscNtfParams");
LABEL_23:
      sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreRemDevInfo");
      phOsalNfc_FreeMemory();
      a3 = 255;
      goto LABEL_14;
    }
    *(_DWORD *)(v13 + 16) = v7[1];
    *(_DWORD *)(v13 + 20) = v7[2];
    v15 = v7[3];
    v16 = v7 + 4;
    sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreRfTechParams");
    v17 = 0;
    v18 = *(_DWORD *)(v13 + 20);
    if (v18 <= 0xC && ((1 << v18) & 0x1C01) != 0)
      v17 = (v7[6] + 3);
    v19 = (_DWORD *)(v13 + 4);
    sub_2198592E8((unsigned int *)a1, v16[v17 + 1], v16[v17], (_DWORD *)v13, (int *)(v13 + 4));
    v20 = 255;
    switch(*(_DWORD *)(v13 + 20))
    {
      case 0:
      case 3:
      case 0xA:
      case 0xB:
      case 0xC:
        if (v15 < 4)
          goto LABEL_82;
        sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreNfcATechParams");
        v21 = v7[6];
        if (v21 > 0xA || ((1 << v21) & 0x491) == 0)
          goto LABEL_71;
        if (*v19 == 23)
        {
          *(_BYTE *)(v13 + 49) = v7[4];
          *(_BYTE *)(v13 + 50) = v7[5];
          *(_BYTE *)(v13 + 67) = 2;
          v29 = v7[6];
          *(_BYTE *)(v13 + 46) = v29;
          if (!v29)
          {
LABEL_53:
            v25 = 3;
LABEL_60:
            v23 = 255;
            v24 = 1;
            goto LABEL_65;
          }
          if (v29 <= 0xA)
          {
            phOsalNfc_MemCopy();
            v30 = *(_BYTE *)(v13 + 46);
            v25 = v30 + 3;
            v24 = 1;
            if (v16[(v30 + 3)] == 1)
            {
              v23 = 0;
              *(_BYTE *)(v13 + 48) = 1;
              v25 = v30 + 5;
              *(_BYTE *)(v13 + 47) = v16[(v30 + 4)];
LABEL_58:
              v24 = 0;
              goto LABEL_65;
            }
LABEL_64:
            v23 = 255;
            goto LABEL_65;
          }
          v33 = "Received NFCID Length exceeded max NFCID size";
        }
        else
        {
          if (*v19 == 19)
          {
            *(_BYTE *)(v13 + 47) = v7[4];
            *(_BYTE *)(v13 + 48) = v7[5];
            v22 = v7[6];
            *(_BYTE *)(v13 + 46) = v22;
            if (!v22)
            {
              v23 = v7[7];
              if (!v7[7])
              {
                v24 = 0;
                v25 = 4;
LABEL_65:
                if (v15 == v25)
                  v34 = 1;
                else
                  v34 = v24;
                if (v34)
                  v20 = v23;
                else
                  v20 = 255;
LABEL_71:
                v35 = "phNciNfc_StoreNfcATechParams";
                goto LABEL_81;
              }
            }
            goto LABEL_53;
          }
          *(_BYTE *)(v13 + 101) = v7[4];
          *(_BYTE *)(v13 + 102) = v7[5];
          v31 = v7[6];
          if (!v7[6])
          {
            v25 = 2;
            goto LABEL_60;
          }
          *(_BYTE *)(v13 + 46) = v31;
          if (v31 <= 0xA)
          {
            phOsalNfc_MemCopy();
            v32 = *(_BYTE *)(v13 + 46);
            v25 = v32 + 3;
            v24 = 1;
            if (v16[(v32 + 3)] != 1)
            {
              v23 = 255;
              goto LABEL_65;
            }
            v23 = 0;
            *(_BYTE *)(v13 + 103) = 1;
            v25 = v32 + 5;
            *(_BYTE *)(v13 + 96) = v16[(v32 + 4)];
            goto LABEL_58;
          }
          v33 = "Received UID Length exceeded max UID size";
        }
        v25 = 3;
        v24 = 1;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v33);
        goto LABEL_64;
      case 1:
        if (v15 >= 0xC)
        {
          v28 = *v16;
          if ((v28 - 11) <= 1)
          {
            *(_BYTE *)(v13 + 98) = v28;
            phOsalNfc_MemCopy();
            if (v15 == (*(_BYTE *)(v13 + 98) + 1))
              v20 = 0;
            else
              v20 = 255;
          }
        }
        goto LABEL_82;
      case 2:
      case 5:
        if (v15 >= 0x12)
        {
          sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreNfcFTechParams");
          v26 = *v16;
          if ((v26 - 1) <= 1 && (v7[5] | 2) == 0x12 && *v19 != 23)
          {
            *(_BYTE *)(v13 + 55) = v26;
            v27 = v7[5];
            *(_BYTE *)(v13 + 56) = v27;
            if (v27 > 0x12)
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received SensFResp Length exceeded max SensF length");
            else
              phOsalNfc_MemCopy();
            if ((*(_BYTE *)(v13 + 56) + 2) != v15 || v27 >= 0x13)
              v20 = 255;
            else
              v20 = 0;
          }
          v35 = "phNciNfc_StoreNfcFTechParams";
LABEL_81:
          sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)v35);
        }
        goto LABEL_82;
      case 6:
        *(_BYTE *)(v13 + 46) = v7[4];
        *(_BYTE *)(v13 + 45) = v7[5];
        *(_BYTE *)(v13 + 44) = 8;
        phOsalNfc_MemCopy();
        v20 = 0;
        goto LABEL_82;
      default:
LABEL_82:
        sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreRfTechParams");
        v37 = v7[3];
        sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreDiscNtfParams");
        if (v20)
          goto LABEL_23;
        v38 = v37 + 4;
        if (v7[v38] > 2u)
        {
          v38 = 0;
        }
        else if (sub_219863D4C((unsigned int *)a1, (_DWORD *)(a1 + 72), v13, 1) || v38 + 1 != v8)
        {
          goto LABEL_23;
        }
        sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StoreRemDevInfo");
        if (v7[v38] > 1u)
        {
          a3 = 0;
        }
        else if (*(_DWORD *)(a1 + 72))
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Last Notification received");
          *(_BYTE *)(a1 + 176) = 0;
          a3 = 55;
          sub_2198649A0(a1, 55);
        }
        else
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Chain of Discover notifications failed");
          a3 = 255;
        }
        sub_21988078C((unsigned int *)a1, v13);
        if (!(_DWORD)a3)
          goto LABEL_15;
        goto LABEL_4;
    }
  }
LABEL_3:
  sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)v6);
  if (a1)
  {
LABEL_4:
    if ((_DWORD)a3 != 55)
      goto LABEL_14;
  }
LABEL_15:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessDiscNtf");
  return a3;
}

uint64_t sub_2198649A0(uint64_t a1, uint64_t a2)
{
  void (*v4)(_QWORD, _QWORD, _QWORD *, uint64_t);
  _QWORD v6[3];

  memset(v6, 0, sizeof(v6));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TargetDiscoveryComplete");
  if (a1)
  {
    v4 = *(void (**)(_QWORD, _QWORD, _QWORD *, uint64_t))(a1 + 216);
    if (v4)
    {
      v6[0] = a1 + 72;
      v4(*(_QWORD *)(a1 + 208), 0, v6, a2);
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_TargetDiscoveryComplete");
}

uint64_t sub_219864A30(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned int *v6;
  const char *v7;
  unsigned __int8 *v8;
  int v9;
  void (*v11)(_QWORD, _QWORD, uint64_t);
  int v13;
  int v14;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessDeActvNtf");
  if (!a1)
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Received Erroneous Notification(phNciNfc_ProcessDeActvNtf)\n");
    goto LABEL_22;
  }
  if (!*(_QWORD *)(a1 + 3384) || *(uint64_t (***)())(a1 + 3736) != off_2550A3F78)
  {
    phOsalNfc_Timer_Stop();
    *(_BYTE *)(a1 + 6464) = 0;
    sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_ProcessDeActvNtf");
  }
  if (!(_DWORD)a3)
  {
    if (!a2)
      goto LABEL_12;
    v8 = *(unsigned __int8 **)(a2 + 8);
    if (!v8)
      goto LABEL_12;
    v9 = *(_DWORD *)(a2 + 16);
    if (v9 == 2)
    {
      if (*(_QWORD *)(a1 + 736) && !v8[1])
      {
        v13 = *v8;
        v14 = *(_DWORD *)(a1 + 172);
        if (v13 == v14)
        {
          LODWORD(a3) = 0;
        }
        else if (v13 || v14 != 1)
        {
          LODWORD(a3) = 255;
          if (v14 == 2)
          {
            if (v13 == 1)
              LODWORD(a3) = 0;
            else
              LODWORD(a3) = 255;
          }
        }
        else
        {
          LODWORD(a3) = 121;
          sub_219886108(*(_QWORD *)(a1 + 6480), 121);
        }
        goto LABEL_14;
      }
    }
    else
    {
      if (!v9)
      {
LABEL_12:
        v6 = (unsigned int *)(a1 + 6476);
        v7 = "Invalid input parameter (phNciNfc_ProcessDeActvNtf)\n";
        LODWORD(a3) = 1;
        goto LABEL_13;
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed,(phNciNfc_ProcessDeActvNtf)Wrong ntf length\n");
    }
    LODWORD(a3) = 255;
    goto LABEL_14;
  }
  v6 = (unsigned int *)(a1 + 6476);
  v7 = "Received Erroneous Notification(phNciNfc_ProcessDeActvNtf)\n";
LABEL_13:
  sub_219850628(1, v6, 3u, 1u, (uint64_t)v7);
LABEL_14:
  if ((_DWORD)a3 == 121 || (_DWORD)a3 == 0)
    a3 = a3;
  else
    a3 = 255;
  sub_2198636E8(a1);
  sub_2198F32D8(a1 + 888);
  v11 = *(void (**)(_QWORD, _QWORD, uint64_t))(a1 + 736);
  if (v11)
  {
    *(_QWORD *)(a1 + 736) = 0;
    *(_WORD *)(a1 + 6666) = a3;
    v11(*(_QWORD *)(a1 + 744), 0, a1 + 6666);
  }
LABEL_22:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessDeActvNtf");
  return a3;
}

uint64_t sub_219864C44(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _BYTE *v6;
  const char *v7;
  unsigned __int8 *v8;
  const char *v9;
  unsigned int v10;
  void (*v11)(uint64_t, uint64_t, uint64_t);
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  _DWORD *v16;
  unsigned int v17;
  uint64_t v18;
  uint64_t v19;
  uint64_t v20;
  unsigned int v21;
  int v22;
  int v23;
  uint64_t v24;
  uint64_t v25;
  uint64_t Memory;

  v25 = 0;
  Memory = 0;
  v6 = (_BYTE *)(a1 + 6464);
  v24 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessActvNtf");
  if ((_DWORD)a3)
  {
    v7 = "Received Erroneous Notification(phNciNfc_ProcessActvNtf)\n";
    goto LABEL_8;
  }
  if (!a1 || !a2)
  {
    v7 = "Invalid input parameter (phNciNfc_ProcessActvNtf)\n";
    a3 = 1;
LABEL_8:
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)v7);
    if (!a1)
      goto LABEL_19;
    goto LABEL_9;
  }
  phOsalNfc_Timer_Stop();
  *v6 = 0;
  sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_ProcessActvNtf");
  sub_2198F32D8(a1 + 888);
  v24 = 3;
  LODWORD(v25) = 7;
  sub_2198F3088((unsigned int *)(a1 + 888), (uint64_t)&v24, (uint64_t)sub_21985ADB8);
  v8 = *(unsigned __int8 **)(a2 + 8);
  *(_BYTE *)(a1 + 176) = 0;
  if (*(_BYTE *)(a1 + 177) != 1)
  {
    if (!v8 || (v10 = *(_DWORD *)(a2 + 16), v10 < 0xB))
    {
      v9 = "Failed,(phNciNfc_ProcessActvNtf)Wrong ntf payload length\n";
      goto LABEL_14;
    }
    if (sub_219859754((unsigned int *)a1, v8, v10))
      goto LABEL_15;
    if (!v8[1])
    {
      a3 = sub_2198AC608(a1, *(unsigned __int8 **)(a2 + 8), *(_DWORD *)(a2 + 16));
      if (!(_DWORD)a3)
      {
        a3 = 42;
        goto LABEL_19;
      }
LABEL_54:
      if ((_DWORD)a3 == 42)
        goto LABEL_19;
      v18 = Memory;
      if ((_DWORD)a3)
        goto LABEL_60;
      goto LABEL_56;
    }
    v16 = (_DWORD *)(a1 + 72);
    a3 = sub_219863550((unsigned int *)a1, (_DWORD *)(a1 + 72), *v8, &Memory, 1);
    if ((_DWORD)a3 == 255)
    {
      if (!*v16)
      {
        Memory = phOsalNfc_GetMemory();
        if (!Memory)
        {
          v18 = 0;
          a3 = 255;
          goto LABEL_60;
        }
        phOsalNfc_SetMemory();
LABEL_33:
        if (!*v16)
        {
          v20 = sub_219863D4C((unsigned int *)a1, (_DWORD *)(a1 + 72), Memory, 1);
          if ((_DWORD)v20)
          {
            a3 = v20;
            if (*v16)
              goto LABEL_54;
            goto LABEL_53;
          }
        }
        v17 = v8[3];
        if (v17 > 0xC || ((1 << v17) & 0x1C6F) == 0)
        {
          v21 = v17 - 112;
          if (v21 > 0x15)
            goto LABEL_50;
          v22 = 1 << v21;
          if ((v22 & 0x2F0000) != 0)
          {
            v18 = Memory;
            v19 = sub_2198613A8(a1, Memory, *(_BYTE **)(a2 + 8), *(_DWORD *)(a2 + 16));
LABEL_43:
            a3 = v19;
            if ((_DWORD)v19)
            {
LABEL_51:
              if (*v16 == 1)
                sub_219863D4C((unsigned int *)a1, (_DWORD *)(a1 + 72), v18, 0);
LABEL_53:
              phOsalNfc_FreeMemory();
              Memory = 0;
              goto LABEL_54;
            }
LABEL_44:
            if (v18)
            {
              if (*(_DWORD *)(v18 + 4) == 18 && !*(_BYTE *)(v18 + 56))
              {
                a3 = 0;
              }
              else
              {
                a3 = 0;
                *(_BYTE *)v18 = 1;
              }
LABEL_56:
              if (v18)
              {
                v23 = *(_DWORD *)(v18 + 20);
                if ((v23 - 128) >= 4 && v23 != 133)
                {
                  v11 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 720);
                  if (v11)
                  {
                    a3 = 0;
                    *(_QWORD *)(a1 + 720) = 0;
                    goto LABEL_62;
                  }
                  goto LABEL_69;
                }
                a3 = sub_21985B708(a1);
                if ((_DWORD)a3 == 255)
                {
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Dummy Read request for data message failed!");
                  phOsalNfc_FreeMemory();
                  v18 = 0;
                  Memory = 0;
                }
              }
LABEL_60:
              v11 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 720);
              if (v11)
              {
                *(_QWORD *)(a1 + 720) = 0;
                if (!v18)
                  goto LABEL_17;
LABEL_62:
                v12 = *(_QWORD *)(a1 + 728);
                v13 = a3;
                v14 = v18;
                goto LABEL_18;
              }
              if ((_DWORD)a3)
                goto LABEL_21;
              if (!v18)
              {
LABEL_71:
                a3 = 41;
                goto LABEL_21;
              }
LABEL_69:
              if (*(_BYTE *)v18 == 1)
              {
                a3 = 40;
                goto LABEL_21;
              }
              goto LABEL_71;
            }
            goto LABEL_51;
          }
          if ((v22 & 5) == 0)
          {
LABEL_50:
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid Rf Techn and mode received");
            a3 = 0;
            v18 = Memory;
            goto LABEL_44;
          }
        }
        v18 = Memory;
        v19 = sub_21987CE50((unsigned int *)a1, Memory, *(_BYTE **)(a2 + 8), *(_DWORD *)(a2 + 16));
        goto LABEL_43;
      }
      a3 = sub_219863550((unsigned int *)a1, (_DWORD *)(a1 + 72), *v8, &Memory, 0);
    }
    if ((_DWORD)a3)
      goto LABEL_54;
    goto LABEL_33;
  }
  v9 = "Dropping the Activated notification, as the Select command's Response has not yet come";
LABEL_14:
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v9);
LABEL_15:
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Interface activated notification validation failed!");
  v6[145] = 1;
  v11 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 720);
  if (v11)
  {
    *(_QWORD *)(a1 + 720) = 0;
    a3 = 188;
LABEL_17:
    v12 = *(_QWORD *)(a1 + 728);
    v13 = a3;
    v14 = 0;
LABEL_18:
    v11(v12, v13, v14);
    a3 = 40;
    goto LABEL_19;
  }
  a3 = 188;
LABEL_21:
  sub_2198649A0(a1, a3);
LABEL_9:
  if ((unsigned __int16)(a3 - 43) <= 0xFFFCu)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"Failed,(phNciNfc_ProcessActvNtf)\n");
    v6[9] = 1;
  }
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessActvNtf");
  return a3;
}

uint64_t sub_21986514C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  const char *v6;
  int v7;
  int v9;
  uint64_t Memory;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_PrepareHceNciHandle_ExpMode");
  if (!(_DWORD)a3)
  {
    if (!a1 || !a2 || !*(_QWORD *)(a2 + 8))
      goto LABEL_8;
    v7 = *(_DWORD *)(a2 + 16);
    if (v7 != 1)
    {
      if (!v7)
      {
LABEL_8:
        v6 = "Invalid input parameter (phNciNfc_PrepareHceNciHandle_ExpMode)\n";
        a3 = 1;
        goto LABEL_9;
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed,(phNciNfc_PrepareHceNciHandle_ExpMode)Wrong ntf parameter\n");
LABEL_17:
      a3 = 255;
      goto LABEL_10;
    }
    sub_2198F32D8(a1 + 888);
    v9 = *(_DWORD *)(a1 + 72);
    *(_BYTE *)(a1 + 176) = 0;
    if (v9)
      goto LABEL_17;
    Memory = phOsalNfc_GetMemory();
    if (Memory)
    {
      v11 = Memory;
      phOsalNfc_SetMemory();
      v12 = sub_219863D4C((unsigned int *)a1, (_DWORD *)(a1 + 72), v11, 1);
      if ((_DWORD)v12)
      {
        a3 = v12;
LABEL_15:
        phOsalNfc_FreeMemory();
        goto LABEL_10;
      }
      *(_BYTE *)(v11 + 8) = 1;
      *(_QWORD *)(v11 + 12) = 0x400000002;
      *(_DWORD *)(v11 + 20) = 128;
      *(_WORD *)(v11 + 24) = 511;
      *(_BYTE *)(v11 + 26) = 0;
      *(_DWORD *)(v11 + 28) = 128;
      *(_WORD *)(v11 + 32) = 0;
      *(_QWORD *)(a1 + 4512) = v11;
      a3 = sub_219859BD8(a1);
      sub_2198830EC((unsigned int *)a1, v11);
      if ((_DWORD)a3)
        goto LABEL_10;
      *(_BYTE *)v11 = 1;
      v13 = sub_21985B708(a1);
      if ((_DWORD)v13)
      {
        a3 = v13;
        if ((_DWORD)v13 != 255)
          goto LABEL_10;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Dummy Read request for data message failed!");
        goto LABEL_15;
      }
      if (!*(_QWORD *)(a1 + 720) && *(_BYTE *)v11 != 1)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"HCE activation failed in case of HCE + Exp mode !");
        phOsalNfc_FreeMemory();
        goto LABEL_17;
      }
      sub_2198649A0(a1, 40);
    }
    a3 = 0;
    goto LABEL_10;
  }
  v6 = "Received Erroneous Notification(phNciNfc_PrepareHceNciHandle_ExpMode)\n";
LABEL_9:
  sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)v6);
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_PrepareHceNciHandle_ExpMode");
  return a3;
}

uint64_t sub_21986538C(uint64_t a1, int a2)
{
  uint64_t v4;
  void (*v5)(_QWORD, uint64_t, _QWORD *, uint64_t);
  _QWORD v7[3];
  uint64_t v8;

  memset(v7, 0, sizeof(v7));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReleaseHceNciHandle_ExpMode");
  if (a1 && *(_DWORD *)(a1 + 72))
  {
    v8 = 0;
    sub_2199004B4(a1, 0);
    v4 = sub_219863550((unsigned int *)a1, (_DWORD *)(a1 + 72), 0, &v8, 1);
    if (!(_DWORD)v4)
      sub_219861F14(a1, v8);
    sub_219863C78(a1);
    sub_2198F32D8(a1 + 888);
    if (a2 != 1)
    {
      v5 = *(void (**)(_QWORD, uint64_t, _QWORD *, uint64_t))(a1 + 192);
      if (v5)
      {
        v7[0] = 0x200000003;
        v5(*(_QWORD *)(a1 + 184), 7, v7, 146);
      }
    }
  }
  else
  {
    v4 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReleaseHceNciHandle_ExpMode");
  return v4;
}

uint64_t sub_219865494(uint64_t a1, char a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_EnableDisable_SytaxErrRetry");
  if (a1)
  {
    v4 = 0;
    *(_BYTE *)(a1 + 6592) = a2;
    *(_BYTE *)(a1 + 6593) = 0;
  }
  else
  {
    v4 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_EnableDisable_SytaxErrRetry");
  return v4;
}

uint64_t sub_219865518(uint64_t a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetReDiscSetCfgErrStatus");
  v4 = 255;
  if (a1 && a2)
  {
    v4 = 0;
    *a2 = *(_BYTE *)(a1 + 6593);
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetReDiscSetCfgErrStatus");
  return v4;
}

uint64_t sub_219865598(unsigned int *a1, unsigned int a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ConfigDeactvDelay");
  if (a1)
    a1[50] = a2;
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ConfigDeactvDelay");
  return 255;
}

uint64_t sub_2198655FC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _BOOL4 v6;
  char v7;
  uint64_t v8;
  uint64_t v9;
  int v10;
  char v11;
  unsigned int *v12;
  uint64_t v13;
  uint64_t v14;
  int *v15;
  char v16;
  int *v17;
  unsigned int v18;
  uint64_t v19;
  uint64_t (*v20)(uint64_t, uint64_t, uint64_t);
  uint64_t (**v21)();
  uint64_t (*v22)();
  uint64_t v23;
  uint64_t v24;
  uint64_t v25;
  uint64_t (*v26)(uint64_t, _QWORD, uint64_t);
  uint64_t v27;
  uint64_t (*v28)(uint64_t, _QWORD, uint64_t);
  uint64_t v29;
  uint64_t v30;
  uint64_t v31;
  uint64_t (*v32)(uint64_t, _QWORD, uint64_t);
  uint64_t v33;
  uint64_t v34;
  uint64_t (*v35)(uint64_t, _QWORD, uint64_t);
  uint64_t v36;
  uint64_t (*v37)(uint64_t, _QWORD, uint64_t);
  uint64_t v38;
  uint64_t v39;
  uint64_t v40;
  void (*v41)(uint64_t, uint64_t, uint64_t);

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SeqHandler");
  v6 = a1 != 0;
  if (!a1)
    goto LABEL_6;
  v7 = 0;
  v8 = 0;
  do
  {
    v9 = *((_QWORD *)&unk_253E46700 + 14 * v8 + 2);
    if ((v7 & 1) != 0)
      break;
    v7 = 1;
    v8 = 1;
  }
  while (v9 != a1);
  if (v9 != a1)
  {
LABEL_6:
    v10 = 0;
    goto LABEL_7;
  }
  v16 = sub_219899740((unsigned int *)a1, *(_QWORD *)(a1 + 2912));
  if (*(_DWORD *)(a1 + 19368))
    v17 = &dword_253E47158;
  else
    v17 = &dword_253E47070;
  *v17 = *v17 & 0xFFFE003F | ((v16 & 0x3F) << 11) | ((*(_BYTE *)(a1 + 2904) & 0x1F) << 6);
  if ((_DWORD)a2 == 36 || (_DWORD)a2 == 15)
  {
LABEL_68:
    sub_219879E00(a1, a2);
    goto LABEL_69;
  }
  if (!(_DWORD)a2)
  {
    v18 = *(unsigned __int8 *)(a1 + 2904);
    v10 = 1;
    if (v18 > *(unsigned __int8 *)(a1 + 2905) || !*(_BYTE *)(a1 + 2905))
      goto LABEL_7;
    if (!*(_BYTE *)(a1 + 2904))
    {
      if (*(_BYTE *)(a1 + 2906) == 1)
      {
        *(_BYTE *)(a1 + 2906) = 0;
        v21 = *(uint64_t (***)())(a1 + 2912);
      }
      else
      {
        v30 = sub_2199009D0(*(_QWORD *)(a1 + 2952), *(_QWORD *)(a1 + 3040));
        v21 = *(uint64_t (***)())(a1 + 2912);
        if (v21 != off_2550A2FE8)
        {
          a2 = v30;
          if ((_DWORD)v30)
            goto LABEL_69;
        }
      }
      if (!v21)
        goto LABEL_94;
      v22 = v21[2 * *(unsigned __int8 *)(a1 + 2904)];
      if (!v22)
        goto LABEL_94;
      v23 = ((uint64_t (*)(uint64_t, _QWORD, uint64_t))v22)(a1, 0, a3);
      if (!(_DWORD)v23)
      {
        v24 = *(unsigned __int8 *)(a1 + 2904);
        if (*(unsigned __int8 *)(a1 + 2905) > v24)
        {
          v25 = v24 + 1;
          *(_BYTE *)(a1 + 2904) = v25;
          v26 = *(uint64_t (**)(uint64_t, _QWORD, uint64_t))(*(_QWORD *)(a1 + 2912) + 16 * v25);
          if (v26)
          {
            v23 = v26(a1, 0, a3);
            if ((_DWORD)v23)
              goto LABEL_84;
          }
          while (1)
          {
            v29 = *(unsigned __int8 *)(a1 + 2904);
            if (*(unsigned __int8 *)(a1 + 2905) <= v29)
              break;
            v27 = v29 + 1;
            *(_BYTE *)(a1 + 2904) = v27;
            v28 = *(uint64_t (**)(uint64_t, _QWORD, uint64_t))(*(_QWORD *)(a1 + 2912) + 16 * v27);
            if (v28)
              a2 = v28(a1, 0, a3);
            else
              a2 = 0;
            v10 = 1;
            if ((_DWORD)a2)
              goto LABEL_7;
          }
        }
        goto LABEL_94;
      }
      goto LABEL_84;
    }
    v19 = *(_QWORD *)(a1 + 2912);
    if (v19
      && (v20 = *(uint64_t (**)(uint64_t, uint64_t, uint64_t))(v19 + 16 * (v18 - 1) + 8)) != 0
      && !*(_BYTE *)(a1 + 2882))
    {
      a2 = v20(a1, a2, a3);
    }
    else
    {
      *(_BYTE *)(a1 + 2882) = 0;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Sync Handler resending in progress");
    }
    if ((_DWORD)a2 == 111)
    {
LABEL_16:
      v6 = 1;
      v10 = 1;
      goto LABEL_17;
    }
    if (!(_DWORD)a2)
    {
      if (*(unsigned __int8 *)(a1 + 2904) == *(unsigned __int8 *)(a1 + 2905))
      {
LABEL_81:
        v31 = *(_QWORD *)(a1 + 2912);
        if (v31)
        {
          v32 = *(uint64_t (**)(uint64_t, _QWORD, uint64_t))(v31 + 16 * *(unsigned __int8 *)(a1 + 2904));
          if (v32)
          {
            v23 = v32(a1, 0, a3);
            if ((_DWORD)v23)
              goto LABEL_84;
            v33 = *(unsigned __int8 *)(a1 + 2904);
            if (*(unsigned __int8 *)(a1 + 2905) > v33)
            {
              v34 = v33 + 1;
              *(_BYTE *)(a1 + 2904) = v34;
              v35 = *(uint64_t (**)(uint64_t, _QWORD, uint64_t))(*(_QWORD *)(a1 + 2912) + 16 * v34);
              if (v35)
              {
                v23 = v35(a1, 0, a3);
                if ((_DWORD)v23)
                  goto LABEL_84;
              }
              while (1)
              {
                v38 = *(unsigned __int8 *)(a1 + 2904);
                if (*(unsigned __int8 *)(a1 + 2905) <= v38)
                  break;
                v36 = v38 + 1;
                *(_BYTE *)(a1 + 2904) = v36;
                v37 = *(uint64_t (**)(uint64_t, _QWORD, uint64_t))(*(_QWORD *)(a1 + 2912) + 16 * v36);
                if (v37)
                  a2 = v37(a1, 0, a3);
                else
                  a2 = 0;
                v10 = 1;
                if ((_DWORD)a2)
                  goto LABEL_7;
              }
            }
          }
        }
LABEL_94:
        a2 = 0;
        v6 = 1;
        v10 = 1;
        goto LABEL_95;
      }
      if (*(_BYTE *)(a1 + 2906) == 1)
      {
        *(_BYTE *)(a1 + 2906) = 0;
        goto LABEL_81;
      }
      v23 = sub_2199009D0(*(_QWORD *)(a1 + 2952), *(_QWORD *)(a1 + 3040));
      if (!(_DWORD)v23)
        goto LABEL_81;
LABEL_84:
      a2 = v23;
      goto LABEL_69;
    }
    *(_BYTE *)(a1 + 2904) = *(_BYTE *)(a1 + 2905);
    if ((_DWORD)a2 != 36 && (_DWORD)a2 != 15)
      goto LABEL_69;
    goto LABEL_68;
  }
  *(_BYTE *)(a1 + 2904) = *(_BYTE *)(a1 + 2905);
LABEL_69:
  v10 = 1;
LABEL_7:
  if ((_DWORD)a2 && (_DWORD)a2 != 13 && (_DWORD)a2 != 111)
  {
    v11 = v10 ^ 1;
    if (!a1)
      v11 = 1;
    if ((v11 & 1) == 0)
    {
      if (*(_BYTE *)(a1 + 2904) || *(_BYTE *)(a1 + 2928))
        *(_BYTE *)(a1 + 2904) = *(_BYTE *)(a1 + 2905);
      goto LABEL_16;
    }
  }
LABEL_17:
  if (v10 && v6 && (_DWORD)a2 == 111)
  {
    if (*(unsigned __int8 *)(a1 + 2928) > 7u)
    {
      if (*(_DWORD *)(a1 + 19368))
        v15 = &dword_253E47158;
      else
        v15 = &dword_253E47070;
      v15[1] |= 0x1000000u;
      *(_BYTE *)(a1 + 2928) = 0;
      *(_BYTE *)(a1 + 2904) = *(_BYTE *)(a1 + 2905);
      v6 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Send Retry Failed - Maximum No Of retries on NCI Send Busy reached");
      sub_219886108(*(_QWORD *)(a1 + 19360), 202);
      sub_21988F804(*(_QWORD *)(a1 + 2952), 0);
    }
    else
    {
      v12 = (unsigned int *)(a1 + 19368);
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"bResendRetryCount");
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NCI Send busy");
      if (a3)
        *(_QWORD *)(a1 + 2920) = a3;
      v13 = *(_QWORD *)(a1 + 2896);
      if (v13 && v13 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 2896) = 0xFFFFFFFFFFFFLL;
      }
      v14 = phOsalNfc_Timer_Create();
      *(_QWORD *)(a1 + 2896) = v14;
      if (v14 != 0xFFFFFFFFFFFFLL && v14)
      {
        sub_219850628(1, v12, 4u, 4u, (uint64_t)"Libnfc sync handler Timer Created Successfully");
        if (!phOsalNfc_Timer_Start())
        {
          v6 = 1;
          sub_21988629C(1, v12, *(_QWORD *)(a1 + 2896), 4u, 4u, (uint64_t)"phLibNfc_SeqHandler");
          sub_219850628(1, v12, 4u, 4u, (uint64_t)"Libnfc sync handler wait timer started..");
          a2 = 13;
          goto LABEL_98;
        }
        v6 = 1;
        sub_219850628(1, v12, 4u, 1u, (uint64_t)"Failed to start Libnfc sync handler wait timer!");
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a1 + 2896) = 0;
      }
      else
      {
        v6 = 1;
        sub_219850628(1, v12, 4u, 1u, (uint64_t)"Libnfc sync handler Timer Create failed!!");
      }
      *(_BYTE *)(a1 + 2904) = *(_BYTE *)(a1 + 2905);
      *(_BYTE *)(a1 + 2928) = 0;
    }
    a2 = 255;
LABEL_98:
    v10 = 1;
    goto LABEL_99;
  }
LABEL_95:
  if (v6 && v10)
  {
    *(_BYTE *)(a1 + 2928) = 0;
    v6 = 1;
    goto LABEL_98;
  }
LABEL_99:
  if (v6 && v10)
  {
    v39 = *(unsigned __int8 *)(a1 + 2904);
    if ((_DWORD)v39 == *(unsigned __int8 *)(a1 + 2905))
    {
      v40 = *(_QWORD *)(a1 + 2912);
      if (v40)
      {
        v41 = *(void (**)(uint64_t, uint64_t, uint64_t))(v40 + 16 * v39 + 8);
        if (v41)
          v41(a1, a2, a3);
      }
    }
    else
    {
      *(_BYTE *)(a1 + 2904) = v39 + 1;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SeqHandler");
  return a2;
}

uint64_t sub_219865C5C(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  char v8;
  int v9;
  int v10;
  uint64_t v12;

  v12 = a2;
  sub_21988629C(2, (unsigned int *)a2, a1, 4u, 4u, (uint64_t)"phLibNfc_WaitLibSeqHdlrTimerCb");
  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_WaitLibSeqHdlrTimerCb");
  if (a2)
  {
    v3 = 0;
    v4 = 0;
    do
    {
      v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
      if ((v3 & 1) != 0)
        break;
      v3 = 1;
      v4 = 1;
    }
    while (v5 != a2);
    if (v5 == a2)
    {
      v6 = *(_QWORD *)(a2 + 19360);
      v7 = *(_QWORD *)(a2 + 2896);
      if (v7 && v7 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Stop();
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a2 + 2896) = 0;
      }
      sub_219850628(1, (unsigned int *)(a2 + 19368), 4u, 4u, (uint64_t)"phLibNfc_WaitLibSeqHdlrTimerCb: Sync Handler timer call back invoked");
      v8 = *(_BYTE *)(a2 + 2904);
      if (v8)
      {
        *(_BYTE *)(a2 + 2882) = 1;
        *(_BYTE *)(a2 + 2904) = v8 - 1;
      }
      v9 = *(unsigned __int8 *)(a2 + 2928);
      v10 = v9 + 1;
      *(_BYTE *)(a2 + 2928) = v9 + 1;
      sub_2198655FC(a2, 0, *(_QWORD *)(a2 + 2920));
      sub_21988EDF4(v6, &v12);
      if (v10 != 8 && v12)
        *(_BYTE *)(v12 + 2882) = 0;
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_WaitLibSeqHdlrTimerCb");
}

uint64_t sub_219865DD0(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  char v7;
  char v8;
  int v9;
  int *v10;
  BOOL v11;
  int *v12;
  unsigned int v13;
  int v14;
  uint64_t (**v16)();
  char v17;
  uint64_t (**v18)();
  uint64_t (*v19)();
  char v21;

  v21 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InternalSequence");
  if (a1)
  {
    sub_219901EA0(*(_QWORD *)(a1 + 3040), 0, &v21);
    v6 = 0;
    v7 = 1;
    while (1)
    {
      v8 = v7;
      if (*((_QWORD *)&unk_253E46700 + 14 * v6) == *(_QWORD *)(a1 + 19360))
        break;
      v7 = 0;
      v6 = 1;
      if ((v8 & 1) == 0)
      {
        v9 = 255;
        goto LABEL_7;
      }
    }
    v9 = *((_DWORD *)&unk_253E46700 + 28 * v6 + 2);
    if (v21 != 1)
      goto LABEL_20;
LABEL_7:
    v10 = &dword_253E47080;
    v11 = v9 == 0;
    if (v9)
      v12 = (int *)&unk_253E470F4;
    else
      v12 = &dword_253E47084;
    v13 = *v12 & 0xFFFFFFFE;
    if (!v11)
      v10 = &dword_253E470F0;
    v14 = *v10;
    if (v13 == 136 && v14 == 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"phLibNfc_InternalSequence: RID/RALL Response dropped due to Ongoing Discovery Sequence");
    }
    else
    {
LABEL_20:
      if (!(_DWORD)a2
        && *(_BYTE *)(a1 + 19354) == 1
        && ((v16 = *(uint64_t (***)())(a1 + 2912), v16 == off_2550A3588)
         || v16 == (uint64_t (**)())&qword_2550A35F8))
      {
        *(_BYTE *)(a1 + 1426) = 0;
        sub_219865494(*(_QWORD *)(a1 + 3040), 0);
        *(_BYTE *)(a1 + 19354) = 0;
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)" Response dropped due to force stop Discovery Sequence");
        *(_QWORD *)(a1 + 2912) = off_2550A3648;
        *(_BYTE *)(a1 + 2904) = 0;
        *(_BYTE *)(a1 + 2906) = 0;
        v17 = (char)off_2550A3648[0];
        if (off_2550A3648[0])
        {
          v17 = 0;
          v18 = off_2550A3658;
          do
          {
            ++v17;
            v19 = *v18;
            v18 += 2;
          }
          while (v19);
        }
        *(_BYTE *)(a1 + 2905) = v17;
        if (sub_2198655FC(a1, 0, 0) != 13)
          sub_2198D5EE4(a1, 255, 0);
      }
      else
      {
        sub_2198655FC(a1, a2, a3);
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InternalSequence");
}

uint64_t sub_219865FEC(uint64_t a1, int a2)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ForceNextSeq");
  if (a1)
    *(_BYTE *)(a1 + 2906) = a2 == 1;
  else
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_ForceNextSeq FAILED, pLibContext is NULL");
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ForceNextSeq");
}

uint64_t sub_21986607C(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v6;
  unsigned int *v7;
  const char *v8;
  unsigned int v9;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SkipSequenceSeq");
  v6 = 0;
  if (a1 && a2 && a3)
  {
    if (*(_QWORD *)(a1 + 2912) == a2)
    {
      v9 = *(unsigned __int8 *)(a1 + 2904) + a3;
      if (v9 <= *(unsigned __int8 *)(a1 + 2905))
      {
        *(_BYTE *)(a1 + 2904) = v9;
        v6 = 1;
        goto LABEL_10;
      }
      v7 = (unsigned int *)(a1 + 19368);
      v8 = "Value to increment is invalid";
    }
    else
    {
      v7 = (unsigned int *)(a1 + 19368);
      v8 = "Sequence mismatch, can not increment the current sequence";
    }
    sub_219850628(1, v7, 4u, 1u, (uint64_t)v8);
    v6 = 0;
  }
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SkipSequenceSeq");
  return v6;
}

uint64_t sub_219866158(uint64_t a1, uint64_t a2, unsigned int a3)
{
  uint64_t v6;
  unsigned int *v7;
  const char *v8;
  unsigned int v9;
  BOOL v10;
  char v11;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RepeatSequenceSeq");
  v6 = 0;
  if (a1 && a2 && a3)
  {
    if (*(_QWORD *)(a1 + 2912) == a2)
    {
      v9 = *(unsigned __int8 *)(a1 + 2904);
      v10 = v9 >= a3;
      v11 = v9 - a3;
      if (v10)
      {
        *(_BYTE *)(a1 + 2904) = v11;
        v6 = 1;
        goto LABEL_10;
      }
      v7 = (unsigned int *)(a1 + 19368);
      v8 = "Value to decrement is invalid";
    }
    else
    {
      v7 = (unsigned int *)(a1 + 19368);
      v8 = "Sequence mismatch, can not decrement the current sequence";
    }
    sub_219850628(1, v7, 4u, 1u, (uint64_t)v8);
    v6 = 0;
  }
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RepeatSequenceSeq");
  return v6;
}

uint64_t sub_21986622C(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_SendSwpTestCmd");
  v2 = 1;
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 62;
    *(_QWORD *)&v5 = a1 + 816;
    DWORD2(v5) = 1;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_SendSwpTestCmd");
  return v2;
}

uint64_t sub_2198662F4(unsigned int *a1, uint64_t a2)
{
  int v4;
  const char *v5;
  const char *v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = 0;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_SwpTestCompleteSequence");
  if (a1)
  {
    if (!(_DWORD)a2)
    {
      v8 = 0xF00000003;
      LODWORD(v9) = 62;
      v4 = sub_2198F2F98(a1 + 222, (uint64_t)&v8, (uint64_t)sub_219866A7C, (uint64_t)a1);
      if (!v4)
      {
        sub_219850628(1, a1 + 1619, 3u, 4u, (uint64_t)"Test Swp Ntf notification registered");
        sub_219850628(1, a1 + 1619, 3u, 4u, (uint64_t)"Waiting for Test Swp notification...");
        a2 = 0;
        goto LABEL_11;
      }
      v5 = "Invalid parameter sent";
      if (v4 == 255)
        v5 = "Test Swp Ntf registration failed!";
      if (v4 == 53)
        v6 = "Test Swp Ntf already registered";
      else
        v6 = v5;
      sub_219850628(1, a1 + 1619, 3u, 4u, (uint64_t)v6);
      a2 = 255;
    }
    sub_2198E23C4((uint64_t)a1, a2, 0);
  }
LABEL_11:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_SwpTestCompleteSequence");
  return a2;
}

uint64_t sub_219866430(uint64_t a1)
{
  _BYTE *Memory;
  uint64_t v3;
  __int128 v5;
  __int128 v6;

  v5 = 0u;
  v6 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendPrbsTestCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    Memory = (_BYTE *)phOsalNfc_GetMemory();
    *(_QWORD *)&v6 = Memory;
    if (Memory)
    {
      *(_QWORD *)&v5 = 0xF00000001;
      DWORD2(v5) = 48;
      *Memory = **(_DWORD **)(a1 + 3272);
      *(_BYTE *)(v6 + 1) = *(_DWORD *)(*(_QWORD *)(a1 + 3272) + 4);
      *(_BYTE *)(v6 + 2) = *(_BYTE *)(*(_QWORD *)(a1 + 3272) + 9);
      *(_BYTE *)(v6 + 3) = *(_BYTE *)(*(_QWORD *)(a1 + 3272) + 8);
      DWORD2(v6) = 4;
      v3 = sub_2198F2D0C(a1 + 888, (uint64_t)&v5, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
      phOsalNfc_FreeMemory();
      *(_QWORD *)&v6 = 0;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Payload MemAlloc for Send request Failed!");
      v3 = 12;
    }
  }
  else
  {
    v3 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendPrbsTestCmd");
  return v3;
}

uint64_t sub_219866588(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_PrbsTestCompleteSequence");
  if (a1)
  {
    sub_2198E23C4(a1, a2, 0);
    if (*(_QWORD *)(a1 + 3272))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 3272) = 0;
    }
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_PrbsTestCompleteSequence");
  return a2;
}

uint64_t sub_219866614(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  __int128 v5;
  __int128 v6;

  v5 = 0u;
  v6 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetRfCalDataCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v5 = 0xF00000001;
    DWORD2(v5) = 43;
    v2 = *(_QWORD *)(a1 + 3280);
    *(_QWORD *)&v6 = *(_QWORD *)v2;
    DWORD2(v6) = *(_DWORD *)(v2 + 8);
    v3 = sub_2198F2D0C(a1 + 888, (uint64_t)&v5, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    v3 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetRfCalDataCmd");
  return v3;
}

uint64_t sub_2198666E8(uint64_t a1)
{
  unsigned __int8 *v2;
  int v3;
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetRfCalDataRsp");
  if (!a1 || (v2 = *(unsigned __int8 **)(a1 + 3760)) == 0)
  {
    v4 = 1;
    goto LABEL_11;
  }
  if (!*(_DWORD *)(a1 + 3768))
  {
LABEL_10:
    v4 = 255;
    goto LABEL_11;
  }
  v3 = *v2;
  if (v3 == 242)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Rf Cal data response signature error");
    v4 = 130;
    goto LABEL_11;
  }
  if (v3)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Rf Cal data response failed!");
    goto LABEL_10;
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Rf Cal data response success");
  v4 = 0;
LABEL_11:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetRfCalDataRsp");
  return v4;
}

uint64_t sub_2198667E0(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfCalDataCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 42;
    *(_QWORD *)&v5 = 0;
    DWORD2(v5) = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfCalDataCmd");
  return v2;
}

uint64_t sub_2198668A8(uint64_t a1)
{
  _BYTE *v2;
  int v3;
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfCalDataRsp");
  if (!a1 || (v2 = *(_BYTE **)(a1 + 3760)) == 0)
  {
    v4 = 1;
    goto LABEL_12;
  }
  v3 = *(_DWORD *)(a1 + 3768);
  if (!v3)
  {
LABEL_11:
    v4 = 255;
    goto LABEL_12;
  }
  if (*v2 == 242)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Rf Cal data response signature error");
    v4 = 130;
    goto LABEL_12;
  }
  if (*v2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Rf Cal data response failed!");
    goto LABEL_11;
  }
  if ((v3 - 1) <= *(_DWORD *)(*(_QWORD *)(a1 + 3280) + 8))
  {
    phOsalNfc_MemCopy();
    *(_DWORD *)(*(_QWORD *)(a1 + 3280) + 8) = *(_DWORD *)(a1 + 3768) - 1;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Rf Cal data response success");
    v4 = 0;
  }
  else
  {
    v4 = 3;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Rf Cal data response user passed buffer not sufficient");
  }
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfCalDataRsp");
  return v4;
}

uint64_t sub_219866A04(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfCalDataCompleteSequence");
  if (a1)
    sub_2198E23C4(a1, a2, *(_QWORD *)(a1 + 3280));
  else
    a2 = 255;
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetRfCalDataCompleteSequence");
  return a2;
}

uint64_t sub_219866A7C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned int *v6;
  const char *v7;
  _BYTE *v8;
  unsigned int *v9;
  const char *v10;
  int v11;
  unsigned int *v12;
  const char *v13;
  unsigned int *v15;
  unsigned int *v16;
  const char *v17;
  unsigned int *v18;
  uint64_t v19;
  uint64_t v20;
  uint64_t (*v21)();

  v19 = 0;
  v20 = 0;
  v21 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SwpTestNtfCb");
  if (a1 && a2)
  {
    if ((_DWORD)a3)
    {
      v6 = (unsigned int *)(a1 + 6476);
      v7 = "Swp self test ntf: Reception failed";
    }
    else
    {
      if (*(_DWORD *)(a2 + 16) == 2)
      {
        v8 = *(_BYTE **)(a2 + 8);
        if (!*v8)
        {
          if (*(_BYTE *)(a1 + 3264) == 1)
          {
            v16 = (unsigned int *)(a1 + 6476);
            v17 = "Swp self test success";
LABEL_35:
            sub_219850628(1, v16, 3u, 4u, (uint64_t)v17);
            a3 = 0;
          }
          else
          {
            if (!*(_BYTE *)(a1 + 3264))
            {
              switch(v8[1])
              {
                case 0:
                  v15 = (unsigned int *)(a1 + 6476);
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Swp self test failed!");
                  v10 = "Swp power mode: No PMUVCC";
                  goto LABEL_30;
                case 1:
                  v18 = (unsigned int *)(a1 + 6476);
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Swp self test success");
                  v17 = "Swp1 power mode: PMUVCC = 1.8V";
                  goto LABEL_34;
                case 2:
                  v18 = (unsigned int *)(a1 + 6476);
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Swp self test success");
                  v17 = "Swp1 power mode: PMUVCC = 3.3V";
                  goto LABEL_34;
                case 3:
                  v18 = (unsigned int *)(a1 + 6476);
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Swp self test success");
                  v17 = "Swp1 power mode: PMUVCC undetermined";
LABEL_34:
                  v16 = v18;
                  goto LABEL_35;
                default:
                  v15 = (unsigned int *)(a1 + 6476);
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Swp self test failed!");
                  v10 = "Swp1 self test ntf: Invalid PMUVCC power mode!!";
LABEL_30:
                  v9 = v15;
                  goto LABEL_9;
              }
            }
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Swp self test failed!");
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Swp1 self test ntf: Context is corrupt!!");
            a3 = 254;
          }
LABEL_13:
          *(_WORD *)((char *)&v19 + 1) = 15887;
          v20 = a1;
          v21 = sub_219866A7C;
          v11 = sub_219860F20(a1 + 888, (uint64_t)&v19, 3);
          v12 = (unsigned int *)(a1 + 6476);
          switch(v11)
          {
            case 255:
              v13 = "De-register Test Swp Ntf call back failed!";
              break;
            case 52:
              v13 = "Test Swp Ntf call back not registered!";
              break;
            case 0:
              sub_219850628(1, v12, 3u, 4u, (uint64_t)"De-register Test Swp Ntf call back success");
LABEL_21:
              sub_2198E23C4(a1, a3, 0);
              goto LABEL_22;
            default:
              v13 = "Swp self test: Invalid parameter passed!";
              break;
          }
          sub_219850628(1, v12, 3u, 1u, (uint64_t)v13);
          goto LABEL_21;
        }
        v9 = (unsigned int *)(a1 + 6476);
        v10 = "Swp self test failed!";
LABEL_9:
        sub_219850628(1, v9, 3u, 4u, (uint64_t)v10);
LABEL_12:
        a3 = 255;
        goto LABEL_13;
      }
      v6 = (unsigned int *)(a1 + 6476);
      v7 = "Swp self test ntf: Invalid length of payload";
    }
    sub_219850628(1, v6, 3u, 1u, (uint64_t)v7);
    goto LABEL_12;
  }
  sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"Proc Test Swp ntf: Invalid input parameters");
LABEL_22:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SwpTestNtfCb");
  return a3;
}

uint64_t sub_219866DD4(uint64_t a1, uint64_t a2)
{
  int v4;
  unsigned int v5;
  char v6;
  unsigned int v7;
  uint64_t v8;
  unsigned __int8 v9;
  unsigned __int8 v10;
  uint64_t v12;
  _OWORD v13[16];
  uint64_t v14;

  v14 = *MEMORY[0x24BDAC8D0];
  v12 = 0;
  memset(v13, 0, 255);
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetPropRfCfgCmd");
  if (a1)
  {
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v12);
    if (v12)
    {
      if (*(_BYTE *)(v12 + 824) == 1)
      {
        a2 = 0;
        *(_BYTE *)(v12 + 824) = 0;
      }
      else
      {
        v4 = 0;
        v5 = *(unsigned __int8 *)(a1 + 3520);
        v6 = v5 - 27;
        if (v5 >= 0x1C)
        {
          v7 = 27;
        }
        else
        {
          v6 = 0;
          v7 = *(unsigned __int8 *)(a1 + 3520);
        }
        *(_BYTE *)(a1 + 3520) = v6;
        LOBYTE(v13[0]) = v7;
        v8 = *(_QWORD *)(a1 + 3528);
        v9 = 1;
        do
        {
          v10 = *(_BYTE *)(v8 + 2) + 3;
          phOsalNfc_MemCopy();
          v8 = *(_QWORD *)(a1 + 3528) + v10;
          *(_QWORD *)(a1 + 3528) = v8;
          v9 += v10;
          ++v4;
        }
        while (v7 > v4);
        a2 = sub_2198FFF88(*(_QWORD *)(a1 + 3040), (uint64_t)v13, v9, (uint64_t)sub_219865DD0, a1);
      }
    }
    else
    {
      a2 = 0;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetPropRfCfgCmd");
  return a2;
}

uint64_t sub_219866F70(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCfgProc");
  if (!a1)
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_IoctlSetRfCfgProc : Libnfc Context is Invalid");
    a2 = 255;
    goto LABEL_12;
  }
  if (*(_BYTE *)(a1 + 2937) != 1 && *(_BYTE *)(a1 + 2938) != 1)
  {
    if ((_DWORD)a2 || *(_BYTE *)(a1 + 2944) != 1)
      goto LABEL_5;
LABEL_9:
    if (*(_DWORD *)(a1 + 3512) >= *(_DWORD *)(a1 + 3508) || !*(_BYTE *)(a1 + 3520))
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"All Rf configs are set");
      a2 = 0;
      goto LABEL_12;
    }
    goto LABEL_5;
  }
  if (!(_DWORD)a2)
    goto LABEL_9;
LABEL_5:
  sub_21986607C(a1, *(_QWORD *)(a1 + 2912), 1);
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCfgProc");
  return a2;
}

uint64_t sub_219867070(uint64_t a1, int a2)
{
  uint64_t v4;
  uint64_t v5;
  char v6;
  uint64_t (**v7)();
  uint64_t (*v8)();
  uint64_t v9;
  uint64_t v10;
  int v11;
  char v13;
  uint64_t (**v14)();
  uint64_t (*v15)();
  int v16;

  v16 = 8;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetPropRfCfgComplete");
  if (a1)
  {
    if (a2)
    {
      if (a2 == 147 && *(_DWORD *)(a1 + 3148) == 2)
        goto LABEL_5;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"IoctlSetPropRfCfgComplete: Failed");
      if (a2 == 143)
        v4 = 143;
      else
        v4 = 255;
LABEL_17:
      v10 = 146;
LABEL_26:
      v5 = sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v10, v4, 0, 0);
      goto LABEL_27;
    }
    sub_21988ED38(*(_QWORD *)(a1 + 2952), &v16);
    if (*(_BYTE *)(a1 + 3520))
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Re-Initialize the sequence to perform set config");
      *(_QWORD *)(a1 + 2912) = gphLibNfc_IoctlSetPropRfConfig;
      *(_BYTE *)(a1 + 2904) = 0;
      *(_BYTE *)(a1 + 2906) = 0;
      v6 = (char)gphLibNfc_IoctlSetPropRfConfig[0];
      if (gphLibNfc_IoctlSetPropRfConfig[0])
      {
        v6 = 0;
        v7 = off_2550A0AC8;
        do
        {
          ++v6;
          v8 = *v7;
          v7 += 2;
        }
        while (v8);
      }
      *(_BYTE *)(a1 + 2905) = v6;
      v9 = sub_2198655FC(a1, 0, 0);
      v4 = v9;
      if ((_DWORD)v9 != 13 && (_DWORD)v9 != 143)
      {
        v4 = 255;
        goto LABEL_25;
      }
      goto LABEL_24;
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"All Rf configs are set");
    v11 = *(unsigned __int8 *)(a1 + 5408);
    if (*(_BYTE *)(a1 + 5400) == 1)
    {
      if (v11 != 1)
      {
LABEL_29:
        if (*(_DWORD *)(a1 + 5404) == 1)
        {
          sub_21990145C(*(_QWORD *)(a1 + 3040), 1);
          sub_2199014F4(*(_QWORD *)(a1 + 3040), *(_BYTE *)(a1 + 5404));
        }
        goto LABEL_31;
      }
    }
    else if (v11 != 1)
    {
      if (*(_BYTE *)(a1 + 5401) != 1)
      {
LABEL_5:
        v4 = 0;
LABEL_25:
        v10 = 145;
        goto LABEL_26;
      }
      goto LABEL_29;
    }
    sub_21990135C(*(_QWORD *)(a1 + 3040), *(_BYTE *)(a1 + 5404));
    sub_2199014F4(*(_QWORD *)(a1 + 3040), *(_BYTE *)(a1 + 5404));
    if (v16 == 6)
    {
      sub_21990145C(*(_QWORD *)(a1 + 3040), 1);
      sub_21990135C(*(_QWORD *)(a1 + 3040), 1);
      v4 = phTmlNfc_IoCtl();
      if ((_DWORD)v4)
      {
LABEL_24:
        if ((_DWORD)v4 != 13)
          goto LABEL_25;
        goto LABEL_35;
      }
    }
LABEL_31:
    *(_BYTE *)(a1 + 5408) = 0;
    *(_WORD *)(a1 + 5400) = 0;
    *(_WORD *)(a1 + 2882) = 256;
    *(_BYTE *)(a1 + 2884) = 0;
    *(_QWORD *)(a1 + 2912) = off_2550A10F0;
    *(_BYTE *)(a1 + 2904) = 0;
    *(_BYTE *)(a1 + 2906) = 0;
    v13 = (char)off_2550A10F0[0];
    if (off_2550A10F0[0])
    {
      v13 = 0;
      v14 = off_2550A1100;
      do
      {
        ++v13;
        v15 = *v14;
        v14 += 2;
      }
      while (v15);
    }
    *(_BYTE *)(a1 + 2905) = v13;
    if (sub_2198655FC(a1, 0, 0) != 13)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"NFCC Re-Init failed, return failed");
      sub_21987A7D4(a1);
      sub_21990145C(*(_QWORD *)(a1 + 3040), 0);
      v4 = 137;
      goto LABEL_17;
    }
LABEL_35:
    v5 = 13;
    goto LABEL_27;
  }
  sub_219850628(2, 0, 4u, 1u, (uint64_t)"Invalid parameter, Libnfc Context is Invalid");
  v5 = 255;
LABEL_27:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetPropRfCfgComplete");
  return v5;
}

uint64_t sub_21986738C(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  unsigned int *v5;
  char v6;
  uint64_t (**v7)();
  uint64_t (*v8)();
  uint64_t v9;
  _BOOL4 v10;
  _BOOL4 v11;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetCfgSignedComplete");
  if (!a1)
  {
    v9 = 255;
    goto LABEL_21;
  }
  v4 = 146;
  if ((_DWORD)a2 == 143 || (_DWORD)a2 == 130)
  {
LABEL_20:
    v9 = sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v4, a2, 0, 0);
    goto LABEL_21;
  }
  if ((_DWORD)a2)
  {
    v10 = *(_DWORD *)(a1 + 3148) == 2;
    v11 = a2 == 147;
    if (v11 && v10)
      a2 = 0;
    else
      a2 = 255;
    if (v11 && v10)
      v4 = 145;
    else
      v4 = 146;
    goto LABEL_20;
  }
  v5 = (unsigned int *)(a1 + 19368);
  if (*(_DWORD *)(a1 + 3512) >= *(_DWORD *)(a1 + 3508))
  {
    sub_219850628(1, v5, 4u, 4u, (uint64_t)"All Rf configs are set");
    a2 = 0;
    v4 = 145;
    goto LABEL_20;
  }
  sub_219850628(1, v5, 4u, 4u, (uint64_t)"Re-Initialize the sequence to perform set signed config");
  *(_QWORD *)(a1 + 2912) = gphLibNfc_IoctlSetPropConfigSigned;
  *(_BYTE *)(a1 + 2904) = 0;
  *(_BYTE *)(a1 + 2906) = 0;
  v6 = (char)gphLibNfc_IoctlSetPropConfigSigned[0];
  if (gphLibNfc_IoctlSetPropConfigSigned[0])
  {
    v6 = 0;
    v7 = off_2550A0BA8;
    do
    {
      ++v6;
      v8 = *v7;
      v7 += 2;
    }
    while (v8);
  }
  *(_BYTE *)(a1 + 2905) = v6;
  if (sub_2198655FC(a1, 0, 0) != 13)
  {
    v4 = 145;
    a2 = 255;
    goto LABEL_20;
  }
  v9 = 13;
LABEL_21:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetCfgSignedComplete");
  return v9;
}

uint64_t sub_219867504(uint64_t a1)
{
  int v2;
  unsigned int v3;
  char v4;
  unsigned int v5;
  uint64_t v6;
  unsigned __int8 v7;
  unsigned __int8 v8;
  uint64_t v9;
  _OWORD v11[16];
  uint64_t v12;

  v12 = *MEMORY[0x24BDAC8D0];
  memset(v11, 0, 255);
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCfgCmd");
  if (a1)
  {
    v2 = 0;
    v3 = *(unsigned __int8 *)(a1 + 3520);
    v4 = v3 - 27;
    if (v3 >= 0x1C)
    {
      v5 = 27;
    }
    else
    {
      v4 = 0;
      v5 = *(unsigned __int8 *)(a1 + 3520);
    }
    *(_BYTE *)(a1 + 3520) = v4;
    LOBYTE(v11[0]) = v5;
    v6 = *(_QWORD *)(a1 + 3528);
    v7 = 1;
    do
    {
      v8 = *(_BYTE *)(v6 + 1) + 2;
      phOsalNfc_MemCopy();
      v6 = *(_QWORD *)(a1 + 3528) + v8;
      *(_QWORD *)(a1 + 3528) = v6;
      v7 += v8;
      ++v2;
    }
    while (v5 > v2);
    v9 = sub_2198FFF88(*(_QWORD *)(a1 + 3040), (uint64_t)v11, v7, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v9 = 1;
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_IoctlSetRfCfgCmd, Libnfc Context is Invalid");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCfgCmd");
  return v9;
}

uint64_t sub_219867684(uint64_t a1, int a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  uint64_t v10;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCfgComplete");
  if (a1)
  {
    if (a2)
    {
      if (a2 != 147 || *(_DWORD *)(a1 + 3148) != 2)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"IoctlSetRfCfgComplete: Failed");
        if (a2 == 143)
          v4 = 143;
        else
          v4 = 255;
        v5 = 146;
        goto LABEL_20;
      }
      goto LABEL_19;
    }
    if (!*(_BYTE *)(a1 + 3520))
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"All Rf configs are set");
LABEL_19:
      v4 = 0;
      v5 = 145;
LABEL_20:
      v6 = sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v5, v4, 0, 0);
      goto LABEL_21;
    }
    *(_QWORD *)(a1 + 2912) = gphLibNfc_IoctlSetRfConfig;
    *(_BYTE *)(a1 + 2904) = 0;
    *(_BYTE *)(a1 + 2906) = 0;
    v7 = (char)gphLibNfc_IoctlSetRfConfig[0];
    if (gphLibNfc_IoctlSetRfConfig[0])
    {
      v7 = 0;
      v8 = off_2550A0B18;
      do
      {
        ++v7;
        v9 = *v8;
        v8 += 2;
      }
      while (v9);
    }
    *(_BYTE *)(a1 + 2905) = v7;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Re-Initialize the sequence to perform set config");
    v10 = sub_2198655FC(a1, 0, 0);
    v6 = v10;
    if ((_DWORD)v10 != 13)
    {
      v5 = 145;
      if ((_DWORD)v10 == 143)
        v4 = 143;
      else
        v4 = 255;
      goto LABEL_20;
    }
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Invalid parameter, Libnfc Context is Invalid");
    v6 = 255;
  }
LABEL_21:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCfgComplete");
  return v6;
}

uint64_t sub_219867830(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  unsigned int *v6;
  const char *v7;
  int v8;
  unsigned int *v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldGetFwVersion");
  if (!a1)
  {
    v7 = "phLibNfc_DnldGetFwVersion: Invalid LIBNFC context!!";
    v8 = 2;
    v9 = 0;
LABEL_8:
    sub_219850628(v8, v9, 4u, 1u, (uint64_t)v7);
    v5 = 255;
    goto LABEL_9;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v11);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v12);
  v2 = v12;
  if (!v12 || (v3 = v11) == 0)
  {
    v9 = (unsigned int *)(a1 + 19368);
    v7 = "phLibNfc_DnldGetFwVersion: Invalid IOCTL context!!";
    v8 = 1;
    goto LABEL_8;
  }
  v4 = v12 + 728;
  *(_QWORD *)(v12 + 752) = v12 + 471;
  *(_DWORD *)(v2 + 760) = 250;
  *(_DWORD *)(v2 + 728) = 241;
  *(_QWORD *)(v2 + 736) = 0;
  *(_DWORD *)(v2 + 744) = 0;
  *(_BYTE *)(v2 + 768) = 0;
  v5 = sub_2199072EC(*(_QWORD *)(v3 + 56), v4, (uint64_t)sub_219865DD0, a1);
  v6 = (unsigned int *)(a1 + 19368);
  if ((_DWORD)v5 == 13)
    sub_219850628(1, v6, 4u, 4u, (uint64_t)"GetVersion Request submitted successfully");
  else
    sub_219850628(1, v6, 4u, 1u, (uint64_t)"GetVersion Request Failed!!");
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldGetFwVersion");
  return v5;
}

uint64_t sub_219867980(uint64_t a1, int a2, unsigned __int8 **a3)
{
  unsigned __int8 *v6;
  uint64_t v7;
  int v8;
  _BYTE *v9;
  int v10;
  int v11;
  int v12;
  BOOL v15;
  int v16;
  int v17;
  BOOL v18;
  BOOL v19;
  uint64_t v20;
  unsigned int v21;
  int v22;
  _BYTE *v23;
  unsigned __int8 *v24;
  __int16 v25;
  uint64_t v26;
  uint64_t v27;
  __int16 v28;
  _BOOL4 v30;
  uint64_t v31;
  unint64_t v32;
  unint64_t v33;
  int v34;
  const char *v35;
  int v36;
  unsigned int *v37;
  int v39;
  __int16 v40;
  unsigned __int8 *v41;
  __int16 v42;
  uint64_t v43;

  v43 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldGetFwVersionApiCb");
  if (a1 && !a2 && a3)
  {
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v43);
    if (v43)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_DnldGetFwVersionApiCb - Request Successful");
      if (*(_QWORD *)(v43 + 56) && *a3)
      {
        phOsalNfc_SetMemory();
        v6 = *a3;
        v7 = v43;
        *(_BYTE *)(v43 + 92) = **a3;
        v8 = *v6;
        v9 = *(_BYTE **)(v7 + 56);
        *v9 = v8;
        v9[1] = v6[1];
        v10 = v6[2];
        v9[2] = v10;
        *(_BYTE *)(v7 + 94) = v10;
        v11 = sub_21986C924(*(_QWORD *)(v7 + 8), v8, v10);
        v12 = v11;
        v15 = (v11 & 0xB) == 2 || v11 == 4 || (v11 & 0xD) == 5 || v11 == 3;
        v16 = *((_DWORD *)a3 + 2);
        v17 = v11 & 0xE;
        v18 = v15 && v16 == 7;
        if (v18 || (v17 != 8 ? (v19 = v11 == 10) : (v19 = 1), v19 && v16 == 15))
        {
          v20 = 0;
          v21 = 3;
        }
        else
        {
          if (!v11 || v16 != 9)
          {
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_DnldGetFwVersionApiCb - Incorrect Response!!/Unknown Platform");
            v22 = 0;
            v21 = 3;
            v20 = 255;
LABEL_28:
            v23 = *a3;
            v24 = &(*a3)[v21];
            v25 = *v24;
            v26 = v43;
            v27 = *(_QWORD *)(v43 + 56);
            *(_BYTE *)(v27 + 4) = v25;
            v28 = v24[1];
            *(_BYTE *)(v27 + 3) = v28;
            *(_WORD *)(v26 + 832) = v25 | (v28 << 8);
            v30 = v12 == 10 || v17 == 8;
            if (!v22 || !v30)
              goto LABEL_54;
            v31 = v24[2];
            *(_QWORD *)(v27 + 8) = v31;
            v32 = v31 | ((unint64_t)v24[3] << 8);
            *(_QWORD *)(v27 + 8) = v32;
            v33 = v32 | ((unint64_t)v24[4] << 16);
            *(_QWORD *)(v27 + 8) = v33;
            *(_QWORD *)(v27 + 8) = v33 | ((unint64_t)v24[5] << 24);
            LODWORD(v33) = v24[6];
            *(_WORD *)(v27 + 16) = v33;
            v34 = v33 | (v24[7] << 8);
            *(_WORD *)(v27 + 16) = v33 | (v24[7] << 8);
            if (v12 == 9)
            {
              v39 = 16816;
            }
            else
            {
              if (v12 == 8)
              {
                if (v34 != 1)
                {
LABEL_39:
                  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_DnldGetFwVersionApiCb - Invalid Chip Version!!");
                  v23 = *a3;
                  v27 = *(_QWORD *)(v43 + 56);
                  v20 = 255;
LABEL_53:
                  v40 = v23[v21 | 8];
                  *(_WORD *)(v27 + 18) = v40;
                  v41 = &v23[v21];
                  *(_WORD *)(v27 + 18) = v40 | (v41[9] << 8);
                  v42 = v41[10];
                  *(_WORD *)(v27 + 20) = v42;
                  *(_WORD *)(v27 + 20) = v42 | (v41[11] << 8);
LABEL_54:
                  *(_WORD *)(v27 + 5) = 2563;
                  goto LABEL_45;
                }
LABEL_52:
                v20 = 0;
                goto LABEL_53;
              }
              v39 = 16800;
            }
            if (v34 != v39)
              goto LABEL_39;
            goto LABEL_52;
          }
          v20 = 0;
          v21 = 7;
        }
        v22 = 1;
        goto LABEL_28;
      }
      v35 = "phLibNfc_DnldGetFwVersionApiCb - Response Failed!!";
    }
    else
    {
      v35 = "phLibNfc_DnldGetFwVersionApiCb - Invalid IOCTL Context!!";
    }
    v36 = 1;
    v37 = (unsigned int *)(a1 + 19368);
  }
  else
  {
    v35 = "phLibNfc_DnldGetFwVersionApiCb - Request Failed!!";
    v36 = 2;
    v37 = (unsigned int *)a1;
  }
  sub_219850628(v36, v37, 4u, 1u, (uint64_t)v35);
  v20 = 255;
LABEL_45:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldGetFwVersionApiCb");
  return v20;
}

uint64_t sub_219867C98(uint64_t a1, uint64_t a2)
{
  unsigned __int8 *v4;
  uint64_t v5;
  uint64_t v6;
  int v8;
  uint64_t v9;
  uint64_t v10;

  v4 = (unsigned __int8 *)(a1 + 6026);
  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetFwVersionComplete");
  if (a1)
  {
    v9 = *(_QWORD *)(a1 + 2952);
    sub_21988EB80(v9, &v10);
    if (v4[2] == 1 || v4[5] == 1 || v4[4] == 1)
    {
      v5 = 233;
      if (!(_DWORD)a2)
        goto LABEL_11;
    }
    else
    {
      v8 = *v4;
      if (v8 == 1)
        v5 = 232;
      else
        v5 = 220;
      if (!(_DWORD)a2)
      {
        if (v8 == 1)
          v5 = 232;
        else
          v5 = 219;
        goto LABEL_11;
      }
    }
  }
  else
  {
    if (!(_DWORD)a2)
    {
      v5 = 219;
LABEL_11:
      sub_219850628(0, (unsigned int *)&v9, 4u, 4u, (uint64_t)"GetFwVersion SUCCESS!");
      goto LABEL_12;
    }
    v5 = 220;
  }
  sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"GetFwVersion FAILED!");
LABEL_12:
  if (v10 && a1 && *(_BYTE *)(v10 + 67) == 1 && !*v4 && !v4[3] && !v4[4] && !v4[1])
  {
    *(_BYTE *)(v10 + 67) = 0;
    phOsalNfc_FreeMemory();
    sub_21988EEB4(v9, 0);
  }
  v6 = sub_2198D1714(v9, v5, a2, 0, 0);
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_GetFwVersionComplete");
  return v6;
}

uint64_t sub_219867E3C(uint64_t a1, int a2, unsigned __int8 **a3)
{
  uint64_t v6;
  unsigned __int8 *v7;
  int v8;
  int v9;
  unsigned int v10;
  const char *v11;
  int v12;
  unsigned int *v13;
  int v14;
  int v15;
  uint64_t v16;
  uint64_t v17;
  int v19;
  uint64_t v20;
  __int16 v21;

  v21 = 0;
  v20 = 0;
  v19 = 8;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetDumpDnldGetFwVersionCb");
  if (!a1 || a2 || !a3)
  {
    v11 = "phLibNfc_GetDumpDnldGetFwVersionCb: Request Failed!!";
    v12 = 2;
    v13 = (unsigned int *)a1;
LABEL_33:
    sub_219850628(v12, v13, 4u, 1u, (uint64_t)v11);
    v16 = 255;
    goto LABEL_34;
  }
  sub_21988ED38(*(_QWORD *)(a1 + 2952), &v19);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v20);
  v6 = v20;
  if (!v20)
  {
    v13 = (unsigned int *)(a1 + 19368);
    v11 = "phLibNfc_GetDumpDnldGetFwVersionCb: Invalid IOCTL context!!";
    goto LABEL_32;
  }
  v7 = *a3;
  if (*a3)
  {
    v8 = *v7;
    *(_BYTE *)(v20 + 92) = v8;
    v9 = v7[2];
    *(_BYTE *)(v6 + 94) = v9;
    v10 = sub_21986C924(*(_QWORD *)(v6 + 8), v8, v9);
  }
  else
  {
    v10 = 0;
  }
  v14 = v10 & 0xE;
  if ((v10 - 2 < 4 || v14 == 6) && *((_DWORD *)a3 + 2) == 7)
  {
    v15 = 7;
    goto LABEL_19;
  }
  if (v10 != 10 && v14 != 8)
  {
    if (v10)
    {
      v15 = *((_DWORD *)a3 + 2);
LABEL_24:
      switch(v15)
      {
        case 7:
LABEL_27:
          v16 = 0;
          *(_BYTE *)(a1 + 2946) = 0;
          *(_QWORD *)(a1 + 2937) = 0;
          goto LABEL_34;
        case 15:
          v17 = (uint64_t)*a3;
          if (*a3)
          {
            v16 = 0;
            *(_DWORD *)(a1 + 2940) = 0;
            *(_DWORD *)(a1 + 2937) = 0;
            *(_BYTE *)(a1 + 2944) = 1;
            *(_BYTE *)(v20 + 94) = *(_BYTE *)(v17 + 2);
            goto LABEL_34;
          }
          break;
        case 9:
          goto LABEL_27;
      }
      v13 = (unsigned int *)(a1 + 19368);
      v11 = "phLibNfc_GetDumpDnldGetFwVersionCb: Incorrect Response!!";
      goto LABEL_32;
    }
    v13 = (unsigned int *)(a1 + 19368);
    v11 = "phLibNfc_GetDumpDnldGetFwVersionCb: Platform NOT supported";
LABEL_32:
    v12 = 1;
    goto LABEL_33;
  }
  v15 = *((_DWORD *)a3 + 2);
  if (v15 != 15)
    goto LABEL_24;
LABEL_19:
  if (!*a3)
    goto LABEL_24;
  *(_BYTE *)(a1 + 2937) = 1;
  *(_WORD *)(a1 + 2942) = 0;
  *(_DWORD *)(a1 + 2938) = 0;
  if (v10 - 3 < 3 || v14 == 6)
  {
    *(_BYTE *)(a1 + 2938) = 1;
    if ((v19 & 0xFFFFFFFD) == 4)
    {
      *(_BYTE *)(a1 + 2939) = 1;
      if (*(_BYTE *)(v20 + 94) != 3)
        *(_BYTE *)(v20 + 94) = 1;
      switch(v10)
      {
        case 4u:
          *(_BYTE *)(a1 + 2940) = 1;
          break;
        case 5u:
          *(_BYTE *)(a1 + 2941) = 1;
          break;
        case 6u:
          *(_BYTE *)(a1 + 2942) = 1;
          break;
        case 7u:
          *(_BYTE *)(a1 + 2943) = 1;
          break;
        default:
          goto LABEL_43;
      }
    }
    goto LABEL_43;
  }
  if (v10 != 2)
  {
LABEL_43:
    if (v10 == 10 || v14 == 8)
    {
      *(_BYTE *)(a1 + 2944) = 1;
      if (v10 == 9)
      {
        *(_BYTE *)(a1 + 2945) = 1;
      }
      else if (v10 == 10)
      {
        *(_BYTE *)(a1 + 2946) = 1;
      }
      *(_WORD *)(a1 + 2937) = 0;
      *(_BYTE *)(a1 + 2939) = 0;
      phOsalNfc_MemCopy();
    }
  }
  if (*(_DWORD *)(v20 + 88) == 1)
  {
    v16 = 0;
    if (v10 <= 3 && *(_BYTE *)(v20 + 94) != 1)
    {
      v16 = phTmlNfc_ConfigHsuBaudRate();
      if ((_DWORD)v16)
        sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_GetDumpDnldGetFwVersionCb : Config Hsu Baud Rate failed Status ");
    }
  }
  else
  {
    v16 = 58;
  }
LABEL_34:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetDumpDnldGetFwVersionCb");
  return v16;
}

uint64_t phLibNfc_GetMemoryDumpCmd(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  int v5;
  BOOL v7;
  BOOL v8;
  uint64_t v9;
  uint64_t v10;
  int v11;
  int v12;
  int v13;
  int v14;
  int v15;
  int v16;
  unsigned int v17;
  unsigned int v18;
  uint64_t v19;
  uint64_t Memory;
  uint64_t v21;
  int v22;
  uint64_t v23;
  uint64_t v25;
  uint64_t v26;
  uint64_t v27;

  v25 = 0;
  v26 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDumpCmd");
  if (a1)
  {
    v4 = *(_QWORD *)(a1 + 2952);
    if (v4)
    {
      sub_21988EB80(*(_QWORD *)(a1 + 2952), &v26);
      if (!v26)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_GetMemoryDumpCmd: Invalid IOCTL context!!");
LABEL_53:
        a2 = 255;
        goto LABEL_54;
      }
      v5 = sub_21986C924(*(_QWORD *)(v26 + 8), *(unsigned __int8 *)(v26 + 92), *(unsigned __int8 *)(v26 + 94));
      v7 = *(_BYTE *)(v26 + 94) == 1 || v5 == 4 || v5 == 5;
      if (v7 || *(_BYTE *)(a1 + 2944) == 1 || (v5 != 7 ? (v8 = v5 == 6) : (v8 = 1), v8))
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetMemoryDumpCmd : skip the baud rate update");
        if (!(_DWORD)a2)
        {
LABEL_22:
          sub_21988F460(v4, &v25);
          v9 = v26;
          *(_BYTE *)(v26 + 65) = 0;
          v27 = 0;
          sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ComputeMemDumpAddr");
          sub_21988EC5C(*(_QWORD *)(v9 + 8), &v27);
          v10 = v27;
          if (v27)
          {
            if (*(_BYTE *)(a1 + 2937) != 1 && *(_BYTE *)(a1 + 2938) != 1 && *(_BYTE *)(a1 + 2944) != 1)
            {
              v13 = *(_DWORD *)(v9 + 88);
              if (v13 == 2)
              {
                v12 = 0;
                *(_QWORD *)(v9 + 120) = 0x20FFFF00209000;
                v14 = 2134016;
                v15 = 2162688;
              }
              else if (v13 == 1)
              {
                v12 = 0;
                v14 = 2101444;
                *(_QWORD *)(v9 + 120) = 0x201FBF002010C4;
                v15 = 2105280;
              }
              else
              {
                v12 = 1;
                sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_ComputeMemDumpAddr : Invalid memory Type");
                v14 = 0;
                *(_DWORD *)(v9 + 120) = 0;
                v10 = v27;
                v15 = *(_DWORD *)(v9 + 124) + 1;
              }
              *(_DWORD *)(v10 + 8508) = v14;
              v18 = v15 - v14;
              goto LABEL_43;
            }
            if (*(_DWORD *)(v9 + 88) == 1)
            {
              if (*(_BYTE *)(a1 + 2938) == 1)
              {
                v11 = 2287615;
              }
              else if (*(_BYTE *)(a1 + 2944) == 1)
              {
                if (*(_BYTE *)(a1 + 2946) == 1)
                  v11 = 2154495;
                else
                  v11 = 2351103;
              }
              else
              {
                v11 = 2288639;
              }
              *(_DWORD *)(v9 + 124) = v11;
              sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"dwUsrAreaEndAddr:");
              v12 = 0;
              v16 = *(_DWORD *)(v9 + 124);
              v17 = ((v16 - 0x200000) >> 1) + 0x200000;
              *(_DWORD *)(v9 + 120) = v17;
              *(_DWORD *)(v27 + 8508) = v17;
              v18 = v16 - ((v16 - 0x200000) >> 1) - 0x1FFFFF;
LABEL_43:
              *(_DWORD *)(v9 + 128) = v18;
              goto LABEL_44;
            }
          }
          else
          {
            sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phLibNfc_ComputeMemDumpAddr: Invalid Context");
          }
          v12 = 255;
LABEL_44:
          sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ComputeMemDumpAddr");
          if (v12 || !v25)
          {
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"MEM DUMP Address computation FAILED");
          }
          else
          {
            v19 = *(_QWORD *)(v25 + 56);
            if (v19)
              *(_DWORD *)(v19 + 120) = *(_DWORD *)(v26 + 124);
            Memory = phOsalNfc_GetMemory();
            if (Memory)
            {
              phOsalNfc_SetMemory();
              v21 = v26;
              *(_QWORD *)(v26 + 104) = Memory;
              v22 = *(_DWORD *)(v21 + 128);
              *(_DWORD *)(v21 + 112) = v22;
              *(_QWORD *)(v21 + 752) = Memory;
              *(_DWORD *)(v21 + 760) = v22;
              v23 = v25;
              *(_DWORD *)(v25 + 64) = 1;
              *(_DWORD *)(v21 + 728) = 162;
              *(_DWORD *)(v21 + 732) = *(_DWORD *)(v21 + 120);
              *(_QWORD *)(v21 + 736) = 0;
              *(_DWORD *)(v21 + 744) = 0;
              *(_BYTE *)(v21 + 768) = 0;
              if (sub_2199072EC(*(_QWORD *)(v23 + 56), v21 + 728, (uint64_t)sub_219865DD0, a1) == 13)
              {
                sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_Read Request submitted successfully");
                a2 = 13;
                goto LABEL_54;
              }
              sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_Read Request Failed!!");
            }
          }
          goto LABEL_52;
        }
      }
      else
      {
        a2 = phTmlNfc_ConfigHsuBaudRate();
        if (!(_DWORD)a2)
        {
          sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetMemoryDumpCmd : Success Config Hsu Baud Rate = ");
          goto LABEL_22;
        }
      }
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_GetMemoryDumpCmd : Config Hsu Baud Rate failed Status ");
      if ((_DWORD)a2 == 13)
        goto LABEL_54;
LABEL_52:
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v26 + 104) = 0;
      goto LABEL_53;
    }
  }
LABEL_54:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDumpCmd");
  return a2;
}

uint64_t phLibNfc_GetMemoryDumpRsp(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDumpRsp");
  if ((_DWORD)a2)
  {
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"phLibNfc_GetMemoryDumpRsp - Request Failed!!");
    a2 = 255;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDumpRsp");
  return a2;
}

uint64_t phLibNfc_GetMemoryDumpSeqComplete(unsigned int *a1, uint64_t a2)
{
  unsigned int *v3;
  _BYTE *v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  BOOL v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  int v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;

  v3 = a1;
  v18 = 0;
  v19 = 0;
  v16 = 0;
  v17 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDumpSeqComplete");
  if (!v3)
  {
    v5 = "phLibNfc_GetMemoryDumpSeqComplete: Invalid Context";
    v6 = 2;
    v7 = 0;
LABEL_7:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    a2 = 255;
    goto LABEL_28;
  }
  sub_21988EB80(*((_QWORD *)v3 + 369), &v16);
  if (!v16)
  {
    v7 = v3 + 4842;
    v5 = "phLibNfc_GetMemoryDumpSeqComplete: Invalid IOCTL Context";
    v6 = 1;
    goto LABEL_7;
  }
  v4 = (char *)v3 + 6026;
  sub_21988EC5C(*(_QWORD *)(v16 + 8), &v17);
  if ((_DWORD)a2)
  {
    sub_219850628(1, v3 + 4842, 4u, 1u, (uint64_t)"phLibNfc_GetMemoryDumpSeqComplete: failed!");
LABEL_16:
    if (*((_BYTE *)v3 + 6028) == 1 || *((_BYTE *)v3 + 6031) == 1 || *((_BYTE *)v3 + 6030) == 1)
    {
      v9 = *(_QWORD *)(v16 + 8);
      v10 = 233;
    }
    else
    {
      v9 = *(_QWORD *)(v16 + 8);
      if (*v4 == 1)
        v10 = 232;
      else
        v10 = 220;
    }
    sub_2198D1714(v9, v10, a2, 0, 0);
    goto LABEL_21;
  }
  if (*(_QWORD *)(v16 + 104))
    v8 = v17 == 0;
  else
    v8 = 1;
  if (v8)
  {
    sub_219850628(1, v3 + 4842, 4u, 1u, (uint64_t)"phLibNfc_GetMemoryDumpSeqComplete: failed!");
    if (*(_QWORD *)(v16 + 104))
      a2 = 0;
    else
      a2 = 255;
    goto LABEL_16;
  }
  sub_219850628(1, v3 + 4842, 4u, 4u, (uint64_t)"phLibNfc_GetMemoryDumpSeqComplete: SUCCESS!");
  v18 = v16 + 104;
  if ((*(_DWORD *)(v16 + 88) - 1) > 1)
  {
    v19 = 0;
  }
  else
  {
    v13 = *(_DWORD *)(v16 + 124);
    LODWORD(v19) = *(_DWORD *)(v17 + 8508);
    HIDWORD(v19) = v13;
    *(_DWORD *)(v16 + 112) = v13 - v19 + 1;
    sub_219851790(1, v3 + 4842, 4u, 4u, (uint64_t)"MEM DUMP LENGTH");
    sub_219851790(1, v3 + 4842, 4u, 4u, (uint64_t)"MEM DUMP Start Addr");
    sub_219851790(1, v3 + 4842, 4u, 4u, (uint64_t)"MEM DUMP End Addr");
  }
  if (*((_BYTE *)v3 + 6028) == 1 || *((_BYTE *)v3 + 6031) == 1 || *((_BYTE *)v3 + 6030) == 1)
  {
    v14 = *(_QWORD *)(v16 + 8);
    v15 = 233;
  }
  else
  {
    v14 = *(_QWORD *)(v16 + 8);
    if (*v4 == 1)
      v15 = 232;
    else
      v15 = 219;
  }
  sub_2198D1714(v14, v15, 0, (uint64_t)&v18, 0);
  a2 = 0;
LABEL_21:
  v11 = v16;
  *(_DWORD *)(v16 + 88) = 0;
  if (*(_QWORD *)(v11 + 104))
  {
    phOsalNfc_FreeMemory();
    *(_QWORD *)(v16 + 104) = 0;
  }
  if (!*v4 && !*((_BYTE *)v3 + 6029) && !*((_BYTE *)v3 + 6030) && !*((_BYTE *)v3 + 6027))
  {
    sub_21989A5DC(v3);
    sub_21988EEB4(*(_QWORD *)(v16 + 8), 0);
    sub_21986BE40(*(_QWORD *)(v16 + 8));
    v3 = 0;
  }
LABEL_28:
  sub_219850808(2, v3, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDumpSeqComplete");
  return a2;
}

uint64_t sub_219868A30(uint64_t a1)
{
  uint64_t v2;
  unsigned int *v3;
  const char *v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCfgCmd");
  if (!a1)
  {
    v4 = "Invalid parameter, Libnfc Context is Invalid";
    v2 = 1;
    v5 = 2;
    v3 = 0;
    goto LABEL_5;
  }
  v2 = sub_2198FD738(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 3528), *(unsigned __int8 *)(a1 + 3520), (uint64_t)sub_219865DD0, a1);
  if ((_DWORD)v2 != 13)
  {
    v3 = (unsigned int *)(a1 + 19368);
    v4 = "phLibNfc_IoctlGetRfCfgCmd failed!";
    v5 = 1;
LABEL_5:
    sub_219850628(v5, v3, 4u, 1u, (uint64_t)v4);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCfgCmd");
  return v2;
}

uint64_t sub_219868AEC(uint64_t a1, int a2, unsigned __int8 *a3)
{
  uint64_t v6;
  unsigned int v7;
  uint64_t v8;
  int v9;
  _BOOL4 v10;
  unsigned int v11;
  unsigned int v12;
  unsigned __int8 v13;
  char v14;
  unsigned __int16 v15;
  uint64_t v16;
  unsigned __int8 *v17;
  int v18;
  int v19;
  unsigned __int8 v20;
  unsigned __int16 v21;
  _BOOL4 v22;
  int v23;
  __int16 v24;
  BOOL v26;
  unsigned __int8 v27;
  uint64_t v28;
  uint64_t v30;
  _OWORD v31[16];
  uint64_t v32;

  v32 = *MEMORY[0x24BDAC8D0];
  v30 = 0;
  memset(v31, 0, 255);
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCfgProc");
  if (!a1 || !a3)
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"IoctlGetRfCfgProc, failed");
    v6 = 255;
    goto LABEL_45;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v30);
  v6 = 255;
  if (!a2)
  {
    v7 = *a3;
    if (*a3)
    {
      v8 = v30;
      if (v30)
      {
        switch(a3[1])
        {
          case 0u:
            *(_BYTE *)(a1 + 3520) = v7 - 2;
            if (*(_DWORD *)(*(_QWORD *)(v8 + 48) + 8) >= (v7 - 2))
            {
              if (*(_BYTE *)(a1 + 3545) == 1)
              {
                **(_BYTE **)(a1 + 3536) = **(_BYTE **)(a1 + 3528);
                phOsalNfc_MemCopy();
                v6 = 0;
                ++*(_BYTE *)(a1 + 3520);
              }
              else
              {
                phOsalNfc_MemCopy();
                v6 = 0;
              }
            }
            else
            {
              *(_BYTE *)(a1 + 3520) = 0;
              v6 = 3;
            }
            goto LABEL_45;
          case 1u:
          case 5u:
          case 9u:
            if (*(_BYTE *)(a1 + 2936) == 1)
            {
              v9 = 0;
            }
            else
            {
              if (*(_DWORD *)(a1 + 3148) == 2)
              {
                v10 = *(unsigned __int8 *)(a1 + 2937) != 1;
                v9 = 1;
                goto LABEL_16;
              }
              v9 = 1;
            }
            v10 = 1;
LABEL_16:
            sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Unsupported tag id count ");
            v11 = (unsigned __int16)(*(unsigned __int8 *)(a1 + 3520) - 1);
            if (*(_BYTE *)(a1 + 3520) == 1)
              goto LABEL_44;
            v12 = 0;
            v13 = 0;
            v14 = 0;
            v15 = 0;
            v16 = *(_QWORD *)(a1 + 3528) + 1;
            v17 = a3 + 3;
            break;
          default:
            goto LABEL_45;
        }
        while (1)
        {
          v18 = *(unsigned __int8 *)(v16 + v15);
          if (v7 < 3)
          {
            v20 = 0;
          }
          else
          {
            v19 = 0;
            v20 = 0;
            v21 = 0;
            do
            {
              v22 = 0;
              v23 = v17[v21];
              if (v18 == v23)
                v24 = 2;
              else
                v24 = 1;
              if ((v18 & 0xFE) == 0xA0 && v18 == v23)
              {
                v22 = *(unsigned __int8 *)(v16 + v12 + 1) == v17[v19 + 1];
                if (*(unsigned __int8 *)(v16 + v12 + 1) == v17[v19 + 1])
                  ++v20;
                v24 = 2;
              }
              v21 += v24;
              v19 = v21;
            }
            while ((int)(v7 - 2) > v21 && !v22);
            if (v22)
              goto LABEL_41;
          }
          if (v18 == 160 || (v18 == 161 ? (v26 = (v10 & v9) == 0) : (v26 = 1), !v26))
          {
            *((_BYTE *)v31 + v13) = v18;
            ++v20;
            v27 = v13 + 1;
            v13 += 2;
            *((_BYTE *)v31 + v27) = *(_BYTE *)(v16 + v12 + (unint64_t)v20);
            ++v14;
          }
LABEL_41:
          v15 += v20 + 1;
          v12 = v15;
          if (v11 <= v15)
          {
            if (v14)
            {
              phOsalNfc_SetMemory();
              v28 = v30;
              *(_BYTE *)(v30 + 216) = v13 + 1;
              *(_BYTE *)(v28 + 217) = v14;
              phOsalNfc_MemCopy();
            }
LABEL_44:
            v6 = 147;
            break;
          }
        }
      }
    }
  }
LABEL_45:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCfgProc");
  return v6;
}

uint64_t sub_219868E9C(uint64_t a1, int a2)
{
  uint64_t v4;
  uint64_t v5;
  unsigned int v6;
  unsigned int *v7;
  const char *v8;
  int v9;
  uint64_t v10;
  uint64_t v12;
  char v14;
  uint64_t *v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;

  v18 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCfgComplete");
  if (!a1)
  {
    v8 = "IoctlGetRfCfgComplete,Libnfc Context is Invalid";
    v9 = 2;
    v7 = 0;
    goto LABEL_9;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v18);
  v4 = v18;
  if (!v18 || (v5 = *(_QWORD *)(v18 + 48)) == 0)
  {
    v7 = (unsigned int *)(a1 + 19368);
    v8 = "IoctlGetRfCfgComplete,output buffer is Invalid";
    v9 = 1;
LABEL_9:
    sub_219850628(v9, v7, 4u, 1u, (uint64_t)v8);
    v10 = 255;
    goto LABEL_31;
  }
  if (a2 != 147)
  {
    if (a2)
    {
      if (*(_QWORD *)v5)
      {
        **(_BYTE **)v5 = 0;
        *(_DWORD *)(v5 + 8) = 1;
      }
      if (*(_DWORD *)(a1 + 3148) == 2)
      {
        v6 = 0;
        *(_BYTE *)(a1 + 3544) = 0;
      }
      else if (a2 == 143)
      {
        v6 = 143;
      }
      else
      {
        v6 = 255;
      }
    }
    else
    {
      v6 = 0;
      *(_DWORD *)(v5 + 8) = *(unsigned __int8 *)(a1 + 3520);
      *(_BYTE *)(a1 + 3545) = 0;
    }
LABEL_24:
    if (*(_BYTE *)(a1 + 3544) == 1 && v6 == 0)
      v12 = 18;
    else
      v12 = v6;
    v10 = sub_2198D1B2C(*(_QWORD *)(a1 + 2952), 145, v12, v5, 0);
    *(_WORD *)(a1 + 3544) = 0;
    phOsalNfc_SetMemory();
    goto LABEL_31;
  }
  if (!*(_BYTE *)(v18 + 216) || *(unsigned __int8 *)(v18 + 217) == **(unsigned __int8 **)(a1 + 3528))
  {
    if (*(_QWORD *)v5)
    {
      **(_BYTE **)v5 = 0;
      *(_DWORD *)(v5 + 8) = 1;
    }
    if (*(_DWORD *)(a1 + 3148) == 2)
      v6 = 0;
    else
      v6 = 255;
    goto LABEL_24;
  }
  *(_BYTE *)(a1 + 3544) = 1;
  *(_QWORD *)(a1 + 3536) = *(_QWORD *)v5;
  *(_BYTE *)(a1 + 3520) = *(_BYTE *)(v4 + 216);
  *(_QWORD *)(a1 + 3528) = v4 + 217;
  *(_QWORD *)(a1 + 2912) = gphLibNfc_IoctlGetRfConfig;
  *(_BYTE *)(a1 + 2904) = 0;
  *(_BYTE *)(a1 + 2906) = 0;
  v14 = (char)gphLibNfc_IoctlGetRfConfig[0];
  if (gphLibNfc_IoctlGetRfConfig[0])
  {
    v14 = 0;
    v15 = &qword_2550A0AF8;
    do
    {
      ++v14;
      v16 = *v15;
      v15 += 2;
    }
    while (v16);
  }
  *(_BYTE *)(a1 + 2905) = v14;
  v17 = sub_2198655FC(a1, 0, 0);
  if ((_DWORD)v17 != 13)
  {
    if (*(_QWORD *)v5)
    {
      **(_BYTE **)v5 = 0;
      *(_DWORD *)(v5 + 8) = 1;
    }
    *(_BYTE *)(a1 + 3544) = 0;
    sub_2198D1B2C(*(_QWORD *)(a1 + 2952), 146, v17, v5, 0);
  }
  v10 = 147;
LABEL_31:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCfgComplete");
  return v10;
}

uint64_t sub_2198690F8(uint64_t a1)
{
  uint64_t v2;
  unsigned int *v3;
  const char *v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetSpmiGpioCmd");
  if (!a1)
  {
    v4 = "Invalid parameter, Libnfc Context is Invalid";
    v2 = 1;
    v5 = 2;
    v3 = 0;
    goto LABEL_5;
  }
  v2 = sub_2198FD738(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 3528), *(unsigned __int8 *)(a1 + 3520), (uint64_t)sub_219865DD0, a1);
  if ((_DWORD)v2 != 13)
  {
    v3 = (unsigned int *)(a1 + 19368);
    v4 = "phLibNfc_IoctlGetSpmiGpioCmd failed!";
    v5 = 1;
LABEL_5:
    sub_219850628(v5, v3, 4u, 1u, (uint64_t)v4);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetSpmiGpioCmd");
  return v2;
}

uint64_t sub_2198691B4(uint64_t a1, uint64_t a2, _BYTE *a3)
{
  _WORD *v6;
  unsigned int v7;
  unsigned int v8;
  const char *v9;
  int v10;
  unsigned int *v11;
  uint64_t v13;

  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetSpmiGpioProc");
  if (!a1 || !a3)
  {
    v9 = "phLibNfc_IoctlGetSpmiGpioProc, failed";
    v10 = 2;
    v11 = (unsigned int *)a1;
LABEL_12:
    sub_219850628(v10, v11, 4u, 1u, (uint64_t)v9);
    goto LABEL_13;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v13);
  if (!v13)
  {
    v11 = (unsigned int *)(a1 + 19368);
    v9 = "phLibNfc_IoctlGetSpmiGpioProc: Invalid LIBNFC context!!";
LABEL_11:
    v10 = 1;
    goto LABEL_12;
  }
  if (!(_DWORD)a2)
  {
    if (a3[1])
    {
LABEL_13:
      a2 = 255;
      goto LABEL_14;
    }
    if (*a3 == 7)
    {
      v6 = *(_WORD **)(v13 + 136);
      if (v6)
      {
        a2 = 0;
        v7 = a3[6];
        *v6 = *v6 & 0xFFFE | v7 & 1;
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFFFB | (2 * v7) & 4;
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFFFD | (v7 >> 1) & 2;
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFFF7 | v7 & 8;
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFFEF | v7 & 0x10;
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFFDF | v7 & 0x20;
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFFBF | v7 & 0x40;
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFF7F | v7 & 0x80;
        v8 = a3[7];
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFEFF | ((v8 & 1) << 8);
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFDFF | (((v8 >> 1) & 1) << 9);
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xFBFF | (((v8 >> 2) & 1) << 10);
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xF7FF | (((v8 >> 3) & 1) << 11);
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xEFFF | (((v8 >> 4) & 1) << 12);
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xDFFF | (((v8 >> 5) & 1) << 13);
        **(_WORD **)(v13 + 136) = **(_WORD **)(v13 + 136) & 0xBFFF | (((v8 >> 6) & 1) << 14);
        **(_WORD **)(v13 + 136) = ((_WORD)v8 << 8) & 0x8000 | **(_WORD **)(v13 + 136) & 0x7FFF;
        goto LABEL_14;
      }
    }
    v11 = (unsigned int *)(a1 + 19368);
    v9 = "Expected Payload Mismatch";
    goto LABEL_11;
  }
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetSpmiGpioProc");
  return a2;
}

uint64_t sub_219869474(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  const char *v6;
  int v7;
  unsigned int *v8;
  uint64_t v9;
  uint64_t v11;

  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetSpmiGpioComplete");
  if (!a1)
  {
    v6 = "IoctlGetSpmiGpioComplete, Libnfc Context is Invalid";
    v7 = 2;
    v8 = 0;
LABEL_7:
    sub_219850628(v7, v8, 4u, 1u, (uint64_t)v6);
    v9 = 255;
    goto LABEL_10;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v11);
  v4 = v11;
  if (!v11)
  {
    v8 = (unsigned int *)(a1 + 19368);
    v6 = "phLibNfc_IoctlGetSpmiGpioComplete: Invalid IOCTL context!!";
    v7 = 1;
    goto LABEL_7;
  }
  if ((_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"IoctlGetSpmiGpioComplete: Failed");
    v5 = 146;
    v4 = v11;
  }
  else
  {
    v5 = 145;
  }
  v9 = sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v5, a2, *(_QWORD *)(v4 + 48), 0);
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetSpmiGpioComplete");
  return v9;
}

uint64_t sub_21986957C(uint64_t a1)
{
  uint64_t v2;
  unsigned int *v3;
  const char *v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfRegCmd");
  if (!a1)
  {
    v4 = "phLibNfc_IoctlGetRfRegCmd, Libnfc Context is Invalid";
    v2 = 1;
    v5 = 2;
    v3 = 0;
    goto LABEL_5;
  }
  v2 = sub_2198FD8CC(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 3528), *(unsigned __int8 *)(a1 + 3520), (uint64_t)sub_219865DD0, a1);
  if ((_DWORD)v2 != 13)
  {
    v3 = (unsigned int *)(a1 + 19368);
    v4 = "IoctlGetRfRegCmd failed!";
    v5 = 1;
LABEL_5:
    sub_219850628(v5, v3, 4u, 1u, (uint64_t)v4);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfRegCmd");
  return v2;
}

uint64_t sub_219869638(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCalDataCmd");
  if (a1)
  {
    v5 = sub_219900A7C(*(_QWORD *)(a1 + 3040), a3, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v5 = 1;
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_IoctlSetRfCalDataCmd : Libnfc Context is Invalid");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCalDataCmd");
  return v5;
}

uint64_t sub_2198696D8(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetGetRfCalDataProc");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetGetRfCalDataProc");
  return a2;
}

uint64_t sub_21986973C(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCalDataComplete");
  if (a1)
  {
    v4 = (unsigned int *)(a1 + 19368);
    if ((_DWORD)a2)
    {
      sub_219850628(1, v4, 4u, 2u, (uint64_t)"Set Rf calibration data signed failed");
      v5 = 146;
    }
    else
    {
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"Set Rf calibration data signed passed");
      v5 = 145;
    }
    v6 = sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v5, a2, 0, 0);
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_IoctlSetRfCalDataComplete: Invalid LIBNFC context!!");
    v6 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetRfCalDataComplete");
  return v6;
}

uint64_t sub_219869820(uint64_t a1, uint64_t a2, _QWORD *a3)
{
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCalDataCmd");
  if (a1)
  {
    v5 = sub_219900BB4(*(_QWORD *)(a1 + 3040), a3, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v5 = 1;
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_IoctlGetRfCalDataCmd : Libnfc Context is Invalid");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCalDataCmd");
  return v5;
}

uint64_t sub_2198698C0(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;

  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCalDataComplete");
  if (!a1)
  {
    v6 = 2;
    v7 = 0;
LABEL_7:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)"phLibNfc_IoctlGetRfCalDataComplete: Invalid LIBNFC context!!");
    a2 = 255;
    goto LABEL_12;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v9);
  if (!v9)
  {
    v7 = (unsigned int *)(a1 + 19368);
    v6 = 1;
    goto LABEL_7;
  }
  if ((_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Get Rf calibration data signed failed");
    v4 = 0;
    v5 = 146;
  }
  else
  {
    v4 = *(_QWORD *)(v9 + 48);
    if (v4)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Get Rf calibration data signed passed");
      a2 = 0;
      v5 = 145;
    }
    else
    {
      v5 = 146;
      a2 = 255;
    }
  }
  sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v5, a2, v4, 0);
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlGetRfCalDataComplete");
  return a2;
}

uint64_t sub_219869A04(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlLoopbackCmd");
  if (a1)
  {
    v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 19344), a1 + 2712, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_IoctlLoopbackCmd: Libnfc Context is Invalid");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlLoopbackCmd");
  return v2;
}

uint64_t sub_219869AA4(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlMgmt_Transceive_CB");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlMgmt_Transceive_CB");
  return a2;
}

uint64_t sub_219869B08(uint64_t a1, int a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  const char *v9;
  int v10;
  unsigned int *v11;
  uint64_t v13;

  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlLoopbackComplete");
  if (!a1)
  {
    v9 = "phLibNfc_IoctlLoopbackComplete: Invalid LIBNFC context!!";
    v10 = 2;
    v11 = 0;
LABEL_15:
    sub_219850628(v10, v11, 4u, 1u, (uint64_t)v9);
    v7 = 255;
    goto LABEL_16;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v13);
  if (!v13)
  {
    v11 = (unsigned int *)(a1 + 19368);
    v9 = "phLibNfc_IoctlLoopbackComplete: Invalid IOCTL context!!";
    v10 = 1;
    goto LABEL_15;
  }
  v6 = *(_QWORD *)(v13 + 48);
  if (!a2 && a3 && v6 && *(_QWORD *)a3)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Loop back transceive success - received data");
    phOsalNfc_MemCopy();
    v7 = 0;
    *(_DWORD *)(v6 + 8) = *(_DWORD *)(a3 + 8);
    v8 = 145;
  }
  else
  {
    if (a2 == 143)
      v7 = 143;
    else
      v7 = 255;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Loop back transceive failed!");
    v8 = 146;
  }
  sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v8, v7, v6, 0);
LABEL_16:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlLoopbackComplete");
  return v7;
}

uint64_t sub_219869C78(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetSysCfgProc");
  if (!a1)
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_IoctlSetRfCfgProc : Libnfc Context is Invalid");
    a2 = 255;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSetSysCfgProc");
  return a2;
}

uint64_t sub_219869CF8(uint64_t a1, uint64_t a2)
{
  uint64_t v5;
  uint64_t v7;

  v7 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSysCfgComplete");
  byte_253E45D58 = 1;
  if (a1)
  {
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v7);
    if (v7)
      *(_BYTE *)(v7 + 824) = 0;
    sub_21988F690(*(_QWORD *)(a1 + 2952), 0);
    if ((_DWORD)a2 == 143 || (_DWORD)a2 == 0)
      v5 = a2;
    else
      v5 = 255;
    a2 = sub_2198D1B2C(*(_QWORD *)(a1 + 2952), 145, v5, 0, 0);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlSysCfgComplete");
  return a2;
}

uint64_t sub_219869DBC(uint64_t a1)
{
  uint64_t v1;
  BOOL v2;
  uint64_t v4;
  uint64_t v5;

  v4 = 0;
  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_DisableDtaMode");
  v1 = sub_21987AB04(v5, &v4);
  if ((_DWORD)v1)
    v2 = 1;
  else
    v2 = v4 == 0;
  if (v2)
  {
    sub_219850628(0, (unsigned int *)&v5, 4u, 1u, (uint64_t)"Ioctl_DisableDtaMode: LIBNFC Not Initialized");
    sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_DisableDtaMode");
    if ((_DWORD)v1)
    {
      sub_2198D2284(v5, 114);
      sub_219886108(v5, v1);
    }
  }
  else
  {
    sub_2198D1B2C(v5, 114, 0, 0, 0);
    sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_DisableDtaMode");
  }
  return v1;
}

uint64_t sub_219869EAC(uint64_t a1)
{
  uint64_t v1;
  BOOL v2;
  uint64_t v4;
  uint64_t v5;

  v4 = 0;
  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_EnableDtaMode");
  v1 = sub_21987AB04(v5, &v4);
  if ((_DWORD)v1)
    v2 = 1;
  else
    v2 = v4 == 0;
  if (v2)
  {
    sub_219850628(0, (unsigned int *)&v5, 4u, 1u, (uint64_t)"Ioctl_EnableDtaMode: LIBNFC Not Initialized");
    sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_EnableDtaMode");
    if ((_DWORD)v1)
    {
      sub_2198D2284(v5, 113);
      sub_219886108(v5, v1);
    }
  }
  else
  {
    sub_2198D1B2C(v5, 113, 0, 0, 0);
    sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_EnableDtaMode");
  }
  return v1;
}

uint64_t sub_219869F9C(uint64_t a1, uint64_t a2, _QWORD *a3)
{
  uint64_t v5;
  BOOL v6;
  uint64_t v7;
  const char *v8;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropGetRfRegs");
  sub_21988EB80(v13, &v11);
  v5 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v5)
    v6 = 1;
  else
    v6 = v12 == 0;
  if (v6)
  {
    v7 = v5;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"Ioctl_PropGetRfRegs: LIBNFC Not Initialized");
    if ((_DWORD)v7 == 13)
      goto LABEL_19;
  }
  else
  {
    if (v11)
    {
      v7 = 1;
      v8 = "Ioctl_PropGetRfRegs: Invalid input parameters";
      if (a2 && a3 && *(_QWORD *)a2 && *a3 && *(_DWORD *)(a2 + 8) >= 2u)
      {
        if (*(_BYTE *)(v12 + 2946) == 1)
        {
          v7 = 51;
          v8 = "Ioctl_PropGetRfRegs: Feature not supported";
        }
        else
        {
          v7 = sub_2198D1B2C(v13, 112, 0, a2, (uint64_t)a3);
          if ((_DWORD)v7 == 13)
            goto LABEL_19;
          v10 = v12;
          *(_QWORD *)(v12 + 3536) = 0;
          *(_QWORD *)(v10 + 3528) = 0;
          *(_QWORD *)(v11 + 48) = 0;
          v8 = "phLibNfc_Ioctl_PropGetRfRegs Failed!!!";
        }
      }
    }
    else
    {
      v7 = 255;
      v8 = "Ioctl_PropGetRfRegs: Invalid IOCTL context";
    }
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)v8);
  }
  sub_2198D2284(v13, 112);
  sub_219886108(v13, v7);
LABEL_19:
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropGetRfRegs");
  return v7;
}

uint64_t sub_21986A134(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  BOOL v7;
  uint64_t v8;
  const char *v9;
  uint64_t v10;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetSpmiGpio");
  v6 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v6)
    v7 = 1;
  else
    v7 = v12 == 0;
  if (v7)
  {
    v8 = v6;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_GetSpmiGpio: LIBNFC Not Initialized");
    if ((_DWORD)v8 == 13)
      goto LABEL_17;
    goto LABEL_16;
  }
  if (!a3 || !*(_QWORD *)a3)
  {
    v8 = 1;
    v9 = "phLibNfc_Ioctl_GetSpmiGpio: Invalid Input Parameter!";
    goto LABEL_15;
  }
  v8 = 1;
  v9 = "phLibNfc_Ioctl_GetSpmiGpio: Invalid Input Parameter!";
  if (!a4 || *(_DWORD *)(a3 + 8) < 4u)
    goto LABEL_15;
  v8 = sub_2198D1B2C(v13, 123, 0, a3, 0);
  if ((_DWORD)v8 != 13)
  {
    v10 = v12;
    *(_QWORD *)(v12 + 3536) = 0;
    *(_QWORD *)(v10 + 3528) = 0;
    v9 = "phLibNfc_Ioctl_GetSpmiGpio Failed!!!";
LABEL_15:
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)v9);
LABEL_16:
    sub_2198D2284(v13, 123);
    sub_219886108(v13, v8);
  }
LABEL_17:
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetSpmiGpio");
  return v8;
}

uint64_t sub_21986A288(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  BOOL v6;
  uint64_t v7;
  const char *v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropGetRfConfig");
  sub_21988EB80(v13, &v11);
  v5 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v5)
    v6 = 1;
  else
    v6 = v12 == 0;
  if (v6)
  {
    v7 = v5;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"Ioctl_PropGetRfConfig: LIBNFC Not Initialized");
    if ((_DWORD)v7 == 13)
      goto LABEL_20;
    goto LABEL_19;
  }
  if (!v11)
  {
    v7 = 255;
    v8 = "Ioctl_PropGetRfConfig: INVALID IOCTL context";
    goto LABEL_18;
  }
  v7 = 1;
  v8 = "Ioctl_PropGetRfConfig: Invalid input parameters";
  if (!a2 || !a3 || !*(_QWORD *)a2 || !*(_QWORD *)a3 || *(_DWORD *)(a2 + 8) < 2u || !*(_DWORD *)(a3 + 8))
    goto LABEL_18;
  v7 = sub_2198D1B2C(v13, 111, 0, a2, a3);
  if ((_DWORD)v7 != 13)
  {
    v9 = v12;
    *(_QWORD *)(v12 + 3536) = 0;
    *(_QWORD *)(v9 + 3528) = 0;
    *(_QWORD *)(v11 + 48) = 0;
    v8 = "Ioctl_PropGetRfConfig Failed!!!";
LABEL_18:
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)v8);
LABEL_19:
    sub_2198D2284(v13, 111);
    sub_219886108(v13, v7);
  }
LABEL_20:
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropGetRfConfig");
  return v7;
}

uint64_t sub_21986A40C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  BOOL v6;
  uint64_t v7;
  const char *v8;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  v10 = 0;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetDnldIntgInfo");
  sub_21988F744(v12, &v10);
  v5 = sub_21987AB04(v12, &v11);
  if ((_DWORD)v5)
    v6 = 0;
  else
    v6 = v10 == 0;
  if (v6)
  {
    v7 = 147;
    v8 = "This API will only be handled only in the Libnfc uninitialized state";
  }
  else
  {
    if (a3 && *(_QWORD *)a3 && *(_DWORD *)(a3 + 8) >= 0x30u)
    {
      v7 = sub_2198D1B2C(v12, 211, v5, a2, 0);
      if ((_DWORD)v7 == 13)
        goto LABEL_12;
      goto LABEL_11;
    }
    v7 = 1;
    v8 = "phLibNfc_Ioctl_GetDnldIntgInfo: Invalid input parameters";
  }
  sub_219850628(0, (unsigned int *)&v12, 4u, 1u, (uint64_t)v8);
LABEL_11:
  sub_2198D2284(v12, 211);
  sub_219886108(v12, v7);
LABEL_12:
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetDnldIntgInfo");
  return v7;
}

uint64_t sub_21986A528(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  BOOL v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropSetRfConfig");
  v3 = sub_21987AB04(v8, &v7);
  if ((_DWORD)v3)
    v4 = 1;
  else
    v4 = v7 == 0;
  if (v4)
  {
    v5 = v3;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"Ioctl_PropSetRfConfig: LIBNFC Not Initialized");
    goto LABEL_7;
  }
  if (a2 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8) > 3u)
  {
    v5 = sub_2198D1B2C(v8, 110, 0, a2, 0);
LABEL_7:
    if ((_DWORD)v5 == 13)
      goto LABEL_14;
    goto LABEL_13;
  }
  v5 = 1;
  sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"Ioctl_PropSetRfConfig: Invalid input parameters");
LABEL_13:
  sub_2198D2284(v8, 110);
  sub_219886108(v8, v5);
LABEL_14:
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropSetRfConfig");
  return v5;
}

uint64_t sub_21986A644(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v5;

  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetSystemConfigs");
  if (a2 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8) > 3u)
  {
    v3 = sub_2198D1B2C(v5, 124, 0, a2, 0);
    if ((_DWORD)v3 == 13)
      goto LABEL_6;
  }
  else
  {
    v3 = 1;
    sub_219850628(0, (unsigned int *)&v5, 4u, 1u, (uint64_t)"Ioctl_SetSpmiSystemConfigs: Invalid input parameters");
  }
  sub_2198D2284(v5, 124);
  sub_219886108(v5, v3);
LABEL_6:
  sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetSystemConfigs");
  return v3;
}

uint64_t sub_21986A720(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  BOOL v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetRfConfig");
  v3 = sub_21987AB04(v8, &v7);
  if ((_DWORD)v3)
    v4 = 1;
  else
    v4 = v7 == 0;
  if (v4)
  {
    v5 = v3;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"Ioctl_SetRfConfig: LIBNFC Not Initialized");
    goto LABEL_7;
  }
  if (a2 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8) > 2u)
  {
    v5 = sub_2198D1B2C(v8, 109, 0, a2, 0);
LABEL_7:
    if ((_DWORD)v5 == 13)
      goto LABEL_14;
    goto LABEL_13;
  }
  v5 = 1;
  sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"Ioctl_SetRfConfig: Invalid input parameters");
LABEL_13:
  sub_2198D2284(v8, 109);
  sub_219886108(v8, v5);
LABEL_14:
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetRfConfig");
  return v5;
}

uint64_t sub_21986A83C(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  char v4;
  char v5;
  unsigned int v6;
  uint64_t v7;
  uint64_t v8;
  unsigned int v9;
  uint64_t v10;
  uint64_t v11;
  int v12;
  const char *v13;
  int v15;
  uint64_t v16;
  _BYTE *v17;
  uint64_t v18;
  uint64_t v19;

  v3 = 0;
  v18 = 0;
  v19 = a1;
  v17 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (*((_QWORD *)&unk_253E46700 + 14 * v3) == a1)
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
      goto LABEL_9;
  }
  v6 = *((_DWORD *)&unk_253E46700 + 28 * v3 + 2);
  if (v6 > 1)
  {
LABEL_9:
    v8 = 0;
    goto LABEL_10;
  }
  v7 = *((_QWORD *)&unk_253E46700 + 14 * v6 + 10);
  if (v7)
    v8 = v7 + 120;
  else
    v8 = 0;
LABEL_10:
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_NfccTimerCfg");
  sub_21988EDF4(v19, &v17);
  sub_21988EB80(v19, &v18);
  if (!v18 || !v17)
  {
    sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_NfccTimerCfg: Invalid IOCTL/LIBNFC context !");
    if (!v8)
    {
      v11 = 255;
      goto LABEL_26;
    }
    *(_DWORD *)(v8 + 36) = 112;
    v10 = v19;
    v11 = 255;
    v12 = 255;
    goto LABEL_24;
  }
  if (!a2 || !*(_QWORD *)a2 || (v9 = *(_DWORD *)(a2 + 8), v9 >= 3) && *(_DWORD *)(v18 + 72) != 242)
  {
    v13 = "phLibNfc_Ioctl_NfccTimerCfg: Invalid Input Parameter!";
    goto LABEL_22;
  }
  if (v17[2946] == 1)
  {
    sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_NfccTimerCfg: Feature not supported!");
    if (v8)
    {
      *(_DWORD *)(v8 + 36) = 112;
      v10 = v19;
      v11 = 51;
      v12 = 51;
LABEL_24:
      sub_219886108(v10, v12);
      goto LABEL_26;
    }
LABEL_38:
    v11 = 51;
    goto LABEL_26;
  }
  v15 = *(_DWORD *)(v18 + 72);
  if (v15 <= 228)
  {
    if (v15 != 220)
    {
      if (v15 == 221)
      {
        v16 = 117;
        goto LABEL_42;
      }
      goto LABEL_39;
    }
    v16 = 115;
LABEL_42:
    v11 = sub_2198D1B2C(v19, v16, 0, a2, 0);
    if ((_DWORD)v11 == 13)
      goto LABEL_26;
    goto LABEL_43;
  }
  if (v15 == 229)
  {
    v16 = 116;
    goto LABEL_42;
  }
  if (v15 == 242)
  {
    if (v17[2938] != 1 && v17[2939] != 1 && v17[2944] != 1)
      goto LABEL_38;
    v16 = 125;
    if ((v9 & 0xFFFFFFFE) != 2)
    {
      v11 = 1;
LABEL_43:
      sub_2198D2284(v19, v16);
      v10 = v19;
      v12 = v11;
      goto LABEL_24;
    }
    goto LABEL_42;
  }
LABEL_39:
  v13 = "phLibNfc_Ioctl_NfccTimerCfg: Invalid IOCTL code!";
LABEL_22:
  v11 = 1;
  sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)v13);
  if (v8)
  {
    *(_DWORD *)(v8 + 36) = 112;
    v10 = v19;
    v12 = 1;
    goto LABEL_24;
  }
LABEL_26:
  sub_219850808(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_NfccTimerCfg");
  return v11;
}

uint64_t sub_21986AAE4(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PrbsTest");
  v3 = sub_21987AB04(v8, &v7);
  if (a2 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8))
  {
    if (v7)
    {
      v4 = sub_2198D1B2C(v8, 108, v3, a2, 0);
      if ((_DWORD)v4 == 13)
        goto LABEL_10;
      goto LABEL_9;
    }
    v4 = 49;
    v5 = "Ioctl_PrbsTest: LIBNFC Not Initialized";
  }
  else
  {
    v4 = 1;
    v5 = "Ioctl_PrbsTest: Invalid Input Parameter!";
  }
  sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)v5);
LABEL_9:
  sub_2198D2284(v8, 108);
  sub_219886108(v8, v4);
LABEL_10:
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PrbsTest");
  return v4;
}

uint64_t sub_21986ABE0(uint64_t a1)
{
  uint64_t v1;
  uint64_t v2;
  uint64_t v4;
  uint64_t v5;

  v4 = 0;
  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SWP2Test");
  v1 = sub_21987AB04(v5, &v4);
  if (v4)
  {
    v2 = sub_2198D1B2C(v5, 107, v1, 0, 0);
    if ((_DWORD)v2 == 13)
      goto LABEL_6;
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v5, 4u, 1u, (uint64_t)"Ioctl_SWP2Test: LIBNFC Not Initialized");
    v2 = 49;
  }
  sub_2198D2284(v5, 107);
  sub_219886108(v5, v2);
LABEL_6:
  sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SWP2Test");
  return v2;
}

uint64_t sub_21986ACB4(uint64_t a1)
{
  uint64_t v1;
  uint64_t v2;
  uint64_t v4;
  uint64_t v5;

  v4 = 0;
  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SWP1Test");
  v1 = sub_21987AB04(v5, &v4);
  if (v4)
  {
    v2 = sub_2198D1B2C(v5, 106, v1, 0, 0);
    if ((_DWORD)v2 == 13)
      goto LABEL_6;
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v5, 4u, 1u, (uint64_t)"Ioctl_SWP1Test: LIBNFC Not Initialized");
    v2 = 49;
  }
  sub_2198D2284(v5, 106);
  sub_219886108(v5, v2);
LABEL_6:
  sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SWP1Test");
  return v2;
}

uint64_t sub_21986AD88(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  _QWORD *v4;
  _QWORD *v5;
  _QWORD *v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetSpmiGpio");
  sub_21988EB80(v8, &v7);
  if (v7)
  {
    if (a2 && v8 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8))
    {
      v3 = sub_2198D1B2C(v8, 101, 0, (uint64_t)&v8, *(_QWORD *)a2);
      v4 = v7;
      v7[2] = 0;
      *v4 = 0;
      if (!(_DWORD)v3)
        goto LABEL_11;
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 4u, (uint64_t)"phLibNfc_Ioctl_SetSpmiGpio: Invalid driver handle");
      v5 = v7;
      v7[2] = 0;
      *v5 = 0;
      v3 = 1;
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_SetSpmiGpio: Invalid IOCTL context");
    v3 = 255;
  }
  sub_2198D2284(v8, 101);
  sub_219886108(v8, v3);
LABEL_11:
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetSpmiGpio");
  return v3;
}

uint64_t sub_21986AEAC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v4;
  _QWORD *v5;
  _QWORD *v7;
  _QWORD *v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetSpmiErrorRegs");
  sub_21988EB80(v9, &v8);
  if (v8)
  {
    if (a3 && *(_QWORD *)a3 && *(_DWORD *)(a3 + 8) > 5u)
    {
      v4 = sub_2198D1B2C(v9, 102, 0, (uint64_t)&v9, *(_QWORD *)a3);
      v7 = v8;
      v8[2] = 0;
      *v7 = 0;
      if (!(_DWORD)v4)
        goto LABEL_8;
    }
    else
    {
      v4 = 1;
      sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_GetSpmiErrorRegs: Invalid input parameters");
      v5 = v8;
      v8[2] = 0;
      *v5 = 0;
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_GetSpmiErrorRegs: Invalid IOCTL context");
    v4 = 255;
  }
  sub_2198D2284(v9, 102);
  sub_219886108(v9, v4);
LABEL_8:
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetSpmiErrorRegs");
  return v4;
}

uint64_t sub_21986AFD0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v6;
  _QWORD *v7;
  _QWORD *v8;
  _QWORD *v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_ClearSpmiErrorRegs");
  sub_21988EB80(v11, &v10);
  if (v10)
  {
    if (v11)
    {
      v6 = sub_2198D1B2C(v11, 103, 0, (uint64_t)&v11, a5);
      v7 = v10;
      v10[2] = 0;
      *v7 = 0;
      if (!(_DWORD)v6)
        goto LABEL_8;
    }
    else
    {
      v6 = 1;
      sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_ClearSpmiErrorRegs: Invalid input parameters");
      v8 = v10;
      v10[2] = 0;
      *v8 = 0;
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_ClearSpmiErrorRegs: Invalid IOCTL context");
    v6 = 255;
  }
  sub_2198D2284(v11, 103);
  sub_219886108(v11, v6);
LABEL_8:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_ClearSpmiErrorRegs");
  return v6;
}

uint64_t sub_21986B0E0(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v4;
  uint64_t v5;
  _QWORD *v6;
  _QWORD *v8;
  uint64_t v9;
  _QWORD *v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  v9 = 0;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetSpmiConfigRegs");
  sub_21988EB80(v11, &v10);
  if (v10)
  {
    v4 = sub_21987AB04(v11, &v9);
    if (a3 && *(_QWORD *)a3 && *(_DWORD *)(a3 + 8) > 0xDu)
    {
      v5 = sub_2198D1B2C(v11, 104, v4, (uint64_t)&v11, *(_QWORD *)a3);
      v8 = v10;
      v10[2] = 0;
      *v8 = 0;
      if (!(_DWORD)v5)
        goto LABEL_8;
    }
    else
    {
      v5 = 1;
      sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_GetSpmiConfigRegs: Invalid input parameters");
      v6 = v10;
      v10[2] = 0;
      *v6 = 0;
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_GetSpmiConfigRegs: Invalid IOCTL context");
    v5 = 255;
  }
  sub_2198D2284(v11, 104);
  sub_219886108(v11, v5);
LABEL_8:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetSpmiConfigRegs");
  return v5;
}

uint64_t sub_21986B214(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  _QWORD *v5;
  _QWORD *v7;
  uint64_t v8;
  _QWORD *v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  v8 = 0;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetSpmiConfigRegs");
  sub_21988EB80(v10, &v9);
  if (v9)
  {
    v3 = sub_21987AB04(v10, &v8);
    if (a2 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8) > 0xDu)
    {
      v4 = sub_2198D1B2C(v10, 105, v3, (uint64_t)&v10, *(_QWORD *)a2);
      v7 = v9;
      v9[2] = 0;
      *v7 = 0;
      if (!(_DWORD)v4)
        goto LABEL_8;
    }
    else
    {
      v4 = 1;
      sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_SetSpmiConfigRegs: Invalid input parameters");
      v5 = v9;
      v9[2] = 0;
      *v5 = 0;
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_SetSpmiConfigRegs: Invalid IOCTL context");
    v4 = 255;
  }
  sub_2198D2284(v10, 105);
  sub_219886108(v10, v4);
LABEL_8:
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetSpmiConfigRegs");
  return v4;
}

uint64_t sub_21986B348(uint64_t a1)
{
  uint64_t v1;
  uint64_t v2;
  uint64_t v3;
  uint64_t v5;

  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_VenReset");
  if (!v5)
  {
    sub_219850628(0, (unsigned int *)&v5, 4u, 4u, (uint64_t)"phLibNfc_Ioctl_VenReset: Invalid driver handle");
    v3 = 1;
    goto LABEL_15;
  }
  if (sub_2198D24A8(v5) == 3 && sub_2198D23DC(v5) == 1
    || sub_2198D24A8(v5) == 12 && !sub_2198D2C98(v5))
  {
    v1 = v5;
    v2 = 4;
  }
  else
  {
    if (sub_2198D2C98(v5) != 207
      && sub_2198D2C98(v5) != 208
      && sub_2198D2C98(v5) != 209
      && sub_2198D2C98(v5) != 211
      && sub_2198D2C98(v5) != 210)
    {
      v3 = 255;
      goto LABEL_15;
    }
    v1 = v5;
    v2 = 205;
  }
  v3 = sub_2198D1B2C(v1, v2, 0, (uint64_t)&v5, 0);
  if ((_DWORD)v3)
  {
LABEL_15:
    sub_2198D2284(v5, 205);
    sub_219886108(v5, v3);
  }
  sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_VenReset");
  return v3;
}

uint64_t sub_21986B4A8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v4;
  BOOL v5;
  uint64_t v6;
  const char *v7;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  v9 = 0;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_DnldGetDieID");
  sub_21988F744(v11, &v9);
  v4 = sub_21987AB04(v11, &v10);
  if ((_DWORD)v4)
    v5 = 0;
  else
    v5 = v9 == 0;
  if (v5)
  {
    v6 = 147;
    v7 = "This API will only be handled only in the Libnfc uninitialized state";
  }
  else
  {
    if (a3 && *(_QWORD *)a3 && *(_DWORD *)(a3 + 8) >= 0x10u)
    {
      v6 = sub_2198D1B2C(v11, 209, v4, a3, 0);
      if ((_DWORD)v6 == 13)
        goto LABEL_12;
      goto LABEL_11;
    }
    v6 = 1;
    v7 = "phLibNfc_Ioctl_DnldGetDieID: Invalid parameter";
  }
  sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)v7);
LABEL_11:
  sub_2198D2284(v11, 209);
  sub_219886108(v11, v6);
LABEL_12:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_DnldGetDieID");
  return v6;
}

uint64_t sub_21986B5C0(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  const char *v6;
  unsigned int v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_LoopbackTransceive");
  sub_21988EDF4(v10, &v9);
  v5 = 1;
  v6 = "Ioctl_LoopbackTransceive: Invalid input parameters";
  if (a2)
  {
    if (a3)
    {
      if (*(_QWORD *)a3)
      {
        if (*(_DWORD *)(a3 + 8))
        {
          v7 = *(_DWORD *)(a2 + 8);
          if (v7 <= 0xFF && v7 && *(_QWORD *)a2)
          {
            if (v9)
            {
              v5 = sub_2198D1B2C(v10, 100, 0, a2, a3);
              if ((_DWORD)v5 == 13)
                goto LABEL_8;
              goto LABEL_7;
            }
            v5 = 49;
            v6 = "Ioctl_LoopbackTransceive: LIBNFC Not Initialized";
          }
        }
      }
    }
  }
  sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)v6);
LABEL_7:
  sub_2198D2284(v10, 100);
  sub_219886108(v10, v5);
LABEL_8:
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_LoopbackTransceive");
  return v5;
}

uint64_t sub_21986B6E4(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  BOOL v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_ConfigDebugMode");
  v3 = sub_21987AB04(v8, &v7);
  if ((_DWORD)v3)
    v4 = 1;
  else
    v4 = v7 == 0;
  if (v4)
  {
    v5 = v3;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"Ioctl_ConfigDebugMode: LIBNFC Not Initialized");
    if (!(_DWORD)v5)
      goto LABEL_15;
  }
  else if (a2 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8))
  {
    v5 = sub_2198D1B2C(v8, 126, 0, a2, 0);
    if (!(_DWORD)v5)
      goto LABEL_15;
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"Ioctl_ConfigDebugMode: Invalid input parameters");
  }
  sub_2198D2284(v8, 126);
  sub_219886108(v8, v5);
LABEL_15:
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_ConfigDebugMode");
  return v5;
}

uint64_t sub_21986B7FC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  BOOL v7;
  uint64_t v8;
  const char *v9;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_UpdateFirmware");
  sub_21988F744(v13, &v11);
  v6 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v6)
    v7 = 0;
  else
    v7 = v11 == 0;
  if (v7)
  {
    v8 = 147;
    v9 = "This API will only be handled only in the Libnfc uninitialized state";
  }
  else
  {
    if (a4)
    {
      v8 = sub_2198D1B2C(v13, 207, v6, a2, 0);
      if ((_DWORD)v8 == 13)
        goto LABEL_12;
      goto LABEL_11;
    }
    v8 = 1;
    v9 = "NULL callback function passed";
  }
  sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)v9);
LABEL_11:
  sub_2198D2284(v13, 207);
  sub_219886108(v13, v8);
LABEL_12:
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_UpdateFirmware");
  return v8;
}

uint64_t phLibNfc_Mgt_IoCtl(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  const char *v13;
  uint64_t v14;
  char v15;
  uint64_t v16;
  char v17;
  unsigned int v18;
  uint64_t v19;
  uint64_t v20;
  uint64_t v21;
  uint64_t (**v22)();
  uint64_t v24;
  uint64_t v25;
  uint64_t v26;
  uint64_t v27;

  v24 = a1;
  v11 = 1;
  sub_219885F70(0, (unsigned int *)&v24, 4u, 133, (uint64_t)"phLibNfc_Mgt_IoCtl");
  sub_219850718(0, (unsigned int *)&v24, 4u, 5u, (uint64_t)"phLibNfc_Mgt_IoCtl");
  v26 = 0;
  v27 = v24;
  v25 = 0;
  sub_219850718(0, (unsigned int *)&v27, 4u, 5u, (uint64_t)"phLibNfc_Validate_IoctlParam");
  sub_21988EDF4(v27, &v25);
  sub_21988EB80(v27, &v26);
  if (v27)
  {
    v12 = v26;
    if (v26)
    {
      if ((a2 - 192) > 0x33 || ((1 << (a2 + 64)) & 0x800000C000783) == 0)
      {
        if (!a5)
        {
          v12 = 0;
          v13 = "phLibNfc_Validate_IoctlParam: NULL call back";
          goto LABEL_11;
        }
        if (*(_QWORD *)(v26 + 16))
        {
          v12 = 0;
          v11 = 111;
          goto LABEL_12;
        }
      }
      v11 = 0;
      if (a2 <= 2555)
      {
        if ((a2 - 192) <= 0x33 && ((1 << (a2 + 64)) & 0xB000000000781) != 0)
          goto LABEL_12;
LABEL_55:
        if (v25)
        {
LABEL_56:
          v11 = 0;
          goto LABEL_12;
        }
        v11 = 49;
        v13 = "phLibNfc_Validate_IoctlParam: LIBNFC Not Initialized";
        goto LABEL_11;
      }
      if (a2 != 2559)
      {
        if (a2 == 2558)
          goto LABEL_12;
        if (a2 != 2556)
          goto LABEL_55;
      }
      if (a4 && *(_QWORD *)a4 && *(_DWORD *)(a4 + 8) >= 2u)
        goto LABEL_56;
      v11 = 1;
      v13 = "phLibNfc_Validate_IoctlParam: NULL Output buffer";
    }
    else
    {
      v11 = 255;
      v13 = "phLibNfc_Validate_IoctlParam: Invalid IOCTL context";
    }
  }
  else
  {
    v12 = 0;
    v13 = "phLibNfc_Validate_IoctlParam: Invalid Driver handle";
  }
LABEL_11:
  sub_219850628(0, (unsigned int *)&v27, 4u, 1u, (uint64_t)v13);
LABEL_12:
  sub_219850808(0, (unsigned int *)&v27, 4u, 5u, (uint64_t)"phLibNfc_Validate_IoctlParam");
  v14 = 0;
  v15 = 1;
  v16 = v24;
  while (1)
  {
    v17 = v15;
    if (*((_QWORD *)&unk_253E46700 + 14 * v14) == v24)
      break;
    v15 = 0;
    v14 = 1;
    if ((v17 & 1) == 0)
      goto LABEL_22;
  }
  v18 = *((_DWORD *)&unk_253E46700 + 28 * v14 + 2);
  if (v18 > 1)
  {
LABEL_22:
    v20 = 0;
    if (!v12)
    {
LABEL_30:
      if (v20)
      {
        *(_DWORD *)(v20 + 36) = 133;
        sub_219886108(v16, v11);
      }
      sub_219850808(0, (unsigned int *)&v24, 4u, 5u, (uint64_t)"phLibNfc_Mgt_IoCtl");
LABEL_50:
      sub_219885F70(0, (unsigned int *)&v24, 4u, 133, (uint64_t)"phLibNfc_Mgt_IoCtl");
      return v11;
    }
  }
  else
  {
    v19 = *((_QWORD *)&unk_253E46700 + 14 * v18 + 10);
    if (v19)
      v20 = v19 + 120;
    else
      v20 = 0;
    if (!v12)
      goto LABEL_30;
  }
  if ((_DWORD)v11)
    goto LABEL_30;
  if (a2 != 243)
  {
    *(_QWORD *)(v12 + 16) = a5;
    *(_QWORD *)v12 = a6;
    *(_QWORD *)(v12 + 48) = a4;
    *(_DWORD *)(v12 + 72) = a2;
  }
  *(_QWORD *)(v12 + 8) = v16;
  v27 = v16;
  sub_219850718(0, (unsigned int *)&v27, 4u, 5u, (uint64_t)"phLibNfc_Get_IoctlId");
  v21 = 0;
  v22 = &off_24DB72028;
  while (*((_DWORD *)v22 - 2) != a2)
  {
    ++v21;
    v22 += 2;
    if (v21 == 33)
    {
      sub_219850808(0, (unsigned int *)&v27, 4u, 5u, (uint64_t)"phLibNfc_Get_IoctlId");
      goto LABEL_34;
    }
  }
  sub_219850808(0, (unsigned int *)&v27, 4u, 5u, (uint64_t)"phLibNfc_Get_IoctlId");
  if ((v21 & 0xE0) == 0)
  {
    v11 = ((uint64_t (*)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))*v22)(v24, a3, a4, a5, a6);
    goto LABEL_45;
  }
LABEL_34:
  sub_219850628(0, (unsigned int *)&v24, 4u, 1u, (uint64_t)"phLibNfc_Mgt_IoCtl: IOCTL code not supported");
  if (v20)
  {
    *(_DWORD *)(v20 + 36) = 133;
    v11 = 255;
    sub_219886108(v24, 255);
  }
  else
  {
    v11 = 255;
  }
LABEL_45:
  if (a2 != 243 && (_DWORD)v11 && (_DWORD)v11 != 13)
  {
    *(_QWORD *)(v12 + 16) = 0;
    *(_QWORD *)v12 = 0;
  }
  sub_219850808(0, (unsigned int *)&v24, 4u, 5u, (uint64_t)"phLibNfc_Mgt_IoCtl");
  if ((_DWORD)v11 != 13)
    goto LABEL_50;
  return v11;
}

uint64_t sub_21986BD40(unsigned int *a1, _BYTE *a2, int a3)
{
  uint64_t v3;

  LODWORD(v3) = a3;
  sub_219850718(3, a1, 4u, 5u, (uint64_t)"phLibNfc_GetFwVersionCb");
  if (a1)
  {
    if (*((_QWORD *)a1 + 4))
    {
      if ((_DWORD)v3 == 9)
        v3 = 255;
      else
        v3 = v3;
      sub_219885F70(0, a1 + 2, 4u, 12, (uint64_t)"phLibNfc_GetFwVersionCb");
      (*((void (**)(_QWORD, _QWORD, _QWORD, uint64_t))a1 + 4))(*((_QWORD *)a1 + 1), *(_QWORD *)a1, *((_QWORD *)a1 + 7), v3);
      *((_QWORD *)a1 + 4) = 0;
    }
    if (*(_QWORD *)a1)
      *(_QWORD *)a1 = 0;
    if (*((_QWORD *)a1 + 7))
      *((_QWORD *)a1 + 7) = 0;
    if (!a2 || !a2[6026] && !a2[6029] && !a2[6030] && !a2[6027])
      sub_21986BE40(*((_QWORD *)a1 + 1));
  }
  return sub_219850808(3, a1, 4u, 5u, (uint64_t)"phLibNfc_GetFwVersionCb");
}

uint64_t sub_21986BE40(uint64_t a1)
{
  int v1;
  uint64_t v2;
  char v3;
  char v4;
  uint64_t v5;
  const char *v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;

  v14 = a1;
  v12 = 0;
  v13 = 0;
  v10 = 0;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_IoctlClearAbortDnldCtx");
  v1 = v14;
  if (!v14)
  {
    v6 = "phLibNfc_IoctlClearAbortDnldCtx: Invalid Driver Handle!!";
LABEL_27:
    sub_219850628(v1, (unsigned int *)&v14, 4u, 1u, (uint64_t)v6);
    return sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_IoctlClearAbortDnldCtx");
  }
  sub_21988F460(v14, &v12);
  sub_21988EB80(v14, &v11);
  sub_21988EDF4(v14, &v13);
  v2 = 0;
  v3 = 1;
  while (1)
  {
    v4 = v3;
    if (*((_QWORD *)&unk_253E46700 + 14 * v2) == v14)
      break;
    v3 = 0;
    v2 = 1;
    if ((v4 & 1) == 0)
    {
      v5 = 255;
      goto LABEL_8;
    }
  }
  v5 = *((unsigned int *)&unk_253E46700 + 28 * v2 + 2);
LABEL_8:
  if (v12)
  {
    v7 = *(_QWORD *)(v12 + 56);
    if (v7)
    {
      if (sub_2198AE9A8(*(unsigned int **)(v7 + 8496)))
        sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"Failed to perform phNciNfc_ReleaseNciHandle!!");
      v8 = v12;
      *(_QWORD *)(v12 + 40) = 0;
      *(_QWORD *)(v7 + 8496) = 0;
      if (sub_2199056B8(v8))
        sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"Failed to perform phDnldNfc_CoreDeInit!!");
    }
  }
  if (v11)
    *(_BYTE *)(v11 + 92) = 0;
  else
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"Failed to retrieve Ioctl Context!!");
  sub_2198C1BDC(v12);
  sub_21988F744(v14, &v10);
  if (v10)
    sub_219909F14(v10);
  if (v13)
    *(_QWORD *)(v13 + 3040) = 0;
  if (!v11)
  {
    v6 = "phLibNfc_IoctlClearAbortDnldCtx: Invalid IOCTL context!!";
    v1 = 0;
    goto LABEL_27;
  }
  phTmlNfc_ReadAbort();
  phTmlNfc_FlushTxRxBuffers();
  if (sub_21988F8B8(v14) == 1)
  {
    phTmlNfc_WriteAbort();
    sub_21988F804(v14, 0);
  }
  if (*(_DWORD *)(v11 + 192) == 1)
    sub_2198972CC(v5, v14);
  else
    phTmlNfc_IoCtl();
  return sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_IoctlClearAbortDnldCtx");
}

uint64_t sub_21986C070(uint64_t a1, uint64_t a2, unsigned int a3, int a4)
{
  uint64_t v8;
  char v9;
  uint64_t (**v10)();
  uint64_t (*v11)();
  char v13;

  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlRfConfig");
  v8 = 1;
  if (a1)
  {
    if (a2)
    {
      if (a3)
      {
        if ((a4 - 5) <= 2)
        {
          v8 = sub_21986C188(*(_QWORD *)(a1 + 19360), a2, a3, &v13, 2);
          if (!(_DWORD)v8)
          {
            if (v13)
            {
              *(_BYTE *)(a1 + 3520) = v13;
              *(_QWORD *)(a1 + 3528) = a2;
              *(_QWORD *)(a1 + 2912) = gphLibNfc_IoctlSetPropRfConfig;
              *(_BYTE *)(a1 + 2904) = 0;
              *(_BYTE *)(a1 + 2906) = 0;
              v9 = (char)gphLibNfc_IoctlSetPropRfConfig[0];
              if (gphLibNfc_IoctlSetPropRfConfig[0])
              {
                v9 = 0;
                v10 = off_2550A0AC8;
                do
                {
                  ++v9;
                  v11 = *v10;
                  v10 += 2;
                }
                while (v11);
              }
              *(_BYTE *)(a1 + 2905) = v9;
              v8 = sub_2198655FC(a1, 0, 0);
            }
          }
        }
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IoctlRfConfig");
  return v8;
}

uint64_t sub_21986C188(uint64_t a1, uint64_t a2, unsigned int a3, _BYTE *a4, int a5)
{
  char v9;
  unsigned int v10;
  int v11;
  int v12;
  int v13;
  int v14;
  uint64_t v16;
  uint64_t v18;

  v18 = a1;
  sub_219850718(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_ParseInputBuffer");
  if (a2 && a3 && a4)
  {
    v9 = 0;
    v10 = 0;
    if (a5 == 2)
      v11 = 2;
    else
      v11 = 0;
    if (a5 == 2)
      v12 = 3;
    else
      v12 = 0;
    if (a5 == 1)
      v13 = 1;
    else
      v13 = v11;
    if (a5 == 1)
      v14 = 2;
    else
      v14 = v12;
    do
    {
      ++v9;
      v10 += v14 + *(unsigned __int8 *)(a2 + v10 + v13);
    }
    while (v10 < a3);
    if (v10 != a3 || v9 == 0)
    {
      *a4 = 0;
      sub_219850628(0, (unsigned int *)&v18, 4u, 1u, (uint64_t)"Inconsistent input buffer!");
      v16 = 255;
    }
    else
    {
      v16 = 0;
      *a4 = v9;
    }
  }
  else
  {
    if (a4)
      *a4 = 0;
    v16 = 1;
    sub_219850628(0, (unsigned int *)&v18, 4u, 1u, (uint64_t)"Invlaid input parameter");
  }
  sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_ParseInputBuffer");
  return v16;
}

uint64_t sub_21986C2BC(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SwpTest_CB");
  if (a1)
  {
    v4 = (unsigned int *)(a1 + 19368);
    if ((_DWORD)a2)
    {
      sub_219850628(1, v4, 4u, 1u, (uint64_t)"Swp Self test failed");
      v5 = 146;
    }
    else
    {
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"Swp Self test passed");
      v5 = 145;
    }
    sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v5, a2, 0, 0);
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_SwpTest_CB: Invalid LIBNFC context!!");
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SwpTest_CB");
}

uint64_t sub_21986C390(uint64_t a1, uint64_t a2)
{
  const char *v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrbsTest_CB");
  if (a1)
  {
    if ((_DWORD)a2)
      v4 = "Prbs test failed";
    else
      v4 = "Prbs test passed";
    if ((_DWORD)a2)
      v5 = 146;
    else
      v5 = 145;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v4);
    sub_2198D1B2C(*(_QWORD *)(a1 + 2952), v5, a2, 0, 0);
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_SwpTest_CB: Invalid LIBNFC context!!");
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrbsTest_CB");
}

uint64_t sub_21986C460(uint64_t *a1, uint64_t a2, unsigned int a3)
{
  uint64_t v6;
  char v7;
  char v8;
  int v9;
  unsigned int v10;
  const char *v11;
  uint64_t v12;
  unsigned int v13;
  _DWORD *v14;
  uint64_t v15;
  int v16;
  uint64_t v17;
  void (*v18)(uint64_t, uint64_t, uint64_t, uint64_t);
  uint64_t v19;
  uint64_t v20;
  int v21;
  uint64_t v22;
  uint64_t v23;
  uint64_t v24;

  sub_219850718(3, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_Mgmt_CB");
  if (!a1)
    return sub_219850808(3, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_Mgmt_CB");
  v6 = 0;
  v7 = 1;
  do
  {
    v8 = v7;
    if (*((_QWORD *)&unk_253E46700 + 14 * v6) == a1[1])
      break;
    v7 = 0;
    v6 = 1;
  }
  while ((v8 & 1) != 0);
  v9 = *((_DWORD *)a1 + 18);
  v10 = 255;
  if (v9 > 2555)
  {
    if (v9 <= 36896)
    {
      if (v9 != 2556)
      {
        if (v9 == 2558)
        {
          if (a2)
          {
            v17 = a1[6];
            if (v17)
            {
              if (*(_QWORD *)a2 && *(_DWORD *)(a2 + 8) >= 0x16u)
              {
                *(_DWORD *)(v17 + 8) = 16;
                phOsalNfc_MemCopy();
              }
            }
          }
          v11 = "phLibNfc_Ioctl_Mgmt_CB - Download Get DieId complete";
          goto LABEL_62;
        }
        if (v9 != 2559)
          goto LABEL_64;
      }
      v12 = a1[6];
      if (v12 && *(_QWORD *)v12 && *(_DWORD *)(v12 + 8))
      {
        **(_BYTE **)v12 = *((_BYTE *)a1 + 66);
        v13 = sub_21986C924(a1[1], *((unsigned __int8 *)a1 + 92), *((unsigned __int8 *)a1 + 94));
        v14 = (_DWORD *)a1[6];
        if (v14[2] < 2u || v13 < 2)
        {
          v14[2] = 1;
        }
        else
        {
          v14[2] = 2;
          *(_BYTE *)(*(_QWORD *)v14 + 1) = *((_DWORD *)a1 + 24);
        }
      }
      v11 = "phLibNfc_Ioctl_Mgmt_CB - Fw Download test";
    }
    else
    {
      if (v9 <= 37024)
      {
        switch(v9)
        {
          case 36897:
            v11 = "phLibNfc_Ioctl_Mgmt_CB - Swp1 test complete";
            goto LABEL_62;
          case 36900:
            v11 = "phLibNfc_Ioctl_Mgmt_CB - Swp2 test complete";
            goto LABEL_62;
          case 36901:
            v11 = "phLibNfc_Ioctl_Mgmt_CB - Prbs test complete";
            goto LABEL_62;
          case 36902:
            v11 = "phLibNfc_Ioctl_Mgmt_CB - Icotl Set Rf Config complete";
            goto LABEL_62;
          default:
            goto LABEL_64;
        }
        goto LABEL_64;
      }
      switch(v9)
      {
        case 37025:
          v11 = "phLibNfc_Ioctl_Mgmt_CB - Icotl Prop Exten complete";
          break;
        case 37026:
          sub_219850628(0, (unsigned int *)a1 + 2, 4u, 4u, (uint64_t)"phLibNfc_Ioctl_Mgmt_CB - Icotl Prop Exten complete");
          if (a2)
          {
            v10 = a3;
            if (!a3)
            {
              if (*(_QWORD *)a2 && *(_DWORD *)(a2 + 8))
                sub_219851FF8(0, (unsigned int *)a1 + 2, 4u, 4u, (uint64_t)"phLibNfc_Ioctl_Mgmt_CB -Get RF config", *(_QWORD *)a2);
              v10 = 0;
            }
            goto LABEL_64;
          }
          goto LABEL_63;
        case 37027:
          v11 = "phLibNfc_Ioctl_Mgmt_CB - Icotl Prop Get Transition register complete";
          break;
        default:
          goto LABEL_64;
      }
    }
  }
  else
  {
    switch(v9)
    {
      case 218:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Icotl DTA mode Complete";
        break;
      case 219:
      case 227:
      case 230:
      case 231:
      case 232:
      case 233:
      case 234:
      case 235:
      case 236:
      case 237:
      case 238:
      case 239:
      case 240:
        goto LABEL_64;
      case 220:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Icotl Set wait time after Rf Off complete";
        break;
      case 221:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Ioctl VAS Express Set wait time after Rf Off complete";
        break;
      case 222:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Ioctl RF calibration signed data complete";
        break;
      case 223:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Icotl RF calibration signed data complete";
        break;
      case 224:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - RF Signed Config data complete";
        break;
      case 225:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Looop back test";
        break;
      case 226:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Nfcc CRC Config complete";
        break;
      case 228:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Nfcc & eSE power track Config complete";
        break;
      case 229:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Ioctl Generic-A Express Set wait time after Rf Off complete";
        break;
      case 241:
        v15 = a1[6];
        if (v15 && *(_QWORD *)v15)
        {
          if (a3)
          {
            v16 = 0;
          }
          else
          {
            v16 = 48;
            phOsalNfc_SetMemory();
            phOsalNfc_MemCopy();
            phOsalNfc_MemCopy();
            v15 = a1[6];
          }
          *(_DWORD *)(v15 + 8) = v16;
        }
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Get Dnld Integrity Info complete";
        break;
      case 242:
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Icotl Config Swio Sens periodic timer complete";
        break;
      default:
        if (v9 != 193)
          goto LABEL_64;
        v11 = "phLibNfc_Ioctl_Mgmt_CB - Get SPMI GPIO test";
        break;
    }
  }
LABEL_62:
  sub_219850628(0, (unsigned int *)a1 + 2, 4u, 4u, (uint64_t)v11);
LABEL_63:
  v10 = a3;
LABEL_64:
  v18 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t))a1[2];
  if (v18)
  {
    v19 = *a1;
    if (v10 == 9)
      v20 = 255;
    else
      v20 = v10;
    a1[2] = 0;
    *a1 = 0;
    sub_219885F70(0, (unsigned int *)a1 + 2, 4u, 133, (uint64_t)"phLibNfc_Ioctl_Mgmt_CB");
    v21 = *((_DWORD *)a1 + 18);
    if (((v21 - 2556) > 3 || v21 == 2557) && v21 != 241)
    {
      v23 = a1[1];
      v24 = v19;
      v22 = a2;
    }
    else
    {
      v22 = a1[6];
      v23 = a1[1];
      v24 = v19;
    }
    v18(v23, v24, v22, v20);
    a1[6] = 0;
  }
  return sub_219850808(3, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_Mgmt_CB");
}

uint64_t sub_21986C924(uint64_t a1, int a2, int a3)
{
  uint64_t v5;
  unsigned int v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_GetPlatformInfo");
  if (a2 <= 176)
  {
    if ((a2 - 162) < 3)
    {
      v5 = 2;
      goto LABEL_25;
    }
    if (a2 == 66)
    {
      v5 = 1;
      goto LABEL_25;
    }
    if (a2 == 96)
    {
      v5 = 10;
      goto LABEL_25;
    }
    goto LABEL_24;
  }
  if (a2 > 208)
  {
    if ((a2 - 209) <= 2)
    {
      v5 = 9;
      goto LABEL_25;
    }
    goto LABEL_24;
  }
  if ((a2 - 177) < 2)
  {
    if (a3 == 4)
      v6 = 5;
    else
      v6 = 3;
    if (a3 == 3)
      v5 = 4;
    else
      v5 = v6;
  }
  else
  {
    if (a2 != 186)
    {
      if (a2 == 208)
      {
        v5 = 8;
        goto LABEL_25;
      }
LABEL_24:
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_GetPlatformInfo:Unknown platform");
      v5 = 0;
      goto LABEL_25;
    }
    if (a3 == 18)
      v5 = 7;
    else
      v5 = 6;
  }
LABEL_25:
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_GetPlatformInfo");
  return v5;
}

uint64_t sub_21986CA58(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  int v5;
  unsigned int *v6;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldGetSessnState");
  if (!a1)
  {
    v5 = 2;
    v6 = 0;
LABEL_8:
    sub_219850628(v5, v6, 4u, 1u, (uint64_t)"phDnldNfc_DnldGetSessnState: Invalid LIBNFC context!!");
    v4 = 255;
    goto LABEL_9;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v9);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v10);
  v2 = v10;
  if (!v10 || (v3 = v9) == 0)
  {
    v6 = (unsigned int *)(a1 + 19368);
    v5 = 1;
    goto LABEL_8;
  }
  if (*(_BYTE *)(v10 + 64) == 1)
  {
    v4 = 0;
  }
  else
  {
    v8 = v10 + 728;
    *(_QWORD *)(v10 + 752) = v10 + 471;
    *(_DWORD *)(v2 + 760) = 250;
    *(_DWORD *)(v2 + 728) = 242;
    *(_QWORD *)(v2 + 736) = 0;
    *(_DWORD *)(v2 + 744) = 0;
    *(_BYTE *)(v2 + 768) = 0;
    v4 = sub_2199072EC(*(_QWORD *)(v3 + 56), v8, (uint64_t)sub_219865DD0, a1);
    if ((_DWORD)v4 == 13)
      sub_219850628(0, (unsigned int *)(v10 + 8), 4u, 4u, (uint64_t)"GetSessionState Request submitted successfully");
    else
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"GetSessionState Request Failed!!");
  }
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldGetSessnState");
  return v4;
}

uint64_t sub_21986CBC4(uint64_t a1, int a2, _DWORD *a3)
{
  int v6;
  const char *v7;
  int v8;
  unsigned int *v9;
  uint64_t v10;
  const char *v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;

  v15 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldGetSessnStateCb");
  if (!a1)
  {
    v7 = "phDnldNfc_DnldGetSessnStateCb - Invalid libnfc context!!";
    v8 = 2;
    v9 = 0;
LABEL_18:
    sub_219850628(v8, v9, 4u, 1u, (uint64_t)v7);
LABEL_19:
    v10 = 255;
    goto LABEL_20;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v15);
  if (!v15)
  {
    v9 = (unsigned int *)(a1 + 19368);
    v7 = "phDnldNfc_DnldGetSessnStateCb - Invalid IOCTL context!!";
    v8 = 1;
    goto LABEL_18;
  }
  if (a2 || !a3)
  {
    v7 = "phDnldNfc_DnldGetSessnStateCb - Request Failed!!";
LABEL_17:
    v8 = 1;
    v9 = (unsigned int *)(a1 + 19368);
    goto LABEL_18;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldGetSessnStateCb - Request Successful");
  if (a3[2] != 3 || !*(_QWORD *)a3)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldGetSessnStateCb - Session State Resp Buff Invalid...");
    goto LABEL_22;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldGetSessnStateCb - Valid Session State Resp Buff!!...");
  if (*(_BYTE *)(*(_QWORD *)a3 + 2) != 17 && *(_BYTE *)(*(_QWORD *)a3 + 2))
  {
    v7 = "NFCC not in Operational State..Fw Upgrade not allowed!!";
    goto LABEL_17;
  }
  v6 = **(unsigned __int8 **)a3;
  if (v6 == 2)
  {
    if (*(_BYTE *)(v15 + 68) == 1)
    {
      if (*(_BYTE *)(v15 + 836))
        v12 = "Get session state received locked during Degraded FW update!!";
      else
        v12 = "Get session state received locked during FW update!!";
      if (*(_BYTE *)(v15 + 836))
        v10 = 141;
      else
        v10 = 156;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v12);
      *(_BYTE *)(v15 + 836) = 0;
    }
    else if (*(_QWORD *)(a1 + 6056))
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Get session state received locked during Init!!");
      v10 = 136;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Get session state received locked!!");
      v10 = 0;
      *(_WORD *)(v15 + 78) = 156;
    }
  }
  else
  {
    if (v6 == 1)
    {
      if (*(_BYTE *)(v15 + 68) == 1 && *(_BYTE *)(v15 + 836) == 1)
      {
        *(_BYTE *)(v15 + 836) = 0;
        sub_219866158(a1, *(_QWORD *)(a1 + 2912), 2u);
LABEL_22:
        v10 = 0;
        goto LABEL_20;
      }
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Prev Fw Upgrade Session still Open..");
      v14 = v15;
      *(_BYTE *)(v15 + 65) = 1;
      if (*(_BYTE *)(v14 + 68) != 1)
        goto LABEL_22;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Session still Open after Prev Fw Upgrade attempt!!");
      goto LABEL_19;
    }
    v13 = v15;
    if (*(_BYTE *)(v15 + 68) == 1 && *(_BYTE *)(v15 + 836) == 1)
    {
      *(_BYTE *)(v15 + 836) = 0;
      sub_219866158(a1, *(_QWORD *)(a1 + 2912), 2u);
      v13 = v15;
    }
    v10 = 0;
    *(_BYTE *)(v13 + 65) = 0;
  }
LABEL_20:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldGetSessnStateCb");
  return v10;
}

uint64_t sub_21986CECC(uint64_t a1, int a2, _DWORD *a3)
{
  uint64_t v6;
  uint64_t v7;
  const char *v8;
  int v9;
  unsigned int *v10;
  uint64_t v12;
  uint64_t v13;

  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldPrevSessnStateCb");
  if (!a1)
  {
    v8 = "phDnldNfc_DnldPrevSessnStateCb - Invalid libnfc context!!";
    v9 = 2;
    v10 = 0;
LABEL_18:
    sub_219850628(v9, v10, 4u, 1u, (uint64_t)v8);
LABEL_19:
    v7 = 255;
    goto LABEL_20;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v13);
  if (!v13)
  {
    v10 = (unsigned int *)(a1 + 19368);
    v8 = "phDnldNfc_DnldPrevSessnStateCb - Invalid IOCTL context!!";
    v9 = 1;
    goto LABEL_18;
  }
  if (a2 || !a3)
  {
    v8 = "phDnldNfc_DnldPrevSessnStateCb - Request Failed!!";
LABEL_17:
    v9 = 1;
    v10 = (unsigned int *)(a1 + 19368);
    goto LABEL_18;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldPrevSessnStateCb - Request Successful");
  if (a3[2] != 3 || !*(_QWORD *)a3)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldPrevSessnStateCb - Session State Resp Buff Invalid...");
    goto LABEL_22;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldPrevSessnStateCb - Valid Session State Resp Buff!!...");
  if (*(_BYTE *)(*(_QWORD *)a3 + 2) != 17 && *(_BYTE *)(*(_QWORD *)a3 + 2))
  {
    v8 = "NFCC not in Operational State..Fw Upgrade not allowed!!";
    goto LABEL_17;
  }
  if (!**(_BYTE **)a3)
  {
    v7 = 0;
    *(_WORD *)(v13 + 65) = 0;
    goto LABEL_20;
  }
  if (**(_BYTE **)a3 != 2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Prev Fw Upgrade Session still Open..");
    v12 = v13;
    *(_WORD *)(v13 + 65) = 257;
    if (*(_BYTE *)(v12 + 68) == 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Session still Open after Prev Fw Upgrade attempt!!");
      goto LABEL_19;
    }
LABEL_22:
    v7 = 0;
    goto LABEL_20;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Session still Locked..");
  v6 = v13;
  *(_BYTE *)(v13 + 66) = 2;
  if (*(_BYTE *)(a1 + 6026) == 1 || *(_BYTE *)(a1 + 6029) == 1)
  {
    v7 = 156;
  }
  else
  {
    v7 = 0;
    *(_BYTE *)(v6 + 836) = 1;
  }
LABEL_20:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldPrevSessnStateCb");
  return v7;
}

uint64_t sub_21986D118(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;
  unsigned int *v10;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldGetVersion");
  if (!a1)
  {
    v5 = "phDnldNfc_DnldGetVersion - Invalid libnfc context!!";
    v6 = 2;
    v7 = 0;
LABEL_8:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    v4 = 255;
    goto LABEL_9;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v11);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v12);
  v2 = v12;
  if (!v12 || (v3 = v11) == 0)
  {
    v7 = (unsigned int *)(a1 + 19368);
    v5 = "phDnldNfc_DnldGetVersion - Invalid IOCTL context!!";
    v6 = 1;
    goto LABEL_8;
  }
  if (*(_BYTE *)(v12 + 64) == 1)
  {
    v4 = 0;
  }
  else
  {
    v9 = v12 + 728;
    *(_QWORD *)(v12 + 752) = v12 + 471;
    *(_DWORD *)(v2 + 760) = 250;
    *(_DWORD *)(v2 + 728) = 241;
    *(_QWORD *)(v2 + 736) = 0;
    *(_DWORD *)(v2 + 744) = 0;
    *(_BYTE *)(v2 + 768) = 0;
    v4 = sub_2199072EC(*(_QWORD *)(v3 + 56), v9, (uint64_t)sub_219865DD0, a1);
    v10 = (unsigned int *)(a1 + 19368);
    if ((_DWORD)v4 == 13)
      sub_219850628(1, v10, 4u, 4u, (uint64_t)"GetVersion Request submitted successfully");
    else
      sub_219850628(1, v10, 4u, 1u, (uint64_t)"GetVersion Request Failed!!");
  }
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldGetVersion");
  return v4;
}

uint64_t sub_21986D27C(uint64_t a1, int a2, unsigned __int8 **a3)
{
  uint64_t v6;
  unsigned __int8 *v7;
  uint64_t v8;
  unsigned int v9;
  unsigned int v10;
  unsigned __int8 v11;
  int v12;
  int v13;
  __int16 v14;
  BOOL v15;
  char v16;
  int v17;
  unsigned int *v18;
  const char *v19;
  int v20;
  uint64_t v21;
  _BYTE *v23;
  uint64_t v24;
  int v25;
  int v26;
  const char *v27;
  uint64_t v28;
  char v31;
  uint64_t v32;
  char v33;
  uint64_t v34;
  char v37;
  char v38;
  int v39;
  uint64_t v40;
  uint64_t v41;
  char v42;
  unsigned __int8 v43;
  char v44;
  unsigned __int8 v45;
  __int16 v46;

  v46 = 0;
  v40 = 0;
  v41 = 0;
  v39 = 8;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldGetVersionCb");
  if (!a1)
  {
    v19 = "phDnldNfc_DnldGetVersionCb - Invalid libnfc context!!";
    v20 = 2;
    v18 = 0;
    goto LABEL_24;
  }
  sub_21988ED38(*(_QWORD *)(a1 + 2952), &v39);
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v40);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v41);
  if (!v41 || !v40 || (v6 = *(_QWORD *)(v40 + 56)) == 0)
  {
    v18 = (unsigned int *)(a1 + 19368);
    v19 = "phDnldNfc_DnldGetVersionCb - Invalid IOCTL context!!";
    v20 = 1;
LABEL_24:
    sub_219850628(v20, v18, 4u, 1u, (uint64_t)v19);
    v21 = 255;
    goto LABEL_25;
  }
  if (a2 || !a3)
  {
    v19 = "phDnldNfc_DnldGetVersionCb - Request Failed!!";
LABEL_23:
    v20 = 1;
    v18 = (unsigned int *)(a1 + 19368);
    goto LABEL_24;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldGetVersionCb - Request Successful");
  v7 = *a3;
  if (!*a3)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldGetVersionCb - Version Resp Buff Invalid...\n");
    v21 = 0;
    goto LABEL_25;
  }
  v8 = v41;
  *(_BYTE *)(v41 + 92) = *v7;
  v9 = sub_21986C924(*(_QWORD *)(v8 + 8), *v7, v7[2]);
  *(_DWORD *)(v6 + 8480) = v9;
  if (v9 <= 1)
    v10 = 9;
  else
    v10 = 5;
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldGetVersionCb - Valid Version Resp Buff!!...\n");
  v11 = **a3;
  v12 = (*a3)[1];
  v13 = (*a3)[2];
  if (!*(_BYTE *)(v41 + 68))
  {
    v28 = sub_2198C1C60(v40, *(unsigned __int8 ***)(v41 + 184), v9);
    if ((_DWORD)v28)
    {
      v21 = v28;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlFwDnldTrans: Firmware Library Load Failed!!");
      goto LABEL_25;
    }
  }
  phOsalNfc_MemCopy();
  v46 = *(_WORD *)(v41 + 832);
  v14 = *(_WORD *)(v41 + 834);
  phOsalNfc_MemCopy();
  sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"bNewVer[0]");
  sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"bNewVer[1]");
  sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"bCurrVer[0]");
  sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"bCurrVer[1]");
  v15 = v9 == 10 || (v9 & 0xE) == 8;
  v16 = !v15;
  if (v15)
    v17 = (*a3)[v10] | ((*a3)[v10 + 1] << 8) | ((*a3)[v10 | 2] << 16) | ((*a3)[v10 + 3] << 24);
  else
    v17 = 0;
  if ((v12 - 1) >= 3)
  {
    v27 = "ROM Version Check Failed";
    goto LABEL_34;
  }
  if (!v9)
  {
    v19 = "Platform Not Supported";
    goto LABEL_23;
  }
  v23 = (_BYTE *)(a1 + 6027);
  v24 = v41;
  v25 = *(unsigned __int8 *)(v41 + 836);
  v26 = *(unsigned __int8 *)(v41 + 68);
  if (v25 | v26)
  {
    if (v26 != 1)
    {
      if (*(_BYTE *)(v41 + 68))
        goto LABEL_59;
      goto LABEL_41;
    }
    if (v44 == v42 && v45 == v43)
      goto LABEL_59;
    v19 = "Version Not Updated After Download!!\n";
    goto LABEL_23;
  }
  if (v45 < v43)
  {
    v27 = "Version Check Failed - MajorVerNum Mismatch\n";
LABEL_34:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v27);
    v21 = 58;
    goto LABEL_25;
  }
LABEL_41:
  if (v44 == v42 && v45 == v43 && *(_BYTE *)(v41 + 65) != 1)
  {
    *(_BYTE *)(v41 + 93) = v12;
    *(_BYTE *)(v24 + 92) = v11;
    if (v13 != 3 && (v39 & 0xFFFFFFFD) == 4 && v9 == 3)
      v31 = 1;
    else
      v31 = v13;
    *(_BYTE *)(v24 + 94) = v31;
    if (*(_DWORD *)(v24 + 72) != 2556 && v25 != 1 && v17 == *(_DWORD *)(v24 + 828))
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Version Already UpToDate!!\n");
      v21 = 0;
      *(_BYTE *)(v41 + 144) = 1;
      goto LABEL_25;
    }
    if (v25 == 1)
      v38 = v16;
    else
      v38 = 1;
    if ((v38 & 1) == 0)
    {
      if (*v23 == 1 || *(_BYTE *)(a1 + 6030) == 1)
      {
        *(_BYTE *)(v24 + 836) = 0;
        v21 = 156;
        goto LABEL_90;
      }
      if (*(_QWORD *)(v24 + 200))
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Perform Degraded Fw update\n");
        sub_219853E34(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldGetVersionCb : DnldGenNtfCb");
        (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v41 + 200))(*(_QWORD *)(v41 + 8), *(_QWORD *)(v41 + 208), 140, 0);
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Starting degraded host has not registered for download notification.");
      }
    }
    v21 = 0;
LABEL_90:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Forcing FW update even if the version is same !!\n");
    *(_BYTE *)(v41 + 144) = 0;
    goto LABEL_25;
  }
LABEL_59:
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Version Check Successful\n");
  if (*(_BYTE *)(v41 + 68) == 1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Updating Fw & Mw Versions..");
    v21 = 0;
    v32 = v41;
    *(_WORD *)(v41 + 80) = v14;
    *(_WORD *)(v32 + 82) = v46;
  }
  else
  {
    if (*(_BYTE *)(v41 + 836) == 1)
      v33 = v16;
    else
      v33 = 1;
    if ((v33 & 1) == 0)
    {
      if (*v23 == 1 || *(_BYTE *)(a1 + 6030) == 1)
      {
        *(_BYTE *)(v41 + 836) = 0;
        v21 = 156;
        goto LABEL_69;
      }
      if (*(_QWORD *)(v41 + 200))
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Perform Degraded Fw update\n");
        sub_219853E34(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldGetVersionCb : DnldGenNtfCb");
        (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v41 + 200))(*(_QWORD *)(v41 + 8), *(_QWORD *)(v41 + 208), 140, 0);
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Starting degraded host has not registered for download notification.");
      }
    }
    v21 = 0;
  }
LABEL_69:
  v34 = v41;
  *(_BYTE *)(v41 + 93) = v12;
  *(_BYTE *)(v34 + 92) = v11;
  if (v13 != 3 && (v39 & 0xFFFFFFFD) == 4 && v9 == 3)
    v37 = 1;
  else
    v37 = v13;
  *(_BYTE *)(v34 + 94) = v37;
LABEL_25:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldGetVersionCb");
  return v21;
}

uint64_t sub_21986D918(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  const char *v6;
  int v7;
  unsigned int *v8;
  const char *v9;
  int v10;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldWrite");
  if (!a1)
  {
    v9 = "phDnldNfc_DnldWrite - Invalid libnfc context!!";
    v10 = 2;
    v8 = 0;
    goto LABEL_13;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v12);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v13);
  if (!v13 || !v12 || !*(_QWORD *)(v12 + 56))
  {
    v8 = (unsigned int *)(a1 + 19368);
    v9 = "phDnldNfc_DnldWrite - Invalid IOCTL/DNLD/DNLDCORE context!!";
    v10 = 1;
LABEL_13:
    sub_219850628(v10, v8, 4u, 1u, (uint64_t)v9);
    v5 = 255;
    goto LABEL_14;
  }
  if (*(_BYTE *)(v13 + 64) == 1 && !*(_BYTE *)(v13 + 65))
  {
    v5 = 0;
    goto LABEL_14;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldWrite - Incrementing NumDnldTrig..");
  v3 = v12;
  v2 = v13;
  *(_BYTE *)(v13 + 68) = 1;
  v4 = *(_QWORD *)(v3 + 8);
  v5 = 255;
  v6 = "Download Image Primitives extraction failed!!";
  if (!v4)
    goto LABEL_16;
  v7 = *(_DWORD *)(v3 + 16);
  if (!v7)
    goto LABEL_16;
  *(_QWORD *)(v2 + 752) = 0;
  *(_DWORD *)(v2 + 760) = 0;
  *(_DWORD *)(v2 + 728) = 192;
  *(_QWORD *)(v2 + 736) = v4;
  *(_DWORD *)(v2 + 744) = v7;
  *(_BYTE *)(v2 + 768) = *(_BYTE *)(v2 + 836);
  *(_DWORD *)(v2 + 732) = *(_DWORD *)(v2 + 844);
  v5 = sub_2199072EC(*(_QWORD *)(v3 + 56), v2 + 728, (uint64_t)sub_219865DD0, a1);
  if ((_DWORD)v5 != 13)
  {
    v6 = "Write Request Failed!!";
LABEL_16:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v6);
    *(_DWORD *)(v13 + 84) = -1010588251;
    goto LABEL_14;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Write Request submitted successfully");
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldWrite");
  return v5;
}

uint64_t sub_21986DAF4(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;

  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldWriteCb");
  if (!a1)
  {
    v5 = "phDnldNfc_DnldWriteCb: Invalid LIBNFC context!!";
    v6 = 2;
    v7 = 0;
LABEL_11:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    goto LABEL_12;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v11);
  v4 = v11;
  if (!v11)
  {
    v7 = (unsigned int *)(a1 + 19368);
    v5 = "phDnldNfc_DnldWriteCb: Invalid IOCTL context!!";
    v6 = 1;
    goto LABEL_11;
  }
  if (!(_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldWriteCb - Request Successful");
    v9 = v11;
    if (*(_BYTE *)(v11 + 68) == 1)
      *(_DWORD *)(v11 + 84) = -1515863101;
    if (*(_BYTE *)(v9 + 76) == 1)
      *(_BYTE *)(v9 + 76) = 0;
    if (*(_BYTE *)(v9 + 836) != 1)
    {
      a2 = 0;
      goto LABEL_12;
    }
    if (*(_DWORD *)(v9 + 192) == 1)
    {
      a2 = phTmlNfc_IoCtl();
      if ((_DWORD)a2)
      {
LABEL_24:
        v5 = "phDnldNfc_DnldWriteCb [Degreaded FwUpdate] - NFCC Reset Failed";
        v6 = 1;
        v7 = (unsigned int *)(a1 + 19368);
        goto LABEL_11;
      }
      v10 = sub_2198972CC(*(unsigned int *)(a1 + 19368), *(_QWORD *)(v11 + 8));
    }
    else
    {
      v10 = phTmlNfc_IoCtl();
    }
    a2 = v10;
    if (!(_DWORD)v10)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"phDnldNfc_DnldWriteCb [Degreaded FwUpdate] - NFCC Reset Succesful");
      goto LABEL_12;
    }
    goto LABEL_24;
  }
  if (*(_BYTE *)(v11 + 68) == 1)
    *(_DWORD *)(v11 + 84) = -1010588251;
  if ((_DWORD)a2 == 21)
    *(_BYTE *)(v4 + 64) = 1;
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldWriteCb - Request Failed!!");
  a2 = 255;
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldWriteCb");
  return a2;
}

uint64_t sub_21986DCE0(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  int v5;
  const char *v6;
  int v7;
  unsigned int *v8;
  int v10;
  unsigned int v11;
  int v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldChkIntegrity");
  if (!a1)
  {
    v6 = "phDnldNfc_DnldChkIntegrity: Invalid LIBNFC context!!";
    v7 = 2;
    v8 = 0;
LABEL_12:
    sub_219850628(v7, v8, 4u, 1u, (uint64_t)v6);
    goto LABEL_13;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v15);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v16);
  v4 = v16;
  if (!v16 || !v15)
  {
    v8 = (unsigned int *)(a1 + 19368);
    v6 = "phDnldNfc_DnldChkIntegrity: Invalid IOCTL/DNLD context!!";
LABEL_11:
    v7 = 1;
    goto LABEL_12;
  }
  if (*(_BYTE *)(v16 + 64) != 1)
  {
    v5 = *(_DWORD *)(v16 + 72);
    if (*(_BYTE *)(v16 + 65) == 1)
    {
      if (v5 != 241)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Previous Upload session is open..Cannot issue ChkIntegrity Cmd!!");
        goto LABEL_8;
      }
    }
    else if (v5 != 241)
    {
      v10 = *(unsigned __int8 *)(v16 + 92);
      goto LABEL_17;
    }
    v10 = **(unsigned __int8 **)(v16 + 56);
    *(_BYTE *)(v16 + 92) = v10;
LABEL_17:
    v11 = sub_21986C924(*(_QWORD *)(v4 + 8), v10, *(unsigned __int8 *)(v4 + 94));
    v12 = 3;
    phOsalNfc_SetMemory();
    if (v11 <= 1)
    {
      *(_BYTE *)(v16 + 144) = 0;
      phOsalNfc_MemCopy();
      phOsalNfc_MemCopy();
      v12 = 7;
    }
    v13 = v16;
    v14 = v16 + 728;
    *(_QWORD *)(v16 + 752) = v16 + 471;
    *(_DWORD *)(v13 + 760) = 250;
    *(_DWORD *)(v13 + 728) = 224;
    *(_QWORD *)(v13 + 736) = v13 + 216;
    *(_DWORD *)(v13 + 744) = v12;
    *(_BYTE *)(v13 + 768) = 0;
    a2 = sub_2199072EC(*(_QWORD *)(v15 + 56), v14, (uint64_t)sub_219865DD0, a1);
    v8 = (unsigned int *)(a1 + 19368);
    if ((_DWORD)a2 == 13)
    {
      sub_219850628(1, v8, 4u, 4u, (uint64_t)"CheckIntegrity Request submitted successfully");
      goto LABEL_13;
    }
    v6 = "CheckIntegrity Request Failed!!";
    goto LABEL_11;
  }
LABEL_8:
  a2 = 0;
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldChkIntegrity");
  return a2;
}

uint64_t sub_21986DF34(uint64_t a1, int a2, _DWORD *a3)
{
  unsigned int v6;
  int v7;
  unsigned int v8;
  int v9;
  int v10;
  int v11;
  uint64_t v12;
  const char *v13;
  int v14;
  unsigned int *v15;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;
  int v20;
  uint64_t v21;

  v21 = 0;
  v20 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldChkIntegrityCb");
  if (!a1)
  {
    v13 = "phDnldNfc_DnldChkIntegrityCb: Invalid LIBNFC context!!";
    v14 = 2;
    v15 = 0;
LABEL_16:
    sub_219850628(v14, v15, 4u, 1u, (uint64_t)v13);
    v12 = 255;
    goto LABEL_17;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v21);
  if (!v21)
  {
    v15 = (unsigned int *)(a1 + 19368);
    v13 = "phDnldNfc_DnldChkIntegrityCb: Invalid IOCTL context!!";
    v14 = 1;
    goto LABEL_16;
  }
  if (a2 || !a3)
  {
    v13 = "phDnldNfc_DnldChkIntegrityCb - Request Failed!!";
    v14 = 1;
    v15 = (unsigned int *)(a1 + 19368);
    goto LABEL_16;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldChkIntegrityCb - Request Successful");
  v6 = sub_21986C924(*(_QWORD *)(v21 + 8), *(unsigned __int8 *)(v21 + 92), *(unsigned __int8 *)(v21 + 94));
  if (v6 <= 1)
    v7 = 31;
  else
    v7 = 135;
  if (v7 == a3[2] && *(_QWORD *)a3)
  {
    v8 = v6;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldChkIntegrityCb - Valid Resp Buff!!...\n");
    v9 = **(unsigned __int8 **)a3;
    if (v8 < 2)
    {
      v20 = **(unsigned __int8 **)a3;
      if (*(unsigned __int8 *)(v21 + 832) - 252 >= 3)
        v12 = sub_21986F188(*(_QWORD *)(a1 + 2952), v9);
      else
        v12 = 0;
      LOBYTE(v9) = 0;
      LOBYTE(v10) = 0;
    }
    else
    {
      v10 = *(unsigned __int8 *)(*(_QWORD *)a3 + 1);
      phOsalNfc_MemCopy();
      v11 = *(unsigned __int8 *)(v21 + 832);
      if ((v11 - 252) >= 3)
      {
        if (v8 < 3)
        {
          v18 = *(_QWORD *)(a1 + 2952);
          if ((v11 - 161) > 0xE)
            v17 = sub_21986EDF4(v18, v9, v10, 0);
          else
            v17 = phLibNfc_Verify_3_0_CrcStatus_NewLayout(v18, v9, v10, 0);
        }
        else
        {
          v17 = sub_21986E1E4(v21, v9, v10, 0, v8);
        }
        v12 = v17;
      }
      else
      {
        v12 = 0;
      }
    }
    v19 = v21;
    if (*(_DWORD *)(v21 + 72) == 241)
    {
      *(_BYTE *)(v21 + 71) = v9;
      *(_BYTE *)(v19 + 145) = v10;
      *(_DWORD *)(v19 + 148) = v20;
      *(_WORD *)(v19 + 152) = v12;
      v12 = 0;
    }
    phOsalNfc_MemCopy();
    if ((_DWORD)v12 == 255)
      *(_BYTE *)(v21 + 144) = 1;
  }
  else
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldChkIntegrityCb - Resp Buff Invalid...\n");
    v12 = 0;
  }
LABEL_17:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldChkIntegrityCb");
  return v12;
}

uint64_t sub_21986E1E4(uint64_t a1, int a2, int a3, int a4, int a5)
{
  unsigned int v10;
  int v11;
  int v12;
  uint64_t v13;
  int v14;
  const char *v15;
  unsigned int v17;
  __int16 v18;
  int v19;
  uint64_t v20;
  int v21;
  const char *v22;
  int v23;
  unsigned int v24;
  const char *v25;
  const char *v26;
  const char *v27;
  int v28;
  unsigned int v29;
  const char *v30;
  const char *v31;
  uint64_t v32;

  sub_219850718(3, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Verify_4_0_B0_ProcChkIntgRsp");
  if (a1)
  {
    if ((a2 & 0xFE) == 8 && a5 == 3 || (v10 = a5 - 8, (a2 & 0xFE) == 2) && v10 <= 2)
    {
      if (a2 != 2)
      {
        if (a2 == 9)
        {
          if (*(unsigned __int8 *)(a1 + 70) >= 3u)
            goto LABEL_10;
          goto LABEL_25;
        }
        if (a2 != 8)
          goto LABEL_25;
      }
      if (*(unsigned __int8 *)(a1 + 70) > 1u)
      {
LABEL_10:
        sub_219850628(0, (unsigned int *)(a1 + 8), 4u, 1u, (uint64_t)"phLibNfc_Verify_4_0_B0_ProcChkIntgRsp - Failure to recover Customer/Trim area...\n");
        LOWORD(v11) = 255;
LABEL_26:
        sub_219886108(*(_QWORD *)(a1 + 8), 34);
        goto LABEL_27;
      }
LABEL_25:
      *(_BYTE *)(a1 + 71) = a2;
      LOWORD(v11) = 84;
      goto LABEL_26;
    }
    if (v10 < 2)
    {
      v12 = *(unsigned __int8 *)(a1 + 832);
      if ((v12 - 75) >= 0x15 && (v12 - 228) > 0xB)
      {
        v32 = *(_QWORD *)(a1 + 8);
        sub_219850718(0, (unsigned int *)&v32, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_0_CrcStatus");
        if ((a3 + a2) > 0x20)
        {
          LOWORD(v11) = 255;
        }
        else
        {
          if (a3)
          {
            v13 = 0;
            v11 = 0;
            v14 = 1;
            do
            {
              if ((v14 & a4) == 0)
              {
                v15 = "AT Confige Area Crc is NOT OK!!";
                if (v13 <= 3)
                  v15 = off_24DB72248[v13];
                sub_219850628(0, (unsigned int *)&v32, 4u, 1u, (uint64_t)v15);
                v11 = 255;
              }
              v14 *= 2;
              ++v13;
            }
            while (a3 != (_DWORD)v13);
          }
          else
          {
            v11 = 0;
          }
          if (a2)
          {
            v23 = 0;
            v24 = 0x80000000;
            do
            {
              ++v23;
              if ((v24 & a4) == 0)
              {
                switch(v23)
                {
                  case 1:
                    v25 = "Protected Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 2:
                    v25 = "Anti-tearing protected Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 3:
                    v26 = "Customer Area Crc is NOT OK!!";
                    goto LABEL_65;
                  case 4:
                    v26 = "NDEF Area Crc is NOT OK!!";
LABEL_65:
                    sub_219850628(0, (unsigned int *)&v32, 4u, 4u, (uint64_t)v26);
                    break;
                  case 5:
                    v25 = "Mirrored User Flash Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 6:
                    v25 = "Mirrored User Area Protected Crc is NOT OK!!";
                    goto LABEL_76;
                  case 7:
                    v25 = "Mirrored User Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 8:
                    v25 = "Log Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 9:
                    v25 = "Rom Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 10:
                    v25 = "User Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 11:
                    v25 = "User Area Protected Crc is NOT OK!!";
                    goto LABEL_76;
                  case 12:
                    v25 = "Routing Table Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 13:
                    v25 = "HLM debug logging Area Crc is NOT OK!!";
                    goto LABEL_76;
                  case 14:
                    v25 = "RF User Area Crc is NOT OK!!";
                    goto LABEL_76;
                  default:
                    v25 = "End Marker Area Crc is NOT OK!!";
LABEL_76:
                    sub_219850628(0, (unsigned int *)&v32, 4u, 1u, (uint64_t)v25);
                    v11 = 255;
                    break;
                }
              }
              v24 >>= 1;
            }
            while (a2 != v23);
          }
          if (!v11)
            goto LABEL_80;
        }
        sub_219886108(v32, 34);
LABEL_80:
        v27 = "phLibNfc_Verify_5_0_CrcStatus";
LABEL_111:
        sub_219850808(0, (unsigned int *)&v32, 4u, 5u, (uint64_t)v27);
        goto LABEL_27;
      }
      v18 = phLibNfc_Verify_5_0_CrcStatus_NewLayout(*(_QWORD *)(a1 + 8), a2, a3, a4);
LABEL_54:
      LOWORD(v11) = v18;
      goto LABEL_27;
    }
    if (a5 == 10)
    {
      v17 = *(unsigned __int8 *)(a1 + 832);
      if (v17 - 27 >= 0x15)
      {
        if (v17 - 187 >= 0x15)
        {
          v18 = phLibNfc_Verify_5_1_CrcStatus(*(_QWORD *)(a1 + 8), a2, a3, a4);
          goto LABEL_54;
        }
        if (v17 >= 0xBC)
          goto LABEL_31;
      }
      else if (v17 - 28 < 0x14)
      {
LABEL_31:
        v18 = phLibNfc_Verify_5_1_CrcStatus_NewHlmLayout(*(_QWORD *)(a1 + 8), a2, a3, a4);
        goto LABEL_54;
      }
      v18 = phLibNfc_Verify_5_1_CrcStatus_NewLayout(*(_QWORD *)(a1 + 8), a2, a3, a4);
      goto LABEL_54;
    }
    v19 = *(unsigned __int8 *)(a1 + 92);
    if ((v19 + 79) > 1u)
    {
      if (v19 != 186 || (*(_WORD *)(a1 + 832) & 0xF0) != 0xA0)
      {
LABEL_43:
        v32 = *(_QWORD *)(a1 + 8);
        sub_219850718(0, (unsigned int *)&v32, 4u, 5u, (uint64_t)"phLibNfc_Verify_4_0_CrcStatus");
        if ((a3 + a2) > 0x20)
        {
          LOWORD(v11) = 255;
        }
        else
        {
          if (a3)
          {
            v20 = 0;
            v11 = 0;
            v21 = 1;
            do
            {
              if ((v21 & a4) == 0)
              {
                v22 = "Function Table Area Crc is NOT OK!!";
                if (v20 <= 2)
                  v22 = off_24DB72230[v20];
                sub_219850628(0, (unsigned int *)&v32, 4u, 1u, (uint64_t)v22);
                v11 = 255;
              }
              v21 *= 2;
              ++v20;
            }
            while (a3 != (_DWORD)v20);
          }
          else
          {
            v11 = 0;
          }
          if (a2)
          {
            v28 = 0;
            v29 = 0x80000000;
            do
            {
              ++v28;
              if ((v29 & a4) == 0)
              {
                switch(v28)
                {
                  case 1:
                    v30 = "Anti-tearing protected Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 2:
                    v30 = "Anti-tearing RSAKEY Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 3:
                    v30 = "Protected Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 4:
                    v30 = "RSAKEY Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 5:
                    v30 = "ROM Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 6:
                    v30 = "NDEF/LOGGING Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 7:
                    v30 = "Mirrored User Area Protected Crc is NOT OK!!";
                    goto LABEL_106;
                  case 8:
                    v30 = "Mirrored User Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 9:
                    v31 = "Trim Area Crc is NOT OK!!";
                    goto LABEL_100;
                  case 10:
                    v31 = "Customer Area Crc is NOT OK!!";
                    goto LABEL_100;
                  case 11:
                    v30 = "User Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 12:
                    v30 = "RF User Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 13:
                    v31 = "New Banned Area Crc is NOT OK!!";
LABEL_100:
                    sub_219850628(0, (unsigned int *)&v32, 4u, 4u, (uint64_t)v31);
                    break;
                  case 14:
                    v30 = "User Area Protected Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 15:
                    v30 = "Anti-tearing User Area Protected Crc is NOT OK!!";
                    goto LABEL_106;
                  case 16:
                    v30 = "Anti-tearing Mirrored User Area Protected Crc is NOT OK!!";
                    goto LABEL_106;
                  case 17:
                    v30 = "Routing Table Area Crc is NOT OK!!";
                    goto LABEL_106;
                  case 18:
                    v30 = "HLM debug logging Area Crc is NOT OK!!";
                    goto LABEL_106;
                  default:
                    v30 = "End Marker Area Crc is NOT OK!!";
LABEL_106:
                    sub_219850628(0, (unsigned int *)&v32, 4u, 1u, (uint64_t)v30);
                    v11 = 255;
                    break;
                }
              }
              v29 >>= 1;
            }
            while (a2 != v28);
          }
          if (!v11)
            goto LABEL_110;
        }
        sub_219886108(v32, 34);
LABEL_110:
        v27 = "phLibNfc_Verify_4_0_CrcStatus";
        goto LABEL_111;
      }
    }
    else if (*(unsigned __int8 *)(a1 + 832) - 161 >= 0xF)
    {
      goto LABEL_43;
    }
    v18 = phLibNfc_Verify_4_0_CrcStatus_NewLayout(*(_QWORD *)(a1 + 8), a2, a3, a4);
    goto LABEL_54;
  }
  sub_219850628(3, 0, 4u, 1u, (uint64_t)"phLibNfc_Verify_4_0_B0_ProcChkIntgRsp: Invalid IOCTL context!!");
  LOWORD(v11) = 255;
LABEL_27:
  sub_219850808(3, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Verify_4_0_B0_ProcChkIntgRsp");
  return (unsigned __int16)v11;
}

uint64_t phLibNfc_Verify_3_0_CrcStatus_NewLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Verify_3_0_CrcStatus_NewLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_40:
    sub_219886108(v16, 34);
    goto LABEL_41;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_39;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "Function Table Area Crc is NOT OK!!";
      if (v7 <= 2)
        v10 = off_24DB72230[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_37;
          case 2:
            v13 = "Anti-tearing RSAKEY Area Crc is NOT OK!!";
            goto LABEL_37;
          case 3:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_37;
          case 4:
            v13 = "RSAKEY Area Crc is NOT OK!!";
            goto LABEL_37;
          case 5:
            v13 = "ROM Area Crc is NOT OK!!";
            goto LABEL_37;
          case 6:
            v13 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_37;
          case 7:
            v13 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 8:
            v13 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 9:
            v14 = "Trim Area Crc is NOT OK!!";
            goto LABEL_31;
          case 10:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_31;
          case 11:
            v13 = "NDEF/LOGGING Area Crc is NOT OK!!";
            goto LABEL_37;
          case 12:
            v13 = "User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 13:
            v13 = "RF User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 14:
            v14 = "New Banned Area Crc is NOT OK!!";
LABEL_31:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
          case 15:
            v13 = "User Area Protected Area Crc is NOT OK!!";
            goto LABEL_37;
          case 16:
            v13 = "Anti-tearing User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 17:
            v13 = "Anti-tearing Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 18:
            v13 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_37;
          case 19:
            v13 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_37;
          default:
            v13 = "End Marker Area Crc is NOT OK!!";
LABEL_37:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_39:
  if (v8)
    goto LABEL_40;
LABEL_41:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Verify_3_0_CrcStatus_NewLayout");
  return (unsigned __int16)v8;
}

uint64_t sub_21986EDF4(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Verify_3_0_CrcStatus");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_39:
    sub_219886108(v16, 34);
    goto LABEL_40;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_38;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "Function Table Area Crc is NOT OK!!";
      if (v7 <= 2)
        v10 = off_24DB72230[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_36;
          case 2:
            v13 = "Anti-tearing RSAKEY Area Crc is NOT OK!!";
            goto LABEL_36;
          case 3:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_36;
          case 4:
            v13 = "RSAKEY Area Crc is NOT OK!!";
            goto LABEL_36;
          case 5:
            v13 = "ROM Area Crc is NOT OK!!";
            goto LABEL_36;
          case 6:
            v13 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 7:
            v13 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 8:
            v14 = "Trim Area Crc is NOT OK!!";
            goto LABEL_30;
          case 9:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_30;
          case 10:
            v13 = "NDEF/LOGGING Area Crc is NOT OK!!";
            goto LABEL_36;
          case 11:
            v13 = "User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 12:
            v13 = "RF User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 13:
            v14 = "New Banned Area Crc is NOT OK!!";
LABEL_30:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
          case 14:
            v13 = "User Area Protected Area Crc is NOT OK!!";
            goto LABEL_36;
          case 15:
            v13 = "Anti-tearing User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 16:
            v13 = "Anti-tearing Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 17:
            v13 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_36;
          case 18:
            v13 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_36;
          default:
            v13 = "End Marker Area Crc is NOT OK!!";
LABEL_36:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_38:
  if (v8)
    goto LABEL_39;
LABEL_40:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Verify_3_0_CrcStatus");
  return (unsigned __int16)v8;
}

uint64_t sub_21986F188(uint64_t a1, int a2)
{
  unsigned __int16 v3;
  unsigned int v4;
  int v5;
  const char *v6;
  uint64_t v9;

  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_VerifyCrcStatus");
  v3 = 0;
  v4 = 0;
  v5 = 1;
  do
  {
    if ((v5 & a2) == 0)
    {
      switch(v4)
      {
        case 0u:
          v6 = "User Data Crc is NOT OK!!";
          goto LABEL_10;
        case 1u:
          sub_219850628(0, (unsigned int *)&v9, 4u, 4u, (uint64_t)"Trim Data Crc is NOT OK!!");
          break;
        case 2u:
          v6 = "Protected Data Crc is NOT OK!!";
          goto LABEL_10;
        case 3u:
          v6 = "Patch Code Crc is NOT OK!!";
          goto LABEL_10;
        case 4u:
          v6 = "Function Code Crc is NOT OK!!";
          goto LABEL_10;
        case 5u:
          v6 = "Patch Table Crc is NOT OK!!";
LABEL_10:
          sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)v6);
          v3 = 255;
          break;
        default:
          sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"Function Table Crc is NOT OK!!");
          v3 = 255;
          goto LABEL_13;
      }
    }
    v5 = 2 * v5;
  }
  while (v4++ < 6);
LABEL_13:
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_VerifyCrcStatus");
  return v3;
}

uint64_t sub_21986F340(uint64_t a1, int a2, unsigned __int8 **a3)
{
  unsigned int v6;
  int v7;
  unsigned int v8;
  uint64_t v9;
  int v10;
  int v11;
  __int16 v12;
  __int16 v13;
  const char *v14;
  int v15;
  unsigned int *v16;
  uint64_t v17;
  int v19;
  uint64_t v20;
  uint64_t v21;
  uint64_t v22;
  int v23;
  uint64_t v24;

  v24 = 0;
  v23 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldFlashIntegrityCb");
  if (a1)
  {
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v24);
    if (v24)
    {
      if (a2 || !a3)
      {
        v14 = "phDnldNfc_DnldFlashIntegrityCb - Request Failed!!";
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldFlashIntegrityCb - Request Successful");
        v6 = sub_21986C924(*(_QWORD *)(v24 + 8), *(unsigned __int8 *)(v24 + 92), *(unsigned __int8 *)(v24 + 94));
        if (v6 <= 1)
          v7 = 31;
        else
          v7 = 135;
        if (v7 == *((_DWORD *)a3 + 2) && *a3)
        {
          v8 = v6;
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldFlashIntegrityCb - Valid Resp Buff!!...\n");
          v9 = (uint64_t)*a3;
          v10 = **a3;
          if (v8 < 2)
          {
            v23 = v10;
            if (*(unsigned __int8 *)(v24 + 832) - 252 >= 3)
              v13 = sub_21987141C(*(_QWORD *)(a1 + 2952), v10);
            else
              v13 = 0;
            LOBYTE(v11) = 4;
            LOBYTE(v10) = 2;
            goto LABEL_28;
          }
          v11 = *(unsigned __int8 *)(v9 + 1);
          phOsalNfc_MemCopy();
          v12 = *(_WORD *)(v24 + 832);
          if (v12 - 252 < 3)
          {
            v13 = 0;
LABEL_28:
            v17 = 0;
            v20 = v24;
            *(_BYTE *)(v24 + 71) = v10;
            *(_BYTE *)(v20 + 145) = v11;
            *(_DWORD *)(v20 + 148) = v23;
            *(_WORD *)(v20 + 152) = v13;
            goto LABEL_19;
          }
          if (v8 - 3 <= 4)
          {
            v19 = *(unsigned __int8 *)(v24 + 92);
            if ((v19 + 79) > 1u)
            {
              if ((v12 & 0xF0) != 0xA0 || v19 != 186)
                goto LABEL_40;
            }
            else if (v12 - 161 >= 0xF)
            {
LABEL_40:
              v13 = sub_21986FA70(*(_QWORD *)(a1 + 2952), v10, v11, 0);
              goto LABEL_28;
            }
            v13 = phLibNfc_FlashIntg_Verify_4_0_CrcStatus_NewLayout(*(_QWORD *)(a1 + 2952), v10, v11, 0);
            goto LABEL_28;
          }
          if (v8 != 10 && (v8 & 0xE) != 8)
          {
            v21 = *(_QWORD *)(a1 + 2952);
            if (v12 - 161 > 0xE)
              v13 = sub_219871088(v21, v10, v11, 0);
            else
              v13 = phLibNfc_FlashIntg_Verify_3_0_CrcStatus_NewLayout(v21, v10, v11, 0);
            goto LABEL_28;
          }
          if (v8 != 10)
          {
            v22 = *(_QWORD *)(a1 + 2952);
            if (v12 - 75 < 0x15 || v12 - 228 <= 0xB)
              v13 = phLibNfc_FlashIntg_Verify_5_0_CrcStatus_NewLayout(v22, v10, v11, 0);
            else
              v13 = sub_2198709B4(v22, v10, v11, 0);
            goto LABEL_28;
          }
          if (v12 - 27 >= 0x15)
          {
            if (v12 - 187 >= 0x15)
            {
              v13 = phLibNfc_FlashIntg_Verify_5_1_CrcStatus(*(_QWORD *)(a1 + 2952), v10, v11, 0);
              goto LABEL_28;
            }
            if (v12 >= 0xBCu)
              goto LABEL_39;
          }
          else if (v12 - 28 < 0x14)
          {
LABEL_39:
            v13 = phLibNfc_FlashIntg_Verify_5_1_CrcStatus_NewHlmLayout(*(_QWORD *)(a1 + 2952), v10, v11, 0);
            goto LABEL_28;
          }
          v13 = phLibNfc_FlashIntg_Verify_5_1_CrcStatus_NewLayout(*(_QWORD *)(a1 + 2952), v10, v11, 0);
          goto LABEL_28;
        }
        v14 = "phDnldNfc_DnldFlashIntegrityCb - Resp Buff Invalid...\n";
      }
      v15 = 1;
      v16 = (unsigned int *)(a1 + 19368);
    }
    else
    {
      v16 = (unsigned int *)(a1 + 19368);
      v14 = "phDnldNfc_DnldChkIntegrityCb: Invalid IOCTL context!!";
      v15 = 1;
    }
  }
  else
  {
    v14 = "phDnldNfc_DnldChkIntegrityCb: Invalid LIBNFC context!!";
    v15 = 2;
    v16 = 0;
  }
  sub_219850628(v15, v16, 4u, 1u, (uint64_t)v14);
  v17 = 255;
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldFlashIntegrityCb");
  return v17;
}

uint64_t phLibNfc_FlashIntg_Verify_4_0_CrcStatus_NewLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_4_0_CrcStatus_NewLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_40:
    sub_219886108(v16, 34);
    goto LABEL_41;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_39;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "Function Table Area Crc is NOT OK!!";
      if (v7 <= 2)
        v10 = off_24DB72230[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_21;
          case 2:
            v13 = "Anti-tearing RSAKEY Area Crc is NOT OK!!";
            goto LABEL_21;
          case 3:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_21;
          case 4:
            v13 = "RSAKEY Area Crc is NOT OK!!";
LABEL_21:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 5:
            v14 = "ROM Area Crc is NOT OK!!";
            goto LABEL_37;
          case 6:
            v14 = "NDEF/LOGGING Area Crc is NOT OK!!";
            goto LABEL_37;
          case 7:
            v14 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_37;
          case 8:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 9:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 10:
            v14 = "Trim Area Crc is NOT OK!!";
            goto LABEL_37;
          case 11:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_37;
          case 12:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 13:
            v14 = "RF User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 14:
            v14 = "New Banned Area Crc is NOT OK!!";
            goto LABEL_37;
          case 15:
            v14 = "User Area Protected Area Crc is NOT OK!!";
            goto LABEL_37;
          case 16:
            v14 = "Anti-tearing User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 17:
            v14 = "Anti-tearing Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 18:
            v14 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_37;
          case 19:
            v14 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_37;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_37:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_39:
  if (v8)
    goto LABEL_40;
LABEL_41:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_4_0_CrcStatus_NewLayout");
  return (unsigned __int16)v8;
}

uint64_t sub_21986FA70(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_4_0_CrcStatus");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_39:
    sub_219886108(v16, 34);
    goto LABEL_40;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_38;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "Function Table Area Crc is NOT OK!!";
      if (v7 <= 2)
        v10 = off_24DB72230[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_21;
          case 2:
            v13 = "Anti-tearing RSAKEY Area Crc is NOT OK!!";
            goto LABEL_21;
          case 3:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_21;
          case 4:
            v13 = "RSAKEY Area Crc is NOT OK!!";
LABEL_21:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 5:
            v14 = "ROM Area Crc is NOT OK!!";
            goto LABEL_36;
          case 6:
            v14 = "NDEF/LOGGING Area Crc is NOT OK!!";
            goto LABEL_36;
          case 7:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 8:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 9:
            v14 = "Trim Area Crc is NOT OK!!";
            goto LABEL_36;
          case 10:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_36;
          case 11:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 12:
            v14 = "RF User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 13:
            v14 = "New Banned Area Crc is NOT OK!!";
            goto LABEL_36;
          case 14:
            v14 = "User Area Protected Area Crc is NOT OK!!";
            goto LABEL_36;
          case 15:
            v14 = "Anti-tearing User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 16:
            v14 = "Anti-tearing Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 17:
            v14 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_36;
          case 18:
            v14 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_36;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_36:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_38:
  if (v8)
    goto LABEL_39;
LABEL_40:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_4_0_CrcStatus");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_FlashIntg_Verify_5_1_CrcStatus_NewHlmLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_1_CrcStatus_NewHlmLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_33:
    sub_219886108(v16, 34);
    goto LABEL_34;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_32;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_19;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
LABEL_19:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 3:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_30;
          case 4:
            v14 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_30;
          case 5:
            v14 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_30;
          case 6:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_30;
          case 7:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_30;
          case 8:
            v14 = "Log Area Crc is NOT OK!!";
            goto LABEL_30;
          case 9:
            v14 = "Rom Area Crc is NOT OK!!";
            goto LABEL_30;
          case 10:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_30;
          case 11:
            v14 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_30;
          case 12:
            v14 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_30;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_30:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_32:
  if (v8)
    goto LABEL_33;
LABEL_34:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_1_CrcStatus_NewHlmLayout");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_FlashIntg_Verify_5_1_CrcStatus_NewLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_1_CrcStatus_NewLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_32:
    sub_219886108(v16, 34);
    goto LABEL_33;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_31;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_19;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
LABEL_19:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 3:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_29;
          case 4:
            v14 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_29;
          case 5:
            v14 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_29;
          case 6:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_29;
          case 7:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_29;
          case 8:
            v14 = "Log Area Crc is NOT OK!!";
            goto LABEL_29;
          case 9:
            v14 = "Rom Area Crc is NOT OK!!";
            goto LABEL_29;
          case 10:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_29;
          case 11:
            v14 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_29;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_29:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_31:
  if (v8)
    goto LABEL_32;
LABEL_33:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_1_CrcStatus_NewLayout");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_FlashIntg_Verify_5_1_CrcStatus(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_1_CrcStatus");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_31:
    sub_219886108(v16, 34);
    goto LABEL_32;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_30;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_19;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
LABEL_19:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 3:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_28;
          case 4:
            v14 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_28;
          case 5:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_28;
          case 6:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_28;
          case 7:
            v14 = "Log Area Crc is NOT OK!!";
            goto LABEL_28;
          case 8:
            v14 = "Rom Area Crc is NOT OK!!";
            goto LABEL_28;
          case 9:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_28;
          case 10:
            v14 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_28;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_28:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_30:
  if (v8)
    goto LABEL_31;
LABEL_32:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_1_CrcStatus");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_FlashIntg_Verify_5_0_CrcStatus_NewLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_0_CrcStatus_NewLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_36:
    sub_219886108(v16, 34);
    goto LABEL_37;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_35;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_25;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
LABEL_25:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 3:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_33;
          case 4:
            v14 = "NDEF Area Crc is NOT OK!!";
            goto LABEL_33;
          case 5:
            v14 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_33;
          case 6:
            v14 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_33;
          case 7:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_33;
          case 8:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_33;
          case 9:
            v14 = "Log Area Crc is NOT OK!!";
            goto LABEL_33;
          case 10:
            v14 = "Rom Area Crc is NOT OK!!";
            goto LABEL_33;
          case 11:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_33;
          case 12:
            v14 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_33;
          case 13:
            v14 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_33;
          case 14:
            v14 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_33;
          case 15:
            v14 = "RF User Area Crc is NOT OK!!";
            goto LABEL_33;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_33:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_35:
  if (v8)
    goto LABEL_36;
LABEL_37:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_0_CrcStatus_NewLayout");
  return (unsigned __int16)v8;
}

uint64_t sub_2198709B4(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_0_CrcStatus");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_35:
    sub_219886108(v16, 34);
    goto LABEL_36;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_34;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_19;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
LABEL_19:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 3:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_32;
          case 4:
            v14 = "NDEF Area Crc is NOT OK!!";
            goto LABEL_32;
          case 5:
            v14 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_32;
          case 6:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_32;
          case 7:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_32;
          case 8:
            v14 = "Log Area Crc is NOT OK!!";
            goto LABEL_32;
          case 9:
            v14 = "Rom Area Crc is NOT OK!!";
            goto LABEL_32;
          case 10:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_32;
          case 11:
            v14 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_32;
          case 12:
            v14 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_32;
          case 13:
            v14 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_32;
          case 14:
            v14 = "RF User Area Crc is NOT OK!!";
            goto LABEL_32;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_32:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_34:
  if (v8)
    goto LABEL_35;
LABEL_36:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_5_0_CrcStatus");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_FlashIntg_Verify_3_0_CrcStatus_NewLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_3_0_CrcStatus_NewLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_40:
    sub_219886108(v16, 34);
    goto LABEL_41;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_39;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "Function Table Area Crc is NOT OK!!";
      if (v7 <= 2)
        v10 = off_24DB72230[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_21;
          case 2:
            v13 = "Anti-tearing RSAKEY Area Crc is NOT OK!!";
            goto LABEL_21;
          case 3:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_21;
          case 4:
            v13 = "RSAKEY Area Crc is NOT OK!!";
LABEL_21:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 5:
            v14 = "ROM Area Crc is NOT OK!!";
            goto LABEL_37;
          case 6:
            v14 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_37;
          case 7:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 8:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 9:
            v14 = "Trim Area Crc is NOT OK!!";
            goto LABEL_37;
          case 10:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_37;
          case 11:
            v14 = "NDEF/LOGGING Area Crc is NOT OK!!";
            goto LABEL_37;
          case 12:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 13:
            v14 = "RF User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 14:
            v14 = "New Banned Area Crc is NOT OK!!";
            goto LABEL_37;
          case 15:
            v14 = "User Area Protected Area Crc is NOT OK!!";
            goto LABEL_37;
          case 16:
            v14 = "Anti-tearing User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 17:
            v14 = "Anti-tearing Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 18:
            v14 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_37;
          case 19:
            v14 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_37;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_37:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_39:
  if (v8)
    goto LABEL_40;
LABEL_41:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_3_0_CrcStatus_NewLayout");
  return (unsigned __int16)v8;
}

uint64_t sub_219871088(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_3_0_CrcStatus");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_39:
    sub_219886108(v16, 34);
    goto LABEL_40;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_38;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "Function Table Area Crc is NOT OK!!";
      if (v7 <= 2)
        v10 = off_24DB72230[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_21;
          case 2:
            v13 = "Anti-tearing RSAKEY Area Crc is NOT OK!!";
            goto LABEL_21;
          case 3:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_21;
          case 4:
            v13 = "RSAKEY Area Crc is NOT OK!!";
LABEL_21:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
          case 5:
            v14 = "ROM Area Crc is NOT OK!!";
            goto LABEL_36;
          case 6:
            v14 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 7:
            v14 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 8:
            v14 = "Trim Area Crc is NOT OK!!";
            goto LABEL_36;
          case 9:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_36;
          case 10:
            v14 = "NDEF/LOGGING Area Crc is NOT OK!!";
            goto LABEL_36;
          case 11:
            v14 = "User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 12:
            v14 = "RF User Area Crc is NOT OK!!";
            goto LABEL_36;
          case 13:
            v14 = "New Banned Area Crc is NOT OK!!";
            goto LABEL_36;
          case 14:
            v14 = "User Area Protected Area Crc is NOT OK!!";
            goto LABEL_36;
          case 15:
            v14 = "Anti-tearing User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 16:
            v14 = "Anti-tearing Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_36;
          case 17:
            v14 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_36;
          case 18:
            v14 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_36;
          default:
            v14 = "End Marker Area Crc is NOT OK!!";
LABEL_36:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_38:
  if (v8)
    goto LABEL_39;
LABEL_40:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_Verify_3_0_CrcStatus");
  return (unsigned __int16)v8;
}

uint64_t sub_21987141C(uint64_t a1, int a2)
{
  unsigned __int16 v3;
  unsigned int v4;
  int v5;
  const char *v6;
  const char *v7;
  uint64_t v10;

  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_VerifyCrcStatus");
  v3 = 0;
  v4 = 0;
  v5 = 1;
  do
  {
    if ((v5 & a2) == 0)
    {
      switch(v4)
      {
        case 0u:
          v6 = "User Data Crc is NOT OK!!";
          goto LABEL_9;
        case 1u:
          v6 = "Trim Data Crc is NOT OK!!";
          goto LABEL_9;
        case 2u:
          v7 = "Protected Data Crc is NOT OK!!";
          goto LABEL_11;
        case 3u:
          v7 = "Patch Code Crc is NOT OK!!";
          goto LABEL_11;
        case 4u:
          v6 = "Function Code Crc is NOT OK!!";
LABEL_9:
          sub_219850628(0, (unsigned int *)&v10, 4u, 4u, (uint64_t)v6);
          break;
        case 5u:
          v7 = "Patch Table Crc is NOT OK!!";
LABEL_11:
          sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)v7);
          v3 = 255;
          break;
        default:
          sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)"Function Table Crc is NOT OK!!");
          v3 = 255;
          goto LABEL_14;
      }
    }
    v5 = 2 * v5;
  }
  while (v4++ < 6);
LABEL_14:
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_FlashIntg_VerifyCrcStatus");
  return v3;
}

uint64_t sub_2198715D4(uint64_t a1, int a2, unsigned __int8 **a3)
{
  uint64_t v6;
  int v7;
  int v8;
  uint64_t v9;
  const char *v10;
  int v11;
  unsigned int *v12;
  uint64_t v14;

  v14 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldChkIntegrityRecoverCb");
  if (!a1)
  {
    v10 = "phDnldNfc_DnldChkIntegrityRecoverCb: Invalid LIBNFC context!!";
    v11 = 2;
    v12 = 0;
LABEL_12:
    sub_219850628(v11, v12, 4u, 1u, (uint64_t)v10);
    v9 = 255;
    goto LABEL_13;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v14);
  if (!v14)
  {
    v12 = (unsigned int *)(a1 + 19368);
    v10 = "phDnldNfc_DnldChkIntegrityRecoverCb: Invalid LIBNFC context!!";
    v11 = 1;
    goto LABEL_12;
  }
  if (a2 || !a3)
  {
    v10 = "phDnldNfc_DnldChkIntegrityRecoverCb - Request Failed!!";
    v11 = 1;
    v12 = (unsigned int *)(a1 + 19368);
    goto LABEL_12;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldChkIntegrityRecoverCb - Request Successful");
  if (*((_DWORD *)a3 + 2) != 135 || !*a3)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldChkIntegrityRecoverCb - Resp Buff Invalid...\n");
    goto LABEL_15;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldChkIntegrityRecoverCb - Valid Resp Buff!!...\n");
  v6 = (uint64_t)*a3;
  v7 = **a3;
  v8 = *(unsigned __int8 *)(v6 + 1);
  phOsalNfc_MemCopy();
  v9 = sub_21986E1E4(v14, v7, v8, 0, 3);
  if ((_DWORD)v9 == 84)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"phDnldNfc_DnldChkIntegrityRecoverCb - Relaunching recovery...\n");
    sub_219866158(a1, (uint64_t)&qword_2550A2E78, 2u);
LABEL_15:
    v9 = 0;
  }
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldChkIntegrityRecoverCb");
  return v9;
}

uint64_t sub_2198717A8(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  int v4;
  uint64_t v5;
  int v6;
  const char *v7;
  int v8;
  unsigned int *v9;
  uint64_t v10;
  BOOL v12;
  int v14;
  int v15;
  char v16;
  unsigned __int16 v17;
  unsigned int *v18;
  uint64_t v19;
  uint64_t v20;

  v19 = 0;
  v20 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldLogReadReq");
  if (!a1)
  {
    v7 = "phLibNfc_DnldLogReadReq: Invalid LIBNFC context!!";
    v8 = 2;
    v9 = 0;
LABEL_12:
    sub_219850628(v8, v9, 4u, 1u, (uint64_t)v7);
    v10 = 255;
    goto LABEL_13;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v19);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v20);
  v2 = v20;
  if (!v20 || (v3 = v19) == 0)
  {
    v9 = (unsigned int *)(a1 + 19368);
    v7 = "phLibNfc_DnldLogReadReq: Invalid IOCTL context!!";
    v8 = 1;
    goto LABEL_12;
  }
  v4 = *(_DWORD *)(v20 + 72);
  if (v4 != 2556 && v4 != 2559)
  {
    if (*(_BYTE *)(v20 + 65))
      v12 = 0;
    else
      v12 = *(_BYTE *)(v20 + 64) == 1;
    if (!v12 && *(_BYTE *)(v20 + 65) != 1)
      goto LABEL_7;
LABEL_22:
    v10 = 0;
    goto LABEL_13;
  }
  if (!*(_BYTE *)(v20 + 144))
    goto LABEL_22;
LABEL_7:
  if (v4 == 2559 || v4 == 2556)
  {
    v5 = v20 + 471;
    v6 = 64;
  }
  else
  {
    v5 = v20 + 80;
    v6 = 8;
  }
  v14 = 2286765;
  *(_DWORD *)(v19 + 64) = 2;
  *(_DWORD *)(v2 + 728) = 162;
  v15 = *(unsigned __int8 *)(v2 + 92);
  v16 = v15 + 94;
  if ((v15 - 162) <= 0x31)
  {
    if (((1 << v16) & 0x3C00000000000) != 0)
    {
      v14 = 2344345;
      goto LABEL_36;
    }
    if (((1 << v16) & 7) != 0)
    {
      v14 = 2288349;
      goto LABEL_36;
    }
    if (((1 << v16) & 0x1018000) != 0)
      goto LABEL_36;
  }
  if (v15 == 96)
  {
    v17 = -13223;
  }
  else
  {
    if (v15 == 160)
    {
      v14 = 2288348;
      goto LABEL_36;
    }
    v17 = 8064;
  }
  v14 = v17 | 0x200000;
LABEL_36:
  *(_DWORD *)(v2 + 732) = v14;
  *(_QWORD *)(v2 + 752) = v5;
  *(_DWORD *)(v2 + 760) = v6;
  *(_QWORD *)(v2 + 736) = 0;
  *(_DWORD *)(v2 + 744) = 0;
  *(_BYTE *)(v2 + 768) = 0;
  v10 = sub_2199072EC(*(_QWORD *)(v3 + 56), v2 + 728, (uint64_t)sub_219865DD0, a1);
  v18 = (unsigned int *)(a1 + 19368);
  if ((_DWORD)v10 == 13)
    sub_219850628(1, v18, 4u, 4u, (uint64_t)"CheckIntegrity Request submitted successfully");
  else
    sub_219850628(1, v18, 4u, 1u, (uint64_t)"CheckIntegrity Request Failed!!");
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldLogReadReq");
  return v10;
}

uint64_t sub_2198719E8(uint64_t a1)
{
  _BYTE *v2;
  char v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;
  _BYTE *v10;

  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldLog");
  if (!a1)
  {
    v5 = "phDnldNfc_DnldLog: Invalid LIBNFC context!!";
    v6 = 2;
    v7 = 0;
LABEL_13:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    v4 = 255;
    goto LABEL_14;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v9);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v10);
  if (!v10 || !v9)
  {
    v7 = (unsigned int *)(a1 + 19368);
    v5 = "phDnldNfc_DnldLog: Invalid IOCTL/DNLD context!!";
    v6 = 1;
    goto LABEL_13;
  }
  if (v10[64] == 1 && !v10[68])
  {
    v4 = 0;
  }
  else
  {
    phOsalNfc_SetMemory();
    phOsalNfc_MemCopy();
    v2 = v10;
    if (v10[144] == 1)
      v3 = -86;
    else
      v3 = 0;
    v10[227] = v3;
    *((_QWORD *)v2 + 94) = 0;
    *((_DWORD *)v2 + 190) = 0;
    *((_DWORD *)v2 + 182) = 167;
    *((_QWORD *)v2 + 92) = v2 + 216;
    *((_DWORD *)v2 + 186) = 12;
    v2[768] = 0;
    v4 = sub_2199072EC(*(_QWORD *)(v9 + 56), (uint64_t)(v2 + 728), (uint64_t)sub_219865DD0, a1);
    if ((_DWORD)v4 == 13)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Log Request submitted successfully");
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Log Request Failed!!");
      v10[68] = 0;
    }
  }
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldLog");
  return v4;
}

uint64_t sub_219871BB4(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  uint64_t v5;
  const char *v6;
  int v7;
  unsigned int *v8;
  uint64_t v10;

  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldLogCb");
  if (!a1)
  {
    v6 = "phDnldNfc_DnldLogCb: Invalid LIBNFC context!!";
    v7 = 2;
    v8 = 0;
LABEL_7:
    sub_219850628(v7, v8, 4u, 1u, (uint64_t)v6);
    a2 = 255;
    goto LABEL_10;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v10);
  if (!v10)
  {
    v8 = (unsigned int *)(a1 + 19368);
    v6 = "phDnldNfc_DnldLogCb: Invalid IOCTL context!!";
    v7 = 1;
    goto LABEL_7;
  }
  v4 = (unsigned int *)(a1 + 19368);
  if ((_DWORD)a2)
  {
    sub_219850628(1, v4, 4u, 1u, (uint64_t)"phDnldNfc_DnldLogCb - Request Failed!!");
    a2 = 255;
    v5 = v10;
  }
  else
  {
    sub_219850628(1, v4, 4u, 4u, (uint64_t)"phDnldNfc_DnldLogCb - Request Successful");
    v5 = v10;
    *(_BYTE *)(v10 + 68) = 0;
  }
  *(_BYTE *)(v5 + 144) = 0;
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldLogCb");
  return a2;
}

uint64_t sub_219871CC4(uint64_t a1, int a2)
{
  uint64_t v4;
  uint64_t v5;
  char v6;
  char v7;
  int v8;
  const char *v9;
  int v10;
  unsigned int *v11;
  uint64_t v12;
  int v14;
  uint64_t v15;
  int v16;
  uint64_t v17;

  v17 = 0;
  v16 = 8;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldLogReadCb");
  if (a1)
  {
    sub_21988ED38(*(_QWORD *)(a1 + 2952), &v16);
    v4 = 0;
    v5 = *(_QWORD *)(a1 + 2952);
    v6 = 1;
    while (1)
    {
      v7 = v6;
      if (*((_QWORD *)&unk_253E46700 + 14 * v4) == v5)
        break;
      v6 = 0;
      v4 = 1;
      if ((v7 & 1) == 0)
      {
        v8 = 255;
        goto LABEL_8;
      }
    }
    v8 = *((_DWORD *)&unk_253E46700 + 28 * v4 + 2);
LABEL_8:
    sub_21988EB80(v5, &v17);
    if (!v17)
    {
      v11 = (unsigned int *)(a1 + 19368);
      v9 = "phDnldNfc_DnldLogReadCb - Invalid IOCTL context!!";
      v10 = 1;
      goto LABEL_12;
    }
    if (a2)
    {
      v9 = "phDnldNfc_DnldLogReadCb - Request Failed!!";
      v10 = 1;
      v11 = (unsigned int *)(a1 + 19368);
      goto LABEL_12;
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldLogReadCb - Request Successful");
    if (*(unsigned __int8 *)(v17 + 479) == 170)
    {
      sub_219851FF8(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"MW Log area contents", v17 + 471);
LABEL_24:
      v12 = 0;
LABEL_26:
      *(_BYTE *)(v17 + 144) = 0;
      goto LABEL_13;
    }
    v14 = sub_21986C924(*(_QWORD *)(v17 + 8), *(unsigned __int8 *)(v17 + 92), *(unsigned __int8 *)(v17 + 94));
    if ((v16 & 0xFFFFFFFD) == 4)
    {
      if (v14 != 6)
      {
        if (v14 == 3)
        {
          if (*(_BYTE *)(v17 + 94) != 1)
            goto LABEL_25;
        }
        else if (v14 != 7)
        {
          goto LABEL_25;
        }
      }
      if (v8 == 1)
      {
        v15 = v17;
        *(_BYTE *)(v17 + 64) = 1;
        *(_WORD *)(v15 + 78) = 60;
        sub_21986607C(a1, *(_QWORD *)(a1 + 2912), 6);
        goto LABEL_24;
      }
    }
LABEL_25:
    *(_BYTE *)(v17 + 64) = 1;
    v12 = 60;
    goto LABEL_26;
  }
  v9 = "phDnldNfc_DnldLogReadCb - Invalid LIBNFC context!!";
  v10 = 2;
  v11 = 0;
LABEL_12:
  sub_219850628(v10, v11, 4u, 1u, (uint64_t)v9);
  v12 = 255;
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldLogReadCb");
  return v12;
}

uint64_t sub_219871EF0(uint64_t a1)
{
  int v2;
  _BOOL4 v4;
  int v5;
  int v6;
  const char *v7;
  int v8;
  unsigned int *v9;
  uint64_t v10;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldRecover");
  if (!a1)
  {
    v7 = "phDnldNfc_DnldRecover: Invalid LIBNFC context!!";
    v8 = 2;
    v9 = 0;
LABEL_14:
    sub_219850628(v8, v9, 4u, 1u, (uint64_t)v7);
    v10 = 255;
    goto LABEL_15;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v14);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v15);
  if (!v15 || !v14)
  {
    v9 = (unsigned int *)(a1 + 19368);
    v7 = "phDnldNfc_DnldRecover: Invalid IOCTL/DNLD context!!";
    v8 = 1;
    goto LABEL_14;
  }
  v2 = sub_21986C924(*(_QWORD *)(v15 + 8), *(unsigned __int8 *)(v15 + 92), *(unsigned __int8 *)(v15 + 94));
  v4 = v2 == 10 || (v2 & 0xE) == 8;
  phOsalNfc_SetMemory();
  v5 = *(unsigned __int8 *)(v15 + 71);
  if (v4)
  {
    v6 = 3;
    switch(*(_BYTE *)(v15 + 71))
    {
      case 2:
      case 3:
      case 8:
      case 9:
        goto LABEL_18;
      default:
        break;
    }
  }
  else if (v5 == 9 || v5 == 8)
  {
LABEL_18:
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    v6 = 11;
  }
  else
  {
    v6 = 3;
  }
  v12 = v15;
  v13 = v15 + 728;
  *(_QWORD *)(v15 + 752) = 0;
  *(_DWORD *)(v12 + 760) = 0;
  *(_DWORD *)(v12 + 728) = 177;
  *(_QWORD *)(v12 + 736) = v12 + 216;
  *(_DWORD *)(v12 + 744) = v6;
  *(_BYTE *)(v12 + 768) = 0;
  v10 = sub_2199072EC(*(_QWORD *)(v14 + 56), v13, (uint64_t)sub_219865DD0, a1);
  if ((_DWORD)v10 == 13)
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Repair Request submitted successfully");
  else
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Repair Request Failed!!");
LABEL_15:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldRecover");
  return v10;
}

uint64_t sub_219872168(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  const char *v5;
  int v6;
  uint64_t v8;

  v8 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldRecoverCb");
  if (a1)
  {
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v8);
    if (v8)
    {
      if (!(_DWORD)a2)
      {
        ++*(_BYTE *)(v8 + 70);
        goto LABEL_9;
      }
      v4 = (unsigned int *)(a1 + 19368);
      v5 = "phDnldNfc_DnldRecoverCb - Request Failed!!";
    }
    else
    {
      v4 = (unsigned int *)(a1 + 19368);
      v5 = "phDnldNfc_DnldRecoverCb: Invalid IOCTL/DNLD context!!";
    }
    v6 = 1;
  }
  else
  {
    v5 = "phDnldNfc_DnldRecoverCb: Invalid LIBNFC context!!";
    v6 = 2;
    v4 = 0;
  }
  sub_219850628(v6, v4, 4u, 1u, (uint64_t)v5);
  a2 = 255;
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldRecoverCb");
  return a2;
}

uint64_t sub_219872248(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  unsigned int *v6;
  const char *v7;
  int v8;
  unsigned int *v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_GetDieId");
  if (!a1)
  {
    v7 = "phDnldNfc_GetDieId : Invalid LIBNFC Context!!";
    v8 = 2;
    v9 = 0;
LABEL_8:
    sub_219850628(v8, v9, 4u, 1u, (uint64_t)v7);
    v5 = 255;
    goto LABEL_9;
  }
  sub_21988F460(*(_QWORD *)(a1 + 2952), &v11);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v12);
  v2 = v12;
  if (!v12 || (v3 = v11) == 0)
  {
    v9 = (unsigned int *)(a1 + 19368);
    v7 = "phDnldNfc_GetDieId : Invalid IOCTL/DNLD Context!!";
    v8 = 1;
    goto LABEL_8;
  }
  v4 = v12 + 728;
  *(_QWORD *)(v12 + 736) = 0;
  *(_DWORD *)(v2 + 744) = 0;
  *(_QWORD *)(v2 + 752) = v2 + 471;
  *(_DWORD *)(v2 + 760) = 250;
  *(_DWORD *)(v2 + 728) = 244;
  *(_BYTE *)(v2 + 768) = 0;
  v5 = sub_2199072EC(*(_QWORD *)(v3 + 56), v4, (uint64_t)sub_219865DD0, a1);
  v6 = (unsigned int *)(a1 + 19368);
  if ((_DWORD)v5 == 13)
    sub_219850628(1, v6, 4u, 4u, (uint64_t)"RawFrame Request submitted successfully");
  else
    sub_219850628(1, v6, 4u, 1u, (uint64_t)"RawFrame Request Failed!!");
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_GetDieId");
  return v5;
}

uint64_t sub_219872398(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  const char *v6;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phDnldNfc_GetDieIdCb");
  if ((_DWORD)a2)
  {
    v6 = "phDnldNfc_GetDieIdCb - Request Failed!!";
LABEL_7:
    sub_219850628(2, a1, 4u, 1u, (uint64_t)v6);
    goto LABEL_8;
  }
  sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"phDnldNfc_GetDieIdCb - Request Successful");
  if (!*(_DWORD *)(a3 + 8) || !*(_QWORD *)a3)
  {
    v6 = "Invalid Response received for GetDieId Request!!";
    goto LABEL_7;
  }
  sub_219851FF8(1, a1 + 4842, 4u, 4u, (uint64_t)"Received Packet:", *(_QWORD *)a3);
LABEL_8:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phDnldNfc_GetDieIdCb");
  return a2;
}

uint64_t sub_219872480(uint64_t a1)
{
  int v2;
  int HsuMaxBaudRate;
  int v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v8;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  _QWORD v15[2];

  v15[1] = *MEMORY[0x24BDAC8D0];
  v13 = 0;
  v14 = 0;
  v15[0] = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRate");
  if (a1)
  {
    sub_21988F460(*(_QWORD *)(a1 + 2952), &v13);
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v14);
    if (v14 && v13)
    {
      v2 = sub_21986C924(*(_QWORD *)(v14 + 8), *(unsigned __int8 *)(v14 + 92), *(unsigned __int8 *)(v14 + 94));
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRate: ePlatformType = ");
      if (v2 == 2)
      {
        if (*(_BYTE *)(v14 + 65) != 1)
          goto LABEL_6;
      }
      else if (v2 == 3 && *(_BYTE *)(v14 + 94) != 1)
      {
LABEL_6:
        HsuMaxBaudRate = phTmlNfc_GetHsuMaxBaudRate();
        if (HsuMaxBaudRate)
        {
          v4 = HsuMaxBaudRate;
          sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRate: phTmlNfc_GetHsuMaxBaudRate Failed = ");
          if (v4 != 13)
            goto LABEL_24;
        }
        else
        {
          sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRate: Get Hsu MaxBaud Rate = ");
          *(_DWORD *)(v14 + 96) = 0;
          phOsalNfc_MemCopy();
          v11 = v14;
          v12 = v14 + 728;
          *(_QWORD *)(v14 + 752) = v14 + 471;
          *(_DWORD *)(v11 + 760) = 250;
          *(_DWORD *)(v11 + 728) = 176;
          *(_QWORD *)(v11 + 736) = v15;
          *(_DWORD *)(v11 + 744) = 8;
          *(_BYTE *)(v11 + 768) = 0;
          if (sub_2199072EC(*(_QWORD *)(v13 + 56), v12, (uint64_t)sub_219865DD0, a1) != 13)
          {
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"ConfigHsuBaudRate Request Failed!!");
LABEL_24:
            if (!phTmlNfc_ConfigHsuBaudRate())
            {
              sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRate : Success Config Hsu Baud Rate = ");
              phOsalNfc_Delay();
              v8 = 0;
              goto LABEL_13;
            }
            sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRate : Config Hsu Baud Rate failed Status ");
            goto LABEL_12;
          }
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"ConfigHsuBaudRate Request submitted successfully");
        }
        v8 = 13;
        goto LABEL_13;
      }
      v8 = 0;
      *(_DWORD *)(v14 + 96) = 2;
      goto LABEL_13;
    }
    v7 = (unsigned int *)(a1 + 19368);
    v5 = "phDnldNfc_DnldCfgHsuBaudRate: Invalid IOCTL/DNLD context!!";
    v6 = 1;
  }
  else
  {
    v5 = "phDnldNfc_DnldCfgHsuBaudRate: Invalid LIBNFC context!!";
    v6 = 2;
    v7 = 0;
  }
  sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
LABEL_12:
  v8 = 255;
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRate");
  return v8;
}

uint64_t sub_2198727C4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  const char *v6;
  int v7;
  unsigned int *v8;
  uint64_t v10;

  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRateCb");
  if (!a1)
  {
    v6 = "phDnldNfc_DnldCfgHsuBaudRateCb: Invalid LIBNFC context!!";
    v7 = 2;
    v8 = 0;
LABEL_13:
    sub_219850628(v7, v8, 4u, 1u, (uint64_t)v6);
    goto LABEL_14;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v10);
  if (!v10)
  {
    v8 = (unsigned int *)(a1 + 19368);
    v6 = "phDnldNfc_DnldCfgHsuBaudRateCb: Invalid IOCTL context!!";
    v7 = 1;
    goto LABEL_13;
  }
  if ((_DWORD)a2 || !a3)
  {
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRateCb: Dnld Config HSU baud rate failed");
    goto LABEL_17;
  }
  if (*(_QWORD *)a3 && *(_DWORD *)(a3 + 8) && !**(_BYTE **)a3)
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRateCb - Request Successful");
  else
    *(_DWORD *)(v10 + 96) = 2;
  if (!phTmlNfc_ConfigHsuBaudRate())
  {
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRateCb : Success Config Hsu Baud Rate = ");
    phOsalNfc_Delay();
    a2 = 0;
    goto LABEL_17;
  }
  sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRateCb : Config Hsu Baud Rate failed Status ");
LABEL_14:
  a2 = 255;
LABEL_17:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldCfgHsuBaudRateCb");
  return a2;
}

uint64_t sub_219872978(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  _BYTE *v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v12;
  uint64_t v13;
  int v14;
  char v15;
  uint64_t *v16;
  uint64_t v17;
  int v18;
  char v19;
  uint64_t *v20;
  uint64_t v21;
  uint64_t v22;
  int v23;
  int v24;
  unsigned int *v25;
  const char *v26;
  uint64_t v27;
  int v28;
  uint64_t v29;
  uint64_t v30;
  int v31;
  uint64_t v32;
  uint64_t v33;
  int v34;
  uint64_t v35;
  uint64_t v36;
  uint64_t v37;
  int v38;
  int v39;
  uint64_t v40;
  char v41;
  uint64_t (**v42)();
  uint64_t (*v43)();
  uint64_t v44;
  uint64_t v45;
  uint64_t v46;

  v5 = (uint64_t)a1;
  v45 = 0;
  v46 = 0;
  v44 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldComplete");
  if (!v5)
  {
    v10 = 0;
    goto LABEL_17;
  }
  v6 = (_BYTE *)(v5 + 6026);
  sub_21988F744(*(_QWORD *)(v5 + 2952), &v46);
  if (v46 && (sub_21988F460(*(_QWORD *)(v5 + 2952), &v45), v45))
  {
    v7 = *(_QWORD *)(v45 + 56);
    if (*(_BYTE *)(v5 + 6028) == 1 || *(_BYTE *)(v5 + 6031) == 1 || *(_BYTE *)(v5 + 6030) == 1)
    {
      v8 = 233;
    }
    else if (*v6 == 1)
    {
      v8 = 232;
    }
    else
    {
      v8 = 220;
    }
  }
  else
  {
    v7 = 0;
    v8 = 220;
  }
  sub_21988EB80(*(_QWORD *)(v5 + 2952), &v44);
  sub_21988F460(*(_QWORD *)(v5 + 2952), &v45);
  v9 = v44;
  if (v45 && v44)
    v7 = *(_QWORD *)(v45 + 56);
  v10 = 0;
  if (v7 && v44)
  {
    if ((_DWORD)a2 == 84)
    {
      sub_219850628(0, (unsigned int *)(v44 + 8), 4u, 2u, (uint64_t)"Launching Download Recovery Sequence..");
      v10 = sub_2198D1714(*(_QWORD *)(v44 + 8), 221, 84, a3, 0);
      goto LABEL_17;
    }
    v12 = *(unsigned int *)(v7 + 8492);
    if (*(_BYTE *)(v44 + 68) == 1)
    {
      if (*(_BYTE *)(v44 + 836) == 1)
        a2 = 141;
      else
        a2 = a2;
      *(_WORD *)(v44 + 78) = a2;
      *(_BYTE *)(v9 + 76) = 1;
      sub_219850628(0, (unsigned int *)(v9 + 8), 4u, 4u, (uint64_t)"Invoking Pending Download Log Sequence..");
      v13 = v44;
      *(_BYTE *)(v44 + 68) = 0;
      v14 = *(unsigned __int8 *)(v13 + 92);
      if ((v14 - 209) >= 3 && v14 != 96)
      {
        *(_QWORD *)(v5 + 2912) = &qword_2550A2E28;
        *(_BYTE *)(v5 + 2904) = 0;
        *(_BYTE *)(v5 + 2906) = 0;
        v19 = qword_2550A2E28;
        if (qword_2550A2E28)
        {
          v19 = 0;
          v20 = &qword_2550A2E38;
          do
          {
            ++v19;
            v21 = *v20;
            v20 += 2;
          }
          while (v21);
        }
        *(_BYTE *)(v5 + 2905) = v19;
        v10 = sub_2198655FC(v5, 0, 0);
        goto LABEL_70;
      }
      if (*(_BYTE *)(v13 + 836) || *v6 || *(_BYTE *)(v5 + 6029) || *(_BYTE *)(v5 + 6030) || *(_BYTE *)(v5 + 6027))
      {
        if (*(_BYTE *)(v13 + 144) == 1)
        {
          *(_QWORD *)(v5 + 2912) = &qword_2550A2E28;
          *(_BYTE *)(v5 + 2904) = 0;
          *(_BYTE *)(v5 + 2906) = 0;
          v15 = qword_2550A2E28;
          if (qword_2550A2E28)
          {
            v15 = 0;
            v16 = &qword_2550A2E38;
            do
            {
              ++v15;
              v17 = *v16;
              v16 += 2;
            }
            while (v17);
          }
          *(_BYTE *)(v5 + 2905) = v15;
          if (sub_2198655FC(v5, 0, 0) == 13)
          {
            v10 = 13;
LABEL_69:
            *(_BYTE *)(v44 + 836) = 0;
LABEL_70:
            if ((_DWORD)v10
              && (_DWORD)v10 != 13
              && !*v6
              && !*(_BYTE *)(v5 + 6029)
              && !*(_BYTE *)(v5 + 6030)
              && !*(_BYTE *)(v5 + 6027))
            {
              sub_219897050(v5);
              v22 = v44;
              if (*(_BYTE *)(v44 + 67) == 1)
              {
                *(_BYTE *)(v44 + 67) = 0;
                sub_21989A5DC((unsigned int *)v5);
                sub_21988EEB4(*(_QWORD *)(v44 + 8), 0);
                v5 = 0;
                v22 = v44;
              }
              if (*(_DWORD *)(v22 + 192) == 1)
                v23 = sub_2198972CC(v12, *(_QWORD *)(v22 + 8));
              else
                v23 = phTmlNfc_IoCtl();
              if (v23)
                sub_219850628(0, (unsigned int *)(v44 + 8), 4u, 1u, (uint64_t)"Switching to NormalMode Failed!!");
              v36 = v44;
              *(_WORD *)(v44 + 68) = 0;
              *(_BYTE *)(v36 + 64) = 0;
              *(_BYTE *)(v36 + 70) = 0;
              v10 = sub_2198D1714(*(_QWORD *)(v36 + 8), v8, a2, a3, 0);
              v37 = v44;
              *(_WORD *)(v44 + 78) = 0;
              *(_BYTE *)(v37 + 76) = 0;
              *(_BYTE *)(v37 + 65) = 0;
              v38 = *(_DWORD *)(v37 + 72);
              if (v38 == 2559 || v38 == 2556)
              {
                sub_2198C20AC(v45);
                v37 = v44;
              }
              sub_21986BE40(*(_QWORD *)(v37 + 8));
            }
            if ((_DWORD)v10)
            {
              if ((_DWORD)v10 != 13)
              {
                v39 = *(_DWORD *)(v44 + 72);
                if (v39 == 2559 || v39 == 2556)
                {
                  sub_21988F460(*(_QWORD *)(v44 + 8), &v45);
                  sub_2198C20AC(v45);
                }
              }
            }
            goto LABEL_17;
          }
          if (*(_BYTE *)(v5 + 6028) == 1 || *(_BYTE *)(v5 + 6031) == 1 || *(_BYTE *)(v5 + 6030) == 1)
          {
            v8 = 233;
          }
          else if (*v6 == 1)
          {
            v8 = 232;
          }
          else
          {
            v8 = 220;
          }
          v13 = v44;
        }
        else if (*(_BYTE *)(v5 + 6028) == 1 || *(_BYTE *)(v5 + 6031) == 1 || *(_BYTE *)(v5 + 6030) == 1)
        {
          v8 = 233;
        }
        else if (*v6 == 1)
        {
          v8 = 232;
        }
        else
        {
          v8 = 220;
        }
        v10 = sub_2198D1714(*(_QWORD *)(v13 + 8), v8, a2, a3, 0);
        *(_WORD *)(v44 + 78) = 0;
        goto LABEL_69;
      }
      if (*(_DWORD *)(v13 + 192) == 1)
      {
        v29 = phTmlNfc_IoCtl();
        if ((_DWORD)v29)
        {
          v10 = v29;
LABEL_161:
          v8 = 220;
          goto LABEL_69;
        }
        v40 = sub_2198972CC(v12, *(_QWORD *)(v44 + 8));
      }
      else
      {
        v40 = phTmlNfc_IoCtl();
      }
      v10 = v40;
      if (!(_DWORD)v40)
      {
        *(_QWORD *)(v5 + 2912) = &qword_2550A2E48;
        *(_BYTE *)(v5 + 2904) = 0;
        *(_BYTE *)(v5 + 2906) = 0;
        v41 = qword_2550A2E48;
        if (qword_2550A2E48)
        {
          v41 = 0;
          v42 = off_2550A2E58;
          do
          {
            ++v41;
            v43 = *v42;
            v42 += 2;
          }
          while (v43);
        }
        *(_BYTE *)(v5 + 2905) = v41;
        v10 = sub_2198655FC(v5, 0, 0);
        goto LABEL_69;
      }
      goto LABEL_161;
    }
    if (*(_BYTE *)(v44 + 64))
    {
      if (*(_DWORD *)(v44 + 72) != 2559)
        goto LABEL_102;
      if ((_DWORD)a2 == 60 || *(_WORD *)(v44 + 78) == 60)
      {
        *(_WORD *)(v44 + 78) = 0;
        if (*(_BYTE *)(v5 + 6028) == 1 || *(_BYTE *)(v5 + 6031) == 1 || *(_BYTE *)(v5 + 6030) == 1)
        {
          v8 = 233;
        }
        else if (*v6 == 1)
        {
          v8 = 232;
        }
        else
        {
          v8 = 219;
        }
        sub_219850628(0, (unsigned int *)(v9 + 8), 4u, 4u, (uint64_t)"Fw Already Upto Date!!");
        a2 = 60;
LABEL_102:
        if ((_DWORD)v8 != 233 && !*(_BYTE *)(v5 + 6029) && !*(_BYTE *)(v5 + 6030) && !*v6 && !*(_BYTE *)(v5 + 6027))
        {
          sub_219897050(v5);
          v27 = v44;
          if (*(_BYTE *)(v44 + 67) == 1)
          {
            *(_BYTE *)(v44 + 67) = 0;
            sub_21989A5DC((unsigned int *)v5);
            sub_21988EEB4(*(_QWORD *)(v44 + 8), 0);
            v5 = 0;
            v27 = v44;
          }
          if (*(_DWORD *)(v27 + 192) == 1)
            v28 = sub_2198972CC(v12, *(_QWORD *)(v27 + 8));
          else
            v28 = phTmlNfc_IoCtl();
          if (v28)
            sub_219850628(0, (unsigned int *)(v44 + 8), 4u, 1u, (uint64_t)"Switching to NormalMode Failed!!");
        }
        v30 = v44;
        v31 = *(_DWORD *)(v44 + 72);
        if (v31 == 2559 || v31 == 2556)
        {
          if ((_DWORD)a2)
          {
            if (*(_BYTE *)(v44 + 836) == 1)
              a2 = 141;
            else
              a2 = a2;
          }
          *(_BYTE *)(v44 + 836) = 0;
        }
        *(_WORD *)(v30 + 68) = 0;
        *(_BYTE *)(v30 + 64) = 0;
        *(_BYTE *)(v30 + 70) = 0;
        v32 = *(_QWORD *)(v30 + 8);
        if (*(_BYTE *)(v30 + 76))
        {
          v10 = sub_2198D1714(v32, v8, *(unsigned __int16 *)(v30 + 78), a3, 0);
          v33 = v44;
          *(_WORD *)(v44 + 78) = 0;
          *(_BYTE *)(v33 + 76) = 0;
        }
        else
        {
          v10 = sub_2198D1714(v32, v8, a2, a3, 0);
          v33 = v44;
        }
        *(_BYTE *)(v33 + 65) = 0;
        v34 = *(_DWORD *)(v33 + 72);
        if (v34 == 2559 || v34 == 2556)
          sub_2198C20AC(v45);
        if (v5)
        {
          if ((_DWORD)v8 == 233
            || *(_BYTE *)(v5 + 6026)
            || *(_BYTE *)(v5 + 6029)
            || *(_BYTE *)(v5 + 6030)
            || *(_BYTE *)(v5 + 6027))
          {
            goto LABEL_17;
          }
          v35 = *(_QWORD *)(v5 + 2952);
        }
        else
        {
          v35 = *(_QWORD *)(v44 + 8);
        }
        sub_21986BE40(v35);
        goto LABEL_17;
      }
      goto LABEL_88;
    }
    if ((_DWORD)a2)
    {
      v18 = *(_DWORD *)(v44 + 72);
      if (v18 == 241)
      {
        v25 = (unsigned int *)(v44 + 8);
        v26 = "Get Download Integrity Info Request Failed!!";
        goto LABEL_101;
      }
      if (v18 == 2558)
      {
        v25 = (unsigned int *)(v44 + 8);
        v26 = "Get DieId Request Failed!!";
        goto LABEL_101;
      }
      if (v18 != 2559)
        goto LABEL_102;
      if ((_DWORD)a2 == 156 || (_DWORD)a2 == 141)
      {
        v25 = (unsigned int *)(v44 + 8);
        v26 = "Fw download session is locked or Degraded FW update failed!!";
        goto LABEL_101;
      }
      if ((_DWORD)a2 == 60)
      {
        sub_219850628(0, (unsigned int *)(v44 + 8), 4u, 2u, (uint64_t)"Fw Already Upto Date!!");
        goto LABEL_102;
      }
LABEL_88:
      v25 = (unsigned int *)(v44 + 8);
      v26 = "Fw Download Failed!!";
LABEL_101:
      sub_219850628(0, v25, 4u, 1u, (uint64_t)v26);
      goto LABEL_102;
    }
    if (*(_BYTE *)(v5 + 6028) == 1 || *(_BYTE *)(v5 + 6031) == 1 || *(_BYTE *)(v5 + 6030) == 1)
    {
      v8 = 233;
      goto LABEL_84;
    }
    if (*v6 == 1)
    {
      v8 = 232;
    }
    else
    {
      v8 = 219;
      if (*(_BYTE *)(v5 + 6029) != 1)
        goto LABEL_84;
    }
    *(_BYTE *)(v44 + 836) = 0;
LABEL_84:
    v24 = *(_DWORD *)(v9 + 72);
    if (v24 == 241)
    {
      sub_219850628(0, (unsigned int *)(v9 + 8), 4u, 4u, (uint64_t)"Get Download Integrity Info Request success.. ");
      if (*(_WORD *)(v44 + 78) == 156)
      {
        *(_WORD *)(v44 + 78) = 255;
        a2 = 156;
        goto LABEL_102;
      }
    }
    else if (v24 == 2559 || v24 == 2556)
    {
      sub_219850628(0, (unsigned int *)(v9 + 8), 4u, 4u, (uint64_t)"Fw Download success.. ");
    }
    a2 = 0;
    goto LABEL_102;
  }
LABEL_17:
  sub_219850808(2, (unsigned int *)v5, 4u, 5u, (uint64_t)"phDnldNfc_DnldComplete");
  return v10;
}

uint64_t sub_2198732A0(uint64_t a1, int a2)
{
  unsigned int v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldInitComplete");
  if (!a1 || (sub_21988F460(*(_QWORD *)(a1 + 2952), &v8), sub_21988EB80(*(_QWORD *)(a1 + 2952), &v9), a2))
  {
    if (a2 == 136)
      v4 = 136;
    else
      v4 = 255;
    if (a2 == 156)
      v5 = 156;
    else
      v5 = v4;
    goto LABEL_9;
  }
  if (*(_DWORD *)(a1 + 3176) != 1)
  {
    v7 = phTmlNfc_IoCtl();
LABEL_16:
    v5 = v7;
    if (!(_DWORD)v7)
    {
      if (v9 && *(_BYTE *)(v9 + 65) == 1)
        v5 = 153;
      else
        v5 = 255;
      goto LABEL_9;
    }
    goto LABEL_17;
  }
  v5 = phTmlNfc_IoCtl();
  if (!(_DWORD)v5)
  {
    v7 = sub_2198972CC(*(unsigned int *)(a1 + 19368), *(_QWORD *)(a1 + 2952));
    goto LABEL_16;
  }
LABEL_17:
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Switching to NormalMode Failed!!");
LABEL_9:
  if (sub_2199056B8(v8))
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"Failed to perform phDnldNfc_CoreDeInit!!");
  sub_2198C1BDC(v8);
  sub_219898F04((unsigned int *)a1, v5);
  sub_219850808(2, 0, 4u, 5u, (uint64_t)"phDnldNfc_DnldInitComplete");
  return v5;
}

uint64_t sub_219873404(uint64_t a1)
{
  uint64_t v1;
  char v2;
  char v3;
  int v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t Memory;
  uint64_t v14;

  Memory = 0;
  v14 = a1;
  v11 = 0;
  v12 = 0;
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_VerifyCtxt");
  sub_21988F460(v14, &v11);
  sub_21988EB80(v14, &v12);
  sub_21988EDF4(v14, &Memory);
  v1 = 0;
  v2 = 1;
  while (1)
  {
    v3 = v2;
    if (*((_QWORD *)&unk_253E46700 + 14 * v1) == v14)
      break;
    v2 = 0;
    v1 = 1;
    if ((v3 & 1) == 0)
    {
      v4 = 255;
      goto LABEL_6;
    }
  }
  v4 = *((_DWORD *)&unk_253E46700 + 28 * v1 + 2);
LABEL_6:
  v5 = 1;
  if (v14 && v12 && v11)
  {
    if (!Memory)
    {
      Memory = phOsalNfc_GetMemory();
      if (!Memory)
      {
        sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"Failed to allocate memory, Insufficient Resources");
        v5 = 12;
        goto LABEL_11;
      }
      sub_219885FF8(0, (unsigned int *)&v14, 4u, 4u, (uint64_t)"####phLibNfc_VerifyCtxt: DriverHandle");
      sub_219885FF8(0, (unsigned int *)&v14, 4u, 4u, (uint64_t)"####LIBNFC context");
      phOsalNfc_SetMemory();
      v8 = Memory;
      v7 = v14;
      *(_QWORD *)(Memory + 2952) = v14;
      v9 = v11;
      *(_QWORD *)(v8 + 3040) = *(_QWORD *)(v11 + 40);
      *(_QWORD *)(v8 + 19360) = v7;
      *(_DWORD *)(v8 + 19368) = v4;
      v10 = v12;
      *(_DWORD *)(v8 + 3176) = *(_DWORD *)(v12 + 192);
      *(_BYTE *)(v10 + 67) = 1;
      if (sub_219905DA0(*(_QWORD *)(v9 + 56)) != 13)
      {
        phOsalNfc_FreeMemory();
        sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"phLibNfc_VerifyCtxt : Initial TML read request failed!!");
        v5 = 255;
        goto LABEL_11;
      }
      sub_21988EEB4(v14, Memory);
    }
    v5 = 0;
  }
LABEL_11:
  if (Memory && v12)
    *(_BYTE *)(v12 + 67) = 1;
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_VerifyCtxt");
  return v5;
}

uint64_t phLibNfc_Verify_5_1_CrcStatus(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  uint64_t v15;

  v15 = a1;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_1_CrcStatus");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_30:
    sub_219886108(v15, 34);
    goto LABEL_31;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_29;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_27;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_27;
          case 3:
            sub_219850628(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"Customer Area Crc is NOT OK!!");
            break;
          case 4:
            v13 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_27;
          case 5:
            v13 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_27;
          case 6:
            v13 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_27;
          case 7:
            v13 = "Log Area Crc is NOT OK!!";
            goto LABEL_27;
          case 8:
            v13 = "Rom Area Crc is NOT OK!!";
            goto LABEL_27;
          case 9:
            v13 = "User Area Crc is NOT OK!!";
            goto LABEL_27;
          case 10:
            v13 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_27;
          default:
            v13 = "End Marker Area Crc is NOT OK!!";
LABEL_27:
            sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_29:
  if (v8)
    goto LABEL_30;
LABEL_31:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_1_CrcStatus");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_Verify_4_0_CrcStatus_NewLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Verify_4_0_CrcStatus_NewLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_40:
    sub_219886108(v16, 34);
    goto LABEL_41;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_39;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "Function Table Area Crc is NOT OK!!";
      if (v7 <= 2)
        v10 = off_24DB72230[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_37;
          case 2:
            v13 = "Anti-tearing RSAKEY Area Crc is NOT OK!!";
            goto LABEL_37;
          case 3:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_37;
          case 4:
            v13 = "RSAKEY Area Crc is NOT OK!!";
            goto LABEL_37;
          case 5:
            v13 = "ROM Area Crc is NOT OK!!";
            goto LABEL_37;
          case 6:
            v13 = "NDEF/LOGGING Area Crc is NOT OK!!";
            goto LABEL_37;
          case 7:
            v13 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_37;
          case 8:
            v13 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 9:
            v13 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 10:
            v14 = "Trim Area Crc is NOT OK!!";
            goto LABEL_31;
          case 11:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_31;
          case 12:
            v13 = "User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 13:
            v13 = "RF User Area Crc is NOT OK!!";
            goto LABEL_37;
          case 14:
            v14 = "New Banned Area Crc is NOT OK!!";
LABEL_31:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
          case 15:
            v13 = "User Area Protected Area Crc is NOT OK!!";
            goto LABEL_37;
          case 16:
            v13 = "Anti-tearing User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 17:
            v13 = "Anti-tearing Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_37;
          case 18:
            v13 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_37;
          case 19:
            v13 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_37;
          default:
            v13 = "End Marker Area Crc is NOT OK!!";
LABEL_37:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_39:
  if (v8)
    goto LABEL_40;
LABEL_41:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Verify_4_0_CrcStatus_NewLayout");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_Verify_5_0_CrcStatus_NewLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  const char *v14;
  uint64_t v16;

  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_0_CrcStatus_NewLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_36:
    sub_219886108(v16, 34);
    goto LABEL_37;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_35;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_33;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_33;
          case 3:
            v14 = "Customer Area Crc is NOT OK!!";
            goto LABEL_26;
          case 4:
            v14 = "NDEF Area Crc is NOT OK!!";
LABEL_26:
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)v14);
            break;
          case 5:
            v13 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_33;
          case 6:
            v13 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_33;
          case 7:
            v13 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_33;
          case 8:
            v13 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_33;
          case 9:
            v13 = "Log Area Crc is NOT OK!!";
            goto LABEL_33;
          case 10:
            v13 = "Rom Area Crc is NOT OK!!";
            goto LABEL_33;
          case 11:
            v13 = "User Area Crc is NOT OK!!";
            goto LABEL_33;
          case 12:
            v13 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_33;
          case 13:
            v13 = "Routing Table Area Crc is NOT OK!!";
            goto LABEL_33;
          case 14:
            v13 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_33;
          case 15:
            v13 = "RF User Area Crc is NOT OK!!";
            goto LABEL_33;
          default:
            v13 = "End Marker Area Crc is NOT OK!!";
LABEL_33:
            sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_35:
  if (v8)
    goto LABEL_36;
LABEL_37:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_0_CrcStatus_NewLayout");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_Verify_5_1_CrcStatus_NewLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  uint64_t v15;

  v15 = a1;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_1_CrcStatus_NewLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_31:
    sub_219886108(v15, 34);
    goto LABEL_32;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_30;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_28;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_28;
          case 3:
            sub_219850628(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"Customer Area Crc is NOT OK!!");
            break;
          case 4:
            v13 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_28;
          case 5:
            v13 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_28;
          case 6:
            v13 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_28;
          case 7:
            v13 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_28;
          case 8:
            v13 = "Log Area Crc is NOT OK!!";
            goto LABEL_28;
          case 9:
            v13 = "Rom Area Crc is NOT OK!!";
            goto LABEL_28;
          case 10:
            v13 = "User Area Crc is NOT OK!!";
            goto LABEL_28;
          case 11:
            v13 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_28;
          default:
            v13 = "End Marker Area Crc is NOT OK!!";
LABEL_28:
            sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_30:
  if (v8)
    goto LABEL_31;
LABEL_32:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_1_CrcStatus_NewLayout");
  return (unsigned __int16)v8;
}

uint64_t phLibNfc_Verify_5_1_CrcStatus_NewHlmLayout(uint64_t a1, int a2, int a3, int a4)
{
  uint64_t v7;
  int v8;
  int v9;
  const char *v10;
  int v11;
  unsigned int v12;
  const char *v13;
  uint64_t v15;

  v15 = a1;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_1_CrcStatus_NewHlmLayout");
  if ((a3 + a2) > 0x20)
  {
    LOWORD(v8) = 255;
LABEL_32:
    sub_219886108(v15, 34);
    goto LABEL_33;
  }
  if (!a3)
  {
    v8 = 0;
    if (!a2)
      goto LABEL_31;
    goto LABEL_13;
  }
  v7 = 0;
  v8 = 0;
  v9 = 1;
  do
  {
    if ((v9 & a4) == 0)
    {
      v10 = "AT Confige Area Crc is NOT OK!!";
      if (v7 <= 3)
        v10 = off_24DB72248[v7];
      sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)v10);
      v8 = 255;
    }
    v9 *= 2;
    ++v7;
  }
  while (a3 != (_DWORD)v7);
  if (a2)
  {
LABEL_13:
    v11 = 0;
    v12 = 0x80000000;
    do
    {
      ++v11;
      if ((v12 & a4) == 0)
      {
        switch(v11)
        {
          case 1:
            v13 = "Protected Area Crc is NOT OK!!";
            goto LABEL_29;
          case 2:
            v13 = "Anti-tearing protected Area Crc is NOT OK!!";
            goto LABEL_29;
          case 3:
            sub_219850628(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"Customer Area Crc is NOT OK!!");
            break;
          case 4:
            v13 = "RAM AO Only Area Crc is NOT OK!!";
            goto LABEL_29;
          case 5:
            v13 = "Mirrored User Flash Area Crc is NOT OK!!";
            goto LABEL_29;
          case 6:
            v13 = "Mirrored User Area Protected Crc is NOT OK!!";
            goto LABEL_29;
          case 7:
            v13 = "Mirrored User Area Crc is NOT OK!!";
            goto LABEL_29;
          case 8:
            v13 = "Log Area Crc is NOT OK!!";
            goto LABEL_29;
          case 9:
            v13 = "Rom Area Crc is NOT OK!!";
            goto LABEL_29;
          case 10:
            v13 = "User Area Crc is NOT OK!!";
            goto LABEL_29;
          case 11:
            v13 = "User Area Protected Crc is NOT OK!!";
            goto LABEL_29;
          case 12:
            v13 = "HLM debug logging Area Crc is NOT OK!!";
            goto LABEL_29;
          default:
            v13 = "End Marker Area Crc is NOT OK!!";
LABEL_29:
            sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)v13);
            v8 = 255;
            break;
        }
      }
      v12 >>= 1;
    }
    while (a2 != v11);
  }
LABEL_31:
  if (v8)
    goto LABEL_32;
LABEL_33:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Verify_5_1_CrcStatus_NewHlmLayout");
  return (unsigned __int16)v8;
}

uint64_t sub_21987457C(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  BOOL v4;
  uint64_t v5;
  const char *v6;
  unsigned int *v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetRfCalData");
  v3 = sub_21987AB04(v9, &v8);
  if ((_DWORD)v3)
    v4 = 1;
  else
    v4 = v8 == 0;
  if (v4)
  {
    v5 = v3;
    sub_219850628(2, v8, 4u, 1u, (uint64_t)"Ioctl_SetRfCalData: LIBNFC Not Initialized");
    goto LABEL_7;
  }
  if (!a2 || !*a2)
  {
    v5 = 1;
    v6 = "Ioctl_SetRfCalData: Invalid input parameters";
    goto LABEL_14;
  }
  if (*((_BYTE *)v8 + 2946) != 1)
  {
    v5 = sub_2198D1B2C(v9, 118, 0, (uint64_t)a2, 0);
LABEL_7:
    if ((_DWORD)v5 == 13)
      goto LABEL_16;
    goto LABEL_15;
  }
  v5 = 51;
  v6 = "Ioctl_SetRfCalData: Feature Not supported";
LABEL_14:
  sub_219850628(1, v8 + 4842, 4u, 1u, (uint64_t)v6);
LABEL_15:
  sub_2198D2284(v9, 118);
  sub_219886108(v9, v5);
LABEL_16:
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_SetRfCalData");
  return v5;
}

uint64_t sub_2198746A8(uint64_t a1, uint64_t a2, _QWORD *a3)
{
  uint64_t v4;
  BOOL v5;
  uint64_t v6;
  const char *v7;
  unsigned int *v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetRfCalData");
  v4 = sub_21987AB04(v10, &v9);
  if ((_DWORD)v4)
    v5 = 1;
  else
    v5 = v9 == 0;
  if (v5)
  {
    v6 = v4;
    sub_219850628(2, v9, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_GetRfCalData: LIBNFC Not Initialized");
    goto LABEL_7;
  }
  if (!a3 || !*a3)
  {
    v6 = 1;
    v7 = "phLibNfc_Ioctl_GetRfCalData: Invalid input parameters";
    goto LABEL_14;
  }
  if (*((_BYTE *)v9 + 2946) != 1)
  {
    v6 = sub_2198D1B2C(v10, 119, 0, (uint64_t)a3, 0);
LABEL_7:
    if ((_DWORD)v6 == 13)
      goto LABEL_16;
    goto LABEL_15;
  }
  v6 = 51;
  v7 = "phLibNfc_Ioctl_GetRfCalData: Feature Not supported";
LABEL_14:
  sub_219850628(1, v9 + 4842, 4u, 1u, (uint64_t)v7);
LABEL_15:
  sub_2198D2284(v10, 119);
  sub_219886108(v10, v6);
LABEL_16:
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_GetRfCalData");
  return v6;
}

uint64_t sub_2198747D4(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  BOOL v4;
  uint64_t v5;
  const char *v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropSetConfigSigned");
  v3 = sub_21987AB04(v9, &v8);
  if ((_DWORD)v3)
    v4 = 1;
  else
    v4 = v8 == 0;
  if (v4)
  {
    v5 = v3;
    sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_PropSetConfigSigned: LIBNFC Not Initialized");
    goto LABEL_7;
  }
  if (a2 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8) >= 0x10u)
  {
    if (*(_BYTE *)(v8 + 2946) == 1)
    {
      v5 = 51;
      v6 = "Ioctl_PropSetConfigSigned: Feature Not supported!";
      goto LABEL_13;
    }
    v5 = sub_2198D1B2C(v9, 120, 0, a2, 0);
LABEL_7:
    if ((_DWORD)v5 == 13)
      goto LABEL_15;
    goto LABEL_14;
  }
  v5 = 1;
  v6 = "Ioctl_PropSetConfigSigned: Invalid Input Parameter!";
LABEL_13:
  sub_219850628(1, (unsigned int *)(v8 + 19368), 4u, 1u, (uint64_t)v6);
LABEL_14:
  sub_2198D2284(v9, 120);
  sub_219886108(v9, v5);
LABEL_15:
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropSetConfigSigned");
  return v5;
}

uint64_t sub_219874910(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v5;
  uint64_t v6;

  v5 = 0;
  v6 = a1;
  sub_219850718(0, (unsigned int *)&v6, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropSetPwrTrackConfig");
  sub_21988EDF4(v6, &v5);
  if (a2 && *(_QWORD *)a2 && *(_DWORD *)(a2 + 8) == 1)
  {
    if (!v5
      || *(_BYTE *)(v5 + 2936) == 1
      || *(_BYTE *)(v5 + 2937) == 1
      || *(_BYTE *)(v5 + 2938) == 1
      || *(_BYTE *)(v5 + 2944) == 1)
    {
      v3 = sub_2198D1B2C(v6, 121, 0, a2, 0);
      if ((_DWORD)v3 == 13)
        goto LABEL_13;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(v5 + 19368), 4u, 1u, (uint64_t)"phLibNfc_Ioctl_PropSetPwrTrackConfig: Feature Not supported!");
      v3 = 51;
    }
  }
  else
  {
    v3 = 1;
    sub_219850628(0, (unsigned int *)&v6, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_PropSetPwrTrackConfig: Invalid Input Parameter!");
  }
  sub_2198D2284(v6, 121);
  sub_219886108(v6, v3);
LABEL_13:
  sub_219850808(0, (unsigned int *)&v6, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropSetPwrTrackConfig");
  return v3;
}

uint64_t sub_219874A58(uint64_t a1, unsigned __int8 **a2)
{
  unsigned int *v3;
  uint64_t v4;
  int v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropSetCrcChkConfig");
  sub_21988EDF4(v8, &v7);
  if (a2 && *a2 && *((_DWORD *)a2 + 2) == 1)
  {
    v3 = (unsigned int *)v7;
    if (v7
      && *(_BYTE *)(v7 + 2936) != 1
      && *(_BYTE *)(v7 + 2937) != 1
      && *(_BYTE *)(v7 + 2938) != 1
      && *(_BYTE *)(v7 + 2944) != 1)
    {
      sub_219850628(1, (unsigned int *)(v7 + 19368), 4u, 1u, (uint64_t)"phLibNfc_Ioctl_PropSetCrcChkConfig: Feature Not supported!");
      v4 = 51;
      goto LABEL_14;
    }
    if (**a2 < 2u)
    {
      v4 = sub_2198D1B2C(v8, 122, 0, (uint64_t)a2, 0);
      if ((_DWORD)v4 == 13)
        goto LABEL_15;
      goto LABEL_14;
    }
    v4 = 1;
    v5 = 2;
  }
  else
  {
    v4 = 1;
    v3 = (unsigned int *)&v8;
    v5 = 0;
  }
  sub_219850628(v5, v3, 4u, 1u, (uint64_t)"phLibNfc_Ioctl_PropSetCrcChkConfig: Invalid Input Parameter!");
LABEL_14:
  sub_2198D2284(v8, 122);
  sub_219886108(v8, v4);
LABEL_15:
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_Ioctl_PropSetCrcChkConfig");
  return v4;
}

uint64_t sub_219874BC0(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  unsigned int *v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_EseCfg_GetFwVer");
  if (a1
    && (sub_21988EB80(*(_QWORD *)(a1 + 2952), &v11), sub_21988F460(*(_QWORD *)(a1 + 2952), &v10), (v4 = v11) != 0)
    && (v5 = v10) != 0)
  {
    v6 = v11 + 728;
    *(_QWORD *)(v11 + 752) = v11 + 471;
    *(_DWORD *)(v4 + 760) = 250;
    *(_DWORD *)(v4 + 728) = 241;
    *(_QWORD *)(v4 + 736) = 0;
    *(_DWORD *)(v4 + 744) = 0;
    *(_BYTE *)(v4 + 768) = 0;
    v7 = sub_2199072EC(*(_QWORD *)(v5 + 56), v6, a2, a1);
    v8 = (unsigned int *)(a1 + 19368);
    if ((_DWORD)v7 == 13)
      sub_219850628(1, v8, 4u, 4u, (uint64_t)"phDnldNfc_EseCfg_GetFwVer:GetVersion Request submitted successfully");
    else
      sub_219850628(1, v8, 4u, 1u, (uint64_t)"phDnldNfc_EseCfg_GetFwVer:GetVersion Request Failed!!");
  }
  else
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phDnldNfc_EseCfg_GetFwVer:Invalid LIBNFC/IOCTL context !!");
    v7 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_EseCfg_GetFwVer");
  return v7;
}

uint64_t phDnldNfc_DnldEsePwrCfgCmd(uint64_t a1, uint64_t a2, _QWORD *a3)
{
  uint64_t v6;
  char v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  const char *v11;
  int v12;
  unsigned int *v13;
  int v14;
  uint64_t v15;
  uint64_t v16;
  int v17;
  uint64_t Memory;
  uint64_t (*v19)(uint64_t, unsigned int, uint64_t);
  uint64_t v20;
  const char *v21;
  uint64_t v23;
  const char *v24;
  int v25;
  uint64_t v26;
  uint64_t v27;

  v26 = 0;
  v27 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEsePwrCfgCmd");
  if (!a1)
  {
    v11 = "phDnldNfc_DnldEsePwrCfgCmd: Invalid LIBNFC context!!";
    v12 = 2;
    v13 = 0;
    goto LABEL_28;
  }
  sub_21988F744(*(_QWORD *)(a1 + 2952), &v27);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v26);
  v6 = 1;
  if (!v27 || !v26)
    goto LABEL_30;
  if (*(_BYTE *)(a1 + 6026) || *(_BYTE *)(a1 + 6029) || *(_BYTE *)(v26 + 92))
  {
    v6 = a2;
    goto LABEL_8;
  }
  v6 = 255;
  v24 = "phDnldNfc_DnldEsePwrCfgCmd:Get FW ver Response Failed!!";
  if ((_DWORD)a2 || !a3 || !*a3)
    goto LABEL_44;
  v6 = 0;
  v25 = *(unsigned __int8 *)*a3;
  *(_BYTE *)(v26 + 92) = v25;
  if ((v25 - 208) >= 4 && v25 != 96)
  {
    v6 = 51;
    v24 = "phDnldNfc_DnldEsePwrCfgCmd:Unsupported Platform";
LABEL_44:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v24);
    if (*(_BYTE *)(v27 + 18) == 1)
      sub_2198750EC(a1, v6, (uint64_t)a3);
    else
      sub_2198752D8(a1, v6, (uint64_t)a3);
  }
LABEL_8:
  v7 = 0;
  v8 = 0;
  do
  {
    v9 = *((_QWORD *)&unk_253E46700 + 14 * v8 + 2);
    if ((v7 & 1) != 0)
      break;
    v7 = 1;
    v8 = 1;
  }
  while (v9 != a1);
  if (v9 == a1)
  {
    v10 = v26;
    if (*(_BYTE *)(a1 + 6026) == 1)
    {
LABEL_17:
      phOsalNfc_SetMemory();
      v15 = v26;
      *(_DWORD *)(v26 + 776) = 34;
      v16 = v27;
      *(_QWORD *)(v15 + 784) = v27 + 18;
      *(_DWORD *)(v15 + 792) = 1;
      v17 = *(unsigned __int8 *)(v16 + 18);
      Memory = phOsalNfc_GetMemory();
      *(_QWORD *)(v26 + 800) = Memory;
      if (Memory)
      {
        if (v17 == 1)
          v19 = sub_2198750EC;
        else
          v19 = sub_2198752D8;
        phOsalNfc_SetMemory();
        *(_DWORD *)(v26 + 808) = 27;
        phOsalNfc_SetMemory();
        if (sub_219907884(v27, v26 + 776, (uint64_t)v19, a1) == 13)
        {
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Download mode eSE power config submitted successfully");
          v20 = *(_QWORD *)(v27 + 48);
          v21 = "phDnldNfc_DnldEsePwrCfgCmd:Invalid Download Ese ResponseTimer ID";
          if (v20 && v20 != 0xFFFFFFFFFFFFLL && *(_BYTE *)(v27 + 16) != 1)
          {
            *(_DWORD *)(v27 + 32) = 2500;
            if (!phOsalNfc_Timer_Start())
            {
              *(_BYTE *)(v27 + 16) = 1;
              v6 = 13;
              goto LABEL_30;
            }
            v21 = "phDnldNfc_DnldEsePwrCfgCmd:Response Timer Start failed!!!";
          }
        }
        else
        {
          v21 = "phDnldNfc_DnldEsePwrCfgCmd:Download mode eSE config Failed!!";
        }
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v21);
        if (*(_QWORD *)(v26 + 800))
        {
          phOsalNfc_FreeMemory();
          v23 = v26;
          *(_QWORD *)(v26 + 800) = 0;
          *(_DWORD *)(v23 + 808) = 0;
        }
        goto LABEL_29;
      }
      v11 = "Download mode eSE power config memory allocation Failed!!";
      v12 = 1;
      v13 = (unsigned int *)(a1 + 19368);
LABEL_28:
      sub_219850628(v12, v13, 4u, 1u, (uint64_t)v11);
LABEL_29:
      v6 = 255;
      goto LABEL_30;
    }
  }
  else
  {
    v10 = v26;
  }
  v14 = *(unsigned __int8 *)(v10 + 92);
  if ((v14 - 208) < 4 || v14 == 96)
    goto LABEL_17;
  if ((_DWORD)v6 != 51 && (_DWORD)v6 != 255)
  {
    if (*(_BYTE *)(v10 + 92))
    {
      v6 = 51;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldEsePwrCfgCmd:Couldn't get the FW version");
      v6 = 255;
    }
    if (*(_BYTE *)(v27 + 18) == 1)
      sub_2198750EC(a1, v6, (uint64_t)a3);
    else
      sub_2198752D8(a1, v6, (uint64_t)a3);
  }
LABEL_30:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEsePwrCfgCmd");
  return v6;
}

uint64_t sub_2198750EC(uint64_t a1, unsigned int a2, uint64_t a3)
{
  _BYTE *v6;
  uint64_t v7;
  _BYTE *v8;
  BOOL v9;
  const char *v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;

  v16 = 0;
  v17 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseEnableCB");
  if (!a1)
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseEnableCB");
  v6 = (_BYTE *)(a1 + 6026);
  sub_21988F744(*(_QWORD *)(a1 + 2952), &v17);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v16);
  v7 = v17;
  if (a2 || !v17)
  {
    if (!a2)
    {
      v11 = 0;
LABEL_19:
      v12 = 223;
      goto LABEL_20;
    }
LABEL_14:
    *v6 = 0;
    *(_BYTE *)(a1 + 314) = 0;
    *(_QWORD *)(a1 + 400) = 0x300000000;
    *(_QWORD *)(a1 + 392) = 0;
    if (v7)
      *(_QWORD *)(v7 + 8) = 0;
    if (a2 == 214)
      v11 = 67;
    else
      v11 = a2;
    goto LABEL_19;
  }
  v8 = *(_BYTE **)(v17 + 768);
  if (!v8)
  {
    v10 = "phDnldNfc_DnldEseEnableCB:Invalid response buffer!!";
    goto LABEL_13;
  }
  if (*v8)
    v9 = 0;
  else
    v9 = *(_DWORD *)(v17 + 776) == 27;
  if (!v9)
  {
    v10 = "phDnldNfc_DnldEseEnableCB:Unsuccessful status received!!";
LABEL_13:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v10);
    a2 = 255;
    v7 = v17;
    goto LABEL_14;
  }
  v15 = 0;
  *(_BYTE *)(v17 + 29) = v8[1];
  do
  {
    *(_QWORD *)(v7 + 8 * v15 + 152) = 0;
    v7 = v17;
    *(_WORD *)(v17 + 2 * v15 + 216) = 1;
    *(_DWORD *)(v7 + 4 * v15++ + 232) = 0;
  }
  while (v15 != 8);
  v11 = 0;
  *(_OWORD *)(v7 + 136) = xmmword_21990A500;
  *v6 = 1;
  *(_BYTE *)(a1 + 314) = 1;
  *(_QWORD *)(a1 + 400) = 0x200000001;
  *(_QWORD *)(a1 + 392) = &unk_2550A41D8;
  *(_QWORD *)(v7 + 8) = &unk_2550A41D8;
  v12 = 222;
LABEL_20:
  sub_2198D1714(*(_QWORD *)(a1 + 2952), v12, v11, a3, 0);
  if (v16 && *(_QWORD *)(v16 + 800))
  {
    phOsalNfc_FreeMemory();
    v13 = v16;
    *(_QWORD *)(v16 + 800) = 0;
    *(_DWORD *)(v13 + 808) = 0;
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseEnableCB");
}

uint64_t sub_2198752D8(uint64_t a1, unsigned int a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseDisableCB");
  if (a1)
  {
    sub_21988F744(*(_QWORD *)(a1 + 2952), &v10);
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v11);
    *(_BYTE *)(a1 + 6026) = 0;
    *(_BYTE *)(a1 + 6028) = 0;
    *(_BYTE *)(a1 + 314) = 0;
    *(_QWORD *)(a1 + 400) = 0x300000000;
    *(_QWORD *)(a1 + 392) = 0;
    v6 = v10;
    if (v10)
    {
      *(_QWORD *)(v10 + 8) = 0;
      *(_BYTE *)(v6 + 29) = 0;
    }
    if (a2 == 214)
      v7 = 67;
    else
      v7 = a2;
    sub_2198D1714(*(_QWORD *)(a1 + 2952), 224, v7, a3, 0);
    if (v11 && *(_QWORD *)(v11 + 800))
    {
      phOsalNfc_FreeMemory();
      v8 = v11;
      *(_QWORD *)(v11 + 800) = 0;
      *(_DWORD *)(v8 + 808) = 0;
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseDisableCB");
}

uint64_t sub_2198753F4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  const char *v10;
  int v11;
  unsigned int *v12;
  uint64_t v13;
  int v15;
  uint64_t v16;
  uint64_t v17;

  v16 = 0;
  v17 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseTranscvCmd");
  if (!a1
    || (sub_21988F744(*(_QWORD *)(a1 + 2952), &v16), sub_21988EB80(*(_QWORD *)(a1 + 2952), &v17), !a3)
    || !v16
    || !v17
    || !*(_QWORD *)a3
    || !*(_QWORD *)(a3 + 16))
  {
    v10 = "phDnldNfc_DnldEseTranscvCmd : Invalid context / buffer received";
    v11 = 2;
    v12 = (unsigned int *)a1;
    goto LABEL_13;
  }
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  phOsalNfc_MemCopy();
  v5 = v16;
  v6 = v17;
  v7 = v17 + 776;
  *(_DWORD *)(v17 + 776) = 0;
  *(_QWORD *)(v6 + 784) = *(_QWORD *)a3;
  *(_DWORD *)(v6 + 792) = *(_DWORD *)(a3 + 8);
  *(_QWORD *)(v6 + 816) = *(_QWORD *)(a3 + 32);
  v8 = sub_219907884(v5, v7, (uint64_t)sub_219875658, a1);
  if ((_DWORD)v8 != 13)
  {
    v13 = v8;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldEseTranscvCmd : Download mode eSE transceive Failed!!");
    goto LABEL_14;
  }
  *(_BYTE *)(a1 + 6028) = 1;
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phDnldNfc_DnldEseTranscvCmd: Download mode eSE transceive submitted successfully");
  v9 = *(_QWORD *)(v16 + 48);
  if (!v9 || v9 == 0xFFFFFFFFFFFFLL || *(_BYTE *)(v16 + 16) == 1)
  {
    v10 = "phDnldNfc_DnldEseTranscvCmd : Invalid Download Ese ResponseTimer ID";
    v11 = 1;
    v12 = (unsigned int *)(a1 + 19368);
LABEL_13:
    sub_219850628(v11, v12, 4u, 1u, (uint64_t)v10);
    v13 = 255;
    goto LABEL_14;
  }
  if (*(_DWORD *)(v17 + 816) <= 0x2710u)
    v15 = 10000;
  else
    v15 = *(_DWORD *)(v17 + 816);
  *(_DWORD *)(v16 + 32) = v15;
  if (phOsalNfc_Timer_Start())
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldEseTranscvCmd : Response Timer Start failed!!!");
  else
    *(_BYTE *)(v16 + 16) = 1;
  v13 = 13;
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseTranscvCmd");
  return v13;
}

uint64_t sub_219875658(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v7;

  v7 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseTranscvRsp");
  if (a1)
  {
    sub_21988F744(*(_QWORD *)(a1 + 2952), &v7);
    if ((_DWORD)a2 && v7)
      *(_DWORD *)(v7 + 72) = 0;
    *(_BYTE *)(a1 + 6028) = 0;
    a2 = sub_2198D1714(*(_QWORD *)(a1 + 2952), 225, a2, a3, 0);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseTranscvRsp");
  return a2;
}

uint64_t sub_219875710(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  v10 = 0;
  sub_219850718(4, (unsigned int *)a1, 6u, 5u, (uint64_t)"phDnldEseNfc_ProcEseRemovedNtf");
  if (a1)
  {
    sub_21988EDF4(*(_QWORD *)a1, &v12);
    sub_21988F460(*(_QWORD *)a1, &v11);
    sub_21988EB80(*(_QWORD *)a1, &v10);
    v6 = v12;
    if (v12)
    {
      *(_BYTE *)(v12 + 6026) = 0;
      *(_BYTE *)(v6 + 6028) = 0;
      *(_BYTE *)(v6 + 314) = 0;
      *(_QWORD *)(v6 + 400) = 0x300000000;
      *(_QWORD *)(v6 + 392) = 0;
    }
    *(_QWORD *)(a1 + 8) = 0;
    *(_BYTE *)(a1 + 29) = 0;
    phOsalNfc_SetMemory();
    *(_DWORD *)(a1 + 72) = 0;
    if (v10 && *(_QWORD *)(v10 + 800))
    {
      phOsalNfc_FreeMemory();
      v7 = v10;
      *(_QWORD *)(v10 + 800) = 0;
      *(_DWORD *)(v7 + 808) = 0;
    }
    if (*(_QWORD *)(a1 + 712) || *(_QWORD *)(a1 + 728))
      v8 = 231;
    else
      v8 = 230;
    sub_2198D1714(*(_QWORD *)a1, v8, a2, a3, 0);
  }
  return sub_219850808(4, (unsigned int *)a1, 6u, 5u, (uint64_t)"phDnldEseNfc_ProcEseRemovedNtf");
}

uint64_t phDnldEseNfc_ProcOsResetNtf(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  uint64_t v7;

  v7 = 0;
  sub_219850718(4, a1, 6u, 5u, (uint64_t)"phDnldEseNfc_ProcOsResetNtf");
  if (a1)
  {
    sub_21988EDF4(*(_QWORD *)a1, &v7);
    if (v7)
      *(_BYTE *)(v7 + 6028) = 0;
    phOsalNfc_SetMemory();
    a1[18] = 0;
    sub_2198D1714(*(_QWORD *)a1, 225, a2, a3, 0);
  }
  return sub_219850808(4, a1, 6u, 5u, (uint64_t)"phDnldEseNfc_ProcOsResetNtf");
}

uint64_t phDnldNfc_DnldEseSmbCfgCmd(uint64_t a1, uint64_t a2, _QWORD *a3)
{
  uint64_t v6;
  char v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  const char *v11;
  int v12;
  unsigned int *v13;
  int v14;
  uint64_t v15;
  uint64_t Memory;
  uint64_t v17;
  const char *v18;
  uint64_t v20;
  const char *v21;
  int v22;
  uint64_t v23;
  uint64_t v24;

  v23 = 0;
  v24 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseSmbCfgCmd");
  if (!a1)
  {
    v11 = "phDnldNfc_DnldEseSmbCfgCmd: Invalid LIBNFC context!!";
    v12 = 2;
    v13 = 0;
    goto LABEL_25;
  }
  sub_21988F744(*(_QWORD *)(a1 + 2952), &v24);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v23);
  v6 = 1;
  if (!v24 || !v23)
    goto LABEL_27;
  if (*(_BYTE *)(a1 + 6026) || *(_BYTE *)(a1 + 6029) || *(_BYTE *)(v23 + 92))
  {
    v6 = a2;
    goto LABEL_8;
  }
  v6 = 255;
  v21 = "phDnldNfc_DnldEseSmbCfgCmd:Get FW ver Response Failed!!";
  if ((_DWORD)a2 || !a3 || !*a3)
    goto LABEL_41;
  v6 = 0;
  v22 = *(unsigned __int8 *)*a3;
  *(_BYTE *)(v23 + 92) = v22;
  if ((v22 - 209) >= 3 && v22 != 96)
  {
    v6 = 51;
    v21 = "phDnldNfc_DnldEseSmbCfgCmd:Unsupported Platform";
LABEL_41:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v21);
    phDnldNfc_DnldEseSmbCfgCb(a1, v6, (uint64_t)a3);
  }
LABEL_8:
  v7 = 0;
  v8 = 0;
  do
  {
    v9 = *((_QWORD *)&unk_253E46700 + 14 * v8 + 2);
    if ((v7 & 1) != 0)
      break;
    v7 = 1;
    v8 = 1;
  }
  while (v9 != a1);
  if (v9 == a1)
  {
    v10 = v23;
    if (*(_BYTE *)(a1 + 6029) == 1)
    {
LABEL_17:
      phOsalNfc_SetMemory();
      v15 = v23;
      *(_DWORD *)(v23 + 776) = 36;
      *(_QWORD *)(v15 + 784) = v24 + 24;
      *(_DWORD *)(v15 + 792) = 5;
      Memory = phOsalNfc_GetMemory();
      *(_QWORD *)(v23 + 800) = Memory;
      if (Memory)
      {
        phOsalNfc_SetMemory();
        *(_DWORD *)(v23 + 808) = 1;
        phOsalNfc_SetMemory();
        if (sub_219907884(v24, v23 + 776, (uint64_t)phDnldNfc_DnldEseSmbCfgCb, a1) == 13)
        {
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Download mode eSE Smb logging config cmd sent");
          v17 = *(_QWORD *)(v24 + 48);
          v18 = "phDnldNfc_DnldEseSmbCfgCmd:Invalid Download Ese ResponseTimer ID";
          if (v17 && v17 != 0xFFFFFFFFFFFFLL && *(_BYTE *)(v24 + 16) != 1)
          {
            *(_DWORD *)(v24 + 32) = 2500;
            if (!phOsalNfc_Timer_Start())
            {
              *(_BYTE *)(v24 + 16) = 1;
              v6 = 13;
              goto LABEL_27;
            }
            v18 = "phDnldNfc_DnldEseSmbCfgCmd:Response Timer Start failed!!!";
          }
        }
        else
        {
          v18 = "phDnldNfc_DnldEseSmbCfgCmd:Download mode eSE config Failed!!";
        }
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v18);
        if (*(_QWORD *)(v23 + 800))
        {
          phOsalNfc_FreeMemory();
          v20 = v23;
          *(_QWORD *)(v23 + 800) = 0;
          *(_DWORD *)(v20 + 808) = 0;
        }
        goto LABEL_26;
      }
      v11 = "Download mode eSE SMB config memory allocation Failed!!";
      v12 = 1;
      v13 = (unsigned int *)(a1 + 19368);
LABEL_25:
      sub_219850628(v12, v13, 4u, 1u, (uint64_t)v11);
LABEL_26:
      v6 = 255;
      goto LABEL_27;
    }
  }
  else
  {
    v10 = v23;
  }
  v14 = *(unsigned __int8 *)(v10 + 92);
  if ((v14 - 209) < 3 || v14 == 96)
    goto LABEL_17;
  if ((_DWORD)v6 != 51 && (_DWORD)v6 != 255)
  {
    if (*(_BYTE *)(v10 + 92))
    {
      v6 = 51;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DnldEseSmbCfgCmd:Couldn't get the FW version");
      v6 = 255;
    }
    phDnldNfc_DnldEseSmbCfgCb(a1, v6, (uint64_t)a3);
  }
LABEL_27:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseSmbCfgCmd");
  return v6;
}

uint64_t phDnldNfc_DnldEseSmbCfgCb(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _BYTE *v6;
  BOOL v7;
  const char *v8;
  uint64_t v9;
  char v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseSmbCfgCb");
  if (!a1)
    goto LABEL_26;
  sub_21988F744(*(_QWORD *)(a1 + 2952), &v16);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v15);
  if (v16)
  {
    if ((_DWORD)a2)
    {
      if (*(_DWORD *)(v16 + 20) == 1)
      {
        *(_BYTE *)(a1 + 6029) = 0;
        phDnldNfc_EseDeleteSmbList(a1);
      }
      goto LABEL_14;
    }
    v6 = *(_BYTE **)(v16 + 768);
    if (v6)
    {
      if (*v6)
        v7 = 0;
      else
        v7 = *(_DWORD *)(v16 + 776) == 1;
      if (v7)
      {
        if (*(_DWORD *)(v16 + 20) == 1)
        {
          a2 = 0;
          *(_BYTE *)(a1 + 6029) = 1;
        }
        else
        {
          *(_BYTE *)(a1 + 6029) = 0;
          phDnldNfc_EseDeleteSmbList(a1);
          a2 = 0;
        }
        goto LABEL_14;
      }
      v8 = "phDnldNfc_DnldEseSmbCfgCb:Unsuccessful status/invalid response  received!!";
    }
    else
    {
      v8 = "phDnldNfc_DnldEseSmbCfgCb:Invalid response buffer!!";
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v8);
    a2 = 255;
LABEL_14:
    if (*(_BYTE *)(a1 + 6026) == 1)
      v9 = 226;
    else
      v9 = 227;
    sub_2198D1714(*(_QWORD *)(a1 + 2952), v9, a2, a3, 0);
    if (v16)
    {
      v10 = 0;
      v11 = 0;
      do
      {
        v12 = *((_QWORD *)&unk_253E46700 + 14 * v11 + 8);
        if ((v10 & 1) != 0)
          break;
        v10 = 1;
        v11 = 1;
      }
      while (v12 != v16);
      if (v12 == v16)
      {
        phOsalNfc_SetMemory();
        *(_DWORD *)(v16 + 20) = 0;
      }
    }
  }
  if (v15 && *(_QWORD *)(v15 + 800))
  {
    phOsalNfc_FreeMemory();
    v13 = v15;
    *(_QWORD *)(v15 + 800) = 0;
    *(_DWORD *)(v13 + 808) = 0;
  }
LABEL_26:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseSmbCfgCb");
  return a2;
}

uint64_t phDnldNfc_EseDeleteSmbList(uint64_t a1)
{
  uint64_t v2;
  uint64_t i;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;

  v7 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_EseDeleteSmbList");
  if (a1)
  {
    sub_21988F744(*(_QWORD *)(a1 + 2952), &v7);
    if (v7)
    {
      v2 = *(_QWORD *)(v7 + 264);
      if (v2)
      {
        for (i = *(_QWORD *)(v2 + 296); i; i = *(_QWORD *)(v4 + 296))
        {
          v4 = i;
          phOsalNfc_FreeMemory();
        }
        phOsalNfc_FreeMemory();
        v5 = v7;
        *(_QWORD *)(v7 + 264) = 0;
      }
      else
      {
        sub_219850628(1, (unsigned int *)(v7 + 1368), 6u, 4u, (uint64_t)"phDnldEseNfc_HciDeleteList:List is empty");
        v5 = v7;
      }
      *(_WORD *)(v5 + 328) = 1;
      *(_DWORD *)(v5 + 344) = 0;
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_EseDeleteSmbList");
}

uint64_t phDnldNfc_DnldEseGetSmbCmd(uint64_t a1)
{
  uint64_t v2;
  uint64_t Memory;
  uint64_t RemainingSmbLog;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseGetSmbCmd");
  if (!a1 || (sub_21988F744(*(_QWORD *)(a1 + 2952), &v7), sub_21988EB80(*(_QWORD *)(a1 + 2952), &v8), !v7) || !v8)
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phDnldNfc_DnldEseGetSmbCmd : Invalid context / buffer received");
LABEL_8:
    RemainingSmbLog = 255;
    goto LABEL_9;
  }
  phOsalNfc_SetMemory();
  v2 = v7;
  *(_QWORD *)(v7 + 264) = 0;
  *(_WORD *)(v2 + 328) = 1;
  *(_DWORD *)(v2 + 344) = 0;
  Memory = phOsalNfc_GetMemory();
  *(_QWORD *)(v8 + 800) = Memory;
  if (!Memory)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Download mode eSE config memory allocation Failed!!");
    goto LABEL_11;
  }
  RemainingSmbLog = phDnldNfc_DnldEseGetRemainingSmbLog(a1);
  if ((_DWORD)RemainingSmbLog == 255)
  {
LABEL_11:
    if (*(_QWORD *)(v8 + 800))
    {
      phOsalNfc_FreeMemory();
      v6 = v8;
      *(_QWORD *)(v8 + 800) = 0;
      *(_DWORD *)(v6 + 808) = 0;
    }
    goto LABEL_8;
  }
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseGetSmbCmd");
  return RemainingSmbLog;
}

uint64_t phDnldNfc_DnldEseGetRemainingSmbLog(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  const char *v4;
  int v5;
  unsigned int *v6;
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseGetRemainingSmbLog");
  if (a1
    && (sub_21988F744(*(_QWORD *)(a1 + 2952), &v9), sub_21988EB80(*(_QWORD *)(a1 + 2952), &v10), v9)
    && (v2 = v10) != 0)
  {
    *(_DWORD *)(v10 + 776) = 37;
    *(_QWORD *)(v2 + 784) = 0;
    *(_DWORD *)(v2 + 792) = 0;
    phOsalNfc_SetMemory();
    *(_DWORD *)(v10 + 808) = 287;
    phOsalNfc_SetMemory();
    if (sub_219907884(v9, v10 + 776, (uint64_t)phDnldNfc_DnldEseGetSmbCb, a1) == 13)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Download mode eSE Get Smb logging cmd sent");
      v3 = *(_QWORD *)(v9 + 48);
      if (!v3 || v3 == 0xFFFFFFFFFFFFLL || *(_BYTE *)(v9 + 16) == 1)
      {
        v4 = "phDnldNfc_DnldEseGetRemainingSmbLog:Invalid Download Ese ResponseTimer ID";
      }
      else
      {
        *(_DWORD *)(v9 + 32) = 2500;
        if (!phOsalNfc_Timer_Start())
        {
          *(_BYTE *)(v9 + 16) = 1;
          v7 = 13;
          goto LABEL_13;
        }
        v4 = "phDnldNfc_DnldEseGetRemainingSmbLog:Response Timer Start failed!!!";
      }
    }
    else
    {
      v4 = "phDnldNfc_DnldEseGetRemainingSmbLog:Download mode Get Smb logging Failed!!";
    }
    v5 = 1;
    v6 = (unsigned int *)(a1 + 19368);
  }
  else
  {
    v4 = "phDnldNfc_DnldEseGetRemainingSmbLog:Invalid Context received!!";
    v5 = 2;
    v6 = (unsigned int *)a1;
  }
  sub_219850628(v5, v6, 4u, 1u, (uint64_t)v4);
  v7 = 255;
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseGetRemainingSmbLog");
  return v7;
}

uint64_t phDnldNfc_DnldEseGetSmbCb(uint64_t a1, uint64_t SmbList)
{
  _BYTE *v4;
  const char *v5;
  unsigned int v6;
  unsigned int v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;
  __int128 v13;
  __int128 v14;
  __int128 v15;
  __int128 v16;
  __int128 v17;
  __int128 v18;
  __int128 v19;
  __int128 v20;
  __int128 v21;
  __int128 v22;
  __int128 v23;
  __int128 v24;
  __int128 v25;
  __int128 v26;
  __int128 v27;
  __int128 v28;
  __int128 v29;
  uint64_t v30;

  v30 = *MEMORY[0x24BDAC8D0];
  v11 = 0;
  v12 = 0;
  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  v24 = 0u;
  v25 = 0u;
  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v18 = 0u;
  v19 = 0u;
  v16 = 0u;
  v17 = 0u;
  v14 = 0u;
  v15 = 0u;
  v13 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseGetSmbCb");
  if (!a1)
    goto LABEL_27;
  sub_21988F744(*(_QWORD *)(a1 + 2952), &v12);
  sub_21988EB80(*(_QWORD *)(a1 + 2952), &v11);
  if (!v12)
    goto LABEL_27;
  if ((_DWORD)SmbList)
    goto LABEL_17;
  v4 = *(_BYTE **)(v12 + 768);
  if (!v4)
  {
    v5 = "phDnldNfc_DnldEseGetSmbCb:Invalid response buffer!!";
    goto LABEL_16;
  }
  if (!*v4)
  {
    v6 = v4[1];
    if (v6 > 1)
    {
      v5 = "phDnldNfc_DnldEseGetSmbCb:Invalid value received for MoreLog field!!";
      goto LABEL_16;
    }
    v7 = *(_DWORD *)(v12 + 776);
    if (v7 >= 3)
    {
      SmbList = phDnldNfc_EseStoreSmbList(a1, (uint64_t)(v4 + 2), v7 - 2);
      if ((_DWORD)SmbList)
        goto LABEL_29;
      v6 = v4[1];
    }
    if (v6 == 1)
    {
      if (phDnldNfc_DnldEseGetRemainingSmbLog(a1) == 13)
      {
        SmbList = 13;
        goto LABEL_27;
      }
      goto LABEL_17;
    }
    phOsalNfc_SetMemory();
    SmbList = phDnldNfc_EseExtractSmbList(a1, (uint64_t)&v13 + 8);
LABEL_29:
    if ((_DWORD)SmbList == 13)
      goto LABEL_27;
    phDnldNfc_EseDeleteSmbList(a1);
    if ((_DWORD)SmbList != 255)
      goto LABEL_19;
    goto LABEL_18;
  }
  v5 = "phDnldNfc_DnldEseGetSmbCb:Unsuccessful status/invalid response  received!!";
LABEL_16:
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v5);
LABEL_17:
  phDnldNfc_EseDeleteSmbList(a1);
LABEL_18:
  LODWORD(v14) = 0;
  SmbList = 255;
LABEL_19:
  LODWORD(v13) = 1;
  if (*(_BYTE *)(a1 + 6026) == 1)
    v8 = 228;
  else
    v8 = 229;
  sub_2198D1714(*(_QWORD *)(a1 + 2952), v8, SmbList, (uint64_t)&v13, 0);
  if (*((_QWORD *)&v13 + 1))
  {
    phOsalNfc_FreeMemory();
    *((_QWORD *)&v13 + 1) = 0;
  }
  LODWORD(v14) = 0;
  if (v11 && *(_QWORD *)(v11 + 800))
  {
    phOsalNfc_FreeMemory();
    v9 = v11;
    *(_QWORD *)(v11 + 800) = 0;
    *(_DWORD *)(v9 + 808) = 0;
  }
LABEL_27:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_DnldEseGetSmbCb");
  return SmbList;
}

uint64_t phDnldNfc_EseStoreSmbList(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t Memory;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  unsigned int v16;
  uint64_t v17;

  v17 = 0;
  v16 = 255;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_EseStoreSmbList");
  if (a1)
  {
    sub_21988F744(*(_QWORD *)(a1 + 2952), &v17);
    v16 = *(_DWORD *)(a1 + 19368);
    v6 = v17;
  }
  else
  {
    v6 = 0;
  }
  v7 = 255;
  if (a2 && (a3 - 1) <= 0x11C && a1 && v6)
  {
    v8 = *(_QWORD *)(v6 + 264);
    if (v8)
    {
      do
      {
        v9 = v8;
        v8 = *(_QWORD *)(v8 + 296);
      }
      while (v8);
      Memory = phOsalNfc_GetMemory();
      *(_QWORD *)(v9 + 296) = Memory;
      if (!Memory)
      {
        sub_219850628(1, &v16, 4u, 1u, (uint64_t)"phDnldNfc_EseStoreSmbList:Memory allcation failed while creating new node!");
        v7 = 255;
        goto LABEL_17;
      }
      phOsalNfc_SetMemory();
      phOsalNfc_MemCopy();
      v7 = 0;
      v11 = *(_QWORD *)(v9 + 296);
      *(_DWORD *)(v11 + 288) = a3;
      *(_QWORD *)(v11 + 296) = 0;
      v12 = v17;
      ++*(_WORD *)(v17 + 328);
    }
    else
    {
      v13 = phOsalNfc_GetMemory();
      *(_QWORD *)(v17 + 264) = v13;
      if (!v13)
      {
        sub_219850628(1, &v16, 4u, 1u, (uint64_t)"phDnldNfc_EseStoreSmbList:Memory allcation failed while creating new node!");
        goto LABEL_17;
      }
      phOsalNfc_SetMemory();
      phOsalNfc_MemCopy();
      v7 = 0;
      v12 = v17;
      v14 = *(_QWORD *)(v17 + 264);
      *(_DWORD *)(v14 + 288) = a3;
      *(_QWORD *)(v14 + 296) = 0;
    }
    *(_DWORD *)(v12 + 344) += a3;
  }
LABEL_17:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_EseStoreSmbList");
  return v7;
}

uint64_t phDnldNfc_EseExtractSmbList(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t Memory;
  unsigned int v6;
  uint64_t v7;
  uint64_t v9;

  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_EseExtractSmbList");
  if (!a1 || (sub_21988F744(*(_QWORD *)(a1 + 2952), &v9), !a2) || !v9)
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phDnldNfc_EseExtractSmbList : Invalid context / buffer received");
    goto LABEL_12;
  }
  v4 = *(_QWORD *)(v9 + 264);
  if (v4)
  {
    Memory = phOsalNfc_GetMemory();
    *(_QWORD *)a2 = Memory;
    if (Memory)
    {
      phOsalNfc_SetMemory();
      v6 = 0;
      *(_DWORD *)(a2 + 8) = 0;
      do
      {
        if (!*(_DWORD *)(v4 + 288))
          break;
        if (v6 >= *(unsigned __int16 *)(v9 + 328))
          break;
        phOsalNfc_MemCopy();
        *(_DWORD *)(a2 + 8) += *(_DWORD *)(v4 + 288);
        v4 = *(_QWORD *)(v4 + 296);
        ++v6;
      }
      while (v4);
      goto LABEL_10;
    }
LABEL_12:
    v7 = 255;
    goto LABEL_13;
  }
LABEL_10:
  v7 = 0;
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_EseExtractSmbList");
  return v7;
}

uint64_t sub_219876844(uint64_t a1, uint64_t a2)
{
  unsigned int *v3;
  uint64_t v4;
  unsigned int *v5;
  const char *v6;
  uint64_t (*v7)(uint64_t, uint64_t);
  const char *v10;
  int v11;
  int v13;
  int v14;
  unsigned int *v15;
  uint64_t (*v16)(uint64_t, uint64_t);
  int v17;
  char v18;
  uint64_t (**v19)();
  uint64_t (*v20)();
  uint64_t *v21;
  uint64_t v22;
  uint64_t (**v23)();
  uint64_t (*v24)();
  uint64_t (**v25)();
  uint64_t (*v26)();
  uint64_t (**v27)();
  uint64_t (*v28)();
  uint64_t v29;
  unsigned int *v30;

  v29 = 0;
  v30 = 0;
  sub_219850718(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
  if (!a2)
  {
    v10 = "phDnldNfc_SpmiClientResetDelayCb:Invalid download core Context";
    v11 = 2;
    v3 = 0;
LABEL_19:
    sub_219850628(v11, v3, 4u, 1u, (uint64_t)v10);
    return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
  }
  sub_21988EDF4(*(_QWORD *)(a2 + 48), &v30);
  sub_21988EB80(*(_QWORD *)(a2 + 48), &v29);
  v3 = v30;
  if (!v30 || !v29)
  {
    v10 = "phDnldNfc_SpmiClientResetDelayCb:Invalid LIBNFC/IOCTL Context";
    v11 = 2;
    goto LABEL_19;
  }
  v4 = *(_QWORD *)(a2 + 72);
  if (!v4 || v4 == 0xFFFFFFFFFFFFLL)
  {
    v5 = v30 + 4842;
    v6 = "phDnldNfc_SpmiClientResetDelayCb: Invalid Timer Id";
LABEL_7:
    sub_219850628(1, v5, 4u, 1u, (uint64_t)v6);
    goto LABEL_8;
  }
  phOsalNfc_Timer_Stop();
  v13 = phTmlNfc_IoCtl();
  sub_219886334(1, v30 + 4842, 4u, 3u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb: SPMI Reset Client Status =");
  if (v13 == 179)
  {
    sub_219851790(1, v30 + 4842, 4u, 4u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb: SPMI Reset Client Retry Status =");
    phOsalNfc_Delay();
    v13 = phTmlNfc_IoCtl();
    sub_219886334(1, v30 + 4842, 4u, 3u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb: SPMI Reset Client Status =");
    if (v13 == 179)
    {
      sub_219851790(1, v30 + 4842, 4u, 4u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb: SPMI Reset Client Retry Status =");
      sub_219850628(1, v30 + 4842, 4u, 2u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb: SPMI RST got NACKED for 3times");
      v14 = phOsalNfc_Timer_Start();
      v5 = v30 + 4842;
      if (v14)
      {
        v6 = "phDnldNfc_SpmiClientResetDelayCb: Client reset Nack Timer Start failed";
      }
      else
      {
        sub_219850628(1, v5, 4u, 4u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb: Client reset Nack Timer Started");
        if (*(_QWORD *)(v29 + 200))
        {
          sub_219853E34(1, v30 + 4842, 4u, 4u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb : DnldGenNtfCb");
          (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v29 + 200))(*((_QWORD *)v30 + 369), *(_QWORD *)(v29 + 208), 304, 0);
          return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
        }
        phOsalNfc_Timer_Stop();
        v5 = v30 + 4842;
        v6 = "phDnldNfc_SpmiClientResetDelayCb: Download mode Generic Notification not registered";
      }
      goto LABEL_7;
    }
  }
  if (v13 != 255)
  {
    if (v13)
      return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
    phOsalNfc_Delay();
    phTmlNfc_IoCtl();
    v15 = v30;
    v16 = (uint64_t (*)(uint64_t, uint64_t))*((_QWORD *)v30 + 396);
    if (v16 == sub_219876DD0)
    {
      *((_QWORD *)v30 + 364) = off_2550A2D68;
      *((_BYTE *)v15 + 2904) = 0;
      *((_BYTE *)v15 + 2906) = 0;
      v18 = (char)off_2550A2D68[0];
      if (off_2550A2D68[0])
      {
        v18 = 0;
        v19 = off_2550A2D78;
        do
        {
          ++v18;
          v20 = *v19;
          v19 += 2;
        }
        while (v20);
      }
    }
    else if (v16 == sub_219876EA8)
    {
      *((_QWORD *)v30 + 364) = gphLibNfc_GetFwVersionSequence;
      *((_BYTE *)v15 + 2904) = 0;
      *((_BYTE *)v15 + 2906) = 0;
      v18 = (char)gphLibNfc_GetFwVersionSequence[0];
      if (gphLibNfc_GetFwVersionSequence[0])
      {
        v18 = 0;
        v21 = &qword_2550A0A88;
        do
        {
          ++v18;
          v22 = *v21;
          v21 += 2;
        }
        while (v22);
      }
    }
    else if (v16 == sub_219876F80)
    {
      *((_QWORD *)v30 + 364) = &qword_2550A2EB8;
      *((_BYTE *)v15 + 2904) = 0;
      *((_BYTE *)v15 + 2906) = 0;
      v18 = qword_2550A2EB8;
      if (qword_2550A2EB8)
      {
        v18 = 0;
        v23 = off_2550A2EC8;
        do
        {
          ++v18;
          v24 = *v23;
          v23 += 2;
        }
        while (v24);
      }
    }
    else if (v16 == sub_219877058)
    {
      *((_QWORD *)v30 + 364) = gphLibNfc_GetMemDumpSequence;
      *((_BYTE *)v15 + 2904) = 0;
      *((_BYTE *)v15 + 2906) = 0;
      v18 = (char)gphLibNfc_GetMemDumpSequence[0];
      if (gphLibNfc_GetMemDumpSequence[0])
      {
        v18 = 0;
        v25 = off_2550A0A58;
        do
        {
          ++v18;
          v26 = *v25;
          v25 += 2;
        }
        while (v26);
      }
    }
    else
    {
      if (v16 != sub_219877130)
      {
        if (v16 == phDnldNfc_eSEPwrCfgVenResetTimeoutCb)
        {
          v17 = phLibNfc_DnldEsePwrCfgSeq((uint64_t)v30, v29);
        }
        else
        {
          if (v16 != phDnldNfc_eSESmbCfgVenResetTimeoutCb)
          {
LABEL_69:
            v5 = v15 + 4842;
            v6 = "phLibNfc_SpmiClientResetDelayCb:Dnld mode sequence failed";
            goto LABEL_7;
          }
          v17 = phLibNfc_DnldEseSmbCfgSeq((uint64_t)v30, v29);
        }
LABEL_67:
        if (v17 == 13)
          return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
        v15 = v30;
        goto LABEL_69;
      }
      *((_QWORD *)v30 + 364) = &qword_2550A2F08;
      *((_BYTE *)v15 + 2904) = 0;
      *((_BYTE *)v15 + 2906) = 0;
      v18 = qword_2550A2F08;
      if (qword_2550A2F08)
      {
        v18 = 0;
        v27 = off_2550A2F18;
        do
        {
          ++v18;
          v28 = *v27;
          v27 += 2;
        }
        while (v28);
      }
    }
    *((_BYTE *)v15 + 2905) = v18;
    v17 = sub_2198655FC((uint64_t)v15, 0, 0);
    goto LABEL_67;
  }
LABEL_8:
  v7 = (uint64_t (*)(uint64_t, uint64_t))*((_QWORD *)v30 + 396);
  if (v7 != sub_219877130 && v7 != sub_219876DD0 && v7 != sub_219876F80)
  {
    if (v7 == sub_219876EA8)
    {
      sub_219867C98((uint64_t)v30, 255);
      return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
    }
    if (v7 == sub_219877058)
    {
      phLibNfc_GetMemoryDumpSeqComplete(v30, 255);
      return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
    }
    if (v7 == phDnldNfc_eSEPwrCfgVenResetTimeoutCb)
    {
      sub_2198750EC((uint64_t)v30, 0xFFu, 0);
      return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
    }
    if (v7 == phDnldNfc_eSESmbCfgVenResetTimeoutCb)
    {
      phDnldNfc_DnldEseSmbCfgCb((uint64_t)v30, 255, 0);
      return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
    }
    v3 = v30 + 4842;
    v10 = "phDnldNfc_SpmiClientResetDelayCb:Invalid callback";
    v11 = 1;
    goto LABEL_19;
  }
  sub_219872978(v30, 255, 0);
  return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_SpmiClientResetDelayCb");
}

uint64_t sub_219876DD0(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;

  v9 = 0;
  sub_219850718(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_FwDnldVenResetTimeoutCb");
  if (!a2)
  {
    v5 = "phDnldNfc_FwDnldVenResetTimoutCb:Invalid Context";
    v6 = 2;
    v7 = 0;
LABEL_9:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_FwDnldVenResetTimeoutCb");
  }
  sub_21988EDF4(*(_QWORD *)(a2 + 48), &v9);
  v3 = v9;
  if (!v9)
  {
    v7 = (unsigned int *)(a2 + 8492);
    v5 = "phDnldNfc_FwDnldVenResetTimoutCb:Invalid LIBNFC Context";
    v6 = 1;
    goto LABEL_9;
  }
  v4 = *(_QWORD *)(a2 + 72);
  if (v4 && v4 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    v3 = v9;
  }
  *(_QWORD *)(v3 + 3168) = 0;
  sub_2198775AC((unsigned int *)v3, 307);
  return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_FwDnldVenResetTimeoutCb");
}

uint64_t sub_219876EA8(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  int v5;
  unsigned int *v6;
  uint64_t v8;

  v8 = 0;
  sub_219850718(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_FwVerVenResetTimeoutCb");
  if (!a2)
  {
    v5 = 2;
    v6 = 0;
LABEL_9:
    sub_219850628(v5, v6, 4u, 1u, (uint64_t)"phDnldNfc_FwVerVenResetTimoutCb:Invalid Context");
    return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_FwVerVenResetTimeoutCb");
  }
  sub_21988EDF4(*(_QWORD *)(a2 + 48), &v8);
  v3 = v8;
  if (!v8)
  {
    v6 = (unsigned int *)(a2 + 8492);
    v5 = 1;
    goto LABEL_9;
  }
  v4 = *(_QWORD *)(a2 + 72);
  if (v4 && v4 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    v3 = v8;
  }
  *(_QWORD *)(v3 + 3168) = 0;
  sub_21987771C((unsigned int *)v3, 307);
  return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_FwVerVenResetTimeoutCb");
}

uint64_t sub_219876F80(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;

  v9 = 0;
  sub_219850718(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_DieIDVenResetTimeoutCb");
  if (!a2)
  {
    v5 = "phDnldNfc_DieIDVenResetTimeoutCb:Invalid Context";
    v6 = 2;
    v7 = 0;
LABEL_9:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_DieIDVenResetTimeoutCb");
  }
  sub_21988EDF4(*(_QWORD *)(a2 + 48), &v9);
  v3 = v9;
  if (!v9)
  {
    v7 = (unsigned int *)(a2 + 8492);
    v5 = "phDnldNfc_DieIDVenResetTimeoutCb:Invalid LIBNFC Context";
    v6 = 1;
    goto LABEL_9;
  }
  v4 = *(_QWORD *)(a2 + 72);
  if (v4 && v4 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    v3 = v9;
  }
  *(_QWORD *)(v3 + 3168) = 0;
  sub_21987788C((unsigned int *)v3, 307);
  return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_DieIDVenResetTimeoutCb");
}

uint64_t sub_219877058(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;

  v9 = 0;
  sub_219850718(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_MemDmpVenResetTimeoutCb");
  if (!a2)
  {
    v5 = "phDnldNfc_MemDmpVenResetTimeoutCb:Invalid Context";
    v6 = 2;
    v7 = 0;
LABEL_9:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_MemDmpVenResetTimeoutCb");
  }
  sub_21988EDF4(*(_QWORD *)(a2 + 48), &v9);
  v3 = v9;
  if (!v9)
  {
    v7 = (unsigned int *)(a2 + 8492);
    v5 = "phDnldNfc_MemDmpVenResetTimeoutCb:Invalid LIBNFC Context";
    v6 = 1;
    goto LABEL_9;
  }
  v4 = *(_QWORD *)(a2 + 72);
  if (v4 && v4 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    v3 = v9;
  }
  *(_QWORD *)(v3 + 3168) = 0;
  sub_2198779FC((unsigned int *)v3, 307);
  return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_MemDmpVenResetTimeoutCb");
}

uint64_t sub_219877130(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;

  v9 = 0;
  sub_219850718(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_ChkIntVenResetTimeoutCb");
  if (!a2)
  {
    v5 = "phDnldNfc_ChkIntVenResetTimeoutCb:Invalid Context";
    v6 = 2;
    v7 = 0;
LABEL_9:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_ChkIntVenResetTimeoutCb");
  }
  sub_21988EDF4(*(_QWORD *)(a2 + 48), &v9);
  v3 = v9;
  if (!v9)
  {
    v7 = (unsigned int *)(a2 + 8492);
    v5 = "phDnldNfc_ChkIntVenResetTimeoutCb:Invalid LIBNFC Context";
    v6 = 1;
    goto LABEL_9;
  }
  v4 = *(_QWORD *)(a2 + 72);
  if (v4 && v4 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    v3 = v9;
  }
  *(_QWORD *)(v3 + 3168) = 0;
  sub_219877B70((unsigned int *)v3, 307);
  return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_ChkIntVenResetTimeoutCb");
}

uint64_t phDnldNfc_eSEPwrCfgVenResetTimeoutCb(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;

  v9 = 0;
  sub_219850718(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_eSEPwrCfgVenResetTimeoutCb");
  if (!a2)
  {
    v5 = "phDnldNfc_eSEPwrCfgVenResetTimeoutCb:Invalid Context";
    v6 = 2;
    v7 = 0;
LABEL_9:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_eSEPwrCfgVenResetTimeoutCb");
  }
  sub_21988EDF4(*(_QWORD *)(a2 + 48), &v9);
  v3 = v9;
  if (!v9)
  {
    v7 = (unsigned int *)(a2 + 8492);
    v5 = "phDnldNfc_eSEPwrCfgVenResetTimeoutCb:Invalid LIBNFC Context";
    v6 = 1;
    goto LABEL_9;
  }
  v4 = *(_QWORD *)(a2 + 72);
  if (v4 && v4 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    v3 = v9;
  }
  *(_QWORD *)(v3 + 3168) = 0;
  phDnldNfc_eSEPwrCfgAfterVenReset(v3, 0x133u);
  return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_eSEPwrCfgVenResetTimeoutCb");
}

uint64_t phLibNfc_DnldEsePwrCfgSeq(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  int v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldEsePwrCfgSeq");
  v4 = 255;
  if (a1 && a2)
  {
    if (*(_BYTE *)(a1 + 6026) != 1)
    {
      v5 = *(unsigned __int8 *)(a2 + 92);
      if ((v5 - 208) >= 4)
      {
        if (!*(_BYTE *)(a2 + 92))
        {
          if (*(_QWORD *)a2)
            v6 = sub_2198783D4(a1);
          else
            v6 = sub_219874BC0(a1, (uint64_t)phDnldNfc_DnldEsePwrCfgCmd);
          goto LABEL_6;
        }
        if (v5 != 96)
        {
          v4 = 51;
          goto LABEL_7;
        }
      }
    }
    v6 = phDnldNfc_DnldEsePwrCfgCmd(a1, 0, 0);
LABEL_6:
    v4 = v6;
  }
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldEsePwrCfgSeq");
  return v4;
}

uint64_t phDnldNfc_eSESmbCfgVenResetTimeoutCb(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  uint64_t v9;

  v9 = 0;
  sub_219850718(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_eSESmbCfgVenResetTimeoutCb");
  if (!a2)
  {
    v5 = "phDnldNfc_eSESmbCfgVenResetTimeoutCb:Invalid Context";
    v6 = 2;
    v7 = 0;
LABEL_9:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_eSESmbCfgVenResetTimeoutCb");
  }
  sub_21988EDF4(*(_QWORD *)(a2 + 48), &v9);
  v3 = v9;
  if (!v9)
  {
    v7 = (unsigned int *)(a2 + 8492);
    v5 = "phDnldNfc_eSESmbCfgVenResetTimeoutCb:Invalid LIBNFC Context";
    v6 = 1;
    goto LABEL_9;
  }
  v4 = *(_QWORD *)(a2 + 72);
  if (v4 && v4 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    v3 = v9;
  }
  *(_QWORD *)(v3 + 3168) = 0;
  sub_219850628(1, (unsigned int *)(a2 + 8492), 4u, 2u, (uint64_t)"phDnldNfc_eSESmbCfgVenResetTimeoutCb:Timed out, Ven Reset NOT done by host");
  phDnldNfc_eSESmbCfgAfterVenReset(v9, 307);
  return sub_219850808(3, (unsigned int *)a2, 6u, 5u, (uint64_t)"phDnldNfc_eSESmbCfgVenResetTimeoutCb");
}

uint64_t phLibNfc_DnldEseSmbCfgSeq(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  int v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldEseSmbCfgSeq");
  v4 = 255;
  if (a1 && a2)
  {
    if (*(_BYTE *)(a1 + 6029) != 1)
    {
      v5 = *(unsigned __int8 *)(a2 + 92);
      if ((v5 - 209) >= 3)
      {
        if (!*(_BYTE *)(a2 + 92))
        {
          if (*(_QWORD *)a2)
            v6 = sub_2198783D4(a1);
          else
            v6 = sub_219874BC0(a1, (uint64_t)phDnldNfc_DnldEseSmbCfgCmd);
          goto LABEL_8;
        }
        if (v5 != 96)
        {
          v4 = 51;
          goto LABEL_9;
        }
      }
    }
    v6 = phDnldNfc_DnldEseSmbCfgCmd(a1, 0, 0);
LABEL_8:
    v4 = v6;
  }
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DnldEseSmbCfgSeq");
  return v4;
}

uint64_t sub_2198775AC(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int *v4;
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  uint64_t v10;
  uint64_t v11;
  uint64_t v13;

  v3 = (uint64_t)a1;
  v13 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phDnldNfc_FwDnldAfterVenReset");
  if (v3)
  {
    sub_21988F460(*(_QWORD *)(v3 + 2952), &v13);
    if (v13)
    {
      if (*(_QWORD *)(v13 + 56))
      {
        if ((_DWORD)a2)
        {
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_FwDnldAfterVenReset:Invoked with failure status");
          v4 = (unsigned int *)v3;
          v5 = a2;
        }
        else
        {
          *(_QWORD *)(v3 + 2912) = off_2550A2D68;
          *(_BYTE *)(v3 + 2904) = 0;
          *(_BYTE *)(v3 + 2906) = 0;
          v7 = (char)off_2550A2D68[0];
          if (off_2550A2D68[0])
          {
            v7 = 0;
            v8 = off_2550A2D78;
            do
            {
              ++v7;
              v9 = *v8;
              v8 += 2;
            }
            while (v9);
          }
          *(_BYTE *)(v3 + 2905) = v7;
          v10 = sub_2198655FC(v3, 0, 0);
          if ((_DWORD)v10 == 13)
            goto LABEL_13;
          v11 = v10;
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_FwDnldAfterVenReset:Failed to invoke FwDnld Sequence");
          v4 = (unsigned int *)v3;
          v5 = v11;
        }
        sub_219872978(v4, v5, 0);
        v3 = 0;
LABEL_13:
        v6 = 0;
        goto LABEL_14;
      }
    }
  }
  sub_219850628(2, (unsigned int *)v3, 4u, 1u, (uint64_t)"phDnldNfc_FwDnldAfterVenReset:Invalid Context");
  v6 = 255;
LABEL_14:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phDnldNfc_FwDnldAfterVenReset");
  return v6;
}

uint64_t sub_21987771C(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t *v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v13;

  v3 = (uint64_t)a1;
  v13 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phDnldNfc_FwVerAfterVenReset");
  if (v3)
  {
    sub_21988F460(*(_QWORD *)(v3 + 2952), &v13);
    if (v13)
    {
      if (*(_QWORD *)(v13 + 56))
      {
        if ((_DWORD)a2)
        {
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_FwVerAfterVenReset:Invoked with failure status");
          v4 = v3;
          v5 = a2;
        }
        else
        {
          *(_QWORD *)(v3 + 2912) = gphLibNfc_GetFwVersionSequence;
          *(_BYTE *)(v3 + 2904) = 0;
          *(_BYTE *)(v3 + 2906) = 0;
          v7 = (char)gphLibNfc_GetFwVersionSequence[0];
          if (gphLibNfc_GetFwVersionSequence[0])
          {
            v7 = 0;
            v8 = &qword_2550A0A88;
            do
            {
              ++v7;
              v9 = *v8;
              v8 += 2;
            }
            while (v9);
          }
          *(_BYTE *)(v3 + 2905) = v7;
          v10 = sub_2198655FC(v3, 0, 0);
          if ((_DWORD)v10 == 13)
            goto LABEL_13;
          v11 = v10;
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_FwVerAfterVenReset:Failed to start GetFwVer Sequence");
          v4 = v3;
          v5 = v11;
        }
        sub_219867C98(v4, v5);
        v3 = 0;
LABEL_13:
        v6 = 0;
        goto LABEL_14;
      }
    }
  }
  sub_219850628(2, (unsigned int *)v3, 4u, 1u, (uint64_t)"phDnldNfc_FwVerAfterVenReset:Invalid Context");
  v6 = 255;
LABEL_14:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phDnldNfc_FwVerAfterVenReset");
  return v6;
}

uint64_t sub_21987788C(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int *v4;
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  uint64_t v10;
  uint64_t v11;
  uint64_t v13;

  v3 = (uint64_t)a1;
  v13 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phDnldNfc_DieIDAfterVenReset");
  if (v3)
  {
    sub_21988F460(*(_QWORD *)(v3 + 2952), &v13);
    if (v13)
    {
      if (*(_QWORD *)(v13 + 56))
      {
        if ((_DWORD)a2)
        {
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DieIDAfterVenReset:Invoked with failure status");
          v4 = (unsigned int *)v3;
          v5 = a2;
        }
        else
        {
          *(_QWORD *)(v3 + 2912) = &qword_2550A2EB8;
          *(_BYTE *)(v3 + 2904) = 0;
          *(_BYTE *)(v3 + 2906) = 0;
          v7 = qword_2550A2EB8;
          if (qword_2550A2EB8)
          {
            v7 = 0;
            v8 = off_2550A2EC8;
            do
            {
              ++v7;
              v9 = *v8;
              v8 += 2;
            }
            while (v9);
          }
          *(_BYTE *)(v3 + 2905) = v7;
          v10 = sub_2198655FC(v3, 0, 0);
          if ((_DWORD)v10 == 13)
            goto LABEL_13;
          v11 = v10;
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_DieIDAfterVenReset:Failed to invoke Get Die ID Sequence");
          v4 = (unsigned int *)v3;
          v5 = v11;
        }
        sub_219872978(v4, v5, 0);
        v3 = 0;
LABEL_13:
        v6 = 0;
        goto LABEL_14;
      }
    }
  }
  sub_219850628(2, (unsigned int *)v3, 4u, 1u, (uint64_t)"phDnldNfc_DieIDAfterVenReset:Invalid Context");
  v6 = 255;
LABEL_14:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phDnldNfc_DieIDAfterVenReset");
  return v6;
}

uint64_t sub_2198779FC(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  char v5;
  uint64_t (**v6)();
  uint64_t (*v7)();
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;

  v3 = (uint64_t)a1;
  v11 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phDnldNfc_MemDmpAfterVenReset");
  if (v3 && (sub_21988F460(*(_QWORD *)(v3 + 2952), &v11), v11) && *(_QWORD *)(v11 + 56))
  {
    if ((_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_MemDmpAfterVenReset:Invoked with failure status");
      phLibNfc_GetMemoryDumpSeqComplete((unsigned int *)v3, a2);
    }
    else
    {
      *(_QWORD *)(v3 + 2912) = gphLibNfc_GetMemDumpSequence;
      *(_BYTE *)(v3 + 2904) = 0;
      *(_BYTE *)(v3 + 2906) = 0;
      v5 = (char)gphLibNfc_GetMemDumpSequence[0];
      if (gphLibNfc_GetMemDumpSequence[0])
      {
        v5 = 0;
        v6 = off_2550A0A58;
        do
        {
          ++v5;
          v7 = *v6;
          v6 += 2;
        }
        while (v7);
      }
      *(_BYTE *)(v3 + 2905) = v5;
      v8 = sub_2198655FC(v3, 0, 0);
      if ((_DWORD)v8 != 13)
      {
        v9 = v8;
        sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_MemDmpAfterVenReset:Failed to invoke Get Mem Dump Sequence");
        phLibNfc_GetMemoryDumpSeqComplete((unsigned int *)v3, v9);
        v3 = 0;
      }
    }
    v4 = 0;
  }
  else
  {
    sub_219850628(2, (unsigned int *)v3, 4u, 1u, (uint64_t)"phDnldNfc_MemDmpAfterVenReset:Invalid Context");
    v4 = 255;
  }
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phDnldNfc_MemDmpAfterVenReset");
  return v4;
}

uint64_t sub_219877B70(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int *v4;
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  uint64_t v10;
  uint64_t v11;
  uint64_t v13;

  v3 = (uint64_t)a1;
  v13 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phDnldNfc_ChkIntAfterVenReset");
  if (v3)
  {
    sub_21988F460(*(_QWORD *)(v3 + 2952), &v13);
    if (v13)
    {
      if (*(_QWORD *)(v13 + 56))
      {
        if ((_DWORD)a2)
        {
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_ChkIntAfterVenReset:Invoked with failure status");
          v4 = (unsigned int *)v3;
          v5 = a2;
        }
        else
        {
          *(_QWORD *)(v3 + 2912) = &qword_2550A2F08;
          *(_BYTE *)(v3 + 2904) = 0;
          *(_BYTE *)(v3 + 2906) = 0;
          v7 = qword_2550A2F08;
          if (qword_2550A2F08)
          {
            v7 = 0;
            v8 = off_2550A2F18;
            do
            {
              ++v7;
              v9 = *v8;
              v8 += 2;
            }
            while (v9);
          }
          *(_BYTE *)(v3 + 2905) = v7;
          v10 = sub_2198655FC(v3, 0, 0);
          if ((_DWORD)v10 == 13)
            goto LABEL_13;
          v11 = v10;
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_ChkIntAfterVenReset:Failed to invoke check integrity Sequence");
          v4 = (unsigned int *)v3;
          v5 = v11;
        }
        sub_219872978(v4, v5, 0);
        v3 = 0;
LABEL_13:
        v6 = 0;
        goto LABEL_14;
      }
    }
  }
  sub_219850628(2, (unsigned int *)v3, 4u, 1u, (uint64_t)"phDnldNfc_ChkIntAfterVenReset:Invalid Context");
  v6 = 255;
LABEL_14:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phDnldNfc_ChkIntAfterVenReset");
  return v6;
}

uint64_t phDnldNfc_eSEPwrCfgAfterVenReset(uint64_t a1, unsigned int a2)
{
  BOOL v4;
  uint64_t v5;
  unsigned int v7;
  unsigned int v8;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_eSEPwrCfgAfterVenReset");
  if (a1
    && (sub_21988EB80(*(_QWORD *)(a1 + 2952), &v9), sub_21988F460(*(_QWORD *)(a1 + 2952), &v10), v10)
    && (*(_QWORD *)(v10 + 56) ? (v4 = v9 == 0) : (v4 = 1), !v4))
  {
    if (a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_eSEPwrCfgAfterVenReset:Invoked with failure status");
      sub_2198750EC(a1, a2, 0);
    }
    else
    {
      v7 = phLibNfc_DnldEsePwrCfgSeq(a1, v9);
      if (v7 != 13)
      {
        v8 = v7;
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phDnldNfc_eSEPwrCfgAfterVenReset:Failed to invoke Dnld Ese power Config Sequence");
        sub_2198752D8(a1, v8, 0);
      }
    }
    v5 = 0;
  }
  else
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phDnldNfc_eSEPwrCfgAfterVenReset:Invalid Context");
    v5 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_eSEPwrCfgAfterVenReset");
  return v5;
}

uint64_t phDnldNfc_eSESmbCfgAfterVenReset(uint64_t a1, uint64_t a2)
{
  uint64_t v5;
  unsigned int *v7;
  const char *v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_eSESmbCfgAfterVenReset");
  if (a1)
  {
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v10);
    sub_21988F460(*(_QWORD *)(a1 + 2952), &v11);
    if (v11)
    {
      if (*(_QWORD *)(v11 + 56) && v10 != 0)
      {
        if ((_DWORD)a2)
        {
          v7 = (unsigned int *)(a1 + 19368);
          v8 = "phDnldNfc_eSESmbCfgAfterVenReset:Invoked with failure status";
        }
        else
        {
          v9 = phLibNfc_DnldEseSmbCfgSeq(a1, v10);
          if ((_DWORD)v9 == 13)
          {
LABEL_15:
            v5 = 0;
            goto LABEL_9;
          }
          a2 = v9;
          v7 = (unsigned int *)(a1 + 19368);
          v8 = "phDnldNfc_eSESmbCfgAfterVenReset:Failed to invoke Dnld Ese Smb Config Sequence";
        }
        sub_219850628(1, v7, 4u, 1u, (uint64_t)v8);
        phDnldNfc_DnldEseSmbCfgCb(a1, a2, 0);
        goto LABEL_15;
      }
    }
  }
  sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phDnldNfc_eSESmbCfgAfterVenReset:Invalid Context");
  v5 = 255;
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phDnldNfc_eSESmbCfgAfterVenReset");
  return v5;
}

uint64_t phLibNfc_EsePwrCfgDelayCb(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_EsePwrCfgDelayCb");
  if (!a1 || a1 == 0xFFFFFFFFFFFFLL || !a2)
    goto LABEL_10;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 2);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a2);
  if (v6 == a2 && *(_QWORD *)(a2 + 3208) == a1)
  {
    sub_21988C4AC(*(_DWORD *)(a2 + 19368), a1);
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(a2 + 3208) = 0xFFFFFFFFFFFFLL;
    phDnldNfc_DnldEsePwrCfgCmd(a2, 0, 0);
  }
  else
  {
LABEL_10:
    sub_219850628(2, (unsigned int *)a2, 4u, 1u, (uint64_t)"phLibNfc_EsePwrCfgDelayCb:Invalid Timer ID!!");
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_EsePwrCfgDelayCb");
}

uint64_t phLibNfc_EseSmbCfgDelayCb(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_EseSmbCfgDelayCb");
  if (!a1 || a1 == 0xFFFFFFFFFFFFLL || !a2)
    goto LABEL_10;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 2);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a2);
  if (v6 == a2 && *(_QWORD *)(a2 + 3208) == a1)
  {
    sub_21988C4AC(*(_DWORD *)(a2 + 19368), a1);
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(a2 + 3208) = 0xFFFFFFFFFFFFLL;
    phDnldNfc_DnldEseSmbCfgCmd(a2, 0, 0);
  }
  else
  {
LABEL_10:
    sub_219850628(2, (unsigned int *)a2, 4u, 1u, (uint64_t)"phLibNfc_EseSmbCfgDelayCb:Invalid Timer ID!!");
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_EseSmbCfgDelayCb");
}

uint64_t sub_219878150(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_IoctlDelayCb");
  if (!a1 || a1 == 0xFFFFFFFFFFFFLL || !a2)
    goto LABEL_10;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 2);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a2);
  if (v6 == a2 && *(_QWORD *)(a2 + 3200) == a1)
  {
    sub_21988C4AC(*(_DWORD *)(a2 + 19368), a1);
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(a2 + 3200) = 0xFFFFFFFFFFFFLL;
    sub_2198655FC(a2, 0, 0);
  }
  else
  {
LABEL_10:
    sub_219850628(2, (unsigned int *)a2, 4u, 1u, (uint64_t)"phLibNfc_IoctlDelayCb:Invalid Timer ID!!");
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_IoctlDelayCb");
}

uint64_t sub_219878254(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v9;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FwVerDelayTimerStart");
  if (a1)
  {
    v2 = 0;
    v3 = 0;
    do
    {
      v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 2);
      if ((v2 & 1) != 0)
        break;
      v2 = 1;
      v3 = 1;
    }
    while (v4 != a1);
    if (v4 == a1)
    {
      v7 = phOsalNfc_Timer_Create();
      if (v7 == 0xFFFFFFFFFFFFLL || v7 == 0)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_FwVerDelayTimerStart : Dnld Ese Get Fw Version Timer Create failed!!");
        v5 = 12;
        goto LABEL_7;
      }
      v9 = v7;
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Dnld Ese Get Fw Version Timer Created");
      *(_QWORD *)(a1 + 3200) = v9;
      if (!phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_FwVerDelayTimerStart: Dnld Ese Get Fw Ver Timer started");
        v5 = 13;
        goto LABEL_7;
      }
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_FwVerDelayTimerStart: Dnld Ese Get Fw Ver Timer failed to start");
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 3200) = 0;
    }
  }
  v5 = 255;
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FwVerDelayTimerStart");
  return v5;
}

uint64_t sub_2198783D4(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v9;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_EseCfgDelayTimerStart");
  if (a1)
  {
    v2 = 0;
    v3 = 0;
    do
    {
      v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 2);
      if ((v2 & 1) != 0)
        break;
      v2 = 1;
      v3 = 1;
    }
    while (v4 != a1);
    if (v4 == a1)
    {
      v7 = phOsalNfc_Timer_Create();
      if (v7 == 0xFFFFFFFFFFFFLL || v7 == 0)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_EseCfgDelayTimerStart : Dnld Ese Cfg Timer Create failed!!");
        v5 = 12;
        goto LABEL_7;
      }
      v9 = v7;
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Dnld Ese Cfg Timer Created");
      *(_QWORD *)(a1 + 3208) = v9;
      if (!phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_EseCfgDelayTimerStart: Dnld Ese Cfg Timer started");
        v5 = 13;
        goto LABEL_7;
      }
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_EseCfgDelayTimerStart: Dnld Ese Cfg Timer failed to start");
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 3208) = 0;
    }
  }
  v5 = 255;
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_EseCfgDelayTimerStart");
  return v5;
}

uint64_t sub_219878554(unsigned int *a1)
{
  const char *v2;
  int v3;
  unsigned int *v4;
  unsigned int v5;
  uint64_t v6;

  sub_219850718(3, a1, 6u, 5u, (uint64_t)"phLibNfc_SpmiClientResetTimerStart");
  if (a1)
  {
    if (!phOsalNfc_Timer_Start())
    {
      sub_219850628(1, a1 + 2123, 4u, 4u, (uint64_t)"phLibNfc_SpmiClientResetTimerStart: Client reset Nack Timer Started");
      v6 = 13;
      goto LABEL_7;
    }
    v2 = "phLibNfc_SpmiClientResetTimerStart: Client reset Nack Timer Start failed";
    v3 = 1;
    v4 = a1 + 2123;
    v5 = 4;
  }
  else
  {
    v2 = "phLibNfc_SpmiClientResetTimerStart: Invalid Download core context";
    v3 = 3;
    v4 = 0;
    v5 = 6;
  }
  sub_219850628(v3, v4, v5, 1u, (uint64_t)v2);
  v6 = 255;
LABEL_7:
  sub_219850808(3, a1, 6u, 5u, (uint64_t)"phLibNfc_SpmiClientResetTimerStart");
  return v6;
}

uint64_t sub_219878634(uint64_t a1, unsigned int *a2, _BYTE *a3)
{
  unsigned int v6;
  unsigned int v7;
  uint64_t v8;
  unsigned __int8 *v9;
  uint64_t v10;
  int v11;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateLogConnInfo");
  v6 = *a2;
  if (*a2 > 3)
    goto LABEL_14;
  if (*((_BYTE *)a2 + 4) == 1)
  {
    if (*((unsigned __int8 *)a2 + 5) <= 1u)
    {
      if (v6 != 1 && *((_BYTE *)a2 + 6) != 2)
        goto LABEL_14;
      goto LABEL_10;
    }
  }
  else if (*((_BYTE *)a2 + 4))
  {
    goto LABEL_14;
  }
  if (v6 != 1)
  {
LABEL_14:
    v8 = 1;
    goto LABEL_15;
  }
LABEL_10:
  v7 = *(unsigned __int8 *)(a1 + 3777);
  v8 = 1;
  sub_219851888(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Currently number of Open Connections are..");
  if (v7 <= *(unsigned __int8 *)(a1 + 13))
  {
    v9 = (unsigned __int8 *)(a1 + 3840);
    v10 = 1;
    while (1)
    {
      v11 = *v9;
      v9 += 32;
      if (!v11)
        break;
      if (++v10 == 4)
        goto LABEL_14;
    }
    v8 = 0;
    *a3 = v10;
  }
LABEL_15:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ValidateLogConnInfo");
  return v8;
}

uint64_t sub_21987874C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  int v8;
  _BYTE *Memory;
  char v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v14;
  unsigned int v15;
  char v16;
  unsigned __int8 v17;
  uint64_t v18;
  unsigned __int8 v19;

  v19 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnCreate");
  if (!a1 || !a2 || !a3)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)" Invalid Context Param..");
    goto LABEL_12;
  }
  if (sub_219878634(a1, (unsigned int *)a2, &v19))
  {
LABEL_12:
    v12 = 1;
    goto LABEL_13;
  }
  if (*(_DWORD *)a2 == 1)
    v8 = 2;
  else
    v8 = 6;
  Memory = (_BYTE *)phOsalNfc_GetMemory();
  if (Memory)
  {
    *Memory = *(_DWORD *)a2;
    if (*(_DWORD *)a2 == 1)
    {
      v10 = 0;
      v11 = 1;
    }
    else
    {
      Memory[1] = *(_BYTE *)(a2 + 4);
      Memory[2] = *(_BYTE *)(a2 + 5);
      Memory[3] = *(_BYTE *)(a2 + 6);
      Memory[4] = *(_BYTE *)(a2 + 7);
      v10 = *(_BYTE *)(a2 + 8);
      v11 = 5;
    }
    Memory[v11] = v10;
    *(_QWORD *)(a1 + 3920) = a3;
    *(_QWORD *)(a1 + 3912) = a4;
    *(_QWORD *)(a1 + 848) = Memory;
    *(_DWORD *)(a1 + 856) = v8;
    *(_QWORD *)(a1 + 3736) = off_2550A2F78;
    *(_BYTE *)(a1 + 3936) = 0;
    *(_BYTE *)(a1 + 3937) = sub_21987CDC4((unsigned int *)a1, off_2550A2F78);
    v14 = sub_219878950(a1, 0, 0);
    if ((_DWORD)v14 == 13)
    {
      v15 = *(_DWORD *)a2;
      if (*(_DWORD *)a2 == 1)
        v16 = -2;
      else
        v16 = *(_BYTE *)(a2 + 7);
      v17 = v19;
      v18 = a1 + 32 * v19;
      *(_BYTE *)(v18 + 3784) = v16;
      *(_DWORD *)(v18 + 3788) = v15;
      *(_BYTE *)(v18 + 3808) = 0;
      *(_BYTE *)(a1 + 3778) = v17;
      v12 = 13;
    }
    else
    {
      v12 = v14;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Logical connection Sequence failed!");
      sub_2198FBBC4(a1);
    }
  }
  else
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Failed to open logical connection..");
    v12 = 255;
  }
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnCreate");
  return v12;
}

uint64_t sub_219878950(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnSequence");
  if (a1 && a2)
  {
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnSequence");
  return v6;
}

uint64_t sub_2198789E0(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8;
  char v10;

  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnClose");
  if (a1 && a3)
  {
    if (sub_2198C8378(a1, a2, &v10))
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Notification ConnClose Request successful..");
      v8 = 0;
    }
    else
    {
      *(_BYTE *)(a1 + 3778) = v10;
      *(_QWORD *)(a1 + 3736) = off_2550A2F98;
      *(_BYTE *)(a1 + 3936) = 0;
      *(_BYTE *)(a1 + 3937) = sub_21987CDC4((unsigned int *)a1, off_2550A2F98);
      v8 = sub_219878950(a1, 0, 0);
      if ((_DWORD)v8 == 13)
      {
        *(_QWORD *)(a1 + 3920) = a3;
        *(_QWORD *)(a1 + 3912) = a4;
      }
    }
  }
  else
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v8 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnClose");
  return v8;
}

uint64_t sub_219878B08(uint64_t a1, int a2, int a3, uint64_t a4)
{
  uint64_t v8;
  uint64_t v9;
  const char *v10;
  int v11;
  unsigned int *v12;
  _BYTE *v13;
  unsigned __int8 v15;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnUpdateDestInfo");
  if (!a1 || !a4)
  {
    v10 = " Invalid Params supplied!!";
    v8 = 1;
    v11 = 2;
    v12 = (unsigned int *)a1;
    goto LABEL_17;
  }
  if ((a2 & 0xFFFFFFFD) != 1)
  {
    if (a2 == 2)
    {
      if (sub_2198C82D4((unsigned int *)a1))
      {
        v13 = *(_BYTE **)(a1 + 4512);
        if (v13)
        {
          v8 = 0;
          *(_BYTE *)(a1 + 3784) = v13[8];
          *(_DWORD *)(a1 + 3788) = 2;
          *(_BYTE *)(a1 + 3794) = v13[24];
          *(_BYTE *)(a1 + 3793) = v13[25];
          *(_BYTE *)(a1 + 3808) = 1;
          *(_QWORD *)(a1 + 3800) = v13;
          goto LABEL_18;
        }
        v12 = (unsigned int *)(a1 + 6476);
        v10 = " Cannot Extract Rf Device Handle!!";
      }
      else
      {
        v12 = (unsigned int *)(a1 + 6476);
        v10 = "Cannot extract LogConnMgmtInt Context!!";
      }
    }
    else
    {
      v12 = (unsigned int *)(a1 + 6476);
      v10 = " Unsupported Destination Type!!";
    }
    v8 = 1;
    v11 = 1;
LABEL_17:
    sub_219850628(v11, v12, 3u, 1u, (uint64_t)v10);
    goto LABEL_18;
  }
  v15 = 0;
  v8 = sub_2198C8378(a1, a3, &v15);
  if ((_DWORD)v8 != 255)
  {
    v9 = a1 + 32 * v15;
    if (*(unsigned __int8 *)(v9 + 3792) == 255)
      v8 = 255;
    else
      *(_QWORD *)(v9 + 3800) = a4;
  }
LABEL_18:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnUpdateDestInfo");
  return v8;
}

uint64_t sub_219878C88(unsigned int *a1, uint64_t a2, _BYTE *a3)
{
  char v6;
  uint64_t v7;
  unsigned int *v8;
  uint64_t v9;
  uint64_t v10;
  unsigned int *v11;
  const char *v12;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnGetConnId");
  *a3 = -1;
  if (!a1)
    goto LABEL_11;
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v7 + 4);
    if ((v6 & 1) != 0)
      break;
    v6 = 1;
    v7 = 1;
  }
  while (v8 != a1);
  if (a2 && v8 == a1)
  {
    v9 = 0;
    while (*(_QWORD *)&a1[v9 + 950] != a2)
    {
      v9 += 8;
      if (v9 == 32)
        goto LABEL_16;
    }
    if (LOBYTE(a1[v9 + 952]) == 1)
    {
      *a3 = a1[v9 + 948];
      v11 = a1 + 1619;
      v12 = " ConnId Found!!";
    }
    else
    {
      v11 = a1 + 1619;
      v12 = " Interface not active for this connection";
    }
    sub_219850628(1, v11, 3u, 4u, (uint64_t)v12);
LABEL_16:
    v10 = 0;
  }
  else
  {
LABEL_11:
    sub_219850628(2, a1, 3u, 4u, (uint64_t)" Invalid Params..");
    v10 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnGetConnId");
  return v10;
}

uint64_t sub_219878DD0(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  unsigned int *v5;
  uint64_t v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateClosedLogConnInfo");
  if (a1 && a2)
  {
    v4 = 0;
    while (1)
    {
      v5 = &a1[v4];
      if (*(_QWORD *)&a1[v4 + 950] == a2)
        break;
      v4 += 8;
      if (v4 == 32)
      {
        v6 = 255;
        goto LABEL_10;
      }
    }
    v6 = 0;
    if (*((_BYTE *)v5 + 3808) == 1)
      *((_BYTE *)v5 + 3808) = 0;
  }
  else
  {
    v6 = 1;
    sub_219850628(2, a1, 3u, 1u, (uint64_t)"Invalid input Params");
  }
LABEL_10:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateClosedLogConnInfo");
  return v6;
}

uint64_t sub_219878E9C(unsigned int *a1, uint64_t a2, _BYTE *a3)
{
  uint64_t v6;
  uint64_t v7;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnGetCredits");
  if (a1 && a2)
  {
    v6 = 0;
    while (*(_QWORD *)&a1[v6 + 950] != a2)
    {
      v6 += 8;
      if (v6 == 32)
        goto LABEL_11;
    }
    if (LOBYTE(a1[v6 + 952]) == 1)
    {
      *a3 = BYTE1(a1[v6 + 948]);
      sub_219850628(1, a1 + 1619, 3u, 4u, (uint64_t)" ConnCredit Info Found!!");
      v7 = 0;
      goto LABEL_12;
    }
    sub_219850628(1, a1 + 1619, 3u, 1u, (uint64_t)" Interface not active for this connection");
LABEL_11:
    v7 = 255;
  }
  else
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)" Invalid Params..");
    v7 = 1;
  }
LABEL_12:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnGetCredits");
  return v7;
}

uint64_t sub_219878FB8(unsigned int *a1, uint64_t a2, _BYTE *a3)
{
  uint64_t v6;
  uint64_t v7;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnGetMaxPld");
  if (a1 && a2)
  {
    v6 = 0;
    while (*(_QWORD *)&a1[v6 + 950] != a2)
    {
      v6 += 8;
      if (v6 == 32)
        goto LABEL_11;
    }
    if (LOBYTE(a1[v6 + 952]) == 1)
    {
      *a3 = BYTE2(a1[v6 + 948]);
      sub_219850628(1, a1 + 1619, 3u, 4u, (uint64_t)" Conn MaxDataPldSz Found!!");
      v7 = 0;
      goto LABEL_12;
    }
    sub_219850628(1, a1 + 1619, 3u, 4u, (uint64_t)" Interface not active for this connection");
LABEL_11:
    v7 = 255;
  }
  else
  {
    v7 = 1;
    sub_219850628(2, a1, 3u, 1u, (uint64_t)" Invalid Params..");
  }
LABEL_12:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnGetMaxPld");
  return v7;
}

uint64_t sub_2198790D4(unsigned int *a1, int a2, _BYTE *a3)
{
  uint64_t v6;
  uint64_t v7;
  unsigned int *v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetConnCredits");
  if (a1 && a3)
  {
    v6 = 0;
    while (LOBYTE(a1[v6 + 948]) != a2 || !*(_QWORD *)&a1[v6 + 950])
    {
      v6 += 8;
      if (v6 == 32)
        goto LABEL_12;
    }
    v8 = &a1[v6];
    if (a2 && *((_BYTE *)v8 + 3808) != 1)
    {
      sub_219850628(1, a1 + 1619, 3u, 1u, (uint64_t)"Interface not active for this connection");
LABEL_12:
      v7 = 255;
      goto LABEL_13;
    }
    *a3 = *((_BYTE *)v8 + 3793);
    sub_219850628(1, a1 + 1619, 3u, 4u, (uint64_t)" ConnCredit Info Found!!");
    v7 = 0;
  }
  else
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)" Invalid Params..");
    v7 = 1;
  }
LABEL_13:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetConnCredits");
  return v7;
}

uint64_t sub_2198791FC(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  unsigned int *v8;
  unsigned int *v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  BOOL v13;
  int *v14;
  uint64_t v15;
  uint64_t v16;
  int *v17;
  int *v18;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RegForConnCredits");
  v8 = sub_2198C82D4((unsigned int *)a1);
  if (a3 && a1 && (v9 = v8) != 0)
  {
    v10 = 0;
    while (*(unsigned __int8 *)(a1 + v10 + 3792) != a2)
    {
      v10 += 32;
      if (v10 == 128)
        goto LABEL_12;
    }
    if (a2 && *(_BYTE *)(a1 + v10 + 3808) != 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)" Interface not active for this connection");
LABEL_32:
      v11 = 255;
      goto LABEL_33;
    }
LABEL_12:
    *((_BYTE *)v8 + 9) = a2;
    *((_QWORD *)v8 + 4) = a3;
    *((_QWORD *)v8 + 5) = a4;
    v12 = *((_QWORD *)v8 + 7);
    if (v12)
      v13 = v12 == 0xFFFFFFFFFFFFLL;
    else
      v13 = 1;
    if (!v13)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Stopping Credit await timer..");
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_BYTE *)(a1 + 6465) = 0;
      *((_BYTE *)v9 + 64) = 0;
      *((_QWORD *)v9 + 7) = 0;
      v14 = &dword_253E47158;
      if (!*(_DWORD *)(a1 + 6476))
        v14 = &dword_253E47070;
      v14[1] &= ~8u;
    }
    if (*(_BYTE *)(a1 + 3929) == 1)
    {
      v11 = 0;
      goto LABEL_33;
    }
    v15 = phOsalNfc_Timer_Create();
    if (v15 == 0xFFFFFFFFFFFFLL || (v16 = v15) == 0)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Credit wait Timer Create failed!!");
      v11 = 12;
      goto LABEL_33;
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Credit wait Timer Created Successfully");
    *((_QWORD *)v9 + 7) = v16;
    *((_BYTE *)v9 + 64) = 0;
    if (*(_BYTE *)(a1 + 1880) == 1)
    {
      phOsalNfc_Timer_Stop();
      *(_BYTE *)(a1 + 6464) = 0;
      *(_BYTE *)(a1 + 1880) = 0;
      v17 = &dword_253E47158;
      if (!*(_DWORD *)(a1 + 3356))
        v17 = &dword_253E47070;
      v17[1] &= ~0x10u;
    }
    sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Credit timeout set to");
    sub_21988C4AC(*(_DWORD *)(a1 + 3356), *((_QWORD *)v9 + 7));
    *(_BYTE *)(a1 + 6465) = 0;
    v18 = &dword_253E47158;
    if (!*(_DWORD *)(a1 + 3356))
      v18 = &dword_253E47070;
    v18[1] &= ~8u;
    if (phOsalNfc_Timer_Start())
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed to start credit ntf wait timer!");
      phOsalNfc_Timer_Delete();
      *((_QWORD *)v9 + 7) = 0;
      goto LABEL_32;
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Credit wait timer started..");
    v11 = 0;
    *((_BYTE *)v9 + 64) = 1;
    *((_BYTE *)v9 + 49) = 1;
  }
  else
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)" Invalid Caller Layer Param(s) received ..");
    v11 = 1;
  }
LABEL_33:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RegForConnCredits");
  return v11;
}

uint64_t sub_219879600(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  unsigned int *v5;
  _BYTE *v6;
  int *v7;
  uint64_t v8;
  void (*v9)(uint64_t, uint64_t, uint64_t);
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  unsigned __int8 v14;

  v14 = 0;
  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_WaitCreditTimerCb");
  v4 = sub_2198C82D4((unsigned int *)a2);
  if (a2)
  {
    v5 = v4;
    if (v4)
    {
      v6 = (_BYTE *)(a2 + 6232);
      if (!*(_BYTE *)(a2 + 6465))
      {
        phOsalNfc_Timer_Stop();
        if (!phOsalNfc_Timer_Start())
        {
          sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"Credit wait timer started with extended time..");
          *(_BYTE *)(a2 + 6465) = 1;
          return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_WaitCreditTimerCb");
        }
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 1u, (uint64_t)"Failed to start credit ntf wait timer with extended time!");
      }
      *(_BYTE *)(a2 + 6465) = 0;
      if (*((_QWORD *)v5 + 7) == a1)
      {
        *((_BYTE *)v5 + 64) = 0;
        if (a1 && a1 != 0xFFFFFFFFFFFFLL)
        {
          phOsalNfc_Timer_Stop();
          phOsalNfc_Timer_Delete();
          *((_QWORD *)v5 + 7) = 0;
        }
        v7 = &dword_253E47158;
        if (!*(_DWORD *)(a2 + 6476))
          v7 = &dword_253E47070;
        v7[1] |= 8u;
      }
      if (*((_BYTE *)v5 + 49) == 1)
        *((_BYTE *)v5 + 49) = 0;
      v9 = (void (*)(uint64_t, uint64_t, uint64_t))*((_QWORD *)v5 + 4);
      v8 = *((_QWORD *)v5 + 5);
      *((_BYTE *)v5 + 9) = -1;
      *((_QWORD *)v5 + 4) = 0;
      *((_QWORD *)v5 + 5) = 0;
      if (sub_2198790D4((unsigned int *)a2, *v6, &v14) || !v14)
      {
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 1u, (uint64_t)"phNciNfc_WaitCreditTimerCb - NFCSTATUS_RF_TIMEOUT");
        if (*(_BYTE *)(a2 + 1880) == 1)
        {
          phOsalNfc_Timer_Stop();
          *(_BYTE *)(a2 + 6464) = 0;
          *(_BYTE *)(a2 + 1880) = 0;
        }
        sub_219879C68(a2, 0);
        if (*v6 == 3)
          *(_WORD *)(a2 + 6610) = 36;
        v11 = v8;
        v10 = 0;
        v12 = 9;
      }
      else
      {
        sub_219851888(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"phNciNfc_WaitCreditTimerCb - Credits-");
        v10 = v14;
        v11 = v8;
        v12 = 0;
      }
      v9(v11, v10, v12);
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_WaitCreditTimerCb");
}

uint64_t sub_219879850(uint64_t a1, int a2, _BYTE *a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  unsigned int v10;
  unsigned __int8 v11;
  int v12;
  char v13;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetConnMaxPldSz");
  if (!a1 || !a3)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)" Invalid Params..");
    v8 = 1;
    goto LABEL_29;
  }
  v6 = 0;
  while (1)
  {
    v7 = a1 + v6;
    if (*(unsigned __int8 *)(a1 + v6 + 3792) == a2)
      break;
    v6 += 32;
    if (v6 == 128)
      goto LABEL_11;
  }
  if (!a2 || *(_BYTE *)(v7 + 3808) == 1)
  {
    *a3 = *(_BYTE *)(a1 + v6 + 3794);
    if (*(_BYTE *)(v7 + 3792)
      || *(_BYTE *)(a1 + 4737)
      || (v9 = sub_2198DB71C(*(_QWORD *)(a1 + 6480)), (v10 = *(_DWORD *)(a1 + 72)) == 0))
    {
LABEL_28:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Conn MaxDataPldSz Found!!");
      v8 = 0;
      goto LABEL_29;
    }
    v11 = 0;
    while (1)
    {
      if (v9 == *(_QWORD *)(a1 + 8 * v11 + 80))
      {
        v12 = *(_DWORD *)(v9 + 4);
        if (v12 == 16)
        {
          v13 = *(_BYTE *)(v9 + 145);
          if (!v13)
            goto LABEL_27;
        }
        else
        {
          if ((v12 - 5) >= 3 && *(_DWORD *)(*(_QWORD *)(a1 + 80) + 4) != 3)
            goto LABEL_27;
          v13 = *(_BYTE *)(v9 + 106);
          if (!v13)
            goto LABEL_27;
        }
        *a3 = v13;
        v10 = *(_DWORD *)(a1 + 72);
      }
LABEL_27:
      if (v10 <= ++v11)
        goto LABEL_28;
    }
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Interface not active for this connection");
LABEL_11:
  v8 = 255;
LABEL_29:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetConnMaxPldSz");
  return v8;
}

uint64_t sub_2198799F4(unsigned int *a1, int a2, char a3)
{
  uint64_t v6;
  uint64_t v7;
  unsigned int *v8;
  char v9;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_IncrConnCredits");
  if (a1)
  {
    v6 = 0;
    while (LOBYTE(a1[v6 + 948]) != a2)
    {
      v6 += 8;
      if (v6 == 32)
        goto LABEL_10;
    }
    if (a2 && LOBYTE(a1[v6 + 952]) != 1)
    {
      sub_219850628(1, a1 + 1619, 3u, 1u, (uint64_t)" Interface not active for this connection");
LABEL_10:
      v7 = 255;
      goto LABEL_14;
    }
    v8 = &a1[v6];
    v9 = *((_BYTE *)v8 + 3793) + a3;
    *((_BYTE *)v8 + 3793) = v9;
    if (v9 == -1)
    {
      *((_BYTE *)v8 + 3793) = -2;
      sub_219850628(1, a1 + 1619, 3u, 2u, (uint64_t)" Credit Limit xceeded for this Conn,Rounding to max value ..");
    }
    v7 = 0;
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Params..");
    v7 = 1;
  }
LABEL_14:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_IncrConnCredits");
  return v7;
}

uint64_t sub_219879B28(unsigned int *a1, int a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_DecrConnCredit");
  if (a1)
  {
    v4 = 0;
    while (LOBYTE(a1[v4 + 948]) != a2)
    {
      v4 += 8;
      if (v4 == 32)
        goto LABEL_13;
    }
    if (!a2 || LOBYTE(a1[v4 + 952]) == 1)
    {
      sub_219850628(1, a1 + 1619, 3u, 4u, (uint64_t)" ConnCredit Info Found!!");
      if (BYTE1(a1[v4 + 948]))
      {
        v5 = 0;
        --BYTE1(a1[v4 + 948]);
        goto LABEL_14;
      }
      sub_219850628(1, a1 + 1619, 3u, 2u, (uint64_t)"No Credits available for this connId!!");
    }
    else
    {
      sub_219850628(1, a1 + 1619, 3u, 1u, (uint64_t)" Interface not active for this connection");
    }
LABEL_13:
    v5 = 255;
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Param..");
    v5 = 1;
  }
LABEL_14:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_DecrConnCredit");
  return v5;
}

uint64_t sub_219879C68(uint64_t a1, uint64_t a2)
{
  int v4;
  uint64_t v5;
  int *v6;
  int v8;
  int v9;
  __int16 v10;

  v10 = 0;
  v8 = 8;
  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSpmiRegInfo");
  if (a1)
  {
    sub_21988ED38(*(_QWORD *)(a1 + 6480), &v8);
    if (v8 == 6 && !sub_2198AFF40(*(_QWORD *)(a1 + 6480)))
    {
      v4 = phTmlNfc_SpmiDrvErrorStatus();
      sub_2198B00C4(*(_QWORD *)(a1 + 6480), 20);
      if (v4)
      {
        v5 = a1;
        v6 = 0;
      }
      else
      {
        v6 = &v9;
        v5 = a1;
      }
      sub_21985D858(v5, (uint64_t)v6, a2);
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessSpmiRegInfo");
}

uint64_t sub_219879D44(uint64_t a1, uint64_t a2)
{
  int v4;
  uint64_t *v5;
  uint64_t v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateDevHandle");
  if (!a1)
  {
    v6 = 255;
    goto LABEL_10;
  }
  v4 = sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1464));
  v5 = (uint64_t *)(a1 + 1456);
  if (v4)
  {
    *v5 = 0;
    *(_QWORD *)(a1 + 1464) = 0;
LABEL_4:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Target not connected");
    v6 = 148;
    goto LABEL_10;
  }
  v7 = *v5;
  if (!v7)
    goto LABEL_4;
  if (v7 == a2)
    v6 = 0;
  else
    v6 = 255;
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateDevHandle");
  return v6;
}

uint64_t sub_219879E00(uint64_t a1, int a2)
{
  void (*v4)(_QWORD, uint64_t, uint64_t, _QWORD);
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessTmlError");
  if (a1)
  {
    if (a2 == 15)
    {
      v4 = *(void (**)(_QWORD, uint64_t, uint64_t, _QWORD))(a1 + 6568);
      if (v4)
      {
        v5 = *(_QWORD *)(a1 + 6576);
        sub_219853E34(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"ProcessTmlError :pGenericNtfCb[COMM ERR]");
        v4(*(_QWORD *)(a1 + 19360), v5, 15, 0);
      }
    }
    else if (a2 == 36)
    {
      sub_2198FF794(*(_QWORD *)(a1 + 3040));
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessTmlError");
}

uint64_t sub_219879EBC(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CreateLogConnCmd");
  if (a1)
  {
    v2 = sub_2198FEC84(*(_QWORD *)(a1 + 3040), (uint64_t)sub_2198655FC, a1);
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Invalid parameter, Libnfc Context is Invalid");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CreateLogConnCmd");
  return v2;
}

uint64_t sub_219879F54(uint64_t a1, uint64_t a2, uint64_t a3)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CreateLogConnCb");
  if (a1 && !(_DWORD)a2 && a3)
  {
    *(_BYTE *)(a1 + 19336) = 1;
    *(_QWORD *)(a1 + 19344) = a3;
  }
  else
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"ConfigTestMode: Failed");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CreateLogConnCb");
  return a2;
}

uint64_t sub_219879FF8(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CloseLogConnCmd");
  if (a1)
  {
    v2 = sub_2198FF008(*(_QWORD *)(a1 + 3040), (uint64_t)sub_2198655FC, a1);
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Invalid parameter, Libnfc Context is Invalid");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CloseLogConnCmd");
  return v2;
}

uint64_t sub_21987A090(uint64_t a1, int a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_LogConnCloseCb");
  v4 = 255;
  if (a1 && !a2)
  {
    v4 = 0;
    *(_BYTE *)(a1 + 19336) = 0;
    *(_QWORD *)(a1 + 19344) = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_LogConnCloseCb");
  return v4;
}

uint64_t sub_21987A110(unsigned int *a1, int a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyRoutedProto");
  v4 = 0;
  if ((a2 - 1) >= 6
    && ((a2 - 128) > 0x20 || ((1 << (a2 + 0x80)) & 0x100000407) == 0))
  {
    v4 = 1;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyRoutedProto");
  return v4;
}

BOOL sub_21987A1B8(unsigned int *a1, unsigned int a2)
{
  _BOOL8 v4;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyRoutedTech");
  v4 = a2 >= 4 && a2 - 128 >= 3;
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyRoutedTech");
  return v4;
}

uint64_t sub_21987A22C(unsigned int *a1, int a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyRoutedNFCEE");
  v4 = 0;
  if (a2 > 128)
  {
    if (a2 != 129 && a2 != 192)
      goto LABEL_7;
  }
  else if (a2 && a2 != 2)
  {
LABEL_7:
    v4 = 1;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyRoutedNFCEE");
  return v4;
}

uint64_t sub_21987A2C0(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  unint64_t v5;
  uint64_t v6;
  int v7;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyRxdRoutingTable");
  if (a2)
  {
    v4 = 0;
    v5 = 0;
    while (1)
    {
      v6 = *(_QWORD *)(a2 + 8);
      v7 = *(_DWORD *)(v6 + v4);
      if (v7 == 2)
      {
        if (*(unsigned __int8 *)(v6 + v4 + 28) - 17 < 0xFFFFFFF4)
          goto LABEL_14;
      }
      else
      {
        if (v7 == 1)
        {
          if (sub_21987A110(a1, *(_DWORD *)(v6 + v4 + 12)))
            goto LABEL_14;
        }
        else if (v7 || sub_21987A1B8(a1, *(_DWORD *)(v6 + v4 + 12)))
        {
LABEL_14:
          a2 = 1;
          break;
        }
        if (sub_21987A22C(a1, *(unsigned __int8 *)(*(_QWORD *)(a2 + 8) + v4 + 4)))
          goto LABEL_14;
      }
      ++v5;
      v4 += 32;
      if (v5 >= *(unsigned __int8 *)a2)
      {
        a2 = 0;
        break;
      }
    }
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyRxdRoutingTable");
  return a2;
}

uint64_t sub_21987A3C8(uint64_t a1, uint64_t a2)
{
  uint64_t v4;

  v4 = a1;
  sub_219850718(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_PrintgDebugInfo");
  if (a2)
  {
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bHciRspTimer:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bSE2Status:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bLibSeqNxt:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bLibSeqId:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bLibTransFlag:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bLibCurrState:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bLibTarState:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciRxdNtf:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciSendCbStatus:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciUnknownPkt:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciReTransLimit:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciCreditTimer:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciRspTimer:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciCmd:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciSeqNxt:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciSeqId:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bUICCStatus:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"beSEStatus:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bLibRetryLimit:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bLibWDTimer:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bHciRetryLimit:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciPendRet:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciSynErrRxd:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bNciIntErrRxd:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"bHciRxdErr:");
    sub_219851888(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"beSERemovedNtf:");
  }
  return sub_219850808(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_PrintgDebugInfo");
}

uint64_t sub_21987A7D4(uint64_t a1)
{
  uint64_t v2;
  char v3;
  char v4;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrintLibNfcCritInfo");
  if (a1)
  {
    v2 = 0;
    v3 = 1;
    do
    {
      v4 = v3;
      if (*((_QWORD *)&unk_253E46700 + 14 * v2) == *(_QWORD *)(a1 + 19360))
        break;
      v3 = 0;
      v2 = 1;
    }
    while ((v4 & 1) != 0);
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:CurrState=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:TrgtState=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:Flag=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:TrigEvent=");
    if (*(_QWORD *)(a1 + 512))
    {
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:pActiveSeInfo->eSE_Type=");
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:pActiveSeInfo->eSE_ActivationMode=");
    }
    if (*(_QWORD *)(a1 + 2912))
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:SeqNext=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:aConnectionStatus[phLibNfc_SE_Index_eSE]=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:aConnectionStatus[phLibNfc_SE_Index_UICC]=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:aConnectionStatus[phLibNfc_SE_Index_HciNwk]=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:tSeList[phLibNfc_SE_Index_eSE].eSE_ActivationMode=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:tSeList[phLibNfc_SE_Index_eSE].eSE_Type=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:tSeList[phLibNfc_SE_Index_UICC].eSE_ActivationMode=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:tSeList[phLibNfc_SE_Index_UICC].eSE_Type=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:tSeList[phLibNfc_SE_Index_HciNwk].eSE_ActivationMode=");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc:tSeList[phLibNfc_SE_Index_HciNwk].eSE_Type=");
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Invalid Libnfc Context!!!");
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrintLibNfcCritInfo");
}

uint64_t sub_21987AB04(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  uint64_t v5;
  uint64_t v6;

  v5 = 0;
  v6 = a1;
  sub_219850718(0, (unsigned int *)&v6, 4u, 5u, (uint64_t)"phLibNfc_ValidateLibNfcState");
  if (a2)
  {
    sub_21988EDF4(v6, &v5);
    if (v5)
    {
      v3 = 0;
      *a2 = v5;
    }
    else
    {
      v3 = 49;
    }
  }
  else
  {
    v3 = 255;
  }
  sub_219850808(0, (unsigned int *)&v6, 4u, 5u, (uint64_t)"phLibNfc_ValidateLibNfcState");
  return v3;
}

uint64_t sub_21987AB98(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IsShutDownInProgress");
  if (a1)
  {
    v2 = 255;
    if (sub_2198D23DC(*(_QWORD *)(a1 + 2952)) == 11)
    {
      if (sub_2198D2574(*(_QWORD *)(a1 + 2952)) == 1)
        v2 = 0;
      else
        v2 = 255;
    }
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IsShutDownInProgress");
  return v2;
}

uint64_t sub_21987AC20(unsigned int *a1, uint64_t a2)
{
  int v4;
  uint64_t v5;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ChkTagType_Tpz_Mfc");
  if (!a2)
    goto LABEL_7;
  v4 = *(_DWORD *)(a2 + 4);
  if (v4 == 22)
  {
    v5 = 0;
    goto LABEL_9;
  }
  if (v4 == 16)
  {
    if (*(_BYTE *)(a2 + 68))
      v5 = 0;
    else
      v5 = 255;
  }
  else
  {
LABEL_7:
    v5 = 255;
  }
LABEL_9:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ChkTagType_Tpz_Mfc");
  return v5;
}

uint64_t sub_21987ACB4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _BYTE *v6;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ParseWdgDumpInfo");
  if (a1 && a2 && a3)
  {
    phOsalNfc_SetMemory();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    if (*(_BYTE *)(a1 + 2937) == 1 || *(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2944) == 1)
    {
      phOsalNfc_MemCopy();
      phOsalNfc_MemCopy();
      phOsalNfc_MemCopy();
      phOsalNfc_MemCopy();
      v6 = (_BYTE *)(a1 + 2938);
      if (*(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2944) == 1)
      {
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
      }
    }
    else
    {
      v6 = (_BYTE *)(a1 + 2938);
    }
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwRfProcessPc");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwRfProcessSp");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwRfProcessWaitObject");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwRfProcessState");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwSwpProcessPc");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwSwpProcessSp");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwSwpProcessWaitObject");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwSwpProcessState");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwKernelProcessPc");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwKernelProcessSp");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwKernelProcessWaitObject");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwKernelProcessState");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwHostProcessPc");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwHostProcessSp");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwHostProcessWaitObject");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwHostProcessState");
    if (*(_BYTE *)(a1 + 2937) == 1 || *v6 == 1 || *(_BYTE *)(a1 + 2944) == 1)
    {
      sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwMailBoxProcessPc");
      sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwMailBoxProcessSp");
      sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwMailBoxProcessWaitObject");
      sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwMailBoxProcessState");
      if (*v6 == 1 || *(_BYTE *)(a1 + 2944) == 1)
      {
        sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwHostLowPowerProcessPc");
        sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwHostLowPowerProcessSp");
        sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwHostLowPowerProcessWaitObject");
        sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgDumpInfo: dwHostLowPowerProcessState");
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ParseWdgDumpInfo");
}

uint64_t sub_21987B2A8(unsigned int a1, uint64_t a2, uint64_t a3)
{
  unsigned int v6;

  v6 = a1;
  sub_219850718(1, &v6, 4u, 5u, (uint64_t)"phLibNfc_ParseHrdFltDumpInfo");
  if (a2 && a3)
  {
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwR0");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwR1");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwR2");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwR3");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwR12");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwLR");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwPC");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwXPsr");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwhfLr");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwPsp");
    sub_219851888(1, &v6, 4u, 1u, (uint64_t)"HrdFltDumpInfo: dwMsp");
  }
  return sub_219850808(1, &v6, 4u, 5u, (uint64_t)"phLibNfc_ParseHrdFltDumpInfo");
}

uint64_t sub_21987B550(uint64_t a1, uint64_t a2, uint64_t a3)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ParseWdgTickInfo");
  if (a1 && a2 && a3)
  {
    if (*(_BYTE *)(a1 + 2946) != 1)
    {
      phOsalNfc_MemCopy();
      phOsalNfc_MemCopy();
    }
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    if (*(_BYTE *)(a1 + 2937) == 1 || *(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2944) == 1)
    {
      phOsalNfc_MemCopy();
      if (*(_BYTE *)(a1 + 2938) == 1)
        phOsalNfc_MemCopy();
    }
    phOsalNfc_MemCopy();
    if (*(_BYTE *)(a1 + 2946) != 1)
    {
      sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgTickInfo: dwWatchdog_Process_Rf");
      sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgTickInfo: dwWatchdog_Process_Swp");
    }
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgTickInfo: dwWatchdog_Process_Kernel");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgTickInfo: dwWatchdog_Process_Host");
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgTickInfo: dwCurrentSysTick");
    if (*(_BYTE *)(a1 + 2937) == 1 || *(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2944) == 1)
    {
      sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgTickInfo: dwWatchdog_Process_MailBox");
      if (*(_BYTE *)(a1 + 2938) == 1)
        sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"WdgTickInfo: dwWatchdog_Process_HostLowPwr");
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ParseWdgTickInfo");
}

uint64_t sub_21987B7E4(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateNciHandle");
  v4 = 255;
  if (a1 && a2)
  {
    v5 = 0;
    while (*(_QWORD *)&a1[v5 + 182] != a2)
    {
      v5 += 2;
      if (v5 == 20)
      {
        v4 = 255;
        goto LABEL_8;
      }
    }
    v4 = 0;
  }
LABEL_8:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateNciHandle");
  return v4;
}

uint64_t sub_21987B880(unsigned int *a1, int a2, int *a3)
{
  int v6;
  uint64_t v7;
  int v8;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemDevType");
  if (a3)
  {
    v6 = a2 - 2;
    if ((a2 - 2) > 0x13)
    {
      v7 = 255;
      v8 = 28;
    }
    else
    {
      v7 = 0;
      v8 = dword_21990A510[v6];
    }
    *a3 = v8;
  }
  else
  {
    v7 = 1;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemDevType");
  return v7;
}

uint64_t sub_21987B920(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Clear_NdefInfo");
  if (a1)
  {
    v2 = *(_QWORD *)(a1 + 2704);
    if (v2)
    {
      if (*(_QWORD *)(v2 + 32))
      {
        phOsalNfc_FreeMemory();
        v2 = *(_QWORD *)(a1 + 2704);
        *(_QWORD *)(v2 + 32) = 0;
      }
      if (*(_QWORD *)(v2 + 48))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 2704) + 48) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2704) = 0;
    }
    v3 = *(_QWORD *)(a1 + 2696);
    if (v3)
    {
      if (*(_QWORD *)(v3 + 32))
      {
        phOsalNfc_FreeMemory();
        v3 = *(_QWORD *)(a1 + 2696);
        *(_QWORD *)(v3 + 32) = 0;
      }
      if (*(_QWORD *)(v3 + 48))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 2696) + 48) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2696) = 0;
    }
    if (*(_QWORD *)(a1 + 2616))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2616) = 0;
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Clear_NdefInfo");
}

uint64_t sub_21987BA3C(uint64_t a1)
{
  uint64_t v1;
  uint64_t v3;
  uint64_t v4;

  v3 = 0;
  v4 = a1;
  sub_219850718(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_Get_ConvertToReadWriteFlag");
  sub_21988EDF4(v4, &v3);
  if (v3)
    v1 = *(unsigned __int8 *)(v3 + 19372);
  else
    v1 = 0;
  sub_219850808(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_Get_ConvertToReadWriteFlag");
  return v1;
}

uint64_t sub_21987BAC0(uint64_t a1, uint64_t a2)
{
  _QWORD *v4;
  _QWORD *v6;
  void (*v7)(uint64_t, uint64_t, uint64_t);
  uint64_t v8;
  uint64_t v9;
  uint64_t *v10;
  uint64_t v11;
  _QWORD *v12;
  _QWORD *v13;

  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
  if (a1)
  {
    sub_21988EB80(*(_QWORD *)(a1 + 2952), &v13);
    if (*(_QWORD *)(a1 + 6056))
    {
      v4 = (_QWORD *)(a1 + 6056);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 3, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, uint64_t))(a1 + 6056))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6064), a2);
LABEL_6:
      *v4 = 0;
      v4[1] = 0;
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
    }
    if (*(_QWORD *)(a1 + 6664))
    {
      v4 = (_QWORD *)(a1 + 6664);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 51, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, uint64_t))(a1 + 6664))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6672), a2);
      goto LABEL_6;
    }
    if (*(_QWORD *)(a1 + 6072))
    {
      v6 = (_QWORD *)(a1 + 6072);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 35, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6072);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6080);
LABEL_10:
      v7(v8, v9, 255);
LABEL_11:
      *v6 = 0;
      v6[1] = 0;
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
    }
    if (*(_QWORD *)(a1 + 6104))
    {
      sub_2198EB8A8(a1, a2);
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
    }
    if (*(_QWORD *)(a1 + 6136))
    {
      v6 = (_QWORD *)(a1 + 6136);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 116, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6136);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6144);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6152))
    {
      v6 = (_QWORD *)(a1 + 6152);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 15, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6152))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6160), 0, 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6184))
    {
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 17, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6184))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6192), 0, 0, 255);
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
    }
    if (*(_QWORD *)(a1 + 6168))
    {
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 16, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6168))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6176), 0, 0, 255);
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
    }
    if (*(_QWORD *)(a1 + 6216))
    {
      v6 = (_QWORD *)(a1 + 6216);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 130, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6216))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6224), 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6248))
    {
      v6 = (_QWORD *)(a1 + 6248);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 114, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6248);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6256);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6264))
    {
      v6 = (_QWORD *)(a1 + 6264);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 23, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6264))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6272), 0, 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6280))
    {
      v6 = (_QWORD *)(a1 + 6280);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 17, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6280))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6288), 0, 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6360))
    {
      v6 = (_QWORD *)(a1 + 6360);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 24, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6360);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6368);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6376))
    {
      v6 = (_QWORD *)(a1 + 6376);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 25, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6376);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6384);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6392))
    {
      v6 = (_QWORD *)(a1 + 6392);
      *(_BYTE *)(a1 + 19372) = 0;
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 27, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6392);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6400);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6408))
    {
      v6 = (_QWORD *)(a1 + 6408);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 29, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6408))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6416), 0, 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6424))
    {
      v6 = (_QWORD *)(a1 + 6424);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 22, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, uint64_t))(a1 + 6424))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6432), 146);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6440))
    {
      v6 = (_QWORD *)(a1 + 6440);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 37, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6440);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6448);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6456))
    {
      v6 = (_QWORD *)(a1 + 6456);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 40, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6456);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6464);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6472))
    {
      v6 = (_QWORD *)(a1 + 6472);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 7, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(a1 + 6472))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6480), 255, 0);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6728))
    {
      v6 = (_QWORD *)(a1 + 6728);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 32, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6728);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6736);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6744))
    {
      v6 = (_QWORD *)(a1 + 6744);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 31, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6744);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6752);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6760))
    {
      v6 = (_QWORD *)(a1 + 6760);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 30, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6760))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6768), 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6536))
    {
      v6 = (_QWORD *)(a1 + 6536);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 126, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6536))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6544), 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6584))
    {
      v6 = (_QWORD *)(a1 + 6584);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 46, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6584);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6592);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6600))
    {
      v6 = (_QWORD *)(a1 + 6600);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 48, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6600);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6608);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6616))
    {
      v6 = (_QWORD *)(a1 + 6616);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 49, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6616);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6624);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6552))
    {
      v6 = (_QWORD *)(a1 + 6552);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 4, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6552);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6560);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6296))
    {
      v6 = (_QWORD *)(a1 + 6296);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 124, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t, uint64_t))(a1 + 6296))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6304), 0, 0, 255, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6312))
    {
      v6 = (_QWORD *)(a1 + 6312);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 125, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6312))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6320), 0, 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6344))
    {
      v6 = (_QWORD *)(a1 + 6344);
      sub_219853E34(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"InvokePendingCb :EvtWtxCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6344))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6352), 0, 0, 255);
      goto LABEL_11;
    }
    v6 = (_QWORD *)(a1 + 6040);
    if (*(_QWORD *)(a1 + 6040))
    {
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 47, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6040))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6048), 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6088))
    {
      v6 = (_QWORD *)(a1 + 6088);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 43, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6088);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6096);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6632))
    {
      v6 = (_QWORD *)(a1 + 6632);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 5, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6632);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6640);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6648))
    {
      v6 = (_QWORD *)(a1 + 6648);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 50, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6648);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6656);
      goto LABEL_10;
    }
    if (*(_QWORD *)(a1 + 6808))
    {
      v6 = (_QWORD *)(a1 + 6808);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 44, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6808))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6816), 0, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6680))
    {
      v6 = (_QWORD *)(a1 + 6680);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 134, (uint64_t)"phLibNfc_InvokePendingCb");
      v10 = *(uint64_t **)(a1 + 512);
      if (v10)
        v11 = *v10;
      else
        v11 = 0;
      (*(void (**)(_QWORD, _QWORD, uint64_t, uint64_t, uint64_t))(a1 + 6680))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6688), v11, 127, 255);
      goto LABEL_11;
    }
    if (*(_QWORD *)(a1 + 6776))
    {
      v6 = (_QWORD *)(a1 + 6776);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 131, (uint64_t)"phLibNfc_InvokePendingCb");
      (*(void (**)(_QWORD, _QWORD, _QWORD, uint64_t))(a1 + 6776))(*(_QWORD *)(a1 + 19360), *(_QWORD *)(a1 + 6784), 0, 255);
      goto LABEL_11;
    }
    if (v13)
    {
      if (v13[4])
      {
        sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 12, (uint64_t)"phLibNfc_InvokePendingCb");
        ((void (*)(_QWORD, _QWORD, _QWORD, uint64_t))v13[4])(*(_QWORD *)(a1 + 19360), *v13, 0, 255);
        v12 = v13;
        v13[4] = 0;
LABEL_95:
        *v12 = 0;
        return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
      }
      if (v13[3])
      {
        sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 10, (uint64_t)"phLibNfc_InvokePendingCb");
        ((void (*)(_QWORD, _QWORD, _QWORD, uint64_t))v13[3])(*(_QWORD *)(a1 + 19360), *v13, 0, 255);
        v12 = v13;
        v13[3] = 0;
        goto LABEL_95;
      }
      if (v13[2])
      {
        sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 133, (uint64_t)"phLibNfc_InvokePendingCb");
        ((void (*)(_QWORD, _QWORD, _QWORD, uint64_t))v13[2])(*(_QWORD *)(a1 + 19360), *v13, 0, 255);
        v12 = v13;
        v13[2] = 0;
        goto LABEL_95;
      }
    }
    if (*(_QWORD *)(a1 + 6904))
    {
      v6 = (_QWORD *)(a1 + 6904);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 26, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6904);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6912);
    }
    else
    {
      if (!*(_QWORD *)(a1 + 6792))
        return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
      v6 = (_QWORD *)(a1 + 6792);
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 132, (uint64_t)"phLibNfc_InvokePendingCb");
      v7 = *(void (**)(uint64_t, uint64_t, uint64_t))(a1 + 6792);
      v8 = *(_QWORD *)(a1 + 19360);
      v9 = *(_QWORD *)(a1 + 6800);
    }
    goto LABEL_10;
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InvokePendingCb");
}

uint64_t sub_21987C7D4(unsigned int a1)
{
  uint64_t Memory;
  uint64_t v2;
  uint64_t v3;
  unsigned int v5;

  v5 = a1;
  sub_219850718(1, &v5, 4u, 5u, (uint64_t)"phUtilNfc_InitIoctlDnldCoreCtx");
  if (v5 > 1)
  {
    v2 = 255;
  }
  else
  {
    Memory = phOsalNfc_GetMemory();
    if (Memory)
    {
      phOsalNfc_SetMemory();
      sub_21988F964(v5, Memory);
      v2 = 0;
    }
    else
    {
      v2 = 255;
    }
    v3 = phOsalNfc_GetMemory();
    if (Memory && v3)
    {
      phOsalNfc_SetMemory();
      sub_21988F9F4(v5, v3);
      v2 = 0;
    }
    else
    {
      phOsalNfc_FreeMemory();
      phOsalNfc_FreeMemory();
    }
  }
  sub_219850808(1, &v5, 4u, 5u, (uint64_t)"phUtilNfc_InitIoctlDnldCoreCtx");
  return v2;
}

uint64_t sub_21987C8E0(uint64_t a1)
{
  uint64_t v1;
  char v2;
  char v3;
  uint64_t v4;
  unsigned int v5;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  v7 = 0;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_FreeIoctlDnldCoreCtx");
  v1 = 0;
  v2 = 1;
  while (1)
  {
    v3 = v2;
    if (*((_QWORD *)&unk_253E46700 + 14 * v1) == v9)
      break;
    v2 = 0;
    v1 = 1;
    if ((v3 & 1) == 0)
    {
      v4 = 255;
      goto LABEL_10;
    }
  }
  v5 = *((_DWORD *)&unk_253E46700 + 28 * v1 + 2);
  sub_21988EB80(v9, &v8);
  if (v8)
  {
    phOsalNfc_FreeMemory();
    sub_21988F964(v5, 0);
  }
  sub_21988EC5C(v9, &v7);
  if (v7)
  {
    phOsalNfc_FreeMemory();
    sub_21988F9F4(v5, 0);
  }
  v4 = 0;
LABEL_10:
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_FreeIoctlDnldCoreCtx");
  return v4;
}

uint64_t sub_21987C9E0(unsigned int a1, uint64_t *a2)
{
  uint64_t Memory;
  uint64_t v4;
  uint64_t v5;
  unsigned int v7;

  v7 = a1;
  sub_219850718(1, &v7, 4u, 5u, (uint64_t)"phLibNfc_InitializeDnldEseCoreCtx");
  if (a2 && (*a2 = 0, v7 <= 1) && (Memory = phOsalNfc_GetMemory()) != 0)
  {
    v4 = Memory;
    phOsalNfc_SetMemory();
    sub_21988FA84(v7, v4);
    v5 = 0;
    *a2 = v4;
  }
  else
  {
    v5 = 255;
  }
  sub_219850808(1, &v7, 4u, 5u, (uint64_t)"phLibNfc_InitializeDnldEseCoreCtx");
  return v5;
}

uint64_t sub_21987CAA0(unsigned int a1)
{
  uint64_t v1;
  uint64_t v3;
  unsigned int v4;

  v4 = a1;
  v3 = 0;
  sub_219850718(1, &v4, 4u, 5u, (uint64_t)"phUtilNfc_FreeDnldNfcEseCoreContext");
  if (v4 > 1)
  {
    v1 = 255;
  }
  else
  {
    sub_21988FB14(v4, &v3);
    if (v3)
    {
      phOsalNfc_FreeMemory();
      sub_21988FA84(v4, 0);
    }
    v1 = 0;
  }
  sub_219850808(1, &v4, 4u, 5u, (uint64_t)"phUtilNfc_FreeDnldNfcEseCoreContext");
  return v1;
}

uint64_t sub_21987CB40(unsigned int *a1, uint64_t a2)
{
  unsigned int *v4;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_CommonSeqProc");
  if (a1)
  {
    v4 = a1 + 4842;
    if ((_DWORD)a2)
      sub_219850628(1, v4, 4u, 1u, (uint64_t)"phLibNfc_CommonSeqProc: Status failed");
    else
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"phLibNfc_CommonSeqProc: Status success");
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_CommonSeqProc:Libnfc Context is Invalid");
    a2 = 255;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_CommonSeqProc");
  return a2;
}

uint64_t sub_21987CC04(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t (*v6)(uint64_t, _QWORD);
  uint64_t v7;
  char v8;
  char v9;
  int *v10;
  char v11;
  char v12;
  int *v13;
  uint64_t (*v14)(uint64_t);
  uint64_t v15;
  uint64_t v16;
  void (*v17)(uint64_t, uint64_t);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SeqHandler");
  if (!a1 || (_DWORD)a2)
  {
    if (!a1)
      goto LABEL_30;
    v8 = sub_21985B9B4(a1, *(uint64_t (***)())(a1 + 3736));
    v9 = *(_BYTE *)(a1 + 3937);
    if (*(_DWORD *)(a1 + 6476))
      v10 = &dword_253E47158;
    else
      v10 = &dword_253E47070;
    v10[1] = v10[1] & 0xFFF003FF | ((v8 & 0x1F) << 15) | ((v9 & 0x1F) << 10);
    *(_BYTE *)(a1 + 3936) = v9;
    if ((_DWORD)a2)
      goto LABEL_14;
  }
  else
  {
    v4 = *(unsigned __int8 *)(a1 + 3936);
    if (v4 > *(unsigned __int8 *)(a1 + 3937))
      goto LABEL_24;
    v5 = *(_QWORD *)(a1 + 3736);
    if (!v5)
      goto LABEL_24;
    if (*(_BYTE *)(a1 + 3936))
    {
      v6 = *(uint64_t (**)(uint64_t, _QWORD))(v5 + 16 * (v4 - 1) + 8);
      if (v6)
      {
        v7 = v6(a1, 0);
        if ((_DWORD)v7)
        {
          a2 = v7;
          *(_BYTE *)(a1 + 3936) = *(_BYTE *)(a1 + 3937);
LABEL_14:
          if ((_DWORD)a2 != 13 && *(_BYTE *)(a1 + 3936))
          {
            v11 = sub_21985B9B4(a1, *(uint64_t (***)())(a1 + 3736));
            v12 = *(_BYTE *)(a1 + 3937);
            if (*(_DWORD *)(a1 + 6476))
              v13 = &dword_253E47158;
            else
              v13 = &dword_253E47070;
            v13[1] = v13[1] & 0xFFF003FF | ((v11 & 0x1F) << 15) | ((v12 & 0x1F) << 10);
            *(_BYTE *)(a1 + 3936) = v12;
          }
          goto LABEL_25;
        }
        v5 = *(_QWORD *)(a1 + 3736);
        v4 = *(unsigned __int8 *)(a1 + 3936);
      }
    }
    v14 = *(uint64_t (**)(uint64_t))(v5 + 16 * v4);
    if (v14)
    {
      a2 = v14(a1);
      if ((_DWORD)a2)
        goto LABEL_14;
    }
    else
    {
LABEL_24:
      a2 = 0;
    }
  }
LABEL_25:
  v15 = *(unsigned __int8 *)(a1 + 3936);
  if ((_DWORD)v15 == *(unsigned __int8 *)(a1 + 3937) && (v16 = *(_QWORD *)(a1 + 3736)) != 0)
  {
    v17 = *(void (**)(uint64_t, uint64_t))(v16 + 16 * v15 + 8);
    if (v17)
      v17(a1, a2);
  }
  else
  {
    *(_BYTE *)(a1 + 3936) = v15 + 1;
  }
LABEL_30:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SeqHandler");
  return a2;
}

uint64_t sub_21987CDC4(unsigned int *a1, _QWORD *a2)
{
  unsigned __int8 v4;
  uint64_t *v5;
  uint64_t v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_getSequenceLength");
  if (a2 && *a2)
  {
    v4 = 0;
    v5 = a2 + 2;
    do
    {
      ++v4;
      v6 = *v5;
      v5 += 2;
    }
    while (v6);
  }
  else
  {
    v4 = 0;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_getSequenceLength");
  return v4;
}

uint64_t sub_21987CE50(unsigned int *a1, uint64_t a2, _BYTE *a3, unsigned int a4)
{
  uint64_t v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PollMgmt");
  if (a2 && a3 && a1 && a4)
  {
    if (a3[1] == 3 && a3[2] == 5)
      v8 = 0;
    else
      v8 = sub_2198F0DA8((uint64_t)a1, a2, a3, a4);
  }
  else
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"Invalid input parameters");
    v8 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PollMgmt");
  return v8;
}

uint64_t sub_21987CF28(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  char v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  int v15;
  uint64_t v16;
  uint64_t v18;
  uint64_t v19;

  v18 = 0;
  v19 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_DataTx");
  if (!a1)
    goto LABEL_15;
  v10 = 0;
  v11 = 0;
  do
  {
    v12 = *((_QWORD *)&unk_253E46700 + 14 * v11 + 4);
    if ((v10 & 1) != 0)
      break;
    v10 = 1;
    v11 = 1;
  }
  while (v12 != a1);
  if (!a3 || !a4 || v12 != a1)
  {
LABEL_15:
    v13 = 1;
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciCoreMuxNfc_DataTx : Invalid Parameter");
    goto LABEL_27;
  }
  if (a2 == 3)
  {
    if (*(_BYTE *)(a1 + 5572) == 1)
      goto LABEL_19;
    phOsalNfc_MemCopy();
    *(_BYTE *)(a1 + 5574) = *(_BYTE *)(a3 + 174);
    phOsalNfc_MemCopy();
    *(_DWORD *)(a1 + 5568) = *(_DWORD *)(a1 + 5436);
  }
  else
  {
    if (a2 != 1)
    {
      if (!a2 && *(_BYTE *)(a1 + 5020) != 1)
      {
        phOsalNfc_MemCopy();
        *(_BYTE *)(a1 + 5022) = *(_BYTE *)(a3 + 174);
        *(_DWORD *)(a1 + 5008) = *(_DWORD *)(a1 + 4872);
        phOsalNfc_MemCopy();
        if (!*(_BYTE *)(a1 + 5022))
        {
          BYTE5(v19) = 1;
          LODWORD(v18) = 0;
          v13 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v18, a4, a5);
          if ((_DWORD)v13)
            goto LABEL_27;
        }
        goto LABEL_21;
      }
LABEL_19:
      v13 = 111;
      goto LABEL_27;
    }
    if (*(_BYTE *)(a1 + 5204) == 1)
      goto LABEL_19;
    phOsalNfc_MemCopy();
    *(_BYTE *)(a1 + 5206) = *(_BYTE *)(a3 + 174);
    phOsalNfc_MemCopy();
    *(_DWORD *)(a1 + 5200) = *(_DWORD *)(a1 + 5068);
  }
LABEL_21:
  v14 = a1 + 4848 + 184 * a2;
  *(_BYTE *)(v14 + 172) = 1;
  if (*(_BYTE *)(v14 + 174) == 1)
    v15 = 0;
  else
    v15 = *(_DWORD *)(a3 + 176);
  v16 = a1 + 4848 + 184 * a2;
  *(_DWORD *)(v16 + 176) = v15;
  *(_QWORD *)(v16 + 144) = a4;
  *(_QWORD *)(v16 + 152) = a5;
  if (*(_BYTE *)(a1 + 5952) == 1)
  {
    v13 = 13;
  }
  else
  {
    *(_DWORD *)(a1 + 5956) = a2;
    v13 = sub_21987D1CC();
  }
LABEL_27:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_DataTx");
  return v13;
}

uint64_t sub_21987D1CC()
{
  uint64_t v0;
  unsigned __int16 *v1;
  unsigned __int16 *v2;
  int v3;
  int v4;
  uint64_t v5;
  char v6;
  uint64_t v7;
  _BYTE *v8;
  uint64_t v9;
  uint64_t v10;
  unsigned int v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  unsigned int v16;
  int v17;
  uint64_t v18;
  uint64_t v19;
  void (*v20)(uint64_t, unsigned __int16 *, uint64_t);
  void (*v21)(uint64_t, unsigned __int16 *, uint64_t);
  uint64_t v22;
  uint64_t *v23;
  unsigned int v24;
  unsigned int v25;
  void (*v26)(uint64_t, _QWORD, uint64_t);
  uint64_t v27;
  uint64_t v28;
  uint64_t v29;
  uint64_t v30;
  uint64_t v31;
  unsigned int *v32;
  uint64_t v33;
  char v34;
  uint64_t v35;
  uint64_t v36;
  int v37;
  char v38;
  uint64_t v39;
  uint64_t v40;
  uint64_t v41;
  uint64_t v42;
  uint64_t v43;
  _BYTE *v44;
  unsigned int v45;
  uint64_t v46;
  uint64_t v47;
  uint64_t v48;
  unsigned int *v49;
  const char *v50;
  uint64_t v51;
  uint64_t v52;
  unsigned int *v53;
  int v54;
  uint64_t v55;
  uint64_t v56;
  unsigned int v57;
  uint64_t v58;
  uint64_t v59;
  unsigned int v60;
  unsigned int *v61;
  uint64_t v62;
  int v63;
  const char *v64;
  uint64_t v65;
  uint64_t v66;
  void (*v67)(uint64_t, unsigned __int16 *, uint64_t);
  unsigned int v68;
  uint64_t v69;
  uint64_t v70;
  _DWORD *v71;
  int v72;
  const char *v73;
  unsigned int *v74;
  uint64_t v75;
  uint64_t v76;
  int v77;
  uint64_t v78;
  uint64_t v79;
  uint64_t v80;
  uint64_t v81;
  char v82[4151];
  uint64_t v83;

  v0 = MEMORY[0x24BDAC7A8]();
  v2 = v1;
  v4 = v3;
  v5 = v0;
  v83 = *MEMORY[0x24BDAC8D0];
  bzero(v82, 0x1037uLL);
  sub_219850718(2, (unsigned int *)v5, 3u, 5u, (uint64_t)"phNciMuxNfc_MuxHandler");
  if (!v5)
    goto LABEL_6;
  v6 = 0;
  v7 = 0;
  v8 = (_BYTE *)(v5 + 5756);
  do
  {
    v9 = *((_QWORD *)&unk_253E46700 + 14 * v7 + 4);
    if ((v6 & 1) != 0)
      break;
    v6 = 1;
    v7 = 1;
  }
  while (v9 != v5);
  if (v9 != v5)
  {
LABEL_6:
    v10 = 0;
    goto LABEL_7;
  }
  v12 = *(_DWORD *)(v5 + 5956);
  if (v2)
    v13 = *v2;
  else
    v13 = 255;
  v10 = 255;
  v14 = v5 + 4848;
  switch(v4)
  {
    case 0:
      v15 = v5;
      v16 = *(_DWORD *)(v5 + 5956);
      goto LABEL_18;
    case 1:
      *(_BYTE *)(v5 + 5952) = 0;
      v10 = *(unsigned __int16 *)(v5 + 1484);
      if (*(_BYTE *)(v14 + 184 * v12 + 174) == 1)
      {
        if (*(_DWORD *)(v14 + 184 * v12 + 168))
        {
          if (v12 != 2)
            goto LABEL_134;
          goto LABEL_80;
        }
        v65 = v14 + 184 * v12;
        v67 = *(void (**)(uint64_t, unsigned __int16 *, uint64_t))(v65 + 144);
        v66 = *(_QWORD *)(v65 + 152);
        sub_21987FEF8((unsigned int *)v5);
        if (v67)
          v67(v66, v2, v10);
      }
      else
      {
        if (v12 == 2)
        {
LABEL_80:
          v53 = (unsigned int *)v5;
LABEL_81:
          sub_21987FEF8(v53);
          goto LABEL_134;
        }
        if (!*(_BYTE *)(v14 + 184 * v12 + 174) && !*(_DWORD *)(v14 + 184 * v12 + 168))
        {
          v53 = (unsigned int *)v5;
          goto LABEL_81;
        }
      }
LABEL_134:
      v68 = sub_219880418((unsigned int *)v5, v12);
      if (v68 == 6)
      {
        if (*(_BYTE *)(v5 + 6568) == 1)
          *(_BYTE *)(v5 + 6568) = 0;
      }
      else
      {
        v25 = v68;
        v10 = sub_21987F258(v5, v68);
        if ((_DWORD)v10 == 13)
        {
LABEL_138:
          *(_DWORD *)(v5 + 5956) = v25;
        }
        else
        {
          v69 = v14 + 184 * v12;
          v26 = *(void (**)(uint64_t, _QWORD, uint64_t))(v69 + 144);
          v27 = *(_QWORD *)(v69 + 152);
LABEL_140:
          sub_21987FEF8((unsigned int *)v5);
          if (v26)
            v26(v27, 0, v10);
        }
      }
      goto LABEL_7;
    case 2:
      v16 = *(unsigned __int8 *)(v5 + 6231);
      v15 = v5;
LABEL_18:
      v10 = sub_21987F258(v15, v16);
      goto LABEL_7;
    case 3:
      v17 = *(unsigned __int8 *)(v5 + 6231);
      v18 = v14 + 184 * *(unsigned __int8 *)(v5 + 6231);
      v21 = *(void (**)(uint64_t, unsigned __int16 *, uint64_t))(v18 + 144);
      v19 = v18 + 144;
      v20 = v21;
      v23 = (uint64_t *)(v19 + 8);
      v22 = *(_QWORD *)(v19 + 8);
      sub_21987FEF8((unsigned int *)v5);
      if (v21)
        v20(v22, v2, 36);
      v24 = sub_219880418((unsigned int *)v5, v17);
      if (v24 == 6)
        goto LABEL_6;
      v25 = v24;
      v10 = sub_21987F258(v5, v24);
      if ((_DWORD)v10 == 13)
        goto LABEL_138;
      v26 = *(void (**)(uint64_t, _QWORD, uint64_t))v19;
      v27 = *v23;
      goto LABEL_140;
    case 6:
      v28 = *(_QWORD *)(v5 + 6576);
      v29 = *(_QWORD *)(v5 + 6584);
      sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldTx");
      if (v12 == 4 && v28)
      {
        v10 = sub_21987F0A8(v28);
        if ((_DWORD)v10 == 13)
        {
          sub_21988F804(*(_QWORD *)(v5 + 6480), 1);
          *(_BYTE *)(v5 + 5952) = 1;
          *(_DWORD *)(v5 + 5748) = *(_DWORD *)(v28 + 104);
          goto LABEL_7;
        }
        sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciMuxNfc_MuxHandler : Write Request Failed(eMuxEvtDnldTx)");
        if ((_DWORD)v10 == 111)
          v10 = 111;
        else
          v10 = 255;
        if (!*(_BYTE *)(v5 + 5940))
        {
          phTmlNfc_ReadAbort();
          phTmlNfc_FlushTxRxBuffers();
          if (sub_219905DA0(v28) != 13)
          {
            sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldTx: Read request failed");
            v10 = 255;
          }
        }
        v61 = (unsigned int *)v5;
        v62 = v10;
        v63 = 4;
        goto LABEL_192;
      }
      v10 = 0;
      if (v12 != 5 || !v29)
        goto LABEL_7;
      v10 = sub_21987FFD0(v5);
      if ((_DWORD)v10 == 13)
      {
        sub_21988F804(*(_QWORD *)(v5 + 6480), 1);
        *(_BYTE *)(v5 + 5952) = 1;
        *(_DWORD *)(v5 + 5932) = *(_DWORD *)(v29 + 376);
        goto LABEL_7;
      }
      sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciMuxNfc_MuxHandler : Write Request Failed(phNciCoreMuxNfc_eMuxEvtDnldTx)");
      if ((_DWORD)v10 == 111)
        v10 = 111;
      else
        v10 = 255;
      if (!*v8 && !*(_BYTE *)(v5 + 5953))
      {
        phTmlNfc_ReadAbort();
        phTmlNfc_FlushTxRxBuffers();
        if (sub_219905DA0(v28) != 13)
        {
          v73 = "phNciCoreMuxNfc_eMuxEvtDnldTx: Read request failed";
          v74 = (unsigned int *)(v5 + 6476);
          goto LABEL_184;
        }
      }
      goto LABEL_185;
    case 7:
      v30 = *(_QWORD *)(v5 + 6576);
      v31 = *(_QWORD *)(v5 + 6584);
      v32 = (unsigned int *)(v5 + 6476);
      sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldTxCb");
      *(_BYTE *)(v5 + 5952) = 0;
      if (v30)
      {
        v33 = *(_QWORD *)(v30 + 64);
        if (v33)
        {
          if (v33 != 0xFFFFFFFFFFFFLL)
          {
            sub_21988C4AC(*(_DWORD *)(v30 + 8492), v33);
            *(_BYTE *)(v30 + 80) = 0;
          }
        }
      }
      if ((_DWORD)v13 != 179 && (_DWORD)v13)
        goto LABEL_212;
      sub_219850718(2, (unsigned int *)v5, 3u, 5u, (uint64_t)"phNciMuxNfc_DnldEseInterleaveNextPkt");
      v34 = 0;
      v35 = 0;
      do
      {
        v36 = *((_QWORD *)&unk_253E46700 + 14 * v35 + 4);
        if ((v34 & 1) != 0)
          break;
        v34 = 1;
        v35 = 1;
      }
      while (v36 != v5);
      if (v36 != v5)
        goto LABEL_38;
      if (v12 == 5)
      {
        if (*v8 == 1 || *(_BYTE *)(v5 + 5953) == 1)
          goto LABEL_162;
        if (*(_BYTE *)(v5 + 5940) != 1 && *(_BYTE *)(v5 + 5954) != 1)
          goto LABEL_38;
      }
      else
      {
        if (v12 != 4)
        {
LABEL_38:
          v37 = 0;
          v38 = 1;
          goto LABEL_39;
        }
        if (*(_BYTE *)(v5 + 5940) != 1 && *(_BYTE *)(v5 + 5954) != 1)
        {
          if (*v8 == 1 || *(_BYTE *)(v5 + 5953) == 1)
          {
LABEL_162:
            sub_219850808(2, (unsigned int *)v5, 3u, 5u, (uint64_t)"phNciMuxNfc_DnldEseInterleaveNextPkt");
            if (!v30)
            {
LABEL_167:
              v12 = 4;
LABEL_212:
              sub_219880268((unsigned int *)v5, v13, v12, (uint64_t)v2);
              goto LABEL_213;
            }
            v10 = v13;
            if (*(_BYTE *)(v5 + 5953) != 1)
              goto LABEL_7;
            sub_21988C4AC(*(_DWORD *)(v30 + 8492), *(_QWORD *)(v30 + 56));
            if (*(_BYTE *)(v30 + 8440))
            {
              *(_DWORD *)(v30 + 84) = 1500;
              v75 = phOsalNfc_Timer_Start();
              if ((_DWORD)v75)
              {
                v13 = v75;
                goto LABEL_167;
              }
              v13 = phTmlNfc_Write();
              if ((_DWORD)v13 == 13)
              {
                sub_21988F804(*(_QWORD *)(v5 + 6480), 1);
                v77 = 0;
                *(_BYTE *)(v5 + 5952) = 1;
                *(_DWORD *)(v5 + 5748) = *(_DWORD *)(v30 + 104);
              }
              else
              {
                v77 = 1;
                sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo : Write Request Failed");
              }
            }
            else
            {
              v13 = sub_21987F0A8(v30);
              v77 = 1;
              if ((_DWORD)v13 == 13)
              {
                sub_21988F804(*(_QWORD *)(v5 + 6480), 1);
                *(_BYTE *)(v5 + 5952) = 1;
                *(_DWORD *)(v5 + 5748) = *(_DWORD *)(v30 + 104);
                sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"NCI Send busy[DNLD]");
                v77 = 0;
              }
            }
            *(_BYTE *)(v5 + 5953) = 0;
            v12 = 4;
LABEL_211:
            v10 = v13;
            if (!v77)
              goto LABEL_7;
            goto LABEL_212;
          }
          goto LABEL_38;
        }
      }
      v38 = 0;
      v37 = 1;
LABEL_39:
      sub_219850808(2, (unsigned int *)v5, 3u, 5u, (uint64_t)"phNciMuxNfc_DnldEseInterleaveNextPkt");
      if (!v30 || !v37 || !v31)
      {
        if ((v38 & 1) != 0)
          goto LABEL_213;
        v12 = 5;
        goto LABEL_212;
      }
      if (!*(_DWORD *)(v5 + 5932))
      {
        *(_BYTE *)(v5 + 5940) = 0;
        goto LABEL_213;
      }
      if (!*(_BYTE *)(v5 + 5952))
      {
        if (sub_21987FFD0(v5) == 13)
        {
          if (!*(_BYTE *)(v31 + 17))
          {
            sub_21988F804(*(_QWORD *)(v5 + 6480), 1);
            *(_BYTE *)(v5 + 5952) = 1;
          }
          v77 = 0;
          *(_DWORD *)(v5 + 5932) = *(_DWORD *)(v31 + 376);
          v13 = 13;
        }
        else
        {
          sub_21988C4AC(*(_DWORD *)(v30 + 8492), *(_QWORD *)(v31 + 48));
          *(_BYTE *)(v31 + 16) = 0;
          sub_21988C4AC(*(_DWORD *)(v30 + 8492), *(_QWORD *)(v31 + 56));
          v77 = 1;
          sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldTxCb : Write Request Failed");
          v13 = 255;
        }
        *(_BYTE *)(v5 + 5954) = 0;
        v12 = 5;
        goto LABEL_211;
      }
      if (*(_BYTE *)(v5 + 5954))
      {
        sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"DNLD Ese Waiting on Send CB");
      }
      else
      {
        *(_BYTE *)(v5 + 5954) = 1;
        v79 = *(_QWORD *)(v30 + 64);
        if (v79 && v79 != 0xFFFFFFFFFFFFLL && !*(_BYTE *)(v30 + 80))
        {
          if (phOsalNfc_Timer_Start())
          {
            v50 = "phNciCoreMuxNfc_eMuxEvtDnldTxCb : Failed to create start timer";
            goto LABEL_207;
          }
          *(_BYTE *)(v30 + 80) = 1;
        }
      }
LABEL_213:
      v10 = v13;
      goto LABEL_7;
    case 8:
      v39 = *(_QWORD *)(v5 + 6576);
      v40 = *(_QWORD *)(v5 + 6584);
      v32 = (unsigned int *)(v5 + 6476);
      sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRx");
      if (v12 != 4 || !v39)
      {
        v10 = 0;
        v54 = 1;
        if (v12 != 5 || !v40)
          goto LABEL_188;
        sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"Send complete, invoke upper layer");
        v55 = *(_QWORD *)(v40 + 48);
        if (v55 != 0xFFFFFFFFFFFFLL)
        {
          sub_21988C4AC(*(_DWORD *)(v39 + 8492), v55);
          *(_BYTE *)(v40 + 16) = 0;
        }
        v56 = *(_QWORD *)(v40 + 56);
        if (v56 == 0xFFFFFFFFFFFFLL)
        {
LABEL_144:
          v10 = 0;
          goto LABEL_188;
        }
        v57 = *(_DWORD *)(v39 + 8492);
LABEL_143:
        sub_21988C4AC(v57, v56);
        goto LABEL_144;
      }
      *(_BYTE *)(v39 + 8440) = 0;
      if (!*(_DWORD *)(v39 + 104))
      {
        v54 = 1;
        sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"Send complete, invoke upper layer");
        v57 = *(_DWORD *)(v39 + 8492);
        v56 = *(_QWORD *)(v39 + 56);
        goto LABEL_143;
      }
      if (!*(_BYTE *)(v5 + 5952))
      {
        sub_21988C4AC(*(_DWORD *)(v39 + 8492), *(_QWORD *)(v39 + 56));
        v10 = sub_21987F0A8(v39);
        if ((_DWORD)v10 == 13)
        {
          sub_21988F804(*(_QWORD *)(v5 + 6480), 1);
          v54 = 0;
          *(_BYTE *)(v5 + 5952) = 1;
          *(_DWORD *)(v5 + 5748) = *(_DWORD *)(v39 + 104);
        }
        else
        {
          v54 = 1;
          sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRx : Write Request Failed");
        }
        *(_BYTE *)(v5 + 5953) = 0;
LABEL_188:
        if (v2 && v54 && *((_QWORD *)v2 + 1))
        {
          v61 = (unsigned int *)v5;
          v62 = v10;
          v63 = v12;
          goto LABEL_192;
        }
        goto LABEL_7;
      }
      if (*(_BYTE *)(v5 + 5953))
      {
        sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"DNLD Waiting on Send CB");
        goto LABEL_6;
      }
      v10 = 0;
      *(_BYTE *)(v5 + 5953) = 1;
      v76 = *(_QWORD *)(v39 + 64);
      if (!v76 || v76 == 0xFFFFFFFFFFFFLL)
        goto LABEL_7;
      if (*(_BYTE *)(v39 + 80))
        goto LABEL_6;
      if (phOsalNfc_Timer_Start())
      {
        v50 = "phNciCoreMuxNfc_DnldCmdTx : Failed to create start timer";
LABEL_207:
        v49 = v32;
        goto LABEL_208;
      }
LABEL_229:
      v10 = 0;
      *(_BYTE *)(v39 + 80) = 1;
LABEL_7:
      sub_219850808(2, (unsigned int *)v5, 3u, 5u, (uint64_t)"phNciMuxNfc_MuxHandler");
      return v10;
    case 9:
      v41 = *(_QWORD *)(v5 + 6576);
      sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 2u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRxFail");
      if (v12 == 4)
      {
        if (*(_BYTE *)(v5 + 5940) || *(_BYTE *)(v5 + 5954))
          goto LABEL_194;
      }
      else if (v12 != 5 || *v8 || *(_BYTE *)(v5 + 5953))
      {
        goto LABEL_194;
      }
      if (v41)
      {
        if (phTmlNfc_WriteAbort())
        {
          sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 2u, (uint64_t)"MuxEvtDnldRxFail Write Abort failed");
        }
        else
        {
          *(_BYTE *)(v5 + 5952) = 0;
          sub_21988F804(*(_QWORD *)(v5 + 6480), 0);
        }
      }
LABEL_194:
      sub_219880318(v5, v13, v12, (uint64_t)v2);
      goto LABEL_195;
    case 10:
      v42 = *(_QWORD *)(v5 + 6576);
      v43 = *(_QWORD *)(v5 + 6584);
      sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 4u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo");
      if (v12 != 4 || !v42)
      {
        v10 = 0;
        if (v12 != 5 || !v43 || !v42)
          goto LABEL_7;
        sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo: Response Timeout");
        v10 = 44;
        sub_219886108(*(_QWORD *)(v5 + 6480), 44);
        *(_BYTE *)(v5 + 5954) = 0;
        if (!*v8 && !*(_BYTE *)(v5 + 5953))
        {
          phTmlNfc_ReadAbort();
          phTmlNfc_FlushTxRxBuffers();
          phTmlNfc_WriteAbort();
          sub_21988F804(*(_QWORD *)(v5 + 6480), 0);
          *(_BYTE *)(v5 + 5952) = 0;
          if (sub_219905DA0(v42) != 13)
          {
            sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo: Read request failed");
            v10 = 255;
          }
        }
        sub_21988C4AC(*(_DWORD *)(v42 + 8492), *(_QWORD *)(v43 + 48));
        *(_BYTE *)(v43 + 16) = 0;
        sub_21988C4AC(*(_DWORD *)(v42 + 8492), *(_QWORD *)(v43 + 56));
        v58 = v5;
        v59 = v10;
        v60 = 5;
LABEL_226:
        sub_219880318(v58, v59, v60, (uint64_t)v2);
        goto LABEL_7;
      }
      v44 = (_BYTE *)(v42 + 8440);
      v45 = *(unsigned __int8 *)(v42 + 8440);
      if (v45 <= 4)
      {
        sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 2u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo: Dnld Response timeout, re-transmit the frame!!");
        ++*v44;
        sub_219886108(*(_QWORD *)(v5 + 6480), 44);
        sub_21988C4AC(*(_DWORD *)(v42 + 8492), *(_QWORD *)(v42 + 56));
        *(_DWORD *)(v42 + 84) = 1500;
        v46 = phOsalNfc_Timer_Start();
        if ((_DWORD)v46)
        {
LABEL_61:
          v10 = v46;
          sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo : Dnld response timer start failed");
          goto LABEL_62;
        }
        if (*(_BYTE *)(v5 + 5953) == 1)
        {
LABEL_159:
          v10 = 0;
LABEL_220:
          if (*(_BYTE *)(v5 + 5953))
            goto LABEL_7;
          sub_21988F804(*(_QWORD *)(v5 + 6480), 0);
          *(_BYTE *)(v5 + 5952) = 0;
          sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo: MAX Limit Reached");
          sub_219886108(*(_QWORD *)(v5 + 6480), 44);
          sub_21988C4AC(*(_DWORD *)(v42 + 8492), *(_QWORD *)(v42 + 56));
          if (!*(_BYTE *)(v5 + 5940) && !*(_BYTE *)(v5 + 5954))
          {
            phTmlNfc_ReadAbort();
            phTmlNfc_WriteAbort();
            sub_21988F804(*(_QWORD *)(v5 + 6480), 0);
            *(_BYTE *)(v5 + 5952) = 0;
            if (sub_219905DA0(v42) != 13)
              sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo: Read request failed");
          }
          *v44 = 0;
          v10 = 255;
          v58 = v5;
          v59 = 255;
          v60 = 4;
          goto LABEL_226;
        }
        if (*(_BYTE *)(v5 + 5952))
        {
          v10 = 0;
          *(_BYTE *)(v5 + 5953) = 1;
          v78 = *(_QWORD *)(v42 + 64);
          if (!v78 || v78 == 0xFFFFFFFFFFFFLL)
            goto LABEL_220;
          if (!*(_BYTE *)(v42 + 80))
          {
            if (phOsalNfc_Timer_Start())
            {
              sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_DnldCmdTx : Failed to create start timer");
              v10 = 255;
            }
            else
            {
              v10 = 0;
              *(_BYTE *)(v42 + 80) = 1;
            }
            goto LABEL_220;
          }
          goto LABEL_159;
        }
        v80 = phTmlNfc_Write();
        if ((_DWORD)v80 == 13)
          goto LABEL_63;
        v10 = v80;
        v64 = "phNciCoreMuxNfc_eMuxEvtDnldRspTo : Write Request Failed";
LABEL_219:
        sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)v64);
        goto LABEL_220;
      }
      if (v45 != 5 || *(_BYTE *)(v42 + 8444) || *(_BYTE *)(v42 + 8445) || (*(unsigned __int8 *)(v42 + 8504) | 2) == 6)
      {
        *v44 = 0;
        *(_BYTE *)(v5 + 5953) = 0;
        if (*(_BYTE *)(v5 + 5940))
          goto LABEL_220;
        if (*(_BYTE *)(v5 + 5954))
          goto LABEL_220;
        phTmlNfc_ReadAbort();
        phTmlNfc_FlushTxRxBuffers();
        phTmlNfc_WriteAbort();
        sub_21988F804(*(_QWORD *)(v42 + 48), 0);
        *(_BYTE *)(v5 + 5952) = 0;
        if (sub_219905DA0(v42) == 13)
          goto LABEL_220;
        v64 = "phNciCoreMuxNfc_eMuxEvtDnldRspTo: Read request failed";
        goto LABEL_219;
      }
      phOsalNfc_MemCopy();
      *(_BYTE *)(v42 + 126) = 0;
      phOsalNfc_MemCopy();
      ++*(_WORD *)(v42 + 124);
      sub_21988C4AC(*(_DWORD *)(v42 + 8492), *(_QWORD *)(v42 + 56));
      *(_DWORD *)(v42 + 84) = 1500;
      v46 = phOsalNfc_Timer_Start();
      if ((_DWORD)v46)
        goto LABEL_61;
      if (*(_BYTE *)(v5 + 5953))
        goto LABEL_232;
      if (*(_BYTE *)(v5 + 5952))
      {
        v10 = 0;
        *(_BYTE *)(v5 + 5953) = 1;
        v81 = *(_QWORD *)(v42 + 64);
        if (v81 && v81 != 0xFFFFFFFFFFFFLL)
        {
          if (*(_BYTE *)(v42 + 80))
          {
LABEL_232:
            v10 = 0;
          }
          else if (phOsalNfc_Timer_Start())
          {
            sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_DnldCmdTx : Failed to create start timer");
            v10 = 255;
          }
          else
          {
            v10 = 0;
            *(_BYTE *)(v42 + 80) = 1;
          }
        }
      }
      else
      {
        v10 = phTmlNfc_Write();
        if ((_DWORD)v10 != 13)
          sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldRspTo : Write Request Failed");
      }
      ++*v44;
      *(_BYTE *)(v42 + 8444) = 1;
LABEL_62:
      if ((_DWORD)v10 == 13)
      {
LABEL_63:
        sub_21988F804(*(_QWORD *)(v5 + 6480), 1);
        *(_BYTE *)(v5 + 5952) = 1;
        *(_DWORD *)(v5 + 5956) = 4;
        v10 = 13;
        goto LABEL_7;
      }
      goto LABEL_220;
    case 11:
      v10 = 0;
      v47 = *(_QWORD *)(v5 + 6584);
      if (!v47)
        goto LABEL_7;
      v39 = *(_QWORD *)(v5 + 6576);
      if (!v39)
        goto LABEL_7;
      if (!*(_BYTE *)(v5 + 5952))
      {
        sub_21988C4AC(*(_DWORD *)(v39 + 8492), *(_QWORD *)(v47 + 56));
        v70 = v14 + 184 * v12;
        v72 = *(_DWORD *)(v70 + 164);
        v71 = (_DWORD *)(v70 + 164);
        if (!v72)
          goto LABEL_6;
        v10 = sub_21987FFD0(v5);
        if ((_DWORD)v10 == 13)
        {
          sub_21988F804(*(_QWORD *)(v5 + 6480), 1);
          *(_BYTE *)(v5 + 5952) = 1;
          *v71 = *(_DWORD *)(v47 + 376);
        }
        else
        {
          *(_BYTE *)(v5 + 5954) = 0;
          if (!*v8 && !*(_BYTE *)(v5 + 5953))
          {
            phTmlNfc_ReadAbort();
            phTmlNfc_FlushTxRxBuffers();
            sub_219850628(1, (unsigned int *)(v5 + 6476), 3u, 1u, (uint64_t)"phNciMuxNfc_MuxHandler : Write Request Failed(eMuxEvtDnldEseCrdtNtf)");
            v10 = (_DWORD)v10 == 111 ? 111 : 255;
            if (sub_219905DA0(v39) != 13)
            {
              v73 = "phNciCoreMuxNfc_eMuxEvtDnldRspTo: Read request failed";
              v74 = (unsigned int *)(v5 + 6476);
LABEL_184:
              sub_219850628(1, v74, 3u, 1u, (uint64_t)v73);
              v10 = 255;
            }
          }
LABEL_185:
          v61 = (unsigned int *)v5;
          v62 = v10;
          v63 = 5;
LABEL_192:
          sub_219880268(v61, v62, v63, (uint64_t)v2);
        }
        goto LABEL_7;
      }
      if (*(_BYTE *)(v5 + 5954))
        goto LABEL_6;
      v10 = 0;
      *(_BYTE *)(v5 + 5954) = 1;
      v48 = *(_QWORD *)(v39 + 64);
      if (!v48 || v48 == 0xFFFFFFFFFFFFLL)
        goto LABEL_7;
      if (*(_BYTE *)(v39 + 80))
        goto LABEL_6;
      if (phOsalNfc_Timer_Start())
      {
        v49 = (unsigned int *)(v5 + 6476);
        v50 = "phNciCoreMuxNfc_eMuxEvtDnldEseCrdtNtf : Failed to create start timer";
LABEL_208:
        sub_219850628(1, v49, 3u, 1u, (uint64_t)v50);
LABEL_195:
        v10 = 255;
        goto LABEL_7;
      }
      goto LABEL_229;
    case 12:
      v10 = 0;
      v51 = *(_QWORD *)(v5 + 6584);
      if (!v51)
        goto LABEL_7;
      v52 = *(_QWORD *)(v5 + 6576);
      if (!v52)
        goto LABEL_7;
      if (!*v8 && !*(_BYTE *)(v5 + 5953))
      {
        phTmlNfc_WriteAbort();
        *(_BYTE *)(v5 + 5952) = 0;
        sub_21988F804(*(_QWORD *)(v5 + 6480), 0);
      }
      sub_21988C4AC(*(_DWORD *)(v52 + 8492), *(_QWORD *)(v51 + 48));
      *(_BYTE *)(v51 + 16) = 0;
      sub_21988C4AC(*(_DWORD *)(v52 + 8492), *(_QWORD *)(v51 + 56));
      sub_219880318(v5, 36, 5u, (uint64_t)v2);
      goto LABEL_6;
    default:
      goto LABEL_7;
  }
}

uint64_t sub_21987E460(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v10;
  uint64_t v11;
  _BYTE *v12;
  int v13;
  uint64_t v14;
  uint64_t v16;
  uint64_t v17;

  sub_219850718(4, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_DnldCmdTx");
  if (a1 && a4 && a3 && (v10 = *(_QWORD *)(a1 + 8496)) != 0)
  {
    v11 = v10 + 4848 + 184 * a2;
    v13 = *(unsigned __int8 *)(v11 + 172);
    v12 = (_BYTE *)(v11 + 172);
    if (v13 == 1)
    {
      v14 = 111;
    }
    else
    {
      v16 = v10 + 4848 + 184 * a2;
      phOsalNfc_MemCopy();
      *v12 = 1;
      *(_QWORD *)(v16 + 144) = a4;
      *(_QWORD *)(v16 + 152) = a5;
      if (*(_BYTE *)(v10 + 5952) == 1)
      {
        *(_BYTE *)(v10 + 5953) = 1;
        v17 = *(_QWORD *)(a1 + 64);
        v14 = 13;
        if (v17 && v17 != 0xFFFFFFFFFFFFLL && !*(_BYTE *)(a1 + 80))
        {
          if (phOsalNfc_Timer_Start())
          {
            sub_219850628(1, (unsigned int *)(v10 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_DnldCmdTx : Failed to create start timer");
            v14 = 255;
          }
          else
          {
            *(_BYTE *)(a1 + 80) = 1;
          }
        }
      }
      else
      {
        *(_DWORD *)(v10 + 5956) = a2;
        *(_DWORD *)(a1 + 104) = 0;
        v14 = sub_21987D1CC();
      }
    }
  }
  else
  {
    v14 = 1;
    sub_219850628(4, (unsigned int *)a1, 3u, 1u, (uint64_t)"phNciCoreMuxNfc_DataTx : Invalid Parameter");
  }
  sub_219850808(4, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_DnldCmdTx");
  return v14;
}

uint64_t sub_21987E614(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  char v5;
  uint64_t v6;
  uint64_t v7;
  char v8;
  uint64_t v9;
  uint64_t v10;

  sub_219850718(4, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_TmlBusyCb");
  if (a2)
  {
    v4 = *(_QWORD *)(a2 + 8496);
    if (v4)
    {
      sub_219850628(1, (unsigned int *)(v4 + 6476), 3u, 2u, (uint64_t)"phNciCoreMuxNfc_TmlBusyCb:Mux TML busy timer expired");
      sub_21988C4AC(*(_DWORD *)(v4 + 6476), a1);
      *(_BYTE *)(a2 + 80) = 0;
      if (*(_QWORD *)(a2 + 64) == a1)
      {
        v5 = 0;
        v6 = 0;
        do
        {
          v7 = *((_QWORD *)&unk_253E46700 + 14 * v6 + 4);
          if ((v5 & 1) != 0)
            break;
          v5 = 1;
          v6 = 1;
        }
        while (v7 != v4);
        if (v7 != v4 || *(_BYTE *)(v4 + 5952) || sub_21988F8B8(*(_QWORD *)(v4 + 6480)))
        {
          if (*(_BYTE *)(v4 + 5953) == 1)
          {
            *(_BYTE *)(v4 + 5953) = 0;
            *(_DWORD *)(v4 + 5956) = 4;
            sub_21987D1CC(v4, 9, 0);
          }
          v8 = 0;
          v9 = 0;
          do
          {
            v10 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 4);
            if ((v8 & 1) != 0)
              break;
            v8 = 1;
            v9 = 1;
          }
          while (v10 != v4);
          if (v10 == v4 && *(_BYTE *)(v4 + 5954) == 1)
          {
            *(_BYTE *)(v4 + 5954) = 0;
            *(_DWORD *)(v4 + 5956) = 5;
            sub_21987D1CC(v4, 9, 0);
          }
        }
        else
        {
          sub_219907214((unsigned int *)v4);
        }
      }
    }
  }
  return sub_219850808(4, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_TmlBusyCb");
}

uint64_t sub_21987E794(_QWORD *a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v10;
  uint64_t v11;
  _BYTE *v12;
  uint64_t v13;
  unsigned int v14;
  uint64_t v15;
  _BYTE *v16;
  int v17;
  uint64_t v18;
  _QWORD *v19;
  int v20;
  uint64_t v21;
  uint64_t v22;
  uint64_t v23;
  _BYTE *v24;
  uint64_t v25;
  uint64_t v26;
  unsigned int *v27;
  int v28;
  int v30;
  uint64_t v31;
  uint64_t v32;
  unsigned int v33;
  uint64_t v34;

  v34 = 0;
  sub_219850718(5, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_DnldEseTx");
  if (a1)
  {
    v10 = a1[172];
    sub_21988F460(*a1, &v34);
    if (v34)
    {
      v11 = *(_QWORD *)(v34 + 56);
      goto LABEL_6;
    }
  }
  else
  {
    v10 = 0;
  }
  v11 = 0;
  if (!a1)
  {
LABEL_15:
    v18 = 1;
    sub_219850628(2, (unsigned int *)v10, 3u, 1u, (uint64_t)"phNciCoreMuxNfc_DnldEseTx:Invalid Parameter");
    goto LABEL_36;
  }
LABEL_6:
  if (!a4 || !a5 || !a3 || !v10 || !v11)
    goto LABEL_15;
  v12 = (_BYTE *)(v10 + 5756);
  v13 = v10 + 4848;
  v14 = a2;
  v15 = v10 + 4848 + 184 * a2;
  v17 = *(unsigned __int8 *)(v15 + 172);
  v16 = (_BYTE *)(v15 + 172);
  if (v17 != 1)
    goto LABEL_25;
  if (*(_DWORD *)(a3 + 96) != 34 || *(_DWORD *)(v13 + 184 * a2 + 96))
  {
    v18 = 111;
    goto LABEL_36;
  }
  v19 = a1 + 8;
  if (!a1[8] || !a1[81])
    goto LABEL_25;
  v31 = v11;
  if (*v12)
  {
    v30 = 1;
  }
  else
  {
    phTmlNfc_WriteAbort();
    phTmlNfc_ReadAbort();
    phTmlNfc_FlushTxRxBuffers();
    if (sub_219905DA0(v31) == 13)
    {
      v20 = 1;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(v10 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldTx: Read request failed");
      v20 = 255;
    }
    v19 = a1 + 8;
    v30 = v20;
    sub_21988F804(*(_QWORD *)(v31 + 48), 0);
    *(_BYTE *)(v10 + 5952) = 0;
  }
  phOsalNfc_SetMemory();
  *((_DWORD *)a1 + 18) = 0;
  v18 = 255;
  ((void (*)(_QWORD, _QWORD, _QWORD, _QWORD *, uint64_t, uint64_t))a1[81])(*a1, a1[82], a1[1], v19, 255, 150);
  v12 = (_BYTE *)(v10 + 5756);
  *(_OWORD *)(a1 + 81) = 0u;
  *(_OWORD *)(a1 + 83) = 0u;
  v11 = v31;
  v14 = a2;
  if (v30 != 255)
  {
LABEL_25:
    v21 = a3;
    v22 = v11;
    *((_DWORD *)a1 + 94) = 0;
    v32 = v21;
    v33 = v14;
    v23 = v13 + 184 * v14;
    v24 = v12;
    phOsalNfc_MemCopy();
    *v16 = 1;
    *(_QWORD *)(v23 + 144) = a4;
    *(_QWORD *)(v23 + 152) = a5;
    if (v24[196] == 1)
    {
      v24[198] = 1;
      v25 = *(_QWORD *)(v22 + 64);
      v18 = 13;
      if (v25)
      {
        v26 = v10 + 4848;
        if (v25 != 0xFFFFFFFFFFFFLL && !*(_BYTE *)(v22 + 80))
        {
          v27 = (unsigned int *)(v10 + 6476);
          if (phOsalNfc_Timer_Start())
          {
            sub_219850628(1, v27, 3u, 1u, (uint64_t)"phNciCoreMuxNfc_DnldEseTx:Failed to create start timer");
            v18 = 255;
          }
          else
          {
            sub_21988629C(1, v27, *(_QWORD *)(v22 + 64), 3u, 4u, (uint64_t)"phNciCoreMuxNfc_DnldEseTx");
            *(_BYTE *)(v22 + 80) = 1;
          }
        }
      }
      else
      {
        v26 = v10 + 4848;
      }
      v28 = *(_DWORD *)(v32 + 112);
      if (*(_DWORD *)(v32 + 96) == 37)
        v28 = 1;
      *(_DWORD *)(v26 + 184 * v33 + 164) = v28;
    }
    else
    {
      *(_DWORD *)(v10 + 5956) = a2;
      *((_DWORD *)a1 + 94) = 0;
      v18 = sub_21987D1CC();
    }
  }
LABEL_36:
  sub_219850808(5, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_DnldEseTx");
  return v18;
}

uint64_t sub_21987EB1C(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  char v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  _BYTE *v15;
  int v16;
  uint64_t v18;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_CmdTx");
  if (a1)
  {
    v10 = 0;
    v11 = 0;
    do
    {
      v12 = *((_QWORD *)&unk_253E46700 + 14 * v11 + 4);
      if ((v10 & 1) != 0)
        break;
      v10 = 1;
      v11 = 1;
    }
    while (v12 != a1);
    v13 = 255;
    if (a3 && v12 == a1)
    {
      v14 = a1 + 4848 + 184 * a2;
      v16 = *(unsigned __int8 *)(v14 + 172);
      v15 = (_BYTE *)(v14 + 172);
      if (v16 == 1)
      {
        v13 = 111;
      }
      else
      {
        v18 = a1 + 4848 + 184 * a2;
        phOsalNfc_MemCopy();
        *(_DWORD *)(v18 + 168) = *(_DWORD *)(v18 + 24);
        *(_QWORD *)(v18 + 144) = a4;
        *(_QWORD *)(v18 + 152) = a5;
        *v15 = 1;
        if (*(_BYTE *)(a1 + 5952) == 1)
        {
          v13 = 13;
        }
        else
        {
          *(_DWORD *)(a1 + 5956) = a2;
          v13 = sub_21987D1CC();
        }
      }
    }
  }
  else
  {
    v13 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_CmdTx");
  return v13;
}

uint64_t sub_21987EC70(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  char v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_Tx");
  if (a1)
  {
    v10 = 0;
    v11 = 0;
    do
    {
      v12 = *((_QWORD *)&unk_253E46700 + 14 * v11 + 4);
      if ((v10 & 1) != 0)
        break;
      v10 = 1;
      v11 = 1;
    }
    while (v12 != a1);
    v13 = 1;
    if (a3 && v12 == a1)
    {
      *(_BYTE *)(a1 + 6467) = 0;
      switch(a2)
      {
        case 0u:
        case 1u:
        case 3u:
          phOsalNfc_MemCopy();
          v14 = sub_21987CF28(a1, a2, a3, a4, a5);
          goto LABEL_14;
        case 2u:
          phOsalNfc_MemCopy();
          v14 = sub_21987EB1C(a1, 2u, a3, a4, a5);
          goto LABEL_14;
        case 4u:
          v14 = sub_21987E460(*(_QWORD *)(a1 + 6576), 4u, a3, a4, a5);
          goto LABEL_14;
        case 5u:
          v14 = sub_21987E794(*(_QWORD **)(a1 + 6584), 5u, a3, a4, a5);
LABEL_14:
          v13 = v14;
          break;
        default:
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_Tx :Unknown Mux Index");
          break;
      }
    }
  }
  else
  {
    v13 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_Tx");
  return v13;
}

uint64_t sub_21987EE1C(uint64_t a1, unsigned int a2, int a3, char a4)
{
  char v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_HciBuildHcpFragment");
  if (a1)
  {
    v8 = 0;
    v9 = 0;
    do
    {
      v10 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 4);
      if ((v8 & 1) != 0)
        break;
      v8 = 1;
      v9 = 1;
    }
    while (v10 != a1);
    v11 = 1;
    if (a3 && v10 == a1)
    {
      phOsalNfc_SetMemory();
      v12 = a1 + 4848 + 184 * a2;
      *(_BYTE *)(a1 + 5976) = *(_BYTE *)(v12 + 32) | (a4 << 7);
      phOsalNfc_MemCopy();
      v11 = 0;
      *(_QWORD *)(v12 + 16) = a1 + 5976;
      *(_DWORD *)(v12 + 24) = a3 + 1;
      *(_DWORD *)(v12 + 160) = a3 + 1;
    }
  }
  else
  {
    v11 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_HciBuildHcpFragment");
  return v11;
}

uint64_t sub_21987EF4C(uint64_t a1, unsigned int a2, int a3, char a4)
{
  char v8;
  uint64_t v9;
  _BYTE *v10;
  uint64_t v11;
  uint64_t v12;
  unsigned int v13;
  uint64_t v14;
  char v15;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_HciCoreBuildHcipacket");
  if (!a1)
    goto LABEL_6;
  v8 = 0;
  v9 = 0;
  v10 = (_BYTE *)(a1 + 5976);
  do
  {
    v11 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 4);
    if ((v8 & 1) != 0)
      break;
    v8 = 1;
    v9 = 1;
  }
  while (v11 != a1);
  if (v11 == a1)
  {
    phOsalNfc_SetMemory();
    v13 = a2;
    v14 = a1 + 4848 + 184 * a2;
    v15 = *(_BYTE *)(v14 + 33) | (*(_BYTE *)(v14 + 34) << 6);
    *v10 = *(_BYTE *)(v14 + 32) | (a4 << 7);
    *(_BYTE *)(a1 + 5977) = v15;
    if (a3)
      phOsalNfc_MemCopy();
    v12 = 0;
    *(_QWORD *)(v14 + 16) = v10;
    *(_DWORD *)(v14 + 24) = a3 + 2;
    *(_DWORD *)(a1 + 4848 + 184 * v13 + 160) = a3 + 2;
  }
  else
  {
LABEL_6:
    v12 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_HciCoreBuildHcipacket");
  return v12;
}

uint64_t sub_21987F0A8(uint64_t a1)
{
  uint64_t v2;
  __int128 v3;
  uint64_t v4;
  uint64_t v6;
  int v7;
  uint64_t v8;
  _OWORD v9[3];

  sub_219850718(4, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildDnldPkt");
  v2 = *(_QWORD *)(a1 + 8496);
  if (v2)
  {
    v3 = *(_OWORD *)(v2 + 5648);
    v9[0] = *(_OWORD *)(v2 + 5632);
    v9[1] = v3;
    v9[2] = *(_OWORD *)(v2 + 5664);
    if (sub_2199057DC(a1, (int *)v9) || (v6 = *(_QWORD *)(a1 + 56)) == 0 || v6 == 0xFFFFFFFFFFFFLL)
    {
      sub_219850628(1, (unsigned int *)(v2 + 6476), 3u, 1u, (uint64_t)"phNciMuxNfc_BuildDnldPkt : Invalid Download Timer ID");
      v4 = 255;
    }
    else
    {
      if (*(_DWORD *)a1 == 192)
        v7 = 3000;
      else
        v7 = 1500;
      *(_DWORD *)(a1 + 84) = v7;
      sub_21988C4AC(*(_DWORD *)(a1 + 8492), v6);
      v8 = phOsalNfc_Timer_Start();
      if ((_DWORD)v8)
      {
        v4 = v8;
        sub_219850628(1, (unsigned int *)(v2 + 6476), 3u, 1u, (uint64_t)"phNciMuxNfc_BuildDnldPkt : Response Timer Start failed!!!");
      }
      else
      {
        *(_BYTE *)(v2 + 5952) = 1;
        sub_21988F804(*(_QWORD *)(v2 + 6480), 1);
        v4 = phTmlNfc_Write();
        if ((_DWORD)v4 == 13)
        {
          *(_DWORD *)(v2 + 5956) = 4;
        }
        else
        {
          *(_DWORD *)(v2 + 5752) = 0;
          sub_21988F804(*(_QWORD *)(v2 + 6480), 0);
          *(_BYTE *)(v2 + 5952) = 0;
          sub_21988C4AC(*(_DWORD *)(a1 + 8492), *(_QWORD *)(a1 + 56));
        }
      }
    }
  }
  else
  {
    v4 = 1;
  }
  sub_219850808(4, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildDnldPkt");
  return v4;
}

uint64_t sub_21987F258(uint64_t a1, unsigned int a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  char v9;
  uint64_t v10;
  uint64_t v11;
  const char *v12;
  uint64_t v13;
  int v14;
  BOOL v15;
  uint64_t v16;
  char v17;
  uint64_t v18;
  uint64_t v19;
  uint64_t v20;
  unsigned int v21;
  uint64_t v22;
  uint64_t v23;
  const char *v24;
  const char *v25;
  uint64_t v26;
  unsigned int v27;
  unsigned int v28;
  uint64_t v29;
  uint64_t v30;
  int v31;
  _BYTE *v32;
  int v33;
  unsigned int v34;
  int v35;
  unsigned int *v36;
  const char *v37;
  uint64_t v38;
  uint64_t v39;
  int v40;
  _DWORD *v41;
  unsigned int v42;
  uint64_t v43;
  int *v44;
  uint64_t v45;
  int v46;
  int *v47;
  const char *v48;
  __int16 v49;
  _QWORD v50[2];

  v49 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildHciNciPkt");
  if (!a1)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 4);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a1);
  if (v6 != a1)
  {
LABEL_6:
    v7 = 1;
    goto LABEL_7;
  }
  if (a2 == 2)
  {
    *(_BYTE *)(a1 + 6568) = 0;
    v50[0] = 0;
    v50[1] = 0;
    sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildCmdPktNci");
    v9 = 0;
    v10 = 0;
    do
    {
      v11 = *((_QWORD *)&unk_253E46700 + 14 * v10 + 4);
      if ((v9 & 1) != 0)
        break;
      v9 = 1;
      v10 = 1;
    }
    while (v11 != a1);
    if (v11 == a1)
    {
      if (*(_BYTE *)(a1 + 5390))
      {
        v7 = sub_2198AF020(a1 + 888, (_DWORD *)(a1 + 5216));
        sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Build Control packet returns");
        if (!(_DWORD)v7)
          *(_DWORD *)(a1 + 5384) -= *(_DWORD *)(a1 + 5240);
        goto LABEL_14;
      }
      phOsalNfc_MemCopy();
      LODWORD(v50[0]) = 2;
      v7 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)v50, *(_QWORD *)(a1 + 5360), *(_QWORD *)(a1 + 5368));
      if (!(_DWORD)v7)
      {
        v7 = sub_2198AF020(a1 + 888, (_DWORD *)(a1 + 5216));
        sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Build Control packet returns");
        if (!(_DWORD)v7)
        {
          v26 = *(_QWORD *)(a1 + 1872);
          if (v26 != 0xFFFFFFFFFFFFLL)
          {
            *(_DWORD *)(a1 + 1508) = 2000;
            v27 = *(unsigned __int8 *)(a1 + 16);
            if (*(_BYTE *)(a1 + 16))
            {
              v28 = *(_DWORD *)(a1 + 1480);
              if (v28 > v27)
                *(_DWORD *)(a1 + 1508) = 100 * (v28 / v27) + 2000;
            }
            sub_21988C4AC(*(_DWORD *)(a1 + 3356), v26);
            *(_BYTE *)(a1 + 6464) = 0;
            v29 = phOsalNfc_Timer_Start();
            if ((_DWORD)v29)
            {
              v7 = v29;
              *(_BYTE *)(a1 + 1880) = 0;
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Response Timer Start failed!!!");
              goto LABEL_14;
            }
            sub_219850628(1, (unsigned int *)(a1 + 3356), 3u, 4u, (uint64_t)"Response timer started");
            *(_BYTE *)(a1 + 1880) = 1;
            if (*(_DWORD *)(a1 + 3356))
              v47 = &dword_253E47158;
            else
              v47 = &dword_253E47070;
            v47[1] &= ~0x10u;
            phOsalNfc_MemCopy();
          }
          v7 = 0;
        }
      }
    }
    else
    {
      v7 = 255;
    }
LABEL_14:
    v12 = "phNciMuxNfc_BuildCmdPktNci";
LABEL_15:
    sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)v12);
    goto LABEL_36;
  }
  v13 = a1 + 4848;
  v14 = *(unsigned __int8 *)(a1 + 4848 + 184 * a2 + 12);
  if (sub_2198790D4((unsigned int *)a1, v14, (_BYTE *)&v49 + 1))
    v15 = 1;
  else
    v15 = HIBYTE(v49) == 0;
  if (!v15)
  {
    if (!a2)
    {
      v20 = a1;
      v21 = 0;
LABEL_35:
      v7 = sub_21987FB48(v20, v21, a1 + 4848 + 184 * a2);
      goto LABEL_36;
    }
    LOBYTE(v50[0]) = 0;
    sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildDataPktHci");
    v17 = 0;
    v18 = 0;
    do
    {
      v19 = *((_QWORD *)&unk_253E46700 + 14 * v18 + 4);
      if ((v17 & 1) != 0)
        break;
      v17 = 1;
      v18 = 1;
    }
    while (v19 != a1);
    if (v19 != a1)
    {
      v7 = 1;
LABEL_29:
      v12 = "phNciMuxNfc_BuildDataPktHci";
      goto LABEL_15;
    }
    v30 = v13 + 184 * a2;
    v33 = *(unsigned __int8 *)(v30 + 173);
    v32 = (_BYTE *)(v30 + 173);
    v31 = v33;
    v34 = *(_DWORD *)(v32 - 137);
    if (v34 > 0xFD)
    {
      if (!v31)
      {
        if (*(_BYTE *)(a1 + 6608))
        {
          sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciMuxNfc_BuildDataPktHci : Delay Applied");
          phOsalNfc_Delay();
        }
        v35 = sub_21987EF4C(a1, a2, 253, 0);
        *v32 = 1;
        *(_DWORD *)(v13 + 184 * a2 + 168) -= 253;
        if (*(_BYTE *)(a1 + 6568) != 1 || !sub_2198AFA2C(a1 + 888))
          goto LABEL_101;
        if (sub_21988F5D4(*(_QWORD *)(a1 + 6480), v50))
        {
          v36 = (unsigned int *)(a1 + 6476);
          v37 = "phNciMuxNfc_BuildDataPktHci2-Failed to retrieve bIgnoreWkUpRet";
          goto LABEL_100;
        }
        if (LOBYTE(v50[0]) == 1)
          goto LABEL_101;
        v48 = "phNciMuxNfc_BuildDataPktHci2-Failed to Assert Wake Up Line";
LABEL_114:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v48);
        v7 = 255;
        goto LABEL_29;
      }
    }
    else if (!v31)
    {
      v35 = sub_21987EF4C(a1, a2, v34, 1);
      *(_DWORD *)(v13 + 184 * a2 + 168) = 0;
      if (*(_BYTE *)(a1 + 6568) != 1 || !sub_2198AFA2C(a1 + 888))
        goto LABEL_101;
      if (sub_21988F5D4(*(_QWORD *)(a1 + 6480), v50))
      {
        v36 = (unsigned int *)(a1 + 6476);
        v37 = "phNciMuxNfc_BuildDataPktHci1-Failed to retrieve bIgnoreWkUpRet";
LABEL_100:
        sub_219850628(1, v36, 3u, 1u, (uint64_t)v37);
LABEL_101:
        sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildDataPktHci");
        if (v35)
        {
          v7 = 1;
          goto LABEL_69;
        }
        v20 = a1;
        v21 = a2;
        goto LABEL_35;
      }
      if (LOBYTE(v50[0]) == 1)
        goto LABEL_101;
      v48 = "phNciMuxNfc_BuildDataPktHci1-Failed to Assert Wake Up Line";
      goto LABEL_114;
    }
    if (*(_BYTE *)(a1 + 6608))
    {
      sub_219851790(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciMuxNfc_BuildDataPktHci : Delay Applied");
      phOsalNfc_Delay();
    }
    v39 = v13 + 184 * a2;
    v42 = *(_DWORD *)(v39 + 168);
    v41 = (_DWORD *)(v39 + 168);
    v40 = v42;
    if (v42 > 0xFE)
    {
      v35 = sub_21987EE1C(a1, a2, 254, 0);
      *v41 -= 254;
    }
    else
    {
      v35 = sub_21987EE1C(a1, a2, v40, 1);
      *v41 = 0;
    }
    goto LABEL_101;
  }
  v16 = sub_2198791FC(a1, v14, (uint64_t)sub_21985E760, a1);
  if (!(_DWORD)v16)
  {
    *(_BYTE *)(a1 + 6231) = a2;
    *(_BYTE *)(a1 + 6232) = v14;
    v7 = 13;
    goto LABEL_69;
  }
  v7 = v16;
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Conn Credits Registration failed!!");
LABEL_36:
  if ((_DWORD)v7 == 255)
  {
    if (*(_BYTE *)(a1 + 6568) != 1)
    {
LABEL_68:
      v7 = 255;
      goto LABEL_69;
    }
    if (sub_2198B00C4(*(_QWORD *)(a1 + 1520), 20))
    {
      if (sub_21988F5D4(*(_QWORD *)(a1 + 1520), &v49))
      {
        v24 = "phNciMuxNfc_BuildDataPktHci2-Failed to retrieve bIgnoreWkUpRet";
      }
      else
      {
        if ((_BYTE)v49)
          goto LABEL_67;
        v24 = "phNciMuxNfc_BuildHciNciPkt2-Fialed to De-Assert Wake Up Line";
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v24);
    }
LABEL_67:
    *(_BYTE *)(a1 + 6568) = 0;
    goto LABEL_68;
  }
  if (!(_DWORD)v7)
  {
    *(_BYTE *)(a1 + 3929) = 0;
    v22 = a1 + 184 * a2;
    *(_BYTE *)(a1 + 5952) = 1;
    sub_21988F804(*(_QWORD *)(a1 + 6480), 1);
    *(_BYTE *)(a1 + 6433) = 0;
    v23 = sub_2198AF660(a1 + 888, *(_DWORD *)(v22 + 4848));
    if ((_DWORD)v23 == 13)
    {
      *(_DWORD *)(a1 + 5956) = a2;
      if (a2 != 2)
      {
        sub_219879B28((unsigned int *)a1, *(unsigned __int8 *)(v22 + 4860));
        *(_BYTE *)(a1 + 6434) = *(_BYTE *)(v22 + 4860);
        *(_BYTE *)(a1 + 6433) = 1;
      }
      v7 = 13;
      goto LABEL_7;
    }
    v7 = v23;
    if (*(_BYTE *)(a1 + 6568) != 1 || !sub_2198B00C4(*(_QWORD *)(a1 + 1520), 20))
      goto LABEL_81;
    if (sub_21988F5D4(*(_QWORD *)(a1 + 1520), &v49))
    {
      v7 = 255;
      v25 = "phNciMuxNfc_BuildDataPktHci1-Failed to retrieve bIgnoreWkUpRet";
    }
    else
    {
      if ((_BYTE)v49)
      {
LABEL_81:
        *(_BYTE *)(a1 + 6568) = 0;
        v43 = *(_QWORD *)(a1 + 1872);
        if (v43 && v43 != 0xFFFFFFFFFFFFLL)
        {
          phOsalNfc_Timer_Stop();
          *(_BYTE *)(a1 + 6464) = 0;
          *(_BYTE *)(a1 + 1880) = 0;
          v44 = &dword_253E47158;
          if (!*(_DWORD *)(a1 + 3356))
            v44 = &dword_253E47070;
          v44[1] &= ~0x10u;
        }
        v45 = *(_QWORD *)(a1 + 3344);
        if (v45 && v45 != 0xFFFFFFFFFFFFLL)
        {
          if (phOsalNfc_Timer_Stop())
          {
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_CorePktSendToTml-Failed to Stop De-Assert Wake Up Line Timer");
            v7 = 255;
          }
          v46 = phOsalNfc_Timer_Delete();
          *(_QWORD *)(a1 + 3344) = 0xFFFFFFFFFFFFLL;
          if (v46)
          {
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_CorePktSendToTml-Failed to Delete De-Assert Wake Up Line Timer");
            v7 = 255;
          }
        }
        sub_21987FEF8((unsigned int *)a1);
        sub_21988F804(*(_QWORD *)(a1 + 6480), 0);
        *(_BYTE *)(a1 + 5952) = 0;
        goto LABEL_7;
      }
      v25 = "phNciMuxNfc_BuildHciNciPkt1-Failed to De-Assert Wake Up Line";
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v25);
    goto LABEL_81;
  }
LABEL_69:
  v38 = *(_QWORD *)(a1 + 1872);
  if (v38 && v38 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    *(_BYTE *)(a1 + 6464) = 0;
    *(_BYTE *)(a1 + 1880) = 0;
    if (*(_DWORD *)(a1 + 3356))
      dword_253E4715C &= ~0x10u;
    else
      dword_253E47074 &= ~0x10u;
  }
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildHciNciPkt");
  return v7;
}

uint64_t sub_21987FB48(uint64_t a1, unsigned int a2, uint64_t a3)
{
  uint64_t v6;
  char v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  unsigned __int8 v11;
  uint64_t v12;
  uint64_t v13;
  char v14;
  unsigned int v15;
  char v16;
  int v17;
  unsigned __int8 v18;
  int v19;
  int v20;
  uint64_t v21;
  const char *v22;
  uint64_t v24;
  int v25;
  int *v26;
  unsigned __int8 v27;

  v27 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildDataPktNci");
  v6 = 1;
  if (a1 && a3)
  {
    v7 = 0;
    v8 = 0;
    do
    {
      v9 = *((_QWORD *)&unk_253E46700 + 14 * v8 + 4);
      if ((v7 & 1) != 0)
        break;
      v7 = 1;
      v8 = 1;
    }
    while (v9 != a1);
    if (v9 != a1)
    {
      v6 = 1;
      goto LABEL_28;
    }
    phOsalNfc_MemCopy();
    v10 = a1 + 4848;
    if (!*(_BYTE *)(a1 + 4848 + 184 * a2 + 174))
    {
      v13 = *(_QWORD *)(a1 + 1872);
      if (v13 == 0xFFFFFFFFFFFFLL)
      {
        v6 = 1;
        goto LABEL_26;
      }
      v20 = *(_DWORD *)(v10 + 184 * a2 + 176);
      if (!v20)
        v20 = 2000;
      *(_DWORD *)(a1 + 1508) = v20;
      sub_21988C4AC(*(_DWORD *)(a1 + 3356), v13);
      *(_BYTE *)(a1 + 6464) = 0;
      v21 = phOsalNfc_Timer_Start();
      if ((_DWORD)v21)
      {
        v6 = v21;
        *(_BYTE *)(a1 + 1880) = 0;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Response Timer Start failed!!!");
        goto LABEL_26;
      }
      sub_219850628(1, (unsigned int *)(a1 + 3356), 3u, 4u, (uint64_t)"Response timer started");
      *(_BYTE *)(a1 + 1880) = 1;
      if (*(_DWORD *)(a1 + 3356))
        v26 = &dword_253E47158;
      else
        v26 = &dword_253E47070;
      v26[1] &= ~0x10u;
      phOsalNfc_MemCopy();
    }
    v11 = *(_BYTE *)(a3 + 12);
    v12 = sub_219879850(a1, v11, &v27);
    if ((_DWORD)v12)
    {
      v6 = v12;
LABEL_26:
      v22 = "Data Max Payload Length is not available !!!!!";
LABEL_27:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)v22);
      goto LABEL_28;
    }
    if (*(_DWORD *)(a3 + 24) && *(_QWORD *)(a3 + 16))
    {
      phOsalNfc_SetMemory();
      phOsalNfc_SetMemory();
      v14 = v11 & 0xF;
      v15 = *(_DWORD *)(v10 + 184 * a2 + 160);
      v16 = v11 & 0xF | 0x10;
      if (v15 <= v27)
        v17 = *(_DWORD *)(v10 + 184 * a2 + 160);
      else
        v17 = v27;
      if (v15 <= v27)
      {
        v18 = *(_DWORD *)(v10 + 184 * a2 + 160);
      }
      else
      {
        v14 = v16;
        v18 = v27;
      }
      *(_BYTE *)(a1 + 896) = v14;
      *(_BYTE *)(a1 + 898) = v18;
      phOsalNfc_MemCopy();
      *(_DWORD *)(a1 + 1160) = v17 + 3;
      sub_219851FF8(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Data packet:", a1 + 896);
      v19 = v18;
    }
    else
    {
      if (*(_BYTE *)(a1 + 3322) != 1)
      {
        v22 = "Invalid send payload buffer or length!";
        v6 = 1;
        goto LABEL_27;
      }
      *(_BYTE *)(a1 + 3322) = 0;
      phOsalNfc_SetMemory();
      *(_BYTE *)(a1 + 896) = *(_BYTE *)(a1 + 896) & 0x10 | v11 & 0xF;
      *(_BYTE *)(a1 + 898) = 0;
      *(_DWORD *)(a1 + 1160) = 3;
      sub_219851FF8(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Data packet:", a1 + 896);
      v19 = 0;
    }
    v24 = v10 + 184 * a2;
    v25 = *(_DWORD *)(v24 + 160) - v19;
    *(_DWORD *)(v24 + 160) = v25;
    v6 = 0;
    if (!a2)
      *(_DWORD *)(a1 + 5016) = v25;
  }
LABEL_28:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_BuildDataPktNci");
  return v6;
}

uint64_t sub_21987FEF8(unsigned int *a1)
{
  char v2;
  uint64_t v3;
  unsigned int *v4;
  uint64_t v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciMuxNfc_MuxTxPktReset");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    phOsalNfc_SetMemory();
    v5 = 0;
  }
  else
  {
LABEL_6:
    v5 = 1;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciMuxNfc_MuxTxPktReset");
  return v5;
}

uint64_t sub_21987FFD0(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;
  __int128 v9;
  uint64_t v10;
  uint64_t v11;
  _OWORD v12[3];

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_SendDnldEsePkt");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    v7 = *(_QWORD *)(a1 + 6584);
    v5 = 1;
    if (v7)
    {
      v8 = *(_QWORD *)(a1 + 6576);
      if (v8)
      {
        v9 = *(_OWORD *)(a1 + 5880);
        v12[0] = *(_OWORD *)(a1 + 5864);
        v12[1] = v9;
        v12[2] = *(_OWORD *)(a1 + 5896);
        v5 = sub_2199099E0(a1, (int *)v12);
        if (!(_DWORD)v5)
        {
          *(_BYTE *)(a1 + 5952) = 1;
          sub_21988F804(*(_QWORD *)(a1 + 6480), 1);
          v10 = phTmlNfc_Write();
          if ((_DWORD)v10 == 13)
          {
            if (!*(_DWORD *)(v7 + 744))
              --*(_BYTE *)(v7 + 29);
            *(_DWORD *)(a1 + 5956) = 5;
            v11 = *(_QWORD *)(v8 + 64);
            v5 = 13;
            if (v11 && v11 != 0xFFFFFFFFFFFFLL && !*(_BYTE *)(v8 + 80))
            {
              if (phOsalNfc_Timer_Start())
              {
                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciCoreMuxNfc_eMuxEvtDnldTxCb : Failed to create start timer");
                v5 = 255;
              }
              else
              {
                *(_BYTE *)(v8 + 80) = 1;
              }
            }
          }
          else
          {
            v5 = v10;
            *(_DWORD *)(a1 + 5936) = 0;
            sub_21988F804(*(_QWORD *)(a1 + 6480), 0);
            *(_BYTE *)(a1 + 5952) = 0;
            sub_21988C4AC(*(_DWORD *)(v7 + 1368), *(_QWORD *)(v7 + 48));
            *(_BYTE *)(v7 + 16) = 0;
            sub_21988C4AC(*(_DWORD *)(v7 + 1368), *(_QWORD *)(v7 + 56));
          }
        }
      }
    }
  }
  else
  {
LABEL_6:
    v5 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_SendDnldEsePkt");
  return v5;
}

uint64_t sub_2198801C4(unsigned int *a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  unsigned int *v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_TxCallback");
  if (a1 && a2)
  {
    v4 = 0;
    v5 = 0;
    do
    {
      v6 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v5 + 4);
      if ((v4 & 1) != 0)
        break;
      v4 = 1;
      v5 = 1;
    }
    while (v6 != a1);
    if (v6 == a1)
      sub_21987D1CC(a1, 1, a2);
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_TxCallback");
}

uint64_t sub_219880268(unsigned int *a1, uint64_t a2, int a3, uint64_t a4)
{
  unsigned int *v8;
  void (*v9)(uint64_t, uint64_t, uint64_t);
  uint64_t v10;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciMuxNfc_DnldInvokeUpperLayer");
  if (a1)
  {
    v8 = &a1[46 * a3];
    v9 = (void (*)(uint64_t, uint64_t, uint64_t))*((_QWORD *)v8 + 624);
    v10 = *((_QWORD *)v8 + 625);
    sub_21987FEF8(a1);
    if (v9)
      v9(v10, a4, a2);
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciMuxNfc_DnldInvokeUpperLayer");
  return a2;
}

uint64_t sub_219880318(uint64_t a1, uint64_t a2, unsigned int a3, uint64_t a4)
{
  uint64_t v8;
  uint64_t v9;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_DnldClearInvokeUpperLayer");
  if (a1)
  {
    *(_DWORD *)(a1 + 184 * a3 + 5012) = 0;
    if (a3 == 5)
    {
      v9 = *(_QWORD *)(a1 + 6584);
      if (v9)
      {
        *(_BYTE *)(a1 + 5954) = 0;
        *(_DWORD *)(v9 + 40) = 0;
        *(_DWORD *)(v9 + 376) = 0;
        phOsalNfc_SetMemory();
        *(_WORD *)(v9 + 382) = 0;
        goto LABEL_8;
      }
    }
    else if (a3 == 4)
    {
      v8 = *(_QWORD *)(a1 + 6576);
      if (v8)
      {
        *(_BYTE *)(a1 + 5953) = 0;
        *(_DWORD *)(v8 + 104) = 0;
        phOsalNfc_SetMemory();
        *(_WORD *)(v8 + 124) = 0;
LABEL_8:
        sub_219880268((unsigned int *)a1, a2, a3, a4);
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciMuxNfc_DnldClearInvokeUpperLayer");
}

uint64_t sub_219880418(unsigned int *a1, int a2)
{
  char v4;
  uint64_t v5;
  unsigned int *v6;
  uint64_t v7;
  unsigned __int8 v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciMuxNfc_FindMuxNextPktIndex");
  if (!a1)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v5 + 4);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a1);
  if (v6 == a1)
  {
    v8 = a2;
    while (1)
    {
      if ((v8 + 1) == 6)
        v8 = 0;
      else
        ++v8;
      if (LOBYTE(a1[46 * v8 + 1255]) == 1)
        break;
      if (a2 == v8)
      {
        v8 = 6;
        break;
      }
    }
    v7 = v8;
  }
  else
  {
LABEL_6:
    v7 = 6;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciMuxNfc_FindMuxNextPktIndex");
  return v7;
}

uint64_t sub_2198804FC(unsigned int *a1)
{
  char v2;
  uint64_t v3;
  unsigned int *v4;
  uint64_t v5;
  unsigned __int8 v6;
  uint64_t v7;
  uint64_t v8;
  unsigned int *v9;
  uint64_t v10;
  void (*v11)(uint64_t, _QWORD, uint64_t);
  int v12;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_ChkAbortMux");
  if (!a1)
    goto LABEL_17;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 != a1)
  {
LABEL_17:
    v7 = 255;
    goto LABEL_18;
  }
  v5 = 0;
  v6 = 0;
  do
  {
    v6 += LOBYTE(a1[v5 + 1255]);
    v5 += 46;
  }
  while (v5 != 276);
  if (v6 >= 2u)
  {
    v8 = 0;
    v9 = a1 + 1248;
    do
    {
      v11 = *(void (**)(uint64_t, _QWORD, uint64_t))v9;
      v10 = *((_QWORD *)v9 + 1);
      v12 = *((unsigned __int8 *)v9 + 30);
      sub_21987FEF8(a1);
      if (v12 == 1 && v11 != 0)
        v11(v10, 0, 255);
      v9 += 46;
      ++v8;
    }
    while (v8 != 6);
    goto LABEL_17;
  }
  v7 = 0;
LABEL_18:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciCoreMuxNfc_ChkAbortMux");
  return v7;
}

uint64_t sub_219880628(unsigned int *a1, unsigned __int8 *a2, int a3)
{
  const char *v6;
  int v7;
  int v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintDiscPayLoadDescription");
  v6 = "No NCI Discovery Configuration Details:";
  if (a2)
  {
    if (a3)
    {
      sub_219850628(2, a1, 3u, 4u, (uint64_t)"NCI Discovery Configuration Details:");
      v6 = "====================================================";
      sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
      v7 = *a2;
      sub_219851888(2, a1, 3u, 4u, (uint64_t)"Number of Configurations:");
      if (v7)
      {
        v8 = 1;
        do
        {
          sub_219851888(2, a1, 3u, 4u, (uint64_t)"RF Technology mode:");
          v8 += 2;
          sub_219851888(2, a1, 3u, 4u, (uint64_t)"Discover Frequency:");
          --v7;
        }
        while ((_BYTE)v7);
      }
    }
  }
  sub_219850628(2, a1, 3u, 4u, (uint64_t)v6);
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintDiscPayLoadDescription");
}

uint64_t sub_21988078C(unsigned int *a1, uint64_t a2)
{
  unsigned int v4;
  uint64_t v5;
  const char *v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintDiscNtfDescription");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"NCI Remote device Details:");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  sub_219851888(2, a1, 3u, 4u, (uint64_t)"Remote Device type:");
  sub_219851888(2, a1, 3u, 4u, (uint64_t)"Rf Discover ID:");
  sub_219851888(2, a1, 3u, 4u, (uint64_t)"Rf Protocol:");
  sub_219851888(2, a1, 3u, 4u, (uint64_t)"Rf Technology & mode:");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"Rf Technology Specific Details:");
  v4 = *(_DWORD *)(a2 + 20);
  if (v4 <= 0xC)
  {
    if (((1 << v4) & 0x1C09) == 0)
    {
      if (((1 << v4) & 0x24) != 0)
      {
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"SENSF Response length:");
        v5 = a2 + 57;
        v6 = "SENSF Response:";
      }
      else
      {
        if (v4 != 1)
          return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintDiscNtfDescription");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"SENSB Response length:");
        v5 = a2 + 99;
        v6 = "SENSB Response:";
      }
      sub_219851FF8(2, a1, 3u, 4u, (uint64_t)v6, v5);
      return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintDiscNtfDescription");
    }
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Sens Response Byte 1:");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Sens Response Byte 2:");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Uid length:");
    sub_219851FF8(2, a1, 3u, 4u, (uint64_t)"Uid:", a2 + 36);
    if (*(_BYTE *)(a2 + 103))
      sub_219851888(2, a1, 3u, 4u, (uint64_t)"Sel Resp:");
    else
      sub_219850628(2, a1, 3u, 4u, (uint64_t)"Sel Resp not present");
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintDiscNtfDescription");
}

uint64_t sub_219880A3C(unsigned int *a1, _BYTE *a2, unsigned int a3)
{
  const char *v6;
  const char *v7;
  unsigned int v8;
  unsigned __int8 v9;
  uint64_t v10;
  int v11;
  uint64_t v12;
  const char *v13;
  unsigned int *v14;
  const char *v15;
  _BYTE *v16;
  const char *v17;
  const char *v18;
  uint64_t v19;
  char v20;
  uint64_t v21;
  char v22;
  int v23;
  BOOL v24;
  uint64_t v25;
  char v26;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintGetConfigRespDescription");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"NCI Get Config Response Details:");
  v6 = "NCI Get Config Command contains Invalid parameters.                       Get config command needs to be sent again";
  if (*a2 == 10)
    v6 = "NCI Get Config Response partially received ";
  if (*a2)
    v7 = v6;
  else
    v7 = "NCI Get Config Response Completely received ";
  sub_219850628(2, a1, 3u, 4u, (uint64_t)v7);
  sub_219851888(2, a1, 3u, 4u, (uint64_t)"Number of Configs received:");
  if (a3 >= 3)
  {
    v8 = 2;
    v9 = 2;
    do
    {
      v10 = v9;
      v11 = a2[v9];
      if (v11 <= 127)
      {
        switch(v11)
        {
          case '(':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Poll NFC-DEP bitrate len:");
            v15 = "Poll NFC-DEP bitrate Value:";
            goto LABEL_62;
          case ')':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Poll NFC-DEP ATR-REQ Gen bytes len:");
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "ATR-REQ Gen bytes:";
            goto LABEL_60;
          case '*':
            v16 = &a2[v8];
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Poll ATR-REQ config len:");
            if ((~v16[2] & 0x30) != 0)
              v17 = "ATR_REQ - DID shall not be used ";
            else
              v17 = "ATR_REQ - DID may be used ";
            sub_219850628(2, a1, 3u, 4u, (uint64_t)v17);
            if ((v16[2] & 4) == 0)
              goto LABEL_64;
            v18 = "ATR_REQ - Length Reduction is applicable ";
            goto LABEL_50;
          case '+':
          case ',':
          case '-':
          case '.':
          case '/':
          case '4':
          case '5':
          case '6':
          case '7':
          case ';':
          case '=':
          case '>':
          case '?':
          case 'D':
          case 'E':
          case 'F':
          case 'G':
          case 'H':
          case 'I':
          case 'J':
          case 'K':
          case 'L':
          case 'M':
          case 'N':
          case 'O':
          case 'U':
          case 'V':
          case 'W':
          case '\\':
          case ']':
          case '^':
          case '_':
            goto LABEL_64;
          case '0':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen A Bitframe SDD len:");
            v15 = "Listen A Bitframe SDD Value:";
            goto LABEL_62;
          case '1':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen A Platform config len:");
            v15 = "Listen A Platform config Value:";
            goto LABEL_62;
          case '2':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen A Select info len:");
            v19 = v8 + 2;
            v20 = a2[v19];
            if ((v20 & 0x20) != 0)
            {
              sub_219850628(2, a1, 3u, 4u, (uint64_t)"SEL INFO - ISO-DEP protocol is supported ");
              v20 = a2[v19];
            }
            if ((v20 & 0x40) == 0)
              goto LABEL_64;
            v18 = "SEL INFO - NFC-DEP protocol is supported ";
            goto LABEL_50;
          case '3':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen A NFCID1 len:");
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "Listen A NFCID1 :";
            goto LABEL_60;
          case '8':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen B SENSB info len:");
            if ((a2[v8 + 2] & 1) == 0)
              goto LABEL_64;
            v18 = "SENSB INFO - ISO-DEP protocol is supported ";
            goto LABEL_50;
          case '9':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen B NFCID0 len:");
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "Listen B NFCID0 :";
            goto LABEL_60;
          case ':':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen B App Data len:");
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "Listen B App Data :";
            goto LABEL_60;
          case '<':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen B ADC-FO len:");
            if ((a2[v8 + 2] & 1) != 0)
              sub_219850628(2, a1, 3u, 4u, (uint64_t)"ADC-FO - DID may be used");
            v15 = "ADC-FO, ADC value is";
            goto LABEL_62;
          case '@':
          case 'A':
          case 'B':
          case 'C':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen F Id len:");
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "Listen F Id:";
            goto LABEL_60;
          case 'P':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen F protocol type len:");
            v15 = "Listen F protocol type Value:";
            goto LABEL_62;
          case 'Q':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen F T3T PMM len:");
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "Listen F T3T PMM :";
            goto LABEL_60;
          case 'R':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen F T3T MAX len:");
            v15 = "Listen F T3T MAX Value:";
            goto LABEL_62;
          case 'S':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen F T3T Flag len:");
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen F T3T Flag Value lower byte:");
            v15 = "Listen F T3T Flag Value upper byte:";
            goto LABEL_62;
          case 'T':
            v21 = v8 + 1;
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen F bitrate len:");
            v22 = a2[v21];
            if ((v22 & 2) != 0)
            {
              sub_219850628(2, a1, 3u, 4u, (uint64_t)"Listen F bitrate:212kbps");
              v22 = a2[v21];
            }
            if ((v22 & 4) == 0)
              goto LABEL_64;
            v18 = "Listen F bitrate:424kbps";
LABEL_50:
            sub_219850628(2, a1, 3u, 4u, (uint64_t)v18);
            goto LABEL_64;
          case 'X':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Frame waiting time len:");
            v15 = "Frame waiting time Value:";
            goto LABEL_62;
          case 'Y':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen ISO-DEP Hist bytes len:");
            if (!a2[v8 + 1])
              goto LABEL_64;
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "Listen ISO-DEP Hist bytes :";
            goto LABEL_60;
          case 'Z':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen ISO-DEP INFO RESP len:");
            if (!a2[v8 + 1])
              goto LABEL_64;
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "Listen ISO-DEP INFO RESP:";
            goto LABEL_60;
          case '[':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen ISO-DEP bitrate len:");
            v15 = "Listen ISO-DEP bitrate Value:";
            goto LABEL_62;
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen NFC-DEP waiting time len:");
            v15 = "Listen NFC-DEP waiting time Value:";
            goto LABEL_62;
          case 'a':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen NFC-DEP ATR-RES Gen bytes len:");
            if (!a2[v8 + 1])
              goto LABEL_64;
            v12 = (uint64_t)&a2[v8 + 2];
            v13 = "Listen NFC-DEP ATR-RES Gen bytes:";
LABEL_60:
            sub_219851FF8(2, a1, 3u, 4u, (uint64_t)v13, v12);
            goto LABEL_64;
          case 'b':
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Listen NFC-DEP ATR-RES Config len:");
            v15 = "Listen NFC-DEP ATR-RES Config Value:";
LABEL_62:
            v14 = a1;
            goto LABEL_63;
          default:
            if (v11)
            {
              if (v11 != 24)
                goto LABEL_64;
              sub_219851888(2, a1, 3u, 4u, (uint64_t)"Poll F bitrate len:");
              v14 = a1;
              v15 = "Poll F bitrate Value:";
            }
            else
            {
              sub_219851888(2, a1, 3u, 4u, (uint64_t)"Common params Total duration len:");
              sub_219851888(2, a1, 3u, 4u, (uint64_t)"Common params Total duration Value byte 1:");
              v14 = a1;
              v15 = "Common params Total duration Value byte 2:";
            }
            break;
        }
        goto LABEL_63;
      }
      if (v11 > 159)
      {
        if (v11 == 160)
        {
          if (a2[v8 + 1] != 3)
            goto LABEL_64;
          sub_219851888(2, a1, 3u, 4u, (uint64_t)"Nfc prop Clk config len:");
          v14 = a1;
          v15 = "Nfc prop Clk config Value:";
          goto LABEL_63;
        }
        if (v11 == 161)
        {
          v14 = a1;
          v15 = "Nfc prop ID2 Unknown Tag Value:";
          goto LABEL_63;
        }
      }
      else
      {
        if (v11 == 128)
        {
          sub_219851888(2, a1, 3u, 4u, (uint64_t)"RF Field Info len:");
          v14 = a1;
          v15 = "RF Field Info Value:";
          goto LABEL_63;
        }
        if (v11 == 129)
        {
          sub_219851888(2, a1, 3u, 4u, (uint64_t)"RF NFCEE Action len:");
          v14 = a1;
          v15 = "RF NFCEE Action Value:";
LABEL_63:
          sub_219851888(2, v14, 3u, 4u, (uint64_t)v15);
        }
      }
LABEL_64:
      v23 = a2[v10] & 0xFE;
      v24 = v23 == 160;
      if (v23 == 160)
        v25 = 2;
      else
        v25 = 1;
      if (v24)
        v26 = 3;
      else
        v26 = 2;
      v9 = a2[v25 + v8] + v10 + v26;
      v8 = v9;
    }
    while (v9 < a3);
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintGetConfigRespDescription");
}

uint64_t sub_2198813E0(unsigned int *a1, _BYTE *a2)
{
  const char *v4;
  const char *v5;
  const char *v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintResetRespDescription");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"Reset Response:");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  if (*a2)
    v4 = "Reset status: FAILED";
  else
    v4 = "Reset status: SUCCESS";
  sub_219850628(2, a1, 3u, 4u, (uint64_t)v4);
  sub_219851888(2, a1, 3u, 4u, (uint64_t)"Nci Version supported by NFCC:");
  v5 = "Configuration status: Invalid";
  if (a2[2] == 1)
    v5 = "Configuration status: NCI RF Configuration has been reset";
  if (a2[2])
    v6 = v5;
  else
    v6 = "Configuration status: NCI RF Configuration has been kept";
  sub_219850628(2, a1, 3u, 4u, (uint64_t)v6);
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintResetRespDescription");
}

uint64_t sub_219881520(unsigned int *a1, uint64_t a2, int a3)
{
  const char *v6;
  const char *v7;
  const char *v8;
  const char *v9;
  const char *v10;
  const char *v11;
  const char *v12;
  const char *v13;
  unint64_t v14;
  uint64_t v15;
  unsigned int v16;
  const char *v17;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintInitRespDescription");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"Init Response:");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  if (a3 == 255)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"Init status: FAILED");
  }
  else
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"Init status: SUCCESS");
    if ((*(_BYTE *)a2 & 1) != 0)
      v6 = "Discovery Frequency configuration: Supported";
    else
      v6 = "Discovery Frequency configuration: Not supported";
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v6);
    v7 = "Discovery Configuration Mode: Invalid";
    if ((*(_BYTE *)a2 & 6) == 2)
      v7 = "Discovery Configuration Mode: NFCC can receive configurations from the DH and other NFCEEs";
    if ((*(_BYTE *)a2 & 6) != 0)
      v8 = v7;
    else
      v8 = "Discovery Configuration Mode: DH is the only entity that configures the NFCC";
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v8);
    if ((*(_BYTE *)(a2 + 1) & 2) != 0)
      v9 = "Technology based Routing: Supported";
    else
      v9 = "Technology based Routing: Not supported";
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v9);
    if ((*(_BYTE *)(a2 + 1) & 4) != 0)
      v10 = "Protocol based routing: Supported";
    else
      v10 = "Protocol based routing: Not supported";
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v10);
    if ((*(_BYTE *)(a2 + 1) & 8) != 0)
      v11 = "AID based routing: Supported";
    else
      v11 = "AID based routing: Not supported";
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v11);
    if ((*(_BYTE *)(a2 + 2) & 1) != 0)
      v12 = "Battery Off state: Supported";
    else
      v12 = "Battery Off state: Not supported";
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v12);
    if ((*(_BYTE *)(a2 + 2) & 2) != 0)
      v13 = "Switched Off state: Supported";
    else
      v13 = "Switched Off state: Not supported";
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v13);
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Number of Rf intf's supported:");
    if (*(_BYTE *)(a2 + 4))
    {
      v14 = 0;
      v15 = a2 + 5;
      do
      {
        v16 = *(unsigned __int8 *)(v15 + v14);
        if (v16 > 0x7F)
        {
          switch(v16)
          {
            case 0x80u:
              v17 = "Rf interfaces supported: TAG-CMD Rf interface";
              break;
            case 0x81u:
              v17 = "Rf interfaces supported: HID Rf interface";
              break;
            case 0x83u:
              v17 = "Rf interfaces supported: NFCEE DEP RF interface";
              break;
            default:
LABEL_39:
              v17 = "Rf interfaces supported: Invalid";
              break;
          }
        }
        else
        {
          v17 = "Rf interfaces supported: Nfcee direct Rf interface";
          switch(*(_BYTE *)(v15 + v14))
          {
            case 0:
              break;
            case 1:
              v17 = "Rf interfaces supported: Frame Rf interface";
              break;
            case 2:
              v17 = "Rf interfaces supported: ISO-DEP Rf interface";
              break;
            case 3:
              v17 = "Rf interfaces supported: NFC-DEP Rf interface";
              break;
            default:
              goto LABEL_39;
          }
        }
        sub_219850628(2, a1, 3u, 4u, (uint64_t)v17);
        ++v14;
      }
      while (v14 < *(unsigned __int8 *)(a2 + 4));
    }
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Max number of logical conn's supported:");
    if (*(_WORD *)(a2 + 14))
    {
      sub_219850628(2, a1, 3u, 4u, (uint64_t)"Listen mode routing: Supported");
      sub_219851888(2, a1, 3u, 4u, (uint64_t)"Max Routing Table size:");
    }
    else
    {
      sub_219850628(2, a1, 3u, 4u, (uint64_t)"Listen mode routing: Not supported");
    }
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Max Control packet payload size:");
    if (*(_BYTE *)(a2 + 20))
    {
      sub_219851888(2, a1, 3u, 4u, (uint64_t)"Manufacturer ID:");
      sub_219851888(2, a1, 3u, 4u, (uint64_t)"Manufacturer specific info - Byte0:");
      sub_219851888(2, a1, 3u, 4u, (uint64_t)"Manufacturer specific info - Byte1:");
      sub_219851888(2, a1, 3u, 4u, (uint64_t)"Manufacturer specific info - Byte2:");
      sub_219851888(2, a1, 3u, 4u, (uint64_t)"Manufacturer specific info - Byte3:");
    }
    else
    {
      sub_219850628(2, a1, 3u, 4u, (uint64_t)"Manufacturer ID: Not available");
    }
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Build Number:");
  }
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintInitRespDescription");
}

uint64_t sub_219881A20(unsigned int *a1, _BYTE *a2)
{
  unint64_t v4;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintSetConfigRespDescription");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"Set Config Response:");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  if (*a2)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"Set Config: FAILED");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Num of parameter failed to set:");
    if (a2[1])
    {
      v4 = 0;
      do
      {
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Parameter ID:");
        ++v4;
      }
      while (v4 < a2[1]);
    }
  }
  else
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"Set Config: SUCCESS");
  }
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintSetConfigRespDescription");
}

uint64_t sub_219881B80(unsigned int *a1, unsigned __int8 *a2, int a3)
{
  const char *v6;
  unint64_t v7;
  uint64_t v8;
  int v9;
  unsigned int *v10;
  const char *v11;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintGetRtngTableRespDescription");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"Get Lstn mode Rtng Response:");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  sub_219851888(2, a1, 3u, 4u, (uint64_t)"Number of Rtng configs:");
  if (!a3)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"Get Lstn Rtng Table: SUCCESS");
    if (!*a2)
    {
      v6 = "No routing entries";
      goto LABEL_3;
    }
    v7 = 0;
    v8 = *((_QWORD *)a2 + 1) + 8;
    while (1)
    {
      v9 = *(_DWORD *)(v8 - 8);
      if (v9 == 2)
        break;
      if (v9 == 1)
      {
        sub_219850628(2, a1, 3u, 4u, (uint64_t)"----------Protocol based routing----------");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Route                    :");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Power State - Switch ON  :");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Power State - Switch OFF :");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Power State - Battery OFF:");
        v10 = a1;
        v11 = "Protocol                 :";
        goto LABEL_12;
      }
      if (!v9)
      {
        sub_219850628(2, a1, 3u, 4u, (uint64_t)"----------Technology based routing----------");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Route                    :");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Power State - Switch ON  :");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Power State - Switch OFF :");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"Power State - Battery OFF:");
        v10 = a1;
        v11 = "Technology               :";
LABEL_12:
        sub_219851888(2, v10, 3u, 4u, (uint64_t)v11);
      }
      ++v7;
      v8 += 32;
      if (v7 >= *a2)
        goto LABEL_14;
    }
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"----------Aid based routing----------");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Route                    :");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Power State - Switch ON  :");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Power State - Switch OFF :");
    v10 = a1;
    v11 = "Power State - Battery OFF:";
    goto LABEL_12;
  }
  v6 = "Get Lstn Rtng Table: FAILED";
LABEL_3:
  sub_219850628(2, a1, 3u, 4u, (uint64_t)v6);
LABEL_14:
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintGetRtngTableRespDescription");
}

uint64_t sub_219881F28(unsigned int *a1, _BYTE *a2)
{
  char v4;
  unsigned int i;
  uint64_t v6;
  _BYTE *v7;
  unsigned int *v8;
  const char *v9;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintNfceeDiscreqNtfDescription");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  if (a2)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"RF_NFCEE_DISCOVERY_REQ_NTF Payload Contents:");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Number of Information Entries");
    if (*a2)
    {
      v4 = 0;
      for (i = 0; i < *a2; ++i)
      {
        v6 = (v4 + 1);
        if (a2[v6] == 1)
        {
          sub_219850628(2, a1, 3u, 4u, (uint64_t)"Request is to remove following discovery");
          v6 = (v4 + 2);
          if (a2[v6] != 3)
          {
LABEL_11:
            v7 = &a2[v6 + 1];
            v8 = a1;
            v9 = "Invalid length of value! length and value is:";
            goto LABEL_12;
          }
        }
        else
        {
          if (a2[v6])
          {
            sub_219851888(2, a1, 3u, 4u, (uint64_t)"Invalid or Proprietary TLV Type! It is");
            v7 = &a2[v6 + 1];
            v8 = a1;
            v9 = "Length and Value is:";
LABEL_12:
            sub_219851FF8(2, v8, 3u, 4u, (uint64_t)v9, (uint64_t)v7);
            v4 = *v7 + v6;
            continue;
          }
          sub_219850628(2, a1, 3u, 4u, (uint64_t)"Request is to add following discovery");
          v6 = (v4 + 2);
          if (a2[v6] != 3)
            goto LABEL_11;
        }
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"NFCEE ID               ");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"RF Technology and Mode ");
        v4 = v6 + 3;
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"RF Protocol            ");
      }
    }
  }
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"====================================================");
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintNfceeDiscreqNtfDescription");
}

uint64_t sub_2198821EC(unsigned int *a1, int a2)
{
  const char *v4;
  unsigned int *v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfInterfaceDescription");
  if (a2 > 127)
  {
    switch(a2)
    {
      case 128:
        v4 = "RF Interface: Tag-Cmd RF Interface";
        v5 = a1;
        break;
      case 129:
        v4 = "RF Interface: Hid RF Interface";
        v5 = a1;
        break;
      case 131:
        v4 = "Rf interfaces: NFCEE DEP RF interface";
        v5 = a1;
        break;
      default:
LABEL_12:
        v4 = "RF Interface: Unknown Type RF Interface";
        v5 = a1;
        break;
    }
  }
  else
  {
    switch(a2)
    {
      case 0:
        v4 = "RF Interface: NFCEE Direct RF Interface";
        v5 = a1;
        break;
      case 1:
        v4 = "RF Interface: Frame RF Interface";
        v5 = a1;
        break;
      case 2:
        v4 = "RF Interface: ISO-DEP RF Interface";
        v5 = a1;
        break;
      case 3:
        v4 = "RF Interface: NFC-DEP RF Interface";
        v5 = a1;
        break;
      default:
        goto LABEL_12;
    }
  }
  sub_219851888(2, v5, 3u, 4u, (uint64_t)v4);
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfInterfaceDescription");
}

uint64_t sub_219882384(unsigned int *a1, int a2)
{
  const char *v4;
  unsigned int *v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfRfProtocolDescription");
  if (a2 > 127)
  {
    if (a2 > 129)
    {
      if (a2 == 130)
      {
        v4 = "RF Protocol:PROTOCOL_NFC_EPCGEN2";
        v5 = a1;
      }
      else if (a2 == 138)
      {
        v4 = "RF Protocol:PROTOCOL_NFC_KOVIO";
        v5 = a1;
      }
      else
      {
LABEL_19:
        v4 = "RF Protocol: RFU or Proprietry";
        v5 = a1;
      }
    }
    else
    {
      if (a2 == 128)
        v4 = "RF Protocol:PROTOCOL_NFC_MIFCLASSIC";
      else
        v4 = "RF Protocol:PROTOCOL_NFC_HID";
      v5 = a1;
    }
  }
  else
  {
    switch(a2)
    {
      case 0:
        v4 = "RF Protocol:Unknown";
        v5 = a1;
        break;
      case 1:
        v4 = "RF Protocol:PROTOCOL_T1T";
        v5 = a1;
        break;
      case 2:
        v4 = "RF Protocol:PROTOCOL_T2T";
        v5 = a1;
        break;
      case 3:
        v4 = "RF Protocol:PROTOCOL_T3T";
        v5 = a1;
        break;
      case 4:
        v4 = "RF Protocol:PROTOCOL_ISO_DEP";
        v5 = a1;
        break;
      case 5:
        v4 = "RF Protocol:PROTOCOL_NFC_DEP";
        v5 = a1;
        break;
      case 6:
        v4 = "RF Protocol:PROTOCOL_NFC_15693";
        v5 = a1;
        break;
      default:
        goto LABEL_19;
    }
  }
  sub_219851888(2, v5, 3u, 4u, (uint64_t)v4);
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfRfProtocolDescription");
}

uint64_t sub_2198825AC(unsigned int *a1, int a2)
{
  const char *v4;
  unsigned int *v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfTechModeDescription");
  if (a2 > 112)
  {
    switch(a2)
    {
      case 128:
        v4 = "RF Tech and Mode:NFC_A_PASSIVE_LISTEN_MODE";
        v5 = a1;
        break;
      case 129:
        v4 = "RF Tech and Mode:NFC_B_PASSIVE_LISTEN_MODE";
        v5 = a1;
        break;
      case 130:
        v4 = "RF Tech and Mode:NFC_F_ACTIVE_LISTEN_MODE";
        v5 = a1;
        break;
      case 131:
        v4 = "RF Tech and Mode:NFC_A_ACTIVE_LISTEN_MODE";
        v5 = a1;
        break;
      case 132:
        goto LABEL_15;
      case 133:
        v4 = "RF Tech and Mode:NFC_F_ACTIVE_LISTEN_MODE";
        v5 = a1;
        break;
      default:
        if (a2 == 113)
        {
          v4 = "RF Tech and Mode:NFC_HID_PASSIVE_POLL_MODE";
          v5 = a1;
        }
        else if (a2 == 114)
        {
          v4 = "RF Tech and Mode:NFC_EPCGEN2_PASSIVE_POLL_MODE";
          v5 = a1;
        }
        else
        {
LABEL_15:
          v4 = "RF Tech and Mode: RFU or Proprietry";
          v5 = a1;
        }
        break;
    }
  }
  else
  {
    switch(a2)
    {
      case 0:
        v4 = "RF Tech and Mode:NFC_A_PASSIVE_POLL_MODE";
        v5 = a1;
        break;
      case 1:
        v4 = "RF Tech and Mode:NFC_B_PASSIVE_POLL_MODE";
        v5 = a1;
        break;
      case 2:
        v4 = "RF Tech and Mode:NFC_F_PASSIVE_POLL_MODE";
        v5 = a1;
        break;
      case 3:
        v4 = "RF Tech and Mode:NFC_A_ACTIVE_POLL_MODE";
        v5 = a1;
        break;
      case 4:
      case 7:
      case 8:
      case 9:
        goto LABEL_15;
      case 5:
        v4 = "RF Tech and Mode:NFC_F_ACTIVE_POLL_MODE";
        v5 = a1;
        break;
      case 6:
        v4 = "RF Tech and Mode:NFC_ISO15693_PASSIVE_POLL_MODE";
        v5 = a1;
        break;
      case 10:
        v4 = "RF Tech and Mode:NFC_A_SILENT_NTAG_PASSIVE_POLL_MODE";
        v5 = a1;
        break;
      case 11:
        v4 = "RF Tech and Mode:NFC_A_SILENT_TAG1_PASSIVE_POLL_MODE";
        v5 = a1;
        break;
      case 12:
        v4 = "RF Tech and Mode:NFC_A_SILENT_TAG2_PASSIVE_POLL_MODE";
        v5 = a1;
        break;
      default:
        if (a2 != 112)
          goto LABEL_15;
        v4 = "RF Tech and Mode:NFC_KOVIO_PASSIVE_POLL_MODE";
        v5 = a1;
        break;
    }
  }
  sub_219851888(2, v5, 3u, 4u, (uint64_t)v4);
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfTechModeDescription");
}

uint64_t sub_2198828A8(unsigned int *a1, uint64_t a2)
{
  int v4;
  const char *v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcASpcfcParamsDescription");
  if (a2)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC A POLL Techn Specific Params - START");
    v4 = *(_DWORD *)(a2 + 4);
    if ((v4 - 5) < 7 || v4 == 14 || v4 == 3)
    {
      if (!*(_BYTE *)(a2 + 26))
      {
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"SENS_RES Byte 1");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"SENS_RES Byte 2");
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"NFCID1 Length");
        if (*(unsigned __int8 *)(a2 + 46) >= 0xBu)
        {
          *(_BYTE *)(a2 + 46) = 10;
          sub_219850628(2, a1, 3u, 2u, (uint64_t)"Uid Length is greater than 10(0x0A) byte so only 10 bytes will be printed");
        }
        sub_219851FF8(2, a1, 3u, 4u, (uint64_t)"UID", a2 + 36);
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"SEL Response Length");
        if (*(_BYTE *)(a2 + 103))
          sub_219851888(2, a1, 3u, 4u, (uint64_t)"SEL Response");
        goto LABEL_17;
      }
      v8 = "No Techn specific params available";
    }
    else
    {
      v8 = "No Dbg Info added for this Remote Device Type";
    }
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v8);
LABEL_17:
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC A POLL Techn Specific Params - END");
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcASpcfcParamsDescription");
}

uint64_t sub_219882A8C(unsigned int *a1, uint64_t a2)
{
  const char *v4;
  int v6;
  const char *v7;
  const char *v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcFSpcfcParamsDescription");
  if (a2)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC F POLL Techn Specific Params - Start");
    if (*(_DWORD *)(a2 + 4) == 18)
    {
      if (!*(_BYTE *)(a2 + 26))
      {
        sub_219851888(2, a1, 3u, 4u, (uint64_t)"SensF Resp Length");
        sub_219850628(2, a1, 3u, 4u, (uint64_t)"BitRate");
        v6 = *(unsigned __int8 *)(a2 + 55);
        v7 = "UnSupported BitRate!!";
        if (v6 == 2)
          v7 = "424 kbps";
        if (v6 == 1)
          v8 = "212 kbps";
        else
          v8 = v7;
        sub_219850628(2, a1, 3u, 4u, (uint64_t)v8);
        if (*(_BYTE *)(a2 + 56))
        {
          sub_219850628(2, a1, 3u, 4u, (uint64_t)"SensF Response:");
          sub_219851FF8(2, a1, 3u, 4u, (uint64_t)"IDm ", a2 + 57);
          sub_219851FF8(2, a1, 3u, 4u, (uint64_t)"PMm ", a2 + 65);
        }
        goto LABEL_7;
      }
      v4 = "No Techn specific params available";
    }
    else
    {
      v4 = "No Dbg Info added for this Remote Device Type";
    }
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v4);
LABEL_7:
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC F POLL Techn Specific Params - END");
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcFSpcfcParamsDescription");
}

uint64_t sub_219882C44(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcBSpcfcParamsDescription");
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC B POLL Techn Specific Params - END");
  sub_219851888(2, a1, 3u, 4u, (uint64_t)"SensB Resp Length");
  if (*(_BYTE *)(a2 + 62))
    sub_219851FF8(2, a1, 3u, 4u, (uint64_t)"SensB Response:", a2 + 63);
  sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC B POLL Techn Specific Params - END");
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcBSpcfcParamsDescription");
}

uint64_t sub_219882D18(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcALstnSpcfcParams");
  if (a2)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC A LISTEN Techn Specific Params - START");
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"No Dbg Info for this Remote Device Type");
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC A LISTEN Techn Specific Params - END");
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcALstnSpcfcParams");
}

uint64_t sub_219882DC4(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcFLstnSpcfcParams");
  if (a2)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC F LISTEN Techn Specific Params - START");
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"No Dbg Info added for this Remote Device Type");
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"NFC F LISTEN Techn Specific Params - END");
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintTechNfcFLstnSpcfcParams");
}

uint64_t sub_219882E70(unsigned int *a1, int a2)
{
  const char *v4;
  unsigned int *v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintNfceeProtocolDescription");
  switch(a2)
  {
    case 0:
      v4 = "NFCEE Interface/Protocol: NFCEE APDU";
      v5 = a1;
      break;
    case 1:
      v4 = "NFCEE Interface/Protocol: NFCEE APDU";
      v5 = a1;
      break;
    case 2:
      v4 = "NFCEE Interface/Protocol: NFCEE APDU";
      v5 = a1;
      break;
    case 3:
      v4 = "NFCEE Interface/Protocol: NFCEE APDU";
      v5 = a1;
      break;
    default:
      v4 = "NFCEE Interface/Protocol: UNKNOWN";
      v5 = a1;
      break;
  }
  sub_219851888(2, v5, 3u, 4u, (uint64_t)v4);
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintNfceeProtocolDescription");
}

uint64_t sub_219882F88(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  const char *v5;
  unint64_t v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintfNfceeDiscNtfDescription");
  if (a2)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"**********************NFCEE Discovery Notification*************************");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Nfcee Discovery Id");
    v4 = *(int *)(a2 + 4);
    if (v4 > 2)
      v5 = "Nfcee status INVALID";
    else
      v5 = off_24DB72268[v4];
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v5);
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Number of supported protocols are");
    if (*(_BYTE *)(a2 + 8))
    {
      sub_219850628(2, a1, 3u, 4u, (uint64_t)"Supported protocols are\n");
      if (*(_BYTE *)(a2 + 8))
      {
        v6 = 0;
        do
          sub_219882E70(a1, *(unsigned __int8 *)(a2 + 9 + v6++));
        while (v6 < *(unsigned __int8 *)(a2 + 8));
      }
    }
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Number of TLVs are");
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintfNfceeDiscNtfDescription");
}

uint64_t sub_2198830EC(unsigned int *a1, uint64_t a2)
{
  int v4;
  const char *v5;
  __int128 v6;
  __int128 v7;
  __int128 v8;
  _OWORD v10[5];
  _OWORD v11[2];
  uint64_t v12;

  v12 = *MEMORY[0x24BDAC8D0];
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfDevActNtfDescription");
  if (a2)
  {
    sub_219850628(2, a1, 3u, 4u, (uint64_t)"*************************Activation Notification*************************");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Discovery Id");
    sub_2198821EC(a1, *(_DWORD *)(a2 + 12));
    sub_219882384(a1, *(_DWORD *)(a2 + 16));
    sub_2198825AC(a1, *(_DWORD *)(a2 + 20));
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Max Packet Size");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"Initial Credits");
    sub_219851888(2, a1, 3u, 4u, (uint64_t)"RF Techn specific params length ");
    v4 = *(_DWORD *)(a2 + 20);
    if (v4 > 112)
    {
      switch(v4)
      {
        case 128:
        case 131:
          sub_219882D18(a1, a2);
          break;
        case 129:
          goto LABEL_12;
        case 130:
        case 133:
          sub_219882DC4(a1, a2);
          break;
        case 132:
          goto LABEL_17;
        default:
          if (v4 == 113 || v4 == 114)
            goto LABEL_12;
          goto LABEL_17;
      }
      goto LABEL_19;
    }
    if (v4 <= 0xC)
    {
      if (((1 << v4) & 0x1C09) != 0)
      {
        sub_2198828A8(a1, a2);
LABEL_19:
        sub_219850628(2, a1, 3u, 4u, (uint64_t)"**************************************************************************");
        return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfDevActNtfDescription");
      }
      if (((1 << v4) & 0x24) != 0)
      {
        sub_219882A8C(a1, a2);
        goto LABEL_19;
      }
      if (v4 == 1)
      {
        v6 = *(_OWORD *)(a2 + 84);
        v7 = *(_OWORD *)(a2 + 116);
        v10[4] = *(_OWORD *)(a2 + 100);
        v11[0] = v7;
        *(_OWORD *)((char *)v11 + 14) = *(_OWORD *)(a2 + 130);
        v8 = *(_OWORD *)(a2 + 52);
        v10[0] = *(_OWORD *)(a2 + 36);
        v10[1] = v8;
        v10[2] = *(_OWORD *)(a2 + 68);
        v10[3] = v6;
        sub_219882C44(a1, (uint64_t)v10);
        goto LABEL_19;
      }
    }
    if (v4 == 112)
LABEL_12:
      v5 = "No Debugging info provided for Techn specific params";
    else
LABEL_17:
      v5 = "Invalid Rf Techn and mode";
    sub_219850628(2, a1, 3u, 4u, (uint64_t)v5);
    goto LABEL_19;
  }
  return sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_PrintRfDevActNtfDescription");
}

uint64_t sub_219883374(uint64_t a1)
{
  uint64_t v2;
  _OWORD v4[10];
  __int128 v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  __int128 v9;
  __int128 v10;

  v9 = 0u;
  v10 = 0u;
  v7 = 0;
  v8 = 0;
  v6 = 0;
  v5 = 0u;
  memset(v4, 0, sizeof(v4));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_InitReset");
  if (a1)
  {
    if (*(_BYTE *)(a1 + 41) != 1)
    {
      BYTE5(v8) = 2;
      v7 = 3;
      LODWORD(v8) = 0;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21988550C, a1);
      BYTE5(v8) = 2;
      v7 = 0x100000003;
      LODWORD(v8) = 33;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985C56C, a1);
      BYTE5(v8) = 2;
      v7 = 0x100000003;
      LODWORD(v8) = 40;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985C60C, a1);
      BYTE5(v8) = 2;
      v7 = 0x100000003;
      LODWORD(v8) = 35;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985C6AC, a1);
      BYTE5(v8) = 2;
      v7 = 0x100000003;
      LODWORD(v8) = 44;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985C798, a1);
      BYTE5(v8) = 2;
      v7 = 0x100000003;
      LODWORD(v8) = 36;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985C838, a1);
      BYTE5(v8) = 2;
      v7 = 3;
      LODWORD(v8) = 7;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_219885318, a1);
      BYTE5(v8) = 2;
      v7 = 0xF00000003;
      LODWORD(v8) = 50;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_219853C54, a1);
      BYTE5(v8) = 2;
      v7 = 0xF00000003;
      LODWORD(v8) = 3;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985D780, a1);
      BYTE5(v8) = 2;
      v7 = 0xF00000003;
      LODWORD(v8) = 58;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985C490, a1);
      BYTE5(v8) = 2;
      v7 = 0xF00000003;
      LODWORD(v8) = 12;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985C28C, a1);
      BYTE5(v8) = 2;
      v7 = 0xF00000003;
      LODWORD(v8) = 16;
      sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_21985C380, a1);
    }
    phOsalNfc_SetMemory();
    *(_QWORD *)&v9 = 1;
    DWORD2(v9) = 0;
    *(_QWORD *)&v10 = a1 + 36;
    DWORD2(v10) = 1;
    BYTE14(v5) = 0;
    phOsalNfc_MemCopy();
    v2 = sub_21987EC70(a1, 2u, (uint64_t)v4, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_InitReset");
  return v2;
}

uint64_t sub_21988368C(uint64_t a1, int a2)
{
  _BYTE *v4;
  uint64_t v5;
  int v7;
  _BOOL4 v8;
  const char *v9;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessResetRsp");
  if (a1)
  {
    if (a2 == 44
      || *(_DWORD *)(a1 + 3768) != 3
      || (sub_2198813E0((unsigned int *)a1, *(_BYTE **)(a1 + 3760)), v4 = *(_BYTE **)(a1 + 3760), *v4))
    {
      v5 = 255;
    }
    else
    {
      if (*(_BYTE *)(a1 + 6242) == 1)
      {
        if (*(_BYTE *)(a1 + 6243))
        {
          v5 = 0;
        }
        else
        {
          v5 = phTmlNfc_IoCtl();
          *(_BYTE *)(a1 + 6241) = *(_BYTE *)(a1 + 6243);
          v4 = *(_BYTE **)(a1 + 3760);
        }
        *(_WORD *)(a1 + 6242) = 0;
      }
      else
      {
        v5 = 0;
      }
      *(_BYTE *)(a1 + 6240) = *(_BYTE *)(a1 + 6241);
      *(_BYTE *)(a1 + 28) = v4[1];
      v7 = v4[2];
      v8 = v7 != 0;
      if (v7)
        v9 = "Nfcc reseted to 'phNciNfc_ResetType_ResetConfig'";
      else
        v9 = "Nfcc reseted to 'phNciNfc_ResetType_KeepConfig'";
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)v9);
      *(_DWORD *)(a1 + 32) = v8;
    }
  }
  else
  {
    v5 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessResetRsp");
  return v5;
}

uint64_t sub_2198837C8(uint64_t a1)
{
  uint64_t v2;
  int v3;
  __int128 v5;
  __int128 v6;

  v5 = 0u;
  v6 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Init");
  phOsalNfc_SetMemory();
  *(_QWORD *)&v5 = 1;
  DWORD2(v5) = 1;
  *(_QWORD *)&v6 = a1 + 40;
  DWORD2(v6) = 0;
  v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v5, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  if ((_DWORD)v2 == 111)
  {
    v2 = sub_21987FEF8((unsigned int *)a1);
    if (!(_DWORD)v2)
    {
      v3 = phTmlNfc_WriteAbort();
      sub_21988F804(*(_QWORD *)(a1 + 1520), 0);
      if (v3)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"NCI Inti command resend failed");
        v2 = 255;
      }
      else
      {
        v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v5, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Init");
  return v2;
}

uint64_t sub_21988391C(uint64_t a1, uint64_t a2)
{
  unsigned __int8 *v4;
  _QWORD *v5;
  unsigned int v6;
  unsigned __int8 v7;
  __int16 v8;
  char v9;
  __int16 v10;
  int v11;
  int v12;
  char v13;
  int v14;
  uint64_t v16;
  uint64_t v17;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessInitRsp");
  if (!a1)
  {
    a2 = 1;
    goto LABEL_40;
  }
  if (*(_DWORD *)(a1 + 3768) < 0x11u)
  {
    a2 = 255;
    goto LABEL_40;
  }
  v4 = *(unsigned __int8 **)(a1 + 3760);
  if (*v4 == 241)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Suica/VAS express enabled/transaction inprogress");
    a2 = 81;
LABEL_39:
    sub_219881520((unsigned int *)a1, a1, a2);
    goto LABEL_40;
  }
  if (*v4)
  {
    a2 = 255;
    goto LABEL_39;
  }
  v5 = (_QWORD *)(a1 + 4786);
  *(_BYTE *)a1 = v4[1];
  *(_BYTE *)(a1 + 1) = v4[2];
  *(_BYTE *)(a1 + 2) = v4[3];
  *(_BYTE *)(a1 + 3) = v4[4];
  v6 = v4[5];
  *(_BYTE *)(a1 + 4) = v6;
  if (v6)
  {
    if (v6 > 8)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Received number of RF interface support exceeded max number of RF interfaces");
      a2 = 255;
    }
    else
    {
      phOsalNfc_MemCopy();
    }
    v7 = *(_BYTE *)(a1 + 4) + 6;
    v4 = *(unsigned __int8 **)(a1 + 3760);
  }
  else
  {
    v7 = 6;
  }
  *(_BYTE *)(a1 + 13) = v4[v7];
  v8 = v4[(v7 + 1)];
  *(_WORD *)(a1 + 14) = v8;
  *(_WORD *)(a1 + 14) = v8 | (v4[(v7 + 2)] << 8);
  v9 = v4[(v7 + 3)];
  *(_BYTE *)(a1 + 16) = v9;
  v10 = v4[(v7 + 4)];
  *(_WORD *)(a1 + 18) = v10;
  *(_WORD *)(a1 + 18) = v10 | (v4[(v7 + 5)] << 8);
  v11 = v4[(v7 + 6)];
  *(_BYTE *)(a1 + 20) = v11;
  if (v11)
  {
    v12 = v4[(v7 + 7)];
    *(_BYTE *)(a1 + 21) = v12;
    *(_BYTE *)(a1 + 22) = v4[(v7 + 8)];
    *(_BYTE *)(a1 + 23) = v4[(v7 + 9)];
    *(_BYTE *)(a1 + 24) = v4[(v7 + 10)];
  }
  else
  {
    v12 = *(unsigned __int8 *)(a1 + 21);
  }
  *(_WORD *)(a1 + 4794) = 0;
  *v5 = 0;
  v13 = v12 + 94;
  if ((v12 - 162) > 0x31)
  {
LABEL_26:
    if (v12 != 96)
    {
      if (v12 == 66)
        *(_BYTE *)(a1 + 4795) = 1;
      goto LABEL_38;
    }
LABEL_29:
    *(_BYTE *)(a1 + 4788) = 1;
    if ((v12 - 209) >= 3)
    {
      if (v12 == 96)
        *(_BYTE *)v5 = 1;
    }
    else
    {
      *(_BYTE *)(a1 + 4787) = 1;
    }
    goto LABEL_38;
  }
  if (((1 << v13) & 0x3C00000000000) != 0)
    goto LABEL_29;
  if (((1 << v13) & 7) == 0)
  {
    if (((1 << v13) & 0x1018000) != 0)
    {
      *(_BYTE *)(a1 + 4793) = 1;
      v14 = *(unsigned __int8 *)(a1 + 3);
      if (v12 == 186)
      {
        if (v14 == 18)
          *(_BYTE *)(a1 + 4790) = 1;
        else
          *(_BYTE *)(a1 + 4789) = 1;
      }
      else if (v14 == 4)
      {
        *(_BYTE *)(a1 + 4792) = 1;
      }
      else if (v14 == 3)
      {
        *(_BYTE *)(a1 + 4791) = 1;
      }
      goto LABEL_38;
    }
    goto LABEL_26;
  }
  *(_BYTE *)(a1 + 4794) = 1;
LABEL_38:
  if ((_DWORD)a2 == 255)
    goto LABEL_39;
  a2 = sub_2198F31D0(a1 + 888, v9);
  sub_219881520((unsigned int *)a1, a1, a2);
  if (!(_DWORD)a2)
  {
    if (*(_BYTE *)(a1 + 41))
    {
      a2 = 0;
    }
    else
    {
      a2 = sub_2198849FC(a1);
      if (!(_DWORD)a2)
      {
        v16 = *(_QWORD *)(a1 + 4656);
        if (v16 && v16 != 0xFFFFFFFFFFFFLL)
        {
          a2 = phOsalNfc_Timer_Delete();
          if ((_DWORD)a2)
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"NCI dwNtfTimerId Timer Delete failed!!");
          *(_QWORD *)(a1 + 4656) = 0xFFFFFFFFFFFFLL;
        }
        v17 = phOsalNfc_Timer_Create();
        *(_QWORD *)(a1 + 4656) = v17;
        if (v17 != 0xFFFFFFFFFFFFLL && v17)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Notification Timer Created Successfully");
        }
        else
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Notification Timer Create failed!!");
          a2 = 12;
        }
      }
    }
  }
LABEL_40:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessInitRsp");
  return a2;
}

uint64_t sub_219883D28(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;
  uint64_t v6;
  uint64_t v7;

  v6 = 0;
  v7 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteInitSequence");
  if (a1)
  {
    v4 = (_BYTE *)(a1 + 4769);
    *(_QWORD *)(a1 + 6624) = a1;
    *(_DWORD *)(a1 + 6640) = 0;
    *(_QWORD *)(a1 + 6632) = 0;
    if (*(_BYTE *)(a1 + 6242) == 1)
    {
      if (!*(_BYTE *)(a1 + 6243))
      {
        a2 = phTmlNfc_IoCtl();
        *(_BYTE *)(a1 + 6241) = *(_BYTE *)(a1 + 6243);
      }
      *(_WORD *)(a1 + 6242) = 0;
    }
    if (*v4)
    {
      a2 = 44;
      *(_WORD *)(a1 + 6666) = 44;
      *(_QWORD *)(a1 + 6632) = a1 + 6666;
      *(_BYTE *)(a1 + 6474) = 1;
      phTmlNfc_ReadAbort();
      phTmlNfc_FlushTxRxBuffers();
      *v4 = 0;
    }
    else if ((_DWORD)a2 == 44)
    {
      *(_BYTE *)(a1 + 6474) = 1;
      if (*(_BYTE *)(a1 + 3353) == 1
        && (sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Corrupted Pkt rxd from TML,Flush TML TxRx buffs and place hdr read req"), phTmlNfc_ReadAbort(), phTmlNfc_FlushTxRxBuffers(), sub_219851DC0(a1 + 888, 0, 3) != 13))
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"TML Read req during boot retry failed");
        a2 = 255;
      }
      else
      {
        a2 = 44;
      }
    }
    else
    {
      *(_QWORD *)(a1 + 6632) = 0;
    }
    v6 = 3;
    LODWORD(v7) = 7;
    sub_2198F3088((unsigned int *)(a1 + 888), (uint64_t)&v6, (uint64_t)sub_219885318);
    sub_2198E23C4(a1, a2, a1 + 6624);
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteInitSequence");
  return a2;
}

uint64_t sub_219883EFC(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_SendReset");
  v2 = 1;
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 1;
    DWORD2(v4) = 0;
    *(_QWORD *)&v5 = a1 + 9;
    DWORD2(v5) = 1;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_SendReset");
  return v2;
}

uint64_t sub_219883FC0(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GenericCompleteSequence");
  if (a1)
    sub_2198E23C4((uint64_t)a1, a2, 0);
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GenericCompleteSequence");
  return a2;
}

uint64_t sub_219884030(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwInterfaceVersionCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 25;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwInterfaceVersionCmd");
  return v2;
}

uint64_t sub_219884100(uint64_t a1, uint64_t a2)
{
  unsigned __int8 *v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwInterfaceVersionRsp");
  if (a1 && !(_DWORD)a2)
  {
    v4 = *(unsigned __int8 **)(a1 + 3760);
    if (!v4)
      goto LABEL_13;
    v5 = *v4;
    if (v5 != 5 && v5 != 1)
    {
      if (!*v4 && *(_DWORD *)(a1 + 3768) == 3)
      {
        *(_BYTE *)(a1 + 4784) = v4[1];
        *(_BYTE *)(a1 + 4785) = v4[2];
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Get FW interface version Successful");
        a2 = 0;
        goto LABEL_14;
      }
LABEL_13:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Get FW interface version failed!");
      *(_DWORD *)(a1 + 3768) = 0;
      a2 = 255;
      goto LABEL_14;
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Get FW interface version Rejected/Syntax error, Hence this is OLD FW");
    *(_DWORD *)(a1 + 3768) = 0;
    a2 = 128;
  }
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwInterfaceVersionRsp");
  return a2;
}

uint64_t sub_219884220(uint64_t a1, uint64_t a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwIntVerCompleteSequence");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
      *(_DWORD *)(a1 + 856) = 0;
    }
    if ((_DWORD)a2)
      v4 = 0;
    else
      v4 = a1 + 4784;
    sub_2198E23C4(a1, a2, v4);
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetFwIntVerCompleteSequence");
  return a2;
}

uint64_t sub_2198842BC(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteReleaseSequence");
  if (a1)
  {
    sub_2198E23C4((uint64_t)a1, a2, 0);
    a2 = sub_2198AE9A8(a1);
  }
  sub_219850808(2, 0, 3u, 5u, (uint64_t)"phNciNfc_CompleteReleaseSequence");
  return a2;
}

uint64_t sub_219884338(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendStandbyCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 0;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21988496C, a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendStandbyCmd");
  return v2;
}

uint64_t sub_219884404(uint64_t a1, uint64_t a2)
{
  int v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteStandbySequence");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
      *(_DWORD *)(a1 + 856) = 0;
    }
    if ((_DWORD)a2)
      v4 = 1;
    else
      v4 = *(_DWORD *)(a1 + 3364);
    *(_DWORD *)(a1 + 3360) = v4;
    sub_2198E23C4(a1, a2, 0);
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteStandbySequence");
  return a2;
}

uint64_t sub_2198844A8(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ConfigHsuBrCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 3;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21985A05C, a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ConfigHsuBrCmd");
  return v2;
}

uint64_t sub_219884578(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ConfigHsuBrSeqComp");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
      *(_DWORD *)(a1 + 856) = 0;
    }
    *(_WORD *)(a1 + 6666) = a2;
    sub_2198E23C4(a1, 0, a1 + 6666);
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ConfigHsuBrSeqComp");
  return a2;
}

uint64_t sub_219884610(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetMultiTagInfoCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 60;
    *(_QWORD *)&v5 = 0;
    DWORD2(v5) = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetMultiTagInfoCmd");
  return v2;
}

uint64_t sub_2198846D8(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetMultiTagInfoRsp");
  if (a1 && !(_DWORD)a2)
  {
    v4 = *(_BYTE **)(a1 + 3760);
    if (v4 && !*v4)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Get Multi tag Info Successful");
      a2 = 0;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Get Multi tag Info failed!");
      *(_DWORD *)(a1 + 3768) = 0;
      a2 = 255;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetMultiTagInfoRsp");
  return a2;
}

uint64_t sub_21988479C(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetMultiTagInfoSeqComp");
  v4 = 255;
  if (a1)
  {
    if ((_DWORD)a2)
      v5 = 255;
    else
      v5 = 0;
    sub_2198E23C4((uint64_t)a1, v5, (uint64_t)(a1 + 940));
    v4 = a2;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_GetMultiTagInfoSeqComp");
  return v4;
}

uint64_t sub_219884820(unsigned int *a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ClearMultiTagListCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 57;
    *(_QWORD *)&v5 = 0;
    DWORD2(v5) = 0;
    v2 = sub_2198F2D0C((uint64_t)(a1 + 222), (uint64_t)&v4, (uint64_t)(a1 + 940), 2000, (uint64_t)sub_21985A05C, (uint64_t)a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ClearMultiTagListCmd");
  return v2;
}

uint64_t sub_2198848E8(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ClearMultiTagListSeqComp");
  v4 = 255;
  if (a1)
  {
    if ((_DWORD)a2)
      v5 = 255;
    else
      v5 = 0;
    sub_2198E23C4((uint64_t)a1, v5, 0);
    v4 = a2;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ClearMultiTagListSeqComp");
  return v4;
}

uint64_t sub_21988496C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetPwrModeSequence");
  if (a1 && a2)
  {
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SetPwrModeSequence");
  return v6;
}

uint64_t sub_2198849FC(uint64_t a1)
{
  uint64_t v2;
  uint64_t v4;
  uint64_t v5;

  v4 = 0;
  v5 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RegAllNtfs");
  if (a1)
  {
    LODWORD(v5) = 7;
    v4 = 0x100000003;
    v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_219853D30, a1);
    if (!(_DWORD)v2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Rf-Nfcee Action Notification");
      LODWORD(v5) = 9;
      v4 = 0x100000003;
      v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_2198ABFF4, a1);
      if (!(_DWORD)v2)
      {
        LODWORD(v5) = 6;
        v4 = 0x100000003;
        v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_219885604, a1);
        if (!(_DWORD)v2)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Interface Activated Notification");
          v4 = 0x100000003;
          LODWORD(v5) = 5;
          v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_219864C44, a1);
          if (!(_DWORD)v2)
          {
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Discover Notification");
            v4 = 0x100000003;
            LODWORD(v5) = 3;
            v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21986423C, a1);
            if (!(_DWORD)v2)
            {
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Interface Error Notification");
              v4 = 3;
              LODWORD(v5) = 8;
              v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985AFBC, a1);
              if (!(_DWORD)v2)
              {
                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Generic Error Notification");
                v4 = 3;
                LODWORD(v5) = 7;
                v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985A0EC, a1);
                if (!(_DWORD)v2)
                {
                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for relay attack detection/protection notification");
                  v4 = 0x100000003;
                  LODWORD(v5) = 45;
                  v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985E394, a1);
                  if (!(_DWORD)v2)
                  {
                    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Tag Detector Notification");
                    v4 = 0xF00000003;
                    LODWORD(v5) = 19;
                    v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_219859CA4, a1);
                    if (!(_DWORD)v2)
                    {
                      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Rf Nfcee Discovery Request Notification");
                      LODWORD(v5) = 10;
                      v4 = 0x100000003;
                      v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_2198AC248, a1);
                      if (!(_DWORD)v2)
                      {
                        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for NFCEE Power off Notification");
                        LODWORD(v5) = 24;
                        v4 = 0xF00000003;
                        v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985A7FC, a1);
                        if (!(_DWORD)v2)
                        {
                          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Suica/VAS Express Mode Transaction Happened Notification");
                          LODWORD(v5) = 35;
                          v4 = 0xF00000003;
                          v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985A9C4, a1);
                          if (!(_DWORD)v2)
                          {
                            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Suica Mode Started Notification");
                            LODWORD(v5) = 36;
                            v4 = 0xF00000003;
                            v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985AA64, a1);
                            if (!(_DWORD)v2)
                            {
                              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for System End of operation Notification for SEs");
                              LODWORD(v5) = 32;
                              v4 = 0xF00000003;
                              v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985A618, a1);
                              if (!(_DWORD)v2)
                              {
                                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for System L1 Debug notification");
                                v4 = 0xF00000003;
                                LODWORD(v5) = 53;
                                v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985AC18, a1);
                                if (!(_DWORD)v2)
                                {
                                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for System L2 Debug notification");
                                  v4 = 0xF00000003;
                                  LODWORD(v5) = 54;
                                  v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985ACE8, a1);
                                  if (!(_DWORD)v2)
                                  {
                                    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Chip Scope Debug notification");
                                    v4 = 0xF00000003;
                                    LODWORD(v5) = 34;
                                    v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985E4B4, a1);
                                    if (!(_DWORD)v2)
                                    {
                                      if (*(_BYTE *)(a1 + 4794) != 1
                                        && *(_BYTE *)(a1 + 4793) != 1
                                        && *(_BYTE *)(a1 + 4788) != 1
                                        || (sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Chip Scope Debug notification"), v4 = 0xF00000003, LODWORD(v5) = 55, v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985E4B4, a1), !(_DWORD)v2))
                                      {
                                        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Prop Reader Ntf messag notification");
                                        LODWORD(v5) = 32;
                                        v4 = 0x100000003;
                                        v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985C0C4, a1);
                                        if (!(_DWORD)v2)
                                        {
                                          LODWORD(v5) = 34;
                                          v4 = 0x100000003;
                                          v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_2198AC554, a1);
                                          if (!(_DWORD)v2)
                                          {
                                            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for RSSI statistics Notification");
                                            LODWORD(v5) = 56;
                                            v4 = 0xF00000003;
                                            v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985B5BC, a1);
                                            if (!(_DWORD)v2)
                                            {
                                              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for FW Debug Info Notification");
                                              LODWORD(v5) = 4;
                                              v4 = 0xF00000003;
                                              v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985D4D0, a1);
                                              if (!(_DWORD)v2)
                                              {
                                                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for HLM Debug Info Notification");
                                                LODWORD(v5) = 31;
                                                v4 = 0xF00000003;
                                                v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985DAB4, a1);
                                                if (!(_DWORD)v2)
                                                {
                                                  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for WTX Notification");
                                                  LODWORD(v5) = 23;
                                                  v4 = 0xF00000003;
                                                  v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985DD88, a1);
                                                  if (!(_DWORD)v2)
                                                  {
                                                    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Tag removal detection Notification");
                                                    LODWORD(v5) = 28;
                                                    v4 = 0xF00000003;
                                                    v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985E078, a1);
                                                    if (!(_DWORD)v2)
                                                    {
                                                      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for LPCD Debug Notification");
                                                      LODWORD(v5) = 38;
                                                      v4 = 0xF00000003;
                                                      v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985E13C, a1);
                                                      if (!(_DWORD)v2)
                                                      {
                                                        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Prop Vas CW Ntf message notification");
                                                        LODWORD(v5) = 41;
                                                        v4 = 0x100000003;
                                                        v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985C1C4, a1);
                                                        if (!(_DWORD)v2)
                                                        {
                                                          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for LPCD Assist succesful Exit Notification");
                                                          LODWORD(v5) = 48;
                                                          v4 = 0x100000003;
                                                          v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985E218, a1);
                                                          if (!(_DWORD)v2)
                                                          {
                                                            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Get prohibit timer status Notification");
                                                            LODWORD(v5) = 13;
                                                            v4 = 0xF00000003;
                                                            v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985CE34, a1);
                                                            if (!(_DWORD)v2)
                                                            {
                                                              LODWORD(v5) = 37;
                                                              v4 = 0x100000003;
                                                              v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985C8D8, a1);
                                                              if (!(_DWORD)v2)
                                                              {
                                                                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Get power track data Notification");
                                                                LODWORD(v5) = 46;
                                                                v4 = 0xF00000003;
                                                                v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v4, (uint64_t)sub_21985CFE8, a1);
                                                              }
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RegAllNtfs");
  return v2;
}

uint64_t sub_219885318(uint64_t a1, uint64_t a2, int a3)
{
  unsigned __int8 *v6;
  uint64_t v7;
  int *v9;
  int v10;
  void (*v11)(_QWORD, uint64_t, _QWORD, uint64_t);
  void (*v12)(_QWORD, uint64_t, _QWORD *, uint64_t);
  _QWORD v13[3];

  memset(v13, 0, sizeof(v13));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_InitGenErrorNtfCB");
  if (!a1)
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)"phNciNfc_InitGenErrorNtfCB:Invalid Context Param..");
    v7 = 1;
    goto LABEL_12;
  }
  if (!a2 || (v6 = *(unsigned __int8 **)(a2 + 8)) == 0 || a3 || !*(_DWORD *)(a2 + 16))
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_InitGenErrorNtfCB:Notification invalid..");
    goto LABEL_10;
  }
  if (*(_BYTE *)(a1 + 6244))
  {
    sub_219859F08(a1, 0, 33);
LABEL_8:
    v7 = 0;
    goto LABEL_12;
  }
  if (!*(_BYTE *)(a1 + 4769))
  {
    v10 = *v6;
    if (v10 == 237)
    {
      v11 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(a1 + 456);
      if (v11)
        v11(*(_QWORD *)(a1 + 448), 29, 0, 154);
      goto LABEL_8;
    }
    *(_DWORD *)(a1 + 6444) = v10;
    v12 = *(void (**)(_QWORD, uint64_t, _QWORD *, uint64_t))(a1 + 248);
    if (v12)
    {
      HIDWORD(v13[0]) = v10;
      v12(*(_QWORD *)(a1 + 240), 46, v13, 133);
      goto LABEL_8;
    }
    sub_219851888(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_InitGenErrorNtfCB - Unexpected Generic Error Ntf with Status");
LABEL_10:
    v7 = 255;
    goto LABEL_12;
  }
  if (*(_BYTE *)(a1 + 1880) != 1)
    goto LABEL_8;
  phOsalNfc_Timer_Stop();
  *(_BYTE *)(a1 + 6464) = 0;
  *(_BYTE *)(a1 + 1880) = 0;
  if (*(_DWORD *)(a1 + 3356))
    v9 = &dword_253E47158;
  else
    v9 = &dword_253E47070;
  v9[1] &= ~0x10u;
  phOsalNfc_Delay();
  v7 = sub_21985A05C(a1, 0, 44);
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_InitGenErrorNtfCB");
  return v7;
}

uint64_t sub_21988550C(uint64_t a1, uint64_t a2)
{
  void (*v4)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;

  v6 = 0;
  v7 = 0;
  v8 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ResetNtfCb");
  if (a1 && a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Received RESET notification from NFCC");
    sub_21987FEF8((unsigned int *)a1);
    phTmlNfc_WriteAbort();
    sub_21988F804(*(_QWORD *)(a1 + 1520), 0);
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
      *(_DWORD *)(a1 + 856) = 0;
    }
    v4 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 280);
    if (v4)
    {
      v6 = *(_QWORD *)(a2 + 8);
      LODWORD(v7) = *(_DWORD *)(a2 + 16);
      v4(*(_QWORD *)(a1 + 272), 4, &v6, 0);
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ResetNtfCb");
  return 0;
}

uint64_t sub_219885604(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v6;
  _BYTE *v7;
  _BYTE *v8;
  unsigned __int8 *v9;
  int v10;
  uint64_t v11;
  uint64_t v12;
  void (*v13)(_QWORD, uint64_t, _QWORD *, uint64_t);
  void (*v14)(_QWORD, uint64_t, _QWORD *, uint64_t);
  _QWORD v16[3];

  memset(v16, 0, sizeof(v16));
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DeActvNtfCb");
  v6 = 1;
  if (a1 && a2)
  {
    v7 = *(_BYTE **)(a2 + 8);
    if (v7 && *v7 == 1 && !v7[1] && (!*(_QWORD *)(a1 + 736) || *(_BYTE *)(a1 + 6473) == 1))
    {
      if (!a3 && *(_DWORD *)(a2 + 16) == 2)
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Dropping Deactivate to sleep Ntf as Call back is not registered");
        v6 = 0;
        goto LABEL_53;
      }
LABEL_23:
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)" Invalid Notification!!");
      v6 = 255;
      goto LABEL_53;
    }
    *(_WORD *)(a1 + 3320) = 0;
    sub_2199004B4(a1, 0);
    v8 = *(_BYTE **)(a2 + 8);
    if (!v8 || a3 || *(_DWORD *)(a2 + 16) != 2)
      goto LABEL_23;
    if (!*v8 && *(_BYTE *)(a1 + 6592) == 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"RF DeActivate notification Dropped as there is SetConfig or Discover Map command retry ongoing");
      goto LABEL_53;
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"RF DeActivate notification Received!!");
    v9 = *(unsigned __int8 **)(a2 + 8);
    if (v9[1] <= 3u)
      HIDWORD(v16[0]) = v9[1];
    v10 = *v9;
    if (*(_QWORD *)(a1 + 3384))
    {
      if (!*v9)
      {
        *(_BYTE *)(a1 + 4736) = 0;
        *(_BYTE *)(a1 + 6467) = 1;
        *(_BYTE *)(a1 + 6609) = 0;
        if (*(_BYTE *)(a1 + 6466) == 1)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Dropping Deactivate Ntf to IdleMode as Restart Discovery is in progress..");
LABEL_52:
          *(_BYTE *)(a1 + 6466) = 0;
          goto LABEL_53;
        }
        if (!*(_QWORD *)(a1 + 768))
        {
          *(_BYTE *)(a1 + 6466) = 0;
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Deactivate Ntf to IdleMode..");
          *(_QWORD *)(a1 + 3384) = 0;
          sub_2198636E8(a1);
          sub_2198F32D8(a1 + 888);
          sub_219886108(*(_QWORD *)(a1 + 6480), 121);
          LODWORD(v16[0]) = 0;
          goto LABEL_49;
        }
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Rf Deactivate Ntf to IdleMode..");
        sub_219886108(*(_QWORD *)(a1 + 6480), 121);
        LODWORD(v16[0]) = 0;
        goto LABEL_38;
      }
    }
    else if (!*v9)
    {
      if (!*(_QWORD *)(a1 + 736))
      {
        if (*(_QWORD *)(a1 + 752) || *(_QWORD *)(a1 + 816))
        {
          *(_BYTE *)(a1 + 6467) = 1;
          *(_BYTE *)(a1 + 6609) = 0;
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Rf Deactivate Ntf to IdleMode..");
          sub_219886108(*(_QWORD *)(a1 + 6480), 121);
          LODWORD(v16[0]) = 0;
          sub_2198636E8(a1);
          *(_QWORD *)(a1 + 736) = 0;
          *(_QWORD *)(a1 + 752) = 0;
          *(_QWORD *)(a1 + 816) = 0;
          phOsalNfc_Timer_Stop();
          *(_BYTE *)(a1 + 6464) = 0;
          sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_DeActvNtfCb");
          goto LABEL_49;
        }
        *(_BYTE *)(a1 + 6609) = 0;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Rf Deactivate Ntf to IdleMode..");
        sub_219886108(*(_QWORD *)(a1 + 6480), 121);
        LODWORD(v16[0]) = 0;
        if (*(_DWORD *)(a1 + 172) == 4)
          *(_DWORD *)(a1 + 172) = 0;
LABEL_38:
        sub_2198636E8(a1);
LABEL_49:
        v14 = *(void (**)(_QWORD, uint64_t, _QWORD *, uint64_t))(a1 + 192);
        if (v14)
          v14(*(_QWORD *)(a1 + 184), 7, v16, 121);
        v6 = 0;
        goto LABEL_52;
      }
      *(_BYTE *)(a1 + 6467) = 1;
      *(_BYTE *)(a1 + 6609) = 0;
      goto LABEL_35;
    }
    if (v9[1] - 1 <= 1)
    {
      if ((v10 - 1) >= 2)
      {
        if (v10 != 3)
        {
          v6 = 255;
          goto LABEL_52;
        }
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"Rf LinkLoss in DiscMode..");
      }
      else
      {
        v11 = *(_QWORD *)(a1 + 4512);
        if (!v11 || (*(_BYTE *)(v11 + 20) & 0x80) != 0)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Device in listen Mode!!!");
          LODWORD(v16[0]) = **(unsigned __int8 **)(a2 + 8);
          v12 = 7;
          goto LABEL_40;
        }
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Endpoint Req to 'Sleep/SleepAF'...Converting to 'Discovery'");
      }
      LODWORD(v16[0]) = 3;
      v12 = 146;
LABEL_40:
      v6 = sub_2198636E8(a1);
      if (**(_BYTE **)(a2 + 8) == 3)
        *(_BYTE *)(a1 + 176) = 1;
      v13 = *(void (**)(_QWORD, uint64_t, _QWORD *, uint64_t))(a1 + 192);
      if (v13)
        v13(*(_QWORD *)(a1 + 184), 7, v16, v12);
      goto LABEL_52;
    }
LABEL_35:
    v6 = sub_219864A30(a1, a2, 0);
    goto LABEL_52;
  }
LABEL_53:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_DeActvNtfCb");
  return v6;
}

uint64_t sub_219885AC0(uint64_t a1, uint64_t a2, _BYTE *a3, int a4)
{
  uint64_t v8;
  int v9;
  unsigned int v10;
  int v11;
  uint64_t (**v12)(uint64_t);
  uint64_t v13;
  int v14;
  int v16;

  v16 = 26;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RdrBInit");
  if (a1 && a2 && a3 && a4)
  {
    if (a3[3] == 1)
    {
      v8 = a3[6];
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" NFC-B Passive Poll Mode Info being captured..");
      v9 = a3[7];
      *(_BYTE *)(a2 + 98) = v9;
      if ((v9 - 11) <= 1u)
      {
        phOsalNfc_SetMemory();
        phOsalNfc_MemCopy();
        v10 = *(unsigned __int8 *)(a2 + 108);
        *(_BYTE *)(a2 + 145) = sub_219862404((unsigned int *)a1, v10 >> 4);
        sub_2198592E8((unsigned int *)a1, v10, v9, (_DWORD *)a2, &v16);
        v11 = v16;
        *(_DWORD *)(a2 + 4) = v16;
        if (v11 == 16)
        {
          if (*(_DWORD *)(a2 + 12) == 2)
          {
            if (a3[v8 + 10])
            {
              v14 = a3[a3[v8 + 10] + 1];
              *(_BYTE *)(a2 + 111) = v14;
              if (v14)
              {
                phOsalNfc_SetMemory();
                phOsalNfc_MemCopy();
              }
            }
          }
        }
        else if (v11 != 25)
        {
          v12 = *(uint64_t (***)(uint64_t))(a1 + 4760);
LABEL_18:
          v13 = 0;
          v12[2] = 0;
          v12[3] = (uint64_t (*)(uint64_t))sub_2198F14B0;
          goto LABEL_19;
        }
        v12 = *(uint64_t (***)(uint64_t))(a1 + 4760);
        *v12 = sub_21989B6B4;
        v12[1] = (uint64_t (*)(uint64_t))sub_21989B35C;
        goto LABEL_18;
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid SENSB_RES Length received..");
      v13 = 255;
    }
    else
    {
      v13 = 0;
    }
  }
  else
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)" Invalid Params..");
    v13 = 1;
  }
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RdrBInit");
  return v13;
}

uint64_t sub_219885CEC(unsigned int a1)
{
  char *v1;
  uint64_t *v2;
  uint64_t v3;
  uint64_t result;
  uint64_t v5;

  if (a1 > 1)
    return 255;
  v1 = (char *)&unk_253E46700 + 112 * a1;
  v3 = *((_QWORD *)v1 + 10);
  v2 = (uint64_t *)(v1 + 80);
  if (v3)
    return 0;
  result = phOsalNfc_GetMemory();
  if (result)
  {
    v5 = result;
    phOsalNfc_SetMemory();
    result = 0;
    *(_QWORD *)(v5 + 120) = 0;
    *(_QWORD *)(v5 + 128) = 0;
    *(_QWORD *)(v5 + 136) = 0;
    *(_WORD *)(v5 + 152) = 255;
    *(_DWORD *)(v5 + 156) = 136;
    *v2 = v5;
  }
  return result;
}

uint64_t sub_219885D88(unsigned int a1)
{
  char *v1;
  uint64_t v2;
  _QWORD *v3;
  uint64_t v4;
  uint64_t result;

  if (a1 > 1)
    return 255;
  v1 = (char *)&unk_253E46700 + 112 * a1;
  v4 = *((_QWORD *)v1 + 10);
  v3 = v1 + 80;
  v2 = v4;
  if (!v4)
    return 0;
  *(_QWORD *)(v2 + 120) = 0;
  *(_QWORD *)(v2 + 128) = 0;
  *(_QWORD *)(v2 + 136) = 0;
  *(_WORD *)(v2 + 152) = 255;
  *(_DWORD *)(v2 + 156) = 136;
  phOsalNfc_FreeMemory();
  result = 0;
  *v3 = 0;
  return result;
}

uint64_t sub_219885DF4(unsigned int a1, int *a2)
{
  uint64_t v3;
  uint64_t v4;
  int v5;
  uint64_t i;
  uint64_t j;
  uint64_t k;
  unsigned int v10;

  v10 = a1;
  if (a1 > 1)
    return 1;
  v3 = 1;
  if (a2)
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * a1 + 10);
    if (v4)
    {
      *(_BYTE *)v4 = *((_BYTE *)a2 + 33);
      if (*((_BYTE *)a2 + 32) == 1)
      {
        v5 = *a2;
        if (*a2 <= 5)
        {
          for (i = 0; i != 60; i += 4)
            *(_DWORD *)(v4 + 32 + i) = *a2;
          goto LABEL_12;
        }
      }
      else
      {
        v5 = *a2;
      }
      *(_DWORD *)(v4 + 36) = v5;
      *(_DWORD *)(v4 + 40) = a2[1];
      *(_DWORD *)(v4 + 44) = a2[2];
      *(_DWORD *)(v4 + 48) = a2[3];
      *(_DWORD *)(v4 + 52) = a2[7];
      *(_DWORD *)(v4 + 56) = a2[4];
      *(_DWORD *)(v4 + 64) = a2[6];
      *(_DWORD *)(v4 + 60) = a2[5];
LABEL_12:
      for (j = 1; j != 16; ++j)
        *(_BYTE *)(v4 + j) = a2[9];
      if (*((_QWORD *)a2 + 6))
      {
        v3 = phOsalNfc_CloseLogFile();
        if (!(_DWORD)v3)
          v3 = phOsalNfc_OpenLogFile();
      }
      else
      {
        v3 = 0;
      }
      sub_219885F70(1, &v10, 5u, 2, (uint64_t)"phLogNfc_ConfigureMwLogging");
      for (k = 0; k != 15; ++k)
        *(_BYTE *)(v4 + 16 + k) = a2[10];
    }
  }
  return v3;
}

uint64_t sub_219885F70(int a1, unsigned int *a2, unsigned int a3, uint64_t a4, uint64_t a5)
{
  uint64_t result;
  unsigned int v8;

  result = sub_2198508F8(a1, a2, a3);
  if (qword_253E46750)
  {
    v8 = *(unsigned __int8 *)(qword_253E46750 + a3 + 16);
    if (v8 >= 4 && a5 != 0 && v8 == 4)
      return phOsalNfc_SignPostLogFunc();
  }
  return result;
}

uint64_t sub_219885FF8(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5)
{
  uint64_t result;
  uint64_t v9;
  uint64_t v10;
  BOOL v11;
  unsigned int v12;
  unsigned int v16;
  BOOL v18;
  char v19;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result == 1)
  {
    if (!qword_253E467C0)
      return result;
    v11 = 0;
    v10 = qword_253E467C0 + 32;
    goto LABEL_25;
  }
  if (!(_DWORD)result)
  {
    v9 = qword_253E46750;
    if (!qword_253E46750)
      return result;
    v10 = 0;
LABEL_12:
    v12 = *(_DWORD *)(v9 + 4 * a3 + 32);
    if (v12 >= a4 && v12 != 0 && a5 != 0 && v12 < 6)
      return phOsalNfc_LogX64();
    goto LABEL_23;
  }
  if (qword_253E467C0)
    v10 = qword_253E467C0 + 32;
  else
    v10 = 0;
  if ((_DWORD)result == 255)
  {
    v9 = qword_253E46750;
    if (qword_253E46750)
      goto LABEL_12;
  }
LABEL_23:
  if (!v10)
    goto LABEL_30;
  v11 = (_DWORD)result == 255;
  if ((_DWORD)result != 255)
    return result;
LABEL_25:
  v16 = *(_DWORD *)(v10 + 4 * a3);
  if (v16 < a4 || v16 == 0)
  {
LABEL_30:
    if ((_DWORD)result != 255)
      return result;
    return phOsalNfc_LogX64();
  }
  if (a5)
    v18 = v16 >= 6;
  else
    v18 = 1;
  v19 = !v18 || v11;
  if ((v19 & 1) != 0)
    return phOsalNfc_LogX64();
  return result;
}

uint64_t sub_219886108(uint64_t result, int a2)
{
  uint64_t v2;
  char i;
  char v4;
  unsigned int v5;
  uint64_t v6;
  BOOL v7;

  v2 = 0;
  for (i = 1; ; i = 0)
  {
    v4 = i;
    if (*((_QWORD *)&unk_253E46700 + 14 * v2) == result)
      break;
    v2 = 1;
    if ((v4 & 1) == 0)
      return result;
  }
  v5 = *((_DWORD *)&unk_253E46700 + 28 * v2 + 2);
  if (v5 <= 1)
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 10);
    if (v6)
    {
      if (a2 == 80 || a2 == 44 && *(_WORD *)(v6 + 152) != 80)
        goto LABEL_10;
      if (*(_WORD *)(v6 + 152))
      {
        if (*(_WORD *)(v6 + 152) != 80)
        {
          v7 = *(unsigned __int16 *)(v6 + 152) > 0x2Cu || ((1 << *(_WORD *)(v6 + 152)) & 0x100600000000) == 0;
          if (v7 && ((a2 - 208) <= 6 && ((1 << (a2 + 48)) & 0x4F) != 0 || a2 == 48))
            goto LABEL_10;
        }
      }
      else if (a2 && (a2 != 185 || (*(_DWORD *)(v6 + 156) & 0xFFFFFFFE) != 0x1E))
      {
LABEL_10:
        *(_WORD *)(v6 + 152) = a2;
      }
    }
  }
  return result;
}

uint64_t sub_21988620C(uint64_t result, __int16 a2)
{
  uint64_t v2;
  char i;
  char v4;
  unsigned int v5;
  uint64_t v6;
  int v7;
  BOOL v8;

  v2 = 0;
  for (i = 1; ; i = 0)
  {
    v4 = i;
    if (*((_QWORD *)&unk_253E46700 + 14 * v2) == result)
      break;
    v2 = 1;
    if ((v4 & 1) == 0)
      return result;
  }
  v5 = *((_DWORD *)&unk_253E46700 + 28 * v2 + 2);
  if (v5 <= 1)
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 10);
    if (v6)
    {
      v7 = *(unsigned __int16 *)(v6 + 152);
      v8 = (v7 - 194) > 0x35 || ((1 << (v7 + 62)) & 0x30000000000003) == 0;
      if (!v8 || v7 == 44)
        *(_WORD *)(v6 + 152) = a2;
    }
  }
  return result;
}

uint64_t sub_21988629C(int a1, unsigned int *a2, uint64_t a3, unsigned int a4, unsigned int a5, uint64_t a6)
{
  uint64_t result;
  unsigned int v10;
  BOOL v11;

  result = sub_2198508F8(a1, a2, a4);
  if (qword_253E46750)
  {
    v10 = *(unsigned __int8 *)(qword_253E46750 + a4 + 16);
    if (*(_BYTE *)(qword_253E46750 + a4 + 16))
      v11 = v10 >= a5;
    else
      v11 = 0;
    if (v11 && a6 != 0 && v10 <= 4)
      return phOsalNfc_SignPostLogTimerEvents();
  }
  return result;
}

uint64_t sub_219886334(int a1, unsigned int *a2, unsigned int a3, unsigned int a4, uint64_t a5)
{
  uint64_t result;
  uint64_t v9;
  uint64_t v10;
  unsigned int v11;
  unsigned int v15;

  result = sub_2198508F8(a1, a2, a3);
  if ((_DWORD)result != 1)
  {
    if ((_DWORD)result)
    {
      if (qword_253E467C0)
        v10 = qword_253E467C0 + 16;
      else
        v10 = 0;
      if ((_DWORD)result != 255)
        goto LABEL_23;
      v9 = qword_253E46750;
      if (!qword_253E46750)
        goto LABEL_23;
    }
    else
    {
      v9 = qword_253E46750;
      if (!qword_253E46750)
        return result;
      v10 = 0;
    }
    v11 = *(unsigned __int8 *)(v9 + a3 + 16);
    if (v11 >= 3 && v11 >= a4 && a5 != 0 && v11 < 5)
      return phOsalNfc_SignPostLogX32();
LABEL_23:
    if (!v10 || (_DWORD)result != 255)
      return result;
    goto LABEL_25;
  }
  if (!qword_253E467C0)
    return result;
  v10 = qword_253E467C0 + 16;
LABEL_25:
  v15 = *(unsigned __int8 *)(v10 + a3);
  if (v15 >= 3 && v15 >= a4 && a5 != 0 && v15 <= 4)
    return phOsalNfc_SignPostLogX32();
  return result;
}

uint64_t sub_21988642C(uint64_t a1, int a2, uint64_t a3, int a4)
{
  char v8;
  unsigned int v9;
  int v10;
  uint64_t v11;
  char v12;
  __int16 v13;
  unsigned __int8 v14;
  unsigned int v15;
  uint64_t v16;
  uint64_t v18;
  uint64_t v19;
  uint64_t v20;

  v20 = *MEMORY[0x24BDAC8D0];
  v18 = 0;
  v19 = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ReadWrite");
  *(_QWORD *)(a1 + 48) = sub_219886658;
  *(_QWORD *)(a1 + 56) = a1;
  v8 = 32;
  *(_DWORD *)(a1 + 232) = 32;
  v9 = *(unsigned __int16 *)(a1 + 640);
  if (v9 >= 0x100)
  {
    if (*(unsigned __int8 *)(a1 + 664) != 226)
      return 27;
    v10 = 0;
    LOBYTE(a2) = a2 | 0x10;
    v8 = 32;
  }
  else if (a2 == 33)
  {
    if ((*(_BYTE *)(a1 + 663) & 0x10) != 0)
      v8 = 96;
    else
      v8 = 32;
    v10 = 1;
  }
  else
  {
    v10 = 0;
  }
  *(_BYTE *)(a1 + 266) = v8;
  *(_BYTE *)(a1 + 267) = a2;
  phOsalNfc_MemCopy();
  v11 = *(_QWORD *)(a1 + 224);
  v12 = *(_BYTE *)(v11 + 16);
  v13 = *(_WORD *)(a1 + 640);
  *(_BYTE *)(a1 + 266 + (v12 + 2)) = v13;
  v14 = v12 + 3;
  if (v9 >= 0x100)
  {
    *(_BYTE *)(a1 + 266 + (v12 + 3)) = HIBYTE(v13);
    v14 = v12 + 4;
  }
  v15 = (((a2 - 33) >> 1) | (((_BYTE)a2 - 33) << 7));
  if (v15 <= 9 && ((1 << v15) & 0x303) != 0)
  {
    if (a3 && a4)
    {
      phOsalNfc_MemCopy();
      v14 += a4;
      v11 = *(_QWORD *)(a1 + 224);
    }
    sub_21988FDB0(*(_QWORD *)(a1 + 2712), v11 + 8, (uint64_t)&v18);
    if (v10 && (HIDWORD(v19) - 3) <= 3)
    {
      *(_BYTE *)(a1 + 266) |= 0x42u;
      *(_DWORD *)(a1 + 232) = 1;
      *(_WORD *)(a1 + 576) = 20;
    }
  }
  *(_WORD *)(a1 + 264) = 260;
  *(_WORD *)(a1 + 526) = v14;
  v16 = sub_219888630(a1, (uint64_t)sub_219887438);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ReadWrite");
  return v16;
}

uint64_t sub_219886658(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v6;
  char *v7;
  char v8;
  unsigned int v9;
  unsigned int v10;
  unsigned __int16 v11;
  __int16 v12;
  __int16 *v13;
  char v14;
  int v15;
  int v16;
  int v17;
  unsigned int v18;
  int v19;
  unsigned __int16 v20;
  __int16 v21;
  int v22;
  unsigned int v23;
  int v24;
  unsigned int v25;
  unsigned int v26;
  BOOL v27;
  int v28;
  int v29;
  unsigned int v30;
  int v31;
  uint64_t v32;
  int v33;
  unsigned int v34;
  int v35;
  BOOL v36;
  int v37;
  int v38;
  char v39;
  BOOL v40;
  BOOL v41;
  unsigned int v42;
  unsigned int v43;
  char v44;
  char v45;
  char v46;
  int v47;
  __int16 v48;
  int v49;
  char v50;
  const char *v51;
  int v52;
  char v53;
  int v54;
  char v55;
  unsigned __int8 v56;
  unsigned int v57;
  int v58;
  int v59;
  unsigned int v60;
  int v61;
  unsigned int v62;
  int v63;
  unsigned __int16 v64;
  int v65;
  __int16 v66;
  __int16 v67;
  int v68;
  uint64_t v69;
  unsigned __int16 v70;
  int v71;
  unsigned int v72;
  int v73;
  unsigned int v74;
  __int16 v75;
  int v76;
  unsigned int v77;
  unsigned int v78;
  int v79;
  int v80;
  unsigned __int8 v81;
  int v82;
  int v83;
  unsigned __int8 v84;
  char v85;
  unsigned int v86;
  char v87;
  char v88;
  int v89;
  unsigned int v90;
  int v91;
  int v92;
  int v93;
  int v94;
  BOOL v95;
  int v96;
  int v97;
  char v98;
  BOOL v99;
  uint64_t v100;
  uint64_t v101;
  _OWORD *v102;
  uint64_t v103;
  uint64_t v104;
  _OWORD v105[3];
  __int16 v106;
  uint64_t v107;

  v107 = *MEMORY[0x24BDAC8D0];
  v104 = a1;
  sub_219850718(0, (unsigned int *)&v104, 8u, 5u, (uint64_t)"phFriNfc_T5T_Process");
  if ((_BYTE)a3)
    goto LABEL_2;
  if (*(_BYTE *)(a2 + 266))
  {
    a3 = 255;
LABEL_6:
    sub_219887614((unsigned int *)a2, a3);
    return sub_219850808(0, (unsigned int *)&v104, 8u, 5u, (uint64_t)"phFriNfc_T5T_Process");
  }
  switch(*(_BYTE *)a2)
  {
    case 1:
      v6 = *(unsigned __int8 *)(a2 + 644);
      v7 = (char *)(a2 + 267);
      v8 = *(_BYTE *)(a2 + 264);
      sub_219850718(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessCheckNdef");
      v9 = *(unsigned __int8 *)(a2 + 665);
      if (!*(_BYTE *)(a2 + 665))
      {
        word_253E47022 = 0;
        sub_219850718(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_CheckCCBytes");
        v52 = *(unsigned __int16 *)(a2 + 640);
        if (v52 == 1)
          goto LABEL_184;
        if (!*(_WORD *)(a2 + 640))
        {
          v53 = *v7;
          if ((*v7 + 31) > 1u)
          {
            v54 = 0;
            a3 = 22;
            goto LABEL_187;
          }
          v54 = 0;
          v55 = *(_BYTE *)(a2 + 264);
          v56 = v55 - 1;
          *(_BYTE *)(a2 + 662) = v55 - 1;
          v57 = (((v55 - 5) >> 2) | ((v55 - 5) << 6));
          a3 = 22;
          if (v57 > 7 || ((1 << v57) & 0x8B) == 0)
          {
LABEL_187:
            v91 = *(unsigned __int8 *)(a2 + 665);
            if (v91 != 8)
              goto LABEL_190;
            goto LABEL_188;
          }
          *(_BYTE *)(a2 + 664) = v53;
          *(_BYTE *)(a2 + 663) = *(_BYTE *)(a2 + 270);
          v58 = *(unsigned __int8 *)(a2 + 269);
          if (*(_BYTE *)(a2 + 269))
          {
            a3 = 0;
            *(_BYTE *)(a2 + 665) = 4;
            v59 = 8 * v58;
            *(_DWORD *)(a2 + 648) = v59;
            *(_DWORD *)(a2 + 652) = v59;
LABEL_186:
            v54 = 1;
            goto LABEL_187;
          }
          if (v56 > 7u)
          {
LABEL_184:
            a3 = 0;
            *(_BYTE *)(a2 + 665) = 8;
            v54 = 1;
LABEL_188:
            v92 = (v7[6u % *(unsigned __int8 *)(a2 + 662)] << 11) | (8
                                                                                    * v7[6u % *(unsigned __int8 *)(a2 + 662) + 1]);
            *(_DWORD *)(a2 + 648) = v92;
            if (!v92)
            {
              a3 = 22;
              goto LABEL_206;
            }
            *(_DWORD *)(a2 + 652) = v92;
            v91 = 8;
LABEL_190:
            if (v54 && v91)
            {
              v93 = *(unsigned __int8 *)(*(_QWORD *)(a2 + 224) + 14);
              if (v93 == 7 || v93 == 4)
              {
                a3 = 0;
                v94 = *(_DWORD *)(a2 + 648) - v91;
                *(_DWORD *)(a2 + 648) = v94;
                *(_DWORD *)(a2 + 652) = v94;
              }
              else
              {
                a3 = 0;
              }
            }
            if (v91)
              v95 = *(unsigned __int8 *)(a2 + 664) == 225;
            else
              v95 = 0;
            if (!v95)
              v54 = 0;
            if (v54 == 1)
            {
              if ((((unsigned __int16)((*(_DWORD *)(a2 + 648) + v91) / *(unsigned __int8 *)(a2 + 662))
                   - ((*(_DWORD *)(a2 + 648) + v91) % *(unsigned __int8 *)(a2 + 662) == 0)) & 0xFF00) != 0)
                a3 = 22;
              else
                a3 = a3;
            }
LABEL_206:
            if (a3 | v52)
              goto LABEL_215;
            v96 = *(char *)(a2 + 268);
            if ((v96 & 0x80000000) == 0)
            {
              v97 = v96 & 0xF;
              if (!v97)
              {
                v98 = 2;
                goto LABEL_214;
              }
              if (v97 == 3)
              {
                v98 = 1;
LABEL_214:
                *(_BYTE *)(a2 + 545) = v98;
LABEL_215:
                sub_219850808(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_CheckCCBytes");
                if ((_DWORD)a3)
                {
                  v14 = 0;
                  goto LABEL_217;
                }
                v9 = *(unsigned __int8 *)(a2 + 665);
                v10 = v9;
                if (!*(_BYTE *)(a2 + 665))
                {
                  ++*(_WORD *)(a2 + 640);
                  a3 = sub_21988642C(a2, 32, 0, 0);
                  goto LABEL_2;
                }
                goto LABEL_11;
              }
            }
            sub_219850808(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_CheckCCBytes");
            goto LABEL_212;
          }
        }
        a3 = 0;
        goto LABEL_186;
      }
      v10 = 0;
LABEL_11:
      if (v10 >= (v8 - 1) || v6 == 2)
      {
        if (v6 == 2)
          goto LABEL_176;
LABEL_118:
        if (v6 == 4)
        {
          v70 = *(_WORD *)(a2 + 656);
          *(_WORD *)(a2 + 640) = v70;
          v71 = *(unsigned __int8 *)(a2 + 662);
          if (v71 - 1 == *(unsigned __int8 *)(a2 + 658))
          {
            LOBYTE(v6) = 0;
            *(_WORD *)(a2 + 640) = ++v70;
          }
          else
          {
            LOBYTE(v6) = 4;
          }
        }
        else
        {
          v70 = *(_WORD *)(a2 + 640) + 1;
          *(_WORD *)(a2 + 640) = v70;
          v71 = *(unsigned __int8 *)(a2 + 662);
        }
        if (*(_DWORD *)(a2 + 648) + v9 != v71 * v70)
        {
          a3 = sub_21988642C(a2, 32, 0, 0);
          v14 = v6;
          goto LABEL_217;
        }
        goto LABEL_212;
      }
      v11 = word_253E47022;
      v12 = word_253E47020;
      v13 = (__int16 *)(a2 + 646);
      a3 = 245;
      while (2)
      {
        v14 = 0;
        v15 = v10;
        switch(v6)
        {
          case 0:
            v16 = v7[v10];
            if (v16 == 3)
            {
              *(_BYTE *)(a2 + 658) = v10;
              *(_WORD *)(a2 + 656) = *(_WORD *)(a2 + 640);
              goto LABEL_32;
            }
            if (v16 != 254)
              goto LABEL_36;
            goto LABEL_212;
          case 1:
            if (v12)
            {
              if (v12 == 1)
              {
                *v13 = v7[v10] << 8;
                v12 = 2;
                goto LABEL_31;
              }
              if (v12 != 2)
              {
LABEL_177:
                v14 = 0;
                a3 = 245;
                goto LABEL_217;
              }
              LOWORD(v17) = *v13 | v7[v10];
              *v13 = v17;
              word_253E47020 = 0;
              if ((unsigned __int16)(v17 + 1) >= 0x100u)
              {
                v85 = 0;
                goto LABEL_163;
              }
LABEL_212:
              v14 = 0;
              a3 = 22;
              goto LABEL_217;
            }
            v17 = v7[v10];
            if (v17 == 255)
            {
              v12 = 1;
LABEL_31:
              word_253E47020 = v12;
LABEL_32:
              v6 = 1;
LABEL_43:
              LOBYTE(v10) = v10 + 1;
              if (v10 >= (v8 - 1))
                goto LABEL_118;
              continue;
            }
            if (v7[v10])
            {
              *v13 = v17;
              v13 = &word_253E47020;
            }
            *v13 = 0;
            v85 = 1;
LABEL_163:
            v86 = *(_DWORD *)(a2 + 648)
                + v9
                + ~(v10 + *(unsigned __int8 *)(a2 + 662) * *(unsigned __int16 *)(a2 + 640));
            *(_DWORD *)(a2 + 648) = v86;
            if (v86 < (unsigned __int16)v17)
              goto LABEL_212;
            if (*(_BYTE *)(a2 + 545) == 1)
              v87 = 1;
            else
              v87 = 2 * ((unsigned __int16)v17 != 0);
            *(_BYTE *)(a2 + 545) = v87;
            if (v86 >= 0xFFFE)
              v86 = 65534;
            *(_DWORD *)(a2 + 648) = v86;
            v88 = v85 ^ 1;
            if (v86 < 0xFF)
              v88 = 1;
            if ((v88 & 1) == 0)
            {
              if (v86 == 255)
                v89 = 254;
              else
                v89 = v86 - 2;
              *(_DWORD *)(a2 + 648) = v89;
            }
LABEL_176:
            a3 = 0;
            v14 = 0;
            *(_BYTE *)(a2 + 544) = 9;
LABEL_217:
            *(_BYTE *)(a2 + 644) = v14;
            v51 = "phFriNfc_T5T_H_ProcessCheckNdef";
LABEL_246:
            sub_219850808(2, (unsigned int *)a2, 8u, 5u, (uint64_t)v51);
LABEL_2:
            if ((_DWORD)a3 != 13)
              goto LABEL_6;
            return sub_219850808(0, (unsigned int *)&v104, 8u, 5u, (uint64_t)"phFriNfc_T5T_Process");
          case 3:
            if (v12 == 2)
            {
              v11 |= v7[v10];
              word_253E47022 = v11;
              word_253E47020 = 0;
              if (((unsigned __int16)(v11 - 255) >> 8) == 255)
                goto LABEL_212;
              goto LABEL_39;
            }
            if (v12 == 1)
            {
              v11 = v7[v10] << 8;
              word_253E47022 = v11;
              v12 = 2;
              word_253E47020 = 2;
              goto LABEL_36;
            }
            if (v12)
              goto LABEL_177;
            v6 = v7[v10];
            if (v7[v10])
            {
              if (v6 == 255)
              {
                v12 = 1;
                word_253E47020 = 1;
LABEL_36:
                v6 = 3;
                goto LABEL_43;
              }
              word_253E47022 = v7[v10];
              word_253E47020 = 0;
              v11 = v6;
LABEL_39:
              v18 = *(unsigned __int8 *)(a2 + 662);
              v19 = v15 + v18 * *(unsigned __int16 *)(a2 + 640);
              if (v9 - 5 + *(_DWORD *)(a2 + 648) + ~v19 < v11)
                goto LABEL_212;
              v12 = 0;
              v20 = v11 + v19;
              *(_BYTE *)(a2 + 658) = v20 % v18;
              *(_WORD *)(a2 + 656) = v20 / v18;
              v10 = v11 + v15;
              if (v10 >= (v8 - 1))
                LOBYTE(v10) = v8 - 1;
              v6 = 4;
              goto LABEL_43;
            }
            v12 = 0;
            goto LABEL_43;
          case 4:
            v6 = 0;
            LOBYTE(v10) = *(_BYTE *)(a2 + 658);
            goto LABEL_43;
          default:
            goto LABEL_217;
        }
      }
    case 2:
      v21 = *(_WORD *)(a2 + 264);
      sub_219850718(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessReadNdef");
      if (*(_BYTE *)(a2 + 560) || (LOBYTE(v30) = *(_BYTE *)(a2 + 659), !(_BYTE)v30))
      {
        v22 = *(unsigned __int8 *)(a2 + 658);
        v23 = *(unsigned __int16 *)(a2 + 646);
        if (v23 <= 0xFE)
          v24 = v22 + 1;
        else
          v24 = v22 + 3;
        v25 = v24 + 1;
        v26 = *(unsigned __int8 *)(a2 + 662);
        v27 = v25 >= v26;
        v28 = *(unsigned __int16 *)(a2 + 656);
        if (v27)
          ++v28;
        if (v28 == *(unsigned __int16 *)(a2 + 640))
        {
          if (v23 <= 0xFE)
            v29 = v22 + 1;
          else
            v29 = v22 + 3;
          v30 = (v29 + 1) % v26;
        }
        else
        {
          LOBYTE(v30) = 0;
        }
      }
      *(_BYTE *)(a2 + 659) = 0;
      v60 = *(unsigned __int16 *)(a2 + 660);
      v61 = *(unsigned __int16 *)(a2 + 252);
      v62 = *(_DWORD *)(a2 + 248) - v61;
      v63 = (v21 - 1) - v30;
      if (v62 >= v60)
      {
        if (v63 >= (int)v60)
          LOWORD(v63) = *(_WORD *)(a2 + 660);
      }
      else if (v62 < (unsigned __int16)v63)
      {
        *(_BYTE *)(a2 + 659) = (v30 + (unsigned __int16)(*(_WORD *)(a2 + 248) - v61))
                             % *(unsigned __int8 *)(a2 + 662);
        LOWORD(v63) = v62;
      }
      phOsalNfc_MemCopy();
      v64 = *(_WORD *)(a2 + 252) + v63;
      *(_WORD *)(a2 + 252) = v64;
      v65 = *(unsigned __int16 *)(a2 + 660);
      *(_WORD *)(a2 + 660) = v65 - v63;
      v66 = *(_WORD *)(a2 + 640);
      if ((*(_BYTE *)(a2 + 663) & 1) != 0)
      {
        v67 = v66 + *(unsigned __int8 *)(a2 + 666);
        *(_WORD *)(a2 + 640) = v67;
        v68 = v64;
        if (*(_DWORD *)(a2 + 248) > v64 && v65 != (unsigned __int16)v63)
        {
          v69 = sub_2198874CC(a2);
          goto LABEL_112;
        }
      }
      else
      {
        v67 = v66 + 1;
        *(_WORD *)(a2 + 640) = v67;
        v68 = v64;
        if (*(_DWORD *)(a2 + 248) > v64 && v65 != (unsigned __int16)v63)
        {
          v69 = sub_21988642C(a2, 32, 0, 0);
LABEL_112:
          a3 = v69;
          goto LABEL_116;
        }
      }
      if (*(_BYTE *)(a2 + 659))
        *(_WORD *)(a2 + 640) = v67 - 1;
      a3 = 0;
      **(_DWORD **)(a2 + 552) = v68;
LABEL_116:
      v51 = "phFriNfc_T5T_H_ProcessReadNdef";
      goto LABEL_246;
    case 3:
      v31 = *(unsigned __int8 *)(a2 + 644);
      v106 = 0;
      memset(v105, 0, sizeof(v105));
      v32 = *(unsigned __int8 *)(a2 + 662);
      sub_219850718(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessWriteNdef");
      switch(v31)
      {
        case 0:
          if ((_DWORD)v32 != (*(_BYTE *)(a2 + 264) - 1))
          {
            v83 = 0;
            LOBYTE(v31) = 0;
            goto LABEL_156;
          }
          phOsalNfc_MemCopy();
          v33 = *(unsigned __int8 *)(a2 + 658);
          v34 = (v33 + 1) % v32;
          if (*(_DWORD *)(a2 + 248) <= 0xFEu)
            v35 = 1;
          else
            v35 = 3;
          v36 = *(unsigned __int8 *)(a2 + 662) - 1 <= v33;
          v37 = *(unsigned __int16 *)(a2 + 656);
          if (v36)
            ++v37;
          v38 = *(unsigned __int16 *)(a2 + 640);
          v39 = v32 - v34;
          if (v35 + v34 <= v32)
            v39 = v35;
          v40 = v37 == v38;
          v41 = v37 == v38 && v35 + v34 > v32;
          if (v40)
            LOBYTE(v42) = v39;
          else
            v42 = (unsigned __int16)(v34 + v35) % v32;
          if (v40)
            v43 = v34;
          else
            v43 = 0;
          if (v43 + v35 <= v32)
            LOBYTE(v31) = 2;
          else
            LOBYTE(v31) = v41;
          phOsalNfc_SetMemory();
          v44 = v42 + v43;
          if (v32 <= (v42 + v43))
            goto LABEL_230;
          if (*(_DWORD *)(a2 + 248) - *(unsigned __int16 *)(a2 + 252) >= (v32 - v44))
            v45 = v32 - v44;
          else
            v45 = *(_BYTE *)(a2 + 248) - *(_WORD *)(a2 + 252);
          phOsalNfc_MemCopy();
          v46 = 0;
          a3 = 0;
          v47 = 0;
          v48 = (v45 + *(_BYTE *)(a2 + 252));
          goto LABEL_233;
        case 1:
          v46 = 0;
          a3 = 0;
          LOBYTE(v31) = 0;
          ++*(_WORD *)(a2 + 640);
          goto LABEL_146;
        case 2:
          v72 = *(_DWORD *)(a2 + 248);
          v73 = *(unsigned __int16 *)(a2 + 252);
          v74 = v72 - v73;
          if (v72 != v73)
          {
            ++*(_WORD *)(a2 + 640);
            if (v74 >= v32)
            {
              LOBYTE(v31) = 2;
              if (v74 == (_DWORD)v32)
              {
                if (v72 >= *(_DWORD *)(a2 + 648))
                  LOBYTE(v31) = 2;
                else
                  LOBYTE(v31) = 3;
              }
              v84 = v32;
            }
            else
            {
              v84 = v72 - v73;
              *((_BYTE *)v105 + (v72 - v73)) = -2;
              LOBYTE(v31) = 2;
            }
            phOsalNfc_MemCopy();
            v46 = 0;
            a3 = 0;
            v47 = 0;
            v48 = *(_WORD *)(a2 + 252) + v84;
LABEL_233:
            *(_WORD *)(a2 + 252) = v48;
            goto LABEL_234;
          }
          v46 = 0;
          a3 = 0;
          v75 = *(_WORD *)(a2 + 656);
          if ((int)v32 - 1 <= *(unsigned __int8 *)(a2 + 658))
            ++v75;
LABEL_144:
          *(_WORD *)(a2 + 640) = v75;
          LOBYTE(v31) = 4;
LABEL_146:
          v83 = 1;
          goto LABEL_147;
        case 3:
          v46 = 0;
          a3 = 0;
          v47 = 0;
          ++*(_WORD *)(a2 + 640);
          LOBYTE(v105[0]) = -2;
          LOBYTE(v31) = 2;
          goto LABEL_234;
        case 4:
          if ((_DWORD)v32 == (*(_BYTE *)(a2 + 264) - 1))
          {
            phOsalNfc_MemCopy();
            v76 = *(unsigned __int8 *)(a2 + 658);
            v77 = (v76 + 1) % v32;
            v78 = *(_DWORD *)(a2 + 248);
            if (v78 < 0xFF)
              v79 = 1;
            else
              v79 = 3;
            v36 = *(unsigned __int8 *)(a2 + 662) - 1 <= v76;
            v80 = *(unsigned __int16 *)(a2 + 656);
            if (v36)
              ++v80;
            if (v80 == *(unsigned __int16 *)(a2 + 640))
            {
              if (v79 + (unsigned __int16)v77 > v32)
                LOBYTE(v31) = 5;
              else
                LOBYTE(v31) = 6;
              if (v79 + (unsigned __int16)v77 > v32)
                LOBYTE(v79) = v32 - v77;
              if (v78 > 0xFE)
              {
                *((_BYTE *)v105 + (unsigned __int16)v77) = -1;
                v81 = v77 + 1;
              }
              else
              {
                *((_BYTE *)v105 + (unsigned __int16)v77) = v78;
                v81 = v77;
              }
              LOBYTE(v90) = v79 - 1;
            }
            else
            {
              v81 = 0;
              v90 = (unsigned __int16)(v77 + v79) % v32;
              LOBYTE(v31) = 6;
            }
            if (v90 == 2 || (v90 == 1 ? (v99 = v81 == 0) : (v99 = 1), !v99))
            {
              *((_BYTE *)v105 + v81++) = *(_BYTE *)(a2 + 253);
              LOBYTE(v90) = v90 - 1;
            }
            if (v90 == 1)
            {
              v46 = 0;
              a3 = 0;
              v47 = 0;
              *((_BYTE *)v105 + v81) = *(_BYTE *)(a2 + 252);
            }
            else
            {
LABEL_230:
              v46 = 0;
              a3 = 0;
              v47 = 0;
            }
LABEL_234:
            v83 = 1;
          }
          else
          {
            v83 = 0;
            LOBYTE(v31) = 4;
LABEL_156:
            a3 = 27;
            v46 = 1;
LABEL_147:
            v47 = 1;
          }
          if (*(_WORD *)(a2 + 252))
          {
            if (**(_DWORD **)(a2 + 256) == *(unsigned __int16 *)(a2 + 252))
              v46 = 1;
            if ((v46 & 1) != 0)
            {
LABEL_245:
              *(_BYTE *)(a2 + 644) = v31;
              v51 = "phFriNfc_T5T_H_ProcessWriteNdef";
              goto LABEL_246;
            }
          }
          else if (!v83)
          {
            goto LABEL_245;
          }
          if (v47)
          {
            v100 = a2;
            v101 = 32;
            v102 = 0;
            v103 = 0;
          }
          else
          {
            v102 = v105;
            v100 = a2;
            v101 = 33;
            v103 = v32;
          }
          a3 = sub_21988642C(v100, v101, v102, v103);
          goto LABEL_245;
        case 5:
          v46 = 0;
          a3 = 0;
          v75 = *(_WORD *)(a2 + 640) + 1;
          goto LABEL_144;
        case 6:
          v46 = 0;
          a3 = 0;
          v82 = *(unsigned __int16 *)(a2 + 252);
          **(_DWORD **)(a2 + 256) = v82;
          *(_WORD *)(a2 + 646) = v82;
          LOBYTE(v31) = 6;
          goto LABEL_146;
        default:
          v46 = 0;
          a3 = 0;
          goto LABEL_146;
      }
    case 4:
      LODWORD(v105[0]) = 0;
      sub_219850718(2, (unsigned int *)a2, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessRdOnlyNdef");
      v49 = *(unsigned __int16 *)(a2 + 264);
      if (v49 - 1 == *(unsigned __int8 *)(a2 + 665))
      {
        phOsalNfc_MemCopy();
        if (sub_21987BA3C(*(_QWORD *)(a2 + 2712)) == 1)
          v50 = 0;
        else
          v50 = 3;
        BYTE1(v105[0]) = BYTE1(v105[0]) & 0xFC | v50;
        a3 = sub_21988642C(a2, 33, v105, 4);
      }
      else if (v49 == 1)
      {
        a3 = 0;
      }
      else
      {
        a3 = 255;
      }
      v51 = "phFriNfc_T5T_H_ProcessRdOnlyNdef";
      goto LABEL_246;
    default:
      goto LABEL_2;
  }
}

uint64_t sub_219887438(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_T5T_CB_Transceive");
  sub_21988EF68(v10, &v9);
  v7 = v9;
  if (v9)
  {
    if (a4)
      *(_WORD *)(v9 + 264) = *(_DWORD *)(a4 + 8);
    (*(void (**)(_QWORD, uint64_t, uint64_t))(v7 + 48))(*(_QWORD *)(v7 + 2712), v7, a5);
  }
  return sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_T5T_CB_Transceive");
}

uint64_t sub_2198874CC(uint64_t a1)
{
  unsigned int v2;
  int v3;
  unsigned int v4;
  int v5;
  unsigned int v6;
  int v7;
  unsigned int v8;
  int v9;
  int v10;
  unsigned int v11;
  unsigned __int8 v12;
  uint64_t v13;
  uint64_t v14;
  __int16 v16;

  v16 = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_ReadRemainingInMultiple");
  v2 = *(_DWORD *)(a1 + 248) - *(unsigned __int16 *)(a1 + 252);
  v3 = *(unsigned __int8 *)(a1 + 658);
  v4 = *(unsigned __int16 *)(a1 + 646);
  if (v4 <= 0xFE)
    v5 = v3 + 1;
  else
    v5 = v3 + 3;
  v6 = *(unsigned __int8 *)(a1 + 662);
  if (v5 + 1 < v6)
    v7 = *(unsigned __int16 *)(a1 + 656);
  else
    v7 = *(unsigned __int16 *)(a1 + 656) + 1;
  v8 = *(unsigned __int16 *)(a1 + 640);
  if (v7 == v8)
  {
    if (v4 <= 0xFE)
      v9 = v3 + 1;
    else
      v9 = v3 + 3;
    v2 += (v9 + 1) % v6;
  }
  if (v2 <= v6)
  {
    v12 = 0;
    *(_BYTE *)(a1 + 666) = 1;
    v13 = 32;
  }
  else
  {
    if (*(_BYTE *)(a1 + 662))
    {
      if (v2 >= 0xFE)
        v10 = 254;
      else
        v10 = v2;
      v11 = v10 / v6;
      *(_BYTE *)(a1 + 666) = v11;
      if (v10 + v6 <= 0xFE && v10 % v6)
      {
        LOBYTE(v11) = v11 + 1;
        *(_BYTE *)(a1 + 666) = v11;
      }
    }
    else
    {
      LOBYTE(v11) = *(_BYTE *)(a1 + 666);
    }
    LOBYTE(v16) = v11 - 1;
    if (v8 <= 0xFF)
      v12 = 1;
    else
      v12 = 2;
    v13 = 35;
  }
  v14 = sub_21988642C(a1, v13, &v16, v12);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_ReadRemainingInMultiple");
  return v14;
}

uint64_t sub_219887614(unsigned int *a1, uint64_t a2)
{
  int v4;
  char v5;
  uint64_t v6;
  char v7;
  unsigned int v8;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  unsigned int v13;

  v13 = 0;
  v11 = 0;
  v12 = 0;
  v10 = 0;
  v4 = *(unsigned __int8 *)a1;
  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_Complete");
  *(_BYTE *)a1 = 0;
  switch(v4)
  {
    case 1:
      if ((_DWORD)a2)
      {
        v5 = 0;
        if (a2 == 22)
          v6 = 152;
        else
          v6 = a2;
        v7 = 3;
      }
      else
      {
        v6 = 0;
        v8 = a1[162];
        HIDWORD(v12) = *((unsigned __int16 *)a1 + 323);
        v13 = v8;
        v7 = *((_BYTE *)a1 + 545);
        v5 = 1;
      }
      *((_BYTE *)a1 + 546) = v5;
      LOBYTE(v12) = v7;
      (*((void (**)(_QWORD, uint64_t, uint64_t *))a1 + 1))(*((_QWORD *)a1 + 5), v6, &v12);
      break;
    case 2:
      if (!(_DWORD)a2)
      {
        LODWORD(v11) = **((_DWORD **)a1 + 69);
        v10 = *((_QWORD *)a1 + 30);
      }
      (*((void (**)(_QWORD, uint64_t, uint64_t *))a1 + 2))(*((_QWORD *)a1 + 5), a2, &v10);
      break;
    case 3:
      *((_BYTE *)a1 + 545) = 2 * (**((_DWORD **)a1 + 32) != 0);
      (*((void (**)(_QWORD, uint64_t))a1 + 3))(*((_QWORD *)a1 + 5), a2);
      break;
    case 4:
      if (!(_DWORD)a2)
        *((_BYTE *)a1 + 545) = 1;
      (*((void (**)(_QWORD, uint64_t))a1 + 4))(*((_QWORD *)a1 + 5), a2);
      break;
    default:
      return sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_Complete");
  }
  return sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_Complete");
}

uint64_t sub_219887770(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_T5T_ChkNdef");
  sub_21988EF68(v10, &v9);
  v5 = v9;
  if (v9)
  {
    v6 = 1;
    if (a2 && a3)
    {
      if (*(_BYTE *)v9)
      {
        v6 = 111;
      }
      else
      {
        *(_QWORD *)(v9 + 8) = a2;
        *(_QWORD *)(v5 + 40) = a3;
        phOsalNfc_SetMemory();
        v8 = v9;
        *(_BYTE *)v9 = 1;
        v6 = sub_21988642C(v8, 32, 0, 0);
        if ((_DWORD)v6 != 13)
          *(_BYTE *)v9 = 0;
      }
    }
  }
  else
  {
    v6 = 49;
  }
  sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_T5T_ChkNdef");
  return v6;
}

uint64_t sub_219887864(uint64_t a1, uint64_t a2, _DWORD *a3, unsigned int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  unsigned int v14;
  unsigned int v15;
  unsigned int v16;
  int v17;
  BOOL v18;
  __int16 v19;
  _BYTE *v21;
  uint64_t v22;

  v21 = 0;
  v22 = a1;
  sub_219850718(0, (unsigned int *)&v22, 8u, 5u, (uint64_t)"phFriNfc_T5T_RdNdef");
  sub_21988EF68(v22, &v21);
  v11 = (uint64_t)v21;
  if (!v21)
  {
    v12 = 49;
    goto LABEL_35;
  }
  v12 = 1;
  if (a4 <= 1 && a3 && a2 && a5)
  {
    if (!v21[546])
    {
      v12 = 152;
      goto LABEL_35;
    }
    if (*v21)
    {
      v12 = 111;
      goto LABEL_35;
    }
    if (v21[545] == 3)
    {
      v12 = 28;
      goto LABEL_34;
    }
    *v21 = 2;
    *(_QWORD *)(v11 + 240) = a2;
    *(_DWORD *)(v11 + 248) = *a3;
    *(_QWORD *)(v11 + 552) = a3;
    *a3 = 0;
    *(_WORD *)(v11 + 252) = 0;
    *(_BYTE *)(v11 + 560) = a4;
    *(_QWORD *)(v11 + 16) = a5;
    *(_QWORD *)(v11 + 40) = a6;
    if (a4 == 1 && !*(_BYTE *)(v11 + 65))
    {
      *(_BYTE *)(v11 + 644) = 0;
      *(_WORD *)(v11 + 642) = *(unsigned __int8 *)(v11 + 665) / *(unsigned __int8 *)(v11 + 662);
      v13 = sub_219887A4C(v11);
LABEL_32:
      v12 = v13;
      if ((_DWORD)v13 == 13)
        goto LABEL_35;
      v11 = (uint64_t)v21;
LABEL_34:
      *(_BYTE *)v11 = 0;
      goto LABEL_35;
    }
    v14 = *(_DWORD *)(v11 + 248);
    v15 = *(unsigned __int16 *)(v11 + 646);
    if (v14 > v15)
    {
      *(_DWORD *)(v11 + 248) = v15;
      v14 = v15;
    }
    v16 = *(unsigned __int16 *)(v11 + 660);
    if (*(_WORD *)(v11 + 660))
    {
      if (!a4)
      {
        if (v14 > v16)
          *(_DWORD *)(v11 + 248) = v16;
LABEL_29:
        if ((*(_BYTE *)(v11 + 663) & 1) != 0)
          v13 = sub_2198874CC(v11);
        else
          v13 = sub_21988642C(v11, 32, 0, 0);
        goto LABEL_32;
      }
    }
    else if (!a4)
    {
      v12 = 26;
      goto LABEL_34;
    }
    *(_WORD *)(v11 + 660) = v15;
    if (v15 <= 0xFE)
      v17 = 2;
    else
      v17 = 4;
    v18 = v17 + *(unsigned __int8 *)(v11 + 658) >= *(unsigned __int8 *)(v11 + 662);
    v19 = *(_WORD *)(v11 + 656);
    if (v18)
      ++v19;
    *(_WORD *)(v11 + 640) = v19;
    goto LABEL_29;
  }
LABEL_35:
  sub_219850808(0, (unsigned int *)&v22, 8u, 5u, (uint64_t)"phFriNfc_T5T_RdNdef");
  return v12;
}

uint64_t sub_219887A4C(uint64_t a1)
{
  unsigned int v2;
  char v3;
  char v4;
  __int16 v5;
  unsigned __int8 v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_RdDynamicNdef");
  *(_QWORD *)(a1 + 56) = a1;
  *(_DWORD *)(a1 + 232) = 32;
  v2 = *(unsigned __int16 *)(a1 + 642);
  v3 = 32;
  if (v2 >= 0x100)
  {
    if (*(unsigned __int8 *)(a1 + 664) != 226)
      return 27;
    v3 = 48;
  }
  *(_BYTE *)(a1 + 266) = 32;
  *(_BYTE *)(a1 + 267) = v3;
  phOsalNfc_MemCopy();
  v4 = *(_BYTE *)(*(_QWORD *)(a1 + 224) + 16);
  v5 = *(_WORD *)(a1 + 642);
  *(_BYTE *)(a1 + 266 + (v4 + 2)) = v5;
  v6 = v4 + 3;
  if (v2 >= 0x100)
  {
    *(_BYTE *)(a1 + 266 + (v4 + 3)) = HIBYTE(v5);
    v6 = v4 + 4;
  }
  *(_WORD *)(a1 + 264) = 260;
  *(_WORD *)(a1 + 526) = v6;
  v7 = sub_219888630(a1, (uint64_t)sub_219887EB0);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_T5T_RdDynamicNdef");
  return v7;
}

uint64_t sub_219887B5C(uint64_t a1, uint64_t a2, _DWORD *a3, char a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  unsigned int v13;
  uint64_t v14;
  _DWORD *v15;
  uint64_t v16;
  signed int v17;
  __int16 v18;
  unsigned int v19;
  __int16 v20;
  __int16 v21;
  uint64_t v23;
  __int16 v24;
  char v25;
  uint64_t v26;
  _OWORD v27[3];
  __int16 v28;
  uint64_t v29;

  v29 = *MEMORY[0x24BDAC8D0];
  v26 = a1;
  v28 = 0;
  memset(v27, 0, sizeof(v27));
  v25 = 0;
  v24 = 208;
  v23 = 0;
  sub_219850718(0, (unsigned int *)&v26, 8u, 5u, (uint64_t)"phFriNfc_T5T_WrNdef");
  sub_21988EF68(v26, &v23);
  v11 = v23;
  if (v23)
  {
    v12 = 1;
    if (a3 && a5)
    {
      if (*(_BYTE *)(v23 + 546))
      {
        if (*(_BYTE *)v23)
        {
          v12 = 111;
        }
        else if (*a3 <= *(_DWORD *)(v23 + 648))
        {
          if (*(_BYTE *)(v23 + 545) == 1)
          {
            *(_QWORD *)(v23 + 256) = a3;
            *a3 = 0;
            v12 = 58;
          }
          else
          {
            v13 = *(unsigned __int8 *)(v23 + 662);
            phOsalNfc_MemCopy();
            v14 = v23;
            v15 = (_DWORD *)(v23 + 2740);
            *(_DWORD *)(v23 + 2740) = 3;
            if (*a3)
            {
              v15 = a3;
              v16 = a2;
            }
            else
            {
              v16 = v14 + 2736;
            }
            *(_QWORD *)(v14 + 256) = v15;
            *(_BYTE *)v14 = 3;
            *(_QWORD *)(v14 + 240) = v16;
            *(_DWORD *)(v14 + 248) = *v15;
            *(_QWORD *)(v14 + 552) = v15;
            *v15 = 0;
            *(_WORD *)(v14 + 252) = 0;
            *(_BYTE *)(v14 + 560) = a4;
            *(_QWORD *)(v14 + 24) = a5;
            *(_QWORD *)(v14 + 40) = a6;
            v17 = *(unsigned __int8 *)(v11 + 658);
            v18 = *(_WORD *)(v11 + 656);
            if ((int)(v13 - 1) <= v17)
              ++v18;
            *(_WORD *)(v11 + 640) = v18;
            if ((v17 + 1) % v13)
            {
              *(_BYTE *)(v11 + 644) = 0;
              v12 = sub_21988642C(v14, 32, 0, 0);
            }
            else
            {
              v19 = *(_DWORD *)(v14 + 248);
              *(_BYTE *)(v11 + 644) = 2;
              if (v19 <= 0xFE)
                v20 = 1;
              else
                v20 = 3;
              phOsalNfc_SetMemory();
              v21 = v13 - v20;
              phOsalNfc_MemCopy();
              v12 = sub_21988642C(v23, 33, (uint64_t)v27, v13);
              *(_WORD *)(v23 + 252) += v21;
            }
            if ((_DWORD)v12 != 13)
              *(_BYTE *)v23 = 0;
          }
        }
        else
        {
          v12 = 31;
        }
      }
      else
      {
        v12 = 152;
      }
    }
  }
  else
  {
    v12 = 49;
  }
  sub_219850808(0, (unsigned int *)&v26, 8u, 5u, (uint64_t)"phFriNfc_T5T_WrNdef");
  return v12;
}

uint64_t sub_219887DDC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_T5T_ConvertToReadOnlyNdef");
  sub_21988EF68(v9, &v8);
  v5 = v8;
  if (v8)
  {
    if (a2)
    {
      if (*(_BYTE *)(v8 + 665) == 4)
      {
        *(_QWORD *)(v8 + 32) = a2;
        *(_QWORD *)(v5 + 40) = a3;
        *(_BYTE *)v5 = 4;
        *(_WORD *)(v5 + 640) = 0;
        v6 = sub_21988642C(v5, 32, 0, 0);
        if ((_DWORD)v6 != 13)
          *(_BYTE *)v8 = 0;
      }
      else
      {
        v6 = 51;
      }
    }
    else
    {
      v6 = 1;
    }
  }
  else
  {
    v6 = 49;
  }
  sub_219850808(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_T5T_ConvertToReadOnlyNdef");
  return v6;
}

uint64_t sub_219887EB0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, unsigned int a5)
{
  uint64_t v7;
  int v8;
  uint64_t v9;
  unsigned __int8 v10;
  int v11;
  unsigned int v12;
  int v13;
  unsigned int v14;
  unsigned __int16 v15;
  __int16 v16;
  __int16 *v17;
  int v18;
  int v19;
  unsigned int v20;
  int v21;
  unsigned __int16 v22;
  uint64_t v23;
  unsigned __int16 v24;
  int v25;
  char v26;
  unsigned int v27;
  char v28;
  char v29;
  int v30;
  unsigned int v31;
  uint64_t v32;
  unsigned int v33;
  unsigned int v34;
  int v35;
  BOOL v36;
  __int16 v37;
  uint64_t v38;
  uint64_t v40;
  uint64_t v41;

  v40 = 0;
  v41 = a1;
  sub_219850718(0, (unsigned int *)&v41, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessDynamicRdNdef");
  sub_21988EF68(v41, &v40);
  if (!a4)
    return sub_219850808(0, (unsigned int *)&v41, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessDynamicRdNdef");
  v7 = v40;
  if (!v40)
    return sub_219850808(0, (unsigned int *)&v41, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessDynamicRdNdef");
  if ((_BYTE)a5)
  {
    v8 = 0;
    v9 = 0;
    v10 = 0;
  }
  else
  {
    v11 = *(_DWORD *)(a4 + 8);
    *(_WORD *)(v40 + 264) = v11;
    v8 = *(unsigned __int8 *)(v7 + 644);
    v9 = v7 + 267;
    v10 = v11 - 1;
    if (*(_BYTE *)(v7 + 266))
      a5 = 255;
  }
  v12 = v10;
  if (!v10 || a5 || v8 == 2)
  {
    if (a5)
    {
      LOBYTE(v8) = 0;
      v23 = v7;
    }
    else
    {
      if (v8 == 2)
        goto LABEL_75;
LABEL_45:
      if (v8 == 4)
      {
        v24 = *(_WORD *)(v7 + 656);
        *(_WORD *)(v7 + 642) = v24;
        v25 = *(unsigned __int8 *)(v7 + 662);
        if (v25 - 1 == *(unsigned __int8 *)(v7 + 658))
        {
          LOBYTE(v8) = 0;
          *(_WORD *)(v7 + 642) = ++v24;
        }
        else
        {
          LOBYTE(v8) = 4;
        }
      }
      else
      {
        v24 = *(_WORD *)(v7 + 642) + 1;
        *(_WORD *)(v7 + 642) = v24;
        v25 = *(unsigned __int8 *)(v7 + 662);
      }
      if (*(_DWORD *)(v7 + 652) + *(unsigned __int8 *)(v7 + 665) == v25 * v24)
        goto LABEL_51;
      a5 = sub_219887A4C(v7);
      v23 = v40;
    }
    *(_BYTE *)(v23 + 644) = v8;
    if (a5 != 13)
      goto LABEL_78;
    return sub_219850808(0, (unsigned int *)&v41, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessDynamicRdNdef");
  }
  v13 = 0;
  LOBYTE(v14) = 0;
  v15 = word_253E47026;
  v16 = word_253E47024;
  v17 = (__int16 *)(v7 + 646);
  a5 = 245;
  while (2)
  {
    switch(v8)
    {
      case 0:
        v18 = *(unsigned __int8 *)(v9 + v14);
        if (v18 == 3)
        {
          *(_BYTE *)(v7 + 658) = v14;
          *(_WORD *)(v7 + 656) = *(_WORD *)(v7 + 642);
          goto LABEL_29;
        }
        if (v18 == 254)
          goto LABEL_51;
        goto LABEL_33;
      case 1:
        if (v16)
        {
          if (v16 == 1)
          {
            *v17 = *(unsigned __int8 *)(v9 + v14) << 8;
            v16 = 2;
            goto LABEL_28;
          }
          if (v16 != 2)
          {
LABEL_76:
            a5 = 245;
            goto LABEL_77;
          }
          LOWORD(v19) = *v17 | *(unsigned __int8 *)(v9 + v14);
          *v17 = v19;
          word_253E47024 = 0;
          if ((unsigned __int16)(v19 + 1) >= 0x100u)
          {
            v26 = 0;
            goto LABEL_61;
          }
LABEL_51:
          a5 = 22;
          goto LABEL_77;
        }
        v19 = *(unsigned __int8 *)(v9 + v14);
        if (v19 == 255)
        {
          v16 = 1;
LABEL_28:
          word_253E47024 = v16;
LABEL_29:
          v8 = 1;
LABEL_40:
          LOBYTE(v14) = v14 + 1;
          v13 = v14;
          if (v14 >= v12)
            goto LABEL_45;
          continue;
        }
        if (*(_BYTE *)(v9 + v14))
        {
          *v17 = v19;
          v17 = &word_253E47024;
        }
        *v17 = 0;
        v26 = 1;
LABEL_61:
        v27 = *(_DWORD *)(v7 + 652)
            + *(unsigned __int8 *)(v7 + 665)
            + ~(v13 + *(unsigned __int8 *)(v7 + 662) * *(unsigned __int16 *)(v7 + 642));
        *(_DWORD *)(v7 + 648) = v27;
        if (v27 < (unsigned __int16)v19)
          goto LABEL_51;
        if (*(_BYTE *)(v7 + 545) == 1)
          v28 = 1;
        else
          v28 = 2 * ((unsigned __int16)v19 != 0);
        *(_BYTE *)(v7 + 545) = v28;
        if (*(unsigned __int16 *)(v7 + 660) >= (unsigned __int16)v19)
          *(_WORD *)(v7 + 660) = 0;
        if (v27 >= 0xFFFE)
          v27 = 65534;
        *(_DWORD *)(v7 + 648) = v27;
        v29 = v26 ^ 1;
        if (v27 < 0xFF)
          v29 = 1;
        if ((v29 & 1) == 0)
        {
          v30 = v27 - 2;
          if (v27 == 255)
            v30 = 254;
          *(_DWORD *)(v7 + 648) = v30;
        }
LABEL_75:
        a5 = 0;
        *(_BYTE *)(v7 + 544) = 9;
LABEL_77:
        *(_BYTE *)(v7 + 644) = 0;
        v23 = v7;
LABEL_78:
        v31 = *(unsigned __int16 *)(v7 + 646);
        if (*(_WORD *)(v7 + 646))
          v32 = a5;
        else
          v32 = 157;
        if ((_DWORD)v32)
        {
LABEL_101:
          sub_219887614((unsigned int *)v23, v32);
          return sub_219850808(0, (unsigned int *)&v41, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessDynamicRdNdef");
        }
        v33 = *(_DWORD *)(v23 + 248);
        if (v33 > v31)
        {
          *(_DWORD *)(v23 + 248) = v31;
          v33 = v31;
        }
        v34 = *(unsigned __int16 *)(v7 + 660);
        if (!*(_WORD *)(v7 + 660))
        {
          if (*(_BYTE *)(v23 + 560))
            goto LABEL_89;
          v32 = 26;
          goto LABEL_101;
        }
        if (!*(_BYTE *)(v23 + 560))
        {
          if (v33 > v34)
            *(_DWORD *)(v23 + 248) = v34;
          goto LABEL_95;
        }
LABEL_89:
        *(_WORD *)(v7 + 660) = v31;
        if (v31 <= 0xFE)
          v35 = 2;
        else
          v35 = 4;
        v36 = v35 + *(unsigned __int8 *)(v7 + 658) >= *(unsigned __int8 *)(v7 + 662);
        v37 = *(_WORD *)(v7 + 656);
        if (v36)
          ++v37;
        *(_WORD *)(v7 + 640) = v37;
LABEL_95:
        if ((*(_BYTE *)(v7 + 663) & 1) != 0)
          v38 = sub_2198874CC(v23);
        else
          v38 = sub_21988642C(v23, 32, 0, 0);
        v32 = v38;
        if ((_DWORD)v38 != 13)
        {
          v23 = v40;
          goto LABEL_101;
        }
        return sub_219850808(0, (unsigned int *)&v41, 8u, 5u, (uint64_t)"phFriNfc_T5T_H_ProcessDynamicRdNdef");
      case 3:
        if (v16 == 2)
        {
          v15 |= *(unsigned __int8 *)(v9 + v14);
          word_253E47026 = v15;
          word_253E47024 = 0;
          if (((unsigned __int16)(v15 - 255) >> 8) == 255)
            goto LABEL_51;
          goto LABEL_36;
        }
        if (v16 == 1)
        {
          v15 = *(unsigned __int8 *)(v9 + v14) << 8;
          word_253E47026 = v15;
          v16 = 2;
          word_253E47024 = 2;
          goto LABEL_33;
        }
        if (v16)
          goto LABEL_76;
        v8 = *(unsigned __int8 *)(v9 + v14);
        if (*(_BYTE *)(v9 + v14))
        {
          if (v8 == 255)
          {
            v16 = 1;
            word_253E47024 = 1;
LABEL_33:
            v8 = 3;
            goto LABEL_40;
          }
          word_253E47026 = *(unsigned __int8 *)(v9 + v14);
          word_253E47024 = 0;
          v15 = v8;
LABEL_36:
          v20 = *(unsigned __int8 *)(v7 + 662);
          v21 = v13 + v20 * *(unsigned __int16 *)(v7 + 642);
          if (*(_DWORD *)(v7 + 652) + *(unsigned __int8 *)(v7 + 665) + ~v21 - 5 < v15)
            goto LABEL_51;
          v16 = 0;
          v22 = v15 + v21;
          *(_BYTE *)(v7 + 658) = v22 % v20;
          *(_WORD *)(v7 + 656) = v22 / v20;
          v14 = v13 + v15;
          if (v14 >= v12)
            LOBYTE(v14) = v12;
          v8 = 4;
          goto LABEL_40;
        }
        v16 = 0;
        goto LABEL_40;
      case 4:
        v8 = 0;
        LOBYTE(v14) = *(_BYTE *)(v7 + 658);
        goto LABEL_40;
      default:
        goto LABEL_77;
    }
  }
}

uint64_t sub_2198883B8(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t Memory;
  uint64_t v10;

  Memory = 0;
  v10 = a1;
  v8 = 0;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Init");
  sub_21988EF68(v10, &Memory);
  sub_21988EDF4(v10, &v8);
  v3 = 1;
  if (a2 && v10 && v8)
  {
    if (Memory || (Memory = phOsalNfc_GetMemory()) != 0)
    {
      phOsalNfc_SetMemory();
      v5 = Memory;
      v4 = v10;
      *(_QWORD *)(Memory + 224) = a2;
      *(_QWORD *)(v5 + 2712) = v4;
      v6 = v8;
      *(_DWORD *)(v5 + 2720) = *(_DWORD *)(v8 + 19368);
      *(_QWORD *)(v5 + 2728) = v6;
      sub_21988F028(v4, v5);
      v3 = 0;
    }
    else
    {
      v3 = 12;
    }
  }
  sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Init");
  return v3;
}

uint64_t sub_2198884B8(uint64_t a1, char a2)
{
  uint64_t v3;
  unsigned int v4;
  BOOL v5;
  int v6;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Reset");
  sub_21988EF68(v11, &v10);
  v3 = v10;
  if (v10)
  {
    *(_QWORD *)(v10 + 240) = v10 + 266;
    *(_DWORD *)(v3 + 248) = 260;
    *(_WORD *)(v3 + 264) = 260;
    v4 = *(_DWORD *)(*(_QWORD *)(v3 + 224) + 4);
    v5 = v4 > 0x13;
    v6 = (1 << v4) & 0x8E800;
    if (!v5 && v6 != 0)
    {
      *(_QWORD *)(v3 + 672) = v3 + 536;
      *(_DWORD *)(v3 + 536) = 0;
      *(_DWORD *)(v3 + 664) = 0;
    }
    v8 = 0;
    *(_QWORD *)(v3 + 528) = v3 + 536;
    *(_BYTE *)(v3 + 65) = a2;
  }
  else
  {
    v8 = 49;
  }
  sub_219850808(0, (unsigned int *)&v11, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Reset");
  return v8;
}

uint64_t sub_219888594(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  v2 = 0;
  v3 = a1;
  sub_219850718(0, (unsigned int *)&v3, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Deinit");
  sub_21988EF68(v3, &v2);
  if (v2)
  {
    phOsalNfc_FreeMemory();
    sub_21988F028(v3, 0);
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v3, 8u, 4u, (uint64_t)"NDEF context is NULL");
  }
  return sub_219850808(0, (unsigned int *)&v3, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Deinit");
}

uint64_t sub_219888630(uint64_t a1, uint64_t a2)
{
  int v4;
  int v5;
  uint64_t v6;
  int v7;
  int v8;
  int v10;
  uint64_t v11;
  int v13;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NDEF_SendData");
  if (a1
    && (v4 = *(unsigned __int16 *)(a1 + 264), *(_WORD *)(a1 + 264))
    && (v5 = *(unsigned __int16 *)(a1 + 526), *(_WORD *)(a1 + 526))
    && (v6 = *(_QWORD *)(a1 + 224)) != 0)
  {
    v7 = *(_DWORD *)(a1 + 232);
    *(_DWORD *)(a1 + 568) = v7;
    v8 = *(_DWORD *)(v6 + 4);
    if (v8 == 16 || v8 == 12)
    {
      *(_BYTE *)(a1 + 572) = *(_BYTE *)(a1 + 266);
      v13 = v5 - 1;
      if ((v7 & 0xFFFFFFFE) == 0x60)
      {
        v10 = *(unsigned __int8 *)(v6 + 18);
        *(_QWORD *)(a1 + 600) = a1 + 2765;
        if (v10 != 7 && v10 != 4)
        {
          *(_DWORD *)(a1 + 608) = v13;
          v11 = 20;
          goto LABEL_15;
        }
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
        v13 = v5 + 3;
        v4 = *(unsigned __int16 *)(a1 + 264);
        v6 = *(_QWORD *)(a1 + 224);
      }
      else
      {
        *(_QWORD *)(a1 + 600) = a1 + 267;
      }
    }
    else
    {
      *(_QWORD *)(a1 + 600) = a1 + 266;
      v13 = v5;
    }
    *(_DWORD *)(a1 + 608) = v13;
    *(_QWORD *)(a1 + 616) = a1 + 266;
    *(_DWORD *)(a1 + 624) = v4;
    *(_WORD *)(a1 + 574) = 500;
    v11 = sub_2198914A0(v6, a1 + 568, a2, *(_QWORD *)(a1 + 2728));
  }
  else
  {
    v11 = 1;
  }
LABEL_15:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NDEF_SendData");
  return v11;
}

uint64_t sub_21988879C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t *v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Reconnect");
  v6 = 1;
  if (a1 && a2 && a3)
  {
    v7 = *(_QWORD *)(a1 + 2728);
    if (v7
      && ((v8 = (uint64_t *)(v7 + 1456),
           !sub_219902600(*(unsigned int **)(v7 + 3040), *(_QWORD *)(v7 + 1456)))
        ? (v9 = *v8)
        : (v9 = 0, *v8 = 0, *(_QWORD *)(v7 + 1464) = 0),
          v12 = v9,
          !sub_2198BE4E4(*(_QWORD *)(a1 + 2728), &v11, &v12, 0)))
    {
      v6 = phLibNfc_RemoteDev_Connect(*(_QWORD *)(v7 + 19360), v11, a2, a1);
    }
    else
    {
      v6 = 255;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Reconnect");
  return v6;
}

uint64_t sub_219888888(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Connect");
  v6 = 1;
  if (a1 && a2 && a3)
  {
    v7 = *(_QWORD *)(a1 + 2728);
    if (v7)
      v6 = phLibNfc_RemoteDev_Connect(*(_QWORD *)(v7 + 19360), a3, a2, a1);
    else
      v6 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NDEF_Connect");
  return v6;
}

uint64_t sub_219888928(uint64_t a1, int a2)
{
  uint64_t v4;
  uint64_t v5;
  const char *v6;
  unsigned int *v7;
  uint64_t v8;
  uint64_t v10;
  int v11;

  v11 = a2;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreInit");
  if (a1)
  {
    sub_219888ACC(a1);
    *(_DWORD *)(a1 + 956) = a2;
    v4 = sub_2198FE724(*(_QWORD *)(a1 + 792), *(_QWORD *)(a1 + 800), 0, (uint64_t)sub_219888C00, a1);
    if ((_DWORD)v4)
    {
      v5 = v4;
      v6 = "phHciNfc_CoreInit:Failed to register HCI Receive Callback with NCI";
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreInit:Receive Data Registeration Sucessfull with NCI");
      LODWORD(v10) = 0;
      BYTE4(v10) = 1;
      v8 = sub_21988CF78((unsigned int *)a1, (uint64_t)&v10, (uint64_t)sub_21988E034, (unsigned int *)a1);
      if ((_DWORD)v8)
      {
        v5 = v8;
        v6 = "phHciNfc_CoreInit:Failed to register Callback for Adm pipe commands!";
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreInit:Adm pipe Callback for Rx Cmds registered!");
        LODWORD(v10) = 1;
        BYTE4(v10) = 1;
        v5 = sub_21988CF78((unsigned int *)a1, (uint64_t)&v10, (uint64_t)sub_21988DC68, (unsigned int *)a1);
        if (!(_DWORD)v5)
        {
          sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreInit:Adm pipe Callback for Rx Events registered!");
          goto LABEL_11;
        }
        v6 = "phHciNfc_CoreInit:Failed to register Callback for Adm pipe events!";
      }
    }
    v7 = (unsigned int *)(a1 + 956);
  }
  else
  {
    v6 = "phHciNfc_CoreInit:Invalid Context";
    v5 = 1;
    v7 = (unsigned int *)&v11;
  }
  sub_219850628(1, v7, 7u, 1u, (uint64_t)v6);
LABEL_11:
  sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreInit");
  return v5;
}

uint64_t sub_219888ACC(uint64_t a1)
{
  int *v2;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreInitialiseContext");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_WORD *)(a1 + 52) = 0;
    *(_QWORD *)(a1 + 56) = 0;
    *(_DWORD *)a1 = 0;
    *(_QWORD *)(a1 + 32) = 0;
    *(_QWORD *)(a1 + 40) = 0;
    *(_DWORD *)(a1 + 47) = 0;
    sub_219889358(a1);
    *(_QWORD *)(a1 + 840) = 0;
    *(_DWORD *)(a1 + 852) = 10000;
    *(_BYTE *)(a1 + 848) = 0;
    *(_QWORD *)(a1 + 856) = 0;
    *(_DWORD *)(a1 + 868) = 2000;
    *(_BYTE *)(a1 + 864) = 0;
    *(_QWORD *)(a1 + 872) = 0;
    *(_DWORD *)(a1 + 884) = 2000;
    *(_BYTE *)(a1 + 880) = 0;
    v2 = &dword_253E47158;
    if (!*(_DWORD *)(a1 + 956))
      v2 = &dword_253E47070;
    *v2 &= ~8u;
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
    *(_WORD *)(a1 + 952) = 0;
  }
  else
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)" phHciNfc_CoreInitialiseContext:Invalid Context");
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreInitialiseContext");
}

uint64_t sub_219888C00(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  void (*v7)(_QWORD, uint64_t, _QWORD);
  const char *v8;
  int v9;
  unsigned int *v10;
  unsigned __int8 v12;
  uint64_t v13;
  unsigned __int8 v14;
  _BYTE *v15;
  unsigned int v16;
  uint64_t v17;
  unsigned int *v18;
  uint64_t v19;
  int v20;
  uint64_t v21;
  int *v22;
  const char *v23;
  uint64_t v24;
  uint64_t v25;
  unsigned int v26;
  uint64_t v27;
  uint64_t Memory;

  v27 = 0;
  Memory = 0;
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreRecvCB");
  if (!a1 || (v6 = *(_QWORD *)(a1 + 960)) == 0)
  {
    v8 = "phHciNfc_CoreRecvCB:Invalid HCI Context received from Lower Layer ";
    v9 = 2;
    v10 = (unsigned int *)a1;
    goto LABEL_10;
  }
  if (!a2)
  {
    v10 = (unsigned int *)(a1 + 956);
    v8 = "phHciNfc_CoreRecvCB:Invalid Information received from lower layer ";
    goto LABEL_9;
  }
  if ((_DWORD)a3)
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)" phHciNfc_CoreRecvCB:Failed Status from lower layer");
    sub_2198DE37C((unsigned int *)a1);
    v7 = *(void (**)(_QWORD, uint64_t, _QWORD))(a1 + 184);
    if (v7)
    {
      *(_QWORD *)(a1 + 184) = 0;
      v7(*(_QWORD *)(a1 + 192), a3, 0);
    }
    goto LABEL_11;
  }
  v12 = **(_BYTE **)(a2 + 8);
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_GetHciPipeIndex");
  v13 = 0;
  v14 = 0;
  while (1)
  {
    v15 = *(_BYTE **)(a1 + 8 * v13 + 64);
    if (v15)
      break;
LABEL_17:
    if (++v13 == 6)
      goto LABEL_20;
  }
  if (((*v15 ^ v12) & 0x7F) != 0)
  {
    ++v14;
    goto LABEL_17;
  }
  v14 = v13;
LABEL_20:
  sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_GetHciPipeIndex");
  v16 = *(_DWORD *)(a2 + 16);
  if (v16 > 0x104)
  {
    v18 = (unsigned int *)(a1 + 956);
    v23 = " phHciNfc_CoreRecvCB:HCP Packet is bigger than PHHCI_HCP_MAX_PACKET_SIZE";
    goto LABEL_35;
  }
  v17 = sub_2198C7294((unsigned int *)a1, a1, v16, v14);
  v18 = (unsigned int *)(a1 + 956);
  if (!v17)
  {
    v23 = " phHciNfc_CoreRecvCB:HCI Core Receive- Failed To Allocate Memory for Node";
LABEL_35:
    sub_219850628(1, v18, 7u, 1u, (uint64_t)v23);
    if ((v12 & 0x80) != 0)
      goto LABEL_23;
LABEL_36:
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreRecvCB:Buffered Received Chained HCI packets");
    v24 = *(_QWORD *)(v6 + 6296);
    if (!v24 && !*(_QWORD *)(v6 + 6312) || *(_BYTE *)(a1 + 968) != 1)
      goto LABEL_11;
    *(_BYTE *)(a1 + 968) = 0;
    v25 = *(_QWORD *)(a1 + 840);
    if (v25 && v25 != 0xFFFFFFFFFFFFLL)
    {
      if (!v24 || (v26 = *(unsigned __int16 *)(v6 + 708), v26 < 0x7D0))
      {
        v26 = *(_DWORD *)(v6 + 592);
        if (v26 >> 4 < 0x271)
          v26 = 10000;
      }
      *(_DWORD *)(a1 + 852) = v26;
      sub_2198EF82C(*(_DWORD *)(a1 + 956), v25);
      if (!phOsalNfc_Timer_Start())
        goto LABEL_11;
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 840) = 0xFFFFFFFFFFFFLL;
      v8 = "phHciNfc_CoreRecvCB: SE TxRx Timer Start Failed";
    }
    else
    {
      v8 = "phHciNfc_CoreRecvCB: SE Transeive Timer Already deleted";
    }
    v9 = 1;
    v10 = (unsigned int *)(a1 + 956);
    goto LABEL_10;
  }
  v19 = v17;
  phOsalNfc_MemCopy();
  *(_DWORD *)(v19 + 260) = *(_DWORD *)(a2 + 16);
  if ((v12 & 0x80) == 0)
    goto LABEL_36;
LABEL_23:
  *(_BYTE *)(a1 + 968) = 1;
  Memory = 0;
  if (*(_DWORD *)(a1 + 4 * v14 + 124) && (Memory = phOsalNfc_GetMemory()) == 0)
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_AnySetParameter:Memory Allocation Failed");
    return 12;
  }
  else
  {
    v20 = sub_2198C7418((unsigned int *)a1, a1, (uint64_t)&v27, v14);
    if (BYTE2(v27) == 2)
    {
      v21 = *(_QWORD *)(a1 + 872);
      if (v21)
      {
        if (v21 != 0xFFFFFFFFFFFFLL)
        {
          phOsalNfc_Timer_Stop();
          phOsalNfc_Timer_Delete();
          sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreRecvCB : HCI Cmd Rsp Timer deleted successfully");
          *(_QWORD *)(a1 + 872) = 0;
          v22 = &dword_253E47158;
          if (!*(_DWORD *)(a1 + 956))
            v22 = &dword_253E47070;
          *v22 &= ~8u;
        }
      }
    }
    if (v20)
    {
      v10 = (unsigned int *)(a1 + 956);
      v8 = " phHciNfc_CoreRecvCB:HCI Core - HCI Packet Extraction Failed";
LABEL_9:
      v9 = 1;
LABEL_10:
      sub_219850628(v9, v10, 7u, 1u, (uint64_t)v8);
    }
    else
    {
      sub_2198C7138((unsigned int *)a1, a1, v14);
      sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Rx HCP:PipeID");
      sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Rx HCP:MsgType");
      sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Rx HCP:Ins");
      sub_219851FF8(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Rx HCP:Data", Memory);
      sub_2198DE694((unsigned int *)a1, (unsigned __int8 *)&v27, 0);
      phOsalNfc_FreeMemory();
    }
LABEL_11:
    sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreRecvCB");
  }
  return a3;
}

uint64_t sub_219889084(uint64_t a1)
{
  uint64_t v2;
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;

  v7 = 0;
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreDeInit");
  if (a1)
  {
    sub_21988925C(a1);
    if (*(_QWORD *)(a1 + 152))
    {
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"CoreDeInit: Releasing HCI send buffer memory");
      if (*(_QWORD *)(*(_QWORD *)(a1 + 152) + 8))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 152) = 0;
    }
    v2 = *(_QWORD *)(a1 + 792);
    if (v2)
    {
      v3 = 0;
      v4 = 0;
      do
      {
        v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 4);
        if ((v3 & 1) != 0)
          break;
        v3 = 1;
        v4 = 1;
      }
      while (v5 != v2);
      if (v5 == v2)
        sub_2198FE724(v2, *(_QWORD *)(a1 + 800), 1, (uint64_t)sub_219888C00, a1);
    }
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreDeInit:phHciNfc_CoreRecvCB unregistered with NCI");
    LODWORD(v7) = 0;
    BYTE4(v7) = 1;
    sub_21988D688((unsigned int *)a1, (int *)&v7, (uint64_t)sub_21988E034);
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreDeInit:phHciNfc_ReceiveAdminNotifyCmd unregistered for ADM Cmds");
    LODWORD(v7) = 1;
    BYTE4(v7) = 1;
    sub_21988D688((unsigned int *)a1, (int *)&v7, (uint64_t)sub_21988DC68);
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreDeInit:phHciNfc_ReceiveAdminNotifyEvt unregistered for ADM Events");
    sub_21988DAB0((unsigned int *)a1);
  }
  else
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)"phHciNfc_CoreDeInit:Failed,Invalid Context");
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreDeInit");
}

uint64_t sub_21988925C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreAbortAllTran");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_DWORD *)a1 = 0;
    *(_QWORD *)(a1 + 32) = 0;
    *(_QWORD *)(a1 + 40) = 0;
    if (*(_QWORD *)(a1 + 944))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 944) = 0;
    }
    sub_219889494((unsigned int *)a1);
    v2 = *(_QWORD *)(a1 + 936);
    if (v2 && v2 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      phOsalNfc_SetMemory();
      *(_QWORD *)(a1 + 904) = 0;
      *(_QWORD *)(a1 + 936) = 0;
      *(_BYTE *)(a1 + 892) = -86;
    }
    *(_BYTE *)(a1 + 953) = 0;
  }
  else
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)"phHciNfc_CoreAbortAllTran: Invalid HCI Context");
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreAbortAllTran");
}

uint64_t sub_219889358(uint64_t a1)
{
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreInitRxData");
  if (a1)
  {
    *(_OWORD *)(a1 + 80) = 0u;
    *(_OWORD *)(a1 + 96) = 0u;
    *(_OWORD *)(a1 + 64) = 0u;
    memset_pattern16((void *)(a1 + 112), &unk_21990A680, 0xCuLL);
    *(_QWORD *)(a1 + 132) = 0;
    *(_QWORD *)(a1 + 124) = 0;
    *(_QWORD *)(a1 + 140) = 0;
  }
  else
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)" phHciNfc_CoreInitRxData:Invalid Context");
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreInitRxData");
}

uint64_t sub_2198893F8(unsigned int *a1, uint64_t a2, int a3)
{
  uint64_t v6;
  _BYTE *v7;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_GetAllocatedPipeIndex");
  if (a2)
  {
    v6 = 0;
    while (1)
    {
      v7 = *(_BYTE **)(a2 + 64 + 8 * v6);
      if (v7)
      {
        if ((*v7 & 0x7F) == a3)
          break;
      }
      if (++v6 == 6)
        goto LABEL_6;
    }
  }
  else
  {
LABEL_6:
    LOBYTE(v6) = -1;
  }
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_GetAllocatedPipeIndex");
  return v6;
}

uint64_t sub_219889494(unsigned int *a1)
{
  uint64_t i;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_CoreClearRxBuffers");
  if (a1)
  {
    for (i = 0; i != 6; ++i)
    {
      sub_2198C7138(a1, (uint64_t)a1, i);
      *(_QWORD *)&a1[2 * i + 16] = 0;
    }
  }
  else
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)"phHciNfc_CoreClearRxBuffers: Invalid HCI Context");
  }
  return sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_CoreClearRxBuffers");
}

uint64_t sub_219889530(uint64_t a1, __int128 *a2, uint64_t a3, uint64_t a4)
{
  int v8;
  int v9;
  int v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  const char *v16;
  int v17;
  unsigned int *v18;
  uint64_t v19;
  uint64_t v20;
  __int128 v22;
  int *v23;
  uint64_t v24;
  int *v25;
  uint64_t v26;
  uint64_t v27;

  v26 = 0;
  v27 = 0;
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreSend");
  if (!a1 || !a2)
  {
    v16 = "phHciNfc_CoreSend:Invalid HCI Context or Send params";
    v14 = 1;
    v17 = 2;
    v18 = (unsigned int *)a1;
    goto LABEL_28;
  }
  v8 = *((unsigned __int8 *)a2 + 1);
  BYTE1(v26) = *((_BYTE *)a2 + 1);
  v9 = *((unsigned __int8 *)a2 + 2);
  BYTE2(v26) = *((_BYTE *)a2 + 2);
  LOBYTE(v26) = *(_BYTE *)a2;
  HIDWORD(v26) = *((_DWORD *)a2 + 1);
  v27 = *((_QWORD *)a2 + 1);
  if (v26 == 1 && v9 == 1 && v8 == 12)
    v12 = 3;
  else
    v12 = 1;
  v13 = sub_219861C30(*(_QWORD *)(a1 + 792), (uint64_t)&v26, *(_QWORD *)(a1 + 800), (uint64_t)sub_219889A60, a1, *(_BYTE *)(a1 + 953), v12);
  if ((_DWORD)v13 != 111)
  {
    v14 = v13;
    if ((_DWORD)v13 == 13)
    {
      *(_BYTE *)(a1 + 10) = BYTE2(v26);
      *(_WORD *)(a1 + 8) = v26;
      *(_DWORD *)(a1 + 12) = HIDWORD(v26);
      *(_QWORD *)(a1 + 16) = v27;
      if (!*((_BYTE *)a2 + 2))
      {
        *(_DWORD *)(a1 + 884) = 2000;
        sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CreateHCICmdRspTimer");
        v15 = phOsalNfc_Timer_Create();
        *(_QWORD *)(a1 + 872) = v15;
        if (v15 != 0xFFFFFFFFFFFFLL && v15)
        {
          sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CreateHCICmdRspTimer : HCI Cmd Rsp Timer Created successfully");
          sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CreateHCICmdRspTimer");
          v25 = &dword_253E47158;
          if (!*(_DWORD *)(a1 + 956))
            v25 = &dword_253E47070;
          *v25 &= ~8u;
          if (phOsalNfc_Timer_Start())
          {
            v14 = phOsalNfc_Timer_Delete();
            *(_QWORD *)(a1 + 872) = 0;
            sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phLibNfc_HciDataSend: HCI Cmd Rsp Timer Start Failed");
            goto LABEL_19;
          }
          sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phLibNfc_HciDataSend: HCI Cmd Rsp Timer Started with Timeout");
        }
        else
        {
          sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_CreateHCICmdRspTimer : HCI Cmd Rsp Timer Create failed");
          sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CreateHCICmdRspTimer");
        }
      }
      v14 = 13;
LABEL_19:
      *(_QWORD *)(a1 + 32) = a3;
      *(_QWORD *)(a1 + 40) = a4;
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreSend:HCP Packet Sent to NCI ");
      sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Tx HCP:PipeID");
      sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Tx HCP:MsgType");
      sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Tx HCP:Ins");
      sub_219851FF8(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Tx HCP:Data", *((_QWORD *)a2 + 1));
      *(_BYTE *)(a1 + 952) = 0;
      goto LABEL_29;
    }
    v18 = (unsigned int *)(a1 + 956);
    v16 = "phHciNfc_CoreSend: HCI packet Send Failed ";
    v17 = 1;
LABEL_28:
    sub_219850628(v17, v18, 7u, 1u, (uint64_t)v16);
    goto LABEL_29;
  }
  *(_DWORD *)a1 = 0;
  *(_BYTE *)(a1 + 892) = 85;
  v19 = *(_QWORD *)(a1 + 936);
  if (v19 && v19 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(a1 + 936) = 0xFFFFFFFFFFFFLL;
  }
  v20 = phOsalNfc_Timer_Create();
  *(_QWORD *)(a1 + 936) = v20;
  if (v20 != 0xFFFFFFFFFFFFLL && v20)
  {
    sub_219851790(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc:NCI BUSY,Retry Cnt=");
    if (*(unsigned __int8 *)(a1 + 952) > 4u)
    {
      v23 = &dword_253E47158;
      if (!*(_DWORD *)(a1 + 956))
        v23 = &dword_253E47070;
      v23[1] |= 0x4000000u;
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_CoreSend:Maximum HCI Send Retry Count reached");
      *(_BYTE *)(a1 + 952) = 0;
      v24 = *(_QWORD *)(a1 + 960);
      if (v24)
        sub_219886108(*(_QWORD *)(v24 + 19360), 202);
    }
    else
    {
      sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CacheHciPacket");
      *(_QWORD *)(a1 + 920) = a3;
      *(_QWORD *)(a1 + 928) = a4;
      v22 = *a2;
      *(_QWORD *)(a1 + 912) = *((_QWORD *)a2 + 2);
      *(_OWORD *)(a1 + 896) = v22;
      *(_QWORD *)(a1 + 904) = *((_QWORD *)a2 + 1);
      sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CacheHciPacket");
      if (!phOsalNfc_Timer_Start())
      {
        sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_CoreSend:dwHciResendPacketTimerId Started, Timeout");
        v14 = 13;
        goto LABEL_29;
      }
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_CoreSend:HCI Resend Packet Timer Start failed");
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 936) = 0;
      *(_BYTE *)(a1 + 952) = 0;
    }
    v14 = 255;
  }
  else
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_CoreSend:HCI Resend Packet Timer Create failed");
    *(_BYTE *)(a1 + 952) = 0;
    v14 = 12;
  }
LABEL_29:
  sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreSend");
  return v14;
}

uint64_t sub_219889A60(uint64_t a1, int a2)
{
  const char *v4;
  uint64_t v5;
  void (*v6)(uint64_t, uint64_t);
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_HciCoreLowerLayerSendCb");
  if (a1)
  {
    if (a2)
      v4 = "phHciNfc_HciCoreLowerLayerSendCb: HCI Tx Failed";
    else
      v4 = "phHciNfc_HciCoreLowerLayerSendCb: HCI Send Complete";
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)v4);
    v6 = *(void (**)(uint64_t, uint64_t))(a1 + 32);
    v5 = *(_QWORD *)(a1 + 40);
    *(_DWORD *)a1 = 0;
    *(_DWORD *)(a1 + 12) = 0;
    *(_QWORD *)(a1 + 32) = 0;
    *(_QWORD *)(a1 + 40) = 0;
    if (v6)
    {
      if (a2)
        v7 = 255;
      else
        v7 = 0;
      v6(v5, v7);
    }
  }
  else
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)"phHciNfc_HciCoreLowerLayerSendCb:Invalid HCI Context received from Lower Layer ");
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_HciCoreLowerLayerSendCb");
}

uint64_t sub_219889B28(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  int *v8;
  uint64_t v9;
  void (*v10)(uint64_t, uint64_t, _QWORD);
  uint64_t v11;

  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phHciNfc_HciCmdRspCb");
  if (!a2)
    goto LABEL_6;
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != a2);
  if (v5 == a2)
  {
    v7 = *(_QWORD *)(a2 + 464);
    if (v7)
    {
      v8 = &dword_253E47158;
      if (!*(_DWORD *)(v7 + 956))
        v8 = &dword_253E47070;
      *v8 |= 8u;
      sub_219850628(1, (unsigned int *)(v7 + 956), 7u, 1u, (uint64_t)"phHciNfc_HciCmdRspCb : HCI Command Response Packet Timer Expired");
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      sub_219850628(1, (unsigned int *)(v7 + 956), 7u, 1u, (uint64_t)"phHciNfc_HciCmdRspCb : HCI Command Response timer deleted successfully");
      *(_DWORD *)(v7 + 884) = 2000;
      *(_QWORD *)(v7 + 872) = 0xFFFFFFFFFFFFLL;
      v10 = *(void (**)(uint64_t, uint64_t, _QWORD))(v7 + 184);
      v9 = *(_QWORD *)(v7 + 192);
      *(_BYTE *)(v7 + 953) = 0;
      *(_QWORD *)(v7 + 184) = 0;
      *(_QWORD *)(v7 + 192) = 0;
      sub_219886108(*(_QWORD *)(a2 + 19360), 44);
      if (*(_BYTE *)(a2 + 706) == 1)
      {
        *(_BYTE *)(a2 + 706) = 0;
        v11 = 218;
        if (!v10)
          return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phHciNfc_HciCmdRspCb");
      }
      else
      {
        sub_219879C68(*(_QWORD *)(a2 + 3040), 0);
        v11 = 255;
        if (!v10)
          return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phHciNfc_HciCmdRspCb");
      }
      v10(v9, v11, 0);
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 4u, 1u, (uint64_t)"phHciNfc_HciCmdRspCb :Invalid Context");
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phHciNfc_HciCmdRspCb");
}

uint64_t sub_219889CC4(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;
  void (*v9)(uint64_t, uint64_t);
  uint64_t v10;
  __int128 v11;
  uint64_t v12;

  v11 = 0uLL;
  v12 = 0;
  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phHciNfc_HciResendPacketCb");
  sub_219850628(2, (unsigned int *)a2, 4u, 2u, (uint64_t)"******HCI Resend Packet Timer Expired********");
  if (!a2)
    goto LABEL_6;
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != a2);
  if (v5 == a2)
  {
    v7 = *(_QWORD *)(a2 + 464);
    if (v7)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(v7 + 936) = 0;
      *(_BYTE *)(v7 + 892) = -86;
      v11 = *(_OWORD *)(v7 + 896);
      v8 = *(_QWORD *)(v7 + 912);
      *((_QWORD *)&v11 + 1) = *(_QWORD *)(v7 + 904);
      v12 = v8;
      v9 = *(void (**)(uint64_t, uint64_t))(v7 + 920);
      v10 = *(_QWORD *)(v7 + 928);
      if (sub_219889530(v7, &v11, v9, v10) == 13)
      {
        if (*(_BYTE *)(v7 + 897) == 12 && *(_BYTE *)(v7 + 898) == 1 && *(_BYTE *)(v7 + 896) == 1)
          *(_QWORD *)(v7 + 184) = sub_2198E0968;
        ++*(_BYTE *)(v7 + 952);
      }
      else
      {
        sub_219850628(1, (unsigned int *)(v7 + 956), 7u, 4u, (uint64_t)"phHciNfc_HciResendPacketCb:Failed to resend HCP packet");
        sub_2198DE37C((unsigned int *)v7);
        *(_QWORD *)(v7 + 920) = 0;
        *(_QWORD *)(v7 + 928) = 0;
        if (v9)
        {
          *(_BYTE *)(v7 + 952) = 0;
          v9(v10, 255);
          phOsalNfc_SetMemory();
          *(_QWORD *)(v7 + 904) = 0;
        }
      }
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 4u, 4u, (uint64_t)"phHciNfc_HciResendPacketCb:Invalid Context");
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phHciNfc_HciResendPacketCb");
}

uint64_t sub_219889EAC(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreReleaseMemory");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 944))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 944) = 0;
    }
    v2 = *(_QWORD *)(a1 + 152);
    if (v2)
    {
      if (*(_QWORD *)(v2 + 8))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 152) = 0;
    }
  }
  else
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)"phHciNfc_CoreDeInit:Failed,Invalid Context");
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CoreReleaseMemory");
}

uint64_t sub_219889F64(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendT3TPollCmd");
  if (a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Setting up commandInfo to be sent to lower layer ..");
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0x100000001;
    DWORD2(v4) = 8;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_21988AE2C, a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendT3TPollCmd");
  return v2;
}

uint64_t sub_21988A06C(uint64_t a1, int a2)
{
  uint64_t v4;
  const char *v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_T3TPollResp");
  if (a1)
  {
    v4 = 255;
    v5 = " T3T Poll Req Failed ..";
    if (!a2 && *(_DWORD *)(a1 + 3768))
    {
      if (*(_QWORD *)(a1 + 3760))
      {
        v5 = " T3TPoll Req sent successfully..";
        v4 = 0;
      }
      else
      {
        v4 = 255;
      }
    }
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)v5);
    *(_WORD *)(a1 + 4592) = v4;
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v4 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_T3TPollResp");
  return v4;
}

uint64_t sub_21988A148(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  const char *v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteT3TPollSequence");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Freeing T3TPollReq Buff..");
      sub_2198FBBC4(a1);
    }
    if ((_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)" Error in T3TPollReq handling ");
      sub_2198E23C4(a1, a2, 0);
    }
    else
    {
      *(_QWORD *)(a1 + 752) = *(_QWORD *)(a1 + 3384);
      *(_QWORD *)(a1 + 760) = *(_QWORD *)(a1 + 3712);
      v8 = 0x100000003;
      LODWORD(v9) = 8;
      v4 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v8, (uint64_t)sub_21988A9A4, a1);
      if ((_DWORD)v4)
      {
        a2 = v4;
        v5 = "T3T Ntf Registration failed";
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"T3T Ntf successfully Registered");
        v6 = *(_QWORD *)(a1 + 4656);
        if (v6 == 0xFFFFFFFFFFFFLL)
        {
          a2 = 0;
          goto LABEL_14;
        }
        sub_21988C4AC(*(_DWORD *)(a1 + 6476), v6);
        *(_BYTE *)(a1 + 6464) = 0;
        a2 = phOsalNfc_Timer_Start();
        if ((_DWORD)a2)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"T3T Ntf timer start failed\n");
          goto LABEL_14;
        }
        sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_CompleteT3TPollSequence");
        *(_QWORD *)(a1 + 3384) = 0;
        v5 = "T3T Ntf timer started\n";
      }
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)v5);
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    a2 = 1;
  }
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteT3TPollSequence");
  return a2;
}

uint64_t sub_21988A374(uint64_t a1, uint64_t a2, uint64_t a3, int a4)
{
  int v8;
  int v9;
  uint64_t v10;
  int v11;
  int v12;
  uint64_t (**v13)(uint64_t);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RdrFInit");
  if (a1 && a2 && a3 && a4)
  {
    v8 = *(_DWORD *)(a2 + 12);
    if (*(_DWORD *)(a2 + 20) == 2)
    {
      if (v8 == 3 && *(_DWORD *)(a2 + 16) == 5)
      {
        v9 = 23;
LABEL_13:
        *(_DWORD *)(a2 + 4) = v9;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid remote device!");
LABEL_16:
        v10 = 255;
LABEL_23:
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Sequence operations not set!");
        goto LABEL_24;
      }
    }
    else if (v8 == 3 && *(_DWORD *)(a2 + 16) == 5)
    {
      v9 = 24;
      goto LABEL_13;
    }
    *(_DWORD *)(a2 + 4) = 18;
    v11 = *(unsigned __int8 *)(a3 + 7);
    *(_BYTE *)(a2 + 55) = v11;
    if ((v11 - 3) <= 0xFFFFFFFD)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid BitRate..");
      goto LABEL_16;
    }
    v12 = *(unsigned __int8 *)(a3 + 8);
    *(_BYTE *)(a2 + 56) = v12;
    if ((v12 & 0xFFFFFFFD) == 0x10)
    {
      phOsalNfc_SetMemory();
      phOsalNfc_MemCopy();
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" SensFResResp.not present.");
    }
    if (*(_DWORD *)(a2 + 4) != 18)
    {
      v10 = 0;
      goto LABEL_23;
    }
    v10 = 0;
    v13 = *(uint64_t (***)(uint64_t))(a1 + 4760);
    *v13 = sub_21988A58C;
    v13[1] = (uint64_t (*)(uint64_t))sub_21988A724;
    v13[2] = 0;
    v13[3] = (uint64_t (*)(uint64_t))sub_2198F14B0;
  }
  else
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)" Invalid Params..");
    v10 = 1;
  }
LABEL_24:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RdrFInit");
  return v10;
}

uint64_t sub_21988A58C(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  __int128 v5;
  __int128 v6;

  v5 = 0u;
  v6 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendFelicaReq");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 4512))
    {
      phOsalNfc_SetMemory();
      if (*(_BYTE *)(a1 + 4544) && **(unsigned __int8 **)(a1 + 4536) == *(unsigned __int8 *)(a1 + 4544))
      {
        v2 = *(_QWORD *)(a1 + 4512);
        LODWORD(v5) = 0;
        if (sub_219878C88((unsigned int *)a1, v2, (_BYTE *)((unint64_t)&v5 | 0xC)))
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Couldn't Get ConnId..");
          v3 = 255;
        }
        else
        {
          *(_QWORD *)&v6 = *(_QWORD *)(a1 + 4536);
          DWORD2(v6) = *(_DWORD *)(a1 + 4544);
          v3 = sub_2198F2D0C(a1 + 888, (uint64_t)&v5, a1 + 3760, *(unsigned __int16 *)(a1 + 4526), (uint64_t)sub_2198F135C, a1);
          *(_WORD *)(a1 + 4526) = 0;
        }
      }
      else
      {
        v3 = 1;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Length..");
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Device..");
      v3 = 6;
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v3 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendFelicaReq");
  return v3;
}

uint64_t sub_21988A724(uint64_t a1, int a2)
{
  unsigned int v4;
  uint64_t v5;
  unsigned int v6;
  unsigned int v7;
  unsigned int *v8;
  const char *v9;
  __int16 v10;
  unsigned __int16 v12;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RecvFelicaResp");
  if (a1)
  {
    if (a2 || (v4 = *(_DWORD *)(a1 + 3768)) == 0 || (v5 = *(_QWORD *)(a1 + 3760)) == 0)
    {
      v10 = 255;
      v12 = 255;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Data Receive Failed..");
LABEL_29:
      *(_WORD *)(a1 + 4592) = v10;
      goto LABEL_30;
    }
    *(_DWORD *)(a1 + 4624) = v4 - 1;
    v6 = *(_DWORD *)(a1 + 4560);
    v7 = *(unsigned __int8 *)(v5 + v4 - 1);
    if (v7 > 0xAF)
    {
      switch(*(_BYTE *)(v5 + v4 - 1))
      {
        case 0xB0:
          v12 = 182;
          v8 = (unsigned int *)(a1 + 6476);
          v9 = " Felica XchgData,PH_NCINFC_STATUS_RF_TRANSMISSION_ERROR Detected by NFCC during Data Exchange ";
          goto LABEL_27;
        case 0xB1:
          v12 = 183;
          v8 = (unsigned int *)(a1 + 6476);
          v9 = " Felica XchgData,PH_NCINFC_STATUS_RF_PROTOCOL_ERROR Detected by NFCC during Data Exchange ";
          goto LABEL_27;
        case 0xB2:
          v12 = 178;
          v8 = (unsigned int *)(a1 + 6476);
          v9 = " Felica XchgData,PH_NCINFC_STATUS_RF_TIMEOUT_ERROR Detected by NFCC during Data Exchange ";
          goto LABEL_27;
        case 0xB3:
          v12 = 184;
          v8 = (unsigned int *)(a1 + 6476);
          v9 = " Felica XchgData,PH_NCINFC_STATUS_RF_UNEXPECTED_DAT Detected by NFCC during Data Exchange ";
          goto LABEL_27;
        default:
          if (v7 == 190)
          {
            v12 = 187;
            v8 = (unsigned int *)(a1 + 6476);
            v9 = " Felica XchgData,PH_NCINFC_STATUS_HRM_SE_INIT_REQUIRED Detected by NFCC during Data Exchange ";
          }
          else
          {
            if (v7 != 191)
              goto LABEL_16;
            v12 = 186;
            v8 = (unsigned int *)(a1 + 6476);
            v9 = " Felica XchgData,PH_NCINFC_STATUS_HRM_TIMER_RUNNING Detected by NFCC during Data Exchange ";
          }
          break;
      }
      goto LABEL_27;
    }
    if (*(_BYTE *)(v5 + v4 - 1))
    {
      if (v7 == 2)
      {
        v12 = 181;
        v8 = (unsigned int *)(a1 + 6476);
        v9 = " Felica XchgData,PH_NCINFC_STATUS_RF_FRAME_CORRUPTED Detected by NFCC during Data Exchange ";
LABEL_27:
        sub_219850628(1, v8, 3u, 2u, (uint64_t)v9);
        goto LABEL_28;
      }
LABEL_16:
      v12 = 185;
      sub_219886108(*(_QWORD *)(a1 + 6480), v7);
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)" Felica XchgData,Unknown RF related error Detected by NFCC during Data Exchange ");
      if (v4 > v6)
      {
LABEL_28:
        sub_2198F1654(a1, &v12);
        v10 = v12;
        goto LABEL_29;
      }
    }
    else
    {
      if (v4 - 1 >= v6)
        v4 = *(_DWORD *)(a1 + 4560);
      else
        --v4;
      v12 = 0;
    }
    phOsalNfc_MemCopy();
    *(_DWORD *)(a1 + 4560) = v4;
    goto LABEL_28;
  }
  v12 = 1;
  sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
LABEL_30:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RecvFelicaResp");
  return v12;
}

uint64_t sub_21988A9A4(uint64_t a1, uint64_t a2, int a3)
{
  const char *v6;
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, _QWORD);
  uint64_t v10;
  uint64_t v11;
  int v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t (*v15)();

  v13 = 0;
  v14 = 0;
  v15 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_T3TPollNtf");
  if (!a1)
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v7 = 1;
    goto LABEL_13;
  }
  phOsalNfc_Timer_Stop();
  *(_BYTE *)(a1 + 6464) = 0;
  sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_T3TPollNtf");
  if (!a2 || !*(_QWORD *)(a2 + 8) || a3 || !*(_DWORD *)(a2 + 16))
  {
    v6 = " T3T Notification invalid..";
    goto LABEL_9;
  }
  *(_WORD *)((char *)&v13 + 1) = 2049;
  v14 = a1;
  v15 = sub_21988A9A4;
  sub_219860F20(a1 + 888, (uint64_t)&v13, 3);
  if (**(_BYTE **)(a2 + 8))
  {
    v6 = " T3T Resp Not Recvd..";
LABEL_9:
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)v6);
    v7 = 255;
    goto LABEL_10;
  }
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateRemDevInf");
  v10 = *(_QWORD *)(a2 + 8);
  if (v10)
  {
    if (*(_BYTE *)(v10 + 1))
    {
      v11 = *(_QWORD *)(a1 + 4512);
      if (v11)
      {
        v12 = *(unsigned __int8 *)(v10 + 2);
        *(_BYTE *)(v11 + 56) = v12;
        if ((v12 & 0xFFFFFFFD) != 0x10)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" SensFResResp.not present in T3T Poll Ntf recvd.");
          v7 = 255;
          goto LABEL_20;
        }
        phOsalNfc_SetMemory();
        phOsalNfc_MemCopy();
      }
    }
  }
  v7 = 0;
LABEL_20:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateRemDevInf");
LABEL_10:
  v8 = *(void (**)(_QWORD, uint64_t, _QWORD))(a1 + 752);
  if (v8)
  {
    *(_QWORD *)(a1 + 752) = 0;
    v8(*(_QWORD *)(a1 + 760), v7, 0);
  }
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_T3TPollNtf");
  return v7;
}

uint64_t sub_21988ABDC(uint64_t a1, _BYTE *a2, uint64_t a3, uint64_t a4)
{
  _BYTE *Memory;
  uint64_t v9;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_T3TPollReq");
  if (!a1)
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
LABEL_9:
    v9 = 1;
    goto LABEL_11;
  }
  if (!a2 || !a3)
  {
    v9 = 1;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid T3T Poll Req Param(s)..");
    goto LABEL_11;
  }
  if (sub_21988AD68(*(_DWORD *)(a1 + 6476), (uint64_t)a2))
    goto LABEL_9;
  Memory = (_BYTE *)phOsalNfc_GetMemory();
  if (Memory)
  {
    *Memory = *a2;
    Memory[1] = a2[1];
    Memory[2] = a2[2];
    Memory[3] = a2[3];
    *(_QWORD *)(a1 + 848) = Memory;
    *(_DWORD *)(a1 + 856) = 4;
    *(_QWORD *)(a1 + 3736) = off_2550A0D68;
    *(_BYTE *)(a1 + 3936) = 0;
    *(_BYTE *)(a1 + 3937) = sub_21987CDC4((unsigned int *)a1, off_2550A0D68);
    v9 = sub_21988AE2C(a1, 0, 0);
    if ((_DWORD)v9 == 13)
    {
      *(_QWORD *)(a1 + 3384) = a3;
      *(_QWORD *)(a1 + 3712) = a4;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"T3t poll Sequence failed!");
      sub_2198FBBC4(a1);
    }
  }
  else
  {
    v9 = 0;
  }
LABEL_11:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_T3TPollReq");
  return v9;
}

uint64_t sub_21988AD68(unsigned int a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int v5;

  v5 = a1;
  sub_219850718(1, &v5, 3u, 5u, (uint64_t)"phNciNfc_ValidateT3TReqParams");
  if (phOsalNfc_MemCompare()
    || *(unsigned __int8 *)(a2 + 2) > 2u
    || *(unsigned __int8 *)(a2 + 3) >= 0x10u)
  {
    v3 = 1;
    sub_219850628(1, &v5, 3u, 4u, (uint64_t)" Invalid SystemCode/RequestCode/TSN Specified..");
  }
  else
  {
    v3 = 0;
  }
  sub_219850808(1, &v5, 3u, 5u, (uint64_t)"phNciNfc_ValidateT3TReqParams");
  return v3;
}

uint64_t sub_21988AE2C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_T3TPollSequence");
  if (a1 && a2)
  {
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_T3TPollSequence");
  return v6;
}

uint64_t sub_21988AEBC(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_T3tNtfTimeoutHandler");
  if (a2)
  {
    v4 = (_BYTE *)(a2 + 6464);
    if (!*(_BYTE *)(a2 + 6464))
    {
      phOsalNfc_Timer_Stop();
      if (!phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"T3T Ntf timer restarted for extended time\n");
        *v4 = 1;
        return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_T3tNtfTimeoutHandler");
      }
      sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 1u, (uint64_t)"T3T Ntf timer failed to start for extended time\n");
    }
    sub_21988629C(2, (unsigned int *)a2, a1, 3u, 4u, (uint64_t)"phNciNfc_T3tNtfTimeoutHandler");
    phOsalNfc_Timer_Stop();
    *v4 = 0;
    sub_21988A9A4(a2, 0, 255);
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_T3tNtfTimeoutHandler");
}

uint64_t sub_21988AFF4(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  unsigned int v5;
  uint64_t v6;
  int v7;
  uint64_t v8;
  unsigned int v9;
  int v10;
  int v11;
  int v12;
  double v13;
  unsigned int v14;
  unsigned __int8 v15;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_H_MRTCalculate");
  v4 = 0;
  if (!a1 || !a2)
    goto LABEL_16;
  v5 = *(_DWORD *)(a2 + 24);
  if (v5 < 2)
    goto LABEL_15;
  v6 = *(_QWORD *)(a2 + 16);
  v7 = *(unsigned __int8 *)(v6 + 1);
  if (v7 == 6)
  {
    v8 = 70;
    goto LABEL_8;
  }
  if (v7 != 8)
  {
LABEL_15:
    v4 = 0;
    goto LABEL_16;
  }
  v8 = 71;
LABEL_8:
  if (v5 < 0xB || v5 <= (2 * *(_BYTE *)(v6 + 10) + 11))
    goto LABEL_15;
  v9 = *(unsigned __int8 *)(*(_QWORD *)(a1 + 4512) + v8);
  v10 = *(unsigned __int8 *)(v6 + (2 * *(_BYTE *)(v6 + 10) + 11));
  v11 = v9 & 7;
  v12 = (v9 >> 3) & 7;
  v13 = 1.0;
  if (v9 >= 0x40)
  {
    v14 = v9 >> 6;
    v15 = 1;
    do
    {
      v15 *= 4;
      --v14;
    }
    while ((_BYTE)v14);
    v13 = (double)v15;
  }
  v4 = (int)((double)(v11 + v10 + v10 * v12 + 1) * 302.064897 * v13 / 1000.0);
  sub_219851888(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Calculated Timeout value from MRTI is ");
LABEL_16:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_H_MRTCalculate");
  return v4;
}

uint64_t sub_21988B150(uint64_t a1, _BYTE *a2)
{
  uint64_t v3;
  uint64_t v5;

  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 3u, 5u, (uint64_t)"phNciNfc_JewelInit");
  v3 = 255;
  if (!*a2)
  {
    if ((a2[1] & 0xF) == 0xC)
      v3 = 0;
    else
      v3 = 255;
  }
  sub_219850808(0, (unsigned int *)&v5, 3u, 5u, (uint64_t)"phNciNfc_JewelInit");
  return v3;
}

uint64_t sub_21988B1D0(uint64_t a1, int a2)
{
  unsigned int v4;
  uint64_t v5;
  unsigned int v6;
  unsigned int v7;
  unsigned int v8;
  unsigned int *v9;
  const char *v10;
  const char *v11;
  unsigned __int16 v13;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RecvJewelResp");
  if (!a1)
  {
    v13 = 1;
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    goto LABEL_29;
  }
  if (a2 || (v4 = *(_DWORD *)(a1 + 3768)) == 0 || (v5 = *(_QWORD *)(a1 + 3760)) == 0)
  {
    v13 = 255;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Data Receive Failed..");
    goto LABEL_27;
  }
  *(_BYTE *)(a1 + 6449) = 0;
  v6 = *(_DWORD *)(a1 + 4560);
  v7 = v4 - 1;
  v8 = *(unsigned __int8 *)(v5 + v4 - 1);
  if (v8 > 0xAF)
  {
    switch(*(_BYTE *)(v5 + v4 - 1))
    {
      case 0xB0:
        v13 = 182;
        v9 = (unsigned int *)(a1 + 6476);
        v10 = " Jewel XchgData,PH_NCINFC_STATUS_RF_TRANSMISSION_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB1:
        v13 = 183;
        v9 = (unsigned int *)(a1 + 6476);
        v10 = " Jewel XchgData,PH_NCINFC_STATUS_RF_PROTOCOL_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB2:
        v13 = 178;
        v9 = (unsigned int *)(a1 + 6476);
        v10 = " Jewel XchgData,PH_NCINFC_STATUS_RF_TIMEOUT_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB3:
        v13 = 184;
        v9 = (unsigned int *)(a1 + 6476);
        v10 = " Jewel XchgData,PH_NCINFC_STATUS_RF_UNEXPECTED_DAT Detected by NFCC during Data Exchange ";
        break;
      default:
        if (v8 == 190)
        {
          v13 = 187;
          v9 = (unsigned int *)(a1 + 6476);
          v10 = " Jewel XchgData,PH_NCINFC_STATUS_HRM_SE_INIT_REQUIRED Detected by NFCC during Data Exchange ";
        }
        else
        {
          if (v8 != 191)
            goto LABEL_22;
          v13 = 186;
          v9 = (unsigned int *)(a1 + 6476);
          v10 = " Jewel XchgData,PH_NCINFC_STATUS_HRM_TIMER_RUNNING Detected by NFCC during Data Exchange ";
        }
        break;
    }
LABEL_25:
    sub_219850628(1, v9, 3u, 2u, (uint64_t)v10);
    goto LABEL_26;
  }
  if (*(_BYTE *)(v5 + v4 - 1))
  {
    if (v8 != 2)
    {
LABEL_22:
      v13 = 185;
      sub_219886108(*(_QWORD *)(a1 + 6480), v8);
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)" Jewel XchgData,Unknown RF related error Detected by NFCC during Data Exchange ");
      if (v4 <= v6)
      {
        phOsalNfc_MemCopy();
        *(_DWORD *)(a1 + 4560) = v4;
      }
      goto LABEL_26;
    }
    v13 = 181;
    v9 = (unsigned int *)(a1 + 6476);
    v10 = " Jewel XchgData,PH_NCINFC_STATUS_RF_FRAME_CORRUPTED Detected by NFCC during Data Exchange ";
    goto LABEL_25;
  }
  if (v4 < 2)
  {
    v13 = 255;
    v11 = " Jewel XchgData Failed ..";
  }
  else
  {
    v13 = 0;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Jewel XchgData Request is Successful!! ..");
    if (v7 <= v6)
    {
      if (v4 == 7 || v4 == 123)
      {
        phOsalNfc_MemCopy();
        *(_DWORD *)(a1 + 4560) = v7;
        if (*(_BYTE *)(a1 + 4568) == 1)
          *(_BYTE *)(a1 + 6449) = 1;
      }
      else
      {
        phOsalNfc_MemCopy();
        *(_DWORD *)(a1 + 4560) = v4 - 2;
      }
      goto LABEL_26;
    }
    v13 = 8;
    v11 = " Jewel XchgData,More Data available than requested  ..";
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)v11);
LABEL_26:
  sub_2198F1654(a1, &v13);
LABEL_27:
  if (*(_QWORD *)(a1 + 4600))
  {
    *(_DWORD *)(a1 + 4608) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Freeing Send Request Payload Buffer..");
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 4600) = 0;
    *(_WORD *)(a1 + 4592) = v13;
  }
LABEL_29:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RecvJewelResp");
  return v13;
}

uint64_t sub_21988B55C(uint64_t a1)
{
  uint64_t v2;
  uint64_t Memory;
  const char *v4;
  uint64_t v5;
  __int128 v7;
  __int128 v8;

  v7 = 0u;
  v8 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendJewelReq");
  if (a1)
  {
    v2 = *(_QWORD *)(a1 + 4512);
    if (v2)
    {
      if (*(_DWORD *)(a1 + 4544))
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Creating Request Payload (Header + Data)..");
        *(_DWORD *)(a1 + 4608) = *(_DWORD *)(a1 + 4544);
        Memory = phOsalNfc_GetMemory();
        *(_QWORD *)(a1 + 4600) = Memory;
        if (Memory)
        {
          phOsalNfc_SetMemory();
          phOsalNfc_MemCopy();
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Payload (Header + Data) created successfully..");
          phOsalNfc_SetMemory();
          LODWORD(v7) = 0;
          if (!sub_219878C88((unsigned int *)a1, v2, (_BYTE *)((unint64_t)&v7 | 0xC)))
          {
            *(_QWORD *)&v8 = *(_QWORD *)(a1 + 4600);
            DWORD2(v8) = *(_DWORD *)(a1 + 4608);
            if (sub_2198F2D0C(a1 + 888, (uint64_t)&v7, a1 + 3760, *(unsigned __int16 *)(a1 + 4526), (uint64_t)sub_2198F135C, a1) == 13)
            {
              v5 = 13;
              goto LABEL_13;
            }
            phOsalNfc_FreeMemory();
            *(_QWORD *)(a1 + 4600) = 0;
            *(_DWORD *)(a1 + 4608) = 0;
            goto LABEL_12;
          }
          phOsalNfc_FreeMemory();
          *(_QWORD *)(a1 + 4600) = 0;
          *(_DWORD *)(a1 + 4608) = 0;
          v4 = " Couldn't Get ConnId..";
        }
        else
        {
          v4 = " Payload MemAlloc for Send request Failed..";
        }
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)v4);
LABEL_12:
        v5 = 255;
        goto LABEL_13;
      }
      v5 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Length..");
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Device..");
      v5 = 6;
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v5 = 1;
  }
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendJewelReq");
  return v5;
}

uint64_t sub_21988B79C(unsigned int *a1, _BYTE *a2, _BYTE *a3)
{
  uint64_t v6;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateUidInfo");
  if (a1)
  {
    a2[49] = *a3;
    a2[50] = a3[1];
    a2[46] = 7;
    phOsalNfc_MemCopy();
    v6 = 0;
  }
  else
  {
    v6 = 255;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateUidInfo");
  return v6;
}

uint64_t sub_21988B840(uint64_t a1, int a2)
{
  int v4;
  uint64_t v5;
  BOOL v6;
  char v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MapTool_NDEF_SetCardState");
  v4 = *(unsigned __int8 *)(a1 + 545);
  if (a2)
  {
    if (v4 == 2 || v4 == 1)
    {
      v5 = 0;
    }
    else
    {
      if (*(_BYTE *)(a1 + 545))
      {
        *(_BYTE *)(a1 + 545) = 3;
        v5 = 22;
        goto LABEL_15;
      }
      v5 = 0;
      LOBYTE(v4) = 2;
    }
    *(_BYTE *)(a1 + 545) = v4;
  }
  else
  {
    v6 = (v4 & 0xFFFFFFFD) == 1;
    if ((v4 & 0xFFFFFFFD) == 1)
      v7 = 3;
    else
      v7 = 0;
    *(_BYTE *)(a1 + 545) = v7;
    if (v6)
      v5 = 22;
    else
      v5 = 0;
  }
LABEL_15:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MapTool_NDEF_SetCardState");
  return v5;
}

uint64_t sub_21988B8FC(uint64_t a1, unsigned int a2)
{
  unsigned int v3;
  int v4;
  uint64_t v5;
  int v6;

  v3 = *(unsigned __int8 *)(a1 + a2 + 266);
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MapTool_NDEF_ChkSpcVer");
  sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Checking the Ndef version suported by the card...");
  if (v3)
  {
    v4 = *(unsigned __int8 *)(a1 + 544);
    if ((v4 - 7) < 2)
    {
      v6 = ((v3 & 0x30) != 0) & (v3 >> 6);
      if ((v3 & 0x70) == 0x40)
        v6 = 1;
      if (v6)
        v5 = 0;
      else
        v5 = 28;
    }
    else if (v4 == 2 || v4 == 6)
    {
      if (v3 >= 0x30)
        v5 = 28;
      else
        v5 = 0;
    }
    else if (v3 == 18)
    {
      v5 = 0;
    }
    else if (((v3 & 0xF) < 3 || (v3 & 0xF0) != 16) && v3 > 0xF && v3 > 0x1F)
    {
      v5 = 28;
    }
    else
    {
      v5 = 0;
    }
  }
  else
  {
    v5 = 28;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MapTool_NDEF_ChkSpcVer");
  return v5;
}

uint64_t sub_21988BA0C(unsigned int *a1, _DWORD *a2, unsigned int a3)
{
  unint64_t v6;
  _DWORD *v7;
  unsigned __int16 *v8;
  _DWORD *v9;
  unint64_t v10;
  int v11;

  sub_219850718(2, a1, 8u, 5u, (uint64_t)"sortLockResByteInfoArray");
  if (a3)
  {
    v6 = 0;
    v7 = a2;
    do
    {
      v8 = (unsigned __int16 *)&a2[v6];
      v9 = v7;
      v10 = v6;
      do
      {
        if (*v8 > *(unsigned __int16 *)v9)
        {
          v11 = *(_DWORD *)v8;
          *(_DWORD *)v8 = *v9;
          *v9 = v11;
        }
        ++v10;
        ++v9;
      }
      while (v10 < a3);
      ++v6;
      ++v7;
    }
    while (v6 != a3);
  }
  return sub_219850808(2, a1, 8u, 5u, (uint64_t)"sortLockResByteInfoArray");
}

uint64_t sub_21988BAC8(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendDeactDiscCmd");
  if (a1)
  {
    sub_219888594(*(_QWORD *)(a1 + 19360));
    v2 = sub_2198FD2D0(*(_QWORD *)(a1 + 3040), 3, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendDeactDiscCmd");
  return v2;
}

uint64_t sub_21988BB50(uint64_t a1, int a2, int *a3, uint64_t a4)
{
  _BOOL4 v9;
  int v10;
  int v11;
  uint64_t v12;
  uint64_t v13;
  const char *v14;
  int v15;
  uint64_t v16;
  const char *v17;
  int v18;
  unsigned int *v19;
  uint64_t v21;
  uint64_t v22;
  uint64_t v23;
  uint64_t v24;
  int v25;
  int v26;
  void (*v27)(_QWORD, uint64_t, _QWORD, uint64_t);
  uint64_t v28;
  void (*v29)(_QWORD, uint64_t, uint64_t);
  uint64_t v30;
  unsigned int v31;
  unsigned __int16 v32;
  int v33;
  unsigned int *v34;
  void (*v35)(_QWORD, uint64_t, _QWORD, uint64_t);
  uint64_t v36;
  int v37;
  char v38;

  v38 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeActvNtfRegister_Resp_Cb");
  if (!a1 || !a3)
  {
    v17 = "Invalid Params received!!";
    v18 = 2;
    v19 = (unsigned int *)a1;
LABEL_16:
    sub_219850628(v18, v19, 4u, 1u, (uint64_t)v17);
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeActvNtfRegister_Resp_Cb");
  }
  sub_2198DA75C(a1);
  v9 = (_DWORD)a4 == 146 || (_DWORD)a4 == 7;
  if (a2 == 7 && v9)
  {
    v10 = sub_2198D2574(*(_QWORD *)(a1 + 19360));
    v11 = sub_2198D24A8(*(_QWORD *)(a1 + 19360));
    v37 = *(_DWORD *)(a1 + 984);
    if ((a3[1] - 1) <= 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"eRfDeactvReason -> phNciNfc_e_RfLinkLoss or phNciNfc_e_EndPoint");
      sub_2198D27D4(*(_QWORD *)(a1 + 19360), 0);
    }
    v12 = a1 + 984;
    v13 = *a3;
    if (v13 > 3)
    {
      v16 = 150;
      v15 = 2;
      v14 = "eRfDeactvType Other";
    }
    else
    {
      v14 = off_24DB72280[v13];
      v15 = dword_21990A6A0[v13];
      v16 = dword_21990A6B0[v13];
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)v14);
    *(_DWORD *)(a1 + 984) = v15;
    v38 = 0;
    sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ListenModeDeactvNtfHandler");
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"In phLibNfc_ListenModeDeactvNtfHandler");
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"pLibNfcHandle->dev_cnt == ");
    if (*(_QWORD *)(a1 + 6760) && *(_BYTE *)(a1 + 714))
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"RemDevType -> phNfc_eNfcIP1_Initiator");
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"pClientNfcIpRxCb is valid, invoking...");
      v25 = v10;
      v26 = v11;
      v27 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(a1 + 6760);
      v28 = *(_QWORD *)(a1 + 6768);
      *(_QWORD *)(a1 + 6760) = 0;
      *(_QWORD *)(a1 + 6768) = 0;
      v16 = v16;
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 30, (uint64_t)"phLibNfc_ListenModeDeactvNtfHandler");
      v27(*(_QWORD *)(a1 + 19360), v28, 0, a4);
      v11 = v26;
      v10 = v25;
      v12 = a1 + 984;
    }
    else
    {
      if (!*(_QWORD *)(a1 + 6744) || !*(_BYTE *)(a1 + 714))
      {
LABEL_30:
        sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ListenModeDeactvNtfHandler");
        sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v16, a4, v12, (uint64_t)&v38);
        if (*(_BYTE *)(a1 + 2885)
          && *a3 == 1
          && *(_BYTE *)(a1 + 714)
          && (v31 = *(_DWORD *)(*(_QWORD *)(a1 + 832) + 4), v31 <= 0x1B)
          && ((1 << v31) & 0x8000006) != 0)
        {
          sub_2198D27D4(*(_QWORD *)(a1 + 19360), 0);
          sub_2198D2964(*(_QWORD *)(a1 + 19360), 12);
          sub_2198D289C(*(_QWORD *)(a1 + 19360), 4);
          *(_DWORD *)(a1 + 984) = 0;
        }
        else if (v38 != 1)
        {
          sub_2198D27D4(*(_QWORD *)(a1 + 19360), v10);
          sub_2198D2964(*(_QWORD *)(a1 + 19360), v11);
          *(_DWORD *)(a1 + 984) = v37;
        }
        return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeActvNtfRegister_Resp_Cb");
      }
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"pClientNfcIpTxCb is valid, invoking...");
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"RemDevType -> phNfc_eNfcIP1_Initiator");
      v29 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 6744);
      v30 = *(_QWORD *)(a1 + 6752);
      *(_QWORD *)(a1 + 6744) = 0;
      *(_QWORD *)(a1 + 6752) = 0;
      v12 = a1 + 984;
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 31, (uint64_t)"phLibNfc_ListenModeDeactvNtfHandler");
      v29(*(_QWORD *)(a1 + 19360), v30, a4);
    }
    v38 = 1;
    goto LABEL_30;
  }
  if ((_DWORD)a4 == 121)
  {
    *(_BYTE *)(a1 + 19353) = 0;
    v32 = 120;
    if (*(_DWORD *)(a1 + 1088) != 3)
    {
      if (*(_DWORD *)(a1 + 988) == 7)
        v32 = 120;
      else
        v32 = 121;
    }
    v24 = a1 + 984;
    *(_QWORD *)(a1 + 984) = 2;
    v21 = *(_QWORD *)(a1 + 19360);
    v23 = v32;
    v22 = 150;
    goto LABEL_43;
  }
  if ((_DWORD)a4 != 120)
  {
    v19 = (unsigned int *)(a1 + 19368);
    v17 = "Irrelevant notification received!!";
    v18 = 1;
    goto LABEL_16;
  }
  if (*(_QWORD *)(a1 + 6152))
  {
    sub_2198C0850(a1);
    sub_2198D27D4(*(_QWORD *)(a1 + 19360), 0);
    v21 = *(_QWORD *)(a1 + 19360);
    v22 = 154;
    v23 = 255;
    v24 = 0;
LABEL_43:
    sub_2198D1B2C(v21, v22, v23, v24, (uint64_t)&v38);
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeActvNtfRegister_Resp_Cb");
  }
  sub_2198D27D4(*(_QWORD *)(a1 + 19360), 0);
  *(_DWORD *)(a1 + 984) = 2;
  v33 = sub_2198D1B2C(*(_QWORD *)(a1 + 19360), 150, 0, a1 + 984, (uint64_t)&v38);
  if (v33)
  {
    v34 = (unsigned int *)(a1 + 19368);
    if (v33 == 111)
    {
      sub_219850628(1, v34, 4u, 2u, (uint64_t)"State machine has returned NFCSTATUS_BUSY ");
    }
    else
    {
      sub_219850628(1, v34, 4u, 1u, (uint64_t)"State machine has returned NFCSTATUS_FAILED ");
      sub_21987A7D4(a1);
    }
  }
  else
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"State machine has returned NFCSTATUS_SUCCESS ");
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Invoking upper layer callback function ");
    v35 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(a1 + 6216);
    if (v35)
    {
      v36 = *(_QWORD *)(a1 + 6224);
      *(_QWORD *)(a1 + 6216) = 0;
      *(_QWORD *)(a1 + 6224) = 0;
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 130, (uint64_t)"phLibNfc_DeActvNtfRegister_Resp_Cb");
      v35(*(_QWORD *)(a1 + 19360), v36, 0, 121);
      sub_2198C0850(a1);
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeActvNtfRegister_Resp_Cb");
}

uint64_t sub_21988C13C(uint64_t a1, uint64_t a2, uint64_t a3, unsigned __int8 a4)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RfIntfErrNtf_Resp_Cb");
  if (a1 && *(_QWORD *)(a1 + 6744) && *(_BYTE *)(a1 + 714))
  {
    sub_2198DA75C(a1);
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), 146, a4, 0, 0);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RfIntfErrNtf_Resp_Cb");
}

uint64_t sub_21988C1C4(uint64_t a1, uint64_t a2, _WORD *a3)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessDeactResp");
  if (!a1)
  {
    a2 = 255;
    goto LABEL_15;
  }
  *(_BYTE *)(a1 + 19353) = 0;
  if (!(_DWORD)a2)
  {
    if (a3)
    {
      a2 = (unsigned __int16)*a3;
      if ((unsigned __int16)*a3 > 0x50u)
      {
        if ((a2 - 81) <= 0x3E && ((1 << (a2 - 81)) & 0x4000010000000001) != 0)
          goto LABEL_14;
      }
      else
      {
        if (!*a3)
        {
LABEL_14:
          sub_219865598(*(unsigned int **)(a1 + 3040), 0);
          goto LABEL_15;
        }
        if ((_DWORD)a2 == 47 || (_DWORD)a2 == 58)
        {
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Deactivation success");
          a2 = 0;
          goto LABEL_14;
        }
      }
    }
    a2 = 255;
    goto LABEL_14;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Deactivate failed!");
LABEL_15:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessDeactResp");
  return a2;
}

uint64_t sub_21988C2EC(uint64_t a1, int a2, unsigned int a3)
{
  uint64_t v5;
  uint64_t v7;

  v7 = a1;
  sub_219850718(0, (unsigned int *)&v7, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateRspPktOID");
  v5 = 255;
  if (a2 > 1)
  {
    if (a2 != 2)
    {
      if (a2 != 15)
        goto LABEL_16;
      if (a3 >= 0x3F || ((0x7A0D5F26BA1321CFuLL >> a3) & 1) == 0)
        goto LABEL_15;
LABEL_13:
      v5 = 0;
      goto LABEL_16;
    }
    if (a3 < 2)
      goto LABEL_13;
LABEL_15:
    sub_219851790(0, (unsigned int *)&v7, 3u, 1u, (uint64_t)"Unknown OID received");
    goto LABEL_16;
  }
  if (!a2)
  {
    if (a3 < 6)
      goto LABEL_13;
    goto LABEL_15;
  }
  if (a2 == 1)
  {
    if (a3 >= 0xC || ((0x95Fu >> a3) & 1) == 0)
      goto LABEL_15;
    goto LABEL_13;
  }
LABEL_16:
  sub_219850808(0, (unsigned int *)&v7, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsValidateRspPktOID");
  return v5;
}

uint64_t sub_21988C3F8(uint64_t a1, unsigned __int8 *a2, unsigned int a3)
{
  uint64_t v6;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsAppendCrc");
  if (a1 && a2 && a3)
  {
    v6 = 0;
    *(_WORD *)&a2[a3] = __rev16(sub_219853A48(*(_QWORD *)(a1 + 632), a2, a3));
  }
  else
  {
    sub_219850628(3, (unsigned int *)a1, 3u, 2u, (uint64_t)"Invalid parameter received");
    v6 = 1;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreUtilsAppendCrc");
  return v6;
}

uint64_t sub_21988C4AC(unsigned int a1, uint64_t a2)
{
  unsigned int v4;

  v4 = a1;
  sub_219850718(1, &v4, 3u, 5u, (uint64_t)"phNciNfc_StopTimer");
  if (a2 && a2 != 0xFFFFFFFFFFFFLL && phOsalNfc_Timer_Stop())
    sub_219851790(1, &v4, 3u, 4u, (uint64_t)"NCI Timer_Stop failed,Stat=");
  return sub_219850808(1, &v4, 3u, 5u, (uint64_t)"phNciNfc_StopTimer");
}

uint64_t sub_21988C54C(uint64_t a1, int a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyOkCb");
  if (!a1 || a2)
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)"phHciNfc_AnyOkCb:Invalid Context received");
  }
  else
  {
    sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_AnyOkCb:");
    v4 = *(_QWORD *)(a1 + 152);
    if (v4)
    {
      if (*(_QWORD *)(v4 + 8))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 152) = 0;
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyOkCb");
}

uint64_t sub_21988C618(uint64_t a1, int a2)
{
  void (*v4)(_QWORD, uint64_t, _QWORD);
  unsigned int *v5;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CmdSendCb");
  if (a1)
  {
    v4 = *(void (**)(_QWORD, uint64_t, _QWORD))(a1 + 184);
    if (v4)
    {
      v5 = (unsigned int *)(a1 + 956);
      if (a2)
      {
        sub_219850628(1, v5, 7u, 1u, (uint64_t)"phHciNfc_CmdSendCb: Send Failed");
        v4(*(_QWORD *)(a1 + 192), 255, 0);
      }
      else
      {
        sub_219850628(1, v5, 7u, 4u, (uint64_t)"phHciNfc_CmdSendCb: Send success");
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CmdSendCb");
}

uint64_t sub_21988C6CC(uint64_t a1, uint64_t a2)
{
  void (*v4)(_QWORD, uint64_t, _QWORD);
  unsigned int *v5;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_RawCmdSendCb");
  if (a1)
  {
    v4 = *(void (**)(_QWORD, uint64_t, _QWORD))(a1 + 184);
    if (v4)
    {
      *(_QWORD *)(a1 + 184) = 0;
      v5 = (unsigned int *)(a1 + 956);
      if ((_DWORD)a2)
        sub_219850628(1, v5, 7u, 1u, (uint64_t)"phHciNfc_RawCmdSendCb: Send Failed");
      else
        sub_219850628(1, v5, 7u, 4u, (uint64_t)"phHciNfc_RawCmdSendCb: Send success");
      v4(*(_QWORD *)(a1 + 192), a2, 0);
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_RawCmdSendCb");
}

uint64_t sub_21988C784(uint64_t a1, int a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, _QWORD);
  uint64_t v7;
  unsigned int *v8;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnySetParameterCb");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 152))
    {
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"AnySetParameterCb: Releasing memory");
      if (*(_QWORD *)(*(_QWORD *)(a1 + 152) + 8))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 152) = 0;
    }
    v6 = *(void (**)(_QWORD, uint64_t, _QWORD))(a1 + 184);
    if (!a2)
    {
      v8 = (unsigned int *)(a1 + 956);
      if (!*(_BYTE *)(a3 + 1))
      {
        sub_219850628(1, v8, 7u, 4u, (uint64_t)"phHciNfc_AnySetParameterCb:Sucessfull");
        v7 = 0;
        if (v6)
          goto LABEL_8;
        goto LABEL_13;
      }
      if (*v8)
        dword_253E4715C |= 0x40000000u;
      else
        dword_253E47074 |= 0x40000000u;
    }
    v7 = 255;
    if (v6)
    {
LABEL_8:
      *(_QWORD *)(a1 + 184) = 0;
      v6(*(_QWORD *)(a1 + 192), v7, 0);
      return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnySetParameterCb");
    }
LABEL_13:
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_AnySetParameterCb:Uppler Layer Callback not defined");
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnySetParameterCb");
}

uint64_t sub_21988C8D4(uint64_t a1, int a2, uint64_t a3)
{
  uint64_t v6;
  void (*v7)(_QWORD, uint64_t, uint64_t);
  uint64_t v8;
  unsigned int *v9;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyGetParameterCb");
  if (!a1)
    return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyGetParameterCb");
  v6 = *(_QWORD *)(a1 + 960);
  if (*(_QWORD *)(a1 + 152))
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"AnyGetParameterCb: Releasing memory");
    if (*(_QWORD *)(*(_QWORD *)(a1 + 152) + 8))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
    }
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 152) = 0;
  }
  if (!v6 || !*(_QWORD *)(v6 + 6536))
  {
    v7 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 184);
    if (!a2)
    {
      v9 = (unsigned int *)(a1 + 956);
      if (!*(_BYTE *)(a3 + 1))
      {
        sub_219850628(1, v9, 7u, 4u, (uint64_t)"phHciNfc_AnyGetParameterCb:Sucessfull");
        v8 = 0;
        if (v7)
          goto LABEL_14;
        goto LABEL_20;
      }
      if (*v9)
        dword_253E4715C |= 0x40000000u;
      else
        dword_253E47074 |= 0x40000000u;
    }
    v8 = 255;
    if (v7)
    {
LABEL_14:
      *(_QWORD *)(a1 + 184) = 0;
      v7(*(_QWORD *)(a1 + 192), v8, a3);
      return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyGetParameterCb");
    }
LABEL_20:
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_AnyGetParameterCb:Uppler Layer Callback not defined");
    return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyGetParameterCb");
  }
  if (a2 || *(_BYTE *)(a3 + 1))
  {
    if (*(_DWORD *)(a1 + 956))
      dword_253E4715C |= 0x40000000u;
    else
      dword_253E47074 |= 0x40000000u;
  }
  else
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_AnyGetParameterCb:Sucessfull");
    sub_2198E0AAC(*(_QWORD *)(a1 + 960), 0, a3);
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyGetParameterCb");
}

uint64_t sub_21988CAA0(uint64_t a1, int a2, uint64_t a3)
{
  void (*v6)(_QWORD, uint64_t, uint64_t);
  char v7;
  uint64_t v8;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_OpenPipeCb");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 152))
    {
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"OpenPipeCb: Releasing memory");
      if (*(_QWORD *)(*(_QWORD *)(a1 + 152) + 8))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 152) = 0;
    }
    v6 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 184);
    if (a2)
    {
      v7 = 0;
    }
    else
    {
      if (!*(_BYTE *)(a3 + 1))
      {
        if (*(_WORD *)(a3 + 4))
          v7 = **(_BYTE **)(a3 + 8);
        else
          v7 = 0;
        sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_OpenPipeCb:Sucessfull");
        v8 = 0;
        if (v6)
          goto LABEL_9;
        goto LABEL_18;
      }
      v7 = 0;
      if (*(_DWORD *)(a1 + 956))
        dword_253E4715C |= 0x40000000u;
      else
        dword_253E47074 |= 0x40000000u;
    }
    v8 = 255;
    if (v6)
    {
LABEL_9:
      *(_QWORD *)(a1 + 184) = 0;
      *(_BYTE *)(a1 + 1237) = v7;
      v6(*(_QWORD *)(a1 + 192), v8, a1 + 1237);
      return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_OpenPipeCb");
    }
LABEL_18:
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_OpenPipeCb:Uppler Layer Callback not defined");
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_OpenPipeCb");
}

uint64_t sub_21988CC18(uint64_t a1, int a2, unsigned int a3, char a4, uint64_t a5, uint64_t a6)
{
  const char *v12;
  int v13;
  unsigned int *v14;
  uint64_t v15;
  uint64_t Memory;
  uint64_t v17;
  _BYTE *v18;
  uint64_t v19;
  uint64_t v20;
  char v22;
  uint64_t v23;
  int v24;
  uint64_t v25;

  v25 = 0;
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyGetParameter");
  if (!a1)
  {
    v12 = "phHciNfc_AnyGetParameter:Invalid HCI Context";
    v13 = 2;
    v14 = 0;
LABEL_20:
    sub_219850628(v13, v14, 7u, 1u, (uint64_t)v12);
    goto LABEL_21;
  }
  *(_BYTE *)(a1 + 1236) = 0;
  *(_BYTE *)(a1 + 1232) = 0;
  switch(a2)
  {
    case 1:
      if (a3 <= 4)
        break;
LABEL_19:
      v14 = (unsigned int *)(a1 + 956);
      v12 = "phHciNfc_AnyGetParameter:Failed Gate ID Evaluation";
      v13 = 1;
      goto LABEL_20;
    case 5:
      if (a3 <= 6)
        break;
      goto LABEL_19;
    case 4:
      if (a3 != 1)
        goto LABEL_19;
      break;
    default:
      sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CheckPropGate");
      v22 = 0;
      v23 = 0;
      do
      {
        v24 = *(unsigned __int8 *)(a1 + 2 * v23 + 817);
        if ((v22 & 1) != 0)
          break;
        v22 = 1;
        v23 = 1;
      }
      while (v24 != a2);
      sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_CheckPropGate");
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_AnyGetParameter: checking for Prop Gate");
      if (v24 != a2)
        goto LABEL_19;
      break;
  }
  v15 = *(_QWORD *)(a1 + 152);
  if (v15)
  {
    if (*(_QWORD *)(v15 + 8))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
    }
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 152) = 0;
  }
  Memory = phOsalNfc_GetMemory();
  if (!Memory)
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_AnyGetParameter:Invalid input parameters");
    v20 = 0;
    goto LABEL_22;
  }
  v17 = Memory;
  phOsalNfc_SetMemory();
  *(_QWORD *)(a1 + 152) = v17;
  *(_BYTE *)v17 = a4;
  *(_WORD *)(v17 + 1) = 2;
  v18 = (_BYTE *)phOsalNfc_GetMemory();
  *(_QWORD *)(a1 + 1224) = v18;
  if (!v18)
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_AnyGetParameter:Memory Allocation failed");
    *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
    phOsalNfc_FreeMemory();
    v20 = 0;
    *(_QWORD *)(a1 + 152) = 0;
    goto LABEL_22;
  }
  *v18 = a3;
  *(_QWORD *)(v17 + 8) = *(_QWORD *)(a1 + 1224);
  *(_DWORD *)(v17 + 4) = 1;
  *(_BYTE *)(a1 + 953) = 0;
  v19 = sub_219889530(a1, (__int128 *)v17, (uint64_t)sub_21988C618, a1);
  if ((_DWORD)v19 != 13)
  {
    v20 = v19;
    phOsalNfc_FreeMemory();
    *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 152) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_AnyGetParameter:Failed Status from lower layer");
    goto LABEL_22;
  }
  *(_QWORD *)(a1 + 184) = a5;
  *(_QWORD *)(a1 + 192) = a6;
  LODWORD(v25) = 2;
  BYTE4(v25) = *(_BYTE *)v17;
  if (!sub_21988CF78((unsigned int *)a1, (uint64_t)&v25, (uint64_t)sub_21988C8D4, (unsigned int *)a1))
  {
    v20 = 13;
    goto LABEL_22;
  }
  sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_AnyGetParameter: Failed to register phHciNfc_OpenPipeCb function");
  *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
  phOsalNfc_FreeMemory();
  phOsalNfc_FreeMemory();
  *(_QWORD *)(a1 + 152) = 0;
LABEL_21:
  v20 = 255;
LABEL_22:
  sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnyGetParameter");
  return v20;
}

uint64_t sub_21988CF78(unsigned int *a1, uint64_t a2, uint64_t a3, unsigned int *a4)
{
  int v8;
  uint64_t v9;
  uint64_t v10;
  const char *v11;
  int v12;
  unsigned int *v13;
  unsigned int v14;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_RegisterCmdRspEvt");
  if (!a2 || !a1 || !a3)
  {
    v11 = "phHciNfc_RegisterCmdRspEvt:Failed, Invalid Context or Input params";
    v9 = 1;
    v12 = 2;
    v13 = a1;
LABEL_13:
    sub_219850628(v12, v13, 7u, 1u, (uint64_t)v11);
    v8 = 0;
    v10 = 0;
    v14 = 0;
    goto LABEL_14;
  }
  v8 = *(_DWORD *)a2;
  if (*(_DWORD *)a2 == 2)
  {
    v9 = 0;
    v10 = (uint64_t)(a1 + 90);
    goto LABEL_10;
  }
  if (v8 == 1)
  {
    v9 = 0;
    v10 = (uint64_t)(a1 + 126);
    v14 = 12;
    goto LABEL_14;
  }
  if (v8)
  {
    v13 = a1 + 239;
    v11 = "phHciNfc_RegisterCmdRspEvt:Failed, Invalid HCI bMsgType";
    v9 = 1;
    v12 = 1;
    goto LABEL_13;
  }
  v9 = 0;
  v10 = (uint64_t)(a1 + 54);
LABEL_10:
  v14 = 6;
  v8 = 1;
LABEL_14:
  if (v8 && a4 && v10 && a3 && a2)
  {
    sub_219851888(1, a1 + 239, 7u, 4u, (uint64_t)"phHciNfc_RegisterCmdRspEvt:Registering for Pipe ID");
    sub_219851888(1, a1 + 239, 7u, 4u, (uint64_t)"phHciNfc_RegisterCmdRspEvt:Registering for Msg Type");
    v9 = sub_21988D7D4(a1, v10, v14, *(unsigned __int8 *)(a2 + 4), a3, a4);
  }
  else
  {
    sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_RegisterCmdRspEvt:Failed, Invalid HCI bMsgType or Input params");
  }
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_RegisterCmdRspEvt");
  return v9;
}

uint64_t sub_21988D124(uint64_t a1, int a2, char a3, unsigned int a4, uint64_t a5, uint64_t a6, uint64_t a7)
{
  uint64_t v13;
  int v14;
  const char *v15;
  int v16;
  unsigned int *v17;
  uint64_t v18;
  uint64_t v19;
  uint64_t v21;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnySetParameter");
  if (!a1 || a4 >= 0xFD)
  {
    v15 = "phHciNfc_AnySetParameter:Invalid HCI Context";
    v16 = 2;
    v17 = (unsigned int *)a1;
LABEL_20:
    sub_219850628(v16, v17, 7u, 1u, (uint64_t)v15);
    return 255;
  }
  v13 = *(_QWORD *)(a1 + 152);
  if (v13)
  {
    if (*(_QWORD *)(v13 + 8))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
    }
    phOsalNfc_FreeMemory();
  }
  *(_QWORD *)(a1 + 152) = 0;
  phOsalNfc_SetMemory();
  *(_BYTE *)(a1 + 160) = a3;
  *(_WORD *)(a1 + 161) = 1;
  if (a2 == 3)
  {
    v14 = a4 + 1;
    goto LABEL_13;
  }
  if (a2 != 1)
  {
    v15 = "phHciNfc_AnySetParameter:Failed Invalid Registery Identifier";
LABEL_19:
    v16 = 1;
    v17 = (unsigned int *)(a1 + 956);
    goto LABEL_20;
  }
  if (a4 != 8)
  {
    v15 = "phHciNfc_AnySetParameter:Failed Invalid Set Data Length";
    goto LABEL_19;
  }
  v14 = 9;
LABEL_13:
  *(_DWORD *)(a1 + 164) = v14;
  v21 = 0;
  *(_QWORD *)(a1 + 168) = a1 + 969;
  *(_BYTE *)(a1 + 969) = a2;
  phOsalNfc_MemCopy();
  *(_BYTE *)(a1 + 953) = 0;
  v18 = sub_219889530(a1, (__int128 *)(a1 + 160), (uint64_t)sub_21988C618, a1);
  if ((_DWORD)v18 == 13)
  {
    *(_QWORD *)(a1 + 184) = a6;
    *(_QWORD *)(a1 + 192) = a7;
    LODWORD(v21) = 2;
    BYTE4(v21) = *(_BYTE *)(a1 + 160);
    if (sub_21988CF78((unsigned int *)a1, (uint64_t)&v21, (uint64_t)sub_21988C784, (unsigned int *)a1))
    {
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_AnySetParameter: Failed to register phHciNfc_OpenPipeCb function");
      v19 = 255;
    }
    else
    {
      v19 = 13;
    }
  }
  else
  {
    v19 = v18;
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_AnySetParameter:Failed to send to lower layer");
  }
  sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_AnySetParameter");
  return v19;
}

uint64_t sub_21988D350(uint64_t a1, char a2, uint64_t a3, uint64_t a4)
{
  uint64_t Memory;
  uint64_t v9;
  uint64_t v10;
  const char *v11;
  int v12;
  unsigned int *v13;
  uint64_t v14;
  unsigned __int8 v16;
  uint64_t v17;

  v17 = 0;
  v16 = -1;
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_OpenPipe");
  if (!a1)
  {
    v11 = "phHciNfc_OpenPipe:Invalid HCI Context";
    v12 = 2;
    v13 = 0;
LABEL_13:
    sub_219850628(v12, v13, 7u, 1u, (uint64_t)v11);
    goto LABEL_14;
  }
  if (*(_QWORD *)(a1 + 152))
  {
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 152) = 0;
  }
  Memory = phOsalNfc_GetMemory();
  if (!Memory)
  {
    v11 = "phHciNfc_OpenPipe:Invalid Input Params";
    v12 = 1;
    v13 = (unsigned int *)(a1 + 956);
    goto LABEL_13;
  }
  v9 = Memory;
  phOsalNfc_SetMemory();
  *(_QWORD *)(a1 + 152) = v9;
  *(_BYTE *)v9 = a2;
  *(_WORD *)(v9 + 1) = 3;
  *(_QWORD *)(v9 + 8) = 0;
  *(_DWORD *)(v9 + 4) = 0;
  *(_BYTE *)(a1 + 953) = 0;
  v10 = sub_219889530(a1, (__int128 *)v9, (uint64_t)sub_21988C618, a1);
  if ((_DWORD)v10 != 13)
  {
    v14 = v10;
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 152) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_OpenPipe:Failed to send to lower layer");
    goto LABEL_17;
  }
  *(_QWORD *)(a1 + 184) = a3;
  *(_QWORD *)(a1 + 192) = a4;
  if (!sub_21988D588(a1, 240, &v16) && v16 != 255)
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_UnRegisterCmdRspEvt:eSE APDU Pipe");
    LODWORD(v17) = 2;
    BYTE4(v17) = v16;
    sub_21988D688((unsigned int *)a1, (int *)&v17, (uint64_t)sub_2198DCB70);
  }
  LODWORD(v17) = 2;
  BYTE4(v17) = *(_BYTE *)v9;
  if (!sub_21988CF78((unsigned int *)a1, (uint64_t)&v17, (uint64_t)sub_21988CAA0, (unsigned int *)a1))
  {
    v14 = 13;
    goto LABEL_17;
  }
  sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_OpenPipe: Failed to register phHciNfc_OpenPipeCb function");
  phOsalNfc_FreeMemory();
  *(_QWORD *)(a1 + 152) = 0;
LABEL_14:
  v14 = 255;
LABEL_17:
  sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_OpenPipe");
  return v14;
}

uint64_t sub_21988D588(uint64_t a1, int a2, _BYTE *a3)
{
  uint64_t v6;
  char v7;
  char v8;
  uint64_t v9;
  uint64_t v10;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_GetPipeId");
  if (a1 && a3)
  {
    v6 = 0;
    v7 = 1;
    do
    {
      v8 = v7;
      v9 = a1 + 2 * v6;
      if (*(unsigned __int8 *)(v9 + 817) == a2)
      {
        v10 = 0;
        *a3 = *(_BYTE *)(v9 + 816);
        goto LABEL_10;
      }
      v7 = 0;
      v6 = 1;
    }
    while ((v8 & 1) != 0);
    v10 = 1;
    if (*(_BYTE *)(a1 + 891) == 1)
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 2u, (uint64_t)"phHciNfc_GetPipeId: ADM_NOTIFY_ALL_PIPE_CLEARED cleared the pipes!!!");
  }
  else
  {
    v10 = 1;
    sub_219850628(2, (unsigned int *)a1, 7u, 1u, (uint64_t)"phHciNfc_GetPipeId:Invalid Context or PipeId");
  }
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_GetPipeId");
  return v10;
}

uint64_t sub_21988D688(unsigned int *a1, int *a2, uint64_t a3)
{
  int v6;
  uint64_t v7;
  const char *v8;
  uint64_t v9;
  int v10;
  unsigned int *v11;
  unsigned int v12;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_UnRegisterCmdRspEvt");
  if (!a2 || !a1 || !a3)
  {
    v8 = "phHciNfc_UnRegisterCmdRspEvt:Failed, Invalid Context or Callback";
    v9 = 1;
    v10 = 2;
    v11 = a1;
LABEL_14:
    sub_219850628(v10, v11, 7u, 1u, (uint64_t)v8);
    goto LABEL_15;
  }
  v6 = *a2;
  if (*a2 == 2)
  {
    v7 = (uint64_t)(a1 + 90);
    goto LABEL_10;
  }
  if (v6 == 1)
  {
    v7 = (uint64_t)(a1 + 126);
    v12 = 12;
    goto LABEL_12;
  }
  if (v6)
  {
    v11 = a1 + 239;
    v8 = "phHciNfc_UnRegisterCmdRspEvt:Failed, Invalid Msg Type";
    v9 = 1;
    v10 = 1;
    goto LABEL_14;
  }
  v7 = (uint64_t)(a1 + 54);
LABEL_10:
  v12 = 6;
LABEL_12:
  sub_219851888(1, a1 + 239, 7u, 4u, (uint64_t)"phHciNfc_UnRegisterCmdRspEvt:Removing Registeration for Pipe ID");
  sub_219851888(1, a1 + 239, 7u, 4u, (uint64_t)"phHciNfc_UnRegisterCmdRspEvt:Removing Registeration for MsgType");
  v9 = sub_21988D9C0(a1, v7, v12, *((unsigned __int8 *)a2 + 4), a3);
LABEL_15:
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_UnRegisterCmdRspEvt");
  return v9;
}

uint64_t sub_21988D7D4(unsigned int *a1, uint64_t a2, unsigned int a3, int a4, uint64_t a5, unsigned int *a6)
{
  uint64_t v12;
  uint64_t v13;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_AddRegistration");
  if (a2 && a5)
  {
    v12 = sub_21988D8D8(a6, a2, a3, a4, a5);
    if ((_DWORD)v12 && a3)
    {
      v13 = a3;
      while (*(_BYTE *)a2)
      {
        a2 += 24;
        if (!--v13)
          goto LABEL_10;
      }
      v12 = 0;
      *(_BYTE *)(a2 + 1) = a4;
      *(_QWORD *)(a2 + 8) = a6;
      *(_QWORD *)(a2 + 16) = a5;
      *(_BYTE *)a2 = 1;
    }
  }
  else
  {
    v12 = 1;
    sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_AddRegistration:Failed, Invalid List or Callback");
  }
LABEL_10:
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_AddRegistration");
  return v12;
}

uint64_t sub_21988D8D8(unsigned int *a1, uint64_t a2, unsigned int a3, int a4, uint64_t a5)
{
  uint64_t v10;
  uint64_t v11;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_VerifyIfRegistered");
  if (a2 && a5)
  {
    if (a3)
    {
      v10 = a3;
      while (*(_BYTE *)a2 != 1 || *(unsigned __int8 *)(a2 + 1) != a4 || *(_QWORD *)(a2 + 16) != a5)
      {
        a2 += 24;
        if (!--v10)
          goto LABEL_9;
      }
      v11 = 0;
    }
    else
    {
LABEL_9:
      v11 = 255;
    }
  }
  else
  {
    v11 = 1;
    sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_VerifyIfRegistered:Failed, Invalid List or Callback");
  }
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_VerifyIfRegistered");
  return v11;
}

uint64_t sub_21988D9C0(unsigned int *a1, uint64_t a2, unsigned int a3, int a4, uint64_t a5)
{
  uint64_t v10;
  uint64_t v11;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_RemoveRegistration");
  if (a2 && a5)
  {
    if (a3)
    {
      v10 = a3;
      while (*(_BYTE *)a2 != 1 || *(unsigned __int8 *)(a2 + 1) != a4 || *(_QWORD *)(a2 + 16) != a5)
      {
        a2 += 24;
        if (!--v10)
          goto LABEL_9;
      }
      v11 = 0;
      *(_WORD *)a2 = 0;
      *(_QWORD *)(a2 + 8) = 0;
      *(_QWORD *)(a2 + 16) = 0;
    }
    else
    {
LABEL_9:
      v11 = 255;
    }
  }
  else
  {
    v11 = 1;
    sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_RemoveRegistration:Failed, Invalid Callback or List Empty");
  }
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_RemoveRegistration");
  return v11;
}

uint64_t sub_21988DAB0(unsigned int *a1)
{
  uint64_t i;
  unsigned int *v3;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_UnRegAllRspCb");
  if (a1)
  {
    sub_219850628(1, a1 + 239, 7u, 4u, (uint64_t)"phHciNfc_UnRegAllRspEvts: Clearing all response call back function registrations");
    for (i = 0; i != 36; i += 6)
    {
      v3 = &a1[i];
      *((_QWORD *)v3 + 46) = 0;
      *((_QWORD *)v3 + 47) = 0;
      *((_WORD *)v3 + 180) = -256;
    }
  }
  else
  {
    sub_219850628(2, 0, 7u, 1u, (uint64_t)"phHciNfc_UnRegAllRspEvts: Failed, Invalid Context or Callback");
  }
  return sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_UnRegAllRspCb");
}

uint64_t sub_21988DB60(unsigned int *a1, uint64_t a2, int a3, int a4, _BYTE *a5)
{
  uint64_t v10;
  unsigned __int8 *v11;
  uint64_t v12;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_GetPipeIndex");
  if (a2 && a5)
  {
    if (a3)
    {
      v10 = 0;
      v11 = (unsigned __int8 *)(a2 + 1);
      while (*(v11 - 1) != 1 || *v11 != a4)
      {
        ++v10;
        v11 += 24;
        if (a3 == v10)
          goto LABEL_8;
      }
      v12 = 0;
      *a5 = v10;
    }
    else
    {
LABEL_8:
      sub_219850628(2, a1, 7u, 4u, (uint64_t)"phHciNfc_GetPipeIndex:Enabled slot is not found");
      v12 = 255;
    }
  }
  else
  {
    v12 = 1;
    sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_GetPipeIndex:Failed, Invalid Index or List Empty");
  }
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_GetPipeIndex");
  return v12;
}

uint64_t sub_21988DC68(uint64_t a1, int a2, uint64_t a3)
{
  uint64_t v6;
  int v7;
  const char *v8;
  int v9;
  unsigned int *v10;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt");
  if (!a1 || !a3 || (v6 = *(_QWORD *)(a1 + 960)) == 0)
  {
    v8 = "phHciNfc_ReceiveAdminNotifyEvt:Failed, Invalid Context or Info received";
    v9 = 2;
    v10 = (unsigned int *)a1;
    goto LABEL_10;
  }
  sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt:Process notification event received on Admin pipe");
  if (!a2)
  {
    v7 = *(unsigned __int8 *)(a3 + 1);
    if (v7 == 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt:Rxd Event End Of Operation");
      sub_2198E0D68(*(_QWORD *)(a1 + 960));
      return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt");
    }
    if (v7 != 32)
    {
      if (v7 == 3)
      {
        sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt:Rxd phHciNfc_e_EvtHotPlug");
        return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt");
      }
      v8 = "phHciNfc_ReceiveAdminNotifyEvt: Not processing the event";
      v9 = 1;
      v10 = (unsigned int *)(a1 + 956);
LABEL_10:
      sub_219850628(v9, v10, 7u, 1u, (uint64_t)v8);
      return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt");
    }
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt:Received OS Reset Ntf on Admin Pipe");
    if (!*(_QWORD *)(v6 + 6136))
      sub_2198E04F8(a1, 0, a3);
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyEvt");
}

uint64_t sub_21988DDD0(uint64_t a1, int a2, unsigned __int8 *a3)
{
  unsigned int *v6;
  const char *v7;
  int v8;
  uint64_t v9;
  uint64_t Memory;
  uint64_t v11;
  _BYTE *v12;
  int v13;
  uint64_t v15;

  v15 = 0;
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveOpenPipeNotifyCmd");
  if (!a1 || !a3)
  {
    v7 = "phHciNfc_ReceiveOpenPipeNotifyCmd:Failed Invalid Params Received";
    v8 = 2;
    v6 = (unsigned int *)a1;
LABEL_18:
    sub_219850628(v8, v6, 7u, 1u, (uint64_t)v7);
    return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveOpenPipeNotifyCmd");
  }
  if (a2)
  {
    v6 = (unsigned int *)(a1 + 956);
    v7 = "phHciNfc_ReceiveOpenPipeNotifyCmd:Failed Status Rxd from lower layer";
LABEL_17:
    v8 = 1;
    goto LABEL_18;
  }
  if (a3[1] != 3)
  {
    v6 = (unsigned int *)(a1 + 956);
    v7 = "phHciNfc_ReceiveOpenPipeNotifyCmd:Invalid Ins Rxd from lower layer";
    goto LABEL_17;
  }
  LODWORD(v15) = 0;
  BYTE4(v15) = *a3;
  sub_21988D688((unsigned int *)a1, (int *)&v15, (uint64_t)sub_21988DDD0);
  v9 = *(_QWORD *)(a1 + 152);
  if (v9)
  {
    if (*(_QWORD *)(v9 + 8))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
    }
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 152) = 0;
  }
  Memory = phOsalNfc_GetMemory();
  if (!Memory)
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ReceiveOpenPipeNotifyCmd: Failed to allocate mem for pSendParams");
LABEL_24:
    *(_QWORD *)(a1 + 152) = 0;
    return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveOpenPipeNotifyCmd");
  }
  v11 = Memory;
  phOsalNfc_SetMemory();
  *(_QWORD *)(a1 + 152) = v11;
  *(_BYTE *)v11 = *a3;
  *(_WORD *)(v11 + 1) = 512;
  v12 = (_BYTE *)phOsalNfc_GetMemory();
  *(_QWORD *)(v11 + 8) = v12;
  if (!v12)
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ReceiveOpenPipeNotifyCmd:Failed to send to lower layer");
    *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
LABEL_23:
    phOsalNfc_FreeMemory();
    goto LABEL_24;
  }
  *v12 = 0;
  *(_DWORD *)(v11 + 4) = 1;
  *(_BYTE *)(a1 + 953) = 0;
  if (sub_219889530(a1, (__int128 *)v11, (uint64_t)sub_21988C54C, a1) != 13)
  {
    sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ReceiveOpenPipeNotifyCmd:Failed to send to lower layer");
    phOsalNfc_FreeMemory();
    *(_QWORD *)(v11 + 8) = 0;
    goto LABEL_23;
  }
  v13 = *a3;
  if (v13 != *(unsigned __int8 *)(a1 + 816))
  {
    LODWORD(v15) = 1;
    BYTE4(v15) = v13;
    sub_21988CF78((unsigned int *)a1, (uint64_t)&v15, (uint64_t)sub_21988E49C, (unsigned int *)a1);
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveOpenPipeNotifyCmd");
}

uint64_t sub_21988E034(uint64_t a1, int a2, uint64_t a3)
{
  int v6;
  unsigned __int8 *v7;
  int v8;
  unsigned __int8 v9;
  int v10;
  int v11;
  const char *v12;
  const char *v13;
  int v14;
  unsigned int *v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t Memory;
  uint64_t v19;
  uint64_t v21;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyCmd");
  if (a1 && !a2 && a3)
  {
    v6 = *(unsigned __int8 *)(a3 + 1);
    if ((v6 - 20) < 2)
    {
      sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessClearAllPipeNotifyCmd");
      if (**(unsigned __int8 **)(a3 + 8) != 192)
        goto LABEL_26;
      v16 = *(_QWORD *)(a1 + 960);
      if (!v16)
        goto LABEL_26;
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_ProcessClearAllPipeNotifyCmd:eSE");
      if (*(_BYTE *)(v16 + 2944) != 1)
      {
        *(_DWORD *)(a1 + 816) = -1;
        *(_BYTE *)(a1 + 891) = 1;
      }
      if (**(_BYTE **)(a3 + 8) == 2)
      {
        sub_219850628(1, (unsigned int *)(v16 + 19368), 7u, 4u, (uint64_t)"phHciNfc_ProcessClearAllPipeNotifyCmd:UICC");
        if (*(_BYTE *)(v16 + 2944) != 1)
          *(_WORD *)(a1 + 832) = -1;
      }
      else
      {
LABEL_26:
        sub_219850628(2, (unsigned int *)a1, 7u, 4u, (uint64_t)"phHciNfc_ProcessClearAllPipeNotifyCmd:unkown NFCEE ID");
      }
      sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessClearAllPipeNotifyCmd");
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"Received ClearAllPipes Sending Any OK!!!");
      goto LABEL_28;
    }
    if (v6 == 19)
      goto LABEL_28;
    if (v6 == 18)
    {
      v21 = 0;
      sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessPipeCreateNotifyCmd");
      if (!*(_QWORD *)(a1 + 960) || (v7 = *(unsigned __int8 **)(a3 + 8)) == 0 || *(_WORD *)(a3 + 4) != 5)
      {
        sub_219850628(2, (unsigned int *)a1, 7u, 1u, (uint64_t)"phHciNfc_ProcessPipeCreateNotifyCmd:Failed Invalid Params Received");
        sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessPipeCreateNotifyCmd");
        return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyCmd");
      }
      v8 = v7[3];
      v9 = v7[4];
      v10 = *v7;
      BYTE4(v21) = v9;
      v11 = sub_21988CF78((unsigned int *)a1, (uint64_t)&v21, (uint64_t)sub_21988DDD0, (unsigned int *)a1);
      if (v11)
        sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 2u, (uint64_t)"ProcessPipeCreateNotifyCmd: Failed to register phHciNfc_ReceiveOpenPipeNotifyCmd");
      if (v10 == 2)
      {
        if (v8 != 65)
          goto LABEL_47;
        *(_BYTE *)(a1 + 832) = v9;
        *(_BYTE *)(a1 + 833) = 65;
        v12 = "phHciNfc_ProcessPipeCreateNotifyCmd:UICC Conn Pipe Info Updated";
      }
      else if (v10 == 192)
      {
        if (v8 == 65)
        {
          *(_BYTE *)(a1 + 818) = v9;
          *(_BYTE *)(a1 + 819) = 65;
          v12 = "phHciNfc_ProcessPipeCreateNotifyCmd:eSE Connectivity Pipe Info Updated";
        }
        else if (v8 == 240)
        {
          *(_BYTE *)(a1 + 816) = v9;
          *(_BYTE *)(a1 + 817) = -16;
          v12 = "phHciNfc_ProcessPipeCreateNotifyCmd:eSE APDU Pipe Info Updated";
        }
        else
        {
          v12 = "phHciNfc_ProcessPipeCreateNotifyCmd:eSE Unkown Source Gate ID";
        }
      }
      else
      {
        v12 = "phHciNfc_ProcessPipeCreateNotifyCmd:Unkown Source Host ID";
      }
      sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)v12);
LABEL_47:
      *(_BYTE *)(a1 + 893) = 1;
      sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessPipeCreateNotifyCmd");
      if (v11)
        return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyCmd");
LABEL_28:
      v17 = *(_QWORD *)(a1 + 152);
      if (v17)
      {
        if (*(_QWORD *)(v17 + 8))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(*(_QWORD *)(a1 + 152) + 8) = 0;
        }
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 152) = 0;
      }
      Memory = phOsalNfc_GetMemory();
      if (Memory)
      {
        v19 = Memory;
        phOsalNfc_SetMemory();
        *(_QWORD *)(a1 + 152) = v19;
        *(_WORD *)v19 = 1;
        *(_BYTE *)(v19 + 2) = 2;
        *(_QWORD *)(v19 + 8) = 0;
        *(_DWORD *)(v19 + 4) = 0;
        *(_BYTE *)(a1 + 953) = 0;
        if (sub_219889530(a1, (__int128 *)v19, (uint64_t)sub_21988C54C, a1) == 13)
        {
          sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"ReceiveAdminNotifyCmd: ANY_OK Sent to NCI");
          return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyCmd");
        }
        sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"ReceiveAdminNotifyCmd: Failed to send ANY_OK to NFCC");
        phOsalNfc_FreeMemory();
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"ReceiveAdminNotifyCmd: Failed to allocate mem for pSendParams");
      }
      *(_QWORD *)(a1 + 152) = 0;
      return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyCmd");
    }
    v15 = (unsigned int *)(a1 + 956);
    v13 = "phHciNfc_ReceiveAdminNotifyCmd:Unknown Instruction";
    v14 = 1;
  }
  else
  {
    v13 = "phHciNfc_ReceiveAdminNotifyCmd:Failed Invalid Params Received";
    v14 = 2;
    v15 = (unsigned int *)a1;
  }
  sub_219850628(v14, v15, 7u, 1u, (uint64_t)v13);
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ReceiveAdminNotifyCmd");
}

uint64_t sub_21988E49C(uint64_t a1, int a2, unsigned __int8 *a3)
{
  uint64_t v6;
  int v7;
  unsigned int v8;
  unsigned __int8 *v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  int v13;
  _BYTE *v14;
  int v15;
  uint64_t v16;
  int v17;
  unsigned int v18;
  int v19;
  uint64_t v20;
  const char *v22;
  unint64_t v23;
  __int128 v24;
  __int128 v25;
  uint64_t v26;

  v26 = 0;
  v24 = 0u;
  v25 = 0u;
  v23 = 0;
  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessEventsOnPipe");
  if (a1)
  {
    if (!a2)
    {
      if (a3)
      {
        v6 = *(_QWORD *)(a1 + 960);
        if (v6)
        {
          v7 = sub_21988E8F0(*(_DWORD *)(a1 + 956), *a3);
          LODWORD(v26) = v7;
          v8 = a3[1];
          if (v8 <= 0x12)
          {
            if (v8 == 16)
            {
              v17 = *((unsigned __int16 *)a3 + 2);
              if (*((_WORD *)a3 + 2) && *((_QWORD *)a3 + 1))
              {
                *(_QWORD *)&v25 = *((_QWORD *)a3 + 1);
              }
              else
              {
                v17 = 0;
                *(_QWORD *)&v25 = 0;
              }
              DWORD2(v25) = v17;
              DWORD2(v24) = 0;
              *(_QWORD *)&v24 = 0;
              v19 = *a3;
              v20 = a1;
              v12 = 0;
              v16 = 3;
              goto LABEL_39;
            }
            if (v8 == 18)
            {
              if (!*((_WORD *)a3 + 2) || (v9 = (unsigned __int8 *)*((_QWORD *)a3 + 1)) == 0 || *v9 != 129)
              {
                sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ProcessEventsOnPipe:Failed, error in packet");
                v18 = 0;
                LODWORD(v11) = 0;
                v12 = 255;
LABEL_26:
                if (v18 + (_DWORD)v11 != *((unsigned __int16 *)a3 + 2))
                {
                  DWORD2(v25) = 0;
                  DWORD2(v24) = 0;
                  sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ProcessEventsOnPipe:Failed,BER TLV parsing, Length Mismatch");
                  v12 = 255;
                }
                v19 = *a3;
                v20 = a1;
                v16 = 2;
                goto LABEL_39;
              }
              v10 = v9[1];
              DWORD2(v24) = v9[1];
              *(_QWORD *)&v24 = v9 + 2;
              v11 = v10 + 2;
              if ((v10 - 17) > 0xFFFFFFF3)
              {
                v12 = 0;
              }
              else
              {
                sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ProcessEventsOnPipe:Failed AID Length Evaluation");
                v9 = (unsigned __int8 *)*((_QWORD *)a3 + 1);
                v12 = 255;
              }
              if (v9[v11] != 130)
              {
                sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ProcessEventsOnPipe:Failed, PARAMETER Field is not available");
                v18 = 0;
                v12 = 255;
                goto LABEL_26;
              }
              LODWORD(v11) = v10 + 3;
              v18 = v9[v10 + 3];
              if (((char)v9[v10 + 3] & 0x80000000) == 0)
              {
                LODWORD(v11) = v10 + 4;
LABEL_45:
                DWORD2(v25) = v18;
LABEL_46:
                *(_QWORD *)&v25 = *((_QWORD *)a3 + 1) + v11;
                goto LABEL_26;
              }
              if (v18 == 130)
              {
                LODWORD(v11) = v10 + 6;
                v18 = v9[v10 + 5] | (v9[v10 + 4] << 8);
                if (v18 >= 0x100)
                  goto LABEL_45;
                v22 = "phHciNfc_ProcessEventsOnPipe:Failed Parsing BER TLV Two BYTE";
              }
              else
              {
                if (v18 != 129)
                {
                  sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ProcessEventsOnPipe:Failed Parsing BER TLV");
                  v18 = 0;
                  v12 = 255;
                  goto LABEL_46;
                }
                LODWORD(v11) = v10 + 4;
                if ((char)v9[v10 + 4] < 0)
                {
                  v18 = v9[v10 + 4];
                  LODWORD(v11) = v10 + 5;
                  goto LABEL_45;
                }
                v22 = "phHciNfc_ProcessEventsOnPipe:Failed Parsing BER TLV One BYTE";
              }
              sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)v22);
              v18 = 0;
              v12 = 255;
              goto LABEL_46;
            }
            goto LABEL_24;
          }
          if (v8 == 19)
          {
            *(_QWORD *)&v24 = 0;
            DWORD2(v24) = 0;
            *(_QWORD *)&v25 = 0;
            DWORD2(v25) = 0;
            sub_2198E0EB0(a1, (uint64_t)&v24, 0, *a3, 17);
            sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_ProcessEventsOnPipe: phLibNfc_eSE_EvtEndOfOperation, Ins");
          }
          else
          {
            if (v8 != 32)
            {
LABEL_24:
              sub_219851888(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)"phHciNfc_ProcessEventsOnPipe: Unknown HCI Event, Dropped Ins");
              return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessEventsOnPipe");
            }
            v13 = *((unsigned __int16 *)a3 + 2);
            if (*((_WORD *)a3 + 2) && (v14 = (_BYTE *)*((_QWORD *)a3 + 1)) != 0)
            {
              v15 = v7;
              if (*v14 == 1)
              {
                v16 = 23;
              }
              else if (*v14)
              {
                sub_219850628(1, (unsigned int *)(a1 + 956), 7u, 1u, (uint64_t)" SE restricted mode Unknown Event\n");
                v14 = (_BYTE *)*((_QWORD *)a3 + 1);
                v13 = *((unsigned __int16 *)a3 + 2);
                v16 = 255;
              }
              else
              {
                v15 = 255;
                LODWORD(v26) = 255;
                v16 = 4;
              }
              *(_QWORD *)&v25 = v14;
              DWORD2(v25) = v13;
              DWORD2(v24) = 0;
              *(_QWORD *)&v24 = 0;
            }
            else
            {
              v15 = 255;
              *(_QWORD *)&v24 = 0;
              DWORD2(v24) = 0;
              *(_QWORD *)&v25 = 0;
              v16 = 4;
              LODWORD(v26) = 255;
              DWORD2(v25) = 0;
            }
            if (!*(_QWORD *)(v6 + 6056))
            {
              v19 = *a3;
              v20 = a1;
              v12 = 0;
LABEL_39:
              sub_2198E0EB0(v20, (uint64_t)&v24, v12, v19, v16);
              return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessEventsOnPipe");
            }
            if (*(_QWORD *)(v6 + 6568))
            {
              v23 = __PAIR64__(v15, v16);
              sub_219853E34(1, (unsigned int *)(a1 + 956), 7u, 4u, (uint64_t)"phHciNfc_ProcessEventsOnPipe :pGenericNtfCb[RestrictedMode]");
              (*(void (**)(_QWORD, _QWORD, uint64_t, unint64_t *))(v6 + 6568))(*(_QWORD *)(v6 + 19360), *(_QWORD *)(v6 + 6576), 216, &v23);
            }
          }
        }
      }
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_ProcessEventsOnPipe");
}

uint64_t sub_21988E8F0(unsigned int a1, unsigned int a2)
{
  uint64_t v3;
  unsigned int v4;
  unsigned int v6;

  v6 = a1;
  sub_219850718(1, &v6, 7u, 5u, (uint64_t)"phHciNfc_GetEseOsType");
  if (a2 > 0x2D)
    goto LABEL_6;
  if (((1 << a2) & 0x88000000000) != 0)
  {
    v3 = 1;
    goto LABEL_14;
  }
  if (((1 << a2) & 0x110000000000) != 0)
  {
    v3 = 2;
    goto LABEL_14;
  }
  if (((1 << a2) & 0x220000000000) != 0)
  {
    v3 = 3;
  }
  else
  {
LABEL_6:
    if (a2 == 25)
      v4 = 0;
    else
      v4 = 255;
    if (a2 == 22)
      v3 = 0;
    else
      v3 = v4;
  }
LABEL_14:
  sub_219850808(1, &v6, 7u, 5u, (uint64_t)"phHciNfc_GetEseOsType");
  return v3;
}

uint64_t sub_21988E9C8(uint64_t a1, int a2, char *a3)
{
  uint64_t v6;
  uint64_t v7;
  char v8;

  sub_219850718(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_MultiOSGetPipeId");
  if (a1 && a3 && (v6 = *(_QWORD *)(a1 + 960)) != 0)
  {
    if (*(_BYTE *)(v6 + 2944) == 1)
    {
      switch(a2)
      {
        case 0:
          v7 = 0;
          v8 = *(_BYTE *)(a1 + 816);
          break;
        case 1:
          v7 = 0;
          v8 = *(_BYTE *)(a1 + 820);
          break;
        case 2:
          v7 = 0;
          v8 = *(_BYTE *)(a1 + 824);
          break;
        case 3:
          v7 = 0;
          v8 = *(_BYTE *)(a1 + 828);
          break;
        default:
          v7 = 0;
          v8 = -1;
          break;
      }
      *a3 = v8;
    }
    else
    {
      v7 = 147;
    }
  }
  else
  {
    v7 = 1;
    sub_219850628(2, (unsigned int *)a1, 7u, 1u, (uint64_t)"phHciNfc_MultiOSGetPipeId:Invalid Context or PipeId");
  }
  sub_219850808(2, (unsigned int *)a1, 7u, 5u, (uint64_t)"phHciNfc_MultiOSGetPipeId");
  return v7;
}

uint64_t sub_21988EAD8(uint64_t a1, unsigned int a2, int a3)
{
  unsigned int v5;
  uint64_t v6;
  char *v7;
  unsigned int v9;

  v9 = a2;
  sub_219850718(1, &v9, 5u, 5u, (uint64_t)"phUtilNfc_SetDriverHandle");
  v5 = v9;
  if (v9 > 1)
  {
    v6 = 255;
  }
  else
  {
    v6 = 0;
    v7 = (char *)&unk_253E46700 + 112 * v9;
    *(_QWORD *)v7 = a1;
    *((_DWORD *)v7 + 2) = v5;
    *((_DWORD *)v7 + 3) = a3;
    *((_QWORD *)v7 + 2) = 0;
    *((_QWORD *)v7 + 4) = 0;
  }
  sub_219850808(1, &v9, 5u, 5u, (uint64_t)"phUtilNfc_SetDriverHandle");
  return v6;
}

uint64_t sub_21988EB80(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  unsigned int v7;
  uint64_t v9;

  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 5u, 5u, (uint64_t)"phUtilNfc_RetrieveIoctlCtx");
  if (a2)
  {
    v3 = 0;
    *a2 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (*((_QWORD *)&unk_253E46700 + 14 * v3) == v9)
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v7 = *((_DWORD *)&unk_253E46700 + 28 * v3 + 2);
    v6 = 0;
    if (v7 <= 1)
      *a2 = *((_QWORD *)&unk_253E46700 + 14 * v7 + 11);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850718(0, (unsigned int *)&v9, 5u, 5u, (uint64_t)"phUtilNfc_RetrieveIoctlCtx");
  return v6;
}

uint64_t sub_21988EC5C(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  unsigned int v7;
  uint64_t v9;

  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 5u, 5u, (uint64_t)"phUtilNfc_RetrieveDnldCoreCtx");
  if (a2)
  {
    v3 = 0;
    *a2 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (*((_QWORD *)&unk_253E46700 + 14 * v3) == v9)
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v7 = *((_DWORD *)&unk_253E46700 + 28 * v3 + 2);
    v6 = 0;
    if (v7 <= 1)
      *a2 = *((_QWORD *)&unk_253E46700 + 14 * v7 + 12);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v9, 5u, 5u, (uint64_t)"phUtilNfc_RetrieveDnldCoreCtx");
  return v6;
}

uint64_t sub_21988ED38(uint64_t a1, _DWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetNfccLinkType");
  if (a2)
  {
    v3 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v6 = 0;
    *a2 = *((_DWORD *)&unk_253E46700 + 28 * v3 + 3);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetNfccLinkType");
  return v6;
}

uint64_t sub_21988EDF4(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetLibNfcContext");
  if (a2)
  {
    v3 = 0;
    *a2 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v6 = 0;
    *a2 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 2);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetLibNfcContext");
  return v6;
}

uint64_t sub_21988EEB4(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetLibNfcContext");
  v3 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
    {
      v6 = 255;
      goto LABEL_6;
    }
  }
  v6 = 0;
  *((_QWORD *)&unk_253E46700 + 14 * v3 + 2) = a2;
LABEL_6:
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetLibNfcContext");
  return v6;
}

uint64_t sub_21988EF68(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetNdefNfcContext");
  if (a2)
  {
    v3 = 0;
    *a2 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v6 = 0;
    *a2 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 3);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetNdefNfcContext");
  return v6;
}

uint64_t sub_21988F028(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetNdefNfcContext");
  v3 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
    {
      v6 = 255;
      goto LABEL_6;
    }
  }
  v6 = 0;
  *((_QWORD *)&unk_253E46700 + 14 * v3 + 3) = a2;
LABEL_6:
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetNdefNfcContext");
  return v6;
}

uint64_t sub_21988F0DC(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetNciNfcContext");
  if (a2)
  {
    v3 = 0;
    *a2 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v6 = 0;
    *a2 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetNciNfcContext");
  return v6;
}

uint64_t sub_21988F19C(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetNciNfcCoreContext");
  if (a2)
  {
    v3 = 0;
    *a2 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v6 = 0;
    *a2 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetNciNfcCoreContext");
  return v6;
}

uint64_t sub_21988F25C(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetNciNfcContext");
  v3 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
    {
      v6 = 255;
      goto LABEL_6;
    }
  }
  v6 = 0;
  *((_QWORD *)&unk_253E46700 + 14 * v3 + 4) = a2;
LABEL_6:
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetNciNfcContext");
  return v6;
}

uint64_t sub_21988F310(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetNciNfcCoreContext");
  v3 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
    {
      v6 = 255;
      goto LABEL_6;
    }
  }
  v6 = 0;
  *((_QWORD *)&unk_253E46700 + 14 * v3 + 5) = a2;
LABEL_6:
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetNciNfcCoreContext");
  return v6;
}

uint64_t sub_21988F3C4(uint64_t a1)
{
  char v1;
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v6;

  v6 = a1;
  sub_219850718(0, (unsigned int *)&v6, 5u, 5u, (uint64_t)"phUtilNfc_ValidateDriverHandle");
  v1 = 0;
  v2 = 0;
  v3 = v6;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v2);
    if ((v1 & 1) != 0)
      break;
    v1 = 1;
    v2 = 1;
  }
  while (v6 != v4);
  sub_219850808(0, (unsigned int *)&v6, 5u, 5u, (uint64_t)"phUtilNfc_ValidateDriverHandle");
  if (v3 == v4)
    return 0;
  else
    return 255;
}

uint64_t sub_21988F460(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetDnldNfcContext");
  if (a2)
  {
    v3 = 0;
    *a2 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v6 = 0;
    *a2 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 6);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetDnldNfcContext");
  return v6;
}

uint64_t sub_21988F520(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetDnldNfcContext");
  v3 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
    {
      v6 = 255;
      goto LABEL_6;
    }
  }
  v6 = 0;
  *((_QWORD *)&unk_253E46700 + 14 * v3 + 6) = a2;
LABEL_6:
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetDnldNfcContext");
  return v6;
}

uint64_t sub_21988F5D4(uint64_t a1, _BYTE *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetIgnoreWkUpRet");
  if (a2)
  {
    v3 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v6 = 0;
    *a2 = *((_BYTE *)&unk_253E46700 + 112 * v3 + 57);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetIgnoreWkUpRet");
  return v6;
}

uint64_t sub_21988F690(uint64_t a1, char a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetIgnoreWkUpRet");
  v3 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
    {
      v6 = 255;
      goto LABEL_6;
    }
  }
  v6 = 0;
  *((_BYTE *)&unk_253E46700 + 112 * v3 + 57) = a2;
LABEL_6:
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetIgnoreWkUpRet");
  return v6;
}

uint64_t sub_21988F744(uint64_t a1, _QWORD *a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetDnldNfcEseCoreContext");
  if (a2)
  {
    v3 = 0;
    *a2 = 0;
    v4 = 1;
    while (1)
    {
      v5 = v4;
      if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
        break;
      v4 = 0;
      v3 = 1;
      if ((v5 & 1) == 0)
        goto LABEL_5;
    }
    v6 = 0;
    *a2 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 8);
  }
  else
  {
LABEL_5:
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_GetDnldNfcEseCoreContext");
  return v6;
}

uint64_t sub_21988F804(uint64_t a1, char a2)
{
  uint64_t v3;
  char v4;
  char v5;
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetMuxState");
  v3 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (v8 == *((_QWORD *)&unk_253E46700 + 14 * v3))
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
    {
      v6 = 255;
      goto LABEL_6;
    }
  }
  v6 = 0;
  *((_BYTE *)&unk_253E46700 + 112 * v3 + 72) = a2;
LABEL_6:
  sub_219850808(0, (unsigned int *)&v8, 5u, 5u, (uint64_t)"phUtilNfc_SetMuxState");
  return v6;
}

uint64_t sub_21988F8B8(uint64_t a1)
{
  uint64_t v1;
  char v2;
  char v3;
  uint64_t v4;
  uint64_t v6;

  v6 = a1;
  sub_219850718(0, (unsigned int *)&v6, 5u, 5u, (uint64_t)"phUtilNfc_GetMuxState");
  v1 = 0;
  v2 = 1;
  while (1)
  {
    v3 = v2;
    if (v6 == *((_QWORD *)&unk_253E46700 + 14 * v1))
      break;
    v2 = 0;
    v1 = 1;
    if ((v3 & 1) == 0)
    {
      v4 = 255;
      goto LABEL_6;
    }
  }
  v4 = *((unsigned __int8 *)&unk_253E46700 + 112 * v1 + 72);
LABEL_6:
  sub_219850808(0, (unsigned int *)&v6, 5u, 5u, (uint64_t)"phUtilNfc_GetMuxState");
  return v4;
}

uint64_t sub_21988F964(unsigned int a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int v5;

  v5 = a1;
  sub_219850718(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_SetIoctlContext");
  if (v5 > 1)
  {
    v3 = 255;
  }
  else
  {
    v3 = 0;
    *((_QWORD *)&unk_253E46700 + 14 * v5 + 11) = a2;
  }
  sub_219850808(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_SetIoctlContext");
  return v3;
}

uint64_t sub_21988F9F4(unsigned int a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int v5;

  v5 = a1;
  sub_219850718(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_SetdnldCoreContext");
  if (v5 > 1)
  {
    v3 = 255;
  }
  else
  {
    v3 = 0;
    *((_QWORD *)&unk_253E46700 + 14 * v5 + 12) = a2;
  }
  sub_219850808(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_SetdnldCoreContext");
  return v3;
}

uint64_t sub_21988FA84(unsigned int a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int v5;

  v5 = a1;
  sub_219850718(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_SetdnldEseCoreContext");
  if (v5 > 1)
  {
    v3 = 255;
  }
  else
  {
    v3 = 0;
    *((_QWORD *)&unk_253E46700 + 14 * v5 + 8) = a2;
  }
  sub_219850808(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_SetdnldEseCoreContext");
  return v3;
}

uint64_t sub_21988FB14(unsigned int a1, _QWORD *a2)
{
  uint64_t v3;
  unsigned int v5;

  v5 = a1;
  sub_219850718(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_GetdnldEseCoreContext");
  if (a2 && (*a2 = 0, v5 <= 1))
  {
    v3 = 0;
    *a2 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 8);
  }
  else
  {
    v3 = 255;
  }
  sub_219850808(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_GetdnldEseCoreContext");
  return v3;
}

uint64_t sub_21988FBB0(unsigned int a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int v5;

  v5 = a1;
  sub_219850718(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_SetHciNfcContext");
  if (v5 > 1)
  {
    v3 = 255;
  }
  else
  {
    v3 = 0;
    *((_QWORD *)&unk_253E46700 + 14 * v5 + 13) = a2;
  }
  sub_219850808(1, &v5, 5u, 5u, (uint64_t)"phUtilNfc_SetHciNfcContext");
  return v3;
}

uint64_t sub_21988FC40(uint64_t a1, uint64_t a2, _BYTE *a3, int a4)
{
  uint64_t v8;
  uint64_t (**v9)(uint64_t);

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RdrIso15693Init");
  if (a1 && a2 && a3 && a4)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Updating NFC-I (ISO15693) passive poll Mode Techn Specific info");
    *(_DWORD *)(a2 + 4) = 20;
    *(_DWORD *)(a2 + 48) = 7;
    if (a3[6] == 10)
    {
      *(_BYTE *)(a2 + 46) = a3[7];
      *(_BYTE *)(a2 + 45) = a3[8];
      *(_BYTE *)(a2 + 44) = 8;
      phOsalNfc_MemCopy();
      sub_21988FDB0(*(_QWORD *)(a1 + 6480), a2 + 36, a2 + 36);
      v8 = 0;
      *(_BYTE *)(a2 + 47) = 0;
      v9 = *(uint64_t (***)(uint64_t))(a1 + 4760);
      *v9 = sub_21988FEA0;
      v9[1] = (uint64_t (*)(uint64_t))sub_2198900EC;
      v9[2] = 0;
      v9[3] = (uint64_t (*)(uint64_t))sub_2198F14B0;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid Activation parameters length received for ISO15693 Tag");
      v8 = 255;
    }
  }
  else
  {
    v8 = 1;
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"Invalid input parameters!");
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RdrIso15693Init");
  return v8;
}

uint64_t sub_21988FDB0(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v5;
  unsigned int v6;
  unsigned int v7;
  uint64_t v9;

  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 3u, 5u, (uint64_t)"phNciNfc_GetTagTypeInfo");
  if (a2 && a3)
  {
    v5 = *(unsigned __int8 *)(a2 + 6);
    if (v5 != 7)
    {
      if (v5 == 4)
      {
        v6 = *(unsigned __int8 *)(a2 + 5) - 1;
        if (v6 >= 3)
          LOBYTE(v6) = 7;
        v6 = v6;
        goto LABEL_16;
      }
LABEL_15:
      v6 = 7;
      goto LABEL_16;
    }
    v7 = *(_BYTE *)(a2 + 5) & 0xFE;
    if (v7 > 0xBF)
    {
      if (v7 == 192)
      {
        v6 = 5;
        goto LABEL_16;
      }
      if (v7 != 196)
        goto LABEL_15;
      v6 = 6;
    }
    else
    {
      if ((*(_BYTE *)(a2 + 5) & 0xFE) == 0)
      {
        v6 = 3;
        goto LABEL_16;
      }
      if (v7 != 128)
        goto LABEL_15;
      v6 = 4;
    }
LABEL_16:
    *(_DWORD *)(a3 + 12) = v6;
  }
  return sub_219850808(0, (unsigned int *)&v9, 3u, 5u, (uint64_t)"phNciNfc_GetTagTypeInfo");
}

uint64_t sub_21988FEA0(uint64_t a1)
{
  _BYTE *v2;
  const char *v3;
  unsigned int *v4;
  uint64_t v5;
  int v7;
  uint64_t Memory;
  __int128 v9;
  __int128 v10;

  v9 = 0u;
  v10 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Iso15693Send");
  if (a1)
  {
    if (*(_DWORD *)(a1 + 4544))
    {
      v2 = (_BYTE *)(a1 + 4736);
      *(_BYTE *)(a1 + 4736) = 0;
      if (!*(_QWORD *)(a1 + 4536))
      {
        v4 = (unsigned int *)(a1 + 6476);
        v3 = "Send Data Buff not valid!";
        goto LABEL_9;
      }
      phOsalNfc_SetMemory();
      LODWORD(v9) = 0;
      if (sub_219878C88((unsigned int *)a1, *(_QWORD *)(a1 + 4512), (_BYTE *)((unint64_t)&v9 | 0xC)))
      {
        v3 = " Couldn't Get ConnId!";
        v4 = (unsigned int *)(a1 + 6476);
LABEL_9:
        sub_219850628(1, v4, 3u, 1u, (uint64_t)v3);
        v5 = 255;
        goto LABEL_10;
      }
      v7 = *(_DWORD *)(a1 + 4544);
      *(_QWORD *)(a1 + 4600) = 0;
      Memory = phOsalNfc_GetMemory();
      *(_QWORD *)(a1 + 4600) = Memory;
      *(_DWORD *)(a1 + 4608) = 0;
      if (Memory)
      {
        *(_DWORD *)(a1 + 4608) = v7;
        phOsalNfc_SetMemory();
        phOsalNfc_MemCopy();
        *(_QWORD *)&v10 = *(_QWORD *)(a1 + 4600);
        DWORD2(v10) = *(_DWORD *)(a1 + 4608);
        if (*(_DWORD *)(a1 + 4520) == 1)
        {
          *v2 = 1;
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"EOF need to be sent after sending the data packet");
        }
        if (sub_2198F2D0C(a1 + 888, (uint64_t)&v9, a1 + 3760, *(unsigned __int16 *)(a1 + 4526), (uint64_t)sub_2198F135C, a1) == 13)
        {
          v5 = 13;
        }
        else
        {
          *v2 = 0;
          phOsalNfc_FreeMemory();
          *(_QWORD *)(a1 + 4600) = 0;
          *(_DWORD *)(a1 + 4608) = 0;
          v5 = 255;
        }
        *(_WORD *)(a1 + 4526) = 0;
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Payload MemAlloc for Send request Failed!");
        v5 = 12;
      }
    }
    else
    {
      v5 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Length..");
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Invalid input parameter (Nci Context)!");
  }
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Iso15693Send");
  return v5;
}

uint64_t sub_2198900EC(uint64_t a1, int a2)
{
  unsigned int v4;
  uint64_t v5;
  unsigned int v6;
  unsigned int v7;
  unsigned int v8;
  unsigned int *v9;
  const char *v10;
  unsigned __int16 v12;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Iso15693Receive");
  if (!a1)
  {
    v12 = 1;
    sub_219850628(2, 0, 3u, 2u, (uint64_t)" Invalid Context Param..");
    goto LABEL_28;
  }
  if (a2 || (v4 = *(_DWORD *)(a1 + 3768)) == 0 || (v5 = *(_QWORD *)(a1 + 3760)) == 0)
  {
    *(_BYTE *)(a1 + 4736) = 0;
    v12 = 255;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)"ISO15693 XchgData receive Failed...");
    goto LABEL_26;
  }
  v6 = *(_DWORD *)(a1 + 4560);
  *(_BYTE *)(a1 + 4736) = 0;
  v7 = v4 - 1;
  v8 = *(unsigned __int8 *)(v5 + v4 - 1);
  if (v8 <= 0xAF)
  {
    if (*(_BYTE *)(v5 + v4 - 1))
    {
      if (v8 != 2)
      {
LABEL_18:
        v12 = 185;
        sub_219886108(*(_QWORD *)(a1 + 6480), v8);
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)" ISO15693 XchgData,Unknown RF related error Detected by NFCC during Data Exchange ");
        if (v4 <= v6)
        {
          phOsalNfc_MemCopy();
          *(_DWORD *)(a1 + 4560) = v4;
        }
        goto LABEL_25;
      }
      v12 = 181;
      v9 = (unsigned int *)(a1 + 6476);
      v10 = " ISO15693 XchgData,PH_NCINFC_STATUS_RF_FRAME_CORRUPTED Detected by NFCC during Data Exchange ";
    }
    else
    {
      v12 = 0;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"ISO15693 XchgData Request is Successful!");
      if (v7 <= v6)
      {
        phOsalNfc_MemCopy();
        *(_DWORD *)(a1 + 4560) = v7;
        goto LABEL_25;
      }
      v12 = 8;
      v10 = "ISO15693 XchgData,More Data available than requested...";
      v9 = (unsigned int *)(a1 + 6476);
    }
  }
  else
  {
    switch(*(_BYTE *)(v5 + v4 - 1))
    {
      case 0xB0:
        v12 = 182;
        v9 = (unsigned int *)(a1 + 6476);
        v10 = " ISO15693 XchgData,PH_NCINFC_STATUS_RF_TRANSMISSION_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB1:
        v12 = 183;
        v9 = (unsigned int *)(a1 + 6476);
        v10 = " ISO15693 XchgData,PH_NCINFC_STATUS_RF_PROTOCOL_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB2:
        v12 = 178;
        v9 = (unsigned int *)(a1 + 6476);
        v10 = " ISO15693 XchgData,PH_NCINFC_STATUS_RF_TIMEOUT_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB3:
        v12 = 184;
        v9 = (unsigned int *)(a1 + 6476);
        v10 = " ISO15693 XchgData,PH_NCINFC_STATUS_RF_UNEXPECTED_DAT Detected by NFCC during Data Exchange ";
        break;
      default:
        if (v8 == 190)
        {
          v12 = 187;
          v9 = (unsigned int *)(a1 + 6476);
          v10 = " ISO15693 XchgData,PH_NCINFC_STATUS_HRM_SE_INIT_REQUIRED Detected by NFCC during Data Exchange ";
        }
        else
        {
          if (v8 != 191)
            goto LABEL_18;
          v12 = 186;
          v9 = (unsigned int *)(a1 + 6476);
          v10 = " ISO15693 XchgData,PH_NCINFC_STATUS_HRM_TIMER_RUNNING Detected by NFCC during Data Exchange ";
        }
        break;
    }
  }
  sub_219850628(1, v9, 3u, 2u, (uint64_t)v10);
LABEL_25:
  sub_2198F1654(a1, &v12);
LABEL_26:
  if (*(_QWORD *)(a1 + 4600))
  {
    *(_DWORD *)(a1 + 4608) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Freeing Send Request Payload Buffer..");
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 4600) = 0;
  }
LABEL_28:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Iso15693Receive");
  return v12;
}

uint64_t sub_2198903FC(uint64_t a1, uint64_t a2)
{
  const char *v3;
  int v4;
  unsigned int *v5;
  __int128 v7;
  __int128 v8;

  v7 = 0u;
  v8 = 0u;
  sub_21988629C(2, (unsigned int *)a2, a1, 3u, 4u, (uint64_t)"phNciNfc_SendEofDataPacket");
  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SendEofDataPacket");
  if (!a2)
  {
    v3 = "phNciNfc_SendEofDataPacket: Nci context null";
    v4 = 2;
    v5 = 0;
LABEL_9:
    sub_219850628(v4, v5, 3u, 1u, (uint64_t)v3);
    return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SendEofDataPacket");
  }
  if (*(_BYTE *)(a2 + 4736) == 1)
  {
    *(_BYTE *)(a2 + 4736) = 0;
    sub_21988C4AC(*(_DWORD *)(a2 + 6476), *(_QWORD *)(a2 + 4656));
    *(_BYTE *)(a2 + 6464) = 0;
    phOsalNfc_SetMemory();
    LODWORD(v7) = 0;
    if (sub_219878C88((unsigned int *)a2, *(_QWORD *)(a2 + 4512), (_BYTE *)((unint64_t)&v7 | 0xC)))
    {
      v3 = "phNciNfc_SendEofDataPacket: Couldn't Get ConnId!";
LABEL_8:
      v4 = 1;
      v5 = (unsigned int *)(a2 + 6476);
      goto LABEL_9;
    }
    *(_QWORD *)&v8 = 0;
    DWORD2(v8) = 0;
    *(_BYTE *)(a2 + 3322) = 1;
    if (sub_2198F2E28(a2 + 888, &v7, (uint64_t)sub_219890560, a2) != 13)
    {
      v3 = "phNciNfc_SendEofDataPacket: Failed to send EOF data packet";
      goto LABEL_8;
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_SendEofDataPacket");
}

uint64_t sub_219890560(unsigned int *a1, uint64_t a2, uint64_t a3)
{
  unsigned int *v5;
  const char *v6;
  int v7;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_EofSendCb");
  if (!a1)
  {
    v6 = "Invalid context received from RecvMgrHdlr!";
    v7 = 2;
    v5 = 0;
    goto LABEL_5;
  }
  if ((_DWORD)a3)
  {
    v5 = a1 + 1619;
    v6 = "Failed to send EOF data packet";
    v7 = 1;
LABEL_5:
    sub_219850628(v7, v5, 3u, 1u, (uint64_t)v6);
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_EofSendCb");
  return a3;
}

uint64_t sub_2198905F8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v5;
  unsigned int v6;
  uint64_t v7;
  const char *v8;
  uint64_t v9;
  char v10;
  int v12;
  char v13;
  char v14;
  char v15;
  char v16;
  char v17;
  unsigned int v18;
  _OWORD v19[9];
  __int128 v20;
  __int128 v21;
  __int128 v22;
  __int128 v23;
  _OWORD v24[10];
  __int128 v25;
  __int128 v26;
  __int128 v27;
  __int128 v28;
  __int128 v29;
  __int128 v30;
  __int128 v31;
  __int128 v32;
  __int128 v33;
  uint64_t v34;

  v34 = *MEMORY[0x24BDAC8D0];
  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  v25 = 0u;
  v23 = 0u;
  memset(v24, 0, sizeof(v24));
  v21 = 0u;
  v22 = 0u;
  v20 = 0u;
  memset(v19, 0, sizeof(v19));
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetHostCECfgs");
  if (!a1)
  {
    v7 = 255;
    goto LABEL_28;
  }
  phOsalNfc_SetMemory();
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateCE_ConfigParams");
  if (!a3)
  {
    sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateCE_ConfigParams");
LABEL_13:
    v7 = 1;
    v8 = "phLibNfc_SetHostCECfgs: CE Host configuration failed";
LABEL_27:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v8);
    goto LABEL_28;
  }
  v5 = *(_DWORD *)(a3 + 4);
  if (v5 == 4)
  {
    v9 = 0;
    DWORD1(v19[0]) |= 0x80u;
    DWORD1(v23) = 29;
    *(_WORD *)((char *)&v25 + 1) = -258;
    BYTE8(v23) |= 3u;
    WORD5(v25) = 15;
    *(_DWORD *)((char *)&v25 + 3) = *(_DWORD *)(a3 + 22);
    *(_WORD *)((char *)&v25 + 7) = *(_WORD *)(a3 + 26);
    do
    {
      if (*(_BYTE *)(a3 + 28) && *(_BYTE *)(a3 + 29))
        phOsalNfc_MemCopy();
      else
        *(_WORD *)((char *)v24 + v9 + 1) = -1;
      phOsalNfc_MemCopy();
      v9 += 10;
    }
    while (v9 != 160);
    goto LABEL_24;
  }
  if (v5 == 2)
  {
    DWORD1(v19[0]) |= 0x40u;
    v10 = BYTE12(v21);
    if ((*(_BYTE *)(a3 + 17) & 1) != 0)
    {
      v10 = BYTE12(v21) | 1;
      LOBYTE(v22) = v22 | 1;
    }
    BYTE12(v21) = v10 | 2;
    phOsalNfc_MemCopy();
    BYTE12(v21) |= 4u;
    phOsalNfc_MemCopy();
    LOBYTE(v23) = v23 & 0xF8 | (2 * (*(_BYTE *)(a3 + 19) & 3)) | *(_BYTE *)(a3 + 20) & 1;
    DWORD1(v19[0]) |= 0x100u;
    BYTE3(v32) = *(_BYTE *)(a3 + 22);
    BYTE12(v25) |= 9u;
    LOBYTE(v26) = *(_BYTE *)(a3 + 18);
    BYTE12(v21) |= 0x18u;
    BYTE12(v22) = *(_BYTE *)(a3 + 21);
    goto LABEL_24;
  }
  if (v5 != 1 || *(_BYTE *)(a3 + 8) != 1)
  {
LABEL_24:
    sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateCE_ConfigParams");
    goto LABEL_25;
  }
  v6 = *(unsigned __int8 *)(a3 + 19);
  if (v6 > 6)
  {
    if (v6 != 10 && v6 != 7)
      goto LABEL_32;
    goto LABEL_31;
  }
  if (*(_BYTE *)(a3 + 19))
  {
    if (v6 != 4)
    {
LABEL_32:
      v12 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Invalid UID Length received!");
      goto LABEL_34;
    }
LABEL_31:
    BYTE4(v20) |= 8u;
    BYTE10(v21) = v6;
    phOsalNfc_MemCopy();
    v12 = 0;
    goto LABEL_34;
  }
  v12 = 0;
  BYTE4(v20) |= 8u;
  BYTE10(v21) = 0;
LABEL_34:
  v13 = BYTE4(v20);
  v14 = *(_BYTE *)(a3 + 70) & 0x1F;
  BYTE8(v20) = v14;
  if ((BYTE4(v20) & 8) == 0)
    goto LABEL_40;
  if (BYTE10(v21) == 7)
  {
    v15 = 64;
  }
  else
  {
    if (BYTE10(v21) != 10)
      goto LABEL_40;
    v15 = 0x80;
  }
  BYTE8(v20) = v15 | v14;
LABEL_40:
  v16 = BYTE4(v20) | 3;
  BYTE4(v20) |= 3u;
  BYTE9(v20) = *(_BYTE *)(a3 + 71);
  v17 = *(_BYTE *)(a3 + 69);
  if ((v17 & 0x40) != 0)
  {
    v16 = v13 | 7;
    BYTE4(v20) = v13 | 7;
    BYTE12(v20) |= 2u;
  }
  if ((v17 & 0x20) != 0)
  {
    BYTE4(v20) = v16 | 4;
    BYTE12(v20) |= 1u;
  }
  DWORD1(v19[0]) |= 0x120u;
  v18 = *(unsigned __int8 *)(a3 + 68);
  if (*(_BYTE *)(a3 + 68))
  {
    if (v18 > 0x30)
    {
      v12 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Received App data Length exceeded max historic bytes length");
    }
    else
    {
      BYTE12(v25) |= 2u;
      BYTE1(v29) = v18;
      phOsalNfc_MemCopy();
    }
  }
  LOBYTE(v26) = *(_BYTE *)(a3 + 73);
  BYTE12(v25) |= 9u;
  BYTE3(v32) = *(_BYTE *)(a3 + 72);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateCE_ConfigParams");
  if (v12)
    goto LABEL_13;
LABEL_25:
  LODWORD(v19[0]) = *(_DWORD *)(a1 + 19368);
  v7 = sub_2198FD4A4(*(_QWORD *)(a1 + 3040), (uint64_t)v19, (uint64_t)sub_219865DD0, a1);
  if ((_DWORD)v7 != 13)
  {
    v8 = "phLibNfc_SetHostCECfgs: Invalid status -CE Host configuration failed to send";
    goto LABEL_27;
  }
LABEL_28:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetHostCECfgs");
  return v7;
}

uint64_t sub_219890B24(uint64_t a1, uint64_t a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetHostCEConfigComplete");
  if (a1)
  {
    if ((_DWORD)a2)
      v4 = 146;
    else
      v4 = 145;
    *(_BYTE *)(a1 + 484) = (_DWORD)a2 == 0;
    a2 = sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v4, a2, 0, 0);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetHostCEConfigComplete");
  return a2;
}

uint64_t sub_219890BB0(uint64_t a1, int a2, uint64_t a3)
{
  uint64_t v6;
  int v7;
  uint64_t Memory;
  __int16 v10;
  __int16 *v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  v10 = 111;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CardEmulation_DataReceiveCb");
  sub_219850628(2, (unsigned int *)a1, 4u, 4u, (uint64_t)"phLibNfc_CardEmulation_DataReceiveCb");
  if (!a1 || !a3)
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CardEmulation_DataReceiveCb");
  v6 = *(_QWORD *)(a1 + 6712);
  if (*(_QWORD *)(a1 + 488))
  {
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 488) = 0;
  }
  *(_DWORD *)(a1 + 496) = 0;
  *(_BYTE *)(a1 + 485) = 1;
  if (a2 == 10)
  {
LABEL_16:
    sub_219890D4C(a1);
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CardEmulation_DataReceiveCb");
  }
  if (a2)
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CardEmulation_DataReceiveCb");
  if (!*(_DWORD *)(a3 + 16) || !*(_QWORD *)(a3 + 8))
    goto LABEL_11;
  v7 = (unsigned __int16)*(_DWORD *)(a3 + 16);
  Memory = phOsalNfc_GetMemory();
  if (Memory)
  {
    *(_QWORD *)(a1 + 488) = Memory;
    *(_DWORD *)(a1 + 496) = v7;
    phOsalNfc_MemCopy();
LABEL_11:
    if (v6)
      goto LABEL_12;
    goto LABEL_15;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Data Allocation failed");
  if (!v6)
  {
LABEL_15:
    v11 = &v10;
    LODWORD(v12) = 2;
    sub_2198619C0(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1, (uint64_t)&v11);
    goto LABEL_16;
  }
LABEL_12:
  if (*(_BYTE *)(a1 + 486))
  {
    *(_BYTE *)(a1 + 486) = 0;
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), 148, 0, a1 + 824, a1 + 714);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CardEmulation_DataReceiveCb");
}

uint64_t sub_219890D4C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RegisterForHceActivation");
  if (a1)
    v2 = sub_219861598(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219890BB0, a1);
  else
    v2 = 1;
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RegisterForHceActivation");
  return v2;
}

uint64_t sub_219890DC8(unsigned int *a1, _BYTE *a2, unsigned __int8 *a3)
{
  uint64_t v6;
  unsigned __int8 v7;
  unsigned __int8 v8;
  unsigned int v10;

  v10 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemoteDevCeHost");
  v6 = 0;
  if (a2 && a3)
  {
    if (sub_2198D8570(a1, a3[32], &v10))
    {
      v6 = 255;
    }
    else
    {
      v6 = 0;
      a2[63] = v10;
      v7 = a3[101];
      v8 = a3[102];
      a2[60] = a3[96];
      a2[61] = v7;
      a2[62] = v8;
    }
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemoteDevCeHost");
  return v6;
}

uint64_t sub_219890E88(uint64_t a1, uint64_t a2)
{
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_SmtCrdFmt_HCrHandler");
  *(_BYTE *)(a1 + 25) = 1;
  (*(void (**)(_QWORD, _QWORD, uint64_t))(a1 + 32))(*(_QWORD *)(a1 + 408), *(_QWORD *)(a1 + 40), a2);
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_SmtCrdFmt_HCrHandler");
}

uint64_t sub_219890EFC(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, unsigned __int16 *a6)
{
  uint64_t v12;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_Reset");
  v12 = 1;
  if (a2 && a5 && a3 && a1 && a6 && a4 && *a6 >= 0xFCu)
  {
    *(_OWORD *)(a1 + 32) = 0u;
    *(_OWORD *)(a1 + 48) = 0u;
    *(_QWORD *)a1 = a2;
    *(_QWORD *)(a1 + 16) = a3;
    *(_QWORD *)(a1 + 88) = a6;
    *(_QWORD *)(a1 + 96) = a5;
    *(_DWORD *)(a1 + 104) = 0;
    *(_WORD *)(a1 + 24) = 256;
    *(_QWORD *)(a1 + 64) = 0;
    *(_QWORD *)(a1 + 72) = 0;
    sub_2198E24A0(a1);
    sub_2198CD790(a1);
    *(_QWORD *)(a1 + 216) = a4;
    sub_219854554(a1);
    v12 = 0;
  }
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_Reset");
  return v12;
}

uint64_t sub_219890FEC(unsigned int *a1, unsigned int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8;
  unsigned int *v9;

  sub_219850718(3, a1, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_SetCR");
  v8 = 1;
  if (a1 && a2 <= 1 && a3 && a4)
  {
    v8 = 0;
    v9 = &a1[4 * a2];
    *((_QWORD *)v9 + 4) = a3;
    *((_QWORD *)v9 + 5) = a4;
  }
  sub_219850808(3, a1, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_SetCR");
  return v8;
}

uint64_t sub_219891084(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  unsigned int v5;
  int v6;
  int v7;
  uint64_t v8;
  uint64_t v9;
  char v11;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_Format");
  if (a1 && *(_QWORD *)(a1 + 32) && *(_QWORD *)(a1 + 40))
  {
    v4 = *(_QWORD *)(a1 + 16);
    v5 = *(_DWORD *)(v4 + 4);
    if (v5 <= 0x10)
    {
      v6 = *(unsigned __int8 *)(v4 + 68);
      v7 = 1 << v5;
      if ((v7 & 0xEC00) != 0)
      {
        if (v6 == 32)
        {
          *(_BYTE *)(a1 + 24) = 1;
          v8 = sub_2198CDF14(a1);
LABEL_15:
          v9 = v8;
          goto LABEL_9;
        }
        goto LABEL_22;
      }
      if ((v7 & 0x11000) != 0)
      {
        if (*(_BYTE *)(v4 + 68))
        {
          if ((v6 & 0x18) == 8)
          {
            v11 = 2;
          }
          else
          {
            v11 = 3;
            if (v6 != 1 && (v6 & 0x18) != 0x18)
              goto LABEL_22;
          }
          *(_BYTE *)(a1 + 24) = v11;
          v8 = sub_2198546A4(a1, a2);
          goto LABEL_15;
        }
        *(_BYTE *)(a1 + 24) = 0;
        if (*(_BYTE *)(v4 + 18) == 7 && *(_BYTE *)(v4 + 8) == 4)
        {
          v8 = sub_2198E2524(a1);
          goto LABEL_15;
        }
LABEL_22:
        v9 = 29;
        goto LABEL_9;
      }
    }
    sub_219850628(3, (unsigned int *)a1, 8u, 2u, (uint64_t)"Invalid remote device or Remote device not found");
    goto LABEL_22;
  }
  sub_219850628(3, (unsigned int *)a1, 8u, 2u, (uint64_t)"Invalid input parameters");
  v9 = 1;
LABEL_9:
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_Format");
  return v9;
}

uint64_t sub_2198911F8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned int v5;
  int v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_Process");
  if (a2)
  {
    v5 = *(_DWORD *)(*(_QWORD *)(a2 + 16) + 4);
    if (v5 > 0x10)
      goto LABEL_9;
    v6 = 1 << v5;
    if ((v6 & 0xEC00) != 0)
    {
      sub_2198CE0A4(a2, a3);
      return sub_219850808(0, (unsigned int *)&v8, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_Process");
    }
    if ((v6 & 0x11000) == 0)
    {
LABEL_9:
      *(_BYTE *)(a2 + 25) = 1;
      (*(void (**)(_QWORD, _QWORD, uint64_t))(a2 + 48))(*(_QWORD *)(a2 + 408), *(_QWORD *)(a2 + 40), 29);
      return sub_219850808(0, (unsigned int *)&v8, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_Process");
    }
    if ((*(_BYTE *)(a2 + 24) & 0xFE) == 2)
      sub_2198547C4(a2, a3);
    else
      sub_2198E2644(a2, a3);
  }
  return sub_219850808(0, (unsigned int *)&v8, 8u, 5u, (uint64_t)"phFriNfc_NdefSmtCrd_Process");
}

uint64_t sub_2198912E4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GenericTransceiveCmd");
  v5 = 1;
  if (a1 && a3)
    v5 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), a3, (uint64_t)sub_219865DD0, a1);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GenericTransceiveCmd");
  return v5;
}

uint64_t sub_219891374(unsigned int *a1, uint64_t a2)
{
  unsigned int *v4;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GenericTransceiveResp");
  if (a1)
  {
    v4 = a1 + 4842;
    if ((_DWORD)a2)
      sub_219850628(1, v4, 4u, 1u, (uint64_t)"phLibNfc_GenericTransceiveResp:transceive failed!");
    else
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"phLibNfc_GenericTransceiveResp:transceive success");
  }
  else
  {
    a2 = 1;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GenericTransceiveResp");
  return a2;
}

uint64_t sub_21989141C(unsigned int *a1, int a2, uint64_t a3)
{
  uint64_t v4;
  BOOL v6;

  LODWORD(v4) = a2;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GenericTransceiveComplete");
  if (a3)
    v6 = a1 == 0;
  else
    v6 = 1;
  if (v6)
    v4 = 1;
  else
    v4 = v4;
  sub_219891854((uint64_t)a1, v4, a3);
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GenericTransceiveComplete");
  return v4;
}

uint64_t sub_2198914A0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8;
  uint64_t v9;
  unsigned int *v10;
  const char *v11;
  uint64_t v12;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = 0;
  sub_219850718(2, (unsigned int *)a4, 4u, 5u, (uint64_t)"phLibNfc_InternalTransceive");
  v8 = 1;
  if (a4)
  {
    *(_BYTE *)(a4 + 1480) = 1;
    v14 = a1;
    v9 = sub_2198BE4E4(a4, &v14, &v15, 1);
    if ((_DWORD)v9)
    {
      v8 = v9;
      v10 = (unsigned int *)(a4 + 19368);
      v11 = "phLibNfc_MapRemoteDevHandle: Failed to map handle";
LABEL_6:
      sub_219850628(1, v10, 4u, 1u, (uint64_t)v11);
      goto LABEL_7;
    }
    v12 = sub_219879D44(a4, v15);
    if ((_DWORD)v12)
    {
      v8 = v12;
      v10 = (unsigned int *)(a4 + 19368);
      v11 = "phLibNfc_ValidateDevHandle: Mapped handle validation failed!";
      goto LABEL_6;
    }
    v8 = sub_2198915DC(a4, a2);
    if ((_DWORD)v8 == 13)
    {
      *(_QWORD *)(a4 + 6200) = a3;
      *(_QWORD *)(a4 + 6208) = a4;
      *(_OWORD *)(a4 + 2552) = *(_OWORD *)(a2 + 48);
    }
    else
    {
      *(_QWORD *)(a4 + 2552) = 0;
      *(_DWORD *)(a4 + 2560) = 0;
      *(_QWORD *)(a4 + 6200) = 0;
      *(_QWORD *)(a4 + 6208) = 0;
    }
  }
LABEL_7:
  sub_219850808(2, (unsigned int *)a4, 4u, 5u, (uint64_t)"phLibNfc_InternalTransceive");
  return v8;
}

uint64_t sub_2198915DC(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t *v5;
  uint64_t v6;
  uint64_t (**v7)();
  uint64_t *v8;
  int v9;
  unsigned __int8 *v10;
  int v11;
  char v12;
  uint64_t (**v13)();
  uint64_t (*v14)();
  uint64_t v15;
  unsigned int v16;
  uint64_t (*v17)();
  uint64_t *v18;
  uint64_t v19;
  uint64_t *v20;
  uint64_t v21;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RfTransceive");
  v4 = 1;
  if (!a1 || !a2)
    goto LABEL_36;
  *(_QWORD *)(a1 + 5384) = 0;
  v5 = (uint64_t *)(a1 + 1456);
  if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    v6 = 0;
    *v5 = 0;
    *(_QWORD *)(a1 + 1464) = 0;
  }
  else
  {
    v6 = *v5;
  }
  if (!sub_2198D07BC((unsigned int *)a1, (int *)a2, v6))
  {
    v8 = (uint64_t *)(a1 + 5384);
    v9 = *(_DWORD *)a2;
    if (*(_DWORD *)a2 == 160)
      goto LABEL_17;
    if (v9)
    {
      v15 = *(_QWORD *)(a2 + 32);
      v16 = v9 & 0xFFFFFFFE;
      if ((v9 & 0xFFFFFFFE) == 0x60 && v15)
        goto LABEL_31;
      if (v16 == 128)
      {
        v7 = off_2550A3098;
        goto LABEL_26;
      }
      if (v16 == 192 && v15 || v9 == 194)
      {
LABEL_9:
        v7 = off_2550A3038;
LABEL_26:
        *(_QWORD *)(a1 + 2912) = v7;
        *(_BYTE *)(a1 + 2904) = 0;
        *(_BYTE *)(a1 + 2906) = 0;
        v17 = *v7;
        if (*v7)
        {
          LOBYTE(v17) = 0;
          v18 = (uint64_t *)(v7 + 2);
          do
          {
            LOBYTE(v17) = (_BYTE)v17 + 1;
            v19 = *v18;
            v18 += 2;
          }
          while (v19);
        }
        *(_BYTE *)(a1 + 2905) = (_BYTE)v17;
LABEL_35:
        v4 = sub_2198655FC(a1, 0, a2);
        goto LABEL_36;
      }
      if (v9 == 176)
      {
        v7 = off_2550A3078;
        goto LABEL_26;
      }
    }
    else
    {
      v10 = *(unsigned __int8 **)(a2 + 32);
      if (v10)
      {
        v11 = *v10;
        if (v11 == 160)
        {
LABEL_17:
          *(_QWORD *)(a1 + 2912) = &qword_2550A3008;
          *(_BYTE *)(a1 + 2904) = 0;
          *(_BYTE *)(a1 + 2906) = 0;
          v12 = qword_2550A3008;
          if (qword_2550A3008)
          {
            v12 = 0;
            v13 = off_2550A3018;
            do
            {
              ++v12;
              v14 = *v13;
              v13 += 2;
            }
            while (v14);
          }
          goto LABEL_34;
        }
        if ((v11 & 0xFE) == 0x60)
        {
LABEL_31:
          *(_QWORD *)(a1 + 2912) = off_2550A3098;
          *(_BYTE *)(a1 + 2904) = 0;
          *(_BYTE *)(a1 + 2906) = 0;
          v12 = (char)off_2550A3098[0];
          if (off_2550A3098[0])
          {
            v12 = 0;
            v20 = &qword_2550A30A8;
            do
            {
              ++v12;
              v21 = *v20;
              v20 += 2;
            }
            while (v21);
          }
LABEL_34:
          *(_BYTE *)(a1 + 2905) = v12;
          if (!*(_DWORD *)a2)
          {
            v4 = sub_2198D04F0(a1, v6, a2, (_QWORD *)(a1 + 5384));
            if ((_DWORD)v4)
              goto LABEL_36;
            a2 = *v8;
            if (!*v8)
            {
              v4 = 0;
              goto LABEL_36;
            }
          }
          goto LABEL_35;
        }
      }
    }
    v4 = 1;
    goto LABEL_36;
  }
  if (*(_QWORD *)(a2 + 32) && *(_DWORD *)a2 == 3)
    goto LABEL_9;
  if (v6 && !sub_2198BF34C(a1, *(_DWORD *)(v6 + 4), a2, a1 + 2712))
  {
    v7 = off_2550A0DD8;
    a2 = a1 + 2712;
    goto LABEL_26;
  }
  v4 = 255;
LABEL_36:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RfTransceive");
  return v4;
}

uint64_t sub_219891854(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t *v6;
  uint64_t v7;
  char v8;
  uint64_t *v9;
  uint64_t v10;
  unsigned int *v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t (**v14)();
  uint64_t (*v15)();
  uint64_t *v16;
  uint64_t v17;
  int v18;
  uint64_t v19;
  int v20;
  _DWORD *v21;
  uint64_t v22;
  int v23;
  uint64_t (**v24)();
  __int16 v25;
  int *v26;
  int v27;
  void (*v28)(_QWORD, uint64_t, uint64_t, uint64_t, uint64_t);
  uint64_t v29;
  uint64_t v30;
  uint64_t v31;
  char *v32;
  uint64_t v33;
  uint64_t v34;
  uint64_t v36;
  unsigned int v37;
  unsigned __int8 *v38;
  char v39;
  uint64_t v40;
  uint64_t v41;

  v40 = 0;
  v41 = 0;
  v39 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrepareTransceiveCb");
  if (!a1 || !a3)
    goto LABEL_95;
  v6 = (uint64_t *)(a1 + 1456);
  if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    v7 = 0;
    *v6 = 0;
    *(_QWORD *)(a1 + 1464) = 0;
  }
  else
  {
    v7 = *v6;
  }
  if ((_DWORD)a2 == 146
    || (_DWORD)a2 == 121
    || !(_DWORD)a2
    || *(_BYTE *)(a1 + 1484)
    || !v7
    || sub_2198D0904((unsigned int *)a1, v7))
  {
    if ((_DWORD)a2 == 44 && *(_QWORD *)(a1 + 6264))
    {
      if (!sub_219901F90(*(_QWORD *)(a1 + 19360), v7))
      {
        *(_QWORD *)(a1 + 2912) = &qword_2550A2B08;
        *(_BYTE *)(a1 + 2904) = 0;
        *(_BYTE *)(a1 + 2906) = 0;
        v8 = qword_2550A2B08;
        if (qword_2550A2B08)
        {
          v8 = 0;
          v9 = &qword_2550A2B18;
          do
          {
            ++v8;
            v10 = *v9;
            v9 += 2;
          }
          while (v10);
        }
        *(_BYTE *)(a1 + 2905) = v8;
        sub_2198655FC(a1, 0, 0);
        word_2550A4210 = 0;
        a2 = 44;
        goto LABEL_95;
      }
    }
    else
    {
      if (!(_DWORD)a2)
      {
        v13 = sub_2198D85FC(a1, a3, *(_QWORD *)(a1 + 1456));
        v12 = 146;
        if ((_DWORD)v13)
          goto LABEL_72;
        goto LABEL_34;
      }
      if ((_DWORD)a2 != 44)
      {
        v12 = 146;
        v13 = 255;
        if ((int)a2 <= 142)
        {
          if ((_DWORD)a2 != 10)
          {
            if ((_DWORD)a2 == 12)
            {
              sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Insufficient resources!");
              v13 = 12;
            }
            else if ((_DWORD)a2 == 121)
            {
              word_2550A4210 = 0;
              v12 = 150;
              v13 = 121;
              goto LABEL_81;
            }
            goto LABEL_72;
          }
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Target Lost!!");
          v40 = *(_QWORD *)(a1 + 1456);
          if (sub_2198BE4E4(a1, &v41, &v40, 0) || !v41)
            goto LABEL_72;
          v36 = sub_21990201C(*(_QWORD *)(a1 + 3040));
          if (v36 > 1)
          {
            v13 = v36;
            goto LABEL_72;
          }
          v37 = *(_DWORD *)(v41 + 4);
          if (v37 > 0x13 || ((1 << v37) & 0x8E800) == 0 || !*(_QWORD *)(a1 + 6264))
          {
LABEL_72:
            if ((_DWORD)v13 != 121 && *(_BYTE *)(a1 + 1480) == 1)
            {
              v28 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 6200);
              if (v28)
              {
                if (*(_QWORD *)(a1 + 2616))
                {
                  phOsalNfc_FreeMemory();
                  *(_QWORD *)(a1 + 2616) = 0;
                  v28 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t, uint64_t))(a1 + 6200);
                }
                v29 = *(_QWORD *)(a1 + 6208);
                *(_QWORD *)(a1 + 6200) = 0;
                *(_QWORD *)(a1 + 6208) = 0;
                v28(*(_QWORD *)(a1 + 19360), v29, v41, a1 + 2552, v13);
              }
              a2 = v13;
              goto LABEL_95;
            }
            if (!(_DWORD)v13)
            {
              v12 = 145;
              goto LABEL_83;
            }
            if ((_DWORD)v13 == 185)
            {
LABEL_83:
              if (*(_QWORD *)(a1 + 2616))
              {
                phOsalNfc_FreeMemory();
                *(_QWORD *)(a1 + 2616) = 0;
              }
              if ((_DWORD)v12 == 150)
              {
                v30 = *(_QWORD *)(a1 + 19360);
                v31 = v41;
                v32 = &v39;
                v33 = 150;
              }
              else
              {
                if ((_DWORD)v13 == 10)
                {
                  v34 = sub_21990201C(*(_QWORD *)(a1 + 3040));
                  v13 = v34;
                  if ((_DWORD)v34 != 186 && (_DWORD)v34 != 187)
                  {
                    if (*(_QWORD *)(a1 + 6264))
                      v13 = 152;
                    else
                      v13 = 255;
                  }
                }
                v30 = *(_QWORD *)(a1 + 19360);
                v31 = v41;
                v32 = (char *)(a1 + 2552);
                v33 = v12;
              }
              a2 = sub_2198D1B2C(v30, v33, v13, v31, (uint64_t)v32);
              goto LABEL_95;
            }
LABEL_81:
            *(_DWORD *)(a1 + 2560) = 0;
            goto LABEL_83;
          }
        }
        else
        {
          v22 = (a2 - 143);
          if (v22 > 0x2C)
            goto LABEL_72;
          if (((1 << (a2 + 113)) & 0x1FC800000001) != 0)
          {
            if (*(_QWORD *)(a1 + 6200))
            {
              v40 = *(_QWORD *)(a1 + 1456);
              v23 = sub_2198BE4E4(a1, &v41, &v40, 0);
              word_2550A4210 = v23;
              if (v23 || !v41)
                goto LABEL_72;
              *(_DWORD *)(a1 + 2560) = 0;
            }
            else
            {
              *(_QWORD *)(a1 + 2552) = *(_QWORD *)a3;
              *(_DWORD *)(a1 + 2560) = *(_DWORD *)(a3 + 8);
              sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"phLibNfc_PrepareTransceiveCb - RF related error received from NFCC ");
            }
            v13 = a2;
            goto LABEL_72;
          }
          if (v22 != 3)
            goto LABEL_72;
          word_2550A4210 = 0;
        }
        v13 = 146;
        goto LABEL_72;
      }
    }
    v11 = (unsigned int *)(a1 + 19368);
    if (*(_BYTE *)(a1 + 1482) != 3)
    {
      sub_219850628(1, v11, 4u, 2u, (uint64_t)"Target Lost!!");
      v12 = 146;
      if (*(_QWORD *)(a1 + 6264))
        v13 = 146;
      else
        v13 = 255;
      goto LABEL_72;
    }
    sub_219850628(1, v11, 4u, 4u, (uint64_t)"A Passive ACK Timeout (PAT) in response to a SECTOR SELECT command packet 2");
    *(_BYTE *)(a1 + 1482) = 0;
    v12 = 145;
LABEL_34:
    v13 = (unsigned __int16)word_2550A4210;
    word_2550A4210 = 0;
    if ((_DWORD)v13)
      goto LABEL_72;
    v40 = *(_QWORD *)(a1 + 1456);
    v18 = sub_2198BE4E4(a1, &v41, &v40, 0);
    if (v18)
      v13 = 255;
    else
      v13 = 0;
    if (v18)
    {
      v19 = *(_QWORD *)a3;
      v20 = *(_DWORD *)(a3 + 8);
      goto LABEL_40;
    }
    v20 = *(_DWORD *)(a3 + 8);
    v19 = *(_QWORD *)a3;
    if (!v20 || !v19)
    {
LABEL_40:
      *(_QWORD *)(a1 + 2552) = v19;
      *(_DWORD *)(a1 + 2560) = v20;
      v21 = *(_DWORD **)(a1 + 2616);
      if (v21 && *v21 == 48)
        goto LABEL_42;
      goto LABEL_72;
    }
    *(_DWORD *)(a1 + 2560) = v20;
    phOsalNfc_MemCopy();
    if (sub_2198D0904((unsigned int *)a1, v7)
      && (!v7 || *(_DWORD *)(v7 + 20) || *(_DWORD *)(v7 + 16) != 2 || *(_BYTE *)(v7 + 96))
      || (v26 = *(int **)(a1 + 2616)) == 0)
    {
      v13 = 0;
      goto LABEL_72;
    }
    v27 = *v26;
    if (*v26)
    {
LABEL_63:
      if (v27 != 48 || *(_DWORD *)(a3 + 8) >= 0x10u)
        goto LABEL_116;
LABEL_115:
      v13 = 255;
LABEL_42:
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2616) = 0;
      goto LABEL_72;
    }
    v38 = (unsigned __int8 *)*((_QWORD *)v26 + 4);
    if (v38)
    {
      v27 = *v38;
      if (v26[10] != 1 || v27 != 96)
        goto LABEL_63;
      if (*(_DWORD *)(a3 + 8) < 8u)
        goto LABEL_115;
    }
LABEL_116:
    v13 = 0;
    v12 = 145;
    goto LABEL_42;
  }
  *(_DWORD *)(a1 + 1476) = 128;
  *(_BYTE *)(a1 + 1484) = 1;
  v14 = off_2550A2D38;
  if (*(_BYTE *)(a1 + 1483) == 1)
    v14 = off_2550A0DF8;
  *(_QWORD *)(a1 + 2912) = v14;
  *(_BYTE *)(a1 + 2904) = 0;
  *(_BYTE *)(a1 + 2906) = 0;
  v15 = *v14;
  if (*v14)
  {
    LOBYTE(v15) = 0;
    v16 = (uint64_t *)(v14 + 2);
    do
    {
      LOBYTE(v15) = (_BYTE)v15 + 1;
      v17 = *v16;
      v16 += 2;
    }
    while (v17);
  }
  *(_BYTE *)(a1 + 2905) = (_BYTE)v15;
  sub_2198655FC(a1, 0, 0);
  if ((a2 - 181) < 7 || (_DWORD)a2 == 178 || (_DWORD)a2 == 10)
  {
    word_2550A4210 = a2;
  }
  else
  {
    if (*(_QWORD *)(a1 + 6264))
    {
      v24 = &off_2550A4000;
      v25 = 152;
    }
    else
    {
      v24 = &off_2550A4000;
      v25 = 255;
    }
    *((_WORD *)v24 + 264) = v25;
  }
LABEL_95:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrepareTransceiveCb");
  return a2;
}

uint64_t sub_219891ED8(uint64_t a1, uint64_t a2, unsigned __int8 *a3)
{
  int v5;
  uint64_t v6;
  unsigned int *v7;
  uint64_t v9;
  uint64_t v10;
  __int16 v11;

  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Initialize");
  if (a3)
    v5 = *a3;
  else
    v5 = 255;
  if (*(_DWORD *)(a1 + 3176) != 1 || *(_BYTE *)(a1 + 3228) || *(_BYTE *)(a1 + 3229))
  {
LABEL_7:
    *(_BYTE *)(a1 + 3229) = 1;
    v6 = sub_2198FB470(*(_QWORD *)(a1 + 2952), (uint64_t)&v11, (uint64_t)sub_219865DD0, a1, v5, 0);
    if ((_DWORD)v6 == 13)
    {
      v7 = sub_2198FBC30(*(_QWORD *)(a1 + 2952));
      *(_QWORD *)(a1 + 3040) = v7;
      sub_2198FCF54((uint64_t)v7, 5, (uint64_t)sub_219896D1C, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 9, (uint64_t)sub_2198ED8AC, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 23, (uint64_t)sub_2198ED8AC, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 29, (uint64_t)sub_2198ED9E0, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 30, (uint64_t)sub_2198EDAEC, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 32, (uint64_t)sub_2198EDB94, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 14, (uint64_t)sub_2198EDD08, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 15, (uint64_t)sub_2198EE018, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 31, (uint64_t)sub_2198EE13C, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 33, (uint64_t)sub_2198EE234, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 4, (uint64_t)sub_2198EE4D0, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 20, (uint64_t)sub_219853EE0, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 19, (uint64_t)sub_2198EC918, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 22, (uint64_t)sub_2198EDDEC, a1);
      sub_2198FCF54(*(_QWORD *)(a1 + 3040), 25, (uint64_t)sub_2198EDEEC, a1);
    }
    goto LABEL_9;
  }
  *(_BYTE *)(a1 + 3228) = 1;
  v6 = phTmlNfc_IoCtl();
  sub_219886334(1, (unsigned int *)(a1 + 19368), 4u, 3u, (uint64_t)"phLibNfc_Initialize: SPMI Reset Client Status =");
  sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_Initialize: SPMI Reset Client Status =");
  if (!(_DWORD)v6)
  {
    phOsalNfc_Delay();
    goto LABEL_7;
  }
  if ((_DWORD)v6 == 179)
  {
    v9 = *(_QWORD *)(a1 + 3184);
    if (v9 == 0xFFFFFFFFFFFFLL || !v9)
    {
      v9 = phOsalNfc_Timer_Create();
      *(_QWORD *)(a1 + 3184) = v9;
    }
    if (v9 != 0xFFFFFFFFFFFFLL && v9)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Client reset Nack Timer Created Successfully");
      *(_QWORD *)(a1 + 3168) = sub_2198977E4;
      if (phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Client reset Nack Timer Start failed");
        v10 = *(_QWORD *)(a1 + 3184);
        v6 = 255;
        if (v10 && v10 != 0xFFFFFFFFFFFFLL)
        {
          phOsalNfc_Timer_Stop();
          phOsalNfc_Timer_Delete();
          *(_QWORD *)(a1 + 3184) = 0xFFFFFFFFFFFFLL;
        }
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Client reset Nack Timer Started");
        v6 = 13;
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Client reset Nack Timer Create failed");
      v6 = 12;
    }
  }
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Initialize");
  return v6;
}

uint64_t sub_2198922A4(uint64_t a1, int a2, uint64_t *a3)
{
  unsigned __int16 *v6;
  int v7;
  uint64_t v8;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InitializeProcess");
  if (a3)
  {
    v6 = (unsigned __int16 *)a3[1];
    if (v6)
      LODWORD(v6) = *v6 != 0;
  }
  else
  {
    LODWORD(v6) = 0;
  }
  if (a2)
    LODWORD(v6) = 1;
  if ((_DWORD)v6)
    v7 = 255;
  else
    v7 = a2;
  v8 = sub_219897454(a1, v7, a3);
  *(_WORD *)(a1 + 3227) = 0;
  *(_BYTE *)(a1 + 3229) = 0;
  *(_BYTE *)(a1 + 3161) = 0;
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InitializeProcess");
  return v8;
}

uint64_t sub_219892360(uint64_t a1)
{
  unsigned int v2;
  int v3;
  BOOL v4;
  BOOL v5;
  uint64_t v6;
  _OWORD v8[96];
  int v9;
  char v10;
  uint64_t v11;

  v11 = *MEMORY[0x24BDAC8D0];
  memset(v8, 0, 512);
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CrcConfig");
  if (a1)
  {
    v2 = *(unsigned __int8 *)(a1 + 2980);
    v3 = *(unsigned __int8 *)(a1 + 2936);
    v4 = v2 > 0x9F && v3 == 1;
    if (v2 >= 0xE0)
      v4 = 0;
    v5 = v2 < 0x32 && v3 == 1;
    if (*(_BYTE *)(a1 + 2884)
      && !v4
      && !v5
      && (v3 == 1 || *(_BYTE *)(a1 + 2937) == 1 || *(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2944) == 1)
      && *(_BYTE *)(a1 + 5404) == 1)
    {
      phOsalNfc_SetMemory();
      DWORD1(v8[0]) |= 0x10000u;
      v9 |= 0x4000u;
      v10 = *(_DWORD *)(a1 + 5404);
      v6 = sub_2198FD4A4(*(_QWORD *)(a1 + 3040), (uint64_t)v8, (uint64_t)sub_219865DD0, a1);
    }
    else
    {
      sub_21986607C(a1, *(_QWORD *)(a1 + 2912), 1);
      v6 = 0;
    }
    *(_BYTE *)(a1 + 2884) = 0;
  }
  else
  {
    v6 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CrcConfig");
  return v6;
}

uint64_t sub_219892528(uint64_t a1, int a2)
{
  uint64_t v4;
  int v6;

  v6 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CrcConfigProcess");
  v4 = 255;
  if (a1 && !a2)
  {
    sub_21988ED38(*(_QWORD *)(a1 + 19360), &v6);
    sub_21990135C(*(_QWORD *)(a1 + 3040), *(_BYTE *)(a1 + 5404));
    if (*(_DWORD *)(a1 + 5404) == 1 && *(_QWORD *)(a1 + 6104))
    {
      sub_21990145C(*(_QWORD *)(a1 + 3040), 1);
      sub_2199014F4(*(_QWORD *)(a1 + 3040), *(_BYTE *)(a1 + 5404));
    }
    if (v6 == 6 && *(_DWORD *)(a1 + 5404) < 2u)
      v4 = phTmlNfc_IoCtl();
    else
      v4 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CrcConfigProcess");
  return v4;
}

uint64_t sub_21989262C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ReInitialize");
  v2 = 1;
  if (a1)
  {
    *(_BYTE *)(a1 + 3229) = 1;
    *(_BYTE *)(a1 + 696) = 0;
    v2 = sub_2198FBC84(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ReInitialize");
  return v2;
}

uint64_t sub_2198926AC(uint64_t a1, int a2, uint64_t *a3)
{
  unsigned __int16 *v6;
  uint64_t v7;
  int v8;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ReInitializeProcess");
  if (a1)
  {
    if (a3)
    {
      v6 = (unsigned __int16 *)a3[1];
      if (v6)
        LODWORD(v6) = *v6 != 0;
    }
    else
    {
      LODWORD(v6) = 0;
    }
    if (a2)
      LODWORD(v6) = 1;
    if ((_DWORD)v6)
      v8 = 255;
    else
      v8 = a2;
    v7 = sub_219897454(a1, v8, a3);
    *(_BYTE *)(a1 + 3227) = 0;
    *(_BYTE *)(a1 + 3229) = 0;
    *(_BYTE *)(a1 + 3161) = 0;
  }
  else
  {
    v7 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ReInitializeProcess");
  return v7;
}

uint64_t sub_219892770(uint64_t a1)
{
  int v2;
  BOOL v3;
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MwFwCompatibilityChk");
  if (a1)
  {
    if (*(_DWORD *)(a1 + 3064)
      || (v2 = *(_DWORD *)(a1 + 2980), (v2 & 0xFD) == 0xFC)
      || ((v2 & 0xE0u) - 160 <= 0x3F ? (v3 = *(_BYTE *)(a1 + 2936) == 1) : (v3 = 0),
          v3
       || *(_BYTE *)(a1 + 2937) == 1 && *(_DWORD *)(a1 + 3148) == 2
       || *(_BYTE *)(a1 + 2938) == 1 && *(_DWORD *)(a1 + 3148) == 2
       || *(_BYTE *)(a1 + 2944) == 1 && *(_DWORD *)(a1 + 3148) == 2))
    {
      v4 = 0;
    }
    else
    {
      v4 = sub_2198FBDCC(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
    }
  }
  else
  {
    v4 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MwFwCompatibilityChk");
  return v4;
}

uint64_t sub_219892870(uint64_t a1, uint64_t a2, unsigned __int16 *a3)
{
  uint64_t v6;
  unsigned int v7;
  unsigned int v8;
  unsigned int *v9;
  unsigned int v11;
  int v12;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MwFwCompatibilityChkProcess");
  v6 = 255;
  if (a1 && a3)
  {
    if (*(_BYTE *)(a1 + 2936) == 1)
    {
      v7 = 21;
      goto LABEL_7;
    }
    if (*(_BYTE *)(a1 + 2937) == 1)
      goto LABEL_6;
    if (*(_BYTE *)(a1 + 2938) == 1)
    {
      if (*(_BYTE *)(a1 + 2942) != 1)
      {
        v7 = 44;
        if (*(_BYTE *)(a1 + 2943) != 1)
        {
          if (*(_BYTE *)(a1 + 3088) == 2)
            v7 = 44;
          else
            v7 = 50;
        }
        goto LABEL_7;
      }
LABEL_6:
      v7 = 44;
      goto LABEL_7;
    }
    v11 = *(unsigned __int8 *)(a1 + 2945);
    if (__PAIR64__(v11, *(unsigned __int8 *)(a1 + 2944)) == 1)
    {
      v12 = *(unsigned __int8 *)(a1 + 2946);
      if (!*(_BYTE *)(a1 + 2946))
      {
        v7 = 3;
        goto LABEL_7;
      }
    }
    else
    {
      if (v11 == 1)
      {
        v7 = 29;
LABEL_7:
        v8 = __rev16(*a3);
        if (v8 == v7)
        {
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_MwFwCompatibilityChkProcess : FW and MW are in sync");
          v6 = a2;
        }
        else
        {
          v9 = (unsigned int *)(a1 + 19368);
          if (v8 <= v7)
          {
            sub_219850628(1, v9, 4u, 1u, (uint64_t)"phLibNfc_MwFwCompatibilityChkProcess : FW IS TOO OLD");
            v6 = 128;
          }
          else
          {
            sub_219850628(1, v9, 4u, 1u, (uint64_t)"phLibNfc_MwFwCompatibilityChkProcess : FW IS TOO NEW");
            v6 = 129;
          }
        }
        goto LABEL_18;
      }
      v12 = *(unsigned __int8 *)(a1 + 2946);
    }
    if (v12 != 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_MwFwCompatibilityChkProcess : Invalid platform");
      goto LABEL_18;
    }
    v7 = 5;
    goto LABEL_7;
  }
LABEL_18:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MwFwCompatibilityChkProcess");
  return v6;
}

uint64_t sub_219892A34(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_EnablePropExtn");
  if (a1)
    a2 = sub_2198FFD90(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_EnablePropExtn");
  return a2;
}

uint64_t sub_219892AAC(uint64_t a1, uint64_t a2, unsigned __int8 *a3)
{
  uint64_t v7;
  int v8;
  int v9;
  int v10;
  int v11;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_EnableExtnProcess");
  if (!a1 || !a3)
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phLibNfc_EnableExtnProcess : Invalid Context or pInfo Received");
LABEL_6:
    a2 = 255;
    goto LABEL_7;
  }
  if ((_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_EnableExtnProcess : received status as failed");
    *(_DWORD *)(a1 + 2984) = 0;
    goto LABEL_7;
  }
  a2 = *a3;
  if (!*a3)
  {
    v9 = *(_DWORD *)(a1 + 2984) | (a3[1] << 24);
    *(_DWORD *)(a1 + 2984) = v9;
    v10 = v9 | (a3[2] << 16);
    *(_DWORD *)(a1 + 2984) = v10;
    v11 = v10 | (a3[3] << 8);
    *(_DWORD *)(a1 + 2984) = v11;
    *(_DWORD *)(a1 + 2984) = v11 | a3[4];
    if (*(_BYTE *)(a1 + 3161))
    {
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Enable proprietary extention successfull after no of retry");
      a2 = 0;
      *(_BYTE *)(a1 + 3161) = 0;
    }
    else
    {
      a2 = 0;
    }
    goto LABEL_7;
  }
  if ((_DWORD)a2 != 44)
  {
    *(_BYTE *)(a1 + 3161) = 0;
    *(_DWORD *)(a1 + 2984) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_EnableExtnProcess: failed");
    goto LABEL_7;
  }
  v7 = *(_QWORD *)(a1 + 3040);
  sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Enable proprietary extention request failed, retry count, bBrRetryCnt");
  if (*(unsigned __int8 *)(a1 + 3161) > 2u)
  {
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Enable Prop Extn retry reached max count, bBrRetryCnt");
    *(_BYTE *)(a1 + 3161) = 0;
    *(_DWORD *)(a1 + 2984) = 0;
    goto LABEL_6;
  }
  phTmlNfc_ReadAbort();
  phTmlNfc_FlushTxRxBuffers();
  if (v7)
  {
    v8 = sub_219851DC0(v7 + 888, 0, 3);
    a2 = 0;
    if (v8 != 13)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_EnableExtnProcess: Nci Read request failed");
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"pLibCtx->tPlatformInfo.bBrRetryCnt");
      *(_BYTE *)(a1 + 3161) = 0;
      a2 = 255;
    }
    sub_219866158(a1, *(_QWORD *)(a1 + 2912), 1u);
    ++*(_BYTE *)(a1 + 3161);
  }
  else
  {
    a2 = 44;
  }
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_EnableExtnProcess");
  return a2;
}

uint64_t sub_219892D10(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DisableStandbyMode");
  if (a1)
  {
    *(_BYTE *)(a1 + 1) = 0;
    if (*(_BYTE *)a1)
    {
      v2 = sub_2198FC704(*(_QWORD *)(a1 + 3040), 0, (uint64_t)sub_219865DD0, a1);
    }
    else
    {
      v2 = 0;
      *(_BYTE *)(a1 + 2) = 1;
    }
  }
  else
  {
    v2 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DisableStandbyMode");
  return v2;
}

uint64_t sub_219892DAC(uint64_t a1, int a2)
{
  uint64_t v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetStandbyModeProcess");
  v4 = 255;
  if (a1 && !a2)
  {
    v4 = 0;
    v5 = *(unsigned __int8 *)(a1 + 1);
    *(_BYTE *)a1 = v5;
    *(_BYTE *)(a1 + 1) = v5 == 0;
    *(_BYTE *)(a1 + 2) = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetStandbyModeProcess");
  return v4;
}

uint64_t sub_219892E3C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetEepromParams");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_DWORD *)(a1 + 3564) |= 0x1000u;
    *(_DWORD *)(a1 + 4140) |= 0x80u;
    v2 = sub_2198FE090(*(_QWORD *)(a1 + 3040), a1 + 3560, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetEepromParams");
  return v2;
}

uint64_t sub_219892EF0(uint64_t a1, int a2, uint64_t a3)
{
  unsigned int *v6;
  const char *v7;
  uint64_t v8;
  int v10;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetEepromParamsProc");
  if (a1)
  {
    if (a2 || !a3)
    {
      v6 = (unsigned int *)(a1 + 19368);
      v7 = "Invalid input parameter/Get Config Failed";
      goto LABEL_8;
    }
    if ((*(_BYTE *)(a3 + 5) & 0x10) == 0)
    {
      v6 = (unsigned int *)(a1 + 19368);
      v7 = "Get EEPROM params failed";
LABEL_8:
      sub_219850628(1, v6, 4u, 4u, (uint64_t)v7);
      v8 = 255;
      goto LABEL_9;
    }
    if ((*(_BYTE *)(a3 + 580) & 0x80) == 0)
    {
      v7 = "EEPROM params read failed";
      v6 = (unsigned int *)(a1 + 19368);
      goto LABEL_8;
    }
    phOsalNfc_MemCopy();
    sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_LogEepromUserData");
    sub_219851888(2, (unsigned int *)a1, 4u, 4u, (uint64_t)"EEPROM User param - wCurrMwVer");
    sub_219851888(2, (unsigned int *)a1, 4u, 4u, (uint64_t)"EEPROM User param - wCurrFwVer");
    sub_219851888(2, (unsigned int *)a1, 4u, 4u, (uint64_t)"EEPROM User param - bConfig");
    sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_LogEepromUserData");
    v10 = *(_DWORD *)(a1 + 3556);
    if (v10)
    {
      if (v10 == -1010588251)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Skipping set config");
        sub_21986607C(a1, (uint64_t)off_2550A11E0, 5);
      }
      else
      {
        if (v10 == -1515863101)
          goto LABEL_15;
        sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Unexpected MW Log Area Value still forcing MW config =");
      }
      v8 = 0;
      goto LABEL_9;
    }
LABEL_15:
    sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Firmware updated, continue with NFCC configurations MW Log Value=");
    v8 = 0;
    *(_BYTE *)(a1 + 3155) = 1;
    goto LABEL_9;
  }
  sub_219850628(2, 0, 4u, 4u, (uint64_t)"Invalid input parameter - Get EEPROM params failed");
  v8 = 1;
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetEepromParamsProc");
  return v8;
}

uint64_t sub_219893144(uint64_t a1)
{
  int v2;
  char v3;
  int v4;
  int v5;
  unsigned int v6;
  int v7;
  BOOL v8;
  uint64_t v9;
  _BYTE v11[4];
  int v12;
  char v13;
  char v14;
  char v15;
  char v16;
  char v17;
  __int16 v18;
  int v19;
  char v20;
  char v21;
  uint64_t v22;
  uint64_t v23;
  int v24;
  int v25;
  char v26;
  __int16 v27;
  char v28;
  uint64_t v29;

  v29 = *MEMORY[0x24BDAC8D0];
  bzero(v11, 0x6E8uLL);
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InitSetConfig");
  v2 = *(unsigned __int8 *)(a1 + 2937);
  if (v2 == 1)
  {
    v24 = 2;
  }
  else
  {
    if (*(_BYTE *)(a1 + 2938) != 1 && *(_BYTE *)(a1 + 2944) != 1)
    {
      v24 = 2;
      v26 = -18;
      v12 = 4096;
      v19 = 114688;
      if (*(_BYTE *)(a1 + 2936) != 1)
      {
        v3 = 0;
        v4 = 0;
        v25 = 4;
        goto LABEL_8;
      }
LABEL_7:
      v3 = 0;
      v25 = 10;
      v4 = 1;
LABEL_8:
      v5 = 4096;
      goto LABEL_10;
    }
    v24 = 2;
  }
  v19 = 0x8000;
  if (*(_BYTE *)(a1 + 2936) == 1)
    goto LABEL_7;
  v4 = 0;
  v19 = 0;
  v5 = v12;
  v3 = v17;
LABEL_10:
  v6 = v5 | 0x400;
  v18 = 257;
  v12 = v5 | 0x400;
  v17 = v3 | 0xC;
  v7 = *(_DWORD *)(a1 + 3156);
  if (v7 == 1)
  {
    v6 = v5 & 0xFFFFFBFF;
    v12 = v5 & 0xFFFFFBFF;
    v17 = v3 & 0xF3;
  }
  if (v2 != 1 && *(_BYTE *)(a1 + 2938) != 1 && *(_BYTE *)(a1 + 2944) != 1)
  {
    v12 = v6 | 0x1000;
    v19 |= 4u;
    v22 = 0x100000002;
    if (*(_BYTE *)(a1 + 2938) != 1 && *(_BYTE *)(a1 + 2944) != 1)
    {
      v12 |= 0x1000u;
      v19 |= 2u;
      v20 = 1;
      if (*(_BYTE *)(a1 + 2938) != 1 && *(_BYTE *)(a1 + 2944) != 1)
      {
        v12 |= 0x1000u;
        v19 |= 8u;
        if (v4)
          v21 = 12;
      }
    }
  }
  if (!v7)
  {
    v27 |= 0x10u;
    v28 = 0;
    v13 |= 1u;
    v14 = 1;
    v12 |= 0x8110u;
    v15 |= 8u;
    v16 = 0;
  }
  if (v2 != 1 && *(_BYTE *)(a1 + 2938) != 1)
  {
    if (*(_BYTE *)(a1 + 2944) == 1)
    {
      v8 = 0;
LABEL_33:
      if (v7 == 1 && !v8)
        goto LABEL_35;
      goto LABEL_31;
    }
    v12 |= 0x1000u;
    v19 |= 0x40u;
    v23 = 0x100000000;
    if (*(_BYTE *)(a1 + 2938) != 1)
    {
      v8 = *(_BYTE *)(a1 + 2944) != 1;
      goto LABEL_33;
    }
  }
  if (v7 == 1)
  {
LABEL_35:
    v9 = 0;
    goto LABEL_36;
  }
LABEL_31:
  v9 = sub_2198FD4A4(*(_QWORD *)(a1 + 3040), (uint64_t)v11, (uint64_t)sub_219865DD0, a1);
LABEL_36:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InitSetConfig");
  return v9;
}

uint64_t sub_219893478(unsigned int *a1)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_InitSetConfigProcess");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_InitSetConfigProcess");
  return 0;
}

uint64_t sub_2198934D0(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetEepromParams");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_DWORD *)(a1 + 3564) |= 0x1000u;
    *(_DWORD *)(a1 + 4140) |= 0x80u;
    *(_WORD *)(a1 + 3554) = *(_DWORD *)(a1 + 2980);
    *(_WORD *)(a1 + 3552) = 778;
    *(_DWORD *)(a1 + 3556) = -1010588251;
    phOsalNfc_SetMemory();
    phOsalNfc_MemCopy();
    v2 = sub_2198FD4A4(*(_QWORD *)(a1 + 3040), a1 + 3560, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Invalid input parameters");
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetEepromParams");
  return v2;
}

uint64_t sub_219893600()
{
  return 0;
}

uint64_t sub_219893608(uint64_t a1, int a2)
{
  uint64_t v2;
  int v4;
  _OWORD v6[2];
  __int128 v7;
  __int128 v8;
  __int128 v9;
  __int128 v10;
  __int128 v11;
  __int128 v12;
  __int128 v13;
  __int128 v14;
  __int128 v15;
  __int128 v16;
  __int128 v17;
  __int128 v18;
  __int128 v19;
  __int128 v20;
  __int128 v21;
  __int128 v22;
  __int128 v23;
  __int128 v24;
  __int128 v25;
  __int128 v26;
  __int128 v27;
  __int128 v28;
  uint64_t v29;

  LODWORD(v2) = a2;
  v29 = *MEMORY[0x24BDAC8D0];
  v27 = 0u;
  v28 = 0u;
  v25 = 0u;
  v26 = 0u;
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v19 = 0u;
  v20 = 0u;
  v17 = 0u;
  v18 = 0u;
  v15 = 0u;
  v16 = 0u;
  v13 = 0u;
  v14 = 0u;
  v11 = 0u;
  v12 = 0u;
  v9 = 0u;
  v10 = 0u;
  v7 = 0u;
  v8 = 0u;
  memset(v6, 0, sizeof(v6));
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetLsntModeRtng");
  v4 = *(_DWORD *)(a1 + 3156);
  if ((_DWORD)v2 || (v4 | 2) != 2)
  {
    if (v4 == 1)
      v2 = 0;
    else
      v2 = v2;
  }
  else
  {
    LODWORD(v6[0]) = 1;
    BYTE4(v6[0]) = 0;
    BYTE8(v6[0]) = 1;
    HIDWORD(v6[0]) = 5;
    LODWORD(v7) = 1;
    BYTE4(v7) = -64;
    BYTE8(v7) = 1;
    HIDWORD(v7) = 4;
    LODWORD(v9) = 1;
    BYTE4(v9) = 2;
    BYTE8(v9) = 1;
    HIDWORD(v9) = 4;
    LODWORD(v11) = 1;
    BYTE4(v11) = 0;
    BYTE8(v11) = 1;
    HIDWORD(v11) = 4;
    v2 = sub_2198FDC40(*(_QWORD *)(a1 + 3040), 4u, (int *)v6);
    if (!(_DWORD)v2)
    {
      v2 = sub_2198F7A7C(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, (char *)(a1 + 336), a1);
      if ((_DWORD)v2 != 13)
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Set Rtng Config Sequence failed!");
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetLsntModeRtng");
  return v2;
}

uint64_t sub_2198937A4(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_SetLstnModeRtngProcess");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_SetLstnModeRtngProcess");
  return a2;
}

uint64_t sub_219893808(uint64_t a1)
{
  int v2;
  __int128 v3;
  int v4;
  uint64_t v5;

  v5 = *MEMORY[0x24BDAC8D0];
  v3 = 0uLL;
  if (*(_DWORD *)(a1 + 3156))
    return 0;
  LOBYTE(v3) = 3;
  v2 = 4;
  BYTE12(v3) = 1;
  v4 = 128;
  *(_QWORD *)((char *)&v3 + 4) = 0x8000000002;
  return sub_2198FDA3C(*(_QWORD *)(a1 + 3040), 2, &v2, (uint64_t)sub_219865DD0, a1);
}

uint64_t sub_2198938AC(unsigned int *a1)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_InitSetMappingProcess");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_InitSetMappingProcess");
  return 0;
}

uint64_t sub_219893904(uint64_t a1)
{
  BOOL v2;
  char v3;
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetNfceeIntfCfg");
  if (a1)
  {
    phOsalNfc_SetMemory();
    v2 = *(_BYTE *)(a1 + 2946) == 0;
    v3 = *(_BYTE *)(a1 + 4692);
    *(_DWORD *)(a1 + 3564) |= 0x2000u;
    *(_BYTE *)(a1 + 4692) = v3 | v2 | 4;
    v4 = sub_2198FE090(*(_QWORD *)(a1 + 3040), a1 + 3560, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v4 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetNfceeIntfCfg");
  return v4;
}

uint64_t sub_2198939D4(uint64_t a1, int a2, _BYTE *a3)
{
  uint64_t v6;
  char v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetNfceeIntfCfgProc");
  v6 = 0;
  if (a1 && a3)
  {
    *(_WORD *)(a1 + 318) = 515;
    if (*(_BYTE *)(a1 + 2946) == 1)
      v7 = 2;
    else
      v7 = 3;
    *(_BYTE *)(a1 + 317) = v7;
    if (!a2 && (a3[5] & 0x20) != 0)
    {
      if ((a3[1132] & 1) != 0)
      {
        sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"0xA0EC value is ");
        if (!a3[1170])
          *(_BYTE *)(a1 + 317) = 2;
      }
      if ((a3[1132] & 4) != 0)
      {
        sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"0xA0ED value is ");
        if (!a3[1172])
          *(_BYTE *)(a1 + 318) = 2;
      }
      if ((a3[1132] & 2) != 0
        && (sub_219851888(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"0xA0D4 value is "), !a3[1171]))
      {
        v6 = 0;
        *(_BYTE *)(a1 + 319) = 2;
      }
      else
      {
        v6 = 0;
      }
    }
    else
    {
      v6 = 255;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetNfceeIntfCfgProc");
  return v6;
}

uint64_t sub_219893B38(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_EnableNfceeDisc");
  if (!a1
    || (*(_BYTE *)(a1 + 696) = 1, *(_DWORD *)(a1 + 504) = 0, *(_BYTE *)(a1 + 317) == 2)
    && *(_BYTE *)(a1 + 318) == 2
    && *(_BYTE *)(a1 + 319) == 2
    || *(_DWORD *)(a1 + 456))
  {
    v2 = 0;
  }
  else
  {
    v2 = sub_2198FC140(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_EnableNfceeDisc");
  return v2;
}

uint64_t sub_219893BEC(unsigned int *a1, uint64_t a2)
{
  unsigned int *v4;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessNfceeDiscRsp");
  if (a1)
  {
    v4 = a1 + 4842;
    if ((_DWORD)a2)
    {
      sub_219850628(1, v4, 4u, 1u, (uint64_t)"Failed to start NFCEE Discovery (phLibNfc_ProcessNfceeDiscRsp)");
    }
    else
    {
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"NFCEE Discovery successfully started");
      a1[114] = 1;
    }
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Failed to start NFCEE Discovery (phLibNfc_ProcessNfceeDiscRsp)");
    a2 = 255;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessNfceeDiscRsp");
  return a2;
}

uint64_t sub_219893CC0(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int *v4;
  uint64_t v5;
  const char *v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  uint64_t v10;
  int v11;
  unsigned int *v12;
  unsigned int v13;
  uint64_t v14;
  const char *v15;
  unsigned int *v16;
  unsigned int *v17;
  uint64_t v18;
  uint64_t v20;
  char v21;
  uint64_t *v22;
  uint64_t v23;
  unsigned int *v24;
  uint64_t v25;
  char v26;
  uint64_t v27;
  uint64_t v28;
  uint64_t v29;
  uint64_t *v30;
  uint64_t v31;
  uint64_t v32;
  uint64_t v34;
  uint64_t v35;
  uint64_t v36;
  uint64_t v37;
  uint64_t v38;
  uint64_t v39;
  uint64_t v40;
  uint64_t v41;
  uint64_t v42;
  uint64_t v43;
  int v44;
  uint64_t v45;
  uint64_t v46;

  v3 = (uint64_t)a1;
  v4 = a1 + 4839;
  v45 = 0;
  v46 = 0;
  v44 = 8;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_InitializeComplete");
  if ((a2 - 128) >= 2 && (_DWORD)a2)
  {
    if ((a2 & 0xFFFE) == 0x88)
    {
      if (*(_BYTE *)(v3 + 3160) && sub_219899740((unsigned int *)v3, *(_QWORD *)(v3 + 2912)) == 31)
      {
        sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 2u, (uint64_t)"Libnfc Recovery on going, skip Init abort");
        *(_WORD *)v4 = a2;
        goto LABEL_130;
      }
LABEL_36:
      sub_21988F460(*(_QWORD *)(v3 + 2952), &v46);
      if ((_DWORD)a2 == 44)
      {
        sub_219897050(v3);
        if (*(_DWORD *)(v3 + 3176) == 1)
        {
          v11 = phTmlNfc_IoCtl();
          if (v11)
            goto LABEL_56;
          v13 = v4[3];
          v12 = v4 + 3;
          v11 = sub_2198972CC(v13, *(_QWORD *)(v3 + 2952));
          if (v11 == 179)
          {
            if (!*(_QWORD *)(v3 + 6568))
            {
LABEL_127:
              sub_21986BE40(*(_QWORD *)(v3 + 2952));
              a2 = 255;
              goto LABEL_128;
            }
            v14 = *(_QWORD *)(v3 + 3184);
            if (v14 == 0xFFFFFFFFFFFFLL || !v14)
            {
              v14 = phOsalNfc_Timer_Create();
              *(_QWORD *)(v3 + 3184) = v14;
            }
            if (v14 != 0xFFFFFFFFFFFFLL && v14)
            {
              *(_QWORD *)(v3 + 3168) = sub_21989949C;
              if (!phOsalNfc_Timer_Start())
              {
                sub_219850628(1, v12, 4u, 4u, (uint64_t)"Client reset Nack Timer Started");
                (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v3 + 6568))(*(_QWORD *)(v3 + 19360), *(_QWORD *)(v3 + 6576), 304, 0);
                goto LABEL_57;
              }
              sub_219850628(1, v12, 4u, 1u, (uint64_t)"Client reset Nack Timer Start failed");
              v32 = *(_QWORD *)(v3 + 3184);
              if (v32 && v32 != 0xFFFFFFFFFFFFLL)
              {
                phOsalNfc_Timer_Stop();
                phOsalNfc_Timer_Delete();
                *(_QWORD *)(v3 + 3184) = 0xFFFFFFFFFFFFLL;
              }
              goto LABEL_127;
            }
            v15 = "Client reset Nack Timer Create failed";
            v16 = v12;
LABEL_126:
            sub_219850628(1, v16, 4u, 1u, (uint64_t)v15);
            goto LABEL_127;
          }
        }
        else
        {
          v11 = phTmlNfc_IoCtl();
        }
        if (v11)
          goto LABEL_56;
        sub_21988ED38(*(_QWORD *)(v3 + 2952), &v44);
        sub_2198C1984(*(_QWORD *)(v3 + 2952), v44);
        sub_21988F460(*(_QWORD *)(v3 + 2952), &v46);
        sub_21988EB80(*(_QWORD *)(v3 + 2952), &v45);
        if (v46 && v45)
        {
          if (sub_219905DA0(*(_QWORD *)(v46 + 56)) == 13)
          {
            v20 = v45;
            *(_BYTE *)(v45 + 67) = 1;
            *(_WORD *)(v20 + 64) = 0;
            *(_QWORD *)(v3 + 2912) = off_2550A2EE8;
            *(_BYTE *)(v3 + 2904) = 0;
            *(_BYTE *)(v3 + 2906) = 0;
            v21 = (char)off_2550A2EE8[0];
            if (off_2550A2EE8[0])
            {
              v21 = 0;
              v22 = &qword_2550A2EF8;
              do
              {
                ++v21;
                v23 = *v22;
                v22 += 2;
              }
              while (v23);
            }
            goto LABEL_73;
          }
          v16 = (unsigned int *)(v3 + 19368);
          v15 = "phLibNfc_InitializeComplete : Initial Dwnld TML read request failed!!";
        }
        else
        {
          v16 = (unsigned int *)(v3 + 19368);
          v15 = "phLibNfc_InitializeComplete : Retrieval of dnld context/ioctl context failed!!";
        }
        goto LABEL_126;
      }
LABEL_76:
      v24 = (unsigned int *)v3;
      v25 = a2;
LABEL_129:
      sub_219898F04(v24, v25);
      v3 = 0;
      goto LABEL_130;
    }
    if ((int)a2 > 142)
    {
      if ((a2 - 305) >= 3 && (_DWORD)a2 != 143)
      {
        if ((_DWORD)a2 == 179)
        {
          a2 = 180;
          goto LABEL_18;
        }
        goto LABEL_110;
      }
    }
    else if ((_DWORD)a2 != 1 && (_DWORD)a2 != 44 && (_DWORD)a2 != 135)
    {
LABEL_110:
      a2 = 255;
    }
LABEL_18:
    if (!v3)
      goto LABEL_130;
    goto LABEL_19;
  }
  if (!v3 || (_DWORD)a2)
  {
    if (!(_DWORD)a2)
    {
      if (!v3)
      {
        a2 = 0;
        goto LABEL_130;
      }
      goto LABEL_48;
    }
    goto LABEL_18;
  }
  *(_BYTE *)(v3 + 485) = 0;
  a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 1, (uint64_t)sub_2198DA870, v3);
  *(_BYTE *)(v3 + 314) = 1;
  *(_QWORD *)(v3 + 368) = 0x100000005;
  *(_QWORD *)(v3 + 360) = 0;
  if (!(_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"Registering for RF Deactivate Notification..");
    a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 3, (uint64_t)sub_21988BB50, v3);
    if (!(_DWORD)a2)
    {
      a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 2, (uint64_t)sub_21984E8F8, v3);
      if (!(_DWORD)a2)
      {
        a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 11, (uint64_t)sub_2198EE400, v3);
        if (!(_DWORD)a2)
        {
          a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 10, (uint64_t)sub_2198DE4D4, v3);
          if (!(_DWORD)a2)
          {
            a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 20, (uint64_t)sub_219853EE0, v3);
            if (!(_DWORD)a2)
            {
              a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 31, (uint64_t)sub_2198EE13C, v3);
              if (!(_DWORD)a2)
              {
                a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 33, (uint64_t)sub_2198EE234, v3);
                if (!(_DWORD)a2)
                {
                  a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 7, (uint64_t)sub_2198EB980, v3);
                  if (!(_DWORD)a2)
                  {
                    a2 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 12, (uint64_t)sub_2198EF258, v3);
                    if (!(_DWORD)a2)
                    {
                      v5 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 8, (uint64_t)sub_2198ED22C, v3);
                      if ((_DWORD)v5)
                      {
                        a2 = v5;
                        v6 = "Failed to Register phLibNfc_PropRdrNtfHandler";
LABEL_141:
                        sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)v6);
                        goto LABEL_19;
                      }
                      v34 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 24, (uint64_t)sub_2198ED178, v3);
                      if ((_DWORD)v34)
                      {
                        a2 = v34;
                        v6 = "Failed to Register phLibNfc_LongVasCwDetNtfHandler";
                        goto LABEL_141;
                      }
                      v35 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 13, (uint64_t)sub_2198EE334, v3);
                      if ((_DWORD)v35)
                      {
                        a2 = v35;
                        v6 = "Failed to Register phLibNfc_RssiStatsHandler";
                        goto LABEL_141;
                      }
                      v36 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 16, (uint64_t)sub_2198EFCF4, v3);
                      if ((_DWORD)v36)
                      {
                        a2 = v36;
                        v6 = "Failed to Register phLibNfc_PropTagRemDetNtfHandler";
                        goto LABEL_141;
                      }
                      v37 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 17, (uint64_t)sub_2198EFDBC, v3);
                      if ((_DWORD)v37
                        || (v37 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 27, (uint64_t)sub_2198EFE74, v3), (_DWORD)v37))
                      {
                        a2 = v37;
                        v6 = "Failed to Register phLibNfc_PropLpcdDebugNtfHandler";
                        goto LABEL_141;
                      }
                      v38 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 34, (uint64_t)sub_2198EDC50, v3);
                      if ((_DWORD)v38)
                      {
                        a2 = v38;
                        v6 = "Failed to Register phLibNfc_TotalPollDurationNtfHandler";
                        goto LABEL_141;
                      }
                      v39 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 18, (uint64_t)sub_2198F0300, v3);
                      if ((_DWORD)v39)
                      {
                        a2 = v39;
                        v6 = "Failed to Register phLibNfc_PropChipScopeLoggingNtfHandler";
                        goto LABEL_141;
                      }
                      v40 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 26, (uint64_t)sub_2198F0414, v3);
                      if ((_DWORD)v40)
                      {
                        a2 = v40;
                        v6 = "Failed to Register phLibNfc_PropSmbLoggingNtfHandler";
                        goto LABEL_141;
                      }
                      v41 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 19, (uint64_t)sub_2198EC918, v3);
                      if ((_DWORD)v41)
                      {
                        a2 = v41;
                        v6 = "Failed to Register phLibNfc_PropMultiTagStatNtfHandler";
                        goto LABEL_141;
                      }
                      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"Registering for RF interface error Notification..");
                      v42 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 21, (uint64_t)sub_21988C13C, v3);
                      if ((_DWORD)v42)
                      {
                        a2 = v42;
                        v6 = "Failed to Register phLibNfc_RfIntfErrNtf_Resp_Cb";
                        goto LABEL_141;
                      }
                      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"Registering for relay attack detection Notification..");
                      v43 = sub_2198FCCD4(*(_QWORD *)(v3 + 3040), 28, (uint64_t)sub_2198EFF24, v3);
                      if ((_DWORD)v43)
                      {
                        a2 = v43;
                        v6 = "Failed to Register phLibNfc_RelaydetectionNtfHandler";
                        goto LABEL_141;
                      }
LABEL_48:
                      v17 = v4 + 3;
                      v18 = phOsalNfc_Timer_Create();
                      *(_QWORD *)(v3 + 1448) = v18;
                      if (v18 == 0xFFFFFFFFFFFFLL || v18 == 0)
                      {
                        sub_219850628(1, v17, 4u, 4u, (uint64_t)"Timer Create Failed for pLibContext->tConnectCtx.dwConnectTimerId");
                        a2 = 12;
                      }
                      else
                      {
                        a2 = 0;
                      }
                      if (*(_BYTE *)(v3 + 3216))
                      {
                        *(_BYTE *)(v3 + 3216) = 0;
                        *(_WORD *)(v3 + 317) = 0;
                        *(_BYTE *)(v3 + 319) = 0;
                      }
                      else
                      {
                        *(_BYTE *)(v3 + 714) = 0;
                        sub_2198E1308(v3);
                        if (*(_BYTE *)(v3 + 317) == 2 && *(_BYTE *)(v3 + 318) == 2 && *(_BYTE *)(v3 + 319) == 2)
                        {
                          sub_219850628(1, v17, 4u, 4u, (uint64_t)"Init Comp- Static feature config");
                          a2 = sub_21989A264(v3);
                          if ((_DWORD)a2 != 13)
                          {
                            sub_219850628(1, v17, 4u, 1u, (uint64_t)"phLibNfc_InitializeComplete: Static feature config seq failed");
LABEL_128:
                            v24 = (unsigned int *)v3;
                            v25 = 255;
                            goto LABEL_129;
                          }
                          sub_219850628(1, v17, 4u, 4u, (uint64_t)"phLibNfc_InitializeComplete: Static feature config seq started");
                        }
                      }
                      v26 = 0;
                      v27 = 0;
                      do
                      {
                        v28 = *((_QWORD *)&unk_253E46700 + 14 * v27 + 2);
                        if ((v26 & 1) != 0)
                          break;
                        v26 = 1;
                        v27 = 1;
                      }
                      while (v28 != v3);
                      if (v28 == v3)
                      {
                        if (*(_BYTE *)(v3 + 3152) == 1)
                        {
                          if (*(_BYTE *)(v3 + 3155) != 1 && *(_QWORD *)(v3 + 6568))
                          {
                            sub_219853E34(1, v17, 4u, 4u, (uint64_t)"InitializeComplete :pGenericNtfCb[PLLUnlock]");
                            (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v3 + 6568))(*(_QWORD *)(v3 + 19360), *(_QWORD *)(v3 + 6576), 70, 0);
                          }
                          *(_BYTE *)(v3 + 3152) = 0;
                        }
                        if (*(_BYTE *)(v3 + 3153) == 1)
                        {
                          if (*(_BYTE *)(v3 + 3155) != 1 && *(_QWORD *)(v3 + 6568))
                          {
                            if (*(_BYTE *)(v3 + 2944) == 1)
                            {
                              sub_219853E34(1, v17, 4u, 4u, (uint64_t)"InitializeComplete :pGenericNtfCb[PLLLostlock]");
                              (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v3 + 6568))(*(_QWORD *)(v3 + 19360), *(_QWORD *)(v3 + 6576), 77, 0);
                            }
                            else
                            {
                              sub_219850628(1, v17, 4u, 1u, (uint64_t)"Unknown ntf is received, and dropped ");
                            }
                          }
                          *(_BYTE *)(v3 + 3153) = 0;
                        }
                        if (*(_BYTE *)(v3 + 3154) == 1)
                        {
                          if (*(_BYTE *)(v3 + 3155) != 1 && *(_QWORD *)(v3 + 6568))
                          {
                            sub_219853E34(1, v17, 4u, 4u, (uint64_t)"InitializeComplete :pGenericNtfCb[XTAL Start Error]");
                            (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v3 + 6568))(*(_QWORD *)(v3 + 19360), *(_QWORD *)(v3 + 6576), 90, 0);
                          }
                          *(_BYTE *)(v3 + 3154) = 0;
                        }
                        *(_BYTE *)(v3 + 3155) = 0;
                      }
                      goto LABEL_130;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LABEL_19:
  if ((_DWORD)a2 != 44 || *(unsigned __int8 *)(v3 + 3227) > 3u)
    goto LABEL_36;
  if (*(_BYTE *)(v3 + 3229) != 1)
  {
    a2 = 44;
    goto LABEL_36;
  }
  sub_21988F460(*(_QWORD *)(v3 + 2952), &v46);
  sub_21988EB80(*(_QWORD *)(v3 + 2952), &v45);
  ++*(_BYTE *)(v3 + 3227);
  *(_BYTE *)(v3 + 3230) = 0;
  *(_QWORD *)(v3 + 2912) = off_2550A11E0;
  *(_BYTE *)(v3 + 2904) = 0;
  *(_BYTE *)(v3 + 2906) = 0;
  v7 = (char)off_2550A11E0[0];
  if (off_2550A11E0[0])
  {
    v7 = 0;
    v8 = off_2550A11F0;
    do
    {
      ++v7;
      v9 = *v8;
      v8 += 2;
    }
    while (v9);
  }
  *(_BYTE *)(v3 + 2905) = v7;
  v10 = sub_2198655FC(v3, 0, v3 + 3230);
  a2 = v10;
  if ((_DWORD)v10 != 13)
  {
    if ((_DWORD)v10 == 179)
    {
      if (!*(_BYTE *)(v3 + 3227))
      {
        a2 = 179;
        goto LABEL_130;
      }
      sub_219897050(v3);
      if (*(_DWORD *)(v3 + 3176) == 1)
      {
        v11 = phTmlNfc_IoCtl();
        if (v11)
          goto LABEL_56;
        v11 = sub_2198972CC(v4[3], *(_QWORD *)(v3 + 2952));
      }
      else
      {
        v11 = phTmlNfc_IoCtl();
      }
      if (v11)
      {
LABEL_56:
        if (v11 == 13)
        {
LABEL_57:
          a2 = 13;
          goto LABEL_130;
        }
        goto LABEL_127;
      }
      sub_21988ED38(*(_QWORD *)(v3 + 2952), &v44);
      sub_2198C1984(*(_QWORD *)(v3 + 2952), v44);
      sub_21988EB80(*(_QWORD *)(v3 + 2952), &v45);
      sub_21988F460(*(_QWORD *)(v3 + 2952), &v46);
      v15 = "phLibNfc_InitializeComplete : Retrieve download/ioctl context failed!!";
      if (v46 && v45)
      {
        if (sub_219905DA0(*(_QWORD *)(v46 + 56)) == 13)
        {
          v29 = v45;
          *(_BYTE *)(v45 + 67) = 1;
          *(_WORD *)(v29 + 64) = 0;
          *(_QWORD *)(v3 + 2912) = off_2550A2EE8;
          *(_BYTE *)(v3 + 2904) = 0;
          *(_BYTE *)(v3 + 2906) = 0;
          v21 = (char)off_2550A2EE8[0];
          if (off_2550A2EE8[0])
          {
            v21 = 0;
            v30 = &qword_2550A2EF8;
            do
            {
              ++v21;
              v31 = *v30;
              v30 += 2;
            }
            while (v31);
          }
LABEL_73:
          *(_BYTE *)(v3 + 2905) = v21;
          v11 = sub_2198655FC(v3, 0, 0);
          goto LABEL_56;
        }
        v15 = "phLibNfc_InitializeComplete : Initial Dwnld TML read request failed!!";
      }
      v16 = (unsigned int *)(v3 + 19368);
      goto LABEL_126;
    }
    sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phLibNfc_InitializeComplete: HW Workaround - Retry failed");
    goto LABEL_76;
  }
LABEL_130:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_InitializeComplete");
  return a2;
}

uint64_t sub_219894884(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ReInitDisableNfceeDisc");
  if (a1 && *(_DWORD *)(a1 + 456) == 1)
  {
    *(_WORD *)(a1 + 504) = 0;
    *(_BYTE *)(a1 + 506) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"ReInitDisableNfceeDisc: Stopping NFCEE Discovery");
    v2 = sub_2198FC2D0(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v2 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ReInitDisableNfceeDisc");
  return v2;
}

uint64_t sub_219894934(unsigned int *a1, uint64_t a2)
{
  unsigned int *v4;
  const char *v5;
  int v6;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessNfceeStopDisc");
  if (a1)
  {
    v4 = a1 + 4842;
    if (!(_DWORD)a2)
    {
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"NFCEE Discovery successfully stopped");
      a1[114] = 0;
      goto LABEL_7;
    }
    v5 = "Failed to stop NFCEE Discovery (phLibNfc_ProcessNfceeStopDisc)";
    v6 = 1;
  }
  else
  {
    v5 = "Failed to start NFCEE Discovery (phLibNfc_ProcessNfceeStopDisc)";
    v6 = 2;
    v4 = 0;
  }
  sub_219850628(v6, v4, 4u, 1u, (uint64_t)v5);
LABEL_7:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessNfceeStopDisc");
  return a2;
}

uint64_t sub_2198949EC(unsigned int *a1, int a2)
{
  uint64_t v3;
  uint64_t v4;
  unsigned int *v5;
  uint64_t v6;
  unsigned int v7;
  char v8;
  uint64_t (**v9)();
  uint64_t (*v10)();

  v3 = (uint64_t)a1;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ReInitializeComplete");
  if (a2)
    v4 = 255;
  else
    v4 = 0;
  if (!v3 || a2)
  {
    if (!v3
      || a2 != 44
      || (v7 = *(unsigned __int8 *)(v3 + 3227), v7 > 3)
      || *(_BYTE *)(v3 + 3229) != 1
      || *(_BYTE *)(v3 + 2884) != 1)
    {
      v5 = (unsigned int *)v3;
      v6 = 137;
      goto LABEL_22;
    }
    *(_BYTE *)(v3 + 3227) = v7 + 1;
    *(_QWORD *)(v3 + 2912) = off_2550A10F0;
    *(_BYTE *)(v3 + 2904) = 0;
    *(_BYTE *)(v3 + 2906) = 0;
    v8 = (char)off_2550A10F0[0];
    if (off_2550A10F0[0])
    {
      v8 = 0;
      v9 = off_2550A1100;
      do
      {
        ++v8;
        v10 = *v9;
        v9 += 2;
      }
      while (v10);
    }
    *(_BYTE *)(v3 + 2905) = v8;
    v4 = sub_2198655FC(v3, 0, 0);
    if ((_DWORD)v4 != 13)
    {
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"gphLibNfc_ReInitSequence: Retry failed");
      sub_21987BAC0(v3, 255);
      v5 = (unsigned int *)v3;
      v6 = v4;
      goto LABEL_22;
    }
  }
  else
  {
    *(_BYTE *)(v3 + 314) = 1;
    *(_QWORD *)(v3 + 368) = 0x100000005;
    *(_QWORD *)(v3 + 360) = 0;
    *(_BYTE *)(v3 + 485) = 0;
    *(_BYTE *)(v3 + 714) = 0;
    sub_2198E1308(v3);
    if (*(_BYTE *)(v3 + 317) == 2 && *(_BYTE *)(v3 + 318) == 2 && *(_BYTE *)(v3 + 319) == 2)
    {
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"Re- Init Comp- Static feature config");
      v4 = sub_21989A264(v3);
      if ((_DWORD)v4 != 13)
      {
        sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phLibNfc_ReInitializeComplete: Static feature config seq failed");
        v5 = (unsigned int *)v3;
        v6 = 255;
LABEL_22:
        sub_219898F04(v5, v6);
        v3 = 0;
      }
    }
  }
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_ReInitializeComplete");
  return v4;
}

uint64_t sub_219894BF4(uint64_t a1)
{
  uint64_t v2;
  _OWORD v4[9];
  uint64_t v5;
  __int128 v6;
  __int128 v7;
  __int128 v8;
  __int128 v9;
  __int128 v10;
  __int128 v11;
  __int128 v12;
  __int128 v13;
  __int128 v14;
  __int128 v15;
  __int128 v16;
  __int128 v17;
  __int128 v18;
  __int128 v19;
  __int128 v20;
  __int128 v21;
  __int128 v22;
  __int128 v23;
  __int128 v24;
  __int128 v25;
  __int128 v26;
  __int128 v27;
  __int128 v28;
  __int128 v29;
  __int128 v30;
  __int128 v31;
  __int128 v32;
  __int128 v33;
  __int128 v34;
  __int128 v35;
  __int128 v36;
  __int128 v37;
  uint64_t v38;

  v38 = *MEMORY[0x24BDAC8D0];
  v36 = 0u;
  v37 = 0u;
  v34 = 0u;
  v35 = 0u;
  v32 = 0u;
  v33 = 0u;
  v30 = 0u;
  v31 = 0u;
  v28 = 0u;
  v29 = 0u;
  v26 = 0u;
  v27 = 0u;
  v24 = 0u;
  v25 = 0u;
  v22 = 0u;
  v23 = 0u;
  v20 = 0u;
  v21 = 0u;
  v18 = 0u;
  v19 = 0u;
  v16 = 0u;
  v17 = 0u;
  v14 = 0u;
  v15 = 0u;
  v12 = 0u;
  v13 = 0u;
  v10 = 0u;
  v11 = 0u;
  v8 = 0u;
  v9 = 0u;
  v6 = 0u;
  v7 = 0u;
  v5 = 0;
  memset(v4, 0, sizeof(v4));
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetAssertInfo");
  if (a1)
  {
    phOsalNfc_SetMemory();
    BYTE8(v4[0]) = 39;
    *(_QWORD *)&v4[0] = 0xA01CA01BA01AA004;
    v2 = sub_2198FD738(*(_QWORD *)(a1 + 3040), (uint64_t)v4, 9, (uint64_t)sub_219865DD0, a1);
    if ((_DWORD)v2 == 13)
      phOsalNfc_SetMemory();
    else
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_GetAssertInfo: Invalid Status");
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetAssertInfo");
  return v2;
}

uint64_t sub_219894D7C(unsigned int *a1, int a2, unsigned __int8 *a3)
{
  unsigned int *v6;
  const char *v7;
  int v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;
  _OWORD v13[6];
  uint64_t v14;

  v14 = *MEMORY[0x24BDAC8D0];
  v11 = 0;
  v12 = 0;
  memset(v13, 0, sizeof(v13));
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetAssertInfoProc");
  if (!a1 || !a3)
  {
    v7 = "phLibNfc_GetAssertInfoProc:Context is Null";
    v8 = 2;
    v6 = a1;
    goto LABEL_6;
  }
  if (a2)
  {
    v6 = a1 + 4842;
    v7 = "phLibNfc_GetAssertInfoProc: Status Failed!";
    v8 = 1;
LABEL_6:
    sub_219850628(v8, v6, 4u, 1u, (uint64_t)v7);
    v9 = 255;
    goto LABEL_7;
  }
  v9 = sub_2198EF464((uint64_t)a1, a3, (_DWORD *)&v12 + 1, &v12, (_DWORD *)&v11 + 1, &v11);
  if (!(_DWORD)v9)
  {
    if (HIDWORD(v12))
    {
      phOsalNfc_MemCopy();
      sub_219851888(1, a1 + 4842, 4u, 1u, (uint64_t)"Assert Reg Program Counter");
    }
    if ((_DWORD)v12)
    {
      phOsalNfc_SetMemory();
      phOsalNfc_MemCopy();
      sub_21987ACB4((uint64_t)a1, (uint64_t)(a1 + 29), (uint64_t)v13);
    }
    if (HIDWORD(v11))
    {
      phOsalNfc_SetMemory();
      phOsalNfc_MemCopy();
      sub_21987B550((uint64_t)a1, (uint64_t)(a1 + 64), (uint64_t)v13);
    }
    if ((_DWORD)v11)
    {
      phOsalNfc_SetMemory();
      phOsalNfc_MemCopy();
      sub_21987B2A8(a1[4842], (uint64_t)(a1 + 53), (uint64_t)v13);
    }
    v9 = 0;
  }
LABEL_7:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetAssertInfoProc");
  return v9;
}

uint64_t sub_219894FF4(uint64_t a1, int a2)
{
  uint64_t v4;
  uint64_t v5;
  void (*v6)(_QWORD, uint64_t, uint64_t);
  uint64_t v7;
  char v8;
  uint64_t v9;
  uint64_t v10;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RecoverySeqComplete");
  if (a2)
    v4 = 255;
  else
    v4 = 0;
  if (a1)
  {
    v5 = *(unsigned __int16 *)(a1 + 19356);
    if ((v5 & 0xFFFE) == 0x88)
    {
      *(_WORD *)(a1 + 19356) = 0;
      v4 = v5;
    }
    v6 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 6120);
    v7 = *(_QWORD *)(a1 + 6128);
    *(_QWORD *)(a1 + 6128) = 0;
    *(_QWORD *)(a1 + 6120) = 0;
    if (v6)
      v6(*(_QWORD *)(a1 + 19360), v7, v4);
    v8 = 0;
    v9 = 0;
    do
    {
      v10 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 2);
      if ((v8 & 1) != 0)
        break;
      v8 = 1;
      v9 = 1;
    }
    while (v10 != a1);
    if (v10 == a1 && *(_QWORD *)(a1 + 288))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 288) = 0;
      *(_DWORD *)(a1 + 296) = 0;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RecoverySeqComplete");
  return v4;
}

uint64_t sub_2198950F8(uint64_t a1)
{
  int v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetStandbyMode");
  if (a1)
  {
    if (*(_BYTE *)(a1 + 2883) == 1 && *(_BYTE *)(a1 + 4) == 1)
      v2 = *(unsigned __int8 *)(a1 + 3);
    else
      v2 = 1;
    *(_BYTE *)(a1 + 1) = v2;
    v3 = sub_2198FC704(*(_QWORD *)(a1 + 3040), v2, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v3 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetStandbyMode");
  return v3;
}

uint64_t sub_21989519C(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  int v8;
  unsigned int *v9;
  const char *v10;
  int v11;
  unsigned int *v12;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeDisableESE");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 2);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 != a1)
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a1, 4u, 4u, (uint64_t)"phLibNfc_NfceeDisableESE:Invalid Context");
    v5 = 1;
    goto LABEL_7;
  }
  v7 = *(_QWORD *)(a1 + 392);
  if (!v7)
  {
    *(_DWORD *)(a1 + 544) = 0;
    v9 = (unsigned int *)(a1 + 19368);
    v10 = "phLibNfc_NfceeDisableESE: Secure Elemnet Handle not available";
    goto LABEL_13;
  }
  v8 = *(_DWORD *)(a1 + 404);
  if (v8 == 1 || v8 == 4)
  {
    *(_DWORD *)(a1 + 544) = 0;
    v9 = (unsigned int *)(a1 + 19368);
    v10 = "phLibNfc_NfceeDisableESE: Secure Elemnet Already disabled";
LABEL_13:
    sub_219850628(1, v9, 4u, 4u, (uint64_t)v10);
    v5 = 0;
    goto LABEL_7;
  }
  if (*(uint64_t **)(a1 + 2912) != &qword_2550A1370
    && (*(_BYTE *)(a1 + 2937) == 1 || *(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2944) == 1))
  {
    v5 = 0;
    *(_DWORD *)(a1 + 404) = 1;
    *(_BYTE *)(a1 + 697) = 0;
  }
  else
  {
    v11 = sub_2198FC458(*(_QWORD *)(a1 + 3040), v7, 0, (uint64_t)sub_219865DD0, a1);
    if (v11 == 13)
    {
      *(_QWORD *)(a1 + 512) = a1 + 392;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_NfceeDisableESE:Cmd Sent to lower layer");
      v5 = 13;
    }
    else
    {
      v12 = (unsigned int *)(a1 + 19368);
      if (v11 == 111)
      {
        sub_219850628(1, v12, 4u, 2u, (uint64_t)"phLibNfc_NfceeDisableESE: Busy stats returned from NCI");
        v5 = 111;
      }
      else
      {
        sub_219851888(1, v12, 4u, 1u, (uint64_t)"phLibNfc_NfceeDisableESE: Failed to Disable ESE,error");
        v5 = 255;
      }
    }
  }
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeDisableESE");
  return v5;
}

uint64_t sub_2198953A0(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  int v9;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeDisableProc");
  if (a1)
  {
    v4 = 0;
    v5 = 0;
    do
    {
      v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 2);
      if ((v4 & 1) != 0)
        break;
      v4 = 1;
      v5 = 1;
    }
    while (v6 != a1);
    if (v6 == a1)
    {
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_NfceeDisableProc wStatus");
      v8 = *(_QWORD *)(a1 + 512);
      if (v8)
      {
        v9 = *(_DWORD *)(v8 + 8);
        switch(v9)
        {
          case 7:
            *(_DWORD *)(a1 + 420) = 1;
            break;
          case 2:
            *(_DWORD *)(a1 + 388) = 1;
            break;
          case 1:
            *(_DWORD *)(a1 + 404) = 1;
            *(_BYTE *)(a1 + 697) = 0;
            break;
        }
        if (*(_BYTE *)(a1 + 2936) == 1)
        {
          *(_DWORD *)(a1 + 544) = 1200;
          *(_BYTE *)(a1 + 2881) = 0;
        }
        else
        {
          *(_DWORD *)(a1 + 544) = 0;
        }
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_NfceeDisableProc Invalid pActiveSeInfo");
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeDisableProc");
  return a2;
}

uint64_t sub_2198954F0(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  int v8;
  unsigned int *v9;
  const char *v10;
  int v11;
  unsigned int *v12;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeDisableUICC");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 2);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 != a1)
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a1, 4u, 4u, (uint64_t)"phLibNfc_NfceeDisableUICC:Invalid Context");
LABEL_7:
    v5 = 1;
    goto LABEL_8;
  }
  v7 = *(_QWORD *)(a1 + 376);
  if (!v7)
  {
    *(_DWORD *)(a1 + 544) = 0;
    v9 = (unsigned int *)(a1 + 19368);
    v10 = "phLibNfc_NfceeDisableUICC:Secure Elemnet Handle not available";
    goto LABEL_14;
  }
  v8 = *(_DWORD *)(a1 + 388);
  if (v8 == 1)
    goto LABEL_7;
  if (v8 == 4)
  {
    *(_DWORD *)(a1 + 544) = 0;
    v9 = (unsigned int *)(a1 + 19368);
    v10 = "phLibNfc_NfceeDisableUICC: Secure Elemnet removed ";
LABEL_14:
    sub_219850628(1, v9, 4u, 4u, (uint64_t)v10);
    v5 = 0;
    goto LABEL_8;
  }
  v11 = sub_2198FC458(*(_QWORD *)(a1 + 3040), v7, 0, (uint64_t)sub_219865DD0, a1);
  if (v11 == 13)
  {
    *(_QWORD *)(a1 + 512) = a1 + 376;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_NfceeDisableUICC:Cmd Sent to lower layer");
    v5 = 13;
  }
  else
  {
    v12 = (unsigned int *)(a1 + 19368);
    if (v11 == 111)
    {
      sub_219850628(1, v12, 4u, 2u, (uint64_t)"phLibNfc_NfceeDisableUICC: Busy stats returned from NCI");
      v5 = 111;
    }
    else
    {
      sub_219851888(1, v12, 4u, 1u, (uint64_t)"phLibNfc_NfceeDisableUICC: Failed to Disable UICC,error");
      v5 = 255;
    }
  }
LABEL_8:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeDisableUICC");
  return v5;
}

uint64_t sub_2198956A8(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  int v7;
  unsigned int *v8;
  const char *v9;
  int v10;
  unsigned int *v11;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeDisableSE2");
  if (a1)
  {
    v2 = 0;
    v3 = 0;
    do
    {
      v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 2);
      if ((v2 & 1) != 0)
        break;
      v2 = 1;
      v3 = 1;
    }
    while (v4 != a1);
    if (v4 == a1)
    {
      v6 = *(_QWORD *)(a1 + 408);
      if (v6)
      {
        v7 = *(_DWORD *)(a1 + 420);
        if (v7 == 1)
        {
          v5 = 1;
          goto LABEL_19;
        }
        if (v7 != 4)
        {
          v10 = sub_2198FC458(*(_QWORD *)(a1 + 3040), v6, 0, (uint64_t)sub_219865DD0, a1);
          if (v10 == 13)
          {
            *(_QWORD *)(a1 + 512) = a1 + 408;
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_NfceeDisableSE2:Cmd Sent to lower layer");
            v5 = 13;
          }
          else
          {
            v11 = (unsigned int *)(a1 + 19368);
            if (v10 == 111)
            {
              sub_219850628(1, v11, 4u, 2u, (uint64_t)"phLibNfc_NfceeDisableSE2: Busy stats returned from NCI");
              v5 = 111;
            }
            else
            {
              sub_219851888(1, v11, 4u, 1u, (uint64_t)"phLibNfc_NfceeDisableSE2: Failed to Disable SE2,error");
              v5 = 255;
            }
          }
          goto LABEL_19;
        }
        *(_DWORD *)(a1 + 544) = 0;
        v8 = (unsigned int *)(a1 + 19368);
        v9 = "phLibNfc_NfceeDisableSE2: Secure Elemnet Already disabled";
      }
      else
      {
        v8 = (unsigned int *)(a1 + 19368);
        v9 = "phLibNfc_NfceeDisableSE2:Secure Elemnet Handle not available";
      }
      sub_219850628(1, v8, 4u, 4u, (uint64_t)v9);
      v5 = 0;
LABEL_19:
      *(_DWORD *)(a1 + 544) = 0;
      *(_BYTE *)(a1 + 2881) = 0;
      goto LABEL_20;
    }
  }
  sub_219850628(2, (unsigned int *)a1, 4u, 4u, (uint64_t)"phLibNfc_NfceeDisableSE2:Invalid Context");
  v5 = 1;
LABEL_20:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeDisableSE2");
  return v5;
}

uint64_t sub_21989586C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FlushSramData");
  sub_219865494(*(_QWORD *)(a1 + 3040), 0);
  if (*(_BYTE *)(a1 + 2937) == 1 || *(_BYTE *)(a1 + 2938) == 1 || *(_BYTE *)(a1 + 2944) == 1)
    v2 = sub_219900CD4(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
  else
    v2 = 0;
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FlushSramData");
  return v2;
}

uint64_t sub_219895914(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_FlushSramDataProcess");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_FlushSramDataProcess");
  return a2;
}

uint64_t sub_219895978(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  BOOL v5;
  uint64_t v6;
  int *v8;
  int v9;
  unsigned int *v10;

  v3 = (uint64_t)a1;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_staticFeatureCfgComplete");
  if (!v3)
    goto LABEL_12;
  *(_WORD *)(v3 + 704) = 0;
  *(_BYTE *)(v3 + 696) = 0;
  v4 = *(_QWORD *)(v3 + 2888);
  if (v4)
    v5 = v4 == 0xFFFFFFFFFFFFLL;
  else
    v5 = 1;
  if (!v5)
  {
    phOsalNfc_Timer_Stop();
    sub_21988629C(1, (unsigned int *)(v3 + 19368), *(_QWORD *)(v3 + 2888), 4u, 4u, (uint64_t)"phLibNfc_staticFeatureCfgComplete");
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(v3 + 2888) = 0;
    v8 = &dword_253E47158;
    if (!*(_DWORD *)(v3 + 19368))
      v8 = &dword_253E47070;
    v8[1] &= ~0x2000000u;
    if (!(_DWORD)a2)
      goto LABEL_16;
LABEL_8:
    if (*(_BYTE *)(v3 + 2883) == 1)
      v6 = 137;
    else
      v6 = 255;
    goto LABEL_11;
  }
  if ((_DWORD)a2)
    goto LABEL_8;
LABEL_16:
  sub_219850718(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_VerifySEStatus");
  if (*(_QWORD *)(v3 + 6056))
  {
    if (*(_DWORD *)(v3 + 440))
    {
      v9 = *(unsigned __int8 *)(v3 + 318);
      if (v9 != 2 && ((((v9 - 3) < 0xFFFFFFFE) ^ ((*(_DWORD *)(v3 + 440) & 2u) >> 1)) & 1) == 0)
        goto LABEL_20;
    }
  }
  else if ((*(_BYTE *)(v3 + 318) != 1) == (*(_BYTE *)(v3 + 440) & 2) >> 1)
  {
LABEL_20:
    sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_VerifySEStatus");
    a2 = 255;
    if (*(_BYTE *)(v3 + 2883) == 1)
      v6 = 137;
    else
      v6 = 255;
LABEL_11:
    sub_219898F04((unsigned int *)v3, v6);
    v3 = 0;
    goto LABEL_12;
  }
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_VerifySEStatus");
  *(_BYTE *)(v3 + 2883) = 0;
  if (*(_BYTE *)(v3 + 3152) == 1)
  {
    if (!*(_BYTE *)(v3 + 3155) && *(_QWORD *)(v3 + 6568))
    {
      sub_219853E34(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"staticFeatureCfgComplete :pGenericNtfCb[PLLUnlock]");
      (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v3 + 6568))(*(_QWORD *)(v3 + 19360), *(_QWORD *)(v3 + 6576), 70, 0);
    }
    *(_BYTE *)(v3 + 3152) = 0;
  }
  if (*(_BYTE *)(v3 + 3153) == 1)
  {
    if (!*(_BYTE *)(v3 + 3155) && *(_QWORD *)(v3 + 6568))
    {
      v10 = (unsigned int *)(v3 + 19368);
      if (*(_BYTE *)(v3 + 2944) == 1)
      {
        sub_219853E34(1, v10, 4u, 4u, (uint64_t)"staticFeatureCfgComplete :pGenericNtfCb[PLLLostlock]");
        (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v3 + 6568))(*(_QWORD *)(v3 + 19360), *(_QWORD *)(v3 + 6576), 77, 0);
      }
      else
      {
        sub_219850628(1, v10, 4u, 1u, (uint64_t)"Unknown ntf is received, and dropped ");
      }
    }
    *(_BYTE *)(v3 + 3153) = 0;
  }
  if (*(_BYTE *)(v3 + 3154) == 1)
  {
    if (*(_BYTE *)(v3 + 3155) != 1 && *(_QWORD *)(v3 + 6568))
    {
      sub_219853E34(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"staticFeatureCfgComplete :pGenericNtfCb[XTAL Start Error]");
      (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v3 + 6568))(*(_QWORD *)(v3 + 19360), *(_QWORD *)(v3 + 6576), 90, 0);
    }
    *(_BYTE *)(v3 + 3154) = 0;
  }
  *(_BYTE *)(v3 + 3155) = 0;
  a2 = sub_2198D1B2C(*(_QWORD *)(v3 + 19360), 145, 0, v3 + 19360, v3);
  if (!(_DWORD)a2)
    sub_2198AA6B0(v3);
LABEL_12:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_staticFeatureCfgComplete");
  return a2;
}

uint64_t sub_219895CC4(uint64_t a1, uint64_t a2, unsigned __int8 *a3)
{
  unsigned int v5;
  int *v6;
  BOOL v7;
  uint64_t v8;
  const char *v9;
  int v10;
  unsigned int *v11;
  uint64_t v12;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetRtngTableCfgs");
  if (!a1)
  {
    v9 = "Error: Routing table can only be configured in Initialized state";
    v8 = 1;
    v10 = 2;
    v11 = 0;
LABEL_9:
    sub_219850628(v10, v11, 4u, 1u, (uint64_t)v9);
    goto LABEL_12;
  }
  v5 = *a3;
  v6 = *(int **)(a1 + 328);
  if (v6)
    v7 = v5 == 0;
  else
    v7 = 1;
  if (v7)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Error: Routing table Buffer is invalid or No Routing Entries");
    v8 = 255;
    goto LABEL_12;
  }
  v12 = sub_2198FDC40(*(_QWORD *)(a1 + 3040), v5, v6);
  v8 = v12;
  if (!(_DWORD)v12)
  {
    v8 = sub_2198F7A7C(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, (char *)(a1 + 336), a1);
    if ((_DWORD)v8 != 13)
    {
      v11 = (unsigned int *)(a1 + 19368);
      v9 = "Set Rtng Config Sequence failed!";
      v10 = 1;
      goto LABEL_9;
    }
  }
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetRtngTableCfgs");
  return v8;
}

uint64_t sub_219895DD0(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ConfigRoutingTableProc");
  if ((_DWORD)a2)
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"phLibNfc_ConfigRoutingTableProc: Routing Table configuration failed");
  else
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"phLibNfc_ConfigRoutingTableMoreProc: Routing Table configuration success");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ConfigRoutingTableProc");
  return a2;
}

uint64_t sub_219895E70(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetRtngTableCfgsMore");
  if (!(_DWORD)a2)
  {
    if (a1 && *(_BYTE *)(a1 + 336) == 1)
      a2 = sub_2198F7A7C(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, (char *)(a1 + 336), a1);
    else
      a2 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetRtngTableCfgsMore");
  return a2;
}

uint64_t sub_219895F04(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ConfigRoutingTableMoreProc");
  if (!a1 || (_DWORD)a2)
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phLibNfc_ConfigRoutingTableProc: Routing Table configuration failed");
  }
  else if (*(_BYTE *)(a1 + 336) == 1)
  {
    sub_219866158(a1, *(_QWORD *)(a1 + 2912), 1u);
  }
  else
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_ConfigRoutingTableProc: Routing Table configuration success");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ConfigRoutingTableMoreProc");
  return a2;
}

uint64_t sub_219895FC8(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ConfigRoutingTableComplete");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 328))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 328) = 0;
    }
    if ((_DWORD)a2)
      v4 = 146;
    else
      v4 = 145;
    v5 = sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v4, a2, 0, 0);
  }
  else
  {
    v5 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ConfigRoutingTableComplete");
  return v5;
}

uint64_t sub_21989606C(unsigned __int8 *a1)
{
  int v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetPowerMode");
  if (a1)
  {
    v2 = a1[1];
    if (*a1 == v2)
    {
      a1[2] = 1;
      sub_219850628(1, (unsigned int *)a1 + 4842, 4u, 4u, (uint64_t)"phLibNfc_SetPowerMode: Power mode already enabled");
      v3 = 0;
    }
    else
    {
      v3 = sub_2198FC704(*((_QWORD *)a1 + 380), v2, (uint64_t)sub_219865DD0, (uint64_t)a1);
    }
  }
  else
  {
    v3 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetPowerMode");
  return v3;
}

uint64_t sub_219896128(uint64_t a1, uint64_t a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetPowerModeComplete");
  if (a1 && !(_DWORD)a2)
  {
    *(_BYTE *)(a1 + 3) = *(_BYTE *)a1;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_SetPowerModeComplete: Success");
    v4 = 145;
LABEL_6:
    a2 = sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v4, a2, 0, 0);
    goto LABEL_7;
  }
  sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phLibNfc_SetPowerModeComplete: Failed");
  if (a1)
  {
    v4 = 146;
    goto LABEL_6;
  }
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SetPowerModeComplete");
  return a2;
}

uint64_t sub_2198961F8(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeInitialize");
  if (a1)
    a2 = sub_2198FF49C(*(unsigned int **)(a1 + 3040), 0, (uint64_t)sub_219865DD0, a1);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeInitialize");
  return a2;
}

uint64_t sub_219896274(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_DeInitializeProcess");
  if ((_DWORD)a2)
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"phLibNfc_DeInitializeProcess: MW DeInitialization failed");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_DeInitializeProcess");
  return a2;
}

uint64_t sub_2198962F0(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeInitializeComplete");
  if (a1)
  {
    if (*(_DWORD *)(a1 + 3176) == 1)
    {
      if (!(_DWORD)a2)
        goto LABEL_11;
      goto LABEL_10;
    }
    if (!(_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"De-Init is sucessfull");
      v4 = a1;
      v5 = 0;
      goto LABEL_12;
    }
    if ((_DWORD)a2 != 81)
    {
LABEL_10:
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_DeInitializeComplete: MW DeInitialization failed");
LABEL_11:
      sub_2198FF49C(*(unsigned int **)(a1 + 3040), 2, 0, a1);
      *(_QWORD *)(a1 + 3040) = 0;
      v4 = a1;
      v5 = a2;
LABEL_12:
      sub_21989AC58(v4, v5);
      goto LABEL_13;
    }
    a2 = sub_2198FF49C(*(unsigned int **)(a1 + 3040), 0, (uint64_t)sub_21989AC58, a1);
    if ((_DWORD)a2 != 13)
      goto LABEL_11;
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_DeInitializeComplete: Invalid LIBNFC Context");
    a2 = 255;
  }
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeInitializeComplete");
  return a2;
}

uint64_t sub_21989642C(uint64_t a1)
{
  const char *v2;
  uint64_t v3;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SpmiRstCrcConfig");
  if (a1)
  {
    if (sub_2198972CC(*(unsigned int *)(a1 + 19368), *(_QWORD *)(a1 + 2952)))
    {
      v2 = "phLibNfc_SpmiRstCrcConfig: Spmi Client reset failed";
    }
    else
    {
      v5 = *(_QWORD *)(a1 + 3040);
      if (v5)
      {
        phTmlNfc_ReadAbort();
        phTmlNfc_FlushTxRxBuffers();
        v6 = v5 + 888;
        sub_219853908(v6);
        phTmlNfc_IoCtl();
        sub_2199013F4(*(_QWORD *)(a1 + 3040), 0);
        sub_21990135C(*(_QWORD *)(a1 + 3040), 0);
        if (sub_219851DC0(v6, 0, 3) == 13)
        {
          v3 = 0;
          *(_WORD *)a1 = 256;
          goto LABEL_8;
        }
        v2 = "phLibNfc_SpmiRstCrcConfig: Tml Read Request Failed";
      }
      else
      {
        v2 = "phLibNfc_SpmiRstCrcConfig: Invalid NCI context";
      }
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v2);
    if (*(_DWORD *)(a1 + 3176) == 1)
      v3 = 288;
    else
      v3 = 255;
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_SpmiRstCrcConfig: Invalid input parameters");
    v3 = 255;
  }
LABEL_8:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SpmiRstCrcConfig");
  return v3;
}

uint64_t sub_219896584(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CoreResetCmd");
  if (a1)
    v2 = sub_219902088(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
  else
    v2 = 1;
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CoreResetCmd");
  return v2;
}

uint64_t sub_219896600(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessCoreResetRsp");
  if ((_DWORD)a2)
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"phLibNfc_ProcessCoreResetRsp:Core reset response failed");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessCoreResetRsp");
  return a2;
}

uint64_t sub_21989667C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CoreInitCmd");
  if (a1)
    v2 = sub_2199021B8(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
  else
    v2 = 1;
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CoreInitCmd");
  return v2;
}

uint64_t sub_2198966F8(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessCoreInitRsp");
  if ((_DWORD)a2)
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"phLibNfc_ProcessCoreInitRsp:Core init response failed");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessCoreInitRsp");
  return a2;
}

uint64_t sub_219896774(unsigned int *a1, int a2, int a3)
{
  uint64_t v6;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_Retrive_TagId");
  if (a1 && word_2550A0E78[5 * a2 + a3] == 1)
    v6 = word_2550A0E78[5 * a2];
  else
    v6 = 0;
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_Retrive_TagId");
  return v6;
}

uint64_t sub_219896814(uint64_t a1, unsigned int a2)
{
  unsigned int *v4;
  int v5;
  int v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Get_TagIds");
  if (!a1)
    goto LABEL_18;
  if (*(_BYTE *)(a1 + 2936) == 1)
  {
    if (a2 == 1)
    {
      v4 = (unsigned int *)a1;
      v5 = 1;
      v6 = 1;
LABEL_17:
      v7 = sub_219896774(v4, v5, v6);
      goto LABEL_19;
    }
    v6 = 1;
    goto LABEL_15;
  }
  if (*(_BYTE *)(a1 + 2937) == 1)
  {
    v6 = 2;
    goto LABEL_10;
  }
  if (*(_BYTE *)(a1 + 2938) == 1)
  {
    v6 = 3;
LABEL_10:
    if (a2 == 1)
      goto LABEL_11;
LABEL_15:
    if (a2 <= 0x2C)
    {
      v4 = (unsigned int *)a1;
      v5 = a2;
      goto LABEL_17;
    }
LABEL_18:
    v7 = 0;
    goto LABEL_19;
  }
  if (*(_BYTE *)(a1 + 2944) != 1)
    goto LABEL_18;
  if (a2 != 1)
  {
    v6 = 4;
    goto LABEL_15;
  }
LABEL_11:
  v7 = 40977;
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Get_TagIds");
  return v7;
}

uint64_t sub_21989690C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_NfccResetRecoveryCb");
  sub_21988EDF4(v13, &v12);
  if (v12)
  {
    sub_21988EB80(v13, &v11);
    if (v11)
    {
      if (*(_QWORD *)(v12 + 6056) || *(_QWORD *)(v11 + 24))
      {
        v5 = 146;
      }
      else if (*(_QWORD *)(v12 + 6072))
      {
        v5 = 146;
      }
      else
      {
        v5 = 145;
      }
      sub_2198D1B2C(*(_QWORD *)(v12 + 19360), v5, a3, a2, 0);
      v6 = v12;
      if (v12)
      {
        v7 = 0;
        v8 = 0;
        do
        {
          v9 = *((_QWORD *)&unk_253E46700 + 14 * v8 + 2);
          if ((v7 & 1) != 0)
            break;
          v7 = 1;
          v8 = 1;
        }
        while (v9 != v12);
        if (v9 == v12 && *(_BYTE *)(v12 + 19374) == 1)
        {
          *(_BYTE *)(v12 + 19374) = 0;
          if (sub_219896A60(v13, v6) != 13)
            sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"phLibNfc_NfccResetRecoveryCb : Failed to resume Deinitialize!");
        }
      }
    }
  }
  return sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_NfccResetRecoveryCb");
}

uint64_t sub_219896A60(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  _QWORD *v5;
  uint64_t v6;
  BOOL v7;
  uint64_t v8;
  BOOL v9;
  uint64_t v10;
  uint64_t v11;
  void (*v12)(uint64_t, _QWORD, uint64_t);
  char v13;
  uint64_t v14;
  uint64_t v15;
  int v17;
  uint64_t v18;

  v18 = a1;
  v17 = 0;
  sub_219850718(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_ResumeDeinit");
  if (a2)
  {
    v3 = *(_QWORD *)(a2 + 1448);
    if (v3 && v3 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 1448) = 0xFFFFFFFFFFFFLL;
    }
    v4 = *(_QWORD *)(a2 + 720);
    if (v4 && v4 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 720) = 0xFFFFFFFFFFFFLL;
    }
    v5 = *(_QWORD **)(a2 + 464);
    if (v5)
    {
      v6 = v5[105];
      if (v6)
        v7 = v6 == 0xFFFFFFFFFFFFLL;
      else
        v7 = 1;
      if (!v7)
      {
        phOsalNfc_Timer_Stop();
        phOsalNfc_Timer_Delete();
        v5[105] = 0xFFFFFFFFFFFFLL;
      }
      v8 = v5[107];
      if (v8)
        v9 = v8 == 0xFFFFFFFFFFFFLL;
      else
        v9 = 1;
      if (!v9)
      {
        phOsalNfc_Timer_Stop();
        phOsalNfc_Timer_Delete();
        v5[107] = 0xFFFFFFFFFFFFLL;
      }
      v10 = v5[109];
      if (v10 && v10 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Stop();
        phOsalNfc_Timer_Delete();
        sub_219850628(0, (unsigned int *)&v18, 4u, 4u, (uint64_t)"phLibNfc_Mgt_DeInitialize : HCI Command Response timer deleted successfully");
        v5[109] = 0;
      }
    }
    sub_2198D270C(v18, 235);
    if (sub_2198D1B2C(v18, 139, 0, (uint64_t)&v18, 0) == 13)
    {
      *(_OWORD *)(a2 + 6136) = *(_OWORD *)(a2 + 19376);
      *(_DWORD *)(a2 + 440) = 16;
      *(_BYTE *)(a2 + 19374) = 0;
      *(_OWORD *)(a2 + 19376) = 0u;
      v11 = 13;
    }
    else
    {
      if (*(_DWORD *)(a2 + 3176) == 1)
        v11 = 288;
      else
        v11 = 0;
      *(_QWORD *)(a2 + 6144) = 0;
      *(_QWORD *)(a2 + 6136) = 0;
      v12 = *(void (**)(uint64_t, _QWORD, uint64_t))(a2 + 19376);
      if (v12)
        v12(v18, *(_QWORD *)(a2 + 19384), v11);
      if (sub_2198D1B2C(v18, 140, v11, 0, (uint64_t)&v17))
      {
        sub_219850628(0, (unsigned int *)&v18, 4u, 2u, (uint64_t)"State Machine has rejected the event!!!");
        sub_2198D289C(v18, 1);
        sub_2198D27D4(v18, 0);
      }
      v13 = 0;
      v14 = 0;
      do
      {
        v15 = *((_QWORD *)&unk_253E46700 + 14 * v14 + 2);
        if ((v13 & 1) != 0)
          break;
        v13 = 1;
        v14 = 1;
      }
      while (v15 != a2);
      if (v15 == a2)
      {
        sub_219897050(a2);
        sub_21988F804(v18, 0);
        sub_2198FF49C(*(unsigned int **)(a2 + 3040), 2, 0, 0);
        *(_QWORD *)(a2 + 3040) = 0;
        sub_21989A5DC((unsigned int *)a2);
        sub_21988EEB4(v18, 0);
      }
    }
  }
  else
  {
    v11 = 255;
  }
  sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_ResumeDeinit");
  return v11;
}

uint64_t sub_219896D1C(uint64_t a1, uint64_t a2, _BYTE **a3)
{
  int v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ResetNtfHandler");
  if (a1 && a3)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"LibNfc Reset Handler: Received Reset Ntf from NFCC");
    if (*a3)
    {
      if (((**a3 + 96) & 0xFC) != 0)
        v5 = 48;
      else
        v5 = (**a3 + 96) + 208;
      sub_219886108(*(_QWORD *)(a1 + 19360), v5);
    }
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), 141, 0, (uint64_t)a3, 0);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ResetNtfHandler");
}

uint64_t sub_219896DDC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _DWORD *v6;
  _BOOL4 v7;
  const char *v8;
  uint64_t v9;
  int v10;
  char v12;
  uint64_t (**v13)();
  uint64_t (*v14)();
  int v15;

  v15 = 8;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_LibNfcRecovery");
  if (!a1 || !a2)
  {
    v9 = 1;
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"LibNfcRecovery : Invalid Param!");
    goto LABEL_19;
  }
  v6 = (_DWORD *)(a1 + 19368);
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)" . Starting LibNfc recovery . ");
  sub_219897050(a1);
  *(_BYTE *)(a1 + 2882) = 0;
  sub_2198FF794(*(_QWORD *)(a1 + 3040));
  *(_QWORD *)(a1 + 6120) = a2;
  *(_QWORD *)(a1 + 6128) = a3;
  sub_21988ED38(*(_QWORD *)(a1 + 19360), &v15);
  if ((v15 & 0xFFFFFFFD) != 4)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"LibNfcRecovery: HSU baud rate different, changing it to the default baud rate (115200)");
    if (phTmlNfc_ConfigHsuBaudRate())
    {
      v7 = 0;
      v8 = "LibNfcRecovery: HSU Baud rate configuration failed";
      goto LABEL_17;
    }
  }
  if (*(_DWORD *)(a1 + 3176) != 1)
  {
    v10 = phTmlNfc_IoCtl();
    v7 = v10 == 0;
LABEL_12:
    if (*v6 == 1 && !v10)
    {
      sub_2199013F4(*(_QWORD *)(a1 + 3040), 0);
      sub_21990135C(*(_QWORD *)(a1 + 3040), 0);
      v10 = phTmlNfc_IoCtl();
    }
    if (!v10)
    {
      *(_QWORD *)(a1 + 2912) = &qword_2550A1050;
      *(_BYTE *)(a1 + 2904) = 0;
      *(_BYTE *)(a1 + 2906) = 0;
      v12 = qword_2550A1050;
      if (qword_2550A1050)
      {
        v12 = 0;
        v13 = off_2550A1060;
        do
        {
          ++v12;
          v14 = *v13;
          v13 += 2;
        }
        while (v14);
      }
      *(_BYTE *)(a1 + 2905) = v12;
      v9 = sub_2198655FC(a1, 0, 0);
      if ((_DWORD)v9 != 13)
      {
        *(_QWORD *)(a1 + 6120) = 0;
        *(_QWORD *)(a1 + 6128) = 0;
        if (v7)
          goto LABEL_18;
      }
      goto LABEL_19;
    }
    goto LABEL_16;
  }
  if (!phTmlNfc_IoCtl())
  {
    v10 = sub_2198972CC(*v6, *(_QWORD *)(a1 + 2952));
    v7 = 0;
    goto LABEL_12;
  }
  v7 = 0;
LABEL_16:
  v8 = "LibNfcRecovery: Failed to Hard reset the controller, return failed";
LABEL_17:
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v8);
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfcRecovery: Failed");
  v9 = 255;
  if (v7)
LABEL_18:
    phTmlNfc_IoCtl();
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_LibNfcRecovery");
  return v9;
}

uint64_t sub_219897050(uint64_t a1)
{
  uint64_t v2;
  BOOL v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  int *v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ReleaseTimers");
  if (a1)
  {
    v2 = *(_QWORD *)(a1 + 3192);
    if (v2)
      v3 = v2 == 0xFFFFFFFFFFFFLL;
    else
      v3 = 1;
    if (!v3)
    {
      phOsalNfc_Timer_Stop();
      *(_BYTE *)(a1 + 6032) = 0;
      sub_21988629C(1, (unsigned int *)(a1 + 19368), *(_QWORD *)(a1 + 3192), 4u, 4u, (uint64_t)"phLibNfc_ReleaseTimers");
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 3192) = 0xFFFFFFFFFFFFLL;
    }
    v4 = *(_QWORD *)(a1 + 3184);
    if (v4 && v4 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 3184) = 0xFFFFFFFFFFFFLL;
    }
    v5 = *(_QWORD *)(a1 + 464);
    v6 = *(_QWORD *)(a1 + 2896);
    if (v6 && v6 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 2896) = 0xFFFFFFFFFFFFLL;
    }
    v7 = *(_QWORD *)(a1 + 448);
    if (v7 && v7 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 448) = 0xFFFFFFFFFFFFLL;
    }
    if (v5)
    {
      v8 = *(_QWORD *)(v5 + 840);
      if (v8 && v8 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(v5 + 840) = 0;
      }
      v9 = *(_QWORD *)(v5 + 936);
      if (v9 && v9 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(v5 + 936) = 0;
      }
      v10 = *(_QWORD *)(v5 + 856);
      if (v10 && v10 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(v5 + 856) = 0;
      }
      v11 = *(_QWORD *)(v5 + 872);
      if (v11 && v11 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(v5 + 872) = 0;
        v12 = &dword_253E47158;
        if (!*(_DWORD *)(v5 + 956))
          v12 = &dword_253E47070;
        *v12 &= ~8u;
      }
    }
    v13 = *(_QWORD *)(a1 + 1448);
    if (v13 && v13 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 1448) = 0xFFFFFFFFFFFFLL;
    }
    v14 = *(_QWORD *)(a1 + 720);
    if (v14 && v14 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 720) = 0xFFFFFFFFFFFFLL;
    }
    v15 = *(_QWORD *)(a1 + 2888);
    if (v15 && v15 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 2888) = 0xFFFFFFFFFFFFLL;
    }
    v16 = *(_QWORD *)(a1 + 536);
    if (v16 && v16 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a1 + 536) = 0xFFFFFFFFFFFFLL;
    }
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"LibNFC Null Context -Timers Delete failed");
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ReleaseTimers");
}

uint64_t sub_2198972CC(uint64_t a1, uint64_t a2)
{
  uint64_t v2;
  uint64_t v4;

  v4 = a2;
  sub_219850718(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SpmiRetryClientReset");
  v2 = phTmlNfc_IoCtl();
  sub_219886334(0, (unsigned int *)&v4, 4u, 3u, (uint64_t)"phLibNfc_SpmiRetryClientReset: SPMI Reset Client Retry Status =");
  if ((_DWORD)v2 == 179)
  {
    sub_219851790(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"phLibNfc_SpmiRetryClientReset: SPMI Reset Client Retry Status =");
    phOsalNfc_Delay();
    v2 = phTmlNfc_IoCtl();
    sub_219886334(0, (unsigned int *)&v4, 4u, 3u, (uint64_t)"phLibNfc_SpmiRetryClientReset: SPMI Reset Client Retry Status =");
    if ((_DWORD)v2 == 179)
    {
      sub_219851790(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"phLibNfc_SpmiRetryClientReset: SPMI Reset Client Retry Status =");
      phOsalNfc_Delay();
      v2 = phTmlNfc_IoCtl();
      sub_219886334(0, (unsigned int *)&v4, 4u, 3u, (uint64_t)"phLibNfc_SpmiRetryClientReset: SPMI Reset Client Retry Status =");
      sub_219851790(0, (unsigned int *)&v4, 4u, 4u, (uint64_t)"phLibNfc_SpmiRetryClientReset: SPMI Reset Client Retry Status =");
    }
  }
  if (!(_DWORD)v2)
    phOsalNfc_Delay();
  sub_219850808(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SpmiRetryClientReset");
  return v2;
}

uint64_t sub_219897454(uint64_t a1, int a2, uint64_t *a3)
{
  char v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  unsigned int *v11;
  const char *v12;
  uint64_t v13;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InitCb");
  if (!a1)
    goto LABEL_6;
  v6 = 0;
  v7 = 0;
  do
  {
    v8 = *((_QWORD *)&unk_253E46700 + 14 * v7 + 2);
    if ((v6 & 1) != 0)
      break;
    v6 = 1;
    v7 = 1;
  }
  while (v8 != a1);
  if (v8 != a1)
  {
LABEL_6:
    v9 = 1;
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"Invalid Libnfc context passed by lower layer");
    goto LABEL_7;
  }
  if (a2)
  {
    v11 = (unsigned int *)(a1 + 19368);
    v12 = "NFCSTATUS_FAILED passed by lower layer";
LABEL_10:
    sub_219850628(1, v11, 4u, 1u, (uint64_t)v12);
    v9 = 255;
    goto LABEL_7;
  }
  if (!a3)
  {
    v11 = (unsigned int *)(a1 + 19368);
    v12 = "Buffer passed by lower layer is NULL";
    goto LABEL_10;
  }
  v13 = *a3;
  *(_QWORD *)(a1 + 3040) = *a3;
  sub_2199023DC(v13, *(_BYTE *)(a1 + 19373));
  *(_BYTE *)(a1 + 508) = 0;
  v9 = sub_2198975C8(a1, *(_QWORD *)(a1 + 3040));
  if (sub_21986C924(*(_QWORD *)(a1 + 19360), *(unsigned __int8 *)(a1 + 2988), *(unsigned __int8 *)(a1 + 2992)) == 10)
  {
    *(_DWORD *)(a1 + 3156) = 1;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Force No RF boot in case of SE300S");
  }
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InitCb");
  return v9;
}

uint64_t sub_2198975C8(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  int v5;
  int v6;
  int v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;

  v9 = 0;
  v10 = 0;
  v11 = 0;
  v8 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetNfccFeatures");
  v4 = 255;
  if (a1 && a2 && !sub_2198FDDEC(a2, (uint64_t)&v9))
  {
    sub_21988ED38(*(_QWORD *)(a1 + 2952), &v8);
    *(_BYTE *)(a1 + 2993) = BYTE1(v11);
    v5 = BYTE4(v10);
    *(_DWORD *)(a1 + 2988) = BYTE4(v10);
    *(_BYTE *)(a1 + 3025) = BYTE5(v10);
    *(_DWORD *)(a1 + 2980) = __rev16(HIWORD(v10));
    v6 = BYTE2(v11);
    *(_BYTE *)(a1 + 3088) = BYTE2(v11);
    *(_WORD *)(a1 + 3134) = WORD2(v11);
    *(_QWORD *)(a1 + 2936) = 0;
    *(_DWORD *)(a1 + 2943) = 0;
    *(_BYTE *)(a1 + 2) = 1;
    if ((v5 - 162) < 3)
    {
      v4 = 0;
      *(_BYTE *)(a1 + 2937) = 1;
      goto LABEL_27;
    }
    if (v5 == 66)
    {
      v4 = 0;
      *(_BYTE *)(a1 + 2936) = 1;
      goto LABEL_27;
    }
    if ((v5 + 79) <= 1u)
    {
      *(_BYTE *)(a1 + 2938) = 1;
      if (v6 == 1)
      {
        v4 = 0;
        *(_BYTE *)(a1 + 2939) = 1;
        goto LABEL_27;
      }
      if (v6 == 3 || v8 == 6 || v8 == 4)
      {
        *(_BYTE *)(a1 + 2939) = 1;
        if (v6 == 4)
        {
          v4 = 0;
          *(_BYTE *)(a1 + 2941) = 1;
          goto LABEL_27;
        }
        if (v6 == 3)
        {
          v4 = 0;
          *(_BYTE *)(a1 + 2940) = 1;
          goto LABEL_27;
        }
      }
LABEL_26:
      v4 = 0;
      goto LABEL_27;
    }
    if ((v5 - 208) < 4 || v5 == 96)
    {
      *(_BYTE *)(a1 + 2944) = 1;
      if ((v5 + 47) <= 2u)
      {
        v4 = 0;
        *(_BYTE *)(a1 + 2945) = 1;
        goto LABEL_27;
      }
      if (v5 == 96)
      {
        v4 = 0;
        *(_BYTE *)(a1 + 2946) = 1;
        goto LABEL_27;
      }
      goto LABEL_26;
    }
    if (v5 == 186)
    {
      *(_WORD *)(a1 + 2938) = 257;
      v4 = 0;
      if (v6 == 18)
        *(_BYTE *)(a1 + 2943) = 1;
      else
        *(_BYTE *)(a1 + 2942) = 1;
    }
  }
LABEL_27:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetNfccFeatures");
  return v4;
}

uint64_t sub_2198977E4(uint64_t a1, unsigned int *a2)
{
  uint64_t v2;
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  unsigned int *v7;
  const char *v8;
  uint64_t v9;
  int v11;
  char v12;
  uint64_t (**v13)();
  uint64_t (*v14)();
  void (*v15)(_QWORD, _QWORD, uint64_t, _QWORD);

  v2 = (uint64_t)a2;
  sub_219850718(2, a2, 4u, 5u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb");
  if (!v2)
    goto LABEL_6;
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != v2);
  if (v5 != v2)
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)v2, 4u, 1u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb:Invalid Context");
    return sub_219850808(2, (unsigned int *)v2, 4u, 5u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb");
  }
  *(_QWORD *)(v2 + 3168) = 0;
  v6 = *(_QWORD *)(v2 + 3184);
  if (!v6 || v6 == 0xFFFFFFFFFFFFLL)
  {
    v7 = (unsigned int *)(v2 + 19368);
    v8 = "phLibNfc_SpmiClientResetDelayCb: Invalid Timer Id";
LABEL_10:
    sub_219850628(1, v7, 4u, 1u, (uint64_t)v8);
    goto LABEL_11;
  }
  phOsalNfc_Timer_Stop();
  v11 = phTmlNfc_IoCtl();
  sub_219886334(1, (unsigned int *)(v2 + 19368), 4u, 3u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb: SPMI Reset Client Retry Status =");
  if (v11 == 179)
  {
    sub_219851790(1, (unsigned int *)(v2 + 19368), 4u, 4u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb: SPMI Reset Client Retry Status =");
    phOsalNfc_Delay();
    v11 = phTmlNfc_IoCtl();
    sub_219886334(1, (unsigned int *)(v2 + 19368), 4u, 3u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb: SPMI Reset Client Retry Status =");
    if (v11 == 179)
    {
      sub_219851790(1, (unsigned int *)(v2 + 19368), 4u, 4u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb: SPMI Reset Client Retry Status =");
      *(_QWORD *)(v2 + 3168) = sub_219899270;
      if (phOsalNfc_Timer_Start())
      {
        v8 = "phLibNfc_SpmiClientResetDelayCb: Client reset Nack Timer Start failed";
      }
      else
      {
        sub_219850628(1, (unsigned int *)(v2 + 19368), 4u, 4u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb: Client reset NACK boot Timer Started");
        v15 = *(void (**)(_QWORD, _QWORD, uint64_t, _QWORD))(v2 + 6568);
        if (v15)
        {
          v15(*(_QWORD *)(v2 + 19360), *(_QWORD *)(v2 + 6576), 304, 0);
          return sub_219850808(2, (unsigned int *)v2, 4u, 5u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb");
        }
        v8 = "phLibNfc_SpmiClientResetDelayCb: NULL Generic notification callback";
      }
      goto LABEL_30;
    }
  }
  if (v11 == 255)
  {
LABEL_11:
    v9 = *(_QWORD *)(v2 + 3184);
    if (v9 && v9 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(v2 + 3184) = 0xFFFFFFFFFFFFLL;
    }
    sub_219898F04((unsigned int *)v2, 255);
    v2 = 0;
    return sub_219850808(2, (unsigned int *)v2, 4u, 5u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb");
  }
  if (!v11)
  {
    phOsalNfc_Delay();
    *(_BYTE *)(v2 + 3230) = 0;
    *(_QWORD *)(v2 + 2912) = off_2550A11E0;
    *(_BYTE *)(v2 + 2904) = 0;
    *(_BYTE *)(v2 + 2906) = 0;
    v12 = (char)off_2550A11E0[0];
    if (off_2550A11E0[0])
    {
      v12 = 0;
      v13 = off_2550A11F0;
      do
      {
        ++v12;
        v14 = *v13;
        v13 += 2;
      }
      while (v14);
    }
    *(_BYTE *)(v2 + 2905) = v12;
    if (sub_2198655FC(v2, 0, v2 + 3230) != 13)
    {
      v8 = "phLibNfc_SpmiClientResetDelayCb:Init sequence failed";
LABEL_30:
      v7 = (unsigned int *)(v2 + 19368);
      goto LABEL_10;
    }
  }
  return sub_219850808(2, (unsigned int *)v2, 4u, 5u, (uint64_t)"phLibNfc_SpmiClientResetDelayCb");
}

uint64_t sub_219897AD4(uint64_t a1)
{
  uint64_t v2;
  int v3;
  uint64_t v4;
  uint64_t v5;
  int v6;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetSEPipeStatus");
  if (!a1)
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_GetSEPipeStatus - Invalid Lib COntext");
LABEL_15:
    v4 = 0;
    goto LABEL_20;
  }
  v2 = *(_QWORD *)(a1 + 464);
  if (*(_BYTE *)(a1 + 317) == 2 && *(_BYTE *)(a1 + 318) == 2 && *(_BYTE *)(a1 + 319) == 2)
    goto LABEL_15;
  phOsalNfc_SetMemory();
  v3 = *(_DWORD *)(*(_QWORD *)(a1 + 512) + 8);
  if (v3 == 1)
  {
    if (*(_BYTE *)(a1 + 2944) == 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetSEPipeStatus - Not required");
      v5 = sub_219897C98(a1);
LABEL_19:
      v4 = v5;
      goto LABEL_20;
    }
    v6 = 25165824;
LABEL_18:
    *(_DWORD *)(a1 + 3564) |= 0x1000u;
    *(_DWORD *)(a1 + 4140) |= v6;
    v5 = sub_2198FE090(*(_QWORD *)(a1 + 3040), a1 + 3560, (uint64_t)sub_219865DD0, a1);
    goto LABEL_19;
  }
  if (v3 == 7)
  {
    v6 = 0x4000000;
    goto LABEL_18;
  }
  if (v3 != 2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetSEPipeStatus - Not required");
    goto LABEL_15;
  }
  if (*(_BYTE *)(a1 + 2944) != 1)
  {
    v6 = 0x2000000;
    goto LABEL_18;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetSEPipeStatus - Not required");
  v4 = 0;
  *(_WORD *)(v2 + 832) = 16650;
LABEL_20:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetSEPipeStatus");
  return v4;
}

uint64_t sub_219897C98(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateStaticPipeInfo");
  if (a1 && (v2 = *(_QWORD *)(a1 + 464)) != 0)
  {
    *(_OWORD *)(v2 + 816) = xmmword_21990A6E0;
    sub_2198DE208(v2, 25);
    sub_2198DE208(v2, 39);
    sub_2198DE208(v2, 40);
    sub_2198DE208(v2, 41);
    sub_2198DE208(v2, 22);
    sub_2198DE208(v2, 43);
    sub_2198DE208(v2, 44);
    sub_2198DE208(v2, 45);
    v3 = 0;
  }
  else
  {
    v3 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateStaticPipeInfo");
  return v3;
}

uint64_t sub_219897D74(uint64_t a1)
{
  unsigned __int8 *v2;
  uint64_t v3;
  uint64_t v4;
  int v6;
  int v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SERecoveryGetPipeStatus");
  if (!a1 || (v2 = *(unsigned __int8 **)(a1 + 464)) == 0)
  {
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"phLibNfc_GetSEPipeStatus - Invalid Lib or HCI COntext");
    goto LABEL_7;
  }
  if (*(_BYTE *)(a1 + 2944) != 1)
  {
    phOsalNfc_SetMemory();
    v6 = *(_DWORD *)(*(_QWORD *)(a1 + 512) + 8);
    if (v6 == 1)
    {
      if (v2[818] == 255 && v2[816] == 255)
      {
        v7 = 25165824;
        goto LABEL_21;
      }
      sub_2198DE208((uint64_t)v2, 25);
    }
    else if (v6 == 7)
    {
      if (v2[834] == 255)
      {
        v7 = 0x4000000;
        goto LABEL_21;
      }
    }
    else if (v6 == 2 && v2[832] == 255)
    {
      v7 = 0x2000000;
LABEL_21:
      *(_DWORD *)(a1 + 3564) |= 0x1000u;
      *(_DWORD *)(a1 + 4140) |= v7;
      v3 = sub_2198FE090(*(_QWORD *)(a1 + 3040), a1 + 3560, (uint64_t)sub_219865DD0, a1);
      goto LABEL_5;
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetSEPipeStatus - Not required");
LABEL_7:
    v4 = 0;
    goto LABEL_8;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_SERecoveryGetPipeStatus - Not required");
  v3 = sub_219897C98(a1);
LABEL_5:
  v4 = v3;
LABEL_8:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SERecoveryGetPipeStatus");
  return v4;
}

uint64_t sub_219897F20(uint64_t a1, uint64_t a2, _BYTE *a3)
{
  _WORD *v6;
  int v7;
  unsigned int *v8;
  const char *v9;
  const char *v10;
  int v11;
  unsigned int *v12;
  uint64_t v13;
  int v14;
  unsigned int *v16;
  const char *v17;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetSEPipeStatusProc");
  if (!a1)
  {
    v10 = "phLibNfc_GetSEPipeStatusProc :Invalid Lib Context";
    v11 = 2;
    v12 = 0;
LABEL_22:
    sub_219850628(v11, v12, 4u, 1u, (uint64_t)v10);
    a2 = 255;
    goto LABEL_23;
  }
  if (!a3 || (v6 = *(_WORD **)(a1 + 464)) == 0)
  {
    v12 = (unsigned int *)(a1 + 19368);
    v10 = "phLibNfc_GetSEPipeStatusProc :Invalid HCI Context/No Data";
LABEL_21:
    v11 = 1;
    goto LABEL_22;
  }
  v7 = *(_DWORD *)(*(_QWORD *)(a1 + 512) + 8);
  if (v7 == 7)
  {
    if ((a3[5] & 0x10) == 0)
    {
LABEL_20:
      v12 = (unsigned int *)(a1 + 19368);
      v10 = "phLibNfc_GetSEPipeStatusProc :Invalid Length";
      goto LABEL_21;
    }
    if ((a3[583] & 4) == 0)
      goto LABEL_23;
    if (a3[1127])
    {
      if (a3[1127] == 1)
      {
        v6[417] = 16675;
        v13 = (uint64_t)v6;
        v14 = 35;
LABEL_28:
        sub_2198DE208(v13, v14);
        v16 = (unsigned int *)(a1 + 19368);
        v17 = "UICC Conn Pipe Updated Status- Open";
LABEL_41:
        sub_219850628(1, v16, 4u, 4u, (uint64_t)v17);
        goto LABEL_23;
      }
LABEL_36:
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_GetSEPipeStatusProc:Unknwon Value in Pipe Status GetConfig");
      goto LABEL_23;
    }
    v6[417] = -1;
LABEL_39:
    v16 = (unsigned int *)(a1 + 19368);
    v17 = "UICC Conn Pipe Updated Status- Deleted";
    goto LABEL_41;
  }
  if (v7 == 2)
  {
    if ((a3[5] & 0x10) == 0)
      goto LABEL_20;
    if ((a3[583] & 2) == 0)
      goto LABEL_23;
    if (a3[1126])
    {
      if (a3[1126] == 1)
      {
        v6[416] = 16650;
        v13 = (uint64_t)v6;
        v14 = 10;
        goto LABEL_28;
      }
      goto LABEL_36;
    }
    v6[416] = -1;
    goto LABEL_39;
  }
  if (v7 != 1 || (a3[5] & 0x10) == 0)
    goto LABEL_20;
  if ((a3[583] & 1) == 0)
    goto LABEL_32;
  if (!a3[1125])
  {
    v6[409] = -1;
    v8 = (unsigned int *)(a1 + 19368);
    v9 = "eSE Conn Pipe Updated Status- Deleted";
    goto LABEL_30;
  }
  if (a3[1125] == 1)
  {
    v6[409] = 16662;
    v8 = (unsigned int *)(a1 + 19368);
    v9 = "eSE Conn Pipe Updated Status- Open";
LABEL_30:
    sub_219850628(1, v8, 4u, 4u, (uint64_t)v9);
    goto LABEL_32;
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_GetSEPipeStatusProc:Unknwon Value in Pipe Status GetConfig");
LABEL_32:
  if ((a3[582] & 0x80) != 0)
  {
    if (!a3[1124])
    {
      v6[408] = -1;
      v16 = (unsigned int *)(a1 + 19368);
      v17 = "eSE APDU Pipe Updated Status- Deleted";
      goto LABEL_41;
    }
    if (a3[1124] == 1)
    {
      v6[408] = -4071;
      sub_2198DE208((uint64_t)v6, 25);
      v16 = (unsigned int *)(a1 + 19368);
      v17 = "eSE APDU Pipe Updated Status- Open";
      goto LABEL_41;
    }
    goto LABEL_36;
  }
LABEL_23:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetSEPipeStatusProc");
  return a2;
}

uint64_t sub_2198981C0(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_OpenLogConn");
  if (!(_DWORD)a2)
  {
    if (*(_BYTE *)(a1 + 314))
    {
      *(_BYTE *)(a1 + 509) = 0;
      a2 = sub_2198AB888(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 344), (uint64_t)sub_219865DD0, a1);
    }
    else
    {
      a2 = 255;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_OpenLogConn");
  return a2;
}

uint64_t sub_219898250(uint64_t a1, int a2)
{
  uint64_t v4;
  uint64_t v6;

  v6 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_OpenLogConnProcess");
  v4 = 255;
  if (a1)
  {
    if (!a2)
    {
      *(_BYTE *)(a1 + 2881) = 0;
      *(_DWORD *)(a1 + 544) = 0;
      sub_219889084(*(_QWORD *)(a1 + 464));
      v4 = sub_219888928(*(_QWORD *)(a1 + 464), *(_DWORD *)(a1 + 19368));
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phHciNfc_RegisterForEvents:Connectivity Pipe");
      LODWORD(v6) = 1;
      BYTE4(v6) = 22;
      sub_21988CF78(*(unsigned int **)(a1 + 464), (uint64_t)&v6, (uint64_t)sub_21988E49C, *(unsigned int **)(a1 + 464));
      if (*(_BYTE *)(a1 + 2944) == 1 && *(_BYTE *)(a1 + 318) == 3)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phHciNfc_RegisterForEvents:APDU Pipe");
        LODWORD(v6) = 1;
        BYTE4(v6) = 25;
        sub_21988CF78(*(unsigned int **)(a1 + 464), (uint64_t)&v6, (uint64_t)sub_2198DDA7C, *(unsigned int **)(a1 + 464));
        LODWORD(v6) = 1;
        BYTE4(v6) = 39;
        sub_21988CF78(*(unsigned int **)(a1 + 464), (uint64_t)&v6, (uint64_t)sub_2198DDA7C, *(unsigned int **)(a1 + 464));
        LODWORD(v6) = 1;
        BYTE4(v6) = 40;
        sub_21988CF78(*(unsigned int **)(a1 + 464), (uint64_t)&v6, (uint64_t)sub_2198DDA7C, *(unsigned int **)(a1 + 464));
        LODWORD(v6) = 1;
        BYTE4(v6) = 41;
        sub_21988CF78(*(unsigned int **)(a1 + 464), (uint64_t)&v6, (uint64_t)sub_2198DDA7C, *(unsigned int **)(a1 + 464));
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_OpenLogConnProcess");
  return v4;
}

uint64_t sub_2198983F4(uint64_t a1, uint64_t a2)
{
  int v4;
  int v5;
  int v6;
  int v7;
  __int16 v8;
  const char *v9;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetNfceeSessionId");
  if (a1 && !(_DWORD)a2)
  {
    if (*(unsigned __int8 *)(a1 + 314) >= 2u)
    {
      v4 = *(unsigned __int8 *)(a1 + 317);
      v5 = *(unsigned __int8 *)(a1 + 318);
      v6 = *(unsigned __int8 *)(a1 + 319);
      phOsalNfc_SetMemory();
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetNfceeSessionId: Se Count greater than 1");
      v7 = *(_DWORD *)(*(_QWORD *)(a1 + 512) + 8);
      if (v7 != 1)
      {
        if (v7 == 7)
        {
          if (!*(_BYTE *)(a1 + 506))
          {
            if (v6 == 1)
            {
              *(_DWORD *)(a1 + 3564) |= 0x2000u;
              *(_WORD *)(a1 + 4704) |= 0x20u;
              sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetNfceeSessionId: Poll for SE2 Session ID enabled");
LABEL_22:
              a2 = sub_2198FE090(*(_QWORD *)(a1 + 3040), a1 + 3560, (uint64_t)sub_219865DD0, a1);
              goto LABEL_17;
            }
            goto LABEL_16;
          }
        }
        else if (v7 == 2 && !*(_BYTE *)(a1 + 505))
        {
          if ((v4 & 0xFFFFFFFD) == 1)
          {
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetNfceeSessionId: Poll for UICC Session ID enabled");
            *(_DWORD *)(a1 + 3564) |= 0x2000u;
            v8 = *(_WORD *)(a1 + 4704) | 0x40;
LABEL_21:
            *(_WORD *)(a1 + 4704) = v8;
            goto LABEL_22;
          }
          goto LABEL_16;
        }
        v9 = "phLibNfc_GetNfceeSessionId: No NFCEE Ntf (UICC or eSE) received";
        goto LABEL_15;
      }
      if ((v5 & 0xFFFFFFFD) == 1)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetNfceeSessionId: eSE is connected/power enabled");
        if (*(_BYTE *)(a1 + 504) != 1)
        {
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetNfceeSessionId: Poll for eSE Session ID enabled");
          *(_DWORD *)(a1 + 3564) |= 0x2000u;
          v8 = *(_WORD *)(a1 + 4704) | 0x80;
          goto LABEL_21;
        }
        v9 = "phLibNfc_GetNfceeSessionId: EoOp already received";
LABEL_15:
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)v9);
      }
    }
LABEL_16:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetNfceeSessionId: No need to poll for Session ID");
    sub_21986607C(a1, *(_QWORD *)(a1 + 2912), 1);
    a2 = 0;
  }
LABEL_17:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetNfceeSessionId");
  return a2;
}

uint64_t sub_219898650(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v6;
  char v8;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyNfceeSessionId");
  if (!a1)
    goto LABEL_21;
  if ((_DWORD)a2)
    goto LABEL_21;
  if (!a3)
    goto LABEL_21;
  sub_219865FEC(a1, 1);
  if (*(unsigned __int8 *)(a1 + 314) < 2u)
    goto LABEL_21;
  v6 = *(_DWORD *)(*(_QWORD *)(a1 + 512) + 8);
  if (v6 != 1)
  {
    if (v6 == 7)
    {
      if ((*(_BYTE *)(a3 + 5) & 0x20) != 0 && (*(_WORD *)(a3 + 1144) & 0x20) != 0)
      {
        if (phOsalNfc_MemCompare())
        {
          *(_BYTE *)(a1 + 506) = 1;
          goto LABEL_19;
        }
        goto LABEL_24;
      }
    }
    else if (v6 == 2 && (*(_BYTE *)(a3 + 5) & 0x20) != 0 && (*(_WORD *)(a3 + 1144) & 0x40) != 0)
    {
      if (phOsalNfc_MemCompare())
      {
        *(_BYTE *)(a1 + 505) = 1;
LABEL_19:
        *(_BYTE *)(a1 + 2881) = 0;
LABEL_20:
        *(_DWORD *)(a1 + 544) = 0;
        goto LABEL_21;
      }
      goto LABEL_24;
    }
LABEL_18:
    *(_WORD *)(a1 + 504) = 0;
    *(_BYTE *)(a1 + 506) = 0;
    goto LABEL_19;
  }
  if ((*(_BYTE *)(a3 + 5) & 0x20) == 0 || (*(_WORD *)(a3 + 1144) & 0x80) == 0)
    goto LABEL_18;
  if (phOsalNfc_MemCompare())
  {
    *(_BYTE *)(a1 + 504) = 1;
    goto LABEL_19;
  }
LABEL_24:
  if (!*(_BYTE *)(a1 + 2881))
    goto LABEL_20;
  v8 = *(_BYTE *)(a1 + 2881) - 1;
  *(_BYTE *)(a1 + 2881) = v8;
  if (!v8)
    *(_BYTE *)(a1 + 508) = 1;
LABEL_21:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_VerifyNfceeSessionId");
  return a2;
}

uint64_t sub_219898814(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  _OWORD v5[71];
  __int16 v6;
  uint64_t v7;

  v7 = *MEMORY[0x24BDAC8D0];
  memset(v5, 0, 512);
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ClearEseSessionIdSeq");
  if (a1 && (v2 = *(_QWORD *)(a1 + 464)) != 0)
  {
    if (*(unsigned __int8 *)(v2 + 816) == 255 || *(unsigned __int8 *)(v2 + 818) == 255)
    {
      phOsalNfc_SetMemory();
      DWORD1(v5[0]) |= 0x2000u;
      v6 |= 0x80u;
      phOsalNfc_SetMemory();
      v3 = sub_2198FD4A4(*(_QWORD *)(a1 + 3040), (uint64_t)v5, (uint64_t)sub_219865DD0, a1);
    }
    else
    {
      v3 = 0;
    }
  }
  else
  {
    v3 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ClearEseSessionIdSeq");
  return v3;
}

uint64_t sub_219898984(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ClearEseSessionIdProc");
  if (a1)
  {
    v4 = (unsigned int *)(a1 + 19368);
    if ((_DWORD)a2)
    {
      sub_219850628(1, v4, 4u, 1u, (uint64_t)"phLibNfc_ClearEseSessionIdProc: Set Session ID Failed");
    }
    else
    {
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"phLibNfc_ClearEseSessionIdProc: Set Session ID Successful");
      *(_BYTE *)(a1 + 509) = 1;
    }
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ClearEseSessionIdProc");
  return a2;
}

uint64_t sub_219898A3C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DisableNfceeDisc");
  if (a1)
  {
    if (*(_DWORD *)(a1 + 456) == 1)
    {
      v2 = sub_2198FC2D0(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1);
    }
    else
    {
      *(_DWORD *)(a1 + 544) = 0;
      *(_BYTE *)(a1 + 2881) = 0;
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"SetMode Skipped as HCI Network is not Enabled");
      sub_21986607C(a1, *(_QWORD *)(a1 + 2912), 1);
      v2 = 0;
    }
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_DisableNfceeDisc Invalid Lib Context");
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DisableNfceeDisc");
  return v2;
}

uint64_t sub_219898B20(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;

  sub_21988629C(2, (unsigned int *)a2, a1, 4u, 4u, (uint64_t)"phLibNfc_NfceeNtfDelayCb");
  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_NfceeNtfDelayCb");
  if (a2)
  {
    v3 = 0;
    v4 = 0;
    do
    {
      v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
      if ((v3 & 1) != 0)
        break;
      v3 = 1;
      v4 = 1;
    }
    while (v5 != a2);
    if (v5 == a2)
    {
      *(_BYTE *)(a2 + 705) = 0;
      sub_219850628(1, (unsigned int *)(a2 + 19368), 4u, 4u, (uint64_t)"phLibNfc_NfceeNtfDelayCb: Timer expired");
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 536) = 0xFFFFFFFFFFFFLL;
      sub_2198655FC(a2, 0, 0);
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_NfceeNtfDelayCb");
}

uint64_t sub_219898C38(uint64_t a1, unsigned int *a2)
{
  uint64_t v2;
  char v4;
  uint64_t v5;
  _BYTE *v6;
  uint64_t v7;
  uint64_t v8;
  int v9;
  const char *v10;
  char v12;
  uint64_t (**v13)();
  uint64_t (*v14)();

  v2 = (uint64_t)a2;
  sub_219850718(2, a2, 4u, 5u, (uint64_t)"phLibNfc_MultiTagNtfWaitTimeOutCb");
  if (!v2)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  v6 = (_BYTE *)(v2 + 6032);
  do
  {
    v7 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 2);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v7 != v2);
  if (v7 != v2)
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)v2, 4u, 1u, (uint64_t)"phLibNfc_MultiTagNtfWaitTimeOutCb:Invalid Context");
    return sub_219850808(2, (unsigned int *)v2, 4u, 5u, (uint64_t)"phLibNfc_MultiTagNtfWaitTimeOutCb");
  }
  if (!*v6)
  {
    phOsalNfc_Timer_Stop();
    if (!phOsalNfc_Timer_Start())
    {
      sub_219850628(1, (unsigned int *)(v2 + 19368), 4u, 4u, (uint64_t)"MultiTag Detection NTF Timer Restarted for extended time");
      *v6 = 1;
      return sub_219850808(2, (unsigned int *)v2, 4u, 5u, (uint64_t)"phLibNfc_MultiTagNtfWaitTimeOutCb");
    }
    sub_219850628(1, (unsigned int *)(v2 + 19368), 4u, 1u, (uint64_t)"MultiTag Detection NTF Timer failed to start for extended time");
  }
  *v6 = 0;
  sub_21988629C(2, (unsigned int *)v2, a1, 4u, 4u, (uint64_t)"phLibNfc_MultiTagNtfWaitTimeOutCb");
  sub_219850628(1, (unsigned int *)(v2 + 19368), 4u, 2u, (uint64_t)"****** Multi-Tag Ntf Wait Timer Expired********");
  v8 = *(_QWORD *)(v2 + 3192);
  if (v8 && v8 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(v2 + 3192) = 0xFFFFFFFFFFFFLL;
  }
  sub_2199013F4(*(_QWORD *)(v2 + 3040), 0);
  sub_21990135C(*(_QWORD *)(v2 + 3040), 0);
  if (phTmlNfc_IoCtl())
    goto LABEL_19;
  if (*(_DWORD *)(v2 + 3176) == 1)
  {
    if (phTmlNfc_IoCtl())
    {
LABEL_19:
      v10 = "phLibNfc_MultiTagNtfWaitTimeOutCb:Power up failed";
LABEL_20:
      sub_219850628(1, (unsigned int *)(v2 + 19368), 4u, 1u, (uint64_t)v10);
      sub_219898F04((unsigned int *)v2, 255);
      v2 = 0;
      return sub_219850808(2, (unsigned int *)v2, 4u, 5u, (uint64_t)"phLibNfc_MultiTagNtfWaitTimeOutCb");
    }
    v9 = sub_2198972CC(*(unsigned int *)(v2 + 19368), *(_QWORD *)(v2 + 2952));
  }
  else
  {
    v9 = phTmlNfc_IoCtl();
  }
  if (v9)
    goto LABEL_19;
  if (phTmlNfc_ReadAbort())
  {
    v10 = "phLibNfc_MultiTagNtfWaitTimeOutCb:Read Abort failed";
    goto LABEL_20;
  }
  *(_BYTE *)(v2 + 3230) = 1;
  *(_QWORD *)(v2 + 2912) = off_2550A11E0;
  *(_BYTE *)(v2 + 2904) = 0;
  *(_BYTE *)(v2 + 2906) = 0;
  v12 = (char)off_2550A11E0[0];
  if (off_2550A11E0[0])
  {
    v12 = 0;
    v13 = off_2550A11F0;
    do
    {
      ++v12;
      v14 = *v13;
      v13 += 2;
    }
    while (v14);
  }
  *(_BYTE *)(v2 + 2905) = v12;
  if (sub_2198655FC(v2, 0, v2 + 3230) != 13)
  {
    v10 = "phLibNfc_MultiTagNtfWaitTimeOutCb:Init Failed";
    goto LABEL_20;
  }
  return sub_219850808(2, (unsigned int *)v2, 4u, 5u, (uint64_t)"phLibNfc_MultiTagNtfWaitTimeOutCb");
}

uint64_t sub_219898F04(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  _DWORD *v5;
  uint64_t v6;
  int v7;
  int v8;
  int v9;
  int v10;
  unsigned int v11;
  unsigned int v12;
  unsigned int v13;
  unsigned int v14;
  uint64_t v16;

  v3 = (uint64_t)a1;
  v16 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ReleaseLibNfcContext");
  if (v3)
  {
    v4 = *(_QWORD *)(v3 + 19360);
    sub_21988EB80(*(_QWORD *)(v3 + 2952), &v16);
    if (!*(_BYTE *)(v3 + 504) && *(_QWORD *)(v3 + 392))
    {
      --*(_BYTE *)(v3 + 314);
      *(_QWORD *)(v3 + 392) = 0;
      *(_DWORD *)(v3 + 400) = 0;
    }
    if (!*(_BYTE *)(v3 + 505) && *(_QWORD *)(v3 + 376))
    {
      --*(_BYTE *)(v3 + 314);
      *(_QWORD *)(v3 + 376) = 0;
      *(_DWORD *)(v3 + 384) = 0;
    }
    if (!*(_BYTE *)(v3 + 506) && *(_QWORD *)(v3 + 408))
    {
      --*(_BYTE *)(v3 + 314);
      *(_QWORD *)(v3 + 408) = 0;
      *(_DWORD *)(v3 + 416) = 0;
    }
    *(_BYTE *)(v3 + 696) = 0;
    if ((_DWORD)a2)
    {
      v5 = (_DWORD *)(v3 + 19368);
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"LibNfc Init/Re-init Failed");
      if (*(_BYTE *)(v3 + 2883) == 1)
        goto LABEL_18;
      if (*(_DWORD *)(v3 + 3176) == 1)
      {
        if (sub_2198972CC(*v5, *(_QWORD *)(v3 + 2952)))
        {
LABEL_15:
          sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phLibNfc_ReleaseLibNfcContext:Powering OFF NFCC Failed");
          goto LABEL_18;
        }
      }
      else if (phTmlNfc_IoCtl())
      {
        goto LABEL_15;
      }
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"phLibNfc_ReleaseLibNfcContext:Powering OFF NFCC Success");
LABEL_18:
      if (*(_QWORD *)(v3 + 6056) || v16 && *(_QWORD *)(v16 + 16))
        sub_2198D1B2C(*(_QWORD *)(v3 + 19360), 146, a2, 0, v3);
      if (*(_QWORD *)(v3 + 6104))
      {
        sub_2198D1B2C(*(_QWORD *)(v3 + 19360), 146, a2, 0, 0);
        sub_2198EB8A8(v3, a2);
      }
      if (*(_BYTE *)(v3 + 2883))
      {
        v6 = *(_QWORD *)(v3 + 2888);
        if (v6 && v6 != 0xFFFFFFFFFFFFLL)
        {
          phOsalNfc_Timer_Stop();
          sub_21988629C(1, (unsigned int *)(v3 + 19368), *(_QWORD *)(v3 + 2888), 4u, 4u, (uint64_t)"phLibNfc_ReleaseLibNfcContext");
          phOsalNfc_Timer_Delete();
          *(_QWORD *)(v3 + 2888) = 0;
          *(_BYTE *)(v3 + 2880) = 0;
        }
        *(_BYTE *)(v3 + 2883) = 0;
      }
      else
      {
        v7 = (sub_219899740((unsigned int *)v3, *(_QWORD *)(v3 + 2912)) & 0x3F) << 11;
        v8 = (*(_BYTE *)(v3 + 2904) & 0x1F) << 6;
        v9 = (*(_BYTE *)(v3 + 318) & 3) << 22;
        v10 = (*(_BYTE *)(v3 + 317) & 3) << 20;
        if (*v5)
        {
          v11 = v7 | dword_253E47158 & 0xFFFE003F | v8;
          dword_253E4715C = v9 | v10 | dword_253E4715C & 0xFF0FFFFF;
          if (*(_BYTE *)(v3 + 2936) == 1)
            v12 = v11 & 0xFFFFFFCF | (16 * (*(_BYTE *)(v3 + 319) & 3));
          else
            v12 = v11 & 0xFFFFFFCF;
          dword_253E47158 = v12;
        }
        else
        {
          v13 = v7 | dword_253E47070 & 0xFFFE003F | v8;
          dword_253E47074 = v9 | v10 | dword_253E47074 & 0xFF0FFFFF;
          if (*(_BYTE *)(v3 + 2936) == 1)
            v14 = v13 & 0xFFFFFFCF | (16 * (*(_BYTE *)(v3 + 319) & 3));
          else
            v14 = v13 & 0xFFFFFFCF;
          dword_253E47070 = v14;
        }
        sub_219897050(v3);
        sub_2198FF49C(*(unsigned int **)(v3 + 3040), 2, 0, 0);
        *(_QWORD *)(v3 + 3040) = 0;
        sub_21989A5DC((unsigned int *)v3);
        sub_21988EEB4(v4, 0);
        v3 = 0;
      }
    }
  }
  return sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_ReleaseLibNfcContext");
}

uint64_t sub_219899270(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_BootVenResetTimeOutCb");
  if (!a2)
    goto LABEL_6;
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != a2);
  if (v5 == a2)
  {
    v6 = *(_QWORD *)(a2 + 3184);
    if (v6 && v6 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 3184) = 0xFFFFFFFFFFFFLL;
    }
    *(_QWORD *)(a2 + 3168) = 0;
    sub_219899360((unsigned int *)a2, 307);
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 4u, 1u, (uint64_t)"phLibNfc_BootVenResetTimeOutCb:Invalid Context");
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_BootVenResetTimeOutCb");
}

uint64_t sub_219899360(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int *v4;
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();

  v3 = (uint64_t)a1;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_InitializeAfterVenReset");
  if (v3)
  {
    if ((_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"phLibNfc_InitializeAfterVenReset invoked with failure status");
      v4 = (unsigned int *)v3;
      v5 = a2;
    }
    else
    {
      *(_BYTE *)(v3 + 3230) = 0;
      *(_QWORD *)(v3 + 2912) = off_2550A11E0;
      *(_BYTE *)(v3 + 2904) = 0;
      *(_BYTE *)(v3 + 2906) = 0;
      v7 = (char)off_2550A11E0[0];
      if (off_2550A11E0[0])
      {
        v7 = 0;
        v8 = off_2550A11F0;
        do
        {
          ++v7;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
      *(_BYTE *)(v3 + 2905) = v7;
      if (sub_2198655FC(v3, 0, v3 + 3230) == 13)
        goto LABEL_11;
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phLibNfc_InitializeAfterVenReset:Init Failed");
      v4 = (unsigned int *)v3;
      v5 = 255;
    }
    sub_219898F04(v4, v5);
    v3 = 0;
LABEL_11:
    v6 = 0;
    goto LABEL_12;
  }
  sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_InitializeAfterVenReset:Invalid Context");
  v6 = 49;
LABEL_12:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_InitializeAfterVenReset");
  return v6;
}

uint64_t sub_21989949C(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_GetSessionVenResetTimeOutCb");
  if (!a2)
    goto LABEL_6;
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != a2);
  if (v5 == a2)
  {
    v6 = *(_QWORD *)(a2 + 3184);
    if (v6 && v6 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 3184) = 0xFFFFFFFFFFFFLL;
    }
    *(_QWORD *)(a2 + 3168) = 0;
    sub_21989958C((unsigned int *)a2, 307);
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 4u, 1u, (uint64_t)"phLibNfc_BootVenResetTimeOutCb:Invalid Context");
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_GetSessionVenResetTimeOutCb");
}

uint64_t sub_21989958C(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  unsigned int *v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  char v9;
  uint64_t *v10;
  uint64_t v11;
  int v12;
  uint64_t v13;
  uint64_t v14;

  v3 = (uint64_t)a1;
  v13 = 0;
  v14 = 0;
  v12 = 8;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetSessionAfterVenReset");
  if (!v3)
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_GetSessionAfterVenReset:Invalid Context");
    v6 = 49;
    goto LABEL_7;
  }
  if ((_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetSessionAfterVenReset invoked with failure status");
    v4 = (unsigned int *)v3;
    v5 = a2;
    goto LABEL_4;
  }
  sub_21988ED38(*(_QWORD *)(v3 + 2952), &v12);
  sub_2198C1984(*(_QWORD *)(v3 + 2952), v12);
  sub_21988F460(*(_QWORD *)(v3 + 2952), &v14);
  sub_21988EB80(*(_QWORD *)(v3 + 2952), &v13);
  v6 = 255;
  if (v14 && v13)
  {
    if (sub_219905DA0(*(_QWORD *)(v14 + 56)) == 13)
    {
      v8 = v13;
      *(_BYTE *)(v13 + 67) = 1;
      *(_WORD *)(v8 + 64) = 0;
      *(_QWORD *)(v3 + 2912) = off_2550A2EE8;
      *(_BYTE *)(v3 + 2904) = 0;
      *(_BYTE *)(v3 + 2906) = 0;
      v9 = (char)off_2550A2EE8[0];
      if (off_2550A2EE8[0])
      {
        v9 = 0;
        v10 = &qword_2550A2EF8;
        do
        {
          ++v9;
          v11 = *v10;
          v10 += 2;
        }
        while (v11);
      }
      *(_BYTE *)(v3 + 2905) = v9;
      if (sub_2198655FC(v3, 0, 0) == 13)
        goto LABEL_5;
    }
    sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"phLibNfc_GetSessionAfterVenReset:Get Session state sequence failed");
    sub_21986BE40(*(_QWORD *)(v3 + 2952));
    v4 = (unsigned int *)v3;
    v5 = 255;
LABEL_4:
    sub_219898F04(v4, v5);
    v3 = 0;
LABEL_5:
    v6 = 0;
  }
LABEL_7:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_GetSessionAfterVenReset");
  return v6;
}

uint64_t sub_219899740(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetLibNfcSeqId");
  if (a2)
  {
    if ((uint64_t (**)())a2 == off_2550A3A28)
    {
      a2 = 1;
    }
    else if ((uint64_t (**)())a2 == off_2550A3A98)
    {
      a2 = 2;
    }
    else if ((uint64_t (**)())a2 == off_2550A3AE8)
    {
      a2 = 75;
    }
    else if ((uint64_t *)a2 == &qword_2550A3B28)
    {
      a2 = 76;
    }
    else if ((uint64_t *)a2 == &qword_2550A3B48)
    {
      a2 = 4;
    }
    else if ((uint64_t (**)())a2 == off_2550A3B68)
    {
      a2 = 3;
    }
    else if ((uint64_t (**)())a2 == off_2550A10F0)
    {
      a2 = 5;
    }
    else if ((uint64_t (**)())a2 == off_2550A11E0)
    {
      a2 = 7;
    }
    else if ((uint64_t *)a2 == &qword_2550A1370)
    {
      a2 = 8;
    }
    else if ((uint64_t *)a2 == &qword_2550A1320)
    {
      a2 = 9;
    }
    else if ((uint64_t (**)())a2 == off_2550A11C0)
    {
      a2 = 10;
    }
    else if ((uint64_t (**)())a2 == off_2550A32E8)
    {
      a2 = 11;
    }
    else if ((uint64_t *)a2 == &qword_2550A3358)
    {
      a2 = 73;
    }
    else if ((uint64_t *)a2 == &qword_2550A3B98)
    {
      a2 = 74;
    }
    else if ((uint64_t *)a2 == &qword_2550A3388)
    {
      a2 = 12;
    }
    else if ((uint64_t (**)())a2 == off_2550A3588)
    {
      a2 = 13;
    }
    else if ((uint64_t *)a2 == &qword_2550A35F8)
    {
      a2 = 14;
    }
    else if ((uint64_t *)a2 == &qword_2550A0D88)
    {
      a2 = 18;
    }
    else if ((uint64_t *)a2 == &qword_2550A33B8)
    {
      a2 = 19;
    }
    else if ((uint64_t *)a2 == &qword_2550A33D8)
    {
      a2 = 20;
    }
    else if ((uint64_t (**)())a2 == off_2550A3648)
    {
      a2 = 22;
    }
    else if ((uint64_t (**)())a2 == off_2550A3408)
    {
      a2 = 23;
    }
    else if ((uint64_t (**)())a2 == off_2550A3428)
    {
      a2 = 24;
    }
    else if ((uint64_t *)a2 == &qword_2550A3468)
    {
      a2 = 27;
    }
    else if ((uint64_t *)a2 == &qword_2550A34B8)
    {
      a2 = 26;
    }
    else if ((uint64_t (**)())a2 == off_2550A36D8)
    {
      a2 = 28;
    }
    else if ((uint64_t (**)())a2 == off_2550A37C8)
    {
      a2 = 29;
    }
    else if ((uint64_t (**)())a2 == off_2550A3748)
    {
      a2 = 30;
    }
    else if ((uint64_t *)a2 == &qword_2550A1050)
    {
      a2 = 31;
    }
    else if ((uint64_t (**)())a2 == off_2550A1090)
    {
      a2 = 32;
    }
    else if ((uint64_t *)a2 == &qword_2550A13A0)
    {
      a2 = 33;
    }
    else if ((uint64_t *)a2 == &qword_2550A1400)
    {
      a2 = 77;
    }
    else if ((uint64_t (**)())a2 == off_2550A3848)
    {
      a2 = 34;
    }
    else if ((uint64_t (**)())a2 == off_2550A2D68)
    {
      a2 = 35;
    }
    else if ((uint64_t *)a2 == &qword_2550A2E28)
    {
      a2 = 36;
    }
    else if ((uint64_t *)a2 == &qword_2550A2E48)
    {
      a2 = 37;
    }
    else if ((uint64_t *)a2 == &qword_2550A2E78)
    {
      a2 = 38;
    }
    else if ((uint64_t *)a2 == &qword_2550A2EB8)
    {
      a2 = 39;
    }
    else if ((uint64_t (**)())a2 == off_2550A2EE8)
    {
      a2 = 40;
    }
    else if ((uint64_t *)a2 == &qword_2550A2F08)
    {
      a2 = 41;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_GetMemDumpSequence)
    {
      a2 = 42;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_GetFwVersionSequence)
    {
      a2 = 43;
    }
    else if ((uint64_t (**)())a2 == off_2550A3868)
    {
      a2 = 44;
    }
    else if ((uint64_t (**)())a2 == off_2550A38A8)
    {
      a2 = 45;
    }
    else if ((uint64_t (**)())a2 == off_2550A38D8)
    {
      a2 = 46;
    }
    else if ((uint64_t (**)())a2 == off_2550A38F8)
    {
      a2 = 47;
    }
    else if ((uint64_t (**)())a2 == off_2550A3958)
    {
      a2 = 48;
    }
    else if ((uint64_t (**)())a2 == off_2550A3BB8)
    {
      a2 = 49;
    }
    else if ((uint64_t (**)())a2 == off_2550A3BE8)
    {
      a2 = 50;
    }
    else if ((uint64_t *)a2 == &qword_2550A3C18)
    {
      a2 = 53;
    }
    else if ((uint64_t *)a2 == &qword_2550A3988)
    {
      a2 = 51;
    }
    else if ((uint64_t (**)())a2 == off_2550A3C38)
    {
      a2 = 52;
    }
    else if ((uint64_t *)a2 == &qword_2550A3C68)
    {
      a2 = 54;
    }
    else if ((uint64_t *)a2 == &qword_2550A3C88)
    {
      a2 = 55;
    }
    else if ((uint64_t *)a2 == &qword_2550A3CB8)
    {
      a2 = 56;
    }
    else if ((uint64_t *)a2 == &qword_2550A3CD8)
    {
      a2 = 57;
    }
    else if ((uint64_t *)a2 == &qword_2550A3CF8)
    {
      a2 = 59;
    }
    else if ((uint64_t *)a2 == &qword_2550A3D18)
    {
      a2 = 58;
    }
    else if ((uint64_t (**)())a2 == off_2550A3D38)
    {
      a2 = 60;
    }
    else if ((uint64_t (**)())a2 == off_2550A3D58)
    {
      a2 = 61;
    }
    else if ((uint64_t (**)())a2 == off_2550A3D88)
    {
      a2 = 62;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlLoopbackSequence)
    {
      a2 = 63;
    }
    else if ((uint64_t *)a2 == &qword_2550A3DB8)
    {
      a2 = 64;
    }
    else if ((uint64_t *)a2 == &qword_2550A3DD8)
    {
      a2 = 65;
    }
    else if ((uint64_t *)a2 == &qword_2550A3DF8)
    {
      a2 = 66;
    }
    else if ((uint64_t *)a2 == &qword_2550A3E18)
    {
      a2 = 67;
    }
    else if ((uint64_t *)a2 == &qword_2550A3E38)
    {
      a2 = 68;
    }
    else if ((uint64_t (**)())a2 == off_2550A3E58)
    {
      a2 = 69;
    }
    else if ((uint64_t *)a2 == &qword_2550A3E78)
    {
      a2 = 71;
    }
    else if ((uint64_t *)a2 == &qword_2550A3E98)
    {
      a2 = 72;
    }
    else if ((uint64_t *)a2 == &qword_2550A3EB8)
    {
      a2 = 70;
    }
    else if ((uint64_t (**)())a2 == off_2550A3788)
    {
      a2 = 78;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlSetPropRfConfig)
    {
      a2 = 80;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlGetRfConfig)
    {
      a2 = 81;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlSetRfConfig)
    {
      a2 = 82;
    }
    else if ((uint64_t (**)())a2 == off_2550A3678)
    {
      a2 = 91;
    }
    else if ((uint64_t (**)())a2 == off_2550A3ED8)
    {
      a2 = 96;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_SysConfigSeq)
    {
      a2 = 98;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlGetSpmiGpio)
    {
      a2 = 100;
    }
    else if ((uint64_t (**)())a2 == off_2550A39A8)
    {
      a2 = 105;
    }
    else if ((uint64_t (**)())a2 == off_2550A39C8)
    {
      a2 = 79;
    }
    else if ((uint64_t (**)())a2 == off_2550A2C08)
    {
      a2 = 103;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlSetPropConfigSigned)
    {
      a2 = 83;
    }
    else if ((uint64_t *)a2 == &qword_2550A2FB8)
    {
      a2 = 89;
    }
    else if ((uint64_t (**)())a2 == off_2550A2F48)
    {
      a2 = 93;
    }
    else if ((uint64_t (**)())a2 == off_2550A2FE8)
    {
      a2 = 92;
    }
    else if ((uint64_t *)a2 == &qword_2550A2B28)
    {
      a2 = 111;
    }
    else if ((uint64_t (**)())a2 == off_2550A3058)
    {
      a2 = 109;
    }
    else if ((uint64_t *)a2 == &qword_2550A3008)
    {
      a2 = 119;
    }
    else if ((uint64_t (**)())a2 == off_2550A3098)
    {
      a2 = 120;
    }
    else if ((uint64_t (**)())a2 == off_2550A3038)
    {
      a2 = 121;
    }
    else if ((uint64_t (**)())a2 == off_2550A3078)
    {
      a2 = 122;
    }
    else if ((uint64_t *)a2 == &qword_2550A2B08)
    {
      a2 = 126;
    }
    else if ((uint64_t (**)())a2 == off_2550A13C0)
    {
      a2 = 94;
    }
    else if ((uint64_t (**)())a2 == off_2550A0DA8)
    {
      a2 = 95;
    }
    else if ((uint64_t *)a2 == &qword_2550A3EF8)
    {
      a2 = 97;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlGetRfRegVal)
    {
      a2 = 99;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlSetRfCalData)
    {
      a2 = 101;
    }
    else if ((uint64_t (**)())a2 == gphLibNfc_IoctlGetRfCalData)
    {
      a2 = 102;
    }
    else if ((uint64_t (**)())a2 == off_2550A34D8)
    {
      a2 = 104;
    }
    else if ((uint64_t *)a2 == &qword_2550A2D08)
    {
      a2 = 108;
    }
    else if ((uint64_t *)a2 == &qword_2550A2B98)
    {
      a2 = 115;
    }
    else if ((uint64_t *)a2 == &qword_2550A30B8)
    {
      a2 = 116;
    }
    else if ((uint64_t (**)())a2 == off_2550A34F8)
    {
      a2 = 84;
    }
    else if ((uint64_t *)a2 == &qword_2550A3548)
    {
      a2 = 90;
    }
    else if ((uint64_t *)a2 == &qword_2550A2C68)
    {
      a2 = 117;
    }
    else if ((uint64_t *)a2 == &qword_2550A2CD8)
    {
      a2 = 118;
    }
    else if ((uint64_t (**)())a2 == off_2550A0DD8)
    {
      a2 = 123;
    }
    else if ((uint64_t (**)())a2 == off_2550A2D38)
    {
      a2 = 125;
    }
    else if ((uint64_t *)a2 == &qword_2550A2BD8)
    {
      a2 = 114;
    }
    else if ((uint64_t *)a2 == &qword_2550A0E38)
    {
      a2 = 106;
    }
    else if ((uint64_t *)a2 == &qword_2550A0E58)
    {
      a2 = 107;
    }
    else if ((uint64_t (**)())a2 == off_2550A0DF8)
    {
      a2 = 124;
    }
    else if ((uint64_t (**)())a2 == off_2550A0E18)
    {
      a2 = 112;
    }
    else if ((uint64_t *)a2 == &qword_2550A2B68)
    {
      a2 = 113;
    }
    else
    {
      a2 = 0;
    }
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetLibNfcSeqId");
  return a2;
}

uint64_t sub_21989A264(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  uint64_t v10;
  unsigned int *v11;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StaticListenModeRouting");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 2);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    *(_DWORD *)(a1 + 544) = 100;
    *(_BYTE *)(a1 + 2881) = 10;
    *(_QWORD *)(a1 + 2912) = off_2550A1090;
    *(_BYTE *)(a1 + 2904) = 0;
    *(_BYTE *)(a1 + 2906) = 0;
    v7 = (char)off_2550A1090[0];
    if (off_2550A1090[0])
    {
      v7 = 0;
      v8 = off_2550A10A0;
      do
      {
        ++v7;
        v9 = *v8;
        v8 += 2;
      }
      while (v9);
    }
    *(_BYTE *)(a1 + 2905) = v7;
    v10 = sub_2198655FC(a1, 0, 0);
    v5 = v10;
    if ((_DWORD)v10 != 13)
    {
      v11 = (unsigned int *)(a1 + 19368);
      if ((_DWORD)v10)
      {
        sub_219850628(1, v11, 4u, 1u, (uint64_t)"StaticListenModeRouting: Listen Mode Routing sequence could not start!");
        v5 = 255;
      }
      else
      {
        sub_219850628(1, v11, 4u, 4u, (uint64_t)"StaticListenModeRouting: gphLibNfc_staticFeatureConfig returned SUCCESS");
        v5 = 13;
      }
    }
  }
  else
  {
LABEL_6:
    v5 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StaticListenModeRouting");
  return v5;
}

uint64_t sub_21989A3AC(unsigned int *a1, uint64_t a2)
{
  uint64_t v3;
  uint64_t v4;
  const char *v5;
  int v6;
  unsigned int *v7;
  char v9;
  uint64_t (**v10)();
  uint64_t (*v11)();
  uint64_t v12;
  int v13;
  uint64_t v14;

  v3 = (uint64_t)a1;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_NfceeInitializeComplete");
  if (!v3)
  {
    v5 = "NfceeInitializeComplete:Invalid Context";
    v6 = 2;
    v7 = 0;
LABEL_8:
    sub_219850628(v6, v7, 4u, 1u, (uint64_t)v5);
    a2 = 255;
    goto LABEL_9;
  }
  if (!(_DWORD)a2)
  {
    if (*(_BYTE *)(v3 + 509) == 1)
    {
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 4u, (uint64_t)"eSE ReInit Sequence");
      *(_QWORD *)(v3 + 2912) = off_2550A3678;
      *(_BYTE *)(v3 + 2904) = 0;
      *(_BYTE *)(v3 + 2906) = 0;
      v9 = (char)off_2550A3678[0];
      if (off_2550A3678[0])
      {
        v9 = 0;
        v10 = off_2550A3688;
        do
        {
          ++v9;
          v11 = *v10;
          v10 += 2;
        }
        while (v11);
      }
      *(_BYTE *)(v3 + 2905) = v9;
      if (sub_2198655FC(v3, 0, 0) != 13)
      {
        v5 = "gphNciNfc_EseReInitSequence:Could not start!";
        v6 = 1;
        v7 = (unsigned int *)(v3 + 19368);
        goto LABEL_8;
      }
LABEL_26:
      a2 = 13;
      goto LABEL_9;
    }
    *(_BYTE *)(v3 + 322) = 2;
    v12 = *(_QWORD *)(v3 + 512);
    if (v12)
    {
      v13 = *(_DWORD *)(v12 + 8);
      if (v13 == 7)
        goto LABEL_24;
      if (v13 != 1)
        goto LABEL_25;
      if (*(_BYTE *)(v3 + 2936) == 1)
      {
        v14 = sub_2198E0040(v3, 4u);
        if ((_DWORD)v14 != 255)
          goto LABEL_30;
      }
      if ((*(_BYTE *)(v3 + 2944) != 1 || *(_BYTE *)(v3 + 505) != 1) && *(_BYTE *)(v3 + 317) == 1)
      {
LABEL_24:
        v14 = sub_2198E0040(v3, 2u);
        if ((_DWORD)v14 == 255)
          goto LABEL_25;
LABEL_30:
        a2 = v14;
        goto LABEL_9;
      }
    }
LABEL_25:
    if (sub_21989A264(v3) != 13)
    {
      sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"NfceeInitializeComplete: Listen Mode Routing sequence could not start!");
      a2 = 255;
      if (*(_BYTE *)(v3 + 2883) == 1)
        v4 = 137;
      else
        v4 = 255;
      goto LABEL_6;
    }
    goto LABEL_26;
  }
  sub_219850628(1, (unsigned int *)(v3 + 19368), 4u, 1u, (uint64_t)"NfceeInitializeComplete: HCI Child Device Init Failed");
  if (*(_BYTE *)(v3 + 2883) == 1)
    v4 = 137;
  else
    v4 = 255;
LABEL_6:
  sub_219898F04((unsigned int *)v3, v4);
  v3 = 0;
LABEL_9:
  sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_NfceeInitializeComplete");
  return a2;
}

uint64_t sub_21989A5DC(unsigned int *a1)
{
  uint64_t v1;
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;

  v1 = (uint64_t)a1;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ReleaseMemory");
  if (!v1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 2);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != v1);
  if (v4 == v1)
  {
    sub_2198DA75C(v1);
    sub_2198DC7F0(v1);
    if (*(_QWORD *)(v1 + 3048))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 3048) = 0;
    }
    if (*(_QWORD *)(v1 + 6128))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 6128) = 0;
    }
    if (*(_QWORD *)(v1 + 328))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 328) = 0;
    }
    if (*(_QWORD *)(v1 + 5840))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 5840) = 0;
    }
    if (*(_QWORD *)(v1 + 24))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 24) = 0;
    }
    sub_2198C0850(v1);
    sub_2198BBF5C(v1);
    sub_219888594(*(_QWORD *)(v1 + 19360));
    if (*(_QWORD *)(v1 + 2616))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 2616) = 0;
    }
    v5 = *(_QWORD *)(v1 + 2704);
    if (v5)
    {
      if (*(_QWORD *)(v5 + 32))
      {
        phOsalNfc_FreeMemory();
        v5 = *(_QWORD *)(v1 + 2704);
        *(_QWORD *)(v5 + 32) = 0;
      }
      if (*(_QWORD *)(v5 + 48))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(v1 + 2704) + 48) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 2704) = 0;
    }
    v6 = *(_QWORD *)(v1 + 2696);
    if (v6)
    {
      if (*(_QWORD *)(v6 + 32))
      {
        phOsalNfc_FreeMemory();
        v6 = *(_QWORD *)(v1 + 2696);
        *(_QWORD *)(v6 + 32) = 0;
      }
      if (*(_QWORD *)(v6 + 48))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(v1 + 2696) + 48) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 2696) = 0;
    }
    if (*(_QWORD *)(v1 + 288))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 288) = 0;
    }
    if (*(_QWORD *)(v1 + 6008))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 6008) = 0;
    }
    if (*(_QWORD *)(v1 + 488))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 488) = 0;
    }
    if (*(_QWORD *)(v1 + 3232))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v1 + 3232) = 0;
    }
    phOsalNfc_FreeMemory();
    v1 = 0;
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)v1, 4u, 4u, (uint64_t)"Releasing Lib context has already been done");
  }
  return sub_219850808(2, (unsigned int *)v1, 4u, 5u, (uint64_t)"phLibNfc_ReleaseMemory");
}

uint64_t sub_21989A864(uint64_t a1, uint64_t a2)
{
  unsigned int v4;
  unsigned int v5;
  unsigned int v6;
  __int16 v7;
  char v8;
  char v9;

  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_UpdateStackCapabilities");
  if (a2)
  {
    v4 = *(unsigned __int8 *)(a2 + 2980);
    v5 = *(_DWORD *)(a1 + 56) & 0xFFFE0000;
    v6 = *(_DWORD *)(a1 + 60) & 0xFFFE0000;
    *(_DWORD *)(a1 + 56) = v5;
    *(_DWORD *)(a1 + 60) = v6;
    v7 = *(_WORD *)(a1 + 68) & 0xE000;
    *(_WORD *)(a1 + 68) = v7;
    *(_WORD *)(a1 + 72) &= 0xE000u;
    if (*(_BYTE *)(a2 + 2938) == 1
      || *(_BYTE *)(a2 + 2944) == 1 && !*(_BYTE *)(a2 + 2946)
      || *(_BYTE *)(a2 + 2937) == 1)
    {
      if (((*(_WORD *)(a1 + 68) = v7 | 0x1FF, *(_DWORD *)(a1 + 56) = v5 | 0x21BF, *(_BYTE *)(a2 + 2937))
         || *(_BYTE *)(a2 + 2938))
        && *(_BYTE *)(a2 + 2942) != 1
        && *(_BYTE *)(a2 + 2943) != 1
        && (*(_BYTE *)(a2 + 2939) != 1 || *(_BYTE *)(a2 + 3088) != 2)
        || (*(_WORD *)(a1 + 68) = v7 | 0x1DFF, *(_DWORD *)(a1 + 56) = v5 | 0x1E1BF, *(_BYTE *)(a2 + 2943) != 1)
        && *(_BYTE *)(a2 + 2942) != 1)
      {
        if (*(_BYTE *)(a2 + 3088) != 2)
          *(_DWORD *)(a1 + 60) = v6 | 0x2C;
      }
    }
    *(_BYTE *)(a1 + 42) = 0;
    *(_BYTE *)(a1 + 53) = *(_BYTE *)(a2 + 3025);
    *(_DWORD *)(a1 + 4) = 50987008;
    *(_WORD *)a1 = 1281;
    *(_QWORD *)(a1 + 8) = *(_QWORD *)(a2 + 2980);
    *(_BYTE *)(a1 + 21) = *(_BYTE *)(a2 + 2993);
    *(_DWORD *)(a1 + 16) = *(_DWORD *)(a2 + 2988);
    *(_DWORD *)(a1 + 80) = *(_DWORD *)(a2 + 3148);
    *(_BYTE *)(a1 + 20) = *(_BYTE *)(a2 + 3088);
    *(_WORD *)(a1 + 66) = *(_WORD *)(a2 + 3134);
    phOsalNfc_MemCopy();
    v8 = *(_BYTE *)(a1 + 76);
    v9 = v8 & 0xC0;
    *(_BYTE *)(a1 + 76) = v8 & 0xC0;
    if (*(_BYTE *)(a2 + 2937) == 1)
    {
      *(_BYTE *)(a1 + 76) = v9 | 0x30;
      if (*(_DWORD *)(a1 + 80) != 1)
        return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_UpdateStackCapabilities");
      *(_BYTE *)(a1 + 76) = v9 | 0x3B;
      if (v4 <= 4)
        return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_UpdateStackCapabilities");
LABEL_27:
      *(_BYTE *)(a1 + 76) = v8 | 0x3F;
      return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_UpdateStackCapabilities");
    }
    if (*(_BYTE *)(a2 + 2938) == 1
      && *(_BYTE *)(a2 + 2943) != 1
      && *(_BYTE *)(a2 + 2942) != 1
      && *(_BYTE *)(a2 + 3088) != 2
      || *(_BYTE *)(a2 + 2944) == 1 && !*(_BYTE *)(a2 + 2946))
    {
      goto LABEL_27;
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_UpdateStackCapabilities");
}

uint64_t sub_21989AABC(uint64_t a1)
{
  uint64_t v2;
  int v3;
  int v4;
  int v5;
  int v7;
  int v8;
  int v9;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StopSEInitTimer");
  v2 = *(_QWORD *)(a1 + 536);
  if (*(uint64_t (***)())(a1 + 2912) != off_2550A36D8 || v2 == 0xFFFFFFFFFFFFLL)
  {
    if (v2 == 0xFFFFFFFFFFFFLL || !*(_DWORD *)(a1 + 544))
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StopSEInitTimer");
    v7 = *(_DWORD *)(*(_QWORD *)(a1 + 512) + 8);
    if (v7 == 7)
      goto LABEL_29;
    if (v7 != 2)
    {
      if (v7 != 1)
        return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StopSEInitTimer");
      v8 = *(unsigned __int8 *)(a1 + 504);
      goto LABEL_30;
    }
LABEL_26:
    v8 = *(unsigned __int8 *)(a1 + 505);
    goto LABEL_30;
  }
  if (!*(_DWORD *)(a1 + 544))
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StopSEInitTimer");
  v3 = *(unsigned __int8 *)(a1 + 318) - 1;
  v4 = *(unsigned __int8 *)(a1 + 317) - 1;
  v5 = *(unsigned __int8 *)(a1 + 319) - 1;
  if (((v4 | v3 | v5) & 0xFD) == 0 && *(_BYTE *)(a1 + 2936) == 1)
  {
    if (*(_BYTE *)(a1 + 504) != 1)
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StopSEInitTimer");
    goto LABEL_24;
  }
  if (((v4 | v3) & 0xFD) == 0)
  {
    if (*(_BYTE *)(a1 + 504) != 1)
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StopSEInitTimer");
    goto LABEL_26;
  }
  if (((v5 | v3) & 0xFD) == 0)
  {
    v9 = *(unsigned __int8 *)(a1 + 504);
LABEL_28:
    if (v9 != 1)
      return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StopSEInitTimer");
    goto LABEL_29;
  }
  if (((v5 | v4) & 0xFD) == 0)
  {
LABEL_24:
    v9 = *(unsigned __int8 *)(a1 + 505);
    goto LABEL_28;
  }
  if ((v3 & 0xFD) == 0 && *(_BYTE *)(a1 + 504) == 1 || (v4 & 0xFD) == 0 && *(_BYTE *)(a1 + 505) == 1)
    goto LABEL_31;
  if ((v5 & 0xFD) == 0)
  {
LABEL_29:
    v8 = *(unsigned __int8 *)(a1 + 506);
LABEL_30:
    if (v8 == 1)
LABEL_31:
      sub_219898B20(v2, a1);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_StopSEInitTimer");
}

uint64_t sub_21989AC58(uint64_t a1, int a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  char v8;
  uint64_t v9;
  uint64_t v10;
  const char *v11;
  int v12;
  unsigned int *v13;
  uint64_t v15;

  v15 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ShutdownCb");
  if (!a1)
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Lower layer has passed Null Libnfc context");
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Lower layer may have some issue");
    if (a2)
      sub_219850628(2, 0, 4u, 1u, (uint64_t)"Lower layer Reset Failed");
    goto LABEL_16;
  }
  if (!a2)
  {
    v8 = 0;
    v9 = 0;
    do
    {
      v10 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 2);
      if ((v8 & 1) != 0)
        break;
      v8 = 1;
      v9 = 1;
    }
    while (v10 != a1);
    if (v10 == a1)
    {
      v7 = 0;
      goto LABEL_20;
    }
LABEL_16:
    v11 = "Libnfc context is Null, Can't do anyhting";
    v12 = 2;
    v13 = (unsigned int *)a1;
LABEL_17:
    sub_219850628(v12, v13, 4u, 1u, (uint64_t)v11);
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ShutdownCb");
  }
  sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"Lower layer Reset Failed");
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 2);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a1);
  if (v6 != a1)
    goto LABEL_16;
  if (*(_DWORD *)(a1 + 3176) == 1)
    v7 = 288;
  else
    v7 = 0;
LABEL_20:
  if (*(_QWORD *)(a1 + 6344))
  {
    *(_QWORD *)(a1 + 6344) = 0;
    *(_QWORD *)(a1 + 6352) = 0;
  }
  v15 = *(_QWORD *)(a1 + 19360);
  if (sub_2198D1B2C(v15, 145, v7, a1 + 19360, a1))
  {
    v11 = "State Machine has rejected the event!!!";
    v13 = (unsigned int *)&v15;
    v12 = 0;
    goto LABEL_17;
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ShutdownCb");
}

uint64_t sub_21989AE28(unsigned int *a1)
{
  uint64_t v2;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_Invoke_Pending_Cb");
  if (a1)
  {
    if (sub_2198D8A94((uint64_t)a1))
      v2 = sub_2198BCAEC((uint64_t)a1);
    else
      v2 = 0;
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_Invoke_Pending_Cb");
  return v2;
}

uint64_t sub_21989AEAC(unsigned int *a1, uint64_t a2, unsigned int a3, uint64_t *a4, unsigned __int8 *a5)
{
  uint64_t v10;
  unsigned __int8 v11;
  uint64_t v12;
  int v13;
  uint64_t v14;
  uint64_t v15;
  char v16;
  unsigned int *v17;
  uint64_t v18;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateRtngCfg");
  v10 = 1;
  if (a2)
  {
    if (a4)
    {
      if (a5)
      {
        *a5 = 0;
        if (a3)
        {
          v11 = 0;
          v12 = a3;
          v13 = 1;
          while (1)
          {
            v14 = *a4;
            if (!*a4)
              break;
            if (v14 != 255)
            {
              v15 = a2 + 32 * v11;
              v16 = *(_BYTE *)(v14 + 1);
              v17 = a1;
              v18 = (uint64_t)a4;
LABEL_10:
              if (sub_21989AFE4(v17, v15, v18, v16))
              {
                v10 = 1;
                sub_219850628(2, a1, 4u, 1u, (uint64_t)"Update Rtng config failed!");
                goto LABEL_17;
              }
              v13 = 0;
              ++v11;
            }
            a4 += 5;
            if (!--v12)
            {
              if (v13)
              {
                v10 = 1;
              }
              else
              {
                v10 = 0;
                *a5 = v11;
              }
              goto LABEL_17;
            }
          }
          v15 = a2 + 32 * v11;
          v17 = a1;
          v18 = (uint64_t)a4;
          v16 = 0;
          goto LABEL_10;
        }
      }
    }
  }
LABEL_17:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateRtngCfg");
  return v10;
}

uint64_t sub_21989AFE4(unsigned int *a1, uint64_t a2, uint64_t a3, char a4)
{
  uint64_t v8;
  int v9;
  int v10;
  unsigned int v11;
  unsigned int v12;
  const char *v13;
  int v14;
  unsigned int v15;
  int v16;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateRtngInfo");
  v8 = 1;
  if (a2 && a3)
  {
    v9 = *(_DWORD *)(a3 + 8);
    if (v9 == 2)
    {
      *(_DWORD *)a2 = 2;
      *(_BYTE *)(a2 + 4) = a4;
      v14 = *(_BYTE *)(a2 + 8) & 0xFB | (4 * ((*(unsigned __int8 *)(a3 + 12) >> 2) & 1));
      *(_BYTE *)(a2 + 8) = v14;
      v15 = v14 & 0xFFFFFFFD | (2 * ((*(unsigned __int8 *)(a3 + 12) >> 1) & 1));
      *(_BYTE *)(a2 + 8) = v15;
      *(_BYTE *)(a2 + 8) = v15 & 0xFE | *(_BYTE *)(a3 + 12) & 1;
      if (*(unsigned __int8 *)(a3 + 32) > 0x10u)
      {
        v13 = "Invalid input AID size";
        goto LABEL_16;
      }
      phOsalNfc_MemCopy();
      v8 = 0;
      *(_BYTE *)(a2 + 28) = *(_BYTE *)(a3 + 32);
    }
    else
    {
      if (v9 == 1)
      {
        *(_DWORD *)a2 = 1;
        *(_BYTE *)(a2 + 4) = a4;
        v16 = *(_BYTE *)(a2 + 8) & 0xFB | (4 * ((*(unsigned __int8 *)(a3 + 12) >> 2) & 1));
        *(_BYTE *)(a2 + 8) = v16;
        LOBYTE(v16) = v16 & 0xFD | (2 * ((*(_BYTE *)(a3 + 12) & 2) != 0));
        *(_BYTE *)(a2 + 8) = v16;
        *(_BYTE *)(a2 + 8) = v16 & 0xFE | *(_BYTE *)(a3 + 12) & 1;
        v12 = *(_DWORD *)(a3 + 16);
        if (v12 - 3 >= 3 && v12 != 160)
        {
          v13 = "Invalid Protocol from Upper Layer";
          goto LABEL_16;
        }
      }
      else
      {
        if (v9)
        {
          v13 = "Input SE handle not valid!";
          goto LABEL_16;
        }
        *(_DWORD *)a2 = 0;
        *(_BYTE *)(a2 + 4) = a4;
        v10 = *(_BYTE *)(a2 + 8) & 0xFB | (4 * ((*(unsigned __int8 *)(a3 + 12) >> 2) & 1));
        *(_BYTE *)(a2 + 8) = v10;
        v11 = v10 & 0xFFFFFFFD | (2 * ((*(unsigned __int8 *)(a3 + 12) >> 1) & 1));
        *(_BYTE *)(a2 + 8) = v11;
        *(_BYTE *)(a2 + 8) = v11 & 0xFE | *(_BYTE *)(a3 + 12) & 1;
        v12 = *(_DWORD *)(a3 + 16);
        if (v12 > 2)
        {
          v13 = "Invalid Technology from Upper Layer";
LABEL_16:
          sub_219850628(2, a1, 4u, 1u, (uint64_t)v13);
          goto LABEL_17;
        }
      }
      v8 = 0;
      *(_DWORD *)(a2 + 12) = v12;
    }
  }
LABEL_17:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_UpdateRtngInfo");
  return v8;
}

uint64_t sub_21989B1C4(unsigned int *a1, int a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateInputRtngInfo");
  v6 = 1;
  if (a2 && a1 && a3)
  {
    v7 = 0;
    do
    {
      v8 = *(_QWORD *)(a3 + 40 * v7);
      if (v8)
      {
        v9 = 0;
        while (v8 != *(_QWORD *)&a1[v9 + 86])
        {
          v9 += 4;
          if (v9 == 20)
          {
            v6 = 1;
            sub_219850628(1, a1 + 4842, 4u, 1u, (uint64_t)"Input SE handle not valid!");
            goto LABEL_12;
          }
        }
      }
      ++v7;
    }
    while (v7 != a2);
    v6 = 0;
  }
LABEL_12:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ValidateInputRtngInfo");
  return v6;
}

uint64_t sub_21989B2B0(uint64_t a1)
{
  uint64_t v2;
  uint64_t v4;

  v4 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SM_ProcessDeInit");
  if (a1)
  {
    v2 = *(_QWORD *)(a1 + 19360);
    v4 = v2;
    sub_219897050(a1);
    if (*(_DWORD *)(a1 + 3176) != 1)
      phTmlNfc_IoCtl();
    sub_21989AE28((unsigned int *)a1);
    sub_21989A5DC((unsigned int *)a1);
    sub_21988EEB4(v2, 0);
  }
  sub_219850808(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_ProcessDeInit");
  return 0;
}

uint64_t sub_21989B35C(uint64_t a1, int a2)
{
  unsigned int v4;
  uint64_t v5;
  unsigned int v6;
  uint64_t v7;
  unsigned int v8;
  unsigned int v9;
  unsigned int *v10;
  const char *v11;
  __int16 v12;
  unsigned __int16 v14;

  v14 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Recv4BResp");
  if (!a1)
  {
    v14 = 1;
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    goto LABEL_33;
  }
  if (a2 || (v4 = *(_DWORD *)(a1 + 3768)) == 0 || (v5 = *(_QWORD *)(a1 + 3760)) == 0)
  {
    v12 = 255;
    v14 = 255;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Data Receive Failed..");
    goto LABEL_31;
  }
  v6 = *(_DWORD *)(a1 + 4560);
  v7 = *(_QWORD *)(a1 + 80);
  if (*(_DWORD *)(v7 + 4) != 25 || *(_DWORD *)(v7 + 12) != 1)
  {
    if (v4 >= v6)
      v4 = *(_DWORD *)(a1 + 4560);
    v14 = 0;
    phOsalNfc_MemCopy();
    v12 = 0;
    *(_DWORD *)(a1 + 4560) = v4;
    goto LABEL_31;
  }
  v8 = v4 - 1;
  v9 = *(unsigned __int8 *)(v5 + v4 - 1);
  if (v9 <= 0xAF)
  {
    if (!*(_BYTE *)(v5 + v4 - 1))
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" 3B_PICC XchgData Request is Successful!! ..");
      if (v8 <= v6)
      {
        phOsalNfc_MemCopy();
        *(_DWORD *)(a1 + 4560) = v8;
      }
      else
      {
        v14 = 8;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Mf XchgData,More Data available than requested  ..");
      }
      goto LABEL_30;
    }
    if (v9 != 2)
    {
LABEL_23:
      v14 = 185;
      sub_219886108(*(_QWORD *)(a1 + 6480), v9);
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)" 3B_PICC XchgData,Unknown RF related error Detected by NFCC during Data Exchange ");
      if (v4 <= v6)
      {
        phOsalNfc_MemCopy();
        *(_DWORD *)(a1 + 4560) = v4;
      }
      goto LABEL_30;
    }
    v14 = 181;
    v10 = (unsigned int *)(a1 + 6476);
    v11 = " 3B_PICC XchgData,PH_NCINFC_STATUS_RF_FRAME_CORRUPTED Detected by NFCC during Data Exchange ";
  }
  else
  {
    switch(*(_BYTE *)(v5 + v4 - 1))
    {
      case 0xB0:
        v14 = 182;
        v10 = (unsigned int *)(a1 + 6476);
        v11 = " 3B_PICC XchgData,PH_NCINFC_STATUS_RF_TRANSMISSION_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB1:
        v14 = 183;
        v10 = (unsigned int *)(a1 + 6476);
        v11 = " 3B_PICC XchgData,PH_NCINFC_STATUS_RF_PROTOCOL_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB2:
        v14 = 178;
        v10 = (unsigned int *)(a1 + 6476);
        v11 = " 3B_PICC XchgData,PH_NCINFC_STATUS_RF_TIMEOUT_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB3:
        v14 = 184;
        v10 = (unsigned int *)(a1 + 6476);
        v11 = " 3B_PICC XchgData,PH_NCINFC_STATUS_RF_UNEXPECTED_DAT Detected by NFCC during Data Exchange ";
        break;
      default:
        if (v9 == 190)
        {
          v14 = 187;
          v10 = (unsigned int *)(a1 + 6476);
          v11 = " 3B_PICC XchgData,PH_NCINFC_STATUS_HRM_SE_INIT_REQUIRED Detected by NFCC during Data Exchange ";
        }
        else
        {
          if (v9 != 191)
            goto LABEL_23;
          v14 = 186;
          v10 = (unsigned int *)(a1 + 6476);
          v11 = " 3B_PICC XchgData,PH_NCINFC_STATUS_HRM_TIMER_RUNNING Detected by NFCC during Data Exchange ";
        }
        break;
    }
  }
  sub_219850628(1, v10, 3u, 2u, (uint64_t)v11);
LABEL_30:
  sub_2198F1654(a1, &v14);
  v12 = v14;
LABEL_31:
  *(_WORD *)(a1 + 4592) = v12;
  if (*(_QWORD *)(a1 + 4600))
  {
    *(_DWORD *)(a1 + 4608) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Freeing Send Request Payload Buffer..");
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 4600) = 0;
  }
LABEL_33:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Recv4BResp");
  return v14;
}

uint64_t sub_21989B6B4(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  int v5;
  uint64_t Memory;
  __int128 v7;
  __int128 v8;

  v7 = 0u;
  v8 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Send4BData");
  if (a1)
  {
    v2 = *(_QWORD *)(a1 + 4512);
    if (v2)
    {
      if (*(_DWORD *)(a1 + 4544))
      {
        phOsalNfc_SetMemory();
        LODWORD(v7) = 0;
        if (sub_219878C88((unsigned int *)a1, v2, (_BYTE *)((unint64_t)&v7 | 0xC)))
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Couldn't Get ConnId..");
          v3 = 255;
        }
        else
        {
          v5 = *(_DWORD *)(a1 + 4544);
          *(_DWORD *)(a1 + 4608) = 0;
          *(_QWORD *)(a1 + 4600) = 0;
          Memory = phOsalNfc_GetMemory();
          *(_QWORD *)(a1 + 4600) = Memory;
          if (Memory)
          {
            *(_DWORD *)(a1 + 4608) = v5;
            phOsalNfc_SetMemory();
            if (v5)
              phOsalNfc_MemCopy();
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" 4B Payload created successfully..");
            *(_QWORD *)&v8 = *(_QWORD *)(a1 + 4600);
            DWORD2(v8) = *(_DWORD *)(a1 + 4608);
            v3 = sub_2198F2D0C(a1 + 888, (uint64_t)&v7, a1 + 3760, *(unsigned __int16 *)(a1 + 4526), (uint64_t)sub_2198F135C, a1);
            *(_WORD *)(a1 + 4526) = 0;
            if ((_DWORD)v3 != 13)
            {
              phOsalNfc_FreeMemory();
              *(_QWORD *)(a1 + 4600) = 0;
              *(_DWORD *)(a1 + 4608) = 0;
            }
          }
          else
          {
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Payload MemAlloc for Send request Failed..");
            v3 = 12;
          }
        }
      }
      else
      {
        v3 = 1;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Length..");
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Device..");
      v3 = 6;
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v3 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Send4BData");
  return v3;
}

uint64_t sub_21989B8E8(uint64_t a1, uint64_t a2, unsigned int a3, uint64_t a4, _DWORD *a5)
{
  uint64_t v7;
  int v8;
  unsigned int v9;
  uint64_t v10;
  int v11;
  uint64_t Memory;
  unsigned int v14;

  v14 = a3;
  v7 = 1;
  sub_219850718(1, &v14, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigDriverTrans");
  if (a4 && a5)
  {
    v14 = a5[10];
    v8 = phOsalNfc_Init();
    if (v8)
    {
      LODWORD(v7) = v8;
      sub_219850628(1, &v14, 4u, 1u, (uint64_t)"OSAL Init failed");
      if ((_DWORD)v7 == 50)
        v7 = 147;
      else
        v7 = v7;
    }
    else
    {
      sub_219885DF4(a5[10], a5 + 20);
      v9 = a5[10];
      if (v9 <= 1)
      {
        v10 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 10);
        if (v10)
        {
          if (*(_QWORD *)(v10 + 104))
          {
            phOsalNfc_FreeMemory();
            *(_QWORD *)(v10 + 104) = 0;
          }
          phOsalNfc_SetMemory();
          v11 = a5[34];
          if ((v11 - 0x8000) <= 0xF2000)
          {
            *(_DWORD *)(v10 + 100) = v11;
            Memory = phOsalNfc_GetMemory();
            *(_QWORD *)(v10 + 104) = Memory;
            if (Memory)
            {
              *(_WORD *)(v10 + 112) = 0;
              *(_DWORD *)(v10 + 96) = 0;
            }
            else
            {
              sub_219850628(1, a5 + 10, 4u, 2u, (uint64_t)"Failed to allocate memory for circular buffer");
              *(_DWORD *)(v10 + 100) = 0;
            }
          }
        }
      }
      v7 = phTmlNfc_Init();
      if ((_DWORD)v7)
      {
        sub_219850628(1, &v14, 4u, 1u, (uint64_t)"TML Init failed");
        phOsalNfc_DeInit();
      }
      else
      {
        sub_219885FF8(1, a5 + 10, 4u, 4u, (uint64_t)"phLibNfc_SM_ConfigDriverTrans: Driver Handle Returned");
        sub_219885FF8(1, a5 + 10, 4u, 4u, (uint64_t)"(uint64_t)pInDriverHandle");
      }
    }
  }
  sub_219850808(1, &v14, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigDriverTrans");
  return v7;
}

uint64_t sub_21989BAEC(uint64_t a1, uint64_t a2, uint64_t a3, int *a4)
{
  uint64_t v5;
  char v6;
  char v7;
  unsigned int v8;
  uint64_t v9;
  uint64_t v11;

  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigMwLoggingTrans");
  v5 = 0;
  v6 = 1;
  while (1)
  {
    v7 = v6;
    if (*((_QWORD *)&unk_253E46700 + 14 * v5) == v11)
      break;
    v6 = 0;
    v5 = 1;
    if ((v7 & 1) == 0)
    {
      v8 = 255;
      if (a4)
        goto LABEL_5;
LABEL_8:
      v9 = 1;
      goto LABEL_9;
    }
  }
  v8 = *((_DWORD *)&unk_253E46700 + 28 * v5 + 2);
  if (!a4)
    goto LABEL_8;
LABEL_5:
  v9 = sub_219885DF4(v8, a4);
  if ((_DWORD)v9)
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"phLogNfc_ConfigureMwLogging failed");
LABEL_9:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigMwLoggingTrans");
  return v9;
}

uint64_t sub_21989BBD4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;

  v7 = a1;
  sub_219850718(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlVenResetTrans");
  if (!(_DWORD)a3)
  {
    if (a4)
      a3 = phTmlNfc_IoCtl();
    else
      a3 = 1;
  }
  sub_219850808(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlVenResetTrans");
  return a3;
}

uint64_t sub_21989BC5C(uint64_t a1)
{
  uint64_t v1;
  uint64_t v2;
  uint64_t v3;
  char v4;
  uint64_t (**v5)();
  uint64_t (*v6)();
  uint64_t v7;
  unsigned __int8 *v8;
  uint64_t v9;
  const char *v11;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_InitTrans");
  sub_21988EDF4(v15, &v14);
  v1 = v14;
  if (v14)
  {
    if (*(_DWORD *)(v14 + 19368) == 1 && *(_DWORD *)(v14 + 3156) == 2)
    {
      if (phTmlNfc_IoCtl())
      {
        sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"MultiTag Detection failed to Enable CRC");
        v2 = 255;
LABEL_18:
        v11 = "MultiTag Detection MW Init Fialed";
LABEL_19:
        sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)v11);
        goto LABEL_20;
      }
      v7 = v14;
      v8 = (unsigned __int8 *)(v14 + 3230);
      *(_BYTE *)(v14 + 3230) = 2;
      v2 = sub_219891ED8(v7, 0, v8);
      sub_2199013F4(*(_QWORD *)(v14 + 3040), 1);
      sub_21990135C(*(_QWORD *)(v14 + 3040), 1);
      if ((_DWORD)v2 != 13)
        goto LABEL_18;
      *(_BYTE *)(v14 + 6032) = 0;
      v9 = phOsalNfc_Timer_Create();
      *(_QWORD *)(v14 + 3192) = v9;
      if (v9 != 0xFFFFFFFFFFFFLL && v9 != 0)
      {
        sub_219850628(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"MultiTag Detection NTF Timer Created Successfully");
        sub_2198FCF54(*(_QWORD *)(v14 + 3040), 19, (uint64_t)sub_2198EC918, v14);
        v13 = phOsalNfc_Timer_Start();
        if (!(_DWORD)v13)
        {
          sub_21988629C(1, (unsigned int *)(v14 + 19368), *(_QWORD *)(v14 + 3192), 4u, 4u, (uint64_t)"phLibNfc_SM_InitTrans");
          sub_219850628(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"MultiTag Detection NTF Timer Started");
          v2 = 13;
          goto LABEL_20;
        }
        v2 = v13;
        v11 = "MultiTag Detection NTF Timer Start failed";
        goto LABEL_19;
      }
      sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"MultiTag Detection NTF Timer Create failed");
      v2 = 12;
    }
    else
    {
      v3 = v14 + 3230;
      *(_BYTE *)(v14 + 3230) = 0;
      *(_QWORD *)(v1 + 2912) = off_2550A11E0;
      *(_BYTE *)(v1 + 2904) = 0;
      *(_BYTE *)(v1 + 2906) = 0;
      v4 = (char)off_2550A11E0[0];
      if (off_2550A11E0[0])
      {
        v4 = 0;
        v5 = off_2550A11F0;
        do
        {
          ++v4;
          v6 = *v5;
          v5 += 2;
        }
        while (v6);
      }
      *(_BYTE *)(v1 + 2905) = v4;
      v2 = sub_2198655FC(v1, 0, v3);
    }
  }
  else
  {
    v2 = 1;
  }
LABEL_20:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_InitTrans");
  return v2;
}

uint64_t sub_21989BEE8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t *a4)
{
  uint64_t v6;
  uint64_t v7;
  char v8;
  char v9;
  uint64_t v10;
  unsigned int v11;
  uint64_t v12;
  unsigned __int8 v13;
  uint64_t v15;

  v15 = a1;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_UnConfigDriverTrans");
  if (a4)
  {
    v6 = 0;
    v7 = *a4;
    v15 = *a4;
    v8 = 1;
    while (1)
    {
      v9 = v8;
      if (*((_QWORD *)&unk_253E46700 + 14 * v6) == v7)
        break;
      v8 = 0;
      v6 = 1;
      if ((v9 & 1) == 0)
      {
        v10 = 0;
        goto LABEL_11;
      }
    }
    v11 = *((_DWORD *)&unk_253E46700 + 28 * v6 + 2);
    if (v11 > 1)
    {
      v10 = 0;
    }
    else
    {
      v12 = *((_QWORD *)&unk_253E46700 + 14 * v11 + 10);
      if (v12)
        v10 = v12 + 96;
      else
        v10 = 0;
    }
LABEL_11:
    if (phTmlNfc_ReadAbort())
      sub_219851888(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"phTmlNfc_ReadAbort Status");
    if (phTmlNfc_FlushTxRxBuffers())
      sub_219851888(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"phTmlNfc_FlushTxRxBuffers Status");
    if (phTmlNfc_WriteAbort())
      sub_219851888(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"phTmlNfc_WriteAbort Status");
    sub_21988F804(v15, 0);
    v13 = phTmlNfc_Shutdown();
    a3 = v13;
    if (v13)
      sub_219851888(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"phTmlNfc_Shutdown Status");
    if (v10 && *(_QWORD *)(v10 + 8))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(v10 + 8) = 0;
    }
    sub_219885F70(0, (unsigned int *)&v15, 4u, 1, (uint64_t)"phLibNfc_SM_UnConfigDriverTrans");
    phOsalNfc_DeInit();
  }
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_UnConfigDriverTrans");
  return a3;
}

uint64_t sub_21989C0E4(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4, uint64_t a5)
{
  uint64_t v8;
  char v9;
  char v10;
  uint64_t v11;
  uint64_t v12;
  _BOOL4 v13;
  uint64_t Memory;
  uint64_t v15;
  _DWORD *v16;
  uint64_t v17;
  char v18;
  uint64_t (**v19)();
  uint64_t (*v20)();
  int v21;
  int v22;
  int v24;
  unsigned int v25;
  uint64_t v26;
  int v27;
  uint64_t v28;

  v28 = a1;
  v27 = 0;
  v26 = 0;
  sub_219850718(0, (unsigned int *)&v28, 4u, 5u, (uint64_t)"phLibNfc_SM_CfgTestModeTrans");
  sub_21988ED38(v28, &v27);
  v8 = 0;
  v9 = 1;
  while (1)
  {
    v10 = v9;
    if (*((_QWORD *)&unk_253E46700 + 14 * v8) == v28)
      break;
    v9 = 0;
    v8 = 1;
    if ((v10 & 1) == 0)
    {
      v11 = 255;
      goto LABEL_6;
    }
  }
  v11 = *((unsigned int *)&unk_253E46700 + 28 * v8 + 2);
LABEL_6:
  sub_21988EB80(v28, &v26);
  v12 = 1;
  if (!a4 || !a5 || !v26)
    goto LABEL_24;
  if ((v27 & 0xFFFFFFFD) != 4)
    a3 = phTmlNfc_ConfigHsuBaudRate();
  if ((_DWORD)a3)
  {
    sub_219851790(0, (unsigned int *)&v28, 4u, 1u, (uint64_t)"ConfigTestModeTrans- Set Default Baud Rate FAILED, Status");
    v12 = a3;
    goto LABEL_24;
  }
  sub_219851790(0, (unsigned int *)&v28, 4u, 4u, (uint64_t)"ConfigTestModeTrans: TML HSU Baud rate Set to");
  if (*(_DWORD *)(v26 + 192) == 1)
  {
    if (!phTmlNfc_IoCtl())
    {
      v13 = 0;
      if (!sub_2198972CC(v11, v28))
        goto LABEL_16;
    }
LABEL_23:
    sub_219851790(0, (unsigned int *)&v28, 4u, 1u, (uint64_t)"Failed to switch to Normal mode!");
    v12 = 255;
    goto LABEL_24;
  }
  v22 = phTmlNfc_IoCtl();
  v13 = v22 == 0;
  if (v22)
    goto LABEL_23;
LABEL_16:
  Memory = phOsalNfc_GetMemory();
  if (Memory)
  {
    v15 = Memory;
    v16 = (_DWORD *)(Memory + 19328);
    phOsalNfc_SetMemory();
    sub_21988EEB4(v28, v15);
    *v16 = *a4;
    v17 = v28;
    *(_QWORD *)(v15 + 2952) = v28;
    *(_QWORD *)(v15 + 19360) = v17;
    v16[10] = v11;
    *(_DWORD *)(v15 + 3176) = *(_DWORD *)(v26 + 192);
    *(_QWORD *)(v15 + 2912) = off_2550A3D58;
    *(_BYTE *)(v15 + 2904) = 0;
    *(_BYTE *)(v15 + 2906) = 0;
    v18 = (char)off_2550A3D58[0];
    if (off_2550A3D58[0])
    {
      v18 = 0;
      v19 = off_2550A3D68;
      do
      {
        ++v18;
        v20 = *v19;
        v19 += 2;
      }
      while (v20);
    }
    *(_BYTE *)(v15 + 2905) = v18;
    v21 = sub_2198655FC(v15, 0, 0);
    if (v21 == 13)
    {
      *(_QWORD *)(v15 + 3040) = sub_2198FBC30(*(_QWORD *)(v15 + 2952));
      sub_21988EEB4(v28, v15);
      v12 = 13;
      goto LABEL_24;
    }
    v24 = v21;
    phOsalNfc_SetMemory();
    phOsalNfc_FreeMemory();
    sub_21988EEB4(v28, 0);
    if (v24 == 143)
      v25 = 143;
    else
      v25 = 255;
    if (v24 == 179)
      v12 = 180;
    else
      v12 = v25;
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v28, 4u, 1u, (uint64_t)"phLibNfc_SM_ConfigTestModeTrans: INSUFFICIENT_RESOURCES");
    v12 = 12;
  }
  if (v13)
    phTmlNfc_IoCtl();
LABEL_24:
  sub_219850808(0, (unsigned int *)&v28, 4u, 5u, (uint64_t)"phLibNfc_SM_CfgTestModeTrans");
  return v12;
}

uint64_t sub_21989C404(uint64_t a1, uint64_t a2, uint64_t a3, unsigned __int8 **a4)
{
  uint64_t v5;
  unsigned int v6;
  uint64_t v7;
  char v8;
  uint64_t v9;
  uint64_t v10;
  const char *v11;
  uint64_t v12;
  unsigned int v13;
  char v14;
  uint64_t v15;
  unsigned int *v16;
  int v18;
  uint64_t v19;
  uint64_t v20;
  uint64_t v21;

  v20 = 0;
  v21 = a1;
  v19 = 0;
  v18 = 8;
  sub_219850718(0, (unsigned int *)&v21, 4u, 5u, (uint64_t)"phLibNfc_SM_ResetNtfTrans");
  sub_21988ED38(v21, &v18);
  sub_21988EDF4(v21, &v20);
  sub_21988EB80(v21, &v19);
  v5 = 1;
  if (a4 && v20 && v19)
  {
    if (!*a4 || *((_DWORD *)a4 + 2) < 2u)
      goto LABEL_26;
    *(_BYTE *)(v20 + 308) = **a4;
    v6 = **a4;
    if (v6 <= 0xA0)
    {
      if (**a4)
      {
        if (v6 == 160)
        {
          sub_219850628(0, (unsigned int *)&v21, 4u, 1u, (uint64_t)"LibNfc Reset Handler: Received Proprietary reset notification");
          if (*((_DWORD *)a4 + 2) == 6)
            phOsalNfc_MemCopy();
LABEL_26:
          v12 = v20;
          if (*(_BYTE *)(v20 + 2936) == 1
            || *(_BYTE *)(v20 + 2937) == 1
            || *(_BYTE *)(v20 + 2938) == 1
            || *(_BYTE *)(v20 + 2944) == 1)
          {
            sub_2199013F4(*(_QWORD *)(v20 + 3040), 0);
            sub_21990135C(*(_QWORD *)(v20 + 3040), 0);
            v12 = v20;
            *(_DWORD *)(v20 + 5404) = 0;
            if (v18 == 6)
            {
              phTmlNfc_IoCtl();
              v12 = v20;
            }
          }
          v13 = ++*(_BYTE *)(v12 + 3160);
          if (v13 <= 1 && sub_219896DDC(v12, (uint64_t)sub_21989690C, 0) == 13)
          {
            v5 = 13;
            goto LABEL_42;
          }
          sub_219850628(0, (unsigned int *)&v21, 4u, 1u, (uint64_t)"phLibNfc_ResetNtfHandler: NFCC Reset recovery failed");
          sub_21989690C(*(_QWORD *)(v20 + 19360), v20, 0);
          v7 = v20;
          if (v20)
          {
            v14 = 0;
            v15 = 0;
            do
            {
              v10 = *((_QWORD *)&unk_253E46700 + 14 * v15 + 2);
              if ((v14 & 1) != 0)
                break;
              v14 = 1;
              v15 = 1;
            }
            while (v10 != v20);
LABEL_39:
            if (v10 == v7)
            {
              sub_219897050(v7);
              sub_2198FF49C(*(unsigned int **)(v20 + 3040), 2, 0, 0);
              v16 = (unsigned int *)v20;
              *(_QWORD *)(v20 + 3040) = 0;
              sub_21989A5DC(v16);
              v20 = 0;
              sub_21988EEB4(v21, 0);
            }
            goto LABEL_41;
          }
          goto LABEL_41;
        }
LABEL_25:
        sub_219851888(0, (unsigned int *)&v21, 4u, 1u, (uint64_t)"LibNfc Reset Handler: Received NCI reset notification with reason code =");
        goto LABEL_26;
      }
      v11 = "LibNfc Reset Handler: Received NCI reset notification";
LABEL_24:
      sub_219850628(0, (unsigned int *)&v21, 4u, 1u, (uint64_t)v11);
      goto LABEL_26;
    }
    if (v6 == 161)
    {
      v11 = "LibNfc Reset Handler: Received Proprietary reset notification triggered by over temperature";
      goto LABEL_24;
    }
    if (v6 != 165)
      goto LABEL_25;
    sub_219850628(0, (unsigned int *)&v21, 4u, 1u, (uint64_t)"LibNfc Reset Handler: RESET NTF - NO Uart Msg Rxd");
    if (*(_QWORD *)(v20 + 6056) || *(_QWORD *)(v20 + 6104) || *(_QWORD *)(v19 + 24) || *(_QWORD *)(v20 + 6072))
    {
      sub_21989690C(*(_QWORD *)(v20 + 19360), v20, 132);
      v7 = v20;
      if (v20)
      {
        v8 = 0;
        v9 = 0;
        do
        {
          v10 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 2);
          if ((v8 & 1) != 0)
            break;
          v8 = 1;
          v9 = 1;
        }
        while (v10 != v20);
        goto LABEL_39;
      }
LABEL_41:
      v5 = 255;
    }
  }
LABEL_42:
  sub_219850808(0, (unsigned int *)&v21, 4u, 5u, (uint64_t)"phLibNfc_SM_ResetNtfTrans");
  return v5;
}

uint64_t sub_21989C76C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v4;
  char v5;
  uint64_t v6;
  char v7;
  unsigned int v8;
  uint64_t v9;
  int *v10;
  uint64_t v11;
  unsigned int v12;
  unsigned int v13;
  BOOL v14;
  int v15;
  _DWORD *v16;
  _WORD *v17;
  uint64_t v19;

  v19 = a1;
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_GetDebugInfoTrans");
  v4 = 0;
  v5 = 1;
  v6 = v19;
  while (1)
  {
    v7 = v5;
    if (*((_QWORD *)&unk_253E46700 + 14 * v4) == v19)
      break;
    v5 = 0;
    v4 = 1;
    if ((v7 & 1) == 0)
      goto LABEL_37;
  }
  v8 = *((_DWORD *)&unk_253E46700 + 28 * v4 + 2);
  if (v8 <= 1)
  {
    v9 = *((_QWORD *)&unk_253E46700 + 14 * v8 + 10);
    if (v9)
    {
      *(_BYTE *)(v9 + 113) = 1;
      if (*(_QWORD *)(v9 + 120))
      {
        if (v8)
          v10 = &dword_253E47158;
        else
          v10 = &dword_253E47070;
        sub_21987A3C8(v6, (uint64_t)v10);
        **(_QWORD **)(v9 + 120) = sub_2198EEA6C(v8);
        phOsalNfc_SetMemory();
      }
      v11 = *(_QWORD *)(v9 + 128);
      if (!v11)
        goto LABEL_32;
      if (*(_QWORD *)(v9 + 104))
      {
        v12 = *(_DWORD *)(v9 + 96);
        v13 = *(_DWORD *)(v11 + 8);
        if (*(_BYTE *)(v9 + 112))
          v14 = v13 > v12;
        else
          v14 = 0;
        if (v14)
        {
          if (v13 >= *(_DWORD *)(v9 + 100))
            v13 = *(_DWORD *)(v9 + 100);
          *(_DWORD *)(v11 + 8) = v13;
          if (*(_QWORD *)v11)
            phOsalNfc_MemCopy();
          else
            sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)"NULL pointer access !!");
          if (!**(_QWORD **)(v9 + 128) || !*(_QWORD *)(v9 + 104))
          {
            sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)"NULL pointer access !!");
            goto LABEL_32;
          }
        }
        else
        {
          if (v12 >= v13)
            v15 = *(_DWORD *)(v11 + 8);
          else
            v15 = *(_DWORD *)(v9 + 96);
          *(_DWORD *)(v11 + 8) = v15;
        }
        phOsalNfc_MemCopy();
      }
      else
      {
        sub_219850628(0, (unsigned int *)&v19, 4u, 4u, (uint64_t)"Circular buffer memory does not exist");
        *(_DWORD *)(*(_QWORD *)(v9 + 128) + 8) = 0;
      }
LABEL_32:
      v16 = *(_DWORD **)(v9 + 144);
      if (v16)
      {
        *v16 = *(_DWORD *)(v9 + 156);
        *(_DWORD *)(v9 + 156) = 136;
      }
      v17 = *(_WORD **)(v9 + 136);
      if (v17)
      {
        *v17 = *(_WORD *)(v9 + 152);
        *(_WORD *)(v9 + 152) = 0;
      }
      *(_BYTE *)(v9 + 113) = 0;
    }
  }
LABEL_37:
  sub_219850808(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_GetDebugInfoTrans");
  return a3;
}

uint64_t sub_21989C9BC(uint64_t a1, uint64_t a2, int a3, uint64_t a4)
{
  uint64_t v6;
  char v7;
  char v8;
  uint64_t v9;
  int v10;
  const char *v11;
  uint64_t v12;
  BOOL v14;
  _BOOL4 v15;
  char v16;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;
  char v20;
  uint64_t (**v21)();
  uint64_t (*v22)();
  uint64_t Memory;
  uint64_t v24;
  uint64_t v25;
  char v26;
  uint64_t (**v27)();
  uint64_t (*v28)();
  int v29;
  int v30;
  uint64_t v31;
  char v32;
  int v33;
  uint64_t v34;

  v34 = a1;
  v33 = 8;
  v32 = 0;
  v31 = 0;
  sub_219850718(0, (unsigned int *)&v34, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetSysConfigTrans");
  sub_21988F690(v34, 0);
  sub_21988EB80(v34, &v31);
  sub_21988ED38(v34, &v33);
  v6 = 0;
  v7 = 1;
  do
  {
    v8 = v7;
    if (*((_QWORD *)&unk_253E46700 + 14 * v6) == v34)
    {
      v9 = *((unsigned int *)&unk_253E46700 + 28 * v6 + 2);
      if (!a4)
        goto LABEL_12;
      goto LABEL_7;
    }
    v7 = 0;
    v6 = 1;
  }
  while ((v8 & 1) != 0);
  v9 = 255;
  if (!a4)
    goto LABEL_12;
LABEL_7:
  if (!v34 || !v31)
  {
LABEL_12:
    sub_219850628(0, (unsigned int *)&v34, 4u, 1u, (uint64_t)"IoctlSetRfPropConfigTrans: Failed");
LABEL_19:
    v12 = 255;
    goto LABEL_20;
  }
  v10 = *(unsigned __int8 *)(v31 + 824);
  sub_21988F690(v34, 1);
  if (v10 == 1)
  {
    if (a3)
    {
      v11 = "phLibNfc_SM_IoctlSetSysConfigTrans- Inconsistent Input buffer, Status";
LABEL_18:
      sub_219851790(0, (unsigned int *)&v34, 4u, 1u, (uint64_t)v11);
      goto LABEL_19;
    }
    if (*(_DWORD *)(v31 + 192) == 1)
    {
      phTmlNfc_IoCtl();
      sub_2198972CC(v9, v34);
      v14 = 0;
    }
    else
    {
      v14 = phTmlNfc_IoCtl() == 0;
    }
    v12 = phTmlNfc_ConfigureSpmi();
    if (!(_DWORD)v12)
    {
      Memory = phOsalNfc_GetMemory();
      if (Memory)
      {
        v24 = Memory;
        phOsalNfc_SetMemory();
        sub_21988EEB4(v34, v24);
        v25 = v34;
        *(_QWORD *)(v24 + 2952) = v34;
        *(_QWORD *)(v24 + 19360) = v25;
        *(_DWORD *)(v24 + 19368) = v9;
        *(_QWORD *)(v24 + 2912) = gphLibNfc_SysConfigSeq;
        *(_BYTE *)(v24 + 2904) = 0;
        *(_BYTE *)(v24 + 2906) = 0;
        v26 = (char)gphLibNfc_SysConfigSeq[0];
        if (gphLibNfc_SysConfigSeq[0])
        {
          v26 = 0;
          v27 = off_2550A0B48;
          do
          {
            ++v26;
            v28 = *v27;
            v27 += 2;
          }
          while (v28);
        }
        *(_BYTE *)(v24 + 2905) = v26;
        v29 = sub_2198655FC(v24, 0, 0);
        if (v29 == 13)
        {
          *(_QWORD *)(v24 + 3040) = sub_2198FBC30(*(_QWORD *)(v24 + 2952));
          v12 = 13;
          goto LABEL_20;
        }
        v30 = v29;
        phTmlNfc_ReadAbort();
        phOsalNfc_SetMemory();
        phOsalNfc_FreeMemory();
        sub_21988EEB4(v34, 0);
        if (v30 == 143)
          v12 = 143;
        else
          v12 = 255;
        sub_21988F690(v34, 0);
      }
      else
      {
        sub_219850628(0, (unsigned int *)&v34, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlSetSysConfigTrans: INSUFFICIENT_RESOURCES");
        v12 = 12;
      }
    }
    v16 = !v14;
    if ((_DWORD)v12 == 13)
      v16 = 1;
    if ((v16 & 1) == 0)
      goto LABEL_51;
  }
  else if (sub_21986C188(v34, *(_QWORD *)a4, *(_DWORD *)(a4 + 8), &v32, 2) || !v32)
  {
    v12 = 1;
    sub_219851790(0, (unsigned int *)&v34, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlSetSysConfigTrans- Inconsistent Input buffer ");
  }
  else
  {
    if ((v33 & 0xFFFFFFFD) != 4 && phTmlNfc_ConfigHsuBaudRate())
    {
      v11 = "phLibNfc_SM_IoctlSetSysConfigTrans- Set Default Baud Rate FAILED, Status";
      goto LABEL_18;
    }
    sub_219851790(0, (unsigned int *)&v34, 4u, 4u, (uint64_t)"phLibNfc_SM_IoctlSetSysConfigTrans: TML HSU Baud rate Set to");
    if (*(_DWORD *)(v31 + 192) == 1)
    {
      phTmlNfc_IoCtl();
      sub_2198972CC(v9, v34);
      v15 = 0;
    }
    else
    {
      v15 = phTmlNfc_IoCtl() == 0;
    }
    v17 = phOsalNfc_GetMemory();
    if (v17)
    {
      v18 = v17;
      phOsalNfc_SetMemory();
      sub_21988EEB4(v34, v18);
      v19 = v34;
      *(_QWORD *)(v18 + 2952) = v34;
      *(_QWORD *)(v18 + 19360) = v19;
      *(_DWORD *)(v18 + 19368) = v9;
      *(_DWORD *)(v18 + 3176) = *(_DWORD *)(v31 + 192);
      *(_BYTE *)(v18 + 3520) = v32;
      *(_QWORD *)(v18 + 3528) = *(_QWORD *)a4;
      *(_QWORD *)(v18 + 2912) = gphLibNfc_SysConfigSeq;
      *(_BYTE *)(v18 + 2904) = 0;
      *(_BYTE *)(v18 + 2906) = 0;
      v20 = (char)gphLibNfc_SysConfigSeq[0];
      if (gphLibNfc_SysConfigSeq[0])
      {
        v20 = 0;
        v21 = off_2550A0B48;
        do
        {
          ++v20;
          v22 = *v21;
          v21 += 2;
        }
        while (v22);
      }
      *(_BYTE *)(v18 + 2905) = v20;
      v12 = sub_2198655FC(v18, 0, 0);
      if ((_DWORD)v12 == 13)
      {
        *(_QWORD *)(v18 + 3040) = sub_2198FBC30(*(_QWORD *)(v18 + 2952));
        goto LABEL_20;
      }
      phTmlNfc_ReadAbort();
      phOsalNfc_SetMemory();
      phOsalNfc_FreeMemory();
      sub_21988EEB4(v34, 0);
      if ((_DWORD)v12 == 143)
        v12 = 143;
      else
        v12 = 255;
      sub_21988F690(v34, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v34, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlSetSysConfigTrans: INSUFFICIENT_RESOURCES");
      v12 = 12;
    }
    if (v15)
LABEL_51:
      phTmlNfc_IoCtl();
  }
LABEL_20:
  sub_219850808(0, (unsigned int *)&v34, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetSysConfigTrans");
  return v12;
}

uint64_t sub_21989CED0(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  unsigned int *v7;
  unsigned int *v8;
  _QWORD *v9;
  void (*v10)(uint64_t, uint64_t, uint64_t *, uint64_t);
  uint64_t v11;
  _QWORD *v12;
  void (*v13)(uint64_t, uint64_t, uint64_t, uint64_t);
  uint64_t v14;
  void (*v15)(uint64_t, uint64_t, uint64_t);
  uint64_t v16;
  unsigned int *v17;
  int v18;
  uint64_t v19;
  uint64_t v20;
  char v21;
  uint64_t v22;
  uint64_t v23;
  const char *v24;
  uint64_t *v26;
  unsigned int *v27;
  uint64_t v28;
  uint64_t v29;
  uint64_t v30;

  v29 = 0;
  v30 = a1;
  v27 = 0;
  v28 = 0;
  v26 = 0;
  sub_219850718(0, (unsigned int *)&v30, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_IdleTransComplete");
  sub_21988EDF4(v30, &v27);
  sub_21988EB80(v30, &v26);
  if ((_DWORD)a3)
    sub_219886108(v30, a3);
  else
    sub_21988620C(v30, 0);
  v7 = v27;
  if (!v27)
    goto LABEL_39;
  if (a2 > 138)
  {
    if (a2 != 139)
    {
      if (a2 == 141)
      {
        sub_2198AA74C(v27, a3);
        goto LABEL_39;
      }
      if (a2 == 210)
      {
        v12 = v26;
        if (!v26)
        {
          v24 = "phLibNfc_SM_Main_IdleTransComplete: phLibNfc_SM_Dnld_eMemDump:Invalid IOCTL context!!";
          goto LABEL_38;
        }
        v13 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t))v26[3];
        v14 = *v26;
        v26[3] = 0;
        *v12 = 0;
        if (v13)
        {
          sub_219851790(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"Get Memory Dump:Invoking callback function, wStatus = ");
          sub_219885F70(0, (unsigned int *)&v30, 4u, 10, (uint64_t)"phLibNfc_SM_Main_IdleTransComplete");
          v13(v30, v14, a4, a3);
        }
      }
      goto LABEL_39;
    }
    v15 = (void (*)(uint64_t, uint64_t, uint64_t))*((_QWORD *)v27 + 767);
    v16 = *((_QWORD *)v27 + 768);
    v30 = *((_QWORD *)v27 + 2420);
    sub_21989B2B0((uint64_t)v27);
    v27 = 0;
    if (!v15)
      goto LABEL_39;
    sub_219851790(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"ShutdownCb:Invoking callback function, wStatus = ");
    v17 = (unsigned int *)&v30;
    v18 = 0;
    v19 = 116;
LABEL_34:
    sub_219885F70(v18, v17, 4u, v19, (uint64_t)"phLibNfc_SM_Main_IdleTransComplete");
    v15(v30, v16, a3);
    goto LABEL_39;
  }
  if (a2 == 5)
  {
    v15 = (void (*)(uint64_t, uint64_t, uint64_t))*((_QWORD *)v27 + 757);
    v16 = *((_QWORD *)v27 + 758);
    *((_QWORD *)v27 + 758) = 0;
    *((_QWORD *)v7 + 757) = 0;
    v30 = *((_QWORD *)v7 + 2420);
    if (!v15)
      goto LABEL_39;
    v17 = v7 + 4842;
    v18 = 1;
    v19 = 3;
    goto LABEL_34;
  }
  if (a2 != 36)
  {
    if (a2 != 124)
      goto LABEL_39;
    if (v26)
    {
      sub_21988F690(v30, 0);
      if (v26[2])
      {
        sub_219897050((uint64_t)v27);
        sub_2198FF49C(*((unsigned int **)v27 + 380), 2, 0, 0);
        if (*((_DWORD *)v26 + 48) != 1)
          phTmlNfc_IoCtl();
        v8 = v27;
        *((_QWORD *)v27 + 380) = 0;
        sub_21989A5DC(v8);
        v27 = 0;
        sub_21988EEB4(v30, 0);
        v28 = 0;
        LODWORD(v29) = 0;
        v9 = v26;
        v10 = (void (*)(uint64_t, uint64_t, uint64_t *, uint64_t))v26[2];
        v11 = *v26;
        v26[2] = 0;
        *v9 = 0;
        sub_219885F70(0, (unsigned int *)&v30, 4u, 133, (uint64_t)"phLibNfc_SM_Main_IdleTransComplete");
        v10(v30, v11, &v28, a3);
      }
      goto LABEL_39;
    }
    v24 = "phLibNfc_SM_Main_IdleTransComplete: phLibNfc_SM_eIoctlSetSysConfig:Invalid IOCTL context!!";
LABEL_38:
    sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)v24);
    goto LABEL_39;
  }
  v15 = (void (*)(uint64_t, uint64_t, uint64_t))*((_QWORD *)v27 + 759);
  v16 = *((_QWORD *)v27 + 760);
  *((_QWORD *)v27 + 760) = 0;
  *((_QWORD *)v7 + 759) = 0;
  if ((_DWORD)a3)
  {
    v20 = *((_QWORD *)v7 + 380);
    if (v20)
    {
      v21 = 0;
      v22 = 0;
      do
      {
        v23 = *((_QWORD *)&unk_253E46700 + 14 * v22 + 4);
        if ((v21 & 1) != 0)
          break;
        v21 = 1;
        v22 = 1;
      }
      while (v23 != v20);
      if (v23 == v20)
      {
        sub_2198FF49C(*((unsigned int **)v7 + 380), 2, 0, 0);
        v7 = v27;
      }
    }
    *((_QWORD *)v7 + 380) = 0;
    sub_2198EEC3C((uint64_t)v7);
    v27 = 0;
  }
  if (v15)
  {
    sub_219851790(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"ConfigTestModeCb:Invoking callback function, wStatus = ");
    v17 = (unsigned int *)&v30;
    v18 = 0;
    v19 = 35;
    goto LABEL_34;
  }
LABEL_39:
  sub_219850808(0, (unsigned int *)&v30, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_IdleTransComplete");
  return a3;
}

uint64_t sub_21989D2A4(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t (**v6)();
  uint64_t (*v7)();
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_DeInitTrans");
  sub_21988EDF4(v11, &v10);
  if (v10)
  {
    if (*(_BYTE *)(v10 + 2937) == 1 || *(_BYTE *)(v10 + 2938) == 1 || *(_BYTE *)(v10 + 2944) == 1)
    {
      sub_21988F804(v11, 0);
      if (sub_2199009D0(v11, *(_QWORD *)(v10 + 3040)) == 111)
        sub_2199004B4(*(_QWORD *)(v10 + 3040), 3);
      sub_2198FBBC4(*(_QWORD *)(v10 + 3040));
      v1 = (_BYTE *)v10;
      if (*(_DWORD *)(v10 + 3176) == 1)
      {
        *(_QWORD *)(v10 + 2912) = &qword_2550A1320;
        v1[2904] = 0;
        v1[2906] = 0;
        v2 = qword_2550A1320;
        if (qword_2550A1320)
        {
          v2 = 0;
          v3 = off_2550A1330;
          do
          {
            ++v2;
            v4 = *v3;
            v3 += 2;
          }
          while (v4);
        }
      }
      else
      {
        *(_QWORD *)(v10 + 2912) = &qword_2550A1370;
        v1[2904] = 0;
        v1[2906] = 0;
        v2 = qword_2550A1370;
        if (qword_2550A1370)
        {
          v2 = 0;
          v6 = off_2550A1380;
          do
          {
            ++v2;
            v7 = *v6;
            v6 += 2;
          }
          while (v7);
        }
      }
      v1[2905] = v2;
      v8 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      v8 = sub_2198FF49C(*(unsigned int **)(v10 + 3040), 0, (uint64_t)sub_21989AC58, v10);
    }
    v5 = v8;
  }
  else
  {
    v5 = 1;
  }
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_DeInitTrans");
  return v5;
}

uint64_t sub_21989D428(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, _DWORD *a5)
{
  unsigned int *v7;
  unsigned int *v8;
  unsigned int *v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_MwResetTrans");
  sub_21988EDF4(v11, &v10);
  if (v10)
  {
    if (a5 && *a5)
    {
      sub_219850628(0, (unsigned int *)&v11, 4u, 4u, (uint64_t)"phLibNfc_SM_MwResetTrans NFCC is ON");
      sub_21989AE28(v10);
    }
    else if (v10[794] == 1)
    {
      sub_2198972CC(v10[4842], *((_QWORD *)v10 + 369));
    }
    else
    {
      phTmlNfc_IoCtl();
    }
    v7 = v10;
    *((_BYTE *)v10 + 696) = 0;
    a3 = sub_2198FF49C(*((unsigned int **)v7 + 380), 2, 0, 0);
    if ((_DWORD)a3)
    {
      sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"phLibNfc_SM_MwResetTrans failed");
    }
    else
    {
      sub_21988F804(v11, 0);
      v8 = v10;
      *((_QWORD *)v10 + 380) = 0;
      sub_219897050((uint64_t)v8);
      sub_21989A5DC(v10);
      v10 = 0;
      sub_21988EEB4(v11, 0);
    }
  }
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_MwResetTrans");
  return a3;
}

uint64_t sub_21989D578(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4)
{
  int v5;
  uint64_t v6;
  int v7;
  uint64_t v8;
  char v11;
  uint64_t (**v12)();
  uint64_t (*v13)();
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigHsuTrans");
  v5 = sub_21988EDF4(v16, &v15);
  v6 = 1;
  if (a4)
  {
    v7 = v5;
    v8 = v15;
    if (!v7 && v15 != 0)
    {
      if (*(_BYTE *)(v15 + 2939) == 1 || *(_BYTE *)(v15 + 2944) == 1)
      {
        v6 = 0;
      }
      else
      {
        *(_DWORD *)(v15 + 2948) = *a4;
        *(_BYTE *)(v8 + 3161) = 0;
        *(_QWORD *)(v8 + 2912) = off_2550A3A98;
        *(_BYTE *)(v8 + 2904) = 0;
        *(_BYTE *)(v8 + 2906) = 0;
        v11 = (char)off_2550A3A98[0];
        if (off_2550A3A98[0])
        {
          v11 = 0;
          v12 = off_2550A3AA8;
          do
          {
            ++v11;
            v13 = *v12;
            v12 += 2;
          }
          while (v13);
        }
        *(_BYTE *)(v8 + 2905) = v11;
        v14 = sub_2198655FC(v8, 0, 0);
        v6 = v14;
        if ((_DWORD)v14 && (_DWORD)v14 != 13)
          sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)"phLibNfc_SM_ConfigHsuTrans failed");
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigHsuTrans");
  return v6;
}

uint64_t sub_21989D69C(uint64_t a1, uint64_t a2, uint64_t a3, int *a4)
{
  uint64_t v5;
  unsigned __int8 *v6;
  int v7;
  int v8;
  uint64_t v9;
  int v10;
  unsigned __int8 v11;
  uint64_t *v12;
  uint64_t v13;
  unsigned __int8 *v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigPowerModeTrans");
  sub_21988EDF4(v16, &v15);
  v5 = 1;
  if (a4)
  {
    v6 = v15;
    if (v15)
    {
      v7 = *a4;
      if (*a4 <= 1)
      {
        v8 = *a4;
        v15[1] = v7;
        v6[2] = 1;
        v9 = 372;
        while (*(_DWORD *)&v6[v9] != 2)
        {
          v9 += 16;
          if (v9 == 452)
          {
            v10 = *v6;
            v6[3] = v10;
            v6[4] = 1;
            if (v10 == v8
              || (v6[2937] == 1 || v6[2938] == 1 || v6[2944] == 1)
              && *((_DWORD *)v6 + 787) == 2
              && v8 == 1
              && (v6[6024] & 3) == 3)
            {
              v5 = 0;
            }
            else
            {
              *((_QWORD *)v6 + 364) = &qword_2550A13A0;
              v6[2904] = 0;
              v6[2906] = 0;
              v11 = qword_2550A13A0;
              if (qword_2550A13A0)
              {
                v11 = 0;
                v12 = &qword_2550A13B0;
                do
                {
                  ++v11;
                  v13 = *v12;
                  v12 += 2;
                }
                while (v13);
              }
              v6[2905] = v11;
              v5 = sub_2198655FC((uint64_t)v6, 0, 0);
            }
            goto LABEL_22;
          }
        }
        if (!v7)
          v6[2] = 0;
        v5 = 0;
        v6[3] = *v6;
        v6[4] = 1;
      }
    }
  }
LABEL_22:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigPowerModeTrans");
  return v5;
}

uint64_t sub_21989D824(uint64_t a1, uint64_t a2, uint64_t a3, _QWORD *a4, char *a5)
{
  uint64_t v8;
  char v9;
  uint64_t v10;
  int v11;
  _QWORD *v12;
  uint64_t v13;
  _QWORD *v14;
  uint64_t v16;
  uint64_t v17;

  v16 = 0;
  v17 = a1;
  sub_219850718(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSEListTrans");
  sub_21988EDF4(v17, &v16);
  if (a5)
  {
    if (a4)
    {
      v8 = v16;
      if (v16)
      {
        if (!*(_BYTE *)(v16 + 314))
        {
          v9 = 0;
          goto LABEL_8;
        }
        if (*(_BYTE *)(v16 + 6026) == 1)
        {
          a4[1] = *(_QWORD *)(v16 + 400);
          *a4 = *(_QWORD *)(v8 + 392);
          v9 = 1;
LABEL_8:
          *a5 = v9;
          goto LABEL_18;
        }
        v10 = 0;
        v11 = 0;
        while (v10 || *(_QWORD *)(v8 + 360) || *(_DWORD *)(v8 + 368) != 5)
        {
          v13 = *(_QWORD *)(v8 + v10 + 360);
          if (v13)
          {
            v14 = &a4[2 * ++v11];
            *(v14 - 1) = *(_QWORD *)(v8 + v10 + 368);
            *(v14 - 2) = v13;
            goto LABEL_16;
          }
LABEL_17:
          v10 += 16;
          if (v10 == 80)
            goto LABEL_18;
        }
        v12 = &a4[2 * ++v11];
        *((_DWORD *)v12 - 2) = 5;
        *((_DWORD *)v12 - 1) = *(_DWORD *)(v8 + 372);
        *(v12 - 2) = 0;
LABEL_16:
        *a5 = v11;
        goto LABEL_17;
      }
    }
  }
LABEL_18:
  sub_219850808(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSEListTrans");
  return a3;
}

uint64_t sub_21989D960(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;

  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_SM_CommonTrans");
  sub_219850808(0, (unsigned int *)&v5, 4u, 5u, (uint64_t)"phLibNfc_SM_CommonTrans");
  return a3;
}

uint64_t sub_21989D9C4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  int v9;
  __int16 v11;
  char v13;
  uint64_t *v14;
  uint64_t v15;
  int v16;
  int v17;
  uint64_t v18;
  uint64_t v19;

  v18 = 0;
  v19 = a1;
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_SeGetRfParamsTrans");
  sub_21988EDF4(v19, &v18);
  v6 = 1;
  if (!a4 || !v18)
    goto LABEL_20;
  v7 = 0;
  while (*(_QWORD *)(v18 + v7 + 344) != a4)
  {
    v7 += 16;
    if (v7 == 80)
    {
      if (!(_DWORD)a3)
      {
        phOsalNfc_SetMemory();
        v8 = v18;
        goto LABEL_24;
      }
LABEL_19:
      sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)"phLibNfc_SM_SeGetRfParamsTrans :Failed");
      v6 = a3;
      goto LABEL_20;
    }
  }
  v9 = *(unsigned __int8 *)(v18 + v7 + 352);
  if (*(_BYTE *)(v18 + 2936) == 1 && v9 == 7)
  {
    a3 = 51;
    goto LABEL_19;
  }
  if ((v9 - 1) >= 2)
  {
    a3 = 255;
    goto LABEL_19;
  }
  phOsalNfc_SetMemory();
  v8 = v18;
  switch(v9)
  {
    case 7:
      *(_DWORD *)(v18 + 3564) |= 0x2000u;
      v11 = *(_WORD *)(v8 + 4704) | 0x100;
      goto LABEL_23;
    case 2:
      *(_DWORD *)(v18 + 3564) |= 0x2000u;
      v11 = *(_WORD *)(v8 + 4704) | 0x200;
      goto LABEL_23;
    case 1:
      *(_DWORD *)(v18 + 3564) |= 0x2000u;
      v11 = *(_WORD *)(v8 + 4704) | 0x400;
LABEL_23:
      *(_WORD *)(v8 + 4704) = v11;
      break;
  }
LABEL_24:
  *(_QWORD *)(v8 + 2912) = &qword_2550A3988;
  *(_BYTE *)(v8 + 2904) = 0;
  *(_BYTE *)(v8 + 2906) = 0;
  v13 = qword_2550A3988;
  if (qword_2550A3988)
  {
    v13 = 0;
    v14 = &qword_2550A3998;
    do
    {
      ++v13;
      v15 = *v14;
      v14 += 2;
    }
    while (v15);
  }
  *(_BYTE *)(v8 + 2905) = v13;
  v16 = sub_2198655FC(v8, 0, 0);
  if (v16 == 13)
  {
    v6 = 13;
  }
  else
  {
    v17 = v16;
    sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)"Set Rf Settings sequence could not start!");
    if (v17 == 143)
      v6 = 143;
    else
      v6 = 255;
  }
LABEL_20:
  sub_219850808(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_SeGetRfParamsTrans");
  return v6;
}

uint64_t sub_21989DBE0(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4)
{
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevNtfRegTrans");
  sub_21988EDF4(v9, &v8);
  v6 = 1;
  if (a4 && v8)
  {
    sub_219850628(0, (unsigned int *)&v9, 4u, 4u, (uint64_t)"Registering Notification Handler");
    *a4 &= 0xFFFFE3FF;
    phOsalNfc_MemCopy();
    v6 = a3;
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevNtfRegTrans");
  return v6;
}

uint64_t sub_21989DCB4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;

  v5 = 0;
  v6 = a1;
  sub_219850718(0, (unsigned int *)&v6, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevUnNtfRegTrans");
  sub_21988EDF4(v6, &v5);
  if (v5)
  {
    sub_219850628(0, (unsigned int *)&v6, 4u, 4u, (uint64_t)"UnRegistering Notification Handler");
    phOsalNfc_SetMemory();
  }
  else
  {
    a3 = 1;
  }
  sub_219850808(0, (unsigned int *)&v6, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevUnNtfRegTrans");
  return a3;
}

uint64_t sub_21989DD6C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_GetStackCapTrans");
  sub_21988EDF4(v9, &v8);
  v6 = 1;
  if (a4 && v8)
  {
    sub_21989A864(a4, v8);
    v6 = a3;
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_GetStackCapTrans");
  return v6;
}

uint64_t sub_21989DE04(uint64_t a1, uint64_t a2, uint64_t a3, unsigned __int8 *a4, uint64_t *a5)
{
  uint64_t v7;
  unsigned int *v8;
  uint64_t v9;
  _BYTE *v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t Memory;
  unsigned int *v14;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  unsigned __int8 v19;
  _BYTE *v20;
  char v21;
  uint64_t (**v22)();
  uint64_t (*v23)();
  unsigned int v24;
  const char *v25;
  uint64_t v27;
  unsigned __int8 v28;
  uint64_t v29;

  v29 = a1;
  v28 = 0;
  v27 = 0;
  sub_219850718(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_SM_CofigRtngTrans");
  sub_21988EDF4(v29, &v27);
  v7 = 1;
  if (!a5)
    goto LABEL_27;
  if (!a4)
    goto LABEL_27;
  v8 = (unsigned int *)v27;
  if (!v27)
    goto LABEL_27;
  v9 = *a4;
  if (v9)
  {
    v10 = (char *)a5 + 12;
    v11 = v9;
    do
    {
      *v10 &= ~4u;
      v10 += 40;
      --v11;
    }
    while (v11);
  }
  v7 = sub_21989B1C4(v8, v9, (uint64_t)a5);
  if ((_DWORD)v7)
    goto LABEL_8;
  v12 = v27;
  *(_BYTE *)(v27 + 312) = v9 + 1;
  *(_QWORD *)(v12 + 328) = 0;
  Memory = phOsalNfc_GetMemory();
  v14 = (unsigned int *)v27;
  *(_QWORD *)(v27 + 328) = Memory;
  if (Memory)
  {
    v7 = sub_21989AEAC(v14, Memory, v9, a5, &v28);
    if ((_DWORD)v7)
    {
LABEL_8:
      if ((_DWORD)v7 == 13)
        goto LABEL_27;
      goto LABEL_25;
    }
    v15 = *(_QWORD *)(v27 + 328) + 32 * v28;
    *(_DWORD *)v15 = 1;
    *(_BYTE *)(v15 + 4) = 0;
    v16 = *(_QWORD *)(v27 + 328) + 32 * v28;
    *(_BYTE *)(v16 + 8) &= ~2u;
    v17 = *(_QWORD *)(v27 + 328) + 32 * v28;
    *(_BYTE *)(v17 + 8) &= ~4u;
    v18 = *(_QWORD *)(v27 + 328) + 32 * v28;
    *(_BYTE *)(v18 + 8) |= 1u;
    v19 = v28;
    *(_DWORD *)(*(_QWORD *)(v27 + 328) + 32 * v28 + 12) = 5;
    v28 = v19 + 1;
    v20 = (_BYTE *)v27;
    *(_QWORD *)(v27 + 2912) = off_2550A13C0;
    v20[2904] = 0;
    v20[2906] = 0;
    v21 = (char)off_2550A13C0[0];
    if (off_2550A13C0[0])
    {
      v21 = 0;
      v22 = off_2550A13D0;
      do
      {
        ++v21;
        v23 = *v22;
        v22 += 2;
      }
      while (v23);
    }
    v20[2905] = v21;
    v24 = sub_2198655FC((uint64_t)v20, 0, (uint64_t)(v20 + 312));
    if (v24 == 13)
    {
      v7 = 13;
      goto LABEL_27;
    }
    if ((v24 & 0xFFFFFFFB) == 0x8B)
      v25 = "Max Routing Table Size Has Reached or Non-heap Memory access";
    else
      v25 = "Set Routing Table Config sequence could not start!";
    if ((v24 & 0xFFFFFFFB) == 0x8B)
      v7 = v24;
    else
      v7 = 255;
  }
  else
  {
    v7 = 255;
    v25 = "Failed to allocate memory, Insufficient Resources";
  }
  sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)v25);
LABEL_25:
  if (*(_QWORD *)(v27 + 328))
  {
    sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"Nci Set routing table failed!");
    phOsalNfc_FreeMemory();
    *(_QWORD *)(v27 + 328) = 0;
  }
LABEL_27:
  sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_SM_CofigRtngTrans");
  return v7;
}

uint64_t sub_21989E09C(uint64_t a1, uint64_t a2, uint64_t a3, unsigned __int8 *a4)
{
  uint64_t v6;
  int v7;
  uint64_t Memory;
  unsigned int v9;
  char v10;
  char v11;
  uint64_t v12;
  char v14;
  uint64_t (**v15)();
  uint64_t (*v16)();
  uint64_t v17;
  uint64_t v18;

  v17 = 0;
  v18 = a1;
  sub_219850718(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_SM_SetP2pParamsTrans");
  sub_21988EDF4(v18, &v17);
  v6 = 1;
  if (a4 && v17)
  {
    v7 = *a4;
    Memory = phOsalNfc_GetMemory();
    if (!Memory)
    {
      a3 = 12;
LABEL_16:
      phOsalNfc_FreeMemory();
      v6 = a3;
      goto LABEL_17;
    }
    phOsalNfc_SetMemory();
    *(_DWORD *)Memory = *(_DWORD *)(v17 + 19368);
    v9 = *((_DWORD *)a4 + 13);
    if (v9 <= 1)
    {
      *(_DWORD *)(Memory + 4) |= 0x10u;
      *(_DWORD *)(Memory + 88) = 2;
      *(_BYTE *)(Memory + 141) = v7;
      if (v7)
      {
        phOsalNfc_MemCopy();
        v10 = *(_BYTE *)(Memory + 88) | 4;
      }
      else
      {
        v10 = 6;
      }
      *(_BYTE *)(Memory + 88) = v10;
      *(_BYTE *)(Memory + 144) = *(_BYTE *)(Memory + 144) & 0xF8 | 6;
      v9 = *((_DWORD *)a4 + 13);
    }
    if ((v9 | 2) == 2)
    {
      *(_DWORD *)(Memory + 4) |= 0x200u;
      *(_DWORD *)(Memory + 484) = 2;
      *(_BYTE *)(Memory + 537) = v7;
      if (v7)
      {
        phOsalNfc_MemCopy();
        v11 = *(_BYTE *)(Memory + 484) | 4;
      }
      else
      {
        v11 = 6;
      }
      *(_BYTE *)(Memory + 484) = v11;
      *(_BYTE *)(Memory + 540) |= 3u;
    }
    v12 = v17;
    if ((_DWORD)a3)
      goto LABEL_16;
    *(_QWORD *)(v17 + 5392) = Memory;
    *(_QWORD *)(v12 + 2912) = off_2550A2F48;
    *(_BYTE *)(v12 + 2904) = 0;
    *(_BYTE *)(v12 + 2906) = 0;
    v14 = (char)off_2550A2F48[0];
    if (off_2550A2F48[0])
    {
      v14 = 0;
      v15 = off_2550A2F58;
      do
      {
        ++v14;
        v16 = *v15;
        v15 += 2;
      }
      while (v16);
    }
    *(_BYTE *)(v12 + 2905) = v14;
    if (sub_2198655FC(v12, 0, 0) == 13)
    {
      v6 = 13;
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v18, 4u, 1u, (uint64_t)"P2P Config sequence could not start!");
      phOsalNfc_FreeMemory();
      v6 = 255;
    }
  }
LABEL_17:
  sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_SM_SetP2pParamsTrans");
  return v6;
}

uint64_t sub_21989E2F4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  int v10;
  int v11;
  uint64_t v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_SetHceParamsTrans");
  sub_21988EDF4(v14, &v13);
  v5 = 1;
  if (a4)
  {
    v6 = v13;
    if (v13)
    {
      *(_BYTE *)(v13 + 484) = 0;
      *(_QWORD *)(v6 + 2912) = off_2550A0DA8;
      *(_BYTE *)(v6 + 2904) = 0;
      *(_BYTE *)(v6 + 2906) = 0;
      v7 = (char)off_2550A0DA8[0];
      if (off_2550A0DA8[0])
      {
        v7 = 0;
        v8 = off_2550A0DB8;
        do
        {
          ++v7;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
      *(_BYTE *)(v6 + 2905) = v7;
      v10 = sub_2198655FC(v6, 0, a4);
      if (v10 == 13)
      {
        v5 = 13;
      }
      else
      {
        v11 = v10;
        sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"Set Host CE Config sequence could not start!");
        if (v11 == 143)
          v5 = 143;
        else
          v5 = 255;
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_SetHceParamsTrans");
  return v5;
}

uint64_t sub_21989E3F4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  const char *v6;
  _BYTE *v7;
  char v8;
  uint64_t (**v9)();
  uint64_t (*v10)();
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_AntennaTestTrans");
  sub_21988EDF4(v13, &v12);
  v5 = 255;
  v6 = "phLibNfc_SM_AntennaTestTrans Failed";
  if (!a4 || !v12)
    goto LABEL_8;
  phOsalNfc_SetMemory();
  phOsalNfc_MemCopy();
  v7 = (_BYTE *)v12;
  *(_QWORD *)(v12 + 2912) = off_2550A3AE8;
  v7[2904] = 0;
  v7[2906] = 0;
  v8 = (char)off_2550A3AE8[0];
  if (off_2550A3AE8[0])
  {
    v8 = 0;
    v9 = off_2550A3AF8;
    do
    {
      ++v8;
      v10 = *v9;
      v9 += 2;
    }
    while (v10);
  }
  v7[2905] = v8;
  v5 = sub_2198655FC((uint64_t)v7, 0, 0);
  if ((_DWORD)v5 != 13)
  {
    v6 = "phLibNfc_SM_AntennaTestTrans failed";
LABEL_8:
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)v6);
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_AntennaTestTrans");
  return v5;
}

uint64_t sub_21989E520(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4, uint64_t a5)
{
  uint64_t v7;
  unsigned int *v8;
  uint64_t v9;
  unsigned int v10;
  int v11;
  uint64_t (**v12)();
  uint64_t v13;
  uint64_t (*v14)();
  uint64_t *v15;
  uint64_t v16;
  uint64_t v18;
  char v19;
  uint64_t v20;

  v20 = a1;
  v19 = 0;
  v18 = 0;
  sub_219850718(0, (unsigned int *)&v20, 4u, 5u, (uint64_t)"phLibNfc_SM_SetRfSettingTrans");
  sub_21988EDF4(v20, &v18);
  v7 = 1;
  if (a5)
  {
    if (a4)
    {
      v8 = (unsigned int *)v18;
      if (v18)
      {
        *(_BYTE *)(v18 + 2884) = 0;
        v9 = *(_QWORD *)a5;
        if (*(_QWORD *)a5)
        {
          v10 = *(_DWORD *)(a5 + 8);
          if (v10)
          {
            if (*a4)
            {
              v11 = sub_2198EF0AC(v8, v9, v10, &v19);
              v12 = off_2550A3BE8;
            }
            else
            {
              v11 = sub_21986C188(v20, v9, v10, &v19, 2);
              v12 = off_2550A3BB8;
            }
            v13 = v18;
            if (v11 || !v19)
            {
              *(_BYTE *)(v18 + 3248) = 0;
              *(_QWORD *)(v13 + 3240) = 0;
              *(_QWORD *)(v13 + 3508) = 0;
            }
            else
            {
              *(_BYTE *)(v18 + 3248) = v19;
              *(_QWORD *)(v13 + 3240) = *(_QWORD *)a5;
              *(_DWORD *)(v13 + 3508) = *(_DWORD *)(a5 + 8);
              *(_DWORD *)(v13 + 3512) = 0;
              *(_QWORD *)(v13 + 2912) = v12;
              *(_BYTE *)(v13 + 2904) = 0;
              *(_BYTE *)(v13 + 2906) = 0;
              v14 = *v12;
              if (*v12)
              {
                LOBYTE(v14) = 0;
                v15 = (uint64_t *)(v12 + 2);
                do
                {
                  LOBYTE(v14) = (_BYTE)v14 + 1;
                  v16 = *v15;
                  v15 += 2;
                }
                while (v16);
              }
              *(_BYTE *)(v13 + 2905) = (_BYTE)v14;
              v7 = sub_2198655FC(v13, 0, 0);
            }
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v20, 4u, 5u, (uint64_t)"phLibNfc_SM_SetRfSettingTrans");
  return v7;
}

uint64_t sub_21989E680(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4)
{
  uint64_t v6;
  uint64_t v7;
  char v8;
  uint64_t *v9;
  uint64_t v10;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_SeSvddControlTrans");
  sub_21988EDF4(v13, &v12);
  v6 = 1;
  if (a4)
  {
    v7 = v12;
    if (v12)
    {
      *(_BYTE *)(v12 + 323) = 1;
      *(_DWORD *)(v7 + 480) = *a4;
      *(_QWORD *)(v7 + 2912) = off_2550A3848;
      *(_BYTE *)(v7 + 2904) = 0;
      *(_BYTE *)(v7 + 2906) = 0;
      v8 = (char)off_2550A3848[0];
      if (off_2550A3848[0])
      {
        v8 = 0;
        v9 = &qword_2550A3858;
        do
        {
          ++v8;
          v10 = *v9;
          v9 += 2;
        }
        while (v10);
      }
      *(_BYTE *)(v7 + 2905) = v8;
      v6 = sub_2198655FC(v7, a3, 0);
    }
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_SeSvddControlTrans");
  return v6;
}

uint64_t sub_21989E760(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4, int *a5)
{
  uint64_t v7;
  const char *v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_TrigNfccAssertionTrans");
  sub_21988EDF4(v11, &v10);
  if (!a4 || !v10)
  {
    v8 = "phLibNfc_SM_TrigNfccAssertionTrans: Invalid input parameters";
LABEL_7:
    v7 = 1;
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)v8);
    goto LABEL_8;
  }
  if (*a4 > 2u)
  {
    v8 = "Invald Assertion type";
    goto LABEL_7;
  }
  v7 = sub_219900784(*(_QWORD *)(v10 + 3040), *a4, a5, (uint64_t)sub_2198EE9D0, v10);
LABEL_8:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_TrigNfccAssertionTrans");
  return v7;
}

uint64_t sub_21989E834(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int *a4, uint64_t a5)
{
  unsigned int v8;
  _BOOL4 v9;
  const char *v10;
  uint64_t v11;
  uint64_t Memory;
  uint64_t v14;
  char v15;
  uint64_t (**v16)();
  uint64_t (*v17)();
  char v18;
  char v19;
  uint64_t v20;
  uint64_t v21;

  v20 = 0;
  v21 = a1;
  sub_219850718(0, (unsigned int *)&v21, 4u, 5u, (uint64_t)"phLibNfc_SM_GetClrAssertRegsTrans");
  sub_21988EDF4(v21, &v20);
  if (!a4 || !v20)
    goto LABEL_7;
  v8 = *a4;
  if (!a5)
  {
    if (!v8)
    {
      v9 = 0;
      goto LABEL_11;
    }
LABEL_7:
    v10 = "phLibNfc_SM_GetClrAssertRegsTrans: Invalid input parameters";
    goto LABEL_8;
  }
  v9 = v8 == 1;
  if (v8 > 1)
  {
    v10 = "Invald Assertion Config type";
LABEL_8:
    v11 = 1;
    sub_219850628(0, (unsigned int *)&v21, 4u, 1u, (uint64_t)v10);
    goto LABEL_9;
  }
LABEL_11:
  Memory = phOsalNfc_GetMemory();
  phOsalNfc_SetMemory();
  if (Memory)
  {
    v14 = v20;
    *(_DWORD *)(v20 + 16) = v8;
    *(_QWORD *)(v14 + 24) = Memory;
    *(_QWORD *)(v14 + 8) = a5;
    if (v9)
    {
      *(_QWORD *)(v14 + 2912) = &qword_2550A1400;
      *(_BYTE *)(v14 + 2904) = 0;
      *(_BYTE *)(v14 + 2906) = 0;
      v15 = qword_2550A1400;
      if (qword_2550A1400)
      {
        v15 = 0;
        v16 = off_2550A1410;
        do
        {
          ++v15;
          v17 = *v16;
          v16 += 2;
        }
        while (v17);
      }
      *(_BYTE *)(v14 + 2905) = v15;
      v11 = sub_2198655FC(v14, a3, 0);
      if ((_DWORD)v11 != 13)
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v20 + 24) = 0;
      }
    }
    else
    {
      *(_DWORD *)(Memory + 4) |= 0x1000u;
      *(_DWORD *)(Memory + 580) |= 0x20000u;
      *(_BYTE *)(Memory + 945) = 4;
      phOsalNfc_SetMemory();
      *(_DWORD *)(Memory + 580) |= 0x40000u;
      if (*(_BYTE *)(v20 + 2936))
      {
        v18 = 64;
      }
      else if (*(_BYTE *)(v20 + 2938) == 1)
      {
        v18 = 96;
      }
      else if (*(_BYTE *)(v20 + 2946) == 1)
      {
        v18 = 48;
      }
      else
      {
        v18 = 80;
      }
      *(_BYTE *)(Memory + 1042) = v18;
      phOsalNfc_SetMemory();
      if (*(_BYTE *)(v20 + 2936) == 1)
        v19 = 20;
      else
        v19 = 24;
      if (*(_BYTE *)(v20 + 2938) == 1)
        v19 += 4;
      if (*(_BYTE *)(v20 + 2946) == 1)
        v19 -= 8;
      *(_DWORD *)(Memory + 580) |= 0x80000u;
      *(_BYTE *)(Memory + 1071) = v19;
      phOsalNfc_SetMemory();
      *(_DWORD *)(Memory + 580) |= 0x100000u;
      *(_BYTE *)(Memory + 1116) = 44;
      phOsalNfc_SetMemory();
      v11 = sub_2198FD4A4(*(_QWORD *)(v20 + 3040), Memory, (uint64_t)sub_2198EF3CC, v20);
      if ((_DWORD)v11 != 13)
        phOsalNfc_FreeMemory();
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v21, 4u, 1u, (uint64_t)"phLibNfc_SM_GetClrAssertRegsTrans: INSUFFICIENT_RESOURCE");
    v11 = 12;
  }
LABEL_9:
  sub_219850808(0, (unsigned int *)&v21, 4u, 5u, (uint64_t)"phLibNfc_SM_GetClrAssertRegsTrans");
  return v11;
}

uint64_t sub_21989EB48(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4)
{
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigLogTrans");
  sub_21988EDF4(v12, &v11);
  v5 = 1;
  if (a4)
  {
    v6 = v11;
    if (v11)
    {
      *(_DWORD *)(v11 + 104) = *a4;
      *(_QWORD *)(v6 + 2912) = off_2550A3B68;
      *(_BYTE *)(v6 + 2904) = 0;
      *(_BYTE *)(v6 + 2906) = 0;
      v7 = (char)off_2550A3B68[0];
      if (off_2550A3B68[0])
      {
        v7 = 0;
        v8 = off_2550A3B78;
        do
        {
          ++v7;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
      *(_BYTE *)(v6 + 2905) = v7;
      v5 = sub_2198655FC(v6, 0, 0);
    }
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigLogTrans");
  return v5;
}

uint64_t sub_21989EC14(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4)
{
  uint64_t v5;
  char v6;
  uint64_t *v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigAssertionLogTrans");
  sub_21988EDF4(v12, &v11);
  if (a4 && (v5 = v11) != 0)
  {
    *(_DWORD *)(v11 + 32) = *a4;
    *(_QWORD *)(v5 + 2912) = off_2550A3ED8;
    *(_BYTE *)(v5 + 2904) = 0;
    *(_BYTE *)(v5 + 2906) = 0;
    v6 = (char)off_2550A3ED8[0];
    if (off_2550A3ED8[0])
    {
      v6 = 0;
      v7 = &qword_2550A3EE8;
      do
      {
        ++v6;
        v8 = *v7;
        v7 += 2;
      }
      while (v8);
    }
    *(_BYTE *)(v5 + 2905) = v6;
    v9 = sub_2198655FC(v5, 0, 0);
  }
  else
  {
    v9 = 1;
    sub_219850628(0, (unsigned int *)&v12, 4u, 1u, (uint64_t)"ConfigureAssertLogging: Failed");
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigAssertionLogTrans");
  return v9;
}

uint64_t sub_21989ED00(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v4;
  char v5;
  uint64_t (**v6)();
  uint64_t (*v7)();
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_ValidateEepromTrans");
  sub_21988EDF4(v10, &v9);
  v4 = v9;
  if (v9)
  {
    *(_WORD *)(v9 + 3225) = 0;
    *(_QWORD *)(v4 + 2912) = off_2550A3A28;
    *(_BYTE *)(v4 + 2904) = 0;
    *(_BYTE *)(v4 + 2906) = 0;
    v5 = (char)off_2550A3A28[0];
    if (off_2550A3A28[0])
    {
      v5 = 0;
      v6 = off_2550A3A38;
      do
      {
        ++v5;
        v7 = *v6;
        v6 += 2;
      }
      while (v7);
    }
    *(_BYTE *)(v4 + 2905) = v5;
    a3 = sub_2198655FC(v4, 0, 0);
  }
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_ValidateEepromTrans");
  return a3;
}

uint64_t sub_21989EDC4(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetPowerTrackTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2936) == 1
      || *(_BYTE *)(v7 + 2937) == 1
      || *(_BYTE *)(v7 + 2938) == 1
      || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3C68;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3C68;
      if (qword_2550A3C68)
      {
        v2 = 0;
        v3 = &qword_2550A3C78;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetPowerTrackTrans: System Power trace feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetPowerTrackTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetPowerTrackTrans");
  return v5;
}

uint64_t sub_21989EEF4(uint64_t a1)
{
  _BYTE *v2;
  char v3;
  uint64_t (**v4)();
  uint64_t (*v5)();
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_GetEraseCounterTrans");
  sub_21988EDF4(v9, &v8);
  if (v8)
  {
    if (*(_BYTE *)(v8 + 2944) == 1 || *(_BYTE *)(v8 + 2946) == 1)
    {
      phOsalNfc_SetMemory();
      v2 = (_BYTE *)v8;
      *(_QWORD *)(v8 + 2912) = off_2550A3C38;
      v2[2904] = 0;
      v2[2906] = 0;
      v3 = (char)off_2550A3C38[0];
      if (off_2550A3C38[0])
      {
        v3 = 0;
        v4 = off_2550A3C48;
        do
        {
          ++v3;
          v5 = *v4;
          v4 += 2;
        }
        while (v5);
      }
      v2[2905] = v3;
      v6 = sub_2198655FC((uint64_t)v2, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_GetEraseCounterTrans: Get Erase counter info not supported on this platform");
      v6 = 51;
    }
  }
  else
  {
    v6 = 1;
    sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_GetEraseCounterTrans: Invalid context");
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_GetEraseCounterTrans");
  return v6;
}

uint64_t sub_21989F028(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSmbLogTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2937) == 1 || *(_BYTE *)(v7 + 2938) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3CD8;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3CD8;
      if (qword_2550A3CD8)
      {
        v2 = 0;
        v3 = &qword_2550A3CE8;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetSmbLogTrans: SMB Logging feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetSmbLogTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSmbLogTrans");
  return v5;
}

uint64_t sub_21989F14C(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetProhibitTimerStatusTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2937) == 1 || *(_BYTE *)(v7 + 2938) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3C18;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3C18;
      if (qword_2550A3C18)
      {
        v2 = 0;
        v3 = &qword_2550A3C28;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetProhibitTimerStatusTrans: Get prohibit timer status not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetProhibitTimerStatusTrans: Invalid context");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetProhibitTimerStatusTrans");
  return v5;
}

uint64_t sub_21989F270(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetHlmDbgLogTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2937) == 1 || *(_BYTE *)(v7 + 2938) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3D18;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3D18;
      if (qword_2550A3D18)
      {
        v2 = 0;
        v3 = &qword_2550A3D28;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetHlmDbgLogTrans: HLM debug Logging feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetHlmDbgLogTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetHlmDbgLogTrans");
  return v5;
}

uint64_t sub_21989F394(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetLpcdCountTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2937) == 1 || *(_BYTE *)(v7 + 2938) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3DD8;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3DD8;
      if (qword_2550A3DD8)
      {
        v2 = 0;
        v3 = &qword_2550A3DE8;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetLpcdCountTrans: Get Lpcd False counter feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetLpcdCountTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetLpcdCountTrans");
  return v5;
}

uint64_t sub_21989F4B8(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetVasCodeTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2937) == 1 || *(_BYTE *)(v7 + 2938) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3DF8;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3DF8;
      if (qword_2550A3DF8)
      {
        v2 = 0;
        v3 = &qword_2550A3E08;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetVasCodeTrans: Feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetVasCodeTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetVasCodeTrans");
  return v5;
}

uint64_t sub_21989F5DC(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSuicaSysCodeTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2937) == 1
      || *(_BYTE *)(v7 + 2938) == 1
      || *(_BYTE *)(v7 + 2936) == 1
      || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3E38;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3E38;
      if (qword_2550A3E38)
      {
        v2 = 0;
        v3 = &qword_2550A3E48;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetSuicaSysCodeTrans: Feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetSuicaSysCodeTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSuicaSysCodeTrans");
  return v5;
}

uint64_t sub_21989F70C(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetMultiTagInfoTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2939) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3E78;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3E78;
      if (qword_2550A3E78)
      {
        v2 = 0;
        v3 = &qword_2550A3E88;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetMultiTagInfoTrans: Feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetMultiTagInfoTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetMultiTagInfoTrans");
  return v5;
}

uint64_t sub_21989F824(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSwioVoltageTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2938) == 1 || *(_BYTE *)(v7 + 2939) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3C88;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3C88;
      if (qword_2550A3C88)
      {
        v2 = 0;
        v3 = off_2550A3C98;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetSwioVoltageTrans: Read SWIO pad voltage not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetSwioVoltageTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSwioVoltageTrans");
  return v5;
}

uint64_t sub_21989F948(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetTrimVerTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3CB8;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3CB8;
      if (qword_2550A3CB8)
      {
        v2 = 0;
        v3 = &qword_2550A3CC8;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetTrimVerTrans: Get Trim Version not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_GetTrimVerTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_GetTrimVerTrans");
  return v5;
}

uint64_t sub_21989FA54(uint64_t a1)
{
  _BYTE *v1;
  BOOL v2;
  char v3;
  uint64_t *v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_SetSmbNfccParamsTrans");
  sub_21988EDF4(v9, &v8);
  v1 = (_BYTE *)v8;
  if (v8)
  {
    v2 = *(_BYTE *)(v8 + 2937) == 1 && *(unsigned __int8 *)(v8 + 2980) > 2u;
    if (v2 || *(_BYTE *)(v8 + 2938) == 1 || *(_BYTE *)(v8 + 2944) == 1)
    {
      *(_QWORD *)(v8 + 2912) = &qword_2550A3CF8;
      v1[2904] = 0;
      v1[2906] = 0;
      v3 = qword_2550A3CF8;
      if (qword_2550A3CF8)
      {
        v3 = 0;
        v4 = &qword_2550A3D08;
        do
        {
          ++v3;
          v5 = *v4;
          v4 += 2;
        }
        while (v5);
      }
      v1[2905] = v3;
      v6 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_SetSmbNfccParamsTrans: Feature not supported on this platform");
      v6 = 51;
    }
  }
  else
  {
    v6 = 1;
    sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_SetSmbNfccParamsTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_SetSmbNfccParamsTrans");
  return v6;
}

uint64_t sub_21989FB80(uint64_t a1)
{
  uint64_t v1;
  int v2;
  char v3;
  uint64_t *v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_SetHLMParamsTrans");
  sub_21988EDF4(v9, &v8);
  v1 = v8;
  if (v8)
  {
    if (*(_BYTE *)(v8 + 2937) == 1 || *(_BYTE *)(v8 + 2938) == 1 || *(_BYTE *)(v8 + 2944) == 1)
    {
      v2 = *(_DWORD *)(v8 + 5424) & 0x1E | 1;
      if ((*(_DWORD *)(v8 + 5424) & 0x1F) == 0)
        v2 = 0;
      *(_DWORD *)(v8 + 5424) = v2;
      *(_QWORD *)(v1 + 2912) = off_2550A3D38;
      *(_BYTE *)(v1 + 2904) = 0;
      *(_BYTE *)(v1 + 2906) = 0;
      v3 = (char)off_2550A3D38[0];
      if (off_2550A3D38[0])
      {
        v3 = 0;
        v4 = &qword_2550A3D48;
        do
        {
          ++v3;
          v5 = *v4;
          v4 += 2;
        }
        while (v5);
      }
      *(_BYTE *)(v1 + 2905) = v3;
      v6 = sub_2198655FC(v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_SetHLMParamsTrans: Feature not supported on this platform");
      v6 = 51;
    }
  }
  else
  {
    v6 = 1;
    sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_SetHLMParamsTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_SetHLMParamsTrans");
  return v6;
}

uint64_t sub_21989FCB4(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_TrigRfOnNtfTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    *(_QWORD *)(v7 + 2912) = &qword_2550A3B48;
    v1[2904] = 0;
    v1[2906] = 0;
    v2 = qword_2550A3B48;
    if (qword_2550A3B48)
    {
      v2 = 0;
      v3 = &qword_2550A3B58;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    v1[2905] = v2;
    v5 = sub_2198655FC((uint64_t)v1, 0, 0);
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_TrigRfOnNtfTrans: Failed");
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_TrigRfOnNtfTrans");
  return v5;
}

uint64_t sub_21989FD90(uint64_t a1)
{
  uint64_t v1;
  _BYTE *v2;
  char v3;
  uint64_t *v4;
  uint64_t v5;
  uint64_t v6;
  const char *v7;
  _BYTE *v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SetVasCodeTrans");
  sub_21988EDF4(v10, &v9);
  v1 = (uint64_t)v9;
  if (!v9)
  {
    v7 = "phLibNfc_SM_SetVasCodeTrans: Failed";
    v6 = 1;
LABEL_40:
    sub_219850628(v1, (unsigned int *)&v10, 4u, 1u, (uint64_t)v7);
    goto LABEL_41;
  }
  v2 = v9 + 5424;
  if (v9[5426] >= 0x14u
    && v9[5448] >= 0x14u
    && v9[5470] >= 0x14u
    && v9[5492] >= 0x14u
    && v9[5514] >= 0x14u
    && v9[5536] > 0x13u)
  {
    v7 = "phLibNfc_SM_SetVasCodeTrans: Invalid Params";
    v6 = 1;
    LODWORD(v1) = 0;
    goto LABEL_40;
  }
  if (v9[2937] == 1 || v9[2938] == 1 || v9[2944] == 1)
  {
    if (*v2 >= 2u)
      *v2 = 0;
    if (*(unsigned __int8 *)(v1 + 5446) >= 2u)
      *(_BYTE *)(v1 + 5446) = 0;
    if (*(unsigned __int8 *)(v1 + 5468) >= 2u)
      *(_BYTE *)(v1 + 5468) = 0;
    if (*(unsigned __int8 *)(v1 + 5490) >= 2u)
      *(_BYTE *)(v1 + 5490) = 0;
    if (*(unsigned __int8 *)(v1 + 5512) >= 2u)
      *(_BYTE *)(v1 + 5512) = 0;
    if (*(unsigned __int8 *)(v1 + 5534) >= 2u)
      *(_BYTE *)(v1 + 5534) = 0;
    if (*(unsigned __int8 *)(v1 + 5425) >= 2u)
      *(_BYTE *)(v1 + 5425) = 0;
    if (*(unsigned __int8 *)(v1 + 5447) >= 2u)
      *(_BYTE *)(v1 + 5447) = 0;
    if (*(unsigned __int8 *)(v1 + 5469) >= 2u)
      *(_BYTE *)(v1 + 5469) = 0;
    if (*(unsigned __int8 *)(v1 + 5491) >= 2u)
      *(_BYTE *)(v1 + 5491) = 0;
    if (*(unsigned __int8 *)(v1 + 5513) >= 2u)
      *(_BYTE *)(v1 + 5513) = 0;
    if (*(unsigned __int8 *)(v1 + 5535) >= 2u)
      *(_BYTE *)(v1 + 5535) = 0;
    *(_QWORD *)(v1 + 2912) = &qword_2550A3DB8;
    *(_BYTE *)(v1 + 2904) = 0;
    *(_BYTE *)(v1 + 2906) = 0;
    v3 = qword_2550A3DB8;
    if (qword_2550A3DB8)
    {
      v3 = 0;
      v4 = &qword_2550A3DC8;
      do
      {
        ++v3;
        v5 = *v4;
        v4 += 2;
      }
      while (v5);
    }
    *(_BYTE *)(v1 + 2905) = v3;
    v6 = sub_2198655FC(v1, 0, 0);
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)"phLibNfc_SM_SetVasCodeTrans: Feature not supported on this platform");
    v6 = 51;
  }
LABEL_41:
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SetVasCodeTrans");
  return v6;
}

uint64_t sub_21989FFDC(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SetSuicaEntrySysCodeTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(unsigned __int8 *)(v7 + 5424) >= 2u && *(unsigned __int8 *)(v7 + 5425) > 1u)
    {
      v5 = 1;
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_SetSuicaEntrySysCodeTrans: Invalid Params");
    }
    else if (*(_BYTE *)(v7 + 2937) == 1
           || *(_BYTE *)(v7 + 2938) == 1
           || *(_BYTE *)(v7 + 2936) == 1
           || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3E18;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3E18;
      if (qword_2550A3E18)
      {
        v2 = 0;
        v3 = &qword_2550A3E28;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_SetSuicaEntrySysCodeTrans: Feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_SetSuicaEntrySysCodeTrans: Failed");
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SetSuicaEntrySysCodeTrans");
  return v5;
}

uint64_t sub_2198A0150(uint64_t a1)
{
  uint64_t v1;
  _BYTE *v2;
  int v3;
  uint64_t v4;
  uint64_t Memory;
  uint64_t v6;
  char v7;
  uint64_t *v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t *v11;
  uint64_t v12;
  uint64_t *v13;
  uint64_t v14;
  uint64_t v16;
  uint64_t v17;

  v16 = 0;
  v17 = a1;
  sub_219850718(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_SM_SetChipScopeCfgTrans");
  sub_21988EDF4(v17, &v16);
  v1 = v16;
  if (!v16)
  {
    sub_219850628(0, (unsigned int *)&v17, 4u, 1u, (uint64_t)"phLibNfc_SM_SetChipScopeCfgTrans: Failed");
    v10 = 255;
    goto LABEL_30;
  }
  if (*(_BYTE *)(v16 + 2937) != 1 && *(_BYTE *)(v16 + 2938) != 1 && *(_BYTE *)(v16 + 2944) != 1
    || *(_DWORD *)(v16 + 3148) != 2)
  {
    sub_219850628(0, (unsigned int *)&v17, 4u, 1u, (uint64_t)"phLibNfc_SM_SetChipScopeCfgTrans: Feature not supported on this platform");
    v10 = 51;
    goto LABEL_30;
  }
  v2 = (_BYTE *)(v16 + 6024);
  v3 = *(_DWORD *)(v16 + 5424);
  switch(v3)
  {
    case 0:
      *v2 &= ~1u;
      *(_QWORD *)(v1 + 2912) = off_2550A3E58;
      *(_BYTE *)(v1 + 2904) = 0;
      *(_BYTE *)(v1 + 2906) = 0;
      v7 = (char)off_2550A3E58[0];
      if (off_2550A3E58[0])
      {
        v7 = 0;
        v11 = &qword_2550A3E68;
        do
        {
          ++v7;
          v12 = *v11;
          v11 += 2;
        }
        while (v12);
      }
      goto LABEL_29;
    case 1:
      *v2 |= 1u;
      *(_QWORD *)(v1 + 2912) = off_2550A3E58;
      *(_BYTE *)(v1 + 2904) = 0;
      *(_BYTE *)(v1 + 2906) = 0;
      v7 = (char)off_2550A3E58[0];
      if (off_2550A3E58[0])
      {
        v7 = 0;
        v13 = &qword_2550A3E68;
        do
        {
          ++v7;
          v14 = *v13;
          v13 += 2;
        }
        while (v14);
      }
LABEL_29:
      *(_BYTE *)(v1 + 2905) = v7;
      v10 = sub_2198655FC(v1, 0, 0);
      goto LABEL_30;
    case 2:
      v4 = *(_QWORD *)(v16 + 5432);
      if (v4)
      {
        if (*(_QWORD *)v4 && *(_DWORD *)(v4 + 8))
        {
          if (*(_QWORD *)(v16 + 6008))
          {
            phOsalNfc_FreeMemory();
            v1 = v16;
            *(_QWORD *)(v16 + 6008) = 0;
            v4 = *(_QWORD *)(v1 + 5432);
          }
          *(_DWORD *)(v1 + 6016) = 0;
          *(_DWORD *)(v1 + 6016) = *(_DWORD *)(v4 + 8);
          Memory = phOsalNfc_GetMemory();
          v6 = v16;
          *(_QWORD *)(v16 + 6008) = Memory;
          if (!Memory)
          {
            v10 = 12;
            goto LABEL_30;
          }
          *(_BYTE *)(v6 + 6024) = 2;
          phOsalNfc_MemCopy();
          v1 = v16;
          *(_QWORD *)(v16 + 2912) = off_2550A3E58;
          *(_BYTE *)(v1 + 2904) = 0;
          *(_BYTE *)(v1 + 2906) = 0;
          v7 = (char)off_2550A3E58[0];
          if (off_2550A3E58[0])
          {
            v7 = 0;
            v8 = &qword_2550A3E68;
            do
            {
              ++v7;
              v9 = *v8;
              v8 += 2;
            }
            while (v9);
          }
          goto LABEL_29;
        }
      }
      break;
  }
  v10 = 1;
  sub_219850628(0, (unsigned int *)&v17, 4u, 1u, (uint64_t)"phLibNfc_SM_SetChipScopeCfgTrans: Invalid Params");
LABEL_30:
  sub_219850808(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_SM_SetChipScopeCfgTrans");
  return v10;
}

uint64_t sub_2198A03CC(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SetMultiTagCfgTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2939) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3B98;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3B98;
      if (qword_2550A3B98)
      {
        v2 = 0;
        v3 = &qword_2550A3BA8;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_SetMultiTagCfgTrans: Feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_SetMultiTagCfgTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SetMultiTagCfgTrans");
  return v5;
}

uint64_t sub_2198A04E4(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_ClearMultiTagInfoTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    if (*(_BYTE *)(v7 + 2939) == 1 || *(_BYTE *)(v7 + 2944) == 1)
    {
      *(_QWORD *)(v7 + 2912) = &qword_2550A3E98;
      v1[2904] = 0;
      v1[2906] = 0;
      v2 = qword_2550A3E98;
      if (qword_2550A3E98)
      {
        v2 = 0;
        v3 = &qword_2550A3EA8;
        do
        {
          ++v2;
          v4 = *v3;
          v3 += 2;
        }
        while (v4);
      }
      v1[2905] = v2;
      v5 = sub_2198655FC((uint64_t)v1, 0, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_ClearMultiTagInfoTrans: Feature not supported on this platform");
      v5 = 51;
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"phLibNfc_SM_ClearMultiTagInfoTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_ClearMultiTagInfoTrans");
  return v5;
}

uint64_t sub_2198A05FC(uint64_t a1)
{
  _BYTE *v1;
  unsigned int v2;
  char v3;
  uint64_t *v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_SetCWRFCfgTrans");
  sub_21988EDF4(v9, &v8);
  v1 = (_BYTE *)v8;
  if (v8)
  {
    if (*(_BYTE *)(v8 + 2937) == 1 || *(_BYTE *)(v8 + 2938) == 1 || *(_BYTE *)(v8 + 2944) == 1)
    {
      v2 = *(_DWORD *)(v8 + 5424);
      if (v2 > 1 || v2 == 1 && *(unsigned __int8 *)(v8 + 5428) - 1 >= 2)
      {
        v6 = 1;
        sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_SetCWRFCfgTrans: Invalid Params");
      }
      else
      {
        *(_QWORD *)(v8 + 2912) = &qword_2550A3EB8;
        v1[2904] = 0;
        v1[2906] = 0;
        v3 = qword_2550A3EB8;
        if (qword_2550A3EB8)
        {
          v3 = 0;
          v4 = &qword_2550A3EC8;
          do
          {
            ++v3;
            v5 = *v4;
            v4 += 2;
          }
          while (v5);
        }
        v1[2905] = v3;
        v6 = sub_2198655FC((uint64_t)v1, 0, 0);
      }
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_SetCWRFCfgTrans: Feature not supported on this platform");
      v6 = 51;
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_SetCWRFCfgTrans: Failed");
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_SetCWRFCfgTrans");
  return v6;
}

uint64_t sub_2198A0768(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  char v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetRfConfigTrans");
  sub_21988EDF4(v13, &v12);
  if (a4 && v12)
  {
    v5 = sub_21986C188(v13, *(_QWORD *)a4, *(_DWORD *)(a4 + 8), &v11, 1);
    if (!(_DWORD)v5 && v11)
    {
      v6 = v12;
      *(_BYTE *)(v12 + 3520) = v11;
      *(_QWORD *)(v6 + 3528) = *(_QWORD *)a4;
      *(_QWORD *)(v6 + 2912) = gphLibNfc_IoctlSetRfConfig;
      *(_BYTE *)(v6 + 2904) = 0;
      *(_BYTE *)(v6 + 2906) = 0;
      v7 = (char)gphLibNfc_IoctlSetRfConfig[0];
      if (gphLibNfc_IoctlSetRfConfig[0])
      {
        v7 = 0;
        v8 = off_2550A0B18;
        do
        {
          ++v7;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
      *(_BYTE *)(v6 + 2905) = v7;
      v5 = sub_2198655FC(v6, 0, 0);
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"IoctlSetRfConfigTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetRfConfigTrans");
  return v5;
}

uint64_t sub_2198A0888(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  char v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetRfPropConfigTrans");
  sub_21988EDF4(v13, &v12);
  if (a4 && v12)
  {
    v5 = sub_21986C188(v13, *(_QWORD *)a4, *(_DWORD *)(a4 + 8), &v11, 2);
    if (!(_DWORD)v5 && v11)
    {
      v6 = v12;
      *(_BYTE *)(v12 + 3520) = v11;
      *(_QWORD *)(v6 + 3528) = *(_QWORD *)a4;
      *(_QWORD *)(v6 + 2912) = gphLibNfc_IoctlSetPropRfConfig;
      *(_BYTE *)(v6 + 2904) = 0;
      *(_BYTE *)(v6 + 2906) = 0;
      v7 = (char)gphLibNfc_IoctlSetPropRfConfig[0];
      if (gphLibNfc_IoctlSetPropRfConfig[0])
      {
        v7 = 0;
        v8 = off_2550A0AC8;
        do
        {
          ++v7;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
      *(_BYTE *)(v6 + 2905) = v7;
      v5 = sub_2198655FC(v6, 0, 0);
    }
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"IoctlSetRfPropConfigTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetRfPropConfigTrans");
  return v5;
}

uint64_t sub_2198A09A8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, _QWORD *a5)
{
  uint64_t v7;
  char v8;
  uint64_t *v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetRfPropConfigTrans");
  sub_21988EDF4(v14, &v13);
  if (a4 && a5 && (v7 = v13) != 0)
  {
    *(_QWORD *)(v13 + 3536) = *a5;
    *(_BYTE *)(v7 + 3520) = *(_DWORD *)(a4 + 8);
    *(_QWORD *)(v7 + 3528) = *(_QWORD *)a4;
    *(_BYTE *)(v7 + 3545) = 1;
    *(_QWORD *)(v7 + 2912) = gphLibNfc_IoctlGetRfConfig;
    *(_BYTE *)(v7 + 2904) = 0;
    *(_BYTE *)(v7 + 2906) = 0;
    v8 = (char)gphLibNfc_IoctlGetRfConfig[0];
    if (gphLibNfc_IoctlGetRfConfig[0])
    {
      v8 = 0;
      v9 = &qword_2550A0AF8;
      do
      {
        ++v8;
        v10 = *v9;
        v9 += 2;
      }
      while (v10);
    }
    *(_BYTE *)(v7 + 2905) = v8;
    v11 = sub_2198655FC(v7, 0, 0);
    if ((_DWORD)v11 != 13)
      *(_BYTE *)(v13 + 3545) = 0;
  }
  else
  {
    v11 = 1;
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"IoctlGetRfPropConfigTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetRfPropConfigTrans");
  return v11;
}

uint64_t sub_2198A0AC4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, _QWORD *a5)
{
  uint64_t v7;
  char v8;
  uint64_t *v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetRfPropRegsTrans");
  sub_21988EDF4(v14, &v13);
  if (a4 && a5 && (v7 = v13) != 0)
  {
    *(_QWORD *)(v13 + 3536) = *a5;
    *(_BYTE *)(v7 + 3520) = *(_DWORD *)(a4 + 8);
    *(_QWORD *)(v7 + 3528) = *(_QWORD *)a4;
    *(_QWORD *)(v7 + 2912) = gphLibNfc_IoctlGetRfRegVal;
    *(_BYTE *)(v7 + 2904) = 0;
    *(_BYTE *)(v7 + 2906) = 0;
    v8 = (char)gphLibNfc_IoctlGetRfRegVal[0];
    if (gphLibNfc_IoctlGetRfRegVal[0])
    {
      v8 = 0;
      v9 = &qword_2550A0BD8;
      do
      {
        ++v8;
        v10 = *v9;
        v9 += 2;
      }
      while (v10);
    }
    *(_BYTE *)(v7 + 2905) = v8;
    v11 = sub_2198655FC(v7, 0, 0);
  }
  else
  {
    v11 = 1;
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"IoctlGetRfPropRegsTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetRfPropRegsTrans");
  return v11;
}

uint64_t sub_2198A0BC8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  _QWORD *v6;
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  uint64_t v10;
  char v11;
  uint64_t *v12;
  uint64_t v13;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;

  v16 = 0;
  v17 = a1;
  v15 = 0;
  sub_219850718(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetSpmiGpioTrans");
  sub_21988EB80(v17, &v15);
  if (v15)
  {
    *(_QWORD *)(v15 + 48) = a4;
    sub_21988EDF4(v17, &v16);
    v5 = v15;
    v6 = *(_QWORD **)(v15 + 48);
    if (!v6 || ((v7 = v16, *v6) ? (v8 = v16 == 0) : (v8 = 1), v8))
    {
      v9 = 1;
      sub_219850628(0, (unsigned int *)&v17, 4u, 1u, (uint64_t)"IoctlGetSpmiGpioTrans: Failed");
    }
    else
    {
      *(_WORD *)(v15 + 216) = -24575;
      v10 = v5 + 216;
      *(_BYTE *)(v10 + 2) = 49;
      *(_BYTE *)(v7 + 3520) = 3;
      *(_QWORD *)(v7 + 3528) = v10;
      *(_QWORD *)(v10 - 80) = *v6;
      *(_QWORD *)(v7 + 2912) = gphLibNfc_IoctlGetSpmiGpio;
      *(_BYTE *)(v7 + 2904) = 0;
      *(_BYTE *)(v7 + 2906) = 0;
      v11 = (char)gphLibNfc_IoctlGetSpmiGpio[0];
      if (gphLibNfc_IoctlGetSpmiGpio[0])
      {
        v11 = 0;
        v12 = &qword_2550A0B88;
        do
        {
          ++v11;
          v13 = *v12;
          v12 += 2;
        }
        while (v13);
      }
      *(_BYTE *)(v7 + 2905) = v11;
      v9 = sub_2198655FC(v7, 0, 0);
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v17, 4u, 1u, (uint64_t)"IoctlGetSpmiGpioTrans: Invalid IOCTL Context");
    v9 = 255;
  }
  sub_219850808(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetSpmiGpioTrans");
  return v9;
}

uint64_t sub_2198A0D24(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t *a4)
{
  uint64_t v6;
  uint64_t v7;
  _QWORD *v8;
  unsigned int v10;
  _QWORD *v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlConfigDebugModeTrans");
  sub_21988EDF4(v13, &v12);
  sub_21988EB80(v13, &v11);
  v6 = 1;
  if (a4 && v12 && v11)
  {
    v7 = *a4;
    if (*a4)
    {
      if (*((_DWORD *)a4 + 2) == 3 && !*(_BYTE *)v7)
      {
        v10 = *(unsigned __int16 *)(v7 + 1);
        if (v10 < 0x7D0)
        {
          sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlConfigDebugModeTrans: Invalid timeout value");
          a3 = 147;
        }
        else
        {
          *(_WORD *)(v12 + 708) = v10;
        }
      }
      else
      {
        a3 = 1;
        sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlConfigDebugModeTrans: Failed to update SeTransceive Modified Timeout details ");
      }
    }
    v8 = v11;
    v11[2] = 0;
    *v8 = 0;
    v6 = a3;
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlConfigDebugModeTrans");
  return v6;
}

uint64_t sub_2198A0E4C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;
  unsigned __int16 v12;
  uint64_t v13;

  v13 = a1;
  v12 = 0;
  v10 = 0;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlExpModeSWaitTimerOffTrans");
  sub_21988EB80(v13, &v10);
  if (v10)
  {
    sub_21988EDF4(v13, &v11);
    if (a4 && v11)
    {
      v5 = v10;
      *(_WORD *)(v10 + 216) = -608;
      v6 = 1;
      *(_BYTE *)(v5 + 218) = 1;
      phOsalNfc_MemCopy();
      if (v12 <= 0x9F6u)
      {
        v7 = v11;
        v8 = v10 + 216;
        *(_BYTE *)(v10 + 219) = v12 / 0xAu;
        v6 = sub_21986C070(v7, v8, 4u, 5);
      }
    }
    else
    {
      v6 = 1;
      sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"IoctlSuicaWaitTimerOffTrans: Failed");
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"IoctlSuicaWaitTimerOffTrans: Invalid IOCTL Context");
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlExpModeSWaitTimerOffTrans");
  return v6;
}

uint64_t sub_2198A0F90(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;
  unsigned __int16 v12;
  uint64_t v13;

  v13 = a1;
  v12 = 0;
  v10 = 0;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlVasExpWaitTimerOffTrans");
  sub_21988EB80(v13, &v10);
  if (v10)
  {
    sub_21988EDF4(v13, &v11);
    if (a4 && v11)
    {
      v5 = v10;
      *(_WORD *)(v10 + 216) = -19808;
      v6 = 1;
      *(_BYTE *)(v5 + 218) = 1;
      phOsalNfc_MemCopy();
      if (v12 <= 0x384u)
      {
        v7 = v11;
        v8 = v10 + 216;
        *(_BYTE *)(v10 + 219) = v12 / 0xAu;
        v6 = sub_21986C070(v7, v8, 4u, 5);
      }
    }
    else
    {
      v6 = 1;
      sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"IoctlVasExpWaitTimerOffTrans: Failed");
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"IoctlVasExpWaitTimerOffTrans: Invalid IOCTL Context");
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlVasExpWaitTimerOffTrans");
  return v6;
}

uint64_t sub_2198A10D4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;
  unsigned __int16 v12;
  uint64_t v13;

  v13 = a1;
  v12 = 0;
  v10 = 0;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGenAWaitTimerOffTrans");
  sub_21988EB80(v13, &v10);
  if (v10)
  {
    sub_21988EDF4(v13, &v11);
    if (a4 && v11)
    {
      v5 = v10;
      *(_WORD *)(v10 + 216) = -16992;
      v6 = 1;
      *(_BYTE *)(v5 + 218) = 1;
      phOsalNfc_MemCopy();
      if (v12 <= 0x384u)
      {
        v7 = v11;
        v8 = v10 + 216;
        *(_BYTE *)(v10 + 219) = v12 / 0xAu;
        v6 = sub_21986C070(v7, v8, 4u, 5);
      }
    }
    else
    {
      v6 = 1;
      sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"IoctlVasExpWaitTimerOffTrans: Failed");
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"IoctlVasExpWaitTimerOffTrans: Invalid IOCTL Context");
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGenAWaitTimerOffTrans");
  return v6;
}

uint64_t sub_2198A1218(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;
  unsigned __int16 v13;
  uint64_t v14;

  v14 = a1;
  v13 = 0;
  v11 = 0;
  v12 = 0;
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSwioPadVolNtfTimerTrans");
  sub_21988EB80(v14, &v11);
  if (v11)
  {
    sub_21988EDF4(v14, &v12);
    if (a4 && v12)
    {
      *(_BYTE *)(v12 + 5401) = 0;
      v5 = v11;
      *(_WORD *)(v11 + 216) = 5537;
      v6 = 1;
      *(_BYTE *)(v5 + 218) = 1;
      phOsalNfc_MemCopy();
      if (!v13 || v13 - 4001 >= 0xFFFFF253)
      {
        v7 = 42949673 * v13;
        v9 = v11;
        v8 = v12;
        *(_BYTE *)(v11 + 219) = v13 / 0x64u;
        if (*(_BYTE *)(v8 + 2945) == 1 && a4[2] == 3 && *(_BYTE *)(*(_QWORD *)a4 + 2) == 1)
          *(_BYTE *)(v9 + 219) = BYTE4(v7) | 0x40;
        v6 = sub_21986C070(v8, v9 + 216, 4u, 5);
        if ((_DWORD)v6 == 13)
          *(_BYTE *)(v12 + 5401) = 1;
      }
    }
    else
    {
      v6 = 1;
      sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"IoctlSwioPadVolNtfTimerTrans: Failed");
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"IoctlSwioPadVolNtfTimerTrans: Invalid IOCTL Context");
    v6 = 255;
  }
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSwioPadVolNtfTimerTrans");
  return v6;
}

uint64_t sub_2198A13C0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  _BYTE *v5;
  char v6;
  uint64_t (**v7)();
  uint64_t (*v8)();
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetRfCalDataSignedTrans");
  sub_21988EDF4(v12, &v11);
  if (a4 && (v5 = (_BYTE *)v11) != 0)
  {
    *(_QWORD *)(v11 + 2912) = gphLibNfc_IoctlSetRfCalData;
    v5[2904] = 0;
    v5[2906] = 0;
    v6 = (char)gphLibNfc_IoctlSetRfCalData[0];
    if (gphLibNfc_IoctlSetRfCalData[0])
    {
      v6 = 0;
      v7 = off_2550A0BF8;
      do
      {
        ++v6;
        v8 = *v7;
        v7 += 2;
      }
      while (v8);
    }
    v5[2905] = v6;
    v9 = sub_2198655FC((uint64_t)v5, 0, a4);
  }
  else
  {
    v9 = 1;
    sub_219850628(0, (unsigned int *)&v12, 4u, 1u, (uint64_t)"IoctlSetRfCalDataSignedTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetRfCalDataSignedTrans");
  return v9;
}

uint64_t sub_2198A14A4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  _BYTE *v5;
  char v6;
  uint64_t *v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetRfCalDataSignedTrans");
  sub_21988EDF4(v12, &v11);
  if (a4 && (v5 = (_BYTE *)v11) != 0)
  {
    *(_QWORD *)(v11 + 2912) = gphLibNfc_IoctlGetRfCalData;
    v5[2904] = 0;
    v5[2906] = 0;
    v6 = (char)gphLibNfc_IoctlGetRfCalData[0];
    if (gphLibNfc_IoctlGetRfCalData[0])
    {
      v6 = 0;
      v7 = &qword_2550A0C28;
      do
      {
        ++v6;
        v8 = *v7;
        v7 += 2;
      }
      while (v8);
    }
    v5[2905] = v6;
    v9 = sub_2198655FC((uint64_t)v5, 0, a4);
  }
  else
  {
    v9 = 1;
    sub_219850628(0, (unsigned int *)&v12, 4u, 1u, (uint64_t)"IoctlGetRfCalDataSignedTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetRfCalDataSignedTrans");
  return v9;
}

uint64_t sub_2198A1588(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  const char *v6;
  int v7;
  unsigned int *v8;
  char v9;
  uint64_t (**v10)();
  uint64_t (*v11)();
  unsigned int *v12;
  unsigned int *v14;
  char v15;
  uint64_t v16;

  v16 = a1;
  v15 = 0;
  v14 = 0;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlIoctlSetRfConfigSignedTrans");
  sub_21988EDF4(v16, &v14);
  v5 = 1;
  v6 = "IoctlIoctlSetRfConfigSignedTrans: Failed";
  if (!a4)
    goto LABEL_10;
  if (!v14)
    goto LABEL_10;
  v7 = sub_2198EF0AC(v14, *(_QWORD *)a4, *(_DWORD *)(a4 + 8), &v15);
  v6 = "IoctlIoctlSetRfConfigSignedTrans:                                    Buffer is not adhering to semantics of RF_SI"
       "GNED_CONFIG_CMD!";
  if (v7 || !v15)
    goto LABEL_10;
  v8 = v14;
  *((_BYTE *)v14 + 3248) = v15;
  *((_QWORD *)v8 + 405) = *(_QWORD *)a4;
  v8[877] = *(_DWORD *)(a4 + 8);
  v8[878] = 0;
  *((_QWORD *)v8 + 364) = gphLibNfc_IoctlSetPropConfigSigned;
  *((_BYTE *)v8 + 2904) = 0;
  *((_BYTE *)v8 + 2906) = 0;
  v9 = (char)gphLibNfc_IoctlSetPropConfigSigned[0];
  if (gphLibNfc_IoctlSetPropConfigSigned[0])
  {
    v9 = 0;
    v10 = off_2550A0BA8;
    do
    {
      ++v9;
      v11 = *v10;
      v10 += 2;
    }
    while (v11);
  }
  *((_BYTE *)v8 + 2905) = v9;
  v5 = sub_2198655FC((uint64_t)v8, 0, 0);
  if ((_DWORD)v5 != 13)
  {
    v12 = v14;
    v14[878] = 0;
    *((_QWORD *)v12 + 442) = 0;
    *((_QWORD *)v12 + 441) = 0;
    v6 = "IoctlIoctlSetRfConfigSignedTrans Failed!!!";
LABEL_10:
    sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v6);
  }
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlIoctlSetRfConfigSignedTrans");
  return v5;
}

uint64_t sub_2198A16D0(uint64_t a1, uint64_t a2, uint64_t a3, char **a4)
{
  _BYTE *v5;
  uint64_t v6;
  char v7;
  char v8;
  uint64_t v9;
  const char *v10;
  uint64_t v12;
  _BYTE *v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  v12 = 0;
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSysPwrTraceConfigTrans");
  sub_21988EDF4(v14, &v13);
  sub_21988EB80(v14, &v12);
  if (!a4 || (v5 = v13) == 0 || (v6 = v12) == 0)
  {
    v10 = "phLibNfc_SM_IoctlSyPwrTraceConfigTrans: Failed";
LABEL_14:
    v9 = 1;
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)v10);
    goto LABEL_15;
  }
  if (!*a4 || *((_DWORD *)a4 + 2) != 1)
  {
    v10 = "phLibNfc_SM_IoctlGetPwrTrackConfigTrans:                                    Buffer is not adhering to semantic"
          "s of PHLIBNFC_IOCTL_GET_PWR_TRACK_CFG!";
    goto LABEL_14;
  }
  v13[5400] = 0;
  *(_WORD *)(v6 + 216) = 28064;
  *(_BYTE *)(v6 + 218) = 1;
  v7 = **a4;
  if (v5[2937] == 1 || v5[2938] == 1 || v5[2944] == 1)
    v8 = v7 & 3;
  else
    v8 = v7 & 1;
  *(_BYTE *)(v6 + 219) = v8;
  v9 = sub_21986C070((uint64_t)v5, v6 + 216, 4u, 6);
  if ((_DWORD)v9 == 13)
    v13[5400] = 1;
LABEL_15:
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSysPwrTraceConfigTrans");
  return v9;
}

uint64_t sub_2198A1828(uint64_t a1, uint64_t a2, uint64_t a3, unsigned __int8 **a4)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  const char *v9;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlCrcChkConfigTrans");
  sub_21988EDF4(v13, &v11);
  sub_21988EB80(v13, &v12);
  if (!a4 || (v5 = v11) == 0 || (v6 = v12) == 0)
  {
    v9 = "phLibNfc_SM_IoctlCrcChkConfigTrans: Failed";
LABEL_10:
    v8 = 1;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)v9);
    goto LABEL_11;
  }
  if (!*a4 || *((_DWORD *)a4 + 2) != 1)
  {
    v9 = "phLibNfc_SM_IoctlCrcChkConfigTrans:                                    Buffer is not adhering to semantics of P"
         "HLIBNFC_IOCTL_SET_CRC_CHK_CFG!";
    goto LABEL_10;
  }
  *(_BYTE *)(v11 + 5408) = 0;
  *(_WORD *)(v6 + 216) = -16480;
  v7 = v6 + 216;
  *(_BYTE *)(v7 + 2) = 1;
  *(_BYTE *)(v7 + 3) = **a4;
  *(_DWORD *)(v5 + 5404) = **a4;
  v8 = sub_21986C070(v5, v7, 4u, 7);
  if ((_DWORD)v8 == 13)
    *(_BYTE *)(v11 + 5408) = 1;
  else
    sub_219851888(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlCrcChkConfigTrans returned with status Rxd=");
LABEL_11:
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlCrcChkConfigTrans");
  return v8;
}

uint64_t sub_2198A1978(uint64_t a1)
{
  BOOL v1;
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  _QWORD *v5;
  _QWORD *v7;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  v7 = 0;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlEnableDtaModeTrans");
  sub_21988EDF4(v9, &v8);
  sub_21988EB80(v9, &v7);
  if (v8)
    v1 = v7 == 0;
  else
    v1 = 1;
  if (v1)
  {
    v2 = 1;
  }
  else
  {
    v3 = sub_21990158C(*(_QWORD *)(v8 + 3040), 1);
    v2 = v3;
    if ((_DWORD)v3)
    {
      sub_219850628(0, (unsigned int *)&v9, 4u, 2u, (uint64_t)"phLibNfc_SM_IoctlEnableDtaModeTrans: Failed to update NCI DTA flag");
    }
    else
    {
      v4 = v8;
      *(_BYTE *)(v8 + 2885) = 1;
      *(_BYTE *)(v4 + 717) = 0;
    }
    v5 = v7;
    v7[2] = 0;
    *v5 = 0;
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlEnableDtaModeTrans");
  return v2;
}

uint64_t sub_2198A1A5C(uint64_t a1)
{
  BOOL v1;
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  _QWORD *v5;
  _QWORD *v7;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  v7 = 0;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlDisableDtaModeTrans");
  sub_21988EDF4(v9, &v8);
  sub_21988EB80(v9, &v7);
  if (v8)
    v1 = v7 == 0;
  else
    v1 = 1;
  if (v1)
  {
    v2 = 1;
  }
  else
  {
    v3 = sub_21990158C(*(_QWORD *)(v8 + 3040), 0);
    v2 = v3;
    if ((_DWORD)v3)
    {
      sub_219850628(0, (unsigned int *)&v9, 4u, 2u, (uint64_t)"phLibNfc_SM_IoctlDisableDtaModeTrans: Failed to update NCI DTA flag");
    }
    else
    {
      v4 = v8;
      *(_BYTE *)(v8 + 2885) = 0;
      *(_BYTE *)(*(_QWORD *)(v4 + 6840) + 242) = 0;
      *(_BYTE *)(v4 + 717) = 3;
    }
    v5 = v7;
    v7[2] = 0;
    *v5 = 0;
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlDisableDtaModeTrans");
  return v2;
}

uint64_t sub_2198A1B48(uint64_t a1, int a2, uint64_t a3, int *a4, uint64_t a5)
{
  uint64_t v9;
  unsigned int *v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigDiscoveryTrans");
  sub_21988EDF4(v12, &v11);
  v9 = sub_2198D9B9C((uint64_t)v11, a2, a3, a4, a5);
  if (!(_DWORD)v9)
    v9 = sub_2198D94F8(v11, a4, a5);
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigDiscoveryTrans");
  return v9;
}

uint64_t sub_2198A1C00(uint64_t a1, int a2, uint64_t a3, _DWORD *a4, uint64_t a5)
{
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_EnableDisableMultiTagTrans");
  sub_21988EDF4(v12, &v11);
  v9 = sub_2198D9B9C(v11, a2, a3, a4, a5);
  if (!(_DWORD)v9)
    v9 = sub_2198D9444(v11);
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_EnableDisableMultiTagTrans");
  return v9;
}

uint64_t sub_2198A1CB0(uint64_t a1, int a2, uint64_t a3, _DWORD *a4, uint64_t a5)
{
  unsigned int *v9;
  char v10;
  uint64_t (**v11)();
  uint64_t (*v12)();
  uint64_t v13;
  unsigned int *v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigInitDiscoveryStopTrans");
  sub_21988EDF4(v16, &v15);
  if (v15)
  {
    a3 = sub_2198D9B9C((uint64_t)v15, a2, a3, a4, a5);
    if (!(_DWORD)a3)
    {
      if (a5)
      {
        v9 = v15;
        if (*(_DWORD *)(a5 + 88) == 1)
        {
          *((_QWORD *)v15 + 364) = &qword_2550A3548;
          *((_BYTE *)v9 + 2904) = 0;
          *((_BYTE *)v9 + 2906) = 0;
          v10 = qword_2550A3548;
          if (qword_2550A3548)
          {
            v10 = 0;
            v11 = off_2550A3558;
            do
            {
              ++v10;
              v12 = *v11;
              v11 += 2;
            }
            while (v12);
          }
          *((_BYTE *)v9 + 2905) = v10;
          v13 = sub_2198655FC((uint64_t)v9, 0, 0);
        }
        else
        {
          v13 = sub_2198D98E4(v15, a4);
        }
        a3 = v13;
      }
      else
      {
        a3 = 1;
        sub_219850628(1, v15 + 4842, 4u, 1u, (uint64_t)"phLibNfc_SM_ConfigInitDiscoveryStopTrans: Invalid Input Parameter passed");
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigInitDiscoveryStopTrans");
  return a3;
}

uint64_t sub_2198A1DF0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, _BYTE *a5)
{
  uint64_t v7;
  int v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_DeactivateTrans");
  sub_21988EDF4(v11, &v10);
  v7 = v10;
  if (v10)
  {
    if (*(_BYTE *)(v10 + 697) == 1)
    {
      v8 = sub_2198D0DC0(*(_QWORD *)(v10 + 19360), 1);
      v7 = v10;
      if (!v8)
      {
        *(_QWORD *)(v10 + 512) = v10 + 392;
        *(_DWORD *)(v7 + 524) = 0;
        sub_219850718(2, (unsigned int *)v7, 4u, 5u, (uint64_t)"phLibNfc_FindSetModeTransEvent");
        sub_219850808(2, (unsigned int *)v7, 4u, 5u, (uint64_t)"phLibNfc_FindSetModeTransEvent");
        sub_2198D1B2C(*(_QWORD *)(v10 + 19360), 167, a3, 0, 0);
        v7 = v10;
        *(_BYTE *)(v10 + 697) = 0;
      }
    }
    *(_BYTE *)(v7 + 1424) = 0;
    if (*(_QWORD *)(v7 + 6152))
    {
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 15, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(v10 + 6152))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6160), 0, 0, a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6160) = 0;
      *(_QWORD *)(v7 + 6152) = 0;
    }
    else if (*(_QWORD *)(v7 + 6216))
    {
      if (sub_2198D2640(*(_QWORD *)(v7 + 19360)) == 22)
        a3 = a3;
      else
        a3 = 0;
      sub_219885F70(1, (unsigned int *)(v10 + 19368), 4u, 130, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, _QWORD, uint64_t))(v10 + 6216))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6224), 0, a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6224) = 0;
      *(_QWORD *)(v7 + 6216) = 0;
    }
    else if (*(_QWORD *)(v7 + 6424))
    {
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 22, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, uint64_t))(v10 + 6424))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6432), a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6432) = 0;
      *(_QWORD *)(v7 + 6424) = 0;
    }
    else if (*(_QWORD *)(v7 + 6264))
    {
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 23, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(v10 + 6264))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6272), 0, 0, a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6272) = 0;
      *(_QWORD *)(v7 + 6264) = 0;
    }
    else if (*(_QWORD *)(v7 + 6360))
    {
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 24, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, uint64_t))(v10 + 6360))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6368), a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6368) = 0;
      *(_QWORD *)(v7 + 6360) = 0;
    }
    else if (*(_QWORD *)(v7 + 6376))
    {
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 25, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, uint64_t))(v10 + 6376))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6384), a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6384) = 0;
      *(_QWORD *)(v7 + 6376) = 0;
    }
    else if (*(_QWORD *)(v7 + 6392))
    {
      *(_BYTE *)(v7 + 19372) = 0;
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 27, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, uint64_t))(v10 + 6392))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6400), a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6400) = 0;
      *(_QWORD *)(v7 + 6392) = 0;
    }
    else if (*(_QWORD *)(v7 + 6248))
    {
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 114, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, _QWORD))(v10 + 6248))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6256), 0);
      v7 = v10;
      *(_QWORD *)(v10 + 6256) = 0;
      *(_QWORD *)(v7 + 6248) = 0;
    }
    else if (*(_QWORD *)(v7 + 6168))
    {
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 16, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(v10 + 6168))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6176), 0, 0, a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6176) = 0;
      *(_QWORD *)(v7 + 6168) = 0;
    }
    else if (*(_QWORD *)(v7 + 6184))
    {
      sub_219885F70(1, (unsigned int *)(v7 + 19368), 4u, 17, (uint64_t)"phLibNfc_SM_DeactivateTrans");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(v10 + 6184))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6192), 0, 0, a3);
      v7 = v10;
      *(_QWORD *)(v10 + 6192) = 0;
      *(_QWORD *)(v7 + 6184) = 0;
    }
    else if (a5 && *(_QWORD *)(v7 + 6232) && !*a5)
    {
      sub_219850628(0, (unsigned int *)&v11, 4u, 4u, (uint64_t)"Invoking pClientNtfRegRespCB with rf deactivated status");
      sub_219853E34(0, (unsigned int *)&v11, 4u, 4u, (uint64_t)"DeactivateTrans :RemDevNtfCB[De-Activated status]");
      (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(v10 + 6232))(*(_QWORD *)(v10 + 19360), *(_QWORD *)(v10 + 6240), 0, 0, a3);
      v7 = v10;
    }
    sub_2198C0850(v7);
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"phLibNfc_SM_DeactivateTrans: Invalid LIBNFC context!!");
  }
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_DeactivateTrans");
  return 0;
}

uint64_t sub_2198A2348(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v6;
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetSpmiGpioTrans");
  v6 = 1;
  if (a5 && v8)
    v6 = phTmlNfc_IoCtl();
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSetSpmiGpioTrans");
  return v6;
}

uint64_t sub_2198A23D4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSpmiErrorRegsTrans");
  sub_21988EB80(v9, &v8);
  if (v8)
  {
    v6 = 1;
    if (a5)
    {
      if (v9)
      {
        if (v9 == *(_QWORD *)(v8 + 8))
        {
          v6 = sub_2198AFF40(v9);
          if (!(_DWORD)v6)
          {
            v6 = phTmlNfc_SpmiDrvErrorStatus();
            sub_2198B00C4(v9, 20);
          }
        }
      }
    }
  }
  else
  {
    v6 = 1;
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSpmiErrorRegsTrans");
  return v6;
}

uint64_t sub_2198A249C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_ClearSpmiErrorRegsTrans");
  sub_21988EB80(v9, &v8);
  if (v8)
  {
    v6 = 1;
    if (a5)
    {
      if (v9)
      {
        if (v9 == *(_QWORD *)(v8 + 8))
        {
          v6 = sub_2198AFF40(v9);
          if (!(_DWORD)v6)
          {
            v6 = phTmlNfc_SpmiDrvErrorStatus();
            sub_2198B00C4(v9, 20);
          }
        }
      }
    }
  }
  else
  {
    v6 = 1;
  }
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_ClearSpmiErrorRegsTrans");
  return v6;
}

uint64_t sub_2198A2564(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t SpmiDrvConfigRegs;
  BOOL v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSpmiCfgRegsTrans");
  sub_21988EB80(v10, &v9);
  SpmiDrvConfigRegs = 1;
  if (a5)
  {
    if (v9)
      v7 = v10 == 0;
    else
      v7 = 1;
    if (!v7 && v10 == *(_QWORD *)(v9 + 8))
    {
      SpmiDrvConfigRegs = sub_2198AFF40(v10);
      if (!(_DWORD)SpmiDrvConfigRegs)
      {
        SpmiDrvConfigRegs = phTmlNfc_SetGetSpmiDrvConfigRegs();
        sub_2198B00C4(v10, 20);
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_GetSpmiCfgRegsTrans");
  return SpmiDrvConfigRegs;
}

uint64_t sub_2198A2628(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t SpmiDrvConfigRegs;
  BOOL v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SetSpmiCfgRegsTrans");
  sub_21988EB80(v10, &v9);
  SpmiDrvConfigRegs = 1;
  if (a5)
  {
    if (v9)
      v7 = v10 == 0;
    else
      v7 = 1;
    if (!v7 && v10 == *(_QWORD *)(v9 + 8))
    {
      SpmiDrvConfigRegs = sub_2198AFF40(v10);
      if (!(_DWORD)SpmiDrvConfigRegs)
      {
        SpmiDrvConfigRegs = phTmlNfc_SetGetSpmiDrvConfigRegs();
        sub_2198B00C4(v10, 20);
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SetSpmiCfgRegsTrans");
  return SpmiDrvConfigRegs;
}

uint64_t sub_2198A26E8(uint64_t a1, int a2, uint64_t a3, _QWORD *a4)
{
  _QWORD *v7;
  void (*v8)(uint64_t, uint64_t, uint64_t);
  uint64_t v9;
  unsigned int *v10;
  uint64_t v11;
  uint64_t v12;
  void (*v14)(_QWORD, uint64_t, uint64_t, _QWORD *);
  uint64_t v15;
  void (*v16)(_QWORD, uint64_t, uint64_t, uint64_t);
  uint64_t v17;
  void (*v18)(_QWORD, uint64_t, _QWORD, uint64_t);
  uint64_t v19;
  uint64_t *v20;
  uint64_t v21;
  uint64_t v22;

  v21 = 0;
  v22 = a1;
  v20 = 0;
  sub_219850718(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_InitTransComplete");
  sub_21988EDF4(v22, &v21);
  sub_21988EB80(v22, &v20);
  if ((_DWORD)a3)
    sub_219886108(v22, a3);
  else
    sub_21988620C(v22, 0);
  v7 = (_QWORD *)v21;
  if (v21)
  {
    switch(a2)
    {
      case 6:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6552);
        v9 = *(_QWORD *)(v21 + 6560);
        *(_OWORD *)(v21 + 6552) = 0u;
        if (v8)
        {
          sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"HsuCfgParam:Invoking callback function, wStatus = ");
          v10 = (unsigned int *)(v21 + 19368);
          v11 = 4;
          goto LABEL_10;
        }
        break;
      case 7:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6632);
        v9 = *(_QWORD *)(v21 + 6640);
        *(_OWORD *)(v21 + 6632) = 0u;
        if (v8)
        {
          sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"Power mode Config: Invoking callback function, wStatus = ");
          v10 = (unsigned int *)(v21 + 19368);
          v11 = 5;
          goto LABEL_10;
        }
        break;
      case 8:
      case 9:
      case 10:
      case 11:
      case 13:
      case 14:
      case 15:
      case 16:
      case 17:
      case 18:
      case 19:
      case 20:
      case 21:
      case 22:
      case 23:
      case 24:
      case 25:
      case 26:
      case 27:
      case 28:
      case 29:
      case 30:
      case 31:
      case 32:
      case 33:
      case 35:
      case 36:
      case 37:
      case 39:
      case 40:
      case 42:
      case 43:
      case 44:
      case 45:
      case 46:
      case 47:
      case 48:
      case 49:
      case 50:
      case 51:
      case 52:
      case 53:
      case 54:
      case 55:
      case 56:
      case 57:
      case 58:
      case 59:
      case 60:
      case 61:
      case 62:
      case 63:
      case 64:
      case 65:
      case 69:
      case 76:
      case 95:
      case 97:
      case 98:
      case 99:
      case 100:
      case 101:
      case 102:
      case 103:
      case 104:
      case 105:
      case 106:
      case 107:
      case 108:
      case 113:
      case 114:
      case 124:
        goto LABEL_18;
      case 12:
        v14 = *(void (**)(_QWORD, uint64_t, uint64_t, _QWORD *))(v21 + 6472);
        v15 = *(_QWORD *)(v21 + 6480);
        *(_QWORD *)(v21 + 6480) = 0;
        v7[809] = 0;
        if (v14)
        {
          sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"SE Get RF param:Invoking callback function, wStatus = ");
          sub_219885F70(1, (unsigned int *)(v21 + 19368), 4u, 7, (uint64_t)"phLibNfc_SM_Main_InitTransComplete");
          v14(*(_QWORD *)(v21 + 19360), v15, a3, a4);
        }
        break;
      case 34:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6728);
        v9 = *(_QWORD *)(v21 + 6736);
        *(_OWORD *)(v21 + 6728) = 0u;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"P2P Set Config:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 32;
        goto LABEL_10;
      case 38:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6440);
        v9 = *(_QWORD *)(v21 + 6448);
        *(_QWORD *)(v21 + 6448) = 0;
        v7[805] = 0;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"HCE Set Config param:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 37;
        goto LABEL_10;
      case 41:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6456);
        v9 = *(_QWORD *)(v21 + 6464);
        *(_QWORD *)(v21 + 6464) = 0;
        v7[807] = 0;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"Config Routing:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 40;
        goto LABEL_10;
      case 66:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6104);
        v9 = *(_QWORD *)(v21 + 6112);
        *(_QWORD *)(v21 + 6112) = 0;
        v7[763] = 0;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"Set RF Settings:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 42;
        goto LABEL_10;
      case 67:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6088);
        v9 = *(_QWORD *)(v21 + 6096);
        *(_QWORD *)(v21 + 6096) = 0;
        v7[761] = 0;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"Set RF Settings:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 43;
        goto LABEL_10;
      case 68:
        v16 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t))(v21 + 6808);
        v17 = *(_QWORD *)(v21 + 6816);
        *(_OWORD *)(v21 + 6808) = 0u;
        if (v16)
        {
          sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"phLibNfc_SM_eAntennaSelfTest:Invoking callback, wStatus = ");
          sub_219885F70(1, (unsigned int *)(v21 + 19368), 4u, 44, (uint64_t)"phLibNfc_SM_Main_InitTransComplete");
          v16(*(_QWORD *)(v21 + 19360), v17, v21 + 5996, a3);
        }
        break;
      case 70:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6584);
        v9 = *(_QWORD *)(v21 + 6592);
        *(_OWORD *)(v21 + 6584) = 0u;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"TriggerNfccAssertion:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 46;
        goto LABEL_10;
      case 71:
        v18 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(v21 + 6040);
        v19 = *(_QWORD *)(v21 + 6048);
        *(_OWORD *)(v21 + 6040) = 0u;
        if (v18)
        {
          sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"GetClrAssertRegs:Invoking callback function, wStatus = ");
          sub_219885F70(1, (unsigned int *)(v21 + 19368), 4u, 47, (uint64_t)"phLibNfc_SM_Main_InitTransComplete");
          v18(*(_QWORD *)(v21 + 19360), v19, *a4, a3);
        }
        else if (!a4)
        {
          break;
        }
        if (a4[2])
        {
          phOsalNfc_FreeMemory();
          a4[2] = 0;
        }
        phOsalNfc_SetMemory();
        break;
      case 72:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6600);
        v9 = *(_QWORD *)(v21 + 6608);
        *(_OWORD *)(v21 + 6600) = 0u;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"ConfigureLogging:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 48;
        goto LABEL_10;
      case 73:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6616);
        v9 = *(_QWORD *)(v21 + 6624);
        *(_OWORD *)(v21 + 6616) = 0u;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"ConfigureAssertionLogging:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 49;
        goto LABEL_10;
      case 74:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6648);
        v9 = *(_QWORD *)(v21 + 6656);
        *(_OWORD *)(v21 + 6648) = 0u;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf:Invoking callback, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 50;
        goto LABEL_10;
      case 75:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6664);
        v9 = *(_QWORD *)(v21 + 6672);
        *(_OWORD *)(v21 + 6664) = 0u;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"ValidateEepromSettings:Invoking callback function, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 51;
        goto LABEL_10;
      case 77:
      case 78:
      case 79:
      case 80:
      case 81:
      case 82:
      case 83:
      case 84:
      case 85:
      case 86:
      case 87:
        sub_2198EF748(v21, (uint64_t)a4, a3);
        break;
      case 88:
      case 89:
      case 90:
      case 91:
      case 92:
      case 93:
      case 94:
      case 96:
        v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6792);
        v9 = *(_QWORD *)(v21 + 6800);
        *(_OWORD *)(v21 + 6792) = 0u;
        if (!v8)
          break;
        sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
        v10 = (unsigned int *)(v21 + 19368);
        v11 = 132;
LABEL_10:
        sub_219885F70(1, v10, 4u, v11, (uint64_t)"phLibNfc_SM_Main_InitTransComplete");
        v12 = *(_QWORD *)(v21 + 19360);
        goto LABEL_11;
      case 109:
      case 110:
      case 111:
      case 112:
      case 115:
      case 116:
      case 117:
      case 118:
      case 119:
      case 120:
      case 121:
      case 122:
      case 123:
      case 125:
      case 126:
        sub_21986C460(v20, v20[6], a3);
        break;
      default:
        if ((a2 - 136) >= 3)
        {
          if (a2 == 139)
          {
            v22 = *(_QWORD *)(v21 + 19360);
            v8 = *(void (**)(uint64_t, uint64_t, uint64_t))(v21 + 6136);
            v9 = *(_QWORD *)(v21 + 6144);
            sub_21989B2B0(v21);
            v21 = 0;
            if (v8)
            {
              sub_219851790(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"ShutdownCb:Invoking callback function, wStatus = ");
              sub_219885F70(0, (unsigned int *)&v22, 4u, 116, (uint64_t)"phLibNfc_SM_Main_InitTransComplete");
              v12 = v22;
LABEL_11:
              v8(v12, v9, a3);
            }
          }
          else
          {
LABEL_18:
            sub_219850628(0, (unsigned int *)&v22, 4u, 1u, (uint64_t)"Complete function invoked Without Transition Event");
          }
        }
        else
        {
          sub_2198D782C(v21, a3);
        }
        break;
    }
  }
  sub_219850808(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_InitTransComplete");
  return a3;
}

uint64_t sub_2198A2F08(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t *a5)
{
  uint64_t v8;
  uint64_t v9;
  int v10;
  char v11;
  uint64_t *v12;
  uint64_t v13;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlLoopbackTrans");
  sub_21988EDF4(v16, &v15);
  if (a4 && a5 && (v8 = *a5) != 0 && *(_QWORD *)a4 && (v9 = v15) != 0)
  {
    if (*(_BYTE *)(v15 + 19336) == 1)
    {
      v10 = *(_DWORD *)(a4 + 8);
      if (v10 == *((_DWORD *)a5 + 2))
      {
        *(_QWORD *)(v15 + 2728) = *(_QWORD *)a4;
        *(_DWORD *)(v9 + 2736) = (unsigned __int16)v10;
        *(_QWORD *)(v9 + 2744) = v8;
        *(_DWORD *)(v9 + 2752) = (unsigned __int16)v10;
        if (!(_DWORD)a3)
        {
          *(_WORD *)(v9 + 2718) = 2000;
          *(_QWORD *)(v9 + 2912) = gphLibNfc_IoctlLoopbackSequence;
          *(_BYTE *)(v9 + 2904) = 0;
          *(_BYTE *)(v9 + 2906) = 0;
          v11 = (char)gphLibNfc_IoctlLoopbackSequence[0];
          if (gphLibNfc_IoctlLoopbackSequence[0])
          {
            v11 = 0;
            v12 = &qword_2550A0AA8;
            do
            {
              ++v11;
              v13 = *v12;
              v12 += 2;
            }
            while (v13);
          }
          *(_BYTE *)(v9 + 2905) = v11;
          a3 = sub_2198655FC(v9, 0, 0);
        }
      }
      else
      {
        a3 = 3;
      }
    }
    else
    {
      a3 = 58;
    }
  }
  else
  {
    a3 = 1;
    sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)"IoctlLoopbackTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlLoopbackTrans");
  return a3;
}

uint64_t sub_2198A3060(uint64_t a1)
{
  uint64_t v1;
  uint64_t v3;
  uint64_t v4;

  v3 = 0;
  v4 = a1;
  sub_219850718(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSwp1TestTrans");
  sub_21988EDF4(v4, &v3);
  if (v3)
  {
    v1 = sub_2198FF1EC(*(_QWORD *)(v3 + 3040), 0, (uint64_t)sub_21986C2BC, v3);
  }
  else
  {
    v1 = 1;
    sub_219850628(0, (unsigned int *)&v4, 4u, 1u, (uint64_t)"IoctlSwp1TestTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSwp1TestTrans");
  return v1;
}

uint64_t sub_2198A3110(uint64_t a1)
{
  uint64_t v1;
  uint64_t v3;
  uint64_t v4;

  v3 = 0;
  v4 = a1;
  sub_219850718(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSwp2TestTrans");
  sub_21988EDF4(v4, &v3);
  if (v3)
  {
    v1 = sub_2198FF1EC(*(_QWORD *)(v3 + 3040), 1, (uint64_t)sub_21986C2BC, v3);
  }
  else
  {
    v1 = 1;
    sub_219850628(0, (unsigned int *)&v4, 4u, 1u, (uint64_t)"IoctlSwp2TestTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlSwp2TestTrans");
  return v1;
}

uint64_t sub_2198A31C0(uint64_t a1, uint64_t a2, uint64_t a3, unsigned __int8 **a4)
{
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlPrbsTestTrans");
  sub_21988EDF4(v8, &v7);
  if (a4 && v7)
  {
    v5 = sub_2198FF310(*(_QWORD *)(v7 + 3040), **a4, (*a4)[1], bswap32(*((unsigned __int16 *)*a4 + 1)) >> 16, (uint64_t)sub_21986C390, v7);
  }
  else
  {
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v8, 4u, 1u, (uint64_t)"IoctlPrbsTestTrans: Failed");
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlPrbsTestTrans");
  return v5;
}

uint64_t sub_2198A328C(uint64_t a1, uint64_t a2, uint64_t a3, _DWORD *a4)
{
  uint64_t v5;
  uint64_t v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  int v10;
  int v11;
  uint64_t v12;
  uint64_t v13;
  char v14;
  uint64_t v15;
  uint64_t v16;
  uint64_t v18;
  uint64_t v19;

  v18 = 0;
  v19 = a1;
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_CfgTestModeOffTrans");
  sub_21988EDF4(v19, &v18);
  v5 = 1;
  if (a4)
  {
    v6 = v18;
    if (v18)
    {
      *(_DWORD *)(v18 + 19328) = *a4;
      *(_QWORD *)(v6 + 2912) = off_2550A3D88;
      *(_BYTE *)(v6 + 2904) = 0;
      *(_BYTE *)(v6 + 2906) = 0;
      v7 = (char)off_2550A3D88[0];
      if (off_2550A3D88[0])
      {
        v7 = 0;
        v8 = off_2550A3D98;
        do
        {
          ++v7;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
      *(_BYTE *)(v6 + 2905) = v7;
      if (*(_BYTE *)(v6 + 19336) != 1)
      {
        sub_21986607C(v6, (uint64_t)off_2550A3D88, 1);
        v6 = v18;
      }
      v10 = sub_2198655FC(v6, 0, 0);
      if (v10 == 13)
      {
        v5 = 13;
      }
      else
      {
        v11 = v10;
        v12 = v18;
        v13 = *(_QWORD *)(v18 + 3040);
        if (v13)
        {
          v14 = 0;
          v15 = 0;
          do
          {
            v16 = *((_QWORD *)&unk_253E46700 + 14 * v15 + 4);
            if ((v14 & 1) != 0)
              break;
            v14 = 1;
            v15 = 1;
          }
          while (v16 != v13);
          if (v16 == v13)
          {
            sub_2198FF49C(*(unsigned int **)(v18 + 3040), 2, 0, 0);
            v12 = v18;
          }
        }
        *(_QWORD *)(v12 + 3040) = 0;
        sub_2198EEC3C(v12);
        v18 = 0;
        if (v11 == 143)
          v5 = 143;
        else
          v5 = 255;
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_CfgTestModeOffTrans");
  return v5;
}

uint64_t sub_2198A3404(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  char v8;
  void (*v10)(uint64_t, uint64_t, uint64_t);
  uint64_t v11;
  unsigned int *v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  char v19;
  uint64_t v20;
  uint64_t v21;
  void (*v22)(_QWORD, uint64_t, uint64_t, uint64_t);
  uint64_t v23;
  uint64_t *v24;
  uint64_t v25;
  uint64_t v26;

  v25 = 0;
  v26 = a1;
  v24 = 0;
  sub_219850718(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_TestModeTransComplete");
  sub_21988EDF4(v26, &v25);
  sub_21988EB80(v26, &v24);
  if ((_DWORD)a3)
    sub_219886108(v26, a3);
  else
    sub_21988620C(v26, 0);
  v7 = v25;
  if (v25)
  {
    if (a2 <= 88)
    {
      switch(a2)
      {
        case '%':
          v10 = *(void (**)(uint64_t, uint64_t, uint64_t))(v25 + 6136);
          v17 = *(_QWORD *)(v25 + 6144);
          *(_QWORD *)(v25 + 6144) = 0;
          *(_QWORD *)(v7 + 6136) = 0;
          v18 = *(_QWORD *)(v7 + 3040);
          if (v18)
          {
            v19 = 0;
            v20 = 0;
            do
            {
              v21 = *((_QWORD *)&unk_253E46700 + 14 * v20 + 4);
              if ((v19 & 1) != 0)
                break;
              v19 = 1;
              v20 = 1;
            }
            while (v21 != v18);
            if (v21 == v18)
            {
              sub_2198FF49C(*(unsigned int **)(v7 + 3040), 2, 0, 0);
              v7 = v25;
            }
          }
          *(_QWORD *)(v7 + 3040) = 0;
          sub_2198EEC3C(v7);
          v25 = 0;
          if (v10)
          {
            sub_219850628(0, (unsigned int *)&v26, 4u, 4u, (uint64_t)"ConfigTestModeCb:Invoking callback function, with status NFCSTATUS_SUCCESS");
            sub_219885F70(0, (unsigned int *)&v26, 4u, 35, (uint64_t)"phLibNfc_SM_Main_TestModeTransComplete");
            v14 = v26;
            v15 = v17;
            v16 = 0;
            goto LABEL_28;
          }
          break;
        case 'D':
          v22 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t))(v25 + 6808);
          v23 = *(_QWORD *)(v25 + 6816);
          *(_OWORD *)(v25 + 6808) = 0u;
          if (v22)
          {
            sub_219851790(0, (unsigned int *)&v26, 4u, 4u, (uint64_t)"phLibNfc_SM_eAntennaSelfTest:Invoking callback, wStatus = ");
            sub_219885F70(1, (unsigned int *)(v25 + 19368), 4u, 44, (uint64_t)"phLibNfc_SM_Main_TestModeTransComplete");
            v22(*(_QWORD *)(v25 + 19360), v23, v25 + 5996, a3);
          }
          break;
        case 'J':
          v10 = *(void (**)(uint64_t, uint64_t, uint64_t))(v25 + 6648);
          v11 = *(_QWORD *)(v25 + 6656);
          *(_OWORD *)(v25 + 6648) = 0u;
          if (v10)
          {
            sub_219851790(0, (unsigned int *)&v26, 4u, 4u, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf:Invoking callback, wStatus = ");
            v12 = (unsigned int *)(v25 + 19368);
            v13 = 50;
LABEL_19:
            sub_219885F70(1, v12, 4u, v13, (uint64_t)"phLibNfc_SM_Main_TestModeTransComplete");
            v14 = v26;
            v15 = v11;
            v16 = a3;
LABEL_28:
            v10(v14, v15, v16);
          }
          break;
      }
    }
    else
    {
      v8 = a2 - 89;
      if ((a2 - 89) <= 0x22)
      {
        if (((1 << v8) & 0x5E0600000) != 0 || ((1 << v8) & 0xE0800) != 0)
        {
          sub_21986C460(v24, a4, a3);
          goto LABEL_10;
        }
        if (((1 << v8) & 0x81) != 0)
        {
          v10 = *(void (**)(uint64_t, uint64_t, uint64_t))(v25 + 6792);
          v11 = *(_QWORD *)(v25 + 6800);
          *(_OWORD *)(v25 + 6792) = 0u;
          if (v10)
          {
            sub_219851790(0, (unsigned int *)&v26, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
            v12 = (unsigned int *)(v25 + 19368);
            v13 = 132;
            goto LABEL_19;
          }
        }
      }
    }
  }
LABEL_10:
  sub_219850808(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_TestModeTransComplete");
  return a3;
}

uint64_t sub_2198A3758(uint64_t a1, int a2, uint64_t a3, int *a4, uint64_t a5)
{
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigReDiscoveryTrans");
  sub_21988EDF4(v12, &v11);
  v9 = sub_2198D9B9C(v11, a2, a3, a4, a5);
  if (!(_DWORD)v9)
    v9 = sub_2198D9588(v11, a4, a5);
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigReDiscoveryTrans");
  return v9;
}

uint64_t sub_2198A3810(uint64_t a1, int a2, uint64_t a3, int *a4, uint64_t a5)
{
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigDiscoveryStopTrans");
  sub_21988EDF4(v12, &v11);
  v9 = sub_2198D9B9C(v11, a2, a3, a4, a5);
  if (!(_DWORD)v9)
    v9 = sub_2198D9698(v11, a4, a5);
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_ConfigDiscoveryStopTrans");
  return v9;
}

uint64_t sub_2198A38C8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _DWORD *v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_PiccActivatedTrans");
  sub_21988EDF4(v8, &v7);
  if (v7 && *(_QWORD *)(v7 + 6232))
  {
    v4 = *(_DWORD **)(v7 + 808);
    if (v4 && *v4 >= 2u && *(_BYTE *)(v7 + 1422) == 1)
    {
      sub_219853E34(0, (unsigned int *)&v8, 4u, 4u, (uint64_t)"PiccActivatedTrans :RemDevNtfCB[Unknown Tag Protocol]");
      v5 = v7;
      *(_BYTE *)(v7 + 714) = 0;
      a3 = 119;
      (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD, uint64_t))(v5 + 6232))(*(_QWORD *)(v5 + 19360), *(_QWORD *)(v5 + 6240), v5 + 824, 0, 119);
    }
    else
    {
      *(_BYTE *)(v7 + 1423) = 0;
      sub_219853E34(0, (unsigned int *)&v8, 4u, 4u, (uint64_t)"PiccActivatedTrans :Received ACTD NTF");
      if (!sub_2198D8828(v7))
      {
        if ((_DWORD)a3 == 188 || (_DWORD)a3 == 186)
        {
          (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD, uint64_t))(v7 + 6232))(*(_QWORD *)(v7 + 19360), *(_QWORD *)(v7 + 6240), v7 + 824, 0, a3);
          a3 = 0;
        }
        else
        {
          (*(void (**)(_QWORD, _QWORD, uint64_t, _QWORD, _QWORD))(v7 + 6232))(*(_QWORD *)(v7 + 19360), *(_QWORD *)(v7 + 6240), v7 + 824, *(unsigned __int8 *)(v7 + 714), a3);
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_PiccActivatedTrans");
  return a3;
}

uint64_t sub_2198A3A3C(uint64_t a1)
{
  uint64_t v1;
  uint64_t v3;
  uint64_t v4;

  v3 = 0;
  v4 = a1;
  sub_219850718(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_PcdActivatedTrans");
  sub_21988EDF4(v4, &v3);
  if (v3)
    v1 = sub_2198D8828(v3);
  else
    v1 = 1;
  sub_219850808(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_PcdActivatedTrans");
  return v1;
}

uint64_t sub_2198A3ACC()
{
  return 0;
}

uint64_t sub_2198A3AD4(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, uint64_t);
  uint64_t v9;
  unsigned int *v10;
  uint64_t v11;
  uint64_t *v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  v13 = 0;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_DiscTransComplete");
  sub_21988EDF4(v15, &v14);
  sub_21988EB80(v15, &v13);
  if ((_DWORD)a3)
    sub_219886108(v15, a3);
  else
    sub_21988620C(v15, 0);
  v7 = v14;
  if (v14)
  {
    if (a2 > 122)
    {
      if ((a2 - 136) < 2)
      {
        *(_WORD *)(v14 + 19354) = 0;
LABEL_18:
        sub_2198D782C(v7, a3);
      }
      else if (a2 == 123 || a2 == 126)
      {
LABEL_11:
        sub_21986C460(v13, a4, a3);
      }
    }
    else
    {
      switch(a2)
      {
        case 'M':
        case 'N':
        case 'O':
        case 'P':
        case 'Q':
        case 'R':
        case 'S':
        case 'T':
        case 'U':
        case 'V':
        case 'W':
          sub_2198EF748(v14, a4, a3);
          break;
        case 'X':
        case 'Z':
        case '[':
        case '\\':
        case ']':
        case '_':
        case 'a':
        case 'b':
        case 'c':
        case 'd':
        case 'e':
        case 'f':
        case 'g':
        case 'h':
        case 'i':
        case 'j':
        case 'k':
        case 'l':
        case 'm':
        case 'n':
          break;
        case 'Y':
        case '^':
          v8 = *(void (**)(_QWORD, uint64_t, uint64_t))(v14 + 6792);
          v9 = *(_QWORD *)(v14 + 6800);
          *(_OWORD *)(v14 + 6792) = 0u;
          if (!v8)
            break;
          sub_219851790(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
          v10 = (unsigned int *)(v14 + 19368);
          v11 = 132;
          goto LABEL_21;
        case 'o':
          goto LABEL_11;
        default:
          if (a2 == 7)
          {
            v8 = *(void (**)(_QWORD, uint64_t, uint64_t))(v14 + 6632);
            v9 = *(_QWORD *)(v14 + 6640);
            *(_OWORD *)(v14 + 6632) = 0u;
            if (v8)
            {
              sub_219851790(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"Power mode Config: Invoking callback function, wStatus = ");
              v10 = (unsigned int *)(v14 + 19368);
              v11 = 5;
LABEL_21:
              sub_219885F70(1, v10, 4u, v11, (uint64_t)"phLibNfc_SM_Main_DiscTransComplete");
              v8(*(_QWORD *)(v14 + 19360), v9, a3);
            }
          }
          else if (a2 == 24)
          {
            goto LABEL_18;
          }
          break;
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_DiscTransComplete");
  return a3;
}

uint64_t sub_2198A3CF8(uint64_t a1, int a2, uint64_t a3, _DWORD *a4, uint64_t a5)
{
  uint64_t v9;
  _BYTE *v10;
  char v11;
  uint64_t *v12;
  uint64_t v13;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_EMVCoTagRemDetTrans");
  sub_21988EDF4(v16, &v15);
  if (v15)
  {
    v9 = sub_2198D9B9C(v15, a2, a3, a4, a5);
    if (!(_DWORD)v9)
    {
      v10 = (_BYTE *)v15;
      *(_QWORD *)(v15 + 2912) = off_2550A34D8;
      v10[2904] = 0;
      v10[2906] = 0;
      v11 = (char)off_2550A34D8[0];
      if (off_2550A34D8[0])
      {
        v11 = 0;
        v12 = &qword_2550A34E8;
        do
        {
          ++v11;
          v13 = *v12;
          v12 += 2;
        }
        while (v13);
      }
      v10[2905] = v11;
      v9 = sub_2198655FC((uint64_t)v10, 0, 0);
    }
  }
  else
  {
    v9 = 255;
  }
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_EMVCoTagRemDetTrans");
  return v9;
}

uint64_t sub_2198A3DF0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  const char *v5;
  uint64_t v6;
  char *v8;
  int v10;
  uint64_t v11;
  char *v12;
  unsigned int *v13;
  uint64_t v14;
  uint64_t v15;
  char *v16;
  int v17;
  unsigned int *v18;
  uint64_t v19;

  v19 = a1;
  v18 = 0;
  v17 = 1;
  v15 = 0;
  v16 = 0;
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_ConnectTrans");
  sub_21988EDF4(v19, &v18);
  if (v18)
  {
    v15 = a4;
    if (sub_2198BE4E4((uint64_t)v18, &v15, &v16, 1))
    {
      v5 = "Mapping of LibNfc RemoteDev Handle to NCI RemoteDev Handle Failed";
LABEL_7:
      sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)v5);
      v6 = 149;
      goto LABEL_8;
    }
    if (sub_21987B7E4(v18, (uint64_t)v16))
    {
      v5 = "Validation of NCI RemoteDev Handle Failed";
      goto LABEL_7;
    }
    v8 = (char *)*((_QWORD *)v18 + 182);
    if (v16 != v8 && v8 != 0)
    {
      sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)"Connected Handle is not same as passed handle");
      v6 = 255;
      goto LABEL_8;
    }
    if (v16 == v8 && *((char **)v18 + 183) == v16 && *((_BYTE *)v18 + 1422) != 1)
    {
      v14 = sub_2198BE5D8((uint64_t)v18, v15, v16);
      goto LABEL_36;
    }
    if (!v16)
    {
LABEL_27:
      v11 = sub_2198D89F4((uint64_t)v16, (_BYTE *)v18 + 712, (_BYTE *)v18 + 713);
      v6 = v11;
      v12 = v16;
      v13 = v18;
      *((_QWORD *)v18 + 182) = v16;
      if (!v12 || (_DWORD)v11)
      {
        if ((_DWORD)v11)
          goto LABEL_8;
      }
      else if ((!*((_DWORD *)v12 + 4) && *((_DWORD *)v12 + 3) == 1 || *((_BYTE *)v13 + 1423) == 1)
             && *((_BYTE *)v13 + 1422) == 1)
      {
        sub_2198BF078((uint64_t)v13, 0, v12);
        v6 = 0;
        goto LABEL_8;
      }
      v14 = sub_2198BE740(v15, (uint64_t)v12, &v17, (uint64_t)v13);
LABEL_36:
      v6 = v14;
      goto LABEL_8;
    }
    v10 = *((_DWORD *)v16 + 4);
    if (v10 > 127)
    {
      if (v10 == 128 || v10 == 129)
        goto LABEL_26;
    }
    else
    {
      if (v10 == 4)
      {
        v10 = 2;
        goto LABEL_26;
      }
      if (v10 == 5)
      {
        v10 = 3;
LABEL_26:
        v17 = v10;
        goto LABEL_27;
      }
    }
    v10 = 1;
    goto LABEL_26;
  }
  v6 = 1;
  sub_219850628(0, (unsigned int *)&v19, 4u, 1u, (uint64_t)"phLibNfc_SM_ConnectTrans: Invalid Param");
LABEL_8:
  sub_219850808(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_ConnectTrans");
  return v6;
}

uint64_t sub_2198A4028(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, _BYTE *a5)
{
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_DeactivateNtfTrans");
  sub_21988EDF4(v10, &v9);
  v7 = v9;
  if (a5 && v9 && *(_QWORD *)(v9 + 6232) && !*a5)
  {
    sub_219850628(0, (unsigned int *)&v10, 4u, 4u, (uint64_t)"Invoking pClientNtfRegRespCB with rf deactivated status");
    sub_219853E34(0, (unsigned int *)&v10, 4u, 4u, (uint64_t)"DeactivateNtfTrans :RemDevNtfCB[De-Activate Ntf]");
    (*(void (**)(_QWORD, _QWORD, _QWORD, _QWORD, uint64_t))(v9 + 6232))(*(_QWORD *)(v9 + 19360), *(_QWORD *)(v9 + 6240), 0, 0, a3);
    v7 = v9;
  }
  sub_2198C0850(v7);
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_DeactivateNtfTrans");
  return 0;
}

uint64_t sub_2198A4118(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, uint64_t);
  uint64_t v9;
  void (*v10)(_QWORD, uint64_t, uint64_t, uint64_t, uint64_t);
  uint64_t v11;
  uint64_t *v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  v13 = 0;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_PollDiscoveredTransComplete");
  sub_21988EDF4(v15, &v14);
  sub_21988EB80(v15, &v13);
  if ((_DWORD)a3)
    sub_219886108(v15, a3);
  else
    sub_21988620C(v15, 0);
  v7 = v14;
  if (v14)
  {
    if (a2 <= 122)
    {
      switch(a2)
      {
        case 'M':
        case 'N':
        case 'O':
        case 'P':
        case 'Q':
        case 'R':
        case 'S':
        case 'T':
        case 'U':
        case 'V':
        case 'W':
          sub_2198EF748(v14, a4, a3);
          goto LABEL_20;
        case 'X':
        case 'Z':
        case '[':
        case '\\':
        case ']':
        case '_':
        case 'a':
        case 'b':
        case 'c':
        case 'd':
        case 'e':
        case 'f':
        case 'g':
        case 'h':
        case 'i':
        case 'j':
        case 'k':
        case 'l':
        case 'm':
        case 'n':
          goto LABEL_20;
        case 'Y':
        case '^':
          v8 = *(void (**)(_QWORD, uint64_t, uint64_t))(v14 + 6792);
          v9 = *(_QWORD *)(v14 + 6800);
          *(_OWORD *)(v14 + 6792) = 0u;
          if (v8)
          {
            sub_219851790(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
            sub_219885F70(1, (unsigned int *)(v14 + 19368), 4u, 132, (uint64_t)"phLibNfc_SM_Main_PollDiscoveredTransComplete");
            v8(*(_QWORD *)(v14 + 19360), v9, a3);
          }
          goto LABEL_20;
        case 'o':
          goto LABEL_11;
        default:
          if (a2 == 17)
          {
            v10 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t, uint64_t))(v14 + 6152);
            v11 = *(_QWORD *)(v14 + 6160);
            *(_QWORD *)(v14 + 6160) = 0;
            *(_QWORD *)(v7 + 6152) = 0;
            if (v10 && *(_BYTE *)(v7 + 1423) != 1)
            {
              sub_219850628(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"Invoking upper layer callback");
              sub_219885F70(1, (unsigned int *)(v14 + 19368), 4u, 15, (uint64_t)"phLibNfc_SM_Main_PollDiscoveredTransComplete");
              v10(*(_QWORD *)(v14 + 19360), v11, a4, a4, a3);
            }
            goto LABEL_20;
          }
          if (a2 != 46)
            goto LABEL_20;
          break;
      }
      goto LABEL_14;
    }
    if ((a2 - 136) < 2)
    {
LABEL_14:
      sub_2198D782C(v14, a3);
      goto LABEL_20;
    }
    if (a2 == 123 || a2 == 126)
LABEL_11:
      sub_21986C460(v13, a4, a3);
  }
LABEL_20:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_PollDiscoveredTransComplete");
  return a3;
}

uint64_t sub_2198A4358(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  uint64_t v8;
  int v9;
  uint64_t v11;
  char v12;
  uint64_t (**v13)();
  uint64_t (*v14)();
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;

  v18 = 0;
  v19 = a1;
  v16 = 0;
  v17 = 0;
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_GetTagTypeTrans");
  sub_21988EDF4(v19, &v18);
  v7 = 1;
  if (a5)
  {
    if (a4)
    {
      v8 = v18;
      if (v18)
      {
        *(_QWORD *)(v18 + 2768) = a5;
        *(_QWORD *)(v8 + 2776) = *(_QWORD *)(a5 + 8);
        v16 = a4;
        v7 = sub_2198BE4E4(v8, &v16, &v17, 1);
        if (!(_DWORD)v7)
        {
          v7 = sub_219879D44(v18, v17);
          if (!(_DWORD)v7)
          {
            v9 = *(_DWORD *)(v16 + 4);
            if (v9 == 16 || v9 == 11)
            {
              v11 = v18;
              **(_DWORD **)(v18 + 2768) = v9;
              *(_QWORD *)(v11 + 2912) = off_2550A2C08;
              *(_BYTE *)(v11 + 2904) = 0;
              *(_BYTE *)(v11 + 2906) = 0;
              v12 = (char)off_2550A2C08[0];
              if (off_2550A2C08[0])
              {
                v12 = 0;
                v13 = off_2550A2C18;
                do
                {
                  ++v12;
                  v14 = *v13;
                  v13 += 2;
                }
                while (v14);
              }
              *(_BYTE *)(v11 + 2905) = v12;
              v7 = sub_2198655FC(v11, 0, 0);
            }
            else
            {
              v7 = 51;
            }
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_GetTagTypeTrans");
  return v7;
}

uint64_t sub_2198A4490(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  v9 = 0;
  v10 = 0;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevTransceiveTrans");
  sub_21988EDF4(v12, &v11);
  v7 = 1;
  if (a5)
  {
    if (a4)
    {
      if (v11)
      {
        v9 = a4;
        v7 = sub_2198BE4E4(v11, &v9, &v10, 1);
        if (!(_DWORD)v7)
        {
          v7 = sub_219879D44(v11, v10);
          if (!(_DWORD)v7)
            v7 = sub_2198915DC(v11, a5);
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevTransceiveTrans");
  return v7;
}

uint64_t sub_2198A4564(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int *a4, uint64_t a5)
{
  uint64_t v9;
  unsigned int *v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_DisConnectStopTrans");
  sub_21988EDF4(v12, &v11);
  if (v11)
  {
    v9 = sub_2198DB590(v11, a2, a3, a4, a5);
    if (!(_DWORD)v9)
      v9 = sub_2198D9698((uint64_t)v11, (int *)a4, a5);
  }
  else
  {
    v9 = 255;
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_DisConnectStopTrans");
  return v9;
}

uint64_t sub_2198A4628(uint64_t a1, uint64_t a2, uint64_t a3, unsigned int *a4, uint64_t a5)
{
  uint64_t v9;
  unsigned int *v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_DisConnectReStartTrans");
  sub_21988EDF4(v12, &v11);
  if (v11)
  {
    v9 = sub_2198DB590(v11, a2, a3, a4, a5);
    if (!(_DWORD)v9)
      v9 = sub_2198D9588((uint64_t)v11, (int *)a4, a5);
  }
  else
  {
    v9 = 255;
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_DisConnectReStartTrans");
  return v9;
}

uint64_t sub_2198A46EC(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t *v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_DisConnectSleepTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    *(_QWORD *)(v7 + 2912) = &qword_2550A33B8;
    v1[2904] = 0;
    v1[2906] = 0;
    v2 = qword_2550A33B8;
    if (qword_2550A33B8)
    {
      v2 = 0;
      v3 = &qword_2550A33C8;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    v1[2905] = v2;
    v5 = sub_2198655FC((uint64_t)v1, 0, 0);
  }
  else
  {
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_DisConnectSleepTrans");
  return v5;
}

uint64_t sub_2198A47B0(uint64_t a1, int a2)
{
  _BYTE *v3;
  char v4;
  uint64_t *v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t *v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_DisConnectTagRemDetTrans");
  sub_21988EDF4(v12, &v11);
  v3 = (_BYTE *)v11;
  if (v11)
  {
    if (a2 == 24)
    {
      *(_QWORD *)(v11 + 2912) = off_2550A34D8;
      v3[2904] = 0;
      v3[2906] = 0;
      v4 = (char)off_2550A34D8[0];
      if (off_2550A34D8[0])
      {
        v4 = 0;
        v5 = &qword_2550A34E8;
        do
        {
          ++v4;
          v6 = *v5;
          v5 += 2;
        }
        while (v6);
      }
    }
    else
    {
      *(_QWORD *)(v11 + 2912) = &qword_2550A34B8;
      v3[2904] = 0;
      v3[2906] = 0;
      v4 = qword_2550A34B8;
      if (qword_2550A34B8)
      {
        v4 = 0;
        v8 = &qword_2550A34C8;
        do
        {
          ++v4;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
    }
    v3[2905] = v4;
    v7 = sub_2198655FC((uint64_t)v3, 0, 0);
  }
  else
  {
    v7 = 255;
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_DisConnectTagRemDetTrans");
  return v7;
}

uint64_t sub_2198A48B8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_CheckPresenceTrans");
  sub_21988EDF4(v8, &v7);
  v5 = 1;
  if (a4 && v7)
    v5 = sub_2198C0DF0(v7, a4);
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_CheckPresenceTrans");
  return v5;
}

uint64_t sub_2198A4948(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  int v6;
  uint64_t v7;
  int v9;
  int v10;
  int v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  v12 = 0;
  v13 = a4;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_CheckNdefTrans");
  sub_21988EDF4(v15, &v14);
  v5 = 149;
  if (a4)
  {
    if (v14)
    {
      v5 = sub_2198BE4E4(v14, &v13, &v12, 1);
      if (!(_DWORD)v5)
      {
        if (v12)
        {
          if (sub_219879D44(v14, v12))
          {
            v5 = 149;
            goto LABEL_12;
          }
          v5 = sub_2198883B8(v15, v13);
          if (!(_DWORD)v5)
          {
            v5 = sub_2198884B8(v15, *(_BYTE *)(v14 + 2885));
            if (!(_DWORD)v5)
            {
              v6 = *(_DWORD *)(v13 + 4);
              switch(v6)
              {
                case 10:
                case 11:
                case 13:
                case 14:
                case 15:
                case 17:
                case 19:
                  v7 = sub_21985F594(v15, (uint64_t)sub_2198BC5C4, v14);
                  goto LABEL_11;
                case 12:
                case 16:
                  v9 = *(unsigned __int8 *)(v13 + 68);
                  v10 = v9 & 0x18;
                  if (((1 << v9) & 0x3000300) == 0)
                    v10 = *(unsigned __int8 *)(v13 + 68);
                  if (v9 <= 0x19)
                    v9 = v10;
                  if (v9 <= 7)
                  {
                    if (!v9)
                      goto LABEL_31;
                    if (v9 == 1)
                      goto LABEL_21;
                  }
                  else if (v9 == 8 || v9 == 24 || v9 == 136)
                  {
LABEL_21:
                    v5 = sub_2198C849C(v15);
                    if ((_DWORD)v5)
                      break;
                    v7 = sub_2198C8538(v15, (uint64_t)sub_2198BC5C4, v14);
LABEL_11:
                    v5 = v7;
                    break;
                  }
                  if (v6 != 12)
                  {
                    v5 = 0;
                    break;
                  }
LABEL_31:
                  v7 = sub_2198C30FC(v15, (uint64_t)sub_2198BC5C4, v14);
                  goto LABEL_11;
                case 21:
                  v7 = sub_2198B31F8(v15, (uint64_t)sub_2198BC5C4, v14);
                  goto LABEL_11;
                case 22:
                  v11 = *(unsigned __int8 *)(v13 + 19);
                  if ((v11 & 0xF0) != 0x10)
                  {
                    v5 = 255;
                    break;
                  }
                  if (v11 == 17)
                    v7 = sub_2198D2D64(v15, (uint64_t)sub_2198BC5C4, v14);
                  else
                    v7 = sub_2199026DC(v15, (uint64_t)sub_2198BC5C4, v14);
                  goto LABEL_11;
                case 23:
                  v7 = sub_219887770(v15, (uint64_t)sub_2198BC5C4, v14);
                  goto LABEL_11;
                default:
                  break;
              }
            }
          }
        }
      }
    }
  }
LABEL_12:
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_CheckNdefTrans");
  return v5;
}

uint64_t sub_2198A4B60(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  unsigned int *v8;
  int v9;
  uint64_t v10;
  unsigned int *v11;
  int v12;
  uint64_t v13;
  int v15;
  uint64_t v16;
  unsigned int v17;
  _DWORD *v18;
  uint64_t v19;
  uint64_t v20;
  unsigned int *v21;
  uint64_t v22;

  v21 = 0;
  v22 = a1;
  v19 = 0;
  v20 = a4;
  sub_219850718(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_SM_ReadNdefTrans");
  sub_21988EDF4(v22, &v21);
  v7 = 1;
  if (a5)
  {
    if (a4)
    {
      v8 = v21;
      if (v21)
      {
        if (!*((_QWORD *)v21 + 182))
        {
          v7 = 148;
          goto LABEL_23;
        }
        v9 = *((unsigned __int8 *)v21 + 6872);
        if (v9 == 2)
        {
          v7 = 147;
          goto LABEL_23;
        }
        if (v9 == 1)
        {
          if (!v21[1707])
          {
            v10 = *((_QWORD *)v21 + 855);
            if (v10 && *(_BYTE *)(v10 + 242) == 1 || !sub_21987AC20(v21, a4))
            {
              v7 = 0;
              *(_DWORD *)(a5 + 8) = 0;
              goto LABEL_23;
            }
            v8 = v21;
          }
        }
        else if (!*((_BYTE *)v21 + 6872))
        {
          v7 = 152;
          goto LABEL_23;
        }
        v7 = sub_2198BE4E4((uint64_t)v8, &v20, &v19, 1);
        if (!(_DWORD)v7)
        {
          if (v19)
          {
            v7 = sub_219879D44((uint64_t)v21, v19);
            if (!(_DWORD)v7)
            {
              v11 = v21;
              **((_BYTE **)v21 + 104) = 1;
              v11[1722] = 1;
              *((_QWORD *)v11 + 857) = a5;
              v12 = *(_DWORD *)(v20 + 4);
              switch(v12)
              {
                case 10:
                case 11:
                case 13:
                case 14:
                case 15:
                case 17:
                case 19:
                  v13 = sub_21985E858(v22, *(_QWORD *)a5, (_DWORD *)(a5 + 8), *((unsigned __int8 *)v11 + 6824), (uint64_t)sub_2198BC788, (uint64_t)v11);
                  goto LABEL_21;
                case 12:
                case 16:
                  v15 = *(unsigned __int8 *)(v20 + 68);
                  if (v15 <= 0x19 && ((1 << v15) & 0x3000300) != 0)
                    v15 &= 0x18u;
                  if (v15 <= 7)
                  {
                    if (!v15)
                    {
LABEL_39:
                      v13 = sub_2198C2154(v22, *(_QWORD *)a5, (int *)(a5 + 8), *((unsigned __int8 *)v11 + 6824), (uint64_t)sub_2198BC788, (uint64_t)v11);
                      goto LABEL_21;
                    }
                    if (v15 == 1)
                    {
LABEL_31:
                      v13 = sub_2198C8C34(v22, *(_QWORD *)a5, (_DWORD *)(a5 + 8), *((unsigned __int8 *)v11 + 6824), (uint64_t)sub_2198BC788, (uint64_t)v11);
LABEL_21:
                      v7 = v13;
                      break;
                    }
                  }
                  else if (v15 == 8 || v15 == 24 || v15 == 136)
                  {
                    goto LABEL_31;
                  }
                  if (v12 != 12)
                  {
                    v7 = 0;
                    break;
                  }
                  goto LABEL_39;
                case 21:
                  v13 = sub_2198B0EE0(v22, *(_QWORD *)a5, (unsigned int *)(a5 + 8), *((unsigned __int8 *)v11 + 6824), (uint64_t)sub_2198BC788, (uint64_t)v11);
                  goto LABEL_21;
                case 22:
                  v16 = *(_QWORD *)a5;
                  v17 = *((unsigned __int8 *)v11 + 6824);
                  v18 = (_DWORD *)(a5 + 8);
                  if (*(_BYTE *)(v20 + 19) == 17)
                    v13 = sub_2198D31A4(v22, v16, v18, v17, (uint64_t)sub_2198BC788, (uint64_t)v11);
                  else
                    v13 = sub_219902968(v22, v16, v18, v17, (uint64_t)sub_2198BC788, (uint64_t)v11);
                  goto LABEL_21;
                case 23:
                  v13 = sub_219887864(v22, *(_QWORD *)a5, (_DWORD *)(a5 + 8), *((unsigned __int8 *)v11 + 6824), (uint64_t)sub_2198BC788, (uint64_t)v11);
                  goto LABEL_21;
                default:
                  break;
              }
            }
          }
        }
      }
    }
  }
LABEL_23:
  sub_219850808(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_SM_ReadNdefTrans");
  return v7;
}

uint64_t sub_2198A4E24(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  uint64_t v8;
  int v9;
  int v10;
  unsigned int *v11;
  uint64_t v12;
  int v14;
  char *v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;
  uint64_t v20;

  v19 = 0;
  v20 = a1;
  v17 = a4;
  v18 = 0;
  v16 = 0;
  sub_219850718(0, (unsigned int *)&v20, 4u, 5u, (uint64_t)"phLibNfc_SM_WriteNdefTrans");
  sub_21988EDF4(v20, &v19);
  sub_21988EF68(v20, &v18);
  v7 = 1;
  if (a5 && a4 && v19)
  {
    if (!*(_QWORD *)(v19 + 1456))
    {
      v7 = 148;
      goto LABEL_24;
    }
    if (*(_BYTE *)(v19 + 6872) == 2)
    {
      v7 = 147;
      goto LABEL_24;
    }
    if (!*(_BYTE *)(v19 + 6872))
    {
      v7 = 152;
      goto LABEL_24;
    }
    if (v18 && (*(unsigned __int8 *)(v18 + 545) | 2) == 3)
    {
      v7 = 58;
      goto LABEL_24;
    }
    if (*(_DWORD *)(a5 + 8) > *(_DWORD *)(v19 + 6868))
    {
      v7 = 31;
      goto LABEL_24;
    }
    v7 = 255;
    if (!sub_2198BE4E4(v19, &v17, &v16, 1))
    {
      if (v16)
      {
        if (v18)
        {
          v7 = sub_219879D44(v19, v16);
          if (!(_DWORD)v7)
          {
            v8 = v19;
            *(_QWORD *)(v19 + 6856) = a5;
            v9 = *(_DWORD *)(a5 + 8);
            *(_DWORD *)(v8 + 6832) = v9;
            *(_DWORD *)(v8 + 6888) = 2;
            **(_BYTE **)(v8 + 832) = 1;
            *(_DWORD *)(v8 + 6864) = v9;
            v10 = *(_DWORD *)(v17 + 4);
            v11 = (unsigned int *)(v8 + 6864);
            switch(v10)
            {
              case 10:
              case 11:
              case 13:
              case 14:
              case 15:
              case 17:
              case 19:
                *(_DWORD *)(v18 + 216) = *(_DWORD *)(v8 + 6836);
                v12 = sub_21985EF20(v20, *(_QWORD *)a5, v11, 1, (uint64_t)sub_2198BC914, v8);
                goto LABEL_21;
              case 12:
              case 16:
                v14 = *(unsigned __int8 *)(v17 + 68);
                if (v14 <= 0x19 && ((1 << v14) & 0x3000300) != 0)
                  v14 &= 0x18u;
                if (v14 <= 7)
                {
                  if (!v14)
                  {
LABEL_40:
                    v12 = sub_2198C24C0(v20, *(_QWORD *)a5, v11, 1u, (uint64_t)sub_2198BC914, v8);
                    goto LABEL_21;
                  }
                  if (v14 == 1)
                  {
LABEL_32:
                    v12 = sub_2198C90DC(v20, *(_QWORD *)a5, v11, 1, (uint64_t)sub_2198BC914, v8);
LABEL_21:
                    v7 = v12;
                    goto LABEL_22;
                  }
                }
                else if (v14 == 8 || v14 == 24 || v14 == 136)
                {
                  goto LABEL_32;
                }
                if (v10 == 12)
                  goto LABEL_40;
                v7 = 0;
LABEL_22:
                if (!*(_DWORD *)(a5 + 8))
                  *(_DWORD *)(v19 + 6864) = 3;
                break;
              case 21:
                v12 = sub_2198B20F4(v20, *(unsigned int **)a5, v11, 1, (uint64_t)sub_2198BC914, v8);
                goto LABEL_21;
              case 22:
                v15 = *(char **)a5;
                if (*(_BYTE *)(v17 + 19) == 17)
                  v12 = sub_2198D33D8(v20, v15, v11, 1, (uint64_t)sub_2198BC914, v8);
                else
                  v12 = sub_219902F78(v20, (uint64_t)v15, v11, 1, (uint64_t)sub_2198BC914, v8);
                goto LABEL_21;
              case 23:
                v12 = sub_219887B5C(v20, *(_QWORD *)a5, v11, 1, (uint64_t)sub_2198BC914, v8);
                goto LABEL_21;
              default:
                goto LABEL_22;
            }
          }
        }
      }
    }
  }
LABEL_24:
  sub_219850808(0, (unsigned int *)&v20, 4u, 5u, (uint64_t)"phLibNfc_SM_WriteNdefTrans");
  return v7;
}

uint64_t sub_2198A5100(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  unsigned int v10;
  int v11;
  uint64_t v12;
  int v14;
  __int16 v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;

  v18 = 0;
  v19 = a1;
  v16 = 0;
  v17 = a4;
  v15 = 0;
  v14 = 0;
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_FormatNdefTrans");
  sub_21988EDF4(v19, &v18);
  v7 = 1;
  if (a5 && a4 && v18)
  {
    if (*(_QWORD *)(v18 + 1456))
    {
      if (*(_BYTE *)(v18 + 6872) == 1)
      {
        v7 = 147;
      }
      else
      {
        v7 = 149;
        if (!sub_2198BE4E4(v18, &v17, &v16, 1) && v16 && !sub_219879D44(v18, v16))
        {
          v8 = v17;
          v9 = v18;
          *(_DWORD *)(v18 + 6888) = 3;
          *(_WORD *)(v9 + 6848) = 252;
          sub_219890EFC(*(_QWORD *)(v9 + 6880), *(_QWORD *)(v9 + 6936), v8, *(_QWORD *)(v9 + 6928), *(_QWORD *)(*(_QWORD *)(v9 + 6840) + 184), (unsigned __int16 *)(v9 + 6848));
          sub_219890FEC(*(unsigned int **)(v18 + 6880), 0, (uint64_t)sub_2198BC440, v18);
          sub_219890FEC(*(unsigned int **)(v18 + 6880), 1u, (uint64_t)sub_2198BC440, v18);
          v10 = *(_DWORD *)(a5 + 8);
          if (v10)
          {
            v11 = 0;
            v12 = *(_QWORD *)a5 + 1;
            do
            {
              *(_QWORD *)a5 = v12;
              *((_BYTE *)&v14 + v11++) = *(_BYTE *)(v12++ - 1);
            }
            while (v10 > v11);
          }
          v7 = sub_219891084(*(_QWORD *)(v18 + 6880), (uint64_t)&v14);
        }
      }
    }
    else
    {
      v7 = 148;
    }
  }
  sub_219850808(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_FormatNdefTrans");
  return v7;
}

uint64_t sub_2198A52A0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  int v9;
  int v10;
  uint64_t v11;
  int v12;
  uint64_t v13;
  int v14;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  uint64_t v19;

  v18 = 0;
  v19 = a1;
  v16 = a4;
  v17 = 0;
  v15 = 0;
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_ReadOnlyTrans");
  sub_21988EDF4(v19, &v18);
  sub_21988EF68(v19, &v17);
  v7 = 255;
  if (a4 && v18)
  {
    if (*(_BYTE *)(v18 + 6872) == 2)
    {
      v7 = 147;
      goto LABEL_7;
    }
    if (!*(_BYTE *)(v18 + 6872))
    {
      v7 = 152;
      goto LABEL_7;
    }
    if (v17)
    {
      v9 = *(unsigned __int8 *)(v17 + 545);
      v10 = *(unsigned __int8 *)(v18 + 19372);
      if (v9 == 2)
      {
        if (v10 == 1)
        {
          v7 = 58;
          goto LABEL_7;
        }
      }
      else
      {
        v7 = 58;
        if (v9 != 1 || v10 != 1)
          goto LABEL_7;
      }
    }
    v7 = 149;
    if (!sub_2198BE4E4(v18, &v16, &v15, 1) && v15 && !sub_219879D44(v18, v15))
    {
      v11 = v18;
      *(_DWORD *)(v18 + 6888) = 4;
      v12 = *(_DWORD *)(v16 + 4);
      v7 = 51;
      switch(v12)
      {
        case 11:
        case 13:
        case 14:
        case 15:
          v13 = sub_21985F64C(v19, (uint64_t)sub_2198BC2F0, v11);
          goto LABEL_35;
        case 12:
        case 16:
          if (*(_BYTE *)(v11 + 19372) == 1)
            break;
          if (v12 == 12 || !*(_BYTE *)(v16 + 68))
          {
            v13 = sub_2198C36DC(v19, (uint64_t)sub_2198BC2F0, v11);
            goto LABEL_35;
          }
          v7 = 1;
          if (a5 && v17 && *(_QWORD *)a5 && *(_DWORD *)(a5 + 8) == 6)
          {
            phOsalNfc_MemCopy();
            v13 = sub_2198CD698(v19, (uint64_t)sub_2198BC2F0, v18);
            goto LABEL_35;
          }
          break;
        case 21:
          v13 = sub_2198B2360(v19, (uint64_t)sub_2198BC2F0, v11);
          goto LABEL_35;
        case 22:
          v14 = *(unsigned __int8 *)(v16 + 19);
          if ((v14 & 0xF0) == 0x10)
          {
            if (v14 == 17)
              v13 = sub_2198D2FD8(v19, (uint64_t)sub_2198BC2F0, v11);
            else
              v13 = sub_219902D70(v19, (uint64_t)sub_2198BC2F0, v11);
LABEL_35:
            v7 = v13;
          }
          else
          {
            v7 = 255;
          }
          break;
        case 23:
          v13 = sub_219887DDC(v19, (uint64_t)sub_2198BC2F0, v11);
          goto LABEL_35;
        default:
          break;
      }
    }
  }
LABEL_7:
  sub_219850718(0, (unsigned int *)&v19, 4u, 5u, (uint64_t)"phLibNfc_SM_ReadOnlyTrans");
  return v7;
}

uint64_t sub_2198A550C(uint64_t a1)
{
  int v1;
  _BYTE *v2;
  _QWORD *v3;
  uint64_t v4;
  char v6;
  uint64_t *v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_ISO15693_HdrConfigTrans");
  sub_21988EDF4(v10, &v9);
  if (!v9)
  {
    v4 = 1;
    sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)"phLibNfc_SM_ISO15693_HdrConfigTrans: Failed");
    goto LABEL_10;
  }
  if (*(_BYTE *)(v9 + 2938) != 1 && *(_BYTE *)(v9 + 2944) != 1 || *(_DWORD *)(*(_QWORD *)(v9 + 1352) + 4) != 23)
  {
    sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)"phLibNfc_SM_ISO15693_HdrConfigTrans: Feature not supported on this platform or tag");
    v4 = 51;
    goto LABEL_10;
  }
  v1 = sub_219902600(*(unsigned int **)(v9 + 3040), *(_QWORD *)(v9 + 1456));
  v2 = (_BYTE *)v9;
  v3 = (_QWORD *)(v9 + 1456);
  if (v1)
  {
    *v3 = 0;
    v3[1] = 0;
LABEL_7:
    sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)"Target not connected");
    v4 = 148;
    goto LABEL_10;
  }
  if (!*v3)
    goto LABEL_7;
  *(_QWORD *)(v9 + 2912) = &qword_2550A3EF8;
  v2[2904] = 0;
  v2[2906] = 0;
  v6 = qword_2550A3EF8;
  if (qword_2550A3EF8)
  {
    v6 = 0;
    v7 = &qword_2550A3F08;
    do
    {
      ++v6;
      v8 = *v7;
      v7 += 2;
    }
    while (v8);
  }
  v2[2905] = v6;
  v4 = sub_2198655FC((uint64_t)v2, 0, 0);
LABEL_10:
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_ISO15693_HdrConfigTrans");
  return v4;
}

uint64_t sub_2198A5684(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  uint64_t v10;
  void (*v11)(_QWORD, uint64_t, _QWORD, uint64_t);
  uint64_t v12;
  void (*v13)(_QWORD, uint64_t, uint64_t, uint64_t, uint64_t);
  uint64_t v14;
  void (*v15)(_QWORD, uint64_t, uint64_t);
  uint64_t v16;
  unsigned int *v17;
  uint64_t v18;
  void (*v19)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t);
  uint64_t v20;
  uint64_t v21;
  uint64_t v22;
  uint64_t v23;
  uint64_t v24;
  uint64_t v25;
  uint64_t *v27;
  uint64_t v28;
  uint64_t v29;

  v28 = 0;
  v29 = a1;
  v27 = 0;
  sub_219850718(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_PollActiveTransComplete");
  sub_21988EDF4(v29, &v28);
  sub_21988EB80(v29, &v27);
  if ((_DWORD)a3)
    sub_219886108(v29, a3);
  else
    sub_21988620C(v29, 0);
  v9 = v28;
  if (v28)
  {
    v10 = 1;
    if (a2 <= 122)
    {
      switch(a2)
      {
        case 'M':
        case 'N':
        case 'O':
        case 'P':
        case 'Q':
        case 'R':
        case 'S':
        case 'T':
        case 'U':
        case 'V':
        case 'W':
          sub_2198EF748(v28, a4, a3);
          goto LABEL_44;
        case 'X':
        case 'Z':
        case '[':
        case '\\':
        case ']':
        case 'a':
        case 'b':
        case 'c':
        case 'd':
        case 'e':
        case 'f':
        case 'g':
        case 'h':
        case 'i':
        case 'j':
        case 'k':
        case 'l':
          goto LABEL_45;
        case 'Y':
        case '^':
        case '_':
          v15 = *(void (**)(_QWORD, uint64_t, uint64_t))(v28 + 6792);
          v16 = *(_QWORD *)(v28 + 6800);
          *(_OWORD *)(v28 + 6792) = 0u;
          if (v15)
          {
            sub_219851790(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
            v17 = (unsigned int *)(v28 + 19368);
            v18 = 132;
LABEL_43:
            sub_219885F70(1, v17, 4u, v18, (uint64_t)"phLibNfc_SM_Main_PollActiveTransComplete");
            v15(*(_QWORD *)(v28 + 19360), v16, a3);
          }
          goto LABEL_44;
        case 'm':
        case 'n':
        case 'o':
          goto LABEL_14;
        default:
          switch(a2)
          {
            case 17:
              goto LABEL_19;
            case 18:
              v19 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))(v28 + 6168);
              v20 = *(_QWORD *)(v28 + 6176);
              *(_QWORD *)(v28 + 6176) = 0;
              *(_QWORD *)(v9 + 6168) = 0;
              if (!v19)
                goto LABEL_44;
              sub_219851790(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"Get Tag Type:Invoking callback function, wStatus = ");
              sub_219885F70(1, (unsigned int *)(v28 + 19368), 4u, 16, (uint64_t)"phLibNfc_SM_Main_PollActiveTransComplete");
              v21 = *(_QWORD *)(v28 + 19360);
              v22 = *(_QWORD *)(v28 + 2768);
              goto LABEL_27;
            case 19:
              v19 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))(v28 + 6184);
              v20 = *(_QWORD *)(v28 + 6192);
              *(_QWORD *)(v28 + 6192) = 0;
              *(_QWORD *)(v9 + 6184) = 0;
              if (!v19)
                goto LABEL_44;
              sub_219851790(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"RemDev Transceive:Invoking callback function, wStatus = ");
              sub_219885F70(1, (unsigned int *)(v28 + 19368), 4u, 17, (uint64_t)"phLibNfc_SM_Main_PollActiveTransComplete");
              v21 = *(_QWORD *)(v28 + 19360);
              v22 = v28 + 2552;
LABEL_27:
              v23 = v20;
              v24 = a4;
              goto LABEL_34;
            case 20:
            case 21:
            case 24:
              goto LABEL_8;
            case 22:
            case 23:
              v11 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(v28 + 6216);
              v12 = *(_QWORD *)(v28 + 6224);
              *(_QWORD *)(v28 + 6224) = 0;
              *(_QWORD *)(v9 + 6216) = 0;
              if (v11)
              {
                sub_219885F70(1, (unsigned int *)(v9 + 19368), 4u, 130, (uint64_t)"phLibNfc_SM_Main_PollActiveTransComplete");
                v11(*(_QWORD *)(v28 + 19360), v12, 0, a3);
              }
              goto LABEL_44;
            case 25:
              v15 = *(void (**)(_QWORD, uint64_t, uint64_t))(v28 + 6424);
              v16 = *(_QWORD *)(v28 + 6432);
              *(_QWORD *)(v28 + 6432) = 0;
              *(_QWORD *)(v9 + 6424) = 0;
              if (!v15)
                goto LABEL_44;
              v17 = (unsigned int *)(v9 + 19368);
              v18 = 22;
              goto LABEL_43;
            case 26:
              v19 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t, uint64_t))(v28 + 6264);
              v25 = *(_QWORD *)(v28 + 6272);
              *(_QWORD *)(v28 + 6264) = 0;
              *(_QWORD *)(v9 + 6272) = 0;
              phOsalNfc_SetMemory();
              if (!v19)
                goto LABEL_44;
              if (a4)
                phOsalNfc_MemCopy();
              sub_219850628(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"Invoking upper layer callback");
              sub_219885F70(1, (unsigned int *)(v28 + 19368), 4u, 23, (uint64_t)"phLibNfc_SM_Main_PollActiveTransComplete");
              v21 = *(_QWORD *)(v28 + 19360);
              v24 = 0;
              v22 = 0;
              v23 = v25;
LABEL_34:
              v19(v21, v23, v24, v22, a3);
              goto LABEL_44;
            case 27:
              v15 = *(void (**)(_QWORD, uint64_t, uint64_t))(v28 + 6360);
              v16 = *(_QWORD *)(v28 + 6368);
              *(_QWORD *)(v28 + 6368) = 0;
              *(_QWORD *)(v9 + 6360) = 0;
              if (!v15)
                goto LABEL_44;
              sub_219850628(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"Invoking upper layer callback");
              v17 = (unsigned int *)(v28 + 19368);
              v18 = 24;
              goto LABEL_43;
            case 28:
              v15 = *(void (**)(_QWORD, uint64_t, uint64_t))(v28 + 6376);
              v16 = *(_QWORD *)(v28 + 6384);
              *(_QWORD *)(v28 + 6384) = 0;
              *(_QWORD *)(v9 + 6376) = 0;
              if (!v15)
                goto LABEL_44;
              sub_219850628(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"Invoking upper layer callback");
              v17 = (unsigned int *)(v28 + 19368);
              v18 = 25;
              goto LABEL_43;
            case 29:
              v15 = *(void (**)(_QWORD, uint64_t, uint64_t))(v28 + 6904);
              v16 = *(_QWORD *)(v28 + 6912);
              *(_QWORD *)(v28 + 6912) = 0;
              *(_QWORD *)(v9 + 6904) = 0;
              if (!v15)
                goto LABEL_44;
              sub_219850628(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"Invoking upper layer callback");
              v17 = (unsigned int *)(v28 + 19368);
              v18 = 26;
              goto LABEL_43;
            case 30:
              *(_BYTE *)(v28 + 19372) = 0;
              v15 = *(void (**)(_QWORD, uint64_t, uint64_t))(v9 + 6392);
              v16 = *(_QWORD *)(v9 + 6400);
              *(_QWORD *)(v9 + 6392) = 0;
              *(_QWORD *)(v9 + 6400) = 0;
              if (!v15)
                goto LABEL_44;
              sub_219850628(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"Invoking upper layer callback");
              v17 = (unsigned int *)(v28 + 19368);
              v18 = 27;
              goto LABEL_43;
            default:
              goto LABEL_45;
          }
      }
    }
    if (a2 <= 135)
    {
      if (a2 == 123 || a2 == 126)
      {
LABEL_14:
        sub_21986C460(v27, a4, a3);
        goto LABEL_44;
      }
    }
    else
    {
      if ((a2 - 136) < 2)
      {
LABEL_8:
        sub_2198D782C(v28, a3);
LABEL_44:
        v10 = a3;
        goto LABEL_45;
      }
      if (a2 == 154)
      {
LABEL_19:
        v13 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t, uint64_t))(v28 + 6152);
        v14 = *(_QWORD *)(v28 + 6160);
        *(_QWORD *)(v28 + 6160) = 0;
        *(_QWORD *)(v9 + 6152) = 0;
        if (v13)
        {
          sub_219850628(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"Invoking upper layer callback");
          sub_219885F70(1, (unsigned int *)(v28 + 19368), 4u, 15, (uint64_t)"phLibNfc_SM_Main_PollActiveTransComplete");
          v13(*(_QWORD *)(v28 + 19360), v14, a4, a5, a3);
        }
        goto LABEL_44;
      }
    }
  }
  else
  {
    v10 = 1;
  }
LABEL_45:
  sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_PollActiveTransComplete");
  return v10;
}

uint64_t sub_2198A5C80(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  uint64_t v8;
  void (*v9)(_QWORD, uint64_t, uint64_t, _QWORD, uint64_t);
  uint64_t v10;
  void (*v11)(_QWORD, uint64_t, uint64_t);
  uint64_t v12;
  uint64_t *v14;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  v14 = 0;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ListenActiveTransComplete");
  sub_21988EDF4(v16, &v15);
  sub_21988EB80(v16, &v14);
  if ((_DWORD)a3)
    sub_219886108(v16, a3);
  else
    sub_21988620C(v16, 0);
  if (v15)
  {
    v7 = 1;
    if (a2 > 88)
    {
      v8 = (a2 - 109);
      if (v8 <= 0x27)
      {
        if (((1 << (a2 - 109)) & 0x24007) != 0)
        {
          sub_21986C460(v14, a4, a3);
          goto LABEL_21;
        }
        if (((1 << (a2 - 109)) & 0x18000000) != 0)
        {
          sub_2198D782C(v15, a3);
          goto LABEL_21;
        }
        if (v8 == 39)
        {
          v9 = *(void (**)(_QWORD, uint64_t, uint64_t, _QWORD, uint64_t))(v15 + 6712);
          if (v9)
          {
            v10 = *(_QWORD *)(v15 + 6720);
            sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)"Invoking upper layer callback");
            sub_219853E34(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)"ListenActiveTransComplete :CEHostNtfCb [Hce Activated Ntf]");
            v9(*(_QWORD *)(v15 + 19360), v10, v15 + 824, *(unsigned __int8 *)(v15 + 714), a3);
          }
          goto LABEL_21;
        }
      }
      if (a2 == 89 || a2 == 94)
      {
        v11 = *(void (**)(_QWORD, uint64_t, uint64_t))(v15 + 6792);
        v12 = *(_QWORD *)(v15 + 6800);
        *(_OWORD *)(v15 + 6792) = 0u;
        if (v11)
        {
          sub_219851790(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
          sub_219885F70(1, (unsigned int *)(v15 + 19368), 4u, 132, (uint64_t)"phLibNfc_SM_Main_ListenActiveTransComplete");
          v11(*(_QWORD *)(v15 + 19360), v12, a3);
        }
        goto LABEL_21;
      }
    }
    else if ((a2 - 77) < 0xB)
    {
      sub_2198EF748(v15, a4, a3);
LABEL_21:
      v7 = a3;
    }
  }
  else
  {
    v7 = 1;
  }
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ListenActiveTransComplete");
  return v7;
}

uint64_t sub_2198A5EB4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  v9 = 0;
  v10 = a4;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevReceiveTrans");
  sub_21988EDF4(v12, &v9);
  v5 = 1;
  if (a4)
  {
    if (v9)
    {
      v5 = sub_2198BE4E4(v9, &v10, &v11, 1);
      if (!(_DWORD)v5)
      {
        if (v11)
        {
          v6 = v9;
          *(_BYTE *)(v9 + 486) = 0;
          if (*(_BYTE *)(v6 + 485) == 1)
            v7 = sub_2198CEDF8(v6);
          else
            v7 = sub_219861598(*(_QWORD *)(v6 + 3040), (uint64_t)sub_2198CF084, v6);
          v5 = v7;
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevReceiveTrans");
  return v5;
}

uint64_t sub_2198A5F8C(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, uint64_t);
  uint64_t v9;
  void (*v10)(_QWORD, uint64_t, uint64_t, uint64_t);
  uint64_t v11;
  uint64_t *v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  v13 = 0;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ListenReceiveTransComplete");
  sub_21988EDF4(v15, &v14);
  sub_21988EB80(v15, &v13);
  if ((_DWORD)a3)
    sub_219886108(v15, a3);
  else
    sub_21988620C(v15, 0);
  if (v14)
  {
    v7 = 1;
    if (a2 <= 122)
    {
      switch(a2)
      {
        case 'M':
        case 'N':
        case 'O':
        case 'P':
        case 'Q':
        case 'R':
        case 'S':
        case 'T':
        case 'U':
        case 'V':
        case 'W':
          sub_2198EF748(v14, a4, a3);
          goto LABEL_19;
        case 'X':
        case 'Z':
        case '[':
        case '\\':
        case ']':
        case '_':
        case 'a':
        case 'b':
        case 'c':
        case 'd':
        case 'e':
        case 'f':
        case 'g':
        case 'h':
        case 'i':
        case 'j':
        case 'k':
        case 'l':
        case 'm':
        case 'n':
          goto LABEL_20;
        case 'Y':
        case '^':
          v8 = *(void (**)(_QWORD, uint64_t, uint64_t))(v14 + 6792);
          v9 = *(_QWORD *)(v14 + 6800);
          *(_OWORD *)(v14 + 6792) = 0u;
          if (v8)
          {
            sub_219851790(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
            sub_219885F70(1, (unsigned int *)(v14 + 19368), 4u, 132, (uint64_t)"phLibNfc_SM_Main_ListenReceiveTransComplete");
            v8(*(_QWORD *)(v14 + 19360), v9, a3);
          }
          goto LABEL_19;
        case 'o':
          goto LABEL_12;
        default:
          if (a2 != 32)
            goto LABEL_20;
          v10 = *(void (**)(_QWORD, uint64_t, uint64_t, uint64_t))(v14 + 6760);
          v11 = *(_QWORD *)(v14 + 6768);
          *(_OWORD *)(v14 + 6760) = 0u;
          if (v10)
          {
            sub_219850628(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"Invoking upper layer callback");
            sub_219885F70(1, (unsigned int *)(v14 + 19368), 4u, 30, (uint64_t)"phLibNfc_SM_Main_ListenReceiveTransComplete");
            v10(*(_QWORD *)(v14 + 19360), v11, a4, a3);
          }
          break;
      }
      goto LABEL_19;
    }
    if ((a2 - 136) < 2)
    {
      sub_2198D782C(v14, a3);
      goto LABEL_19;
    }
    if (a2 == 123 || a2 == 126)
    {
LABEL_12:
      sub_21986C460(v13, a4, a3);
LABEL_19:
      v7 = a3;
    }
  }
  else
  {
    v7 = 1;
  }
LABEL_20:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ListenReceiveTransComplete");
  return v7;
}

uint64_t sub_2198A61C8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  _BYTE *v8;
  char v9;
  uint64_t *v10;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  v13 = a4;
  v14 = 0;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevSendTrans");
  sub_21988EDF4(v16, &v15);
  v7 = 1;
  if (a5)
  {
    if (a4)
    {
      if (v15)
      {
        v7 = sub_2198BE4E4(v15, &v13, &v14, 1);
        if (!(_DWORD)v7)
        {
          if (v14)
          {
            v8 = (_BYTE *)v15;
            *(_QWORD *)(v15 + 2912) = off_2550A2FE8;
            v8[2904] = 0;
            v8[2906] = 0;
            v9 = (char)off_2550A2FE8[0];
            if (off_2550A2FE8[0])
            {
              v9 = 0;
              v10 = &qword_2550A2FF8;
              do
              {
                ++v9;
                v11 = *v10;
                v10 += 2;
              }
              while (v11);
            }
            v8[2905] = v9;
            v7 = sub_2198655FC((uint64_t)v8, 0, a5);
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_RemDevSendTrans");
  return v7;
}

uint64_t sub_2198A62C4(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, uint64_t);
  uint64_t v9;
  unsigned int *v10;
  uint64_t v11;
  uint64_t *v13;
  _QWORD *v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  v13 = 0;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ListenSendTransComplete");
  sub_21988EDF4(v15, &v14);
  sub_21988EB80(v15, &v13);
  if ((_DWORD)a3)
    sub_219886108(v15, a3);
  else
    sub_21988620C(v15, 0);
  if (!v14)
    goto LABEL_19;
  v7 = 1;
  if (a2 <= 122)
  {
    switch(a2)
    {
      case 'M':
      case 'N':
      case 'O':
      case 'P':
      case 'Q':
      case 'R':
      case 'S':
      case 'T':
      case 'U':
      case 'V':
      case 'W':
        sub_2198EF748((uint64_t)v14, a4, a3);
        goto LABEL_19;
      case 'X':
      case 'Z':
      case '[':
      case '\\':
      case ']':
      case '_':
      case 'a':
      case 'b':
      case 'c':
      case 'd':
      case 'e':
      case 'f':
      case 'g':
      case 'h':
      case 'i':
      case 'j':
      case 'k':
      case 'l':
      case 'm':
      case 'n':
        goto LABEL_20;
      case 'Y':
      case '^':
        v8 = (void (*)(_QWORD, uint64_t, uint64_t))v14[849];
        v9 = v14[850];
        *(_OWORD *)(v14 + 849) = 0u;
        if (!v8)
          goto LABEL_19;
        sub_219851790(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
        v10 = (unsigned int *)(v14 + 2421);
        v11 = 132;
        goto LABEL_18;
      case 'o':
        goto LABEL_11;
      default:
        if (a2 != 33)
          goto LABEL_20;
        v8 = (void (*)(_QWORD, uint64_t, uint64_t))v14[843];
        v9 = v14[844];
        *(_OWORD *)(v14 + 843) = 0u;
        if (v8)
        {
          sub_219850628(0, (unsigned int *)&v15, 4u, 4u, (uint64_t)"Invoking upper layer callback");
          v10 = (unsigned int *)(v14 + 2421);
          v11 = 31;
LABEL_18:
          sub_219885F70(1, v10, 4u, v11, (uint64_t)"phLibNfc_SM_Main_ListenSendTransComplete");
          v8(v14[2420], v9, a3);
        }
        break;
    }
    goto LABEL_19;
  }
  if ((a2 - 136) < 2)
  {
    sub_2198D782C((uint64_t)v14, a3);
    goto LABEL_19;
  }
  if (a2 == 123 || a2 == 126)
  {
LABEL_11:
    sub_21986C460(v13, a4, a3);
LABEL_19:
    v7 = a3;
  }
LABEL_20:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ListenSendTransComplete");
  return v7;
}

uint64_t sub_2198A64D4(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, uint64_t);
  uint64_t v9;
  uint64_t *v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ListenSleepTransComplete");
  sub_21988EDF4(v13, &v12);
  sub_21988EB80(v13, &v11);
  if ((_DWORD)a3)
    sub_219886108(v13, a3);
  else
    sub_21988620C(v13, 0);
  if (!v12)
    goto LABEL_15;
  v7 = 1;
  if (a2 > 122)
  {
    if ((a2 - 136) < 2)
    {
      sub_2198D782C(v12, a3);
    }
    else
    {
      if (a2 != 123 && a2 != 126)
        goto LABEL_16;
LABEL_11:
      sub_21986C460(v11, a4, a3);
    }
LABEL_15:
    v7 = a3;
    goto LABEL_16;
  }
  switch(a2)
  {
    case 'M':
    case 'N':
    case 'O':
    case 'P':
    case 'Q':
    case 'R':
    case 'S':
    case 'T':
    case 'U':
    case 'V':
    case 'W':
      sub_2198EF748(v12, a4, a3);
      goto LABEL_15;
    case 'Y':
    case '^':
      v8 = *(void (**)(_QWORD, uint64_t, uint64_t))(v12 + 6792);
      v9 = *(_QWORD *)(v12 + 6800);
      *(_OWORD *)(v12 + 6792) = 0u;
      if (v8)
      {
        sub_219851790(0, (unsigned int *)&v13, 4u, 4u, (uint64_t)"phLibNfc_Mgt_SetNfccParams:Invoking callback, wStatus = ");
        sub_219885F70(1, (unsigned int *)(v12 + 19368), 4u, 132, (uint64_t)"phLibNfc_SM_Main_ListenSleepTransComplete");
        v8(*(_QWORD *)(v12 + 19360), v9, a3);
      }
      goto LABEL_15;
    case 'o':
      goto LABEL_11;
    default:
      break;
  }
LABEL_16:
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ListenSleepTransComplete");
  return v7;
}

uint64_t sub_2198A6684(uint64_t a1, int a2, uint64_t a3)
{
  unsigned int *v5;
  void (*v6)(uint64_t, uint64_t, uint64_t);
  uint64_t v7;
  unsigned int *v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ShutdownTransComplete");
  sub_21988EDF4(v10, &v9);
  v5 = v9;
  if (v9)
  {
    switch(a2)
    {
      case 66:
        if (*((_QWORD *)v9 + 763))
          sub_2198EB8A8((uint64_t)v9, a3);
        break;
      case 141:
        sub_2198AA74C(v9, a3);
        break;
      case 139:
        v6 = (void (*)(uint64_t, uint64_t, uint64_t))*((_QWORD *)v9 + 767);
        v7 = *((_QWORD *)v9 + 768);
        if ((_DWORD)a3)
        {
          sub_219886108(v10, a3);
          v5 = v9;
        }
        sub_21989B2B0((uint64_t)v5);
        v9 = 0;
        if (v6)
        {
          sub_219851790(0, (unsigned int *)&v10, 4u, 4u, (uint64_t)"ShutdownCb:Invoking callback function, wStatus = ");
          sub_219885F70(0, (unsigned int *)&v10, 4u, 116, (uint64_t)"phLibNfc_SM_Main_ShutdownTransComplete");
          v6(v10, v7, a3);
        }
        break;
      default:
        a3 = 1;
        break;
    }
  }
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_Main_ShutdownTransComplete");
  return a3;
}

uint64_t sub_2198A67C4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v4;
  uint64_t v6;
  uint64_t v7;

  v6 = 0;
  v7 = a1;
  sub_219850718(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSEInitTrans");
  sub_21988EDF4(v7, &v6);
  if (!v6)
    goto LABEL_5;
  v4 = *(unsigned __int8 *)(v6 + 318);
  if (v4 != 1)
  {
    if (v4 == 2)
    {
      sub_2198D2A2C(*(_QWORD *)(v6 + 19360), 1u, 5);
      a3 = 214;
      goto LABEL_6;
    }
LABEL_5:
    a3 = 255;
  }
LABEL_6:
  sub_219850808(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSEInitTrans");
  return a3;
}

uint64_t sub_2198A686C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v4;
  uint64_t v6;
  uint64_t v7;

  v6 = 0;
  v7 = a1;
  sub_219850718(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eUiccInitTrans");
  sub_21988EDF4(v7, &v6);
  if (!v6)
    goto LABEL_5;
  v4 = *(unsigned __int8 *)(v6 + 317);
  if (v4 != 1)
  {
    if (v4 == 2)
    {
      sub_2198D2A2C(*(_QWORD *)(v6 + 19360), 2u, 5);
      a3 = 214;
      goto LABEL_6;
    }
LABEL_5:
    a3 = 255;
  }
LABEL_6:
  sub_219850808(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eUiccInitTrans");
  return a3;
}

uint64_t sub_2198A6914(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v4;
  uint64_t v6;
  uint64_t v7;

  v6 = 0;
  v7 = a1;
  sub_219850718(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSE2InitTrans");
  sub_21988EDF4(v7, &v6);
  if (!v6)
    goto LABEL_5;
  v4 = *(unsigned __int8 *)(v6 + 319);
  if (v4 != 1)
  {
    if (v4 == 2)
    {
      sub_2198D2A2C(*(_QWORD *)(v6 + 19360), 3u, 5);
      a3 = 214;
      goto LABEL_6;
    }
LABEL_5:
    a3 = 255;
  }
LABEL_6:
  sub_219850808(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSE2InitTrans");
  return a3;
}

uint64_t sub_2198A69BC(uint64_t a1)
{
  uint64_t v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetRemovedToOffTrans");
  sub_21988EDF4(v8, &v7);
  v1 = v7;
  if (v7)
  {
    *(_BYTE *)(v7 + 1) = 1;
    *(_DWORD *)(v1 + 520) = 0;
    *(_QWORD *)(v1 + 2912) = off_2550A3958;
    *(_BYTE *)(v1 + 2904) = 0;
    *(_BYTE *)(v1 + 2906) = 0;
    v2 = (char)off_2550A3958[0];
    if (off_2550A3958[0])
    {
      v2 = 0;
      v3 = off_2550A3968;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    *(_BYTE *)(v1 + 2905) = v2;
    v5 = sub_2198655FC(v1, 0, 0);
  }
  else
  {
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetRemovedToOffTrans");
  return v5;
}

uint64_t sub_2198A6A88(uint64_t a1, int a2)
{
  uint64_t v3;
  char v4;
  uint64_t (**v5)();
  uint64_t (*v6)();
  uint64_t v7;
  uint64_t *v8;
  uint64_t v9;
  uint64_t (**v10)();
  uint64_t (*v11)();
  uint64_t v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetOffToVirtualTrans");
  sub_21988EDF4(v14, &v13);
  v3 = v13;
  if (v13)
  {
    if (a2 == 160)
    {
      *(_DWORD *)(v13 + 520) = 1;
      *(_QWORD *)(v3 + 2912) = off_2550A39A8;
      *(_BYTE *)(v3 + 2904) = 0;
      *(_BYTE *)(v3 + 2906) = 0;
      v4 = (char)off_2550A39A8[0];
      if (off_2550A39A8[0])
      {
        v4 = 0;
        v8 = &qword_2550A39B8;
        do
        {
          ++v4;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
      goto LABEL_30;
    }
    if (a2 != 177)
    {
      if (a2 == 167)
      {
        if (*(_BYTE *)(v13 + 2936) != 1
          && *(_BYTE *)(v13 + 2937) != 1
          && *(_BYTE *)(v13 + 2938) != 1
          && *(_BYTE *)(v13 + 2944) != 1)
        {
LABEL_11:
          *(_BYTE *)(v3 + 1) = 1;
          *(_DWORD *)(v3 + 520) = 1;
          *(_QWORD *)(v3 + 2912) = off_2550A3868;
          *(_BYTE *)(v3 + 2904) = 0;
          *(_BYTE *)(v3 + 2906) = 0;
          v4 = (char)off_2550A3868[0];
          if (off_2550A3868[0])
          {
            v4 = 0;
            v5 = off_2550A3878;
            do
            {
              ++v4;
              v6 = *v5;
              v5 += 2;
            }
            while (v6);
          }
LABEL_30:
          *(_BYTE *)(v3 + 2905) = v4;
          v7 = sub_2198655FC(v3, 0, 0);
          goto LABEL_32;
        }
        if (sub_2198D0CBC(*(_QWORD *)(v13 + 19360), 2))
        {
          v3 = v13;
          goto LABEL_11;
        }
      }
LABEL_31:
      v7 = 147;
      goto LABEL_32;
    }
    if (*(_BYTE *)(v13 + 2937) == 1
      || *(_BYTE *)(v13 + 2936) == 1
      || *(_BYTE *)(v13 + 2944) == 1
      || *(_BYTE *)(v13 + 2938) == 1)
    {
      if (!sub_2198D0CBC(*(_QWORD *)(v13 + 19360), 1)
        || !sub_2198D0DC0(*(_QWORD *)(v13 + 19360), 1))
      {
        goto LABEL_31;
      }
      v3 = v13;
    }
    *(_DWORD *)(v3 + 520) = 1;
    *(_QWORD *)(v3 + 2912) = off_2550A3868;
    *(_BYTE *)(v3 + 2904) = 0;
    *(_BYTE *)(v3 + 2906) = 0;
    v4 = (char)off_2550A3868[0];
    if (off_2550A3868[0])
    {
      v4 = 0;
      v10 = off_2550A3878;
      do
      {
        ++v4;
        v11 = *v10;
        v10 += 2;
      }
      while (v11);
    }
    goto LABEL_30;
  }
  v7 = 255;
LABEL_32:
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetOffToVirtualTrans");
  return v7;
}

uint64_t sub_2198A6C8C(uint64_t a1, int a2)
{
  uint64_t v3;
  char v4;
  uint64_t (**v5)();
  uint64_t (*v6)();
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetOffToApduTrans");
  sub_21988EDF4(v10, &v9);
  v3 = v9;
  if (!v9)
  {
    v7 = 255;
    goto LABEL_15;
  }
  if (a2 != 168)
    goto LABEL_13;
  if (*(_BYTE *)(v9 + 2936) != 1
    && *(_BYTE *)(v9 + 2937) != 1
    && *(_BYTE *)(v9 + 2938) != 1
    && *(_BYTE *)(v9 + 2944) != 1)
  {
    goto LABEL_9;
  }
  if (!sub_2198D0CBC(*(_QWORD *)(v9 + 19360), 2))
  {
LABEL_13:
    v7 = 147;
    goto LABEL_15;
  }
  v3 = v9;
LABEL_9:
  *(_DWORD *)(v3 + 520) = 1;
  *(_QWORD *)(v3 + 2912) = off_2550A3868;
  *(_BYTE *)(v3 + 2904) = 0;
  *(_BYTE *)(v3 + 2906) = 0;
  v4 = (char)off_2550A3868[0];
  if (off_2550A3868[0])
  {
    v4 = 0;
    v5 = off_2550A3878;
    do
    {
      ++v4;
      v6 = *v5;
      v5 += 2;
    }
    while (v6);
  }
  *(_BYTE *)(v3 + 2905) = v4;
  v7 = sub_2198655FC(v3, 0, 0);
LABEL_15:
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetOffToApduTrans");
  return v7;
}

uint64_t sub_2198A6DAC(uint64_t a1, int a2, uint64_t a3)
{
  uint64_t v5;
  void (*v6)(_QWORD, uint64_t, _QWORD, _QWORD, uint64_t);
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, _QWORD, uint64_t, _QWORD, uint64_t);
  uint64_t v9;
  const char *v10;
  void (*v11)(_QWORD, uint64_t, _QWORD, uint64_t *, uint64_t);
  uint64_t v12;
  uint64_t v13;
  void (*v14)(_QWORD, uint64_t, _QWORD, uint64_t);
  uint64_t v15;
  int v16;
  uint64_t v17;
  uint64_t v19;
  uint64_t v20;
  uint64_t v21;
  uint64_t v22;

  v21 = 0;
  v22 = a1;
  v19 = 0;
  v20 = 0;
  sub_219850718(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_TransComplete");
  sub_21988EDF4(v22, &v21);
  if ((_DWORD)a3)
    sub_219886108(v22, a3);
  else
    sub_21988620C(v22, 0);
  v5 = v21;
  if (v21)
  {
    switch(a2)
    {
      case 159:
      case 160:
      case 164:
      case 166:
      case 167:
      case 168:
      case 176:
      case 177:
      case 181:
      case 182:
        v6 = *(void (**)(_QWORD, uint64_t, _QWORD, _QWORD, uint64_t))(v21 + 6680);
        v7 = *(_QWORD *)(v21 + 6688);
        *(_OWORD *)(v21 + 6680) = 0u;
        *(_DWORD *)(v5 + 520) = 3;
        if (v6)
        {
          sub_219885F70(1, (unsigned int *)(v5 + 19368), 4u, 134, (uint64_t)"phLibNfc_SM_SE_TransComplete");
          v6(*(_QWORD *)(v21 + 19360), v7, **(_QWORD **)(v21 + 512), *(unsigned int *)(v21 + 528), a3);
        }
        break;
      case 169:
      case 170:
        v8 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t, _QWORD, uint64_t))(v21 + 6296);
        v9 = *(_QWORD *)(v21 + 6304);
        *(_QWORD *)(v21 + 6304) = 0;
        *(_QWORD *)(v5 + 6296) = 0;
        if (sub_2199024B8(*(_QWORD *)(v5 + 3040)) == 36 && *(_BYTE *)(v21 + 706) == 1)
        {
          *(_BYTE *)(v21 + 706) = 0;
          a3 = 218;
        }
        if (v8)
        {
          sub_219885F70(1, (unsigned int *)(v21 + 19368), 4u, 124, (uint64_t)"phLibNfc_SM_SE_TransComplete");
          v8(*(_QWORD *)(v21 + 19360), v9, 0, v21 + 576, *(unsigned int *)(v21 + 596), a3);
          v10 = "phLibNfc_HciDataSendProc:APP Callback Invoked";
          goto LABEL_18;
        }
        break;
      case 171:
        v11 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t *, uint64_t))(v21 + 6312);
        v12 = *(_QWORD *)(v21 + 6320);
        *(_QWORD *)(v21 + 6320) = 0;
        *(_QWORD *)(v5 + 6312) = 0;
        if (sub_2199024B8(*(_QWORD *)(v5 + 3040)) == 36 && *(_BYTE *)(v21 + 706) == 1)
        {
          *(_BYTE *)(v21 + 706) = 0;
          a3 = 218;
        }
        if (v11)
        {
          v19 = v21 + 632;
          LODWORD(v20) = 16;
          sub_219885F70(1, (unsigned int *)(v21 + 19368), 4u, 125, (uint64_t)"phLibNfc_SM_SE_TransComplete");
          v11(*(_QWORD *)(v21 + 19360), v12, 0, &v19, a3);
          v10 = "phLibNfc_SM_SE_TransComplete:APP Callback Invoked";
LABEL_18:
          sub_219850628(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)v10);
          v13 = v21;
          *(_QWORD *)(v21 + 6352) = 0;
          *(_QWORD *)(v13 + 6344) = 0;
        }
        break;
      case 172:
        v14 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t))(v21 + 6536);
        v15 = *(_QWORD *)(v21 + 6544);
        *(_QWORD *)(v21 + 6544) = 0;
        *(_QWORD *)(v5 + 6536) = 0;
        v16 = sub_2199024B8(*(_QWORD *)(v5 + 3040));
        v17 = v21;
        if (v16 == 36 && *(_BYTE *)(v21 + 706) == 1)
        {
          *(_BYTE *)(v21 + 706) = 0;
          a3 = 218;
        }
        if (v14)
        {
          sub_219885F70(1, (unsigned int *)(v17 + 19368), 4u, 126, (uint64_t)"phLibNfc_SM_SE_TransComplete");
          v14(*(_QWORD *)(v21 + 19360), v15, *(_QWORD *)(v21 + 552), a3);
          sub_219850628(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"phLibNfc_eSE_GetAtrProc: App layer Callback Invoked");
          v17 = v21;
        }
        if (*(_QWORD *)(v17 + 552))
          *(_QWORD *)(v17 + 552) = 0;
        break;
      default:
        break;
    }
  }
  sub_219850808(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_TransComplete");
  return a3;
}

uint64_t sub_2198A70DC(uint64_t a1, int a2)
{
  uint64_t v3;
  uint64_t v4;
  char v5;
  uint64_t *v6;
  uint64_t v7;
  _BYTE *v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetOffToOffTrans");
  sub_21988EDF4(v10, &v9);
  v3 = (uint64_t)v9;
  if (v9)
  {
    if (a2 == 181)
      v4 = 147;
    else
      v4 = 0;
    if (a2 == 164 && !*v9)
    {
      v9[1] = 1;
      *(_QWORD *)(v3 + 2912) = off_2550A38D8;
      *(_BYTE *)(v3 + 2904) = 0;
      *(_BYTE *)(v3 + 2906) = 0;
      v5 = (char)off_2550A38D8[0];
      if (off_2550A38D8[0])
      {
        v5 = 0;
        v6 = &qword_2550A38E8;
        do
        {
          ++v5;
          v7 = *v6;
          v6 += 2;
        }
        while (v7);
      }
      *(_BYTE *)(v3 + 2905) = v5;
      v4 = sub_2198655FC(v3, 0, 0);
    }
  }
  else
  {
    v4 = 255;
  }
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetOffToOffTrans");
  return v4;
}

uint64_t sub_2198A71C4(uint64_t a1)
{
  uint64_t v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetOffToPwrOffTrans");
  sub_21988EDF4(v8, &v7);
  v1 = v7;
  if (v7)
  {
    *(_BYTE *)(v7 + 1) = 1;
    *(_DWORD *)(v1 + 520) = 0;
    *(_QWORD *)(v1 + 2912) = off_2550A3868;
    *(_BYTE *)(v1 + 2904) = 0;
    *(_BYTE *)(v1 + 2906) = 0;
    v2 = (char)off_2550A3868[0];
    if (off_2550A3868[0])
    {
      v2 = 0;
      v3 = off_2550A3878;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    *(_BYTE *)(v1 + 2905) = v2;
    v5 = sub_2198655FC(v1, 0, 0);
  }
  else
  {
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetOffToPwrOffTrans");
  return v5;
}

uint64_t sub_2198A7290(uint64_t a1, int a2)
{
  uint64_t v3;
  uint64_t v4;
  char v5;
  uint64_t *v6;
  uint64_t v7;
  _BYTE *v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetVirtualToVirtualTrans");
  sub_21988EDF4(v10, &v9);
  v3 = (uint64_t)v9;
  if (v9)
  {
    if (a2 == 167 && !*v9)
    {
      v9[1] = 1;
      *(_QWORD *)(v3 + 2912) = off_2550A38D8;
      *(_BYTE *)(v3 + 2904) = 0;
      *(_BYTE *)(v3 + 2906) = 0;
      v5 = (char)off_2550A38D8[0];
      if (off_2550A38D8[0])
      {
        v5 = 0;
        v6 = &qword_2550A38E8;
        do
        {
          ++v5;
          v7 = *v6;
          v6 += 2;
        }
        while (v7);
      }
      *(_BYTE *)(v3 + 2905) = v5;
      v4 = sub_2198655FC(v3, 0, 0);
    }
    else
    {
      v4 = 0;
    }
  }
  else
  {
    v4 = 255;
  }
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetVirtualToVirtualTrans");
  return v4;
}

uint64_t sub_2198A7374(uint64_t a1, int a2)
{
  uint64_t (**v3)();
  int v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t (*v7)();
  uint64_t *v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetVirtualToOffTrans");
  sub_21988EDF4(v12, &v11);
  if (!v11)
  {
    v5 = 255;
    goto LABEL_23;
  }
  if (*(_BYTE *)(v11 + 2936) == 1)
    v3 = off_2550A3818;
  else
    v3 = off_2550A38A8;
  if (sub_2198D0CBC(*(_QWORD *)(v11 + 19360), 1))
  {
    v4 = sub_2198D0DC0(*(_QWORD *)(v11 + 19360), 1);
    if (a2 == 159 && !v4)
      goto LABEL_18;
  }
  else if (a2 == 159)
  {
    goto LABEL_18;
  }
  sub_219889494(*(unsigned int **)(v11 + 464));
  if (a2 != 159)
  {
    if (a2 != 176)
    {
      if (a2 != 164)
      {
        v5 = 147;
        goto LABEL_23;
      }
      if (*(_BYTE *)(v11 + 2937) == 1 || *(_BYTE *)(v11 + 2938) == 1 || *(_BYTE *)(v11 + 2944) == 1)
      {
        *(_BYTE *)(v11 + 1) = 1;
        v3 = off_2550A38D8;
      }
    }
    goto LABEL_19;
  }
LABEL_18:
  v3 = off_2550A39A8;
LABEL_19:
  v6 = v11;
  *(_DWORD *)(v11 + 520) = 0;
  *(_QWORD *)(v6 + 2912) = v3;
  *(_BYTE *)(v6 + 2904) = 0;
  *(_BYTE *)(v6 + 2906) = 0;
  v7 = *v3;
  if (*v3)
  {
    LOBYTE(v7) = 0;
    v8 = (uint64_t *)(v3 + 2);
    do
    {
      LOBYTE(v7) = (_BYTE)v7 + 1;
      v9 = *v8;
      v8 += 2;
    }
    while (v9);
  }
  *(_BYTE *)(v6 + 2905) = (_BYTE)v7;
  v5 = sub_2198655FC(v6, 0, 0);
LABEL_23:
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetVirtualToOffTrans");
  return v5;
}

uint64_t sub_2198A74FC(uint64_t a1)
{
  uint64_t v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetVirtualToPwrOffTrans");
  sub_21988EDF4(v8, &v7);
  v1 = v7;
  if (v7)
  {
    *(_BYTE *)(v7 + 1) = 1;
    *(_DWORD *)(v1 + 520) = 0;
    *(_QWORD *)(v1 + 2912) = off_2550A3868;
    *(_BYTE *)(v1 + 2904) = 0;
    *(_BYTE *)(v1 + 2906) = 0;
    v2 = (char)off_2550A3868[0];
    if (off_2550A3868[0])
    {
      v2 = 0;
      v3 = off_2550A3878;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    *(_BYTE *)(v1 + 2905) = v2;
    v5 = sub_2198655FC(v1, 0, 0);
  }
  else
  {
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetVirtualToPwrOffTrans");
  return v5;
}

uint64_t sub_2198A75C8(uint64_t a1, int a2)
{
  uint64_t v3;
  uint64_t v4;
  uint64_t (**v5)();
  uint64_t (*v6)();
  uint64_t *v7;
  uint64_t v8;
  unsigned __int8 *v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetVirtualToApduTrans");
  sub_21988EDF4(v11, &v10);
  v3 = (uint64_t)v10;
  if (!v10)
  {
    v4 = 255;
    goto LABEL_15;
  }
  if (a2 != 168)
  {
    v4 = 147;
    goto LABEL_15;
  }
  if (v10[2937] == 1 || v10[2938] == 1 || v10[2944] == 1)
  {
    if (v10[697] == 1)
    {
      v4 = 0;
      *(_DWORD *)(*((_QWORD *)v10 + 64) + 12) = *((_DWORD *)v10 + 131);
      goto LABEL_15;
    }
    *((_DWORD *)v10 + 130) = 1;
    v5 = off_2550A3868;
  }
  else
  {
    if (*v10 == v10[1])
    {
      v4 = 0;
      goto LABEL_15;
    }
    v5 = off_2550A38D8;
  }
  *(_QWORD *)(v3 + 2912) = v5;
  *(_BYTE *)(v3 + 2904) = 0;
  *(_BYTE *)(v3 + 2906) = 0;
  v6 = *v5;
  if (*v5)
  {
    LOBYTE(v6) = 0;
    v7 = (uint64_t *)(v5 + 2);
    do
    {
      LOBYTE(v6) = (_BYTE)v6 + 1;
      v8 = *v7;
      v7 += 2;
    }
    while (v8);
  }
  *(_BYTE *)(v3 + 2905) = (_BYTE)v6;
  v4 = sub_2198655FC(v3, 0, 0);
LABEL_15:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetVirtualToApduTrans");
  return v4;
}

uint64_t sub_2198A770C(uint64_t a1, uint64_t a2, uint64_t a3, _OWORD *a4)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  __int128 v8;
  __int128 v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSETransceiveTrans");
  sub_21988EDF4(v12, &v11);
  v5 = 255;
  if (a4 && v11)
  {
    v6 = sub_2198DD268(v11);
    if ((_DWORD)v6)
    {
      v5 = v6;
      sub_219850628(0, (unsigned int *)&v12, 4u, 2u, (uint64_t)"phLibNfc_eSE_Transceive: Stack BUSY");
    }
    else
    {
      v7 = v11;
      v9 = a4[1];
      v8 = a4[2];
      *(_OWORD *)(v11 + 560) = *a4;
      *(_OWORD *)(v7 + 576) = v9;
      *(_OWORD *)(v7 + 592) = v8;
      v5 = sub_2198DC908(v7);
    }
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSETransceiveTrans");
  return v5;
}

uint64_t sub_2198A77DC(uint64_t a1, int a2)
{
  _BYTE *v3;
  uint64_t v4;
  char v5;
  uint64_t *v6;
  uint64_t v7;
  unsigned __int8 *v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetApduToApduTrans");
  sub_21988EDF4(v10, &v9);
  v3 = v9;
  if (v9)
  {
    if (a2 == 168)
    {
      if (*v9 == v9[1])
      {
        v4 = 0;
      }
      else
      {
        *((_QWORD *)v9 + 364) = off_2550A38D8;
        v3[2904] = 0;
        v3[2906] = 0;
        v5 = (char)off_2550A38D8[0];
        if (off_2550A38D8[0])
        {
          v5 = 0;
          v6 = &qword_2550A38E8;
          do
          {
            ++v5;
            v7 = *v6;
            v6 += 2;
          }
          while (v7);
        }
        v3[2905] = v5;
        v4 = sub_2198655FC((uint64_t)v3, 0, 0);
      }
    }
    else
    {
      v4 = 147;
    }
  }
  else
  {
    v4 = 255;
  }
  sub_219850808(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetApduToApduTrans");
  return v4;
}

uint64_t sub_2198A78CC(uint64_t a1, int a2)
{
  uint64_t (**v3)();
  uint64_t v4;
  uint64_t (*v5)();
  uint64_t *v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetApduToOffTrans");
  sub_21988EDF4(v11, &v10);
  if (v10)
  {
    if (*(_BYTE *)(v10 + 2936) == 1)
      v3 = off_2550A3818;
    else
      v3 = off_2550A38A8;
    sub_219889494(*(unsigned int **)(v10 + 464));
    if (a2 == 164)
    {
      v4 = v10;
      if (*(_BYTE *)(v10 + 2937) == 1 || *(_BYTE *)(v10 + 2938) == 1 || *(_BYTE *)(v10 + 2944) == 1)
      {
        *(_BYTE *)(v10 + 1) = 1;
        v3 = off_2550A38D8;
      }
      *(_DWORD *)(v4 + 520) = 0;
      *(_QWORD *)(v4 + 2912) = v3;
      *(_BYTE *)(v4 + 2904) = 0;
      *(_BYTE *)(v4 + 2906) = 0;
      v5 = *v3;
      if (*v3)
      {
        LOBYTE(v5) = 0;
        v6 = (uint64_t *)(v3 + 2);
        do
        {
          LOBYTE(v5) = (_BYTE)v5 + 1;
          v7 = *v6;
          v6 += 2;
        }
        while (v7);
      }
      *(_BYTE *)(v4 + 2905) = (_BYTE)v5;
      v8 = sub_2198655FC(v4, 0, 0);
    }
    else
    {
      v8 = 147;
    }
  }
  else
  {
    v8 = 255;
  }
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetApduToOffTrans");
  return v8;
}

uint64_t sub_2198A79F8(uint64_t a1)
{
  uint64_t v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetApduToPwrOffTrans");
  sub_21988EDF4(v8, &v7);
  v1 = v7;
  if (v7)
  {
    *(_BYTE *)(v7 + 1) = 1;
    *(_DWORD *)(v1 + 520) = 0;
    *(_QWORD *)(v1 + 2912) = off_2550A3868;
    *(_BYTE *)(v1 + 2904) = 0;
    *(_BYTE *)(v1 + 2906) = 0;
    v2 = (char)off_2550A3868[0];
    if (off_2550A3868[0])
    {
      v2 = 0;
      v3 = off_2550A3878;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    *(_BYTE *)(v1 + 2905) = v2;
    v5 = sub_2198655FC(v1, 0, 0);
  }
  else
  {
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetApduToPwrOffTrans");
  return v5;
}

uint64_t sub_2198A7AC4(uint64_t a1, int a2)
{
  uint64_t v3;
  uint64_t v4;
  uint64_t (**v5)();
  uint64_t (*v6)();
  uint64_t *v7;
  uint64_t v8;
  unsigned __int8 *v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetApduToVirtualTrans");
  sub_21988EDF4(v11, &v10);
  v3 = (uint64_t)v10;
  if (!v10)
  {
    v4 = 255;
    goto LABEL_15;
  }
  if (a2 != 167)
  {
    v4 = 147;
    goto LABEL_15;
  }
  if (v10[2937] == 1 || v10[2938] == 1 || v10[2944] == 1)
  {
    if (v10[697] == 1)
    {
LABEL_7:
      v4 = 0;
      *(_DWORD *)(*((_QWORD *)v10 + 64) + 12) = *((_DWORD *)v10 + 131);
      goto LABEL_15;
    }
    *((_DWORD *)v10 + 130) = 1;
    v5 = off_2550A3868;
  }
  else
  {
    if (*v10 == v10[1])
      goto LABEL_7;
    v5 = off_2550A38D8;
  }
  *(_QWORD *)(v3 + 2912) = v5;
  *(_BYTE *)(v3 + 2904) = 0;
  *(_BYTE *)(v3 + 2906) = 0;
  v6 = *v5;
  if (*v5)
  {
    LOBYTE(v6) = 0;
    v7 = (uint64_t *)(v5 + 2);
    do
    {
      LOBYTE(v6) = (_BYTE)v6 + 1;
      v8 = *v7;
      v7 += 2;
    }
    while (v8);
  }
  *(_BYTE *)(v3 + 2905) = (_BYTE)v6;
  v4 = sub_2198655FC(v3, 0, 0);
LABEL_15:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetApduToVirtualTrans");
  return v4;
}

uint64_t sub_2198A7C00(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  __int128 v8;
  __int128 v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSERawTransceiveTrans");
  sub_21988EDF4(v12, &v11);
  v5 = 255;
  if (a4 && v11)
  {
    v6 = sub_2198DD268(v11);
    if ((_DWORD)v6)
    {
      v5 = v6;
      sub_219850628(0, (unsigned int *)&v12, 4u, 2u, (uint64_t)"phLibNfc_eSE_Transceive: Stack BUSY");
    }
    else
    {
      v5 = sub_2198DD6F0(v11, (unsigned __int8 *)a4);
      if (!(_DWORD)v5)
      {
        v7 = v11;
        v9 = *(_OWORD *)(a4 + 16);
        v8 = *(_OWORD *)(a4 + 32);
        *(_OWORD *)(v11 + 608) = *(_OWORD *)a4;
        *(_OWORD *)(v7 + 624) = v9;
        *(_OWORD *)(v7 + 640) = v8;
        v5 = sub_2198DD8A0(v7);
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSERawTransceiveTrans");
  return v5;
}

uint64_t sub_2198A7CE4(uint64_t a1)
{
  uint64_t v1;
  uint64_t v2;
  uint64_t v3;
  int v4;
  int v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSEGetAtrTrans");
  sub_21988EDF4(v9, &v8);
  if (!v8)
    goto LABEL_9;
  v1 = *(_QWORD *)(v8 + 464);
  if (!v1)
    goto LABEL_9;
  v2 = sub_2198DD268(v8);
  if (!(_DWORD)v2)
  {
    v4 = *(unsigned __int8 *)(v1 + 816);
    if (v4 != 255)
    {
      v5 = *(unsigned __int8 *)(v1 + 817);
      if (v5 != 255)
      {
        v6 = v8;
        *(_BYTE *)(v8 + 706) = 0;
        v3 = sub_21988CC18(*(_QWORD *)(v6 + 464), v5, 1u, v4, (uint64_t)sub_2198E0AAC, v6);
        goto LABEL_10;
      }
    }
    sub_219850628(0, (unsigned int *)&v9, 4u, 1u, (uint64_t)"phLibNfc_SM_SE_eSEGetAtrTrans:Failed, Pipe Info not Avialable");
LABEL_9:
    v3 = 255;
    goto LABEL_10;
  }
  v3 = v2;
  sub_219850628(0, (unsigned int *)&v9, 4u, 2u, (uint64_t)"phLibNfc_SM_SE_eSEGetAtrTrans: Stack BUSY");
LABEL_10:
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eSEGetAtrTrans");
  return v3;
}

uint64_t sub_2198A7DE8(uint64_t a1)
{
  uint64_t v1;
  uint64_t v2;
  char v3;
  uint64_t *v4;
  uint64_t v5;
  _BYTE *v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetPwrOffToPwrOffTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (uint64_t)v7;
  if (v7)
  {
    if (*v7)
    {
      v2 = 0;
    }
    else
    {
      v7[1] = 1;
      *(_QWORD *)(v1 + 2912) = off_2550A38D8;
      *(_BYTE *)(v1 + 2904) = 0;
      *(_BYTE *)(v1 + 2906) = 0;
      v3 = (char)off_2550A38D8[0];
      if (off_2550A38D8[0])
      {
        v3 = 0;
        v4 = &qword_2550A38E8;
        do
        {
          ++v3;
          v5 = *v4;
          v4 += 2;
        }
        while (v5);
      }
      *(_BYTE *)(v1 + 2905) = v3;
      v2 = sub_2198655FC(v1, 0, 0);
    }
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetPwrOffToPwrOffTrans");
  return v2;
}

uint64_t sub_2198A7EC0(uint64_t a1)
{
  uint64_t v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetPwrOffToVirtualTrans");
  sub_21988EDF4(v8, &v7);
  v1 = v7;
  if (v7)
  {
    *(_BYTE *)(v7 + 1) = 1;
    *(_DWORD *)(v1 + 520) = 1;
    *(_QWORD *)(v1 + 2912) = off_2550A3868;
    *(_BYTE *)(v1 + 2904) = 0;
    *(_BYTE *)(v1 + 2906) = 0;
    v2 = (char)off_2550A3868[0];
    if (off_2550A3868[0])
    {
      v2 = 0;
      v3 = off_2550A3878;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    *(_BYTE *)(v1 + 2905) = v2;
    v5 = sub_2198655FC(v1, 0, 0);
  }
  else
  {
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetPwrOffToVirtualTrans");
  return v5;
}

uint64_t sub_2198A7F8C(uint64_t a1)
{
  uint64_t v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetPwrOffToApduTrans");
  sub_21988EDF4(v8, &v7);
  v1 = v7;
  if (v7)
  {
    *(_BYTE *)(v7 + 1) = 0;
    *(_DWORD *)(v1 + 520) = 1;
    *(_QWORD *)(v1 + 2912) = off_2550A3868;
    *(_BYTE *)(v1 + 2904) = 0;
    *(_BYTE *)(v1 + 2906) = 0;
    v2 = (char)off_2550A3868[0];
    if (off_2550A3868[0])
    {
      v2 = 0;
      v3 = off_2550A3878;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    *(_BYTE *)(v1 + 2905) = v2;
    v5 = sub_2198655FC(v1, 0, 0);
  }
  else
  {
    v5 = 255;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_eModeSetPwrOffToApduTrans");
  return v5;
}

uint64_t sub_2198A8058(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  char v7;
  char v8;
  int v9;
  BOOL v10;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  int v16;
  BOOL v17;
  uint64_t v18;
  uint64_t v19;
  _BYTE *v20;
  _BYTE *v21;
  char v22;
  uint64_t (**v23)();
  uint64_t (*v24)();
  char v25;
  uint64_t v26;
  uint64_t v27;
  uint64_t v28;
  int v29;
  uint64_t v30;
  uint64_t v31;

  v30 = 0;
  v31 = a1;
  v29 = 8;
  v27 = 0;
  v28 = 0;
  v26 = 0;
  sub_219850718(0, (unsigned int *)&v31, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eUserFwDnldTrans");
  v6 = 0;
  v7 = 1;
  while (1)
  {
    v8 = v7;
    if (*((_QWORD *)&unk_253E46700 + 14 * v6) == v31)
      break;
    v7 = 0;
    v6 = 1;
    if ((v8 & 1) == 0)
    {
      v9 = 255;
      goto LABEL_6;
    }
  }
  v9 = *((_DWORD *)&unk_253E46700 + 28 * v6 + 2);
LABEL_6:
  sub_21988ED38(v31, &v29);
  sub_21988EB80(v31, &v30);
  sub_21988F744(v31, &v26);
  if (!v30 || !*(_QWORD *)(v30 + 16))
  {
    a3 = 1;
    sub_219850628(0, (unsigned int *)&v31, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlFwDnldTrans: Invalid parameter");
    goto LABEL_20;
  }
  if (!v26)
  {
    if (*(_DWORD *)(v30 + 192) != 1)
    {
      a3 = phTmlNfc_IoCtl();
      v10 = (_DWORD)a3 == 0;
      goto LABEL_10;
    }
    v12 = phTmlNfc_IoCtl();
    if ((_DWORD)v12)
    {
      a3 = v12;
    }
    else
    {
      a3 = phTmlNfc_IoCtl();
      sub_219886334(0, (unsigned int *)&v31, 4u, 3u, (uint64_t)"phLibNfc_SM_Dnld_eUserFwDnldTrans: SPMI Reset Client Retry Status =");
      if (!(_DWORD)a3)
      {
        phOsalNfc_Delay();
        v10 = 0;
        goto LABEL_12;
      }
    }
  }
  v10 = 0;
LABEL_10:
  if ((_DWORD)a3 != 179 && (_DWORD)a3)
  {
    sub_219850628(0, (unsigned int *)&v31, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlFwDnldTrans: Failed");
    a3 = 255;
    goto LABEL_20;
  }
LABEL_12:
  if ((v29 & 0xFFFFFFFD) != 4)
  {
    a3 = phTmlNfc_ConfigHsuBaudRate();
    goto LABEL_25;
  }
  if (v9 != 1)
  {
LABEL_25:
    if ((_DWORD)a3 != 179 && (_DWORD)a3)
      goto LABEL_40;
    goto LABEL_27;
  }
  LODWORD(a3) = phTmlNfc_IoCtl();
  sub_219886334(0, (unsigned int *)&v31, 4u, 3u, (uint64_t)"phLibNfc_SM_Dnld_eUserFwDnldTrans: Assert Wakeup Status=");
  if ((_DWORD)a3 == 179)
  {
    sub_219850628(0, (unsigned int *)&v31, 4u, 4u, (uint64_t)"phLibNfc_SM_Dnld_eUserFwDnldTrans: NFCSTATUS_SPMI_NACK1");
    phOsalNfc_Delay();
    LODWORD(a3) = phTmlNfc_IoCtl();
    sub_219886334(0, (unsigned int *)&v31, 4u, 3u, (uint64_t)"phLibNfc_SM_Dnld_eUserFwDnldTrans: Assert Wakeup Status=");
    if ((_DWORD)a3 == 179)
    {
      sub_219850628(0, (unsigned int *)&v31, 4u, 4u, (uint64_t)"phLibNfc_SM_Dnld_eUserFwDnldTrans: NFCSTATUS_SPMI_NACK2");
      sub_219850628(0, (unsigned int *)&v31, 4u, 4u, (uint64_t)"phLibNfc_SM_Dnld_eUserFwDnldTrans: Update Client-ID to Secondary Client                                ID(0x0B)");
      LODWORD(a3) = phTmlNfc_ConfigureSpmi();
    }
  }
  if ((_DWORD)a3)
  {
    a3 = 255;
LABEL_40:
    sub_219851790(0, (unsigned int *)&v31, 4u, 1u, (uint64_t)"IoctlFwDnldTrans: TML HSU Baud rate failed, Status");
LABEL_58:
    v25 = !v10;
    if ((_DWORD)a3 == 13)
      v25 = 1;
    if ((v25 & 1) == 0)
      phTmlNfc_IoCtl();
    goto LABEL_20;
  }
LABEL_27:
  v13 = v31;
  *(_DWORD *)(v30 + 96) = 2;
  sub_2198C1984(v13, v29);
  v15 = v30;
  v14 = v31;
  *(_BYTE *)(v30 + 68) = 0;
  *(_BYTE *)(v15 + 70) = 0;
  *(_WORD *)(v15 + 78) = 0;
  *(_BYTE *)(v15 + 76) = 0;
  *(_BYTE *)(v15 + 836) = 0;
  *(_DWORD *)(v15 + 64) = 16711680;
  v16 = sub_219873404(v14);
  if (v16)
    LODWORD(a3) = v16;
  sub_21988EDF4(v31, &v28);
  sub_21988F460(v31, &v27);
  if (v27)
    v17 = v28 == 0;
  else
    v17 = 1;
  if (v17)
    LODWORD(a3) = 255;
  if ((_DWORD)a3 != 179 && (_DWORD)a3)
  {
    sub_219850628(0, (unsigned int *)&v31, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlFwDnldTrans: Failed");
    a3 = 255;
LABEL_51:
    if (v28)
    {
      if (!*(_BYTE *)(v28 + 6026) && !*(_BYTE *)(v28 + 6029) && !*(_BYTE *)(v28 + 6030) && !*(_BYTE *)(v28 + 6027))
      {
        sub_21986BE40(v31);
        *(_BYTE *)(v30 + 67) = 0;
        phOsalNfc_FreeMemory();
        v28 = 0;
        sub_21988EEB4(v31, 0);
      }
    }
    else
    {
      sub_21986BE40(v31);
    }
    goto LABEL_58;
  }
  sub_219850628(0, (unsigned int *)&v31, 4u, 4u, (uint64_t)"Firmware Load Library SUCCESS, Now initiating Firmware Download Sequence!!!");
  v18 = v30;
  *(_BYTE *)(v30 + 144) = 0;
  *(_QWORD *)(v18 + 184) = a4;
  if ((_DWORD)a3 == 179 && *(_DWORD *)(v18 + 192) == 1)
  {
    *(_QWORD *)(v28 + 3168) = sub_219876DD0;
    v19 = sub_219878554(*(unsigned int **)(v27 + 56));
  }
  else
  {
    v20 = (_BYTE *)v28;
    v21 = (_BYTE *)(v28 + 6026);
    *(_QWORD *)(v28 + 2912) = off_2550A2D68;
    v20[2904] = 0;
    v20[2906] = 0;
    v22 = (char)off_2550A2D68[0];
    if (off_2550A2D68[0])
    {
      v22 = 0;
      v23 = off_2550A2D78;
      do
      {
        ++v22;
        v24 = *v23;
        v23 += 2;
      }
      while (v24);
    }
    v20[2905] = v22;
    if (*v21 || v21[3] || v21[1] != 1 && v21[4] != 1)
      v19 = sub_2198655FC((uint64_t)v20, 0, 0);
    else
      v19 = sub_219878254((uint64_t)v20);
  }
  a3 = v19;
  if ((_DWORD)v19 != 13)
    goto LABEL_51;
LABEL_20:
  sub_219850808(0, (unsigned int *)&v31, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eUserFwDnldTrans");
  return a3;
}

uint64_t sub_2198A858C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  char v7;
  char v8;
  BOOL v9;
  uint64_t v10;
  int v11;
  uint64_t v12;
  uint64_t v13;
  BOOL v14;
  int v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  char v19;
  uint64_t (**v20)();
  uint64_t (*v21)();
  char v22;
  uint64_t v24;
  uint64_t v25;
  int v26;
  _BYTE *v27;
  uint64_t v28;
  uint64_t v29;

  v28 = 0;
  v29 = a1;
  v27 = 0;
  v26 = 8;
  v24 = 0;
  v25 = 0;
  sub_219850718(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eUserGetDieIdTrans");
  sub_21988EB80(v29, &v28);
  sub_21988ED38(v29, &v26);
  v6 = 0;
  v7 = 1;
  do
  {
    v8 = v7;
    if (*((_QWORD *)&unk_253E46700 + 14 * v6) == v29)
      break;
    v7 = 0;
    v6 = 1;
  }
  while ((v8 & 1) != 0);
  sub_21988F744(v29, &v24);
  if (!a4 || !v28)
  {
    a3 = 1;
    sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlGetDieIdTrans: Invalid parameter");
    goto LABEL_51;
  }
  if (!v24)
  {
    if (*(_DWORD *)(v28 + 192) != 1)
    {
      a3 = phTmlNfc_IoCtl();
      v9 = (_DWORD)a3 == 0;
      goto LABEL_8;
    }
    v18 = phTmlNfc_IoCtl();
    if ((_DWORD)v18)
    {
      a3 = v18;
    }
    else
    {
      a3 = phTmlNfc_IoCtl();
      sub_219886334(0, (unsigned int *)&v29, 4u, 3u, (uint64_t)"phLibNfc_SM_Dnld_eUserGetDieIdTrans: SPMI Reset Client Retry Status =");
      if (!(_DWORD)a3)
      {
        phOsalNfc_Delay();
        v9 = 0;
        goto LABEL_10;
      }
    }
  }
  v9 = 0;
LABEL_8:
  if ((_DWORD)a3 != 179 && (_DWORD)a3)
  {
    sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlGetDieIdTrans: Failed");
    a3 = 255;
    goto LABEL_51;
  }
LABEL_10:
  if ((v26 & 0xFFFFFFFD) != 4)
    a3 = phTmlNfc_ConfigHsuBaudRate();
  if ((_DWORD)a3 != 179 && (_DWORD)a3)
  {
    sub_219851790(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"IoctlGetDieIdTrans : TML Config Baudrate failed status");
LABEL_47:
    v22 = !v9;
    if ((_DWORD)a3 == 13)
      v22 = 1;
    if ((v22 & 1) == 0)
      phTmlNfc_IoCtl();
    goto LABEL_51;
  }
  sub_2198C1984(v29, v26);
  v10 = v28;
  *(_WORD *)(v28 + 67) = 0;
  *(_WORD *)(v10 + 64) = 0;
  *(_BYTE *)(v10 + 836) = 0;
  *(_BYTE *)(v10 + 70) = 0;
  *(_QWORD *)(v10 + 56) = 0;
  phOsalNfc_SetMemory();
  v11 = sub_219873404(v29);
  if (v11)
    LODWORD(a3) = v11;
  sub_21988EDF4(v29, &v27);
  sub_21988F460(v29, &v25);
  v12 = (uint64_t)v27;
  v13 = v25;
  if (v25)
    v14 = v27 == 0;
  else
    v14 = 1;
  if (v14)
    v15 = 255;
  else
    v15 = a3;
  if (v15 != 179 && v15)
  {
    sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlGetDieIdTrans: Failed");
    a3 = 255;
    goto LABEL_47;
  }
  v16 = v28;
  *(_QWORD *)(v28 + 56) = v28 + 160;
  if (v15 == 179 && *(_DWORD *)(v16 + 192) == 1)
  {
    *(_QWORD *)(v12 + 3168) = sub_219876F80;
    v17 = sub_219878554(*(unsigned int **)(v13 + 56));
  }
  else
  {
    *(_QWORD *)(v12 + 2912) = &qword_2550A2EB8;
    *(_BYTE *)(v12 + 2904) = 0;
    *(_BYTE *)(v12 + 2906) = 0;
    v19 = qword_2550A2EB8;
    if (qword_2550A2EB8)
    {
      v19 = 0;
      v20 = off_2550A2EC8;
      do
      {
        ++v19;
        v21 = *v20;
        v20 += 2;
      }
      while (v21);
    }
    *(_BYTE *)(v12 + 2905) = v19;
    if (*(_BYTE *)(v12 + 6026) || *(_BYTE *)(v12 + 6029) || *(_BYTE *)(v12 + 6027) != 1 && *(_BYTE *)(v12 + 6030) != 1)
      v17 = sub_2198655FC(v12, 0, 0);
    else
      v17 = sub_219878254(v12);
  }
  a3 = v17;
  if ((_DWORD)v17 != 13)
  {
    if (!v27[6026] && !v27[6029] && !v27[6030] && !v27[6027])
    {
      sub_21986BE40(v29);
      *(_BYTE *)(v28 + 67) = 0;
      phOsalNfc_FreeMemory();
      v27 = 0;
      sub_21988EEB4(v29, 0);
    }
    goto LABEL_47;
  }
LABEL_51:
  sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eUserGetDieIdTrans");
  return a3;
}

uint64_t sub_2198A8998(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v5;
  char v6;
  char v7;
  int v8;
  int v9;
  _BOOL4 v10;
  uint64_t v11;
  uint64_t v12;
  int v13;
  _BYTE *v14;
  uint64_t v15;
  BOOL v16;
  int v17;
  uint64_t v18;
  _BYTE *v19;
  char v20;
  uint64_t *v21;
  uint64_t v22;
  int v23;
  int v25;
  uint64_t v26;
  uint64_t v27;
  uint64_t v28;
  uint64_t v29;
  uint64_t v30;

  v29 = 0;
  v30 = a1;
  v27 = 0;
  v28 = 0;
  v26 = 0;
  v25 = 8;
  sub_219850718(0, (unsigned int *)&v30, 4u, 5u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans");
  sub_21988EB80(v30, &v27);
  sub_21988ED38(v30, &v25);
  v5 = 0;
  v6 = 1;
  while (1)
  {
    v7 = v6;
    if (*((_QWORD *)&unk_253E46700 + 14 * v5) == v30)
      break;
    v6 = 0;
    v5 = 1;
    if ((v7 & 1) == 0)
    {
      v8 = 255;
      v9 = 255;
      goto LABEL_6;
    }
  }
  v9 = 0;
  v8 = *((_DWORD *)&unk_253E46700 + 28 * v5 + 2);
LABEL_6:
  sub_21988F744(v30, &v26);
  if (!a4 || !v27)
  {
    v11 = 1;
    sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans Invalid parameter");
    goto LABEL_61;
  }
  sub_21988EDF4(v30, &v29);
  if (!v29)
  {
    phTmlNfc_ReadAbort();
    phTmlNfc_FlushTxRxBuffers();
    if (sub_21988F8B8(v30) == 1)
    {
      phTmlNfc_WriteAbort();
      sub_21988F804(v30, 0);
    }
    if (!v26)
    {
      if (*(_DWORD *)(v27 + 192) != 1)
      {
        v9 = phTmlNfc_IoCtl();
        v10 = v9 == 0;
        goto LABEL_13;
      }
      v23 = phTmlNfc_IoCtl();
      if (v23)
      {
        v9 = v23;
      }
      else
      {
        v9 = phTmlNfc_IoCtl();
        sub_219886334(0, (unsigned int *)&v30, 4u, 3u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: SPMI Reset Client Retry Status =");
        if (!v9)
        {
          phOsalNfc_Delay();
          v10 = 0;
          goto LABEL_15;
        }
      }
    }
  }
  v10 = 0;
LABEL_13:
  if (v9 != 179 && v9)
  {
    sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: Failed");
    v11 = 255;
    goto LABEL_61;
  }
LABEL_15:
  sub_219850628(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: NFCSTATUS_SPMI_NACK1");
  if ((v25 & 0xFFFFFFFD) == 4)
  {
    if (v8 == 1)
    {
      v9 = phTmlNfc_IoCtl();
      sub_219886334(0, (unsigned int *)&v30, 4u, 3u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: Assert Wakeup Status=");
      if (v9 == 179)
      {
        sub_219850628(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: NFCSTATUS_SPMI_NACK2");
        sub_219850628(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: Update Client-ID to Secondary Client ID(0x0B)");
        phOsalNfc_Delay();
        v9 = phTmlNfc_IoCtl();
        sub_219886334(0, (unsigned int *)&v30, 4u, 3u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: Assert Wakeup Status=");
        if (v9 == 179)
        {
          sub_219850628(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: NFCSTATUS_SPMI_NACK2");
          v9 = phTmlNfc_ConfigureSpmi();
        }
      }
      if (v9)
        goto LABEL_39;
      goto LABEL_26;
    }
  }
  else
  {
    v9 = phTmlNfc_ConfigHsuBaudRate();
  }
  if (v9 == 179 || !v9)
  {
LABEL_26:
    sub_2198C1984(v30, v25);
    v12 = v27;
    *(_BYTE *)(v27 + 65) = 0;
    *(_BYTE *)(v12 + 67) = 0;
    v13 = sub_219873404(v30);
    if (v13)
      v9 = v13;
    sub_21988EDF4(v30, &v29);
    sub_21988F460(v30, &v28);
    v15 = v28;
    v14 = (_BYTE *)v29;
    if (v28)
      v16 = v29 == 0;
    else
      v16 = 1;
    if (v16)
      v17 = 255;
    else
      v17 = v9;
    if (!v17)
      goto LABEL_40;
    if (v17 != 179)
    {
      sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans: Failed");
      v11 = 255;
LABEL_52:
      if (v29)
      {
        if (!*(_BYTE *)(v29 + 6026) && !*(_BYTE *)(v29 + 6029) && !*(_BYTE *)(v29 + 6030) && !*(_BYTE *)(v29 + 6027))
        {
          sub_21986BE40(v30);
          *(_BYTE *)(v27 + 67) = 0;
          phOsalNfc_FreeMemory();
          v29 = 0;
          sub_21988EEB4(v30, 0);
        }
      }
      else
      {
        sub_21986BE40(v30);
      }
      goto LABEL_59;
    }
    if (*(_DWORD *)(v27 + 192) == 1)
    {
      *(_QWORD *)(v29 + 3168) = sub_219876EA8;
      v18 = sub_219878554(*(unsigned int **)(v15 + 56));
    }
    else
    {
LABEL_40:
      v19 = (_BYTE *)(v29 + 6026);
      *(_QWORD *)(v29 + 2912) = gphLibNfc_GetFwVersionSequence;
      v14[2904] = 0;
      v14[2906] = 0;
      v20 = (char)gphLibNfc_GetFwVersionSequence[0];
      if (gphLibNfc_GetFwVersionSequence[0])
      {
        v20 = 0;
        v21 = &qword_2550A0A88;
        do
        {
          ++v20;
          v22 = *v21;
          v21 += 2;
        }
        while (v22);
      }
      v14[2905] = v20;
      if (*v19 || v14[6029] || v14[6027] != 1 && v14[6030] != 1)
        v18 = sub_2198655FC((uint64_t)v14, 0, 0);
      else
        v18 = sub_219878254((uint64_t)v14);
    }
    v11 = v18;
    if ((_DWORD)v18 == 13)
      goto LABEL_61;
    goto LABEL_52;
  }
LABEL_39:
  sub_219851790(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"GetFwVersionTrans- Set Default Baud Rate FAILED, Status");
  v11 = 255;
LABEL_59:
  if (v10)
    phTmlNfc_IoCtl();
LABEL_61:
  sub_219850808(0, (unsigned int *)&v30, 4u, 5u, (uint64_t)"phLibNfc_SM_GetFwVersionTrans");
  return v11;
}

uint64_t sub_2198A8ED8(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t v4;
  char v5;
  char v6;
  int v7;
  const char *v8;
  uint64_t v9;
  BOOL v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  unsigned int *v17;
  uint64_t v18;
  _BYTE *v19;
  _BYTE *v20;
  char v21;
  uint64_t (**v22)();
  uint64_t (*v23)();
  int v24;
  uint64_t v25;
  uint64_t v26;
  uint64_t Memory;
  uint64_t v28;
  uint64_t v29;

  v28 = 0;
  v29 = a1;
  v26 = 0;
  Memory = 0;
  v25 = 0;
  v24 = 8;
  sub_219850718(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_SM_GetMemDumpTrans");
  sub_21988EB80(v29, &v26);
  sub_21988EDF4(v29, &Memory);
  sub_21988ED38(v29, &v24);
  sub_21988F744(v29, &v25);
  v4 = 0;
  v5 = 1;
  while (1)
  {
    v6 = v5;
    if (*((_QWORD *)&unk_253E46700 + 14 * v4) == v29)
      break;
    v5 = 0;
    v4 = 1;
    if ((v6 & 1) == 0)
    {
      v7 = 255;
      goto LABEL_6;
    }
  }
  v7 = *((_DWORD *)&unk_253E46700 + 28 * v4 + 2);
LABEL_6:
  if (!v26)
  {
    sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"phLibNfc_SM_GetMemDumpTrans: Invalid IOCTL context");
    goto LABEL_13;
  }
  if ((v24 & 0xFFFFFFFD) != 4)
    a3 = phTmlNfc_ConfigHsuBaudRate();
  if (a3)
  {
    v8 = "GetMemDumpTrans:Set Default Baud Rate FAILED, Status";
LABEL_11:
    sub_219851790(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)v8);
LABEL_13:
    v9 = 255;
    goto LABEL_14;
  }
  if (v25)
  {
    v11 = 0;
    v9 = 0;
    goto LABEL_17;
  }
  if (*(_DWORD *)(v26 + 192) == 1)
  {
    v13 = phTmlNfc_IoCtl();
    if ((_DWORD)v13)
    {
      v9 = v13;
    }
    else
    {
      v9 = phTmlNfc_IoCtl();
      sub_219886334(0, (unsigned int *)&v29, 4u, 3u, (uint64_t)"phLibNfc_SM_GetMemDumpTrans: SPMI Reset Client Retry Status =");
      if (!(_DWORD)v9)
      {
        phOsalNfc_Delay();
        v11 = 0;
        goto LABEL_17;
      }
    }
    v11 = 0;
  }
  else
  {
    v9 = phTmlNfc_IoCtl();
    v11 = (_DWORD)v9 == 0;
  }
  if ((_DWORD)v9 != 179 && (_DWORD)v9)
  {
    v8 = "NFCC NCI Mode Failed!!,phTmlNfc_IoCtl Ret Status =";
    goto LABEL_11;
  }
LABEL_17:
  v12 = Memory;
  if (!Memory)
  {
    Memory = phOsalNfc_GetMemory();
    if (Memory)
    {
      sub_219885FF8(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"####phLibNfc_SM_GetMemDumpTrans: DriverHandle");
      sub_219885FF8(0, (unsigned int *)&v29, 4u, 4u, (uint64_t)"####LIBNFC context");
      phOsalNfc_SetMemory();
      sub_21988EEB4(v29, Memory);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"Failed to allocate memory, Insufficient Resources");
      v9 = 12;
    }
    v12 = Memory;
    if (!Memory)
      goto LABEL_56;
  }
  if ((_DWORD)v9 != 179 && (_DWORD)v9)
  {
LABEL_56:
    if (v11)
      phTmlNfc_IoCtl();
    goto LABEL_14;
  }
  *(_WORD *)v12 = 514;
  v14 = v29;
  *(_QWORD *)(v12 + 2952) = v29;
  *(_QWORD *)(v12 + 19360) = v14;
  *(_DWORD *)(v12 + 19368) = v7;
  v15 = v26;
  *(_DWORD *)(v12 + 3176) = *(_DWORD *)(v26 + 192);
  *(_DWORD *)(v12 + 3056) = 2;
  *(_BYTE *)(v15 + 65) = 0;
  *(_BYTE *)(v15 + 67) = 1;
  sub_2198C1984(v14, v24);
  sub_21988F460(v29, &v28);
  if (v28 && !v25 && sub_219905DA0(*(_QWORD *)(v28 + 56)) != 13)
  {
    sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"phLibNfc_VerifyCtxt : Initial TML read request failed!!");
    v9 = 255;
  }
  if ((_DWORD)v9 == 179 || (_DWORD)v9 == 0)
  {
    if (v28)
    {
      v17 = *(unsigned int **)(v28 + 56);
      if (v17)
      {
        if ((_DWORD)v9 == 179 && *(_DWORD *)(v26 + 192) == 1)
        {
          *(_QWORD *)(Memory + 3168) = sub_219877058;
          v18 = sub_219878554(v17);
        }
        else
        {
          v19 = (_BYTE *)Memory;
          v20 = (_BYTE *)(Memory + 6026);
          *(_QWORD *)(Memory + 2912) = gphLibNfc_GetMemDumpSequence;
          v19[2904] = 0;
          v19[2906] = 0;
          v21 = (char)gphLibNfc_GetMemDumpSequence[0];
          if (gphLibNfc_GetMemDumpSequence[0])
          {
            v21 = 0;
            v22 = off_2550A0A58;
            do
            {
              ++v21;
              v23 = *v22;
              v22 += 2;
            }
            while (v23);
          }
          v19[2905] = v21;
          if (*v20 || v20[3] || v20[1] != 1 && v20[4] != 1)
            v18 = sub_2198655FC((uint64_t)v19, 0, 0);
          else
            v18 = sub_219878254((uint64_t)v19);
        }
        v9 = v18;
      }
    }
  }
  if ((_DWORD)v9 != 13)
  {
    if (!*(_BYTE *)(Memory + 6026)
      && !*(_BYTE *)(Memory + 6029)
      && !*(_BYTE *)(Memory + 6030)
      && !*(_BYTE *)(Memory + 6027))
    {
      sub_21986BE40(v29);
      sub_21988F460(v29, &v28);
      sub_2198C1BDC(v28);
      phOsalNfc_FreeMemory();
      Memory = 0;
      sub_21988EEB4(v29, 0);
    }
    sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)"phLibNfc_SM_GetMemDumpTrans failed");
    goto LABEL_56;
  }
LABEL_14:
  sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_SM_GetMemDumpTrans");
  return v9;
}

uint64_t sub_2198A93AC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v4;
  char v5;
  char v6;
  BOOL v7;
  uint64_t v8;
  int v9;
  uint64_t v10;
  uint64_t v11;
  BOOL v12;
  int v13;
  uint64_t v14;
  uint64_t v15;
  const char *v16;
  uint64_t v17;
  char v18;
  uint64_t (**v19)();
  uint64_t (*v20)();
  char v21;
  uint64_t v23;
  uint64_t v24;
  int v25;
  uint64_t v26;
  _BYTE *v27;
  uint64_t v28;

  v27 = 0;
  v28 = a1;
  v26 = 0;
  v25 = 8;
  v23 = 0;
  v24 = 0;
  sub_219850718(0, (unsigned int *)&v28, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetDnldIntgInfoTrans");
  if (!v28)
  {
    a3 = 1;
    sub_219850628(0, (unsigned int *)&v28, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlGetDnldIntgInfoTrans: Invalid parameter");
    goto LABEL_54;
  }
  sub_21988EB80(v28, &v26);
  sub_21988ED38(v28, &v25);
  v4 = 0;
  v5 = 1;
  do
  {
    v6 = v5;
    if (*((_QWORD *)&unk_253E46700 + 14 * v4) == v28)
      break;
    v5 = 0;
    v4 = 1;
  }
  while ((v6 & 1) != 0);
  sub_21988F744(v28, &v23);
  if (!v26)
  {
    v16 = "phLibNfc_SM_IoctlGetDnldIntgInfoTrans: Invalid IOCTL context";
LABEL_34:
    sub_219850628(0, (unsigned int *)&v28, 4u, 1u, (uint64_t)v16);
    a3 = 255;
    goto LABEL_54;
  }
  if (!v23)
  {
    if (*(_DWORD *)(v26 + 192) != 1)
    {
      a3 = phTmlNfc_IoCtl();
      v7 = (_DWORD)a3 == 0;
      goto LABEL_10;
    }
    v17 = phTmlNfc_IoCtl();
    if ((_DWORD)v17)
    {
      a3 = v17;
    }
    else
    {
      a3 = phTmlNfc_IoCtl();
      sub_219886334(0, (unsigned int *)&v28, 4u, 3u, (uint64_t)"phLibNfc_SM_IoctlGetDnldIntgInfoTrans: SPMI Reset Client Retry Status =");
      if (!(_DWORD)a3)
      {
        phOsalNfc_Delay();
        v7 = 0;
        goto LABEL_12;
      }
    }
  }
  v7 = 0;
LABEL_10:
  if ((_DWORD)a3 != 179 && (_DWORD)a3)
  {
    v16 = "phLibNfc_SM_IoctlGetDnldIntgInfoTrans: Failed";
    goto LABEL_34;
  }
LABEL_12:
  if ((v25 & 0xFFFFFFFD) != 4)
    a3 = phTmlNfc_ConfigHsuBaudRate();
  if ((_DWORD)a3 != 179 && (_DWORD)a3)
  {
    sub_219851790(0, (unsigned int *)&v28, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlGetDnldIntgInfoTrans : TML Config Baudrate failed status");
LABEL_50:
    v21 = !v7;
    if ((_DWORD)a3 == 13)
      v21 = 1;
    if ((v21 & 1) == 0)
      phTmlNfc_IoCtl();
    goto LABEL_54;
  }
  sub_2198C1984(v28, v25);
  v8 = v26;
  *(_WORD *)(v26 + 67) = 0;
  *(_BYTE *)(v8 + 836) = 0;
  *(_WORD *)(v8 + 64) = 0;
  *(_BYTE *)(v8 + 70) = 0;
  *(_BYTE *)(v8 + 145) = 0;
  *(_DWORD *)(v8 + 148) = 0;
  *(_QWORD *)(v8 + 56) = 0;
  phOsalNfc_SetMemory();
  v9 = sub_219873404(v28);
  if (v9)
    LODWORD(a3) = v9;
  sub_21988EDF4(v28, &v27);
  sub_21988F460(v28, &v24);
  v10 = (uint64_t)v27;
  v11 = v24;
  if (v24)
    v12 = v27 == 0;
  else
    v12 = 1;
  if (v12)
    v13 = 255;
  else
    v13 = a3;
  if (v13 != 179 && v13)
  {
    sub_219850628(0, (unsigned int *)&v28, 4u, 1u, (uint64_t)"phLibNfc_SM_IoctlGetDnldIntgInfoTrans: Failed");
    a3 = 255;
    goto LABEL_50;
  }
  v14 = v26;
  *(_QWORD *)(v26 + 56) = v26 + 160;
  if (v13 == 179 && *(_DWORD *)(v14 + 192) == 1)
  {
    *(_QWORD *)(v10 + 3168) = sub_219877130;
    v15 = sub_219878554(*(unsigned int **)(v11 + 56));
  }
  else
  {
    *(_QWORD *)(v10 + 2912) = &qword_2550A2F08;
    *(_BYTE *)(v10 + 2904) = 0;
    *(_BYTE *)(v10 + 2906) = 0;
    v18 = qword_2550A2F08;
    if (qword_2550A2F08)
    {
      v18 = 0;
      v19 = off_2550A2F18;
      do
      {
        ++v18;
        v20 = *v19;
        v19 += 2;
      }
      while (v20);
    }
    *(_BYTE *)(v10 + 2905) = v18;
    if (*(_BYTE *)(v10 + 6026) || *(_BYTE *)(v10 + 6029) || *(_BYTE *)(v10 + 6027) != 1 && *(_BYTE *)(v10 + 6030) != 1)
      v15 = sub_2198655FC(v10, 0, 0);
    else
      v15 = sub_219878254(v10);
  }
  a3 = v15;
  if ((_DWORD)v15 != 13)
  {
    if (!v27[6026] && !v27[6029] && !v27[6030] && !v27[6027])
    {
      sub_21986BE40(v28);
      *(_BYTE *)(v26 + 67) = 0;
      phOsalNfc_FreeMemory();
      sub_21988EEB4(v28, 0);
      v27 = 0;
    }
    goto LABEL_50;
  }
LABEL_54:
  sub_219850808(0, (unsigned int *)&v28, 4u, 5u, (uint64_t)"phLibNfc_SM_IoctlGetDnldIntgInfoTrans");
  return a3;
}

uint64_t sub_2198A97C4(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t *v7;
  void (*v8)(uint64_t, uint64_t, uint64_t, uint64_t);
  uint64_t v9;
  _BYTE *v11;
  uint64_t *v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_TransComplete");
  sub_21988EDF4(v13, &v11);
  sub_21988EB80(v13, &v12);
  if (v12)
  {
    if ((_DWORD)a3)
      sub_219886108(v13, a3);
    else
      sub_21988620C(v13, 0);
    switch(a2)
    {
      case 207:
      case 209:
      case 211:
        sub_21986C460(v12, a4, a3);
        break;
      case 208:
        sub_21986BD40((unsigned int *)v12, v11, a3);
        break;
      case 210:
        v7 = v12;
        v8 = (void (*)(uint64_t, uint64_t, uint64_t, uint64_t))v12[3];
        v9 = *v12;
        v12[3] = 0;
        *v7 = 0;
        if (v8)
        {
          sub_219851790(0, (unsigned int *)&v13, 4u, 4u, (uint64_t)"Get Memory Dump:Invoking callback function, wStatus = ");
          sub_219885F70(0, (unsigned int *)&v13, 4u, 10, (uint64_t)"phLibNfc_SM_Dnld_TransComplete");
          v8(v12[1], v9, a4, a3);
        }
        break;
      default:
        break;
    }
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"phLibNfc_SM_Dnld_TransComplete: Invalid IOCTL/LIBNFC context");
    a3 = 255;
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_TransComplete");
  return a3;
}

uint64_t sub_2198A9958(uint64_t a1, uint64_t a2, int a3, int *a4, _DWORD *a5)
{
  uint64_t v8;
  char v9;
  char v10;
  uint64_t v11;
  int v12;
  BOOL v13;
  const char *v14;
  uint64_t v15;
  uint64_t v16;
  int v17;
  int v18;
  BOOL v19;
  BOOL v21;
  uint64_t v22;
  uint64_t v23;
  unsigned int *v24;
  int v25;
  uint64_t v27;
  uint64_t v28;
  uint64_t v29;
  uint64_t v30;
  uint64_t v31;
  int v32;
  uint64_t v33;
  uint64_t v34;
  uint64_t v35;

  v34 = 0;
  v35 = a1;
  v33 = 0;
  v32 = 8;
  v30 = 0;
  v31 = 0;
  sub_219850718(0, (unsigned int *)&v35, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_PwrSmbCfgTrans");
  sub_21988ED38(v35, &v32);
  sub_21988EB80(v35, &v31);
  sub_21988EDF4(v35, &v34);
  sub_21988F460(v35, &v33);
  v8 = 0;
  v9 = 1;
  while (1)
  {
    v10 = v9;
    if (*((_QWORD *)&unk_253E46700 + 14 * v8) == v35)
      break;
    v9 = 0;
    v8 = 1;
    if ((v10 & 1) == 0)
    {
      if (!a5)
        goto LABEL_17;
      goto LABEL_7;
    }
  }
  if (!a5)
  {
LABEL_17:
    sub_219850628(0, (unsigned int *)&v35, 4u, 1u, (uint64_t)"phLibNfc_SM_Dnld_eSE_PwrSmbCfgTrans: Failed");
    v11 = 255;
    goto LABEL_69;
  }
LABEL_7:
  if (!a4 || !v35)
    goto LABEL_17;
  if (!v34 && v31)
  {
    phTmlNfc_ReadAbort();
    phTmlNfc_FlushTxRxBuffers();
    if (sub_21988F8B8(v35) == 1)
    {
      phTmlNfc_WriteAbort();
      sub_21988F804(v35, 0);
    }
    if (*(_DWORD *)(v31 + 192) == 1)
    {
      a3 = phTmlNfc_IoCtl();
      if (!a3)
      {
        a3 = phTmlNfc_IoCtl();
        sub_219886334(0, (unsigned int *)&v35, 4u, 3u, (uint64_t)"phLibNfc_SM_Dnld_eSE_PwrSmbCfgTrans: SPMI Reset Client Retry Status =");
        if (!a3)
          phOsalNfc_Delay();
      }
    }
    else
    {
      a3 = phTmlNfc_IoCtl();
    }
    if ((v32 & 0xFFFFFFFD) != 4)
      a3 = phTmlNfc_ConfigHsuBaudRate();
    if (a3 == 179 || !a3)
    {
      sub_2198C1984(v35, v32);
      *(_BYTE *)(v31 + 67) = 0;
      v12 = sub_219873404(v35);
      sub_21988EDF4(v35, &v34);
      if (v12)
        a3 = v12;
    }
  }
  v13 = a3 == 179 || a3 == 0;
  v14 = "phLibNfc_SM_Dnld_eSE_PwrSmbCfgTrans: Failed";
  if (v13 && v34 && v31)
  {
    sub_21988F744(v35, &v30);
    v15 = v30;
    if (v30)
    {
      v16 = v33;
    }
    else
    {
      v17 = sub_21990766C(v35);
      if (v17)
      {
        v18 = v17;
        sub_219850628(0, (unsigned int *)&v35, 4u, 1u, (uint64_t)"phLibNfc_SM_Dnld_eSE_PwrSmbCfgTrans: Failed to initialize DNLD eSE core context ");
        a3 = v18;
      }
      sub_21988EDF4(v35, &v34);
      sub_21988F460(v35, &v33);
      sub_21988F744(v35, &v30);
      v16 = v33;
      v15 = v30;
      if (v30)
        v19 = v33 == 0;
      else
        v19 = 1;
      if (v19 || v34 == 0)
        a3 = 255;
    }
    v21 = a3 == 179 || a3 == 0;
    v14 = "phLibNfc_SM_Dnld_eSE_PwrSmbCfgTrans: Failed";
    if (v21 && v15 && v16)
    {
      if (*a5 == 2)
      {
        v25 = *a4;
        *(_DWORD *)(v15 + 20) = *a4;
        if (v25 == 1)
        {
          *(_DWORD *)(v15 + 24) = 4178177;
          *(_BYTE *)(v15 + 28) = 0;
        }
        else
        {
          phOsalNfc_SetMemory();
        }
        if (a3 == 179)
        {
          v28 = v31;
          v29 = v34;
          if (*(_DWORD *)(v31 + 192) == 1)
          {
            *(_QWORD *)(v34 + 3168) = phDnldNfc_eSESmbCfgVenResetTimeoutCb;
            v24 = *(unsigned int **)(v33 + 56);
            goto LABEL_76;
          }
        }
        else
        {
          v29 = v34;
          v28 = v31;
        }
        v27 = phLibNfc_DnldEseSmbCfgSeq(v29, v28);
LABEL_79:
        v11 = v27;
        if ((_DWORD)v27 == 13)
          goto LABEL_69;
        goto LABEL_60;
      }
      if (*a5 == 1)
      {
        *(_BYTE *)(v15 + 18) = *(_BYTE *)a4;
        if (a3 == 179)
        {
          v22 = v31;
          v23 = v34;
          if (*(_DWORD *)(v31 + 192) == 1)
          {
            *(_QWORD *)(v34 + 3168) = phDnldNfc_eSEPwrCfgVenResetTimeoutCb;
            v24 = *(unsigned int **)(v16 + 56);
LABEL_76:
            v27 = sub_219878554(v24);
            goto LABEL_79;
          }
        }
        else
        {
          v23 = v34;
          v22 = v31;
        }
        v27 = phLibNfc_DnldEsePwrCfgSeq(v23, v22);
        goto LABEL_79;
      }
      v14 = "phLibNfc_SM_Dnld_eSE_PwrSmbCfgTrans: Invalid config type param";
    }
  }
  sub_219850628(0, (unsigned int *)&v35, 4u, 1u, (uint64_t)v14);
  v11 = 255;
LABEL_60:
  if (v34)
  {
    if (!*(_BYTE *)(v34 + 6026) && !*(_BYTE *)(v34 + 6029) && !*(_BYTE *)(v34 + 6030) && !*(_BYTE *)(v34 + 6027))
    {
      sub_21986BE40(v35);
      if (v31)
        *(_BYTE *)(v31 + 67) = 0;
      phOsalNfc_FreeMemory();
      v34 = 0;
      sub_21988EEB4(v35, 0);
    }
  }
  else
  {
    sub_21986BE40(v35);
  }
LABEL_69:
  sub_219850808(0, (unsigned int *)&v35, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_PwrSmbCfgTrans");
  return v11;
}

uint64_t sub_2198A9DEC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned int *v4;
  void (*v5)(_QWORD, uint64_t, uint64_t);
  uint64_t v6;
  _BYTE *v7;
  uint64_t v8;
  unsigned int *v10;
  uint64_t v11;
  unsigned int *v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v10 = 0;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_CfgTransCmplt");
  sub_21988EDF4(v13, &v10);
  sub_21988F744(v13, &v12);
  sub_21988EB80(v13, &v11);
  if ((_DWORD)a3)
    sub_219886108(v13, a3);
  else
    sub_21988620C(v13, 0);
  v4 = v12;
  if (v12)
  {
    v5 = (void (*)(_QWORD, uint64_t, uint64_t))*((_QWORD *)v12 + 87);
    v6 = *((_QWORD *)v12 + 88);
    *((_QWORD *)v12 + 88) = 0;
    *((_QWORD *)v4 + 87) = 0;
    if (v5)
    {
      sub_219885F70(0, (unsigned int *)&v13, 4u, 85, (uint64_t)"phLibNfc_SM_Dnld_eSE_CfgTransCmplt");
      v5(*(_QWORD *)v12, v6, a3);
      v4 = v12;
    }
  }
  else
  {
    a3 = 1;
  }
  if (v10)
  {
    if (v4)
    {
      if (v11)
      {
        v7 = (char *)v10 + 6026;
        *((_BYTE *)v10 + 6027) = 0;
        if (*v7 != 1)
        {
          v8 = 0;
          *((_QWORD *)v4 + 86) = 0;
          *((_QWORD *)v4 + 85) = 0;
          do
          {
            sub_219907BBC(v12, v8);
            *(_QWORD *)&v12[2 * v8++ + 38] = 0;
          }
          while (v8 != 8);
          if (!*(_QWORD *)v11 && !*((_BYTE *)v10 + 6029))
          {
            *(_BYTE *)(v11 + 92) = 0;
            phTmlNfc_ReadAbort();
            phTmlNfc_FlushTxRxBuffers();
            sub_219909F14((uint64_t)v12);
            sub_219897050((uint64_t)v10);
            sub_21986BE40(v13);
            if (*(_BYTE *)(v11 + 67) == 1)
            {
              *(_BYTE *)(v11 + 67) = 0;
              if (v10)
              {
                sub_21989A5DC(v10);
                v10 = 0;
                sub_21988EEB4(v13, 0);
              }
            }
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_CfgTransCmplt");
  return a3;
}

uint64_t sub_2198A9FD8(uint64_t a1)
{
  uint64_t SmbCmd;
  uint64_t v3;
  uint64_t v4;

  v3 = 0;
  v4 = a1;
  sub_219850718(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_GetSmbTrans");
  sub_21988EDF4(v4, &v3);
  if (v3)
    SmbCmd = phDnldNfc_DnldEseGetSmbCmd(v3);
  else
    SmbCmd = 255;
  sub_219850808(0, (unsigned int *)&v4, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_GetSmbTrans");
  return SmbCmd;
}

uint64_t sub_2198AA068(uint64_t a1)
{
  _BYTE *v1;
  char v2;
  uint64_t (**v3)();
  uint64_t (*v4)();
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_RecoveryTrans");
  sub_21988EDF4(v8, &v7);
  v1 = (_BYTE *)v7;
  if (v7)
  {
    *(_QWORD *)(v7 + 2912) = &qword_2550A2E78;
    v1[2904] = 0;
    v1[2906] = 0;
    v2 = qword_2550A2E78;
    if (qword_2550A2E78)
    {
      v2 = 0;
      v3 = off_2550A2E88;
      do
      {
        ++v2;
        v4 = *v3;
        v3 += 2;
      }
      while (v4);
    }
    v1[2905] = v2;
    v5 = sub_2198655FC((uint64_t)v1, 0, 0);
  }
  else
  {
    v5 = 1;
  }
  sub_219850808(0, (unsigned int *)&v8, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_RecoveryTrans");
  return v5;
}

uint64_t sub_2198AA12C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned int *v4;
  void (*v5)(_QWORD, uint64_t, _QWORD, unsigned int *, _QWORD, uint64_t);
  uint64_t v6;
  uint64_t v7;
  unsigned int *v8;
  uint64_t i;
  uint64_t v10;
  unsigned int *v11;
  unsigned int *v13;
  uint64_t v14;
  unsigned int *v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  v13 = 0;
  v14 = 0;
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_TrnscvTransCmplt");
  sub_21988EDF4(v16, &v13);
  sub_21988F744(v16, &v15);
  sub_21988EB80(v16, &v14);
  if ((_DWORD)a3)
    sub_219886108(v16, a3);
  else
    sub_21988620C(v16, 0);
  if (v13)
  {
    v4 = v15;
    if (v15)
    {
      if (v14)
      {
        v5 = (void (*)(_QWORD, uint64_t, _QWORD, unsigned int *, _QWORD, uint64_t))*((_QWORD *)v15 + 81);
        v6 = *((_QWORD *)v15 + 82);
        *(_OWORD *)(v15 + 162) = 0u;
        if ((_DWORD)a3 == 214)
        {
          v7 = 0;
          *((_QWORD *)v4 + 86) = 0;
          *((_QWORD *)v4 + 85) = 0;
          do
          {
            sub_219907BBC(v15, v7);
            *(_QWORD *)&v15[2 * v7++ + 38] = 0;
          }
          while (v7 != 8);
        }
        if (v5)
        {
          v5(*(_QWORD *)v15, v6, *((_QWORD *)v15 + 1), v15 + 16, *(unsigned int *)(v14 + 820), a3);
          sub_219850628(0, (unsigned int *)&v16, 4u, 4u, (uint64_t)"phLibNfc_SM_Dnld_eSE_TrnscvTransCmplt:APP Callback Invoked");
          v8 = v15;
          *((_QWORD *)v15 + 84) = 0;
          *((_QWORD *)v8 + 83) = 0;
          phOsalNfc_SetMemory();
          if ((_DWORD)a3 == 217)
          {
            for (i = 0; i != 8; ++i)
            {
              sub_219907BBC(v15, i);
              *(_QWORD *)&v15[2 * i + 38] = 0;
            }
          }
          if ((_DWORD)a3 == 214)
          {
            v10 = 0;
            v11 = v15;
            *((_QWORD *)v15 + 86) = 0;
            *((_QWORD *)v11 + 85) = 0;
            do
            {
              sub_219907BBC(v15, v10);
              *(_QWORD *)&v15[2 * v10++ + 38] = 0;
            }
            while (v10 != 8);
            if (!*(_QWORD *)v14 && !*((_BYTE *)v13 + 6029))
            {
              phTmlNfc_ReadAbort();
              phTmlNfc_FlushTxRxBuffers();
              sub_219909F14((uint64_t)v15);
              sub_219897050((uint64_t)v13);
              sub_21986BE40(v16);
              if (*(_BYTE *)(v14 + 67) == 1)
              {
                *(_BYTE *)(v14 + 67) = 0;
                if (v13)
                {
                  sub_21989A5DC(v13);
                  v13 = 0;
                  sub_21988EEB4(v16, 0);
                }
              }
            }
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_TrnscvTransCmplt");
  return a3;
}

uint64_t sub_2198AA388(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_TrnscvTrans");
  sub_21988EDF4(v9, &v8);
  v6 = 255;
  if (a4 && v8)
    v6 = sub_2198753F4(v8, a3, a4);
  sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_TrnscvTrans");
  return v6;
}

uint64_t sub_2198AA424(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _QWORD *v4;
  void (*v5)(_QWORD, uint64_t, uint64_t);
  uint64_t v6;
  uint64_t v7;
  char *v8;
  unsigned int *v10;
  uint64_t v11;
  _QWORD *v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  v10 = 0;
  v11 = 0;
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_SmbCfgTransCmplt");
  sub_21988EDF4(v13, &v10);
  sub_21988F744(v13, &v12);
  sub_21988EB80(v13, &v11);
  if ((_DWORD)a3)
    sub_219886108(v13, a3);
  else
    sub_21988620C(v13, 0);
  v4 = v12;
  if (v12)
  {
    v5 = (void (*)(_QWORD, uint64_t, uint64_t))v12[89];
    v6 = v12[90];
    v12[90] = 0;
    v4[89] = 0;
    if (v5)
    {
      v5(*v4, v6, a3);
      sub_219850628(0, (unsigned int *)&v13, 4u, 4u, (uint64_t)"phLibNfc_SM_Dnld_eSE_SmbCfgTransCmplt:APP Callback Invoked");
      v4 = v12;
    }
  }
  else
  {
    a3 = 1;
  }
  if (v10)
  {
    if (v4)
    {
      v7 = v11;
      if (v11)
      {
        v8 = (char *)v10 + 6026;
        *((_BYTE *)v10 + 6030) = 0;
        if (v8[3] != 1 && !*(_QWORD *)v7 && !*v8)
        {
          *(_BYTE *)(v7 + 92) = 0;
          phTmlNfc_ReadAbort();
          phTmlNfc_FlushTxRxBuffers();
          sub_219909F14((uint64_t)v12);
          sub_219897050((uint64_t)v10);
          sub_21986BE40(v13);
          if (*(_BYTE *)(v11 + 67) == 1)
          {
            *(_BYTE *)(v11 + 67) = 0;
            if (v10)
            {
              sub_21989A5DC(v10);
              v10 = 0;
              sub_21988EEB4(v13, 0);
            }
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_SmbCfgTransCmplt");
  return a3;
}

uint64_t sub_2198AA5B8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  _QWORD *v6;
  void (*v7)(_QWORD, uint64_t, uint64_t, uint64_t);
  uint64_t v8;
  uint64_t v10;
  _QWORD *v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  v10 = 0;
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_GetSmbTransCmplt");
  sub_21988EDF4(v12, &v10);
  sub_21988F744(v12, &v11);
  if ((_DWORD)a3)
    sub_219886108(v12, a3);
  else
    sub_21988620C(v12, 0);
  if (v10)
  {
    v6 = v11;
    if (v11)
    {
      *(_BYTE *)(v10 + 6031) = 0;
      v7 = (void (*)(_QWORD, uint64_t, uint64_t, uint64_t))v6[91];
      v8 = v6[92];
      v6[92] = 0;
      v6[91] = 0;
      if (v7)
      {
        v7(*v6, v8, a4, a3);
        sub_219850628(0, (unsigned int *)&v12, 4u, 4u, (uint64_t)"phLibNfc_SM_Dnld_eSE_GetSmbTransCmplt:host Callback Invoked");
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_SM_Dnld_eSE_GetSmbTransCmplt");
  return a3;
}

uint64_t sub_2198AA6B0(uint64_t a1)
{
  uint64_t i;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_Initialize");
  if (a1)
  {
    for (i = 0; i != 4; ++i)
      sub_2198D1B2C(*(_QWORD *)(a1 + 19360), dword_21990A94C[i], 0, a1 + 19360, a1);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SM_SE_Initialize");
  return 0;
}

uint64_t sub_2198AA74C(unsigned int *a1, unsigned int a2)
{
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  void (*v6)(uint64_t, uint64_t, uint64_t, uint64_t);
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v13;

  v3 = (uint64_t)a1;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_NfccResetNtf_CB");
  v13 = *(_QWORD *)(v3 + 19360);
  v4 = *(_QWORD *)(v3 + 6056);
  if ((a2 & 0xFFFE) == 0x88)
    v5 = a2;
  else
    v5 = 48;
  sub_21987BAC0(v3, v5);
  v6 = *(void (**)(uint64_t, uint64_t, uint64_t, uint64_t))(v3 + 6568);
  if (v6)
  {
    v7 = *(_QWORD *)(v3 + 6576);
    if (*(unsigned __int8 *)(v3 + 308) == 161)
    {
      sub_219853E34(0, (unsigned int *)&v13, 4u, 4u, (uint64_t)"NfccResetNtf_CB :pGenericNtfCb[RESET NTF PROHIBIT TEMPERATURE]");
      v8 = *(_QWORD *)(v3 + 19360);
      v9 = v7;
      v10 = 209;
      v11 = 0;
    }
    else
    {
      sub_219853E34(0, (unsigned int *)&v13, 4u, 4u, (uint64_t)"NfccResetNtf_CB :pGenericNtfCb[RESET NTF]");
      v8 = *(_QWORD *)(v3 + 19360);
      v11 = v3 + 112;
      v9 = v7;
      v10 = 48;
    }
    v6(v8, v9, v10, v11);
  }
  *(_BYTE *)(v3 + 3160) = 0;
  if (v4)
  {
    sub_219897050(v3);
    sub_2198FF49C(*(unsigned int **)(v3 + 3040), 2, 0, 0);
    *(_QWORD *)(v3 + 3040) = 0;
    phTmlNfc_ReadAbort();
    phTmlNfc_FlushTxRxBuffers();
    phTmlNfc_WriteAbort();
    sub_21988F804(*(_QWORD *)(v3 + 2952), 0);
    *(_QWORD *)(v3 + 2912) = 0;
    sub_21989A5DC((unsigned int *)v3);
    sub_21988EEB4(v13, 0);
    v3 = 0;
  }
  return sub_219850808(2, (unsigned int *)v3, 4u, 5u, (uint64_t)"phLibNfc_NfccResetNtf_CB");
}

uint64_t sub_2198AA8B8(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ModeSet");
  if (a1)
  {
    *(_BYTE *)(a1 + 6432) = 0;
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0x200000001;
    DWORD2(v4) = 1;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_2198AB184, a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ModeSet");
  return v2;
}

uint64_t sub_2198AA990(uint64_t a1, uint64_t a2)
{
  unsigned __int8 *v4;
  int v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessModeSetRsp");
  if (!(_DWORD)a2)
  {
    if (!a1)
      goto LABEL_12;
    *(_BYTE *)(a1 + 6432) = 1;
    v4 = *(unsigned __int8 **)(a1 + 3760);
    if (!v4)
      goto LABEL_12;
    v5 = *v4;
    if (v5 == 241)
    {
      a2 = 81;
      goto LABEL_13;
    }
    if (!v5)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"NFCEE Mode Set process Success");
      v6 = *(_QWORD *)(a1 + 3952);
      if (v6)
      {
        if (*(_BYTE *)(v6 + 1) == 1 && !*(_DWORD *)(a1 + 3948))
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Updating closed logical connection channel info");
          if (sub_219878DD0((unsigned int *)a1, a1 + 3968))
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Failed to update closed connection info");
        }
      }
      a2 = 0;
    }
    else
    {
LABEL_12:
      a2 = 255;
    }
  }
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessModeSetRsp");
  return a2;
}

uint64_t sub_2198AAAB4(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteModeSetSequence");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
      *(_DWORD *)(a1 + 856) = 0;
    }
    if ((_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"phNciNfc_CompleteModeSetSequence: Set Mode failed!!");
    }
    else
    {
      v4 = *(_QWORD *)(a1 + 3952);
      if (!v4 || *(_DWORD *)(a1 + 3948) == 1 && *(_BYTE *)(v4 + 1) == 1)
      {
        a2 = 0;
      }
      else
      {
        v5 = *(_QWORD *)(a1 + 4664);
        if (v5 && v5 != 0xFFFFFFFFFFFFLL)
        {
          phOsalNfc_Timer_Stop();
          phOsalNfc_Timer_Delete();
          *(_QWORD *)(a1 + 4664) = 0xFFFFFFFFFFFFLL;
        }
        v6 = phOsalNfc_Timer_Create();
        *(_QWORD *)(a1 + 4664) = v6;
        if (v6 != 0xFFFFFFFFFFFFLL && v6)
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Set Mode Notification Timer Created Successfully");
          a2 = phOsalNfc_Timer_Start();
          if (!(_DWORD)a2)
          {
            sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4664), 3u, 4u, (uint64_t)"phNciNfc_CompleteModeSetSequence");
            sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Set Mode ntf timer started\n");
            goto LABEL_19;
          }
          phOsalNfc_Timer_Stop();
          phOsalNfc_Timer_Delete();
          *(_QWORD *)(a1 + 4664) = 0xFFFFFFFFFFFFLL;
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Set Mode ntf timer start FAILED\n\n");
        }
        else
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Set Mode Notification Timer Create failed!!");
          a2 = 12;
        }
      }
    }
    *(_QWORD *)(a1 + 776) = 0;
    *(_QWORD *)(a1 + 768) = 0;
    sub_2198E23C4(a1, a2, 0);
  }
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteModeSetSequence");
  return a2;
}

uint64_t sub_2198AACD8(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeDiscover");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0x200000001;
    DWORD2(v4) = 0;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_2198AB184, a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeDiscover");
  return v2;
}

uint64_t sub_2198AADA4(uint64_t a1, uint64_t a2)
{
  unsigned __int8 *v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessNfceeDiscoverRsp");
  if (a1 && !(_DWORD)a2)
  {
    v4 = *(unsigned __int8 **)(a1 + 3760);
    if (!v4 || *(_DWORD *)(a1 + 3768) > 2u)
      goto LABEL_8;
    v5 = *v4;
    if (v5 == 241)
    {
      a2 = 81;
      goto LABEL_9;
    }
    if (v5)
    {
LABEL_8:
      a2 = 255;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"NFCEE Discovery process Started");
      *(_BYTE *)(a1 + 3945) = *(_BYTE *)(*(_QWORD *)(a1 + 3760) + 1);
      *(_BYTE *)(a1 + 3960) = *(_BYTE *)(a1 + 4488);
      sub_219851888(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Number of NFCEE Connected with NFCC");
      a2 = 0;
    }
  }
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ProcessNfceeDiscoverRsp");
  return a2;
}

uint64_t sub_2198AAE98(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteNfceeDiscoverSequence");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 3760))
    {
      if (*(_QWORD *)(a1 + 848))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 848) = 0;
        *(_DWORD *)(a1 + 856) = 0;
      }
      if (!(_DWORD)a2)
      {
        v4 = (unsigned int *)(a1 + 6476);
        if (*(_BYTE *)(a1 + 4488) == 1)
        {
          sub_219850628(1, v4, 3u, 4u, (uint64_t)"Registering for Nfcee Discover Notification");
          BYTE5(v8) = 2;
          LODWORD(v8) = 0;
          v7 = 0x200000003;
          v5 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_2198AB39C, a1);
        }
        else
        {
          sub_219850628(1, v4, 3u, 4u, (uint64_t)"DeRegistering for Nfcee Discover Notification");
          LODWORD(v8) = 0;
          v7 = 0x200000003;
          v5 = sub_2198F3088((unsigned int *)(a1 + 888), (uint64_t)&v7, (uint64_t)sub_2198AB39C);
        }
        a2 = v5;
      }
    }
    sub_2198E23C4(a1, a2, 0);
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteNfceeDiscoverSequence");
  return a2;
}

uint64_t sub_2198AAFE4(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SvddOnCtrlCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 0xF00000001;
    DWORD2(v4) = 41;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_2198AB184, a1);
  }
  else
  {
    v2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SvddOnCtrlCmd");
  return v2;
}

uint64_t sub_2198AB0B4(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SvddOnCtrlRsp");
  if (a1 && !(_DWORD)a2)
  {
    v4 = *(_BYTE **)(a1 + 3760);
    if (v4 && !*v4 && *(_DWORD *)(a1 + 3768) == 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Svdd On Control Successful");
      a2 = 0;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Svdd On Control  failed!");
      *(_DWORD *)(a1 + 3768) = 0;
      a2 = 255;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SvddOnCtrlRsp");
  return a2;
}

uint64_t sub_2198AB184(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeDiscoverSequence");
  if (a1 && a2)
  {
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeDiscoverSequence");
  return v6;
}

uint64_t sub_2198AB214(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;
  void (*v9)(uint64_t, uint64_t, _QWORD);
  uint64_t v10;

  sub_21988629C(2, (unsigned int *)a2, a1, 3u, 4u, (uint64_t)"phNciNfc_NfceeMgmtSetModeTimeOutHandler");
  sub_219850718(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_NfceeMgmtSetModeTimeOutHandler");
  if (!a2)
    goto LABEL_6;
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 4);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != a2);
  if (v5 == a2)
  {
    sub_219850628(1, (unsigned int *)(a2 + 6476), 3u, 4u, (uint64_t)"#######Set Mode notification TIMEOUT########\n");
    v7 = *(_QWORD *)(a2 + 4664);
    if (v7 && v7 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(a2 + 4664) = 0xFFFFFFFFFFFFLL;
    }
    if (*(_BYTE *)(a2 + 4795) == 1 || *(_BYTE *)(a2 + 4794) == 1)
    {
      v8 = 47;
    }
    else
    {
      v8 = 47;
      if (*(_BYTE *)(a2 + 4793) != 1)
      {
        if (*(_BYTE *)(a2 + 4788) == 1)
          v8 = 47;
        else
          v8 = 0;
      }
    }
    v9 = *(void (**)(uint64_t, uint64_t, _QWORD))(a2 + 768);
    if (v9)
    {
      v10 = *(_QWORD *)(a2 + 776);
      *(_QWORD *)(a2 + 768) = 0;
      *(_QWORD *)(a2 + 776) = 0;
      v9(v10, v8, 0);
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a2, 3u, 1u, (uint64_t)"Nci context null (phNciNfc_NfceeMgmtSetModeTimeOutHandler)\n");
  }
  return sub_219850808(2, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_NfceeMgmtSetModeTimeOutHandler");
}

uint64_t sub_2198AB39C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned __int8 *v6;
  int v7;
  BOOL v8;
  int v9;
  char v10;
  unsigned int v11;
  uint64_t v12;
  unsigned int v13;
  int v14;
  uint64_t v15;
  unsigned int v16;
  uint64_t v17;
  _BYTE *v18;
  int v19;
  uint64_t v20;
  int v21;
  __int128 v22;
  __int128 v23;
  __int128 v24;
  uint64_t v25;
  uint64_t v26;
  void (*v27)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v29;
  uint64_t v30;
  uint64_t Memory;
  unsigned __int8 v32;
  __int16 v33;
  uint64_t v34;
  uint64_t v35;
  uint64_t v36;
  __int128 v37;
  __int128 v38;
  __int128 v39;
  __int128 v40;
  __int128 v41;
  __int128 v42;
  uint64_t v43;

  v43 = 0;
  v41 = 0u;
  v42 = 0u;
  v39 = 0u;
  v40 = 0u;
  v37 = 0u;
  v38 = 0u;
  v34 = 0;
  v35 = 0;
  v36 = 0;
  v33 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeDiscNtfHandler");
  if ((_DWORD)a3)
    goto LABEL_44;
  if (!a1)
  {
    a3 = 49;
    goto LABEL_44;
  }
  if (!a2 || (v6 = *(unsigned __int8 **)(a2 + 8)) == 0 || (v7 = *(_DWORD *)(a2 + 16)) == 0)
  {
    a3 = 1;
    goto LABEL_44;
  }
  v8 = 0;
  v9 = *v6;
  v10 = 1;
  a3 = 1;
  if (*v6 && v9 != 255)
  {
    v11 = v6[1];
    if (v11 > 2)
    {
LABEL_9:
      v8 = 0;
      goto LABEL_34;
    }
    v12 = sub_2198ABAEC((unsigned int *)a1, (unsigned __int8 *)(a1 + 3944), v9, &v33, 1u);
    a3 = v12;
    v8 = v11 == 2;
    if (v11 == 2)
    {
      if ((_DWORD)v12 == 255)
      {
        a3 = sub_2198ABAEC((unsigned int *)a1, (unsigned __int8 *)(a1 + 3944), *v6, &v33, 0);
        v13 = v33;
        if (!(_DWORD)a3)
          *(_BYTE *)(a1 + 104 * v33 + 3968) = -1;
        v14 = 1;
      }
      else
      {
        v14 = 0;
        v13 = v33;
      }
      LOBYTE(v34) = 0;
      BYTE1(v34) = *v6;
      v35 = a1 + 104 * v13 + 3968;
      sub_2198ABC44((unsigned int *)a1, v35, v6[(v6[2] + 3)], (uint64_t)&v6[(v6[2] + 4)]);
      v10 = 0;
    }
    else
    {
      if ((_DWORD)v12 == 255)
      {
        v15 = sub_2198ABAEC((unsigned int *)a1, (unsigned __int8 *)(a1 + 3944), *v6, &v33, 0);
        if ((_DWORD)v15)
        {
          a3 = v15;
          goto LABEL_9;
        }
        *(_BYTE *)(a1 + 104 * v33 + 3968) = -1;
        v14 = 1;
        goto LABEL_26;
      }
      v14 = 0;
    }
    if ((_DWORD)a3)
      goto LABEL_34;
LABEL_26:
    if (v6[1] == 2)
    {
LABEL_27:
      a3 = 0;
      goto LABEL_34;
    }
    v16 = v33;
    v17 = a1 + 104 * v33;
    v18 = (_BYTE *)(v17 + 3968);
    *(_BYTE *)(v17 + 3968) = -1;
    *(_BYTE *)(v17 + 3969) = *v6;
    if (v6[1])
    {
      v19 = 0;
      *v18 = -1;
    }
    else
    {
      v19 = 1;
    }
    *(_DWORD *)(a1 + 104 * v16 + 3972) = v19;
    HIBYTE(v33) = 2;
    if (!sub_2198ABEA8((unsigned int *)a1, (uint64_t)v18, (uint64_t)v6, (unsigned __int8 *)&v33 + 1))
    {
      v29 = HIBYTE(v33);
      if (!((_BYTE)v7 + ~HIBYTE(v33)))
        goto LABEL_49;
      a3 = sub_2198B3FD4((unsigned int *)a1, (uint64_t)&v6[HIBYTE(v33) + 1], (v7 + ~HIBYTE(v33)));
      if ((_DWORD)a3)
        goto LABEL_33;
      v30 = a1 + 3968 + 104 * v33;
      *(_BYTE *)(v30 + 14) = v6[v29];
      *(_QWORD *)(v30 + 16) = 0;
      Memory = phOsalNfc_GetMemory();
      *(_QWORD *)(a1 + 3968 + 104 * v33 + 16) = Memory;
      if (!Memory)
      {
        a3 = 255;
        goto LABEL_33;
      }
      phOsalNfc_MemCopy();
      if (!sub_2198ABC44((unsigned int *)a1, a1 + 104 * v33 + 3968, v6[v29], *(_QWORD *)(a1 + 104 * v33 + 3984)))
      {
LABEL_49:
        if (v14)
        {
          a3 = 0;
          ++*(_BYTE *)(a1 + 3944);
          goto LABEL_34;
        }
        goto LABEL_27;
      }
    }
    a3 = 1;
LABEL_33:
    *(_BYTE *)(a1 + 104 * v33 + 3969) = 0;
  }
LABEL_34:
  v20 = a1 + 104 * v33;
  v21 = *v6;
  if (*(unsigned __int8 *)(v20 + 3969) == v21)
  {
    v22 = *(_OWORD *)(v20 + 4048);
    v41 = *(_OWORD *)(v20 + 4032);
    v42 = v22;
    v43 = *(_QWORD *)(v20 + 4064);
    v23 = *(_OWORD *)(v20 + 3984);
    v37 = *(_OWORD *)(v20 + 3968);
    v38 = v23;
    v24 = *(_OWORD *)(v20 + 4016);
    v39 = *(_OWORD *)(v20 + 4000);
    v40 = v24;
  }
  else if (v6[1] == 2)
  {
    v32 = 2;
    BYTE1(v37) = v21;
    DWORD1(v37) = 2;
    a3 = sub_2198ABEA8((unsigned int *)a1, (uint64_t)&v37, (uint64_t)v6, &v32);
    BYTE14(v37) = v6[v32];
    v25 = a1 + 104 * v33;
    *(_BYTE *)(v25 + 3968) = -1;
    *(_BYTE *)(v25 + 3969) = v6[HIBYTE(v33)];
    *(_DWORD *)(v25 + 3972) = 2;
  }
  sub_219882F88((unsigned int *)a1, (uint64_t)&v37);
  if (!(_DWORD)a3)
  {
    if (!v8)
    {
      LOBYTE(v34) = v10;
      v26 = a1 + 104 * v33;
      BYTE1(v34) = *(_BYTE *)(v26 + 3969);
      v35 = v26 + 3968;
    }
    v27 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 232);
    if (v27)
      v27(*(_QWORD *)(a1 + 224), 1, &v34, 0);
    a3 = 0;
  }
LABEL_44:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeDiscNtfHandler");
  return a3;
}

uint64_t sub_2198AB7F8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeModeSetSequence");
  if (a1 && a2)
  {
    *(_DWORD *)(a1 + 3768) = *(_DWORD *)(a2 + 16);
    *(_QWORD *)(a1 + 3760) = *(_QWORD *)(a2 + 8);
  }
  v6 = sub_21987CC04(a1, a3);
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeModeSetSequence");
  return v6;
}

uint64_t sub_2198AB888(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8;
  uint64_t v10;
  int v11;

  v11 = 0;
  v10 = 255;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Nfcee_Connect");
  v8 = 0;
  if (a2 && a3)
  {
    *(_QWORD *)(a1 + 4648) = a2;
    LODWORD(v10) = 3;
    WORD2(v10) = 257;
    BYTE6(v10) = 2;
    HIBYTE(v10) = *(_BYTE *)(a2 + 1);
    LOBYTE(v11) = 1;
    *(_QWORD *)(a1 + 3384) = a3;
    *(_QWORD *)(a1 + 3712) = a4;
    v8 = sub_21987874C(a1, (uint64_t)&v10, (uint64_t)sub_2198AB96C, a1);
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_Nfcee_Connect");
  return v8;
}

uint64_t sub_2198AB96C(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  char v7;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeConnCb");
  if (a1)
  {
    if (!(_DWORD)a3)
    {
      v5 = *(_QWORD *)(a1 + 4648);
      a3 = sub_219878B08(a1, 3, *(unsigned __int8 *)(v5 + 1), v5);
      if (!(_DWORD)a3)
      {
        sub_219851888(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"NFCEE connection created for id = ");
        a3 = sub_219878C88((unsigned int *)a1, v5, &v7);
      }
    }
    sub_2198E23C4(a1, a3, 0);
  }
  else
  {
    a3 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeConnCb");
  return a3;
}

uint64_t sub_2198ABA50(unsigned int *a1, unsigned __int8 *a2)
{
  unsigned __int8 v5;

  v5 = 0;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_DeActivateNfcee");
  if (a2 && !sub_2198ABAEC(a1, a2, 0, &v5, 3u))
    a2[104 * v5 + 24] = -1;
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_DeActivateNfcee");
  return 0;
}

uint64_t sub_2198ABAEC(unsigned int *a1, unsigned __int8 *a2, int a3, _BYTE *a4, unsigned int a5)
{
  uint64_t v10;
  unint64_t v11;
  unsigned __int8 *v12;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNfcNfc_NfceeGetDevIndex");
  v10 = 1;
  if (!a2 || !a4 || a5 > 3)
    goto LABEL_22;
  v11 = 0;
  v12 = a2 + 24;
  while (a5 != 2)
  {
    if (a5 == 1)
    {
      if (v12[1] == a3)
        goto LABEL_18;
    }
    else if (a5)
    {
      if (v11 < *a2 && *v12 != 255)
      {
LABEL_18:
        v10 = 0;
        *a4 = v11;
        goto LABEL_22;
      }
    }
    else if (!v12[1])
    {
      goto LABEL_18;
    }
LABEL_16:
    ++v11;
    v12 += 104;
    if (v11 == 5)
    {
      v10 = 255;
      goto LABEL_22;
    }
  }
  if (v12[1] != a3)
    goto LABEL_16;
  if (*((_QWORD *)v12 + 2))
  {
    phOsalNfc_FreeMemory();
    *((_QWORD *)v12 + 2) = 0;
  }
  v10 = 0;
  v12[1] = 0;
  --a2[1];
  --*a2;
LABEL_22:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNfcNfc_NfceeGetDevIndex");
  return v10;
}

uint64_t sub_2198ABC44(unsigned int *a1, uint64_t a2, unsigned int a3, uint64_t a4)
{
  uint64_t v8;
  int v9;
  unsigned __int8 v10;
  uint64_t v11;
  _DWORD *v12;
  int v13;
  uint64_t v14;
  unsigned __int8 v15;
  uint64_t v16;
  unsigned int v17;
  int v18;
  uint64_t v19;
  uint64_t v20;
  unsigned int *v21;
  const char *v22;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_StoreTlvInfo");
  if (a3)
  {
    v8 = 1;
    if (a3 <= 3)
    {
      v9 = 0;
      v10 = 0;
      *(_BYTE *)(a2 + 24) = a3;
      v11 = a3;
      v12 = (_DWORD *)(a2 + 32);
      while (1)
      {
        v13 = *(unsigned __int8 *)(a4 + v9);
        if (v13 == 160)
        {
          *v12 = 160;
          v15 = v9 + 2;
          if (*(_BYTE *)(a4 + (v9 + 1)) == 1)
          {
            v16 = a2 + 24 * v10;
            *(_DWORD *)(v16 + 36) = 1;
            v9 += 3;
            *(_BYTE *)(v16 + 40) = *(_BYTE *)(a4 + v15);
            v17 = *(unsigned __int8 *)(a4 + v9);
            if (v17 > 0xF && ((v18 = v17 & 0xF0, (v17 & 0xF) == 0xF) || v17 == 77 || v18 != 64))
            {
              v21 = (unsigned int *)(a2 + 24 * v10 + 48);
              if (v18 == 32 && (v17 & 0xF) <= 0xC)
              {
                *v21 = v17;
                *(_BYTE *)(a2 + 24 * v10 + 52) = 0;
              }
              else
              {
                *v21 = 255;
                *(_BYTE *)(a2 + 24 * v10 + 52) = *(_BYTE *)(a4 + v9);
                if (*(_BYTE *)(a4 + v9) == 45)
                  v22 = "StoreTlvInfo: Received NFCEE removed Ntf with eSE Not present Reason Code";
                else
                  v22 = "StoreTlvInfo: Received NFCEE removed Ntf with un-known reason code";
                sub_219850628(2, a1, 3u, 1u, (uint64_t)v22);
              }
            }
            else
            {
              v19 = a2 + 24 * v10;
              *(_DWORD *)(v19 + 48) = v17;
              *(_BYTE *)(v19 + 52) = 0;
            }
          }
          else
          {
            sub_219850628(2, a1, 3u, 1u, (uint64_t)"StoreTlvInfo: Received NFCEE removed Ntf with INVALID type");
            *(_BYTE *)(a2 + 24) = 0;
            *(_DWORD *)(a2 + 24 * v10 + 36) = 2;
            v9 += 2;
          }
        }
        else
        {
          if (v13 == 1)
          {
            v14 = a2 + 24 * v10;
            *(_DWORD *)(v14 + 32) = 1;
          }
          else
          {
            if (*(_BYTE *)(a4 + v9))
            {
              *(_BYTE *)(a2 + 24) = 0;
              v8 = 1;
              break;
            }
            v14 = a2 + 24 * v10;
            *(_DWORD *)(v14 + 32) = 0;
          }
          v20 = a4 + v9;
          *(_BYTE *)(v14 + 40) = *(_BYTE *)(v20 + 1);
          *(_QWORD *)(v14 + 48) = a4 + v9 + 2;
          v9 += *(unsigned __int8 *)(v20 + 1) + 2;
          ++v10;
        }
        v12 += 6;
        if (!--v11)
          goto LABEL_26;
      }
    }
  }
  else
  {
LABEL_26:
    v8 = 0;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_StoreTlvInfo");
  return v8;
}

uint64_t sub_2198ABEA8(unsigned int *a1, uint64_t a2, uint64_t a3, unsigned __int8 *a4)
{
  uint64_t v8;
  unsigned int v9;
  unsigned __int8 v10;
  unint64_t v11;
  unsigned int v12;
  uint64_t v13;

  v8 = *a4;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_StoreNfceeProtocols");
  v9 = *(unsigned __int8 *)(a3 + v8);
  if (v9 > 5)
  {
    v13 = 1;
  }
  else
  {
    *(_BYTE *)(a2 + 8) = v9;
    v10 = v8 + 1;
    if (v9)
    {
      v11 = 0;
      while (1)
      {
        v12 = *(unsigned __int8 *)(a3 + v10);
        sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_VerifyNfceeProtocol");
        if (v12 >= 4 && v12 != 128)
          break;
        sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_VerifyNfceeProtocol");
        *(_BYTE *)(a2 + 9 + v11++) = *(_BYTE *)(a3 + v10++);
        if (v11 >= *(unsigned __int8 *)(a2 + 8))
          goto LABEL_10;
      }
      sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_VerifyNfceeProtocol");
      v13 = 1;
    }
    else
    {
LABEL_10:
      v13 = 0;
    }
    *a4 = v10;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_StoreNfceeProtocols");
  return v13;
}

uint64_t sub_2198ABFF4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  unsigned __int8 *v6;
  unsigned int v7;
  int v8;
  unsigned __int8 v9;
  void (*v10)(_QWORD, uint64_t, _QWORD *, _QWORD);
  unsigned __int8 v12;
  _QWORD v13[3];
  _OWORD v14[17];
  uint64_t v15;
  uint64_t v16;

  v16 = *MEMORY[0x24BDAC8D0];
  memset(v13, 0, sizeof(v13));
  v15 = 0;
  memset(v14, 0, sizeof(v14));
  v12 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeActionNtfHandler");
  if (!a1)
  {
    a3 = 49;
    goto LABEL_28;
  }
  if (!a2 || (v6 = *(unsigned __int8 **)(a2 + 8)) == 0)
  {
    a3 = 1;
    goto LABEL_28;
  }
  v7 = *(_DWORD *)(a2 + 16);
  if (v7 < 3)
  {
    if (!(_DWORD)a3)
      goto LABEL_20;
LABEL_26:
    phOsalNfc_SetMemory();
    goto LABEL_27;
  }
  LOBYTE(v14[0]) = *v6;
  v8 = v6[1];
  DWORD1(v14[0]) = v8;
  a3 = 1;
  if (v8 <= 1)
  {
    if (!v8)
    {
LABEL_18:
      BYTE8(v14[0]) = v6[2];
      phOsalNfc_MemCopy();
      v9 = BYTE8(v14[0]) + 3;
      goto LABEL_19;
    }
    if (v6[2] != 1 || sub_2198591B4((unsigned int *)a1, v6[3]))
      goto LABEL_26;
  }
  else
  {
    if (v8 != 2)
    {
      if (v8 != 32 && v8 != 16)
        goto LABEL_26;
      goto LABEL_18;
    }
    if (v6[2] != 1 || sub_219859250((unsigned int *)a1, v6[3]))
      goto LABEL_26;
  }
  BYTE8(v14[0]) = v6[2];
  HIDWORD(v14[0]) = v6[3];
  v9 = 4;
LABEL_19:
  if (v7 != v9)
    goto LABEL_26;
LABEL_20:
  a3 = sub_2198ABAEC((unsigned int *)a1, (unsigned __int8 *)(a1 + 3944), *v6, &v12, 1u);
  if ((_DWORD)a3)
  {
LABEL_27:
    v13[0] = v14;
    goto LABEL_28;
  }
  v15 = a1 + 104 * v12 + 3968;
  v13[0] = v14;
  v10 = *(void (**)(_QWORD, uint64_t, _QWORD *, _QWORD))(a1 + 232);
  if (v10)
    v10(*(_QWORD *)(a1 + 224), 3, v13, 0);
  a3 = 0;
LABEL_28:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeActionNtfHandler");
  return a3;
}

uint64_t sub_2198AC248(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _BYTE *v6;
  unsigned int v7;
  unsigned int v8;
  int v9;
  int v10;
  uint64_t v11;
  int v12;
  int v13;
  unsigned int v14;
  unsigned int v15;
  int v16;
  _BYTE *v17;
  unsigned __int8 v18;
  void (*v19)(_QWORD, uint64_t, uint64_t *, _QWORD);
  uint64_t v21;
  _BYTE *v22;
  uint64_t v23;
  _BYTE v24[36];
  uint64_t v25;

  v25 = *MEMORY[0x24BDAC8D0];
  v21 = 0;
  v22 = 0;
  v23 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeDiscReqNtfHandler");
  if (!a1)
  {
    a3 = 49;
    goto LABEL_31;
  }
  if (!a2)
    goto LABEL_16;
  v6 = *(_BYTE **)(a2 + 8);
  v7 = *(_DWORD *)(a2 + 16);
  sub_219881F28((unsigned int *)a1, v6);
  if (v7 == 5 * *v6 + 1)
  {
    v24[0] = 0;
    sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeVerifyTlvParams");
    v8 = *v6;
    if (!*v6)
    {
      sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeVerifyTlvParams");
LABEL_20:
      v22 = v24;
      sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeStoreTlv");
      if (v7 < 6)
      {
        a3 = 255;
      }
      else
      {
        LOBYTE(v21) = *v6;
        v14 = v21;
        if ((_BYTE)v21)
        {
          v15 = 0;
          v16 = 1;
          v17 = v24;
          do
          {
            *v17 = v6[v16];
            v17[1] = v6[(v16 + 2)];
            v18 = v16 + 4;
            *((_DWORD *)v17 + 1) = v6[(v16 + 3)];
            v16 += 5;
            *((_DWORD *)v17 + 2) = v6[v18];
            ++v15;
            v17 += 12;
          }
          while (v15 < v14);
        }
        a3 = 0;
      }
      sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeStoreTlv");
      if (v7 >= 6)
      {
        v19 = *(void (**)(_QWORD, uint64_t, uint64_t *, _QWORD))(a1 + 232);
        if (v19)
        {
          v19(*(_QWORD *)(a1 + 224), 2, &v21, 0);
          a3 = 0;
        }
      }
      goto LABEL_31;
    }
    v9 = 0;
    v10 = 1;
    while (v6[v10] <= 1u && v6[(v10 + 1)] == 3)
    {
      v11 = sub_2198ABAEC((unsigned int *)a1, (unsigned __int8 *)(a1 + 3944), v6[(v10 + 2)], v24, 1u);
      if ((_DWORD)v11)
      {
        a3 = v11;
        goto LABEL_30;
      }
      if (sub_219859250((unsigned int *)a1, v6[(v10 + 2) + 1]))
        break;
      v12 = sub_2198591B4((unsigned int *)a1, v6[(v10 + 2) + 2]);
      v13 = v12;
      if (v12)
        v10 += 2;
      else
        v10 += 5;
      if (++v9 >= v8 || v12)
      {
        sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeVerifyTlvParams");
        if (!v13)
          goto LABEL_20;
LABEL_16:
        a3 = 1;
        goto LABEL_31;
      }
    }
    a3 = 1;
LABEL_30:
    sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeVerifyTlvParams");
  }
LABEL_31:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeDiscReqNtfHandler");
  return a3;
}

uint64_t sub_2198AC554(uint64_t a1, uint64_t a2, uint64_t a3)
{
  void (*v5)(_QWORD, uint64_t, uint64_t, _QWORD);
  const char *v6;
  int v7;
  unsigned int *v8;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfRapduSentNtfHandler");
  if (!a1)
  {
    v6 = "Can not process RAPDU Sent Error Ntf - Invalid input parameters";
    v7 = 2;
    v8 = 0;
LABEL_6:
    sub_219850628(v7, v8, 3u, 1u, (uint64_t)v6);
    goto LABEL_7;
  }
  v5 = *(void (**)(_QWORD, uint64_t, uint64_t, _QWORD))(a1 + 232);
  if (!v5)
  {
    v8 = (unsigned int *)(a1 + 6476);
    v6 = "phNciNfc_RfRapduSentNtfHandler Uppler Layer CallBack Not Registered";
    v7 = 1;
    goto LABEL_6;
  }
  v5(*(_QWORD *)(a1 + 224), 15, a1 + 3968, 0);
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RfRapduSentNtfHandler");
  return a3;
}

uint64_t sub_2198AC608(uint64_t a1, unsigned __int8 *a2, unsigned int a3)
{
  uint64_t v6;
  uint64_t Memory;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  void (*v11)(_QWORD, uint64_t, _QWORD *, _QWORD);
  unsigned __int8 v13;
  _QWORD v14[3];

  memset(v14, 0, sizeof(v14));
  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeProcessRfActvtdNtf");
  v6 = 1;
  if (a1)
  {
    if (a2)
    {
      if (a3 >= 2 && !a2[1])
      {
        v6 = sub_2198ABAEC((unsigned int *)a1, (unsigned __int8 *)(a1 + 3944), *a2, &v13, 1u);
        if (!(_DWORD)v6)
        {
          Memory = phOsalNfc_GetMemory();
          if (Memory)
          {
            v8 = Memory;
            phOsalNfc_SetMemory();
            *(_BYTE *)(v8 + 8) = *a2;
            *(_DWORD *)(v8 + 12) = a2[1];
            *(_BYTE *)v8 = 1;
            v9 = sub_219863D4C((unsigned int *)a1, (_DWORD *)(a1 + 72), v8, 1);
            if ((_DWORD)v9)
            {
              v6 = v9;
              phOsalNfc_FreeMemory();
              goto LABEL_12;
            }
            v10 = a1 + 104 * v13;
            *(_BYTE *)(v10 + 3968) = *(_BYTE *)(v10 + 3969);
            v14[0] = v10 + 3968;
            v11 = *(void (**)(_QWORD, uint64_t, _QWORD *, _QWORD))(a1 + 232);
            if (v11)
              v11(*(_QWORD *)(a1 + 224), 5, v14, 0);
          }
          v6 = 0;
        }
      }
    }
  }
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_NfceeProcessRfActvtdNtf");
  return v6;
}

uint64_t sub_2198AC768(uint64_t a1, uint64_t a2, int a3, uint64_t a4, uint64_t a5)
{
  uint64_t Memory;
  uint64_t v11;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_eSeSvddOnCtrl");
  if (a1)
  {
    if (a2 && a3)
    {
      Memory = phOsalNfc_GetMemory();
      *(_QWORD *)(a1 + 848) = Memory;
      if (Memory)
      {
        phOsalNfc_MemCopy();
        *(_DWORD *)(a1 + 856) = a3;
        *(_QWORD *)(a1 + 3736) = off_2550A2A80;
        *(_BYTE *)(a1 + 3936) = 0;
        *(_BYTE *)(a1 + 3937) = sub_21987CDC4((unsigned int *)a1, off_2550A2A80);
        v11 = sub_21985A05C(a1, 0, 0);
        if ((_DWORD)v11 == 13)
        {
          *(_QWORD *)(a1 + 3384) = a4;
          *(_QWORD *)(a1 + 3712) = a5;
        }
        else
        {
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Svdd On Control Sequence failed!");
          phOsalNfc_FreeMemory();
          *(_QWORD *)(a1 + 848) = 0;
          *(_DWORD *)(a1 + 856) = 0;
        }
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"phNciNfc_eSeSvddOnCtrl, Memory allocation failed!");
        v11 = 12;
      }
    }
    else
    {
      v11 = 1;
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"Invalid parameters");
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Stack not initialized");
    v11 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_eSeSvddOnCtrl");
  return v11;
}

uint64_t sub_2198AC900(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StopResponseTimer");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    v7 = *(_QWORD *)(a1 + 1872);
    v5 = 255;
    if (v7 && v7 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      *(_BYTE *)(a1 + 6464) = 0;
      *(_BYTE *)(a1 + 1880) = 0;
      v5 = 0;
      if (*(_DWORD *)(a1 + 3356))
        dword_253E4715C &= ~0x10u;
      else
        dword_253E47074 &= ~0x10u;
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"Stack not initialized (phNciNfc_StopResponseTimer)\n");
    v5 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_StopResponseTimer");
  return v5;
}

uint64_t sub_2198ACA18(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ClearSetModeNtfWaitTimer");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    v7 = *(_QWORD *)(a1 + 4664);
    v5 = 255;
    if (v7 && v7 != 0xFFFFFFFFFFFFLL)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      v5 = 0;
      *(_QWORD *)(a1 + 4664) = 0xFFFFFFFFFFFFLL;
    }
  }
  else
  {
LABEL_6:
    sub_219850628(2, (unsigned int *)a1, 3u, 1u, (uint64_t)"Stack not initialized (phNciNfc_ClearSetModeNtfWaitTimer)\n");
    v5 = 49;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ClearSetModeNtfWaitTimer");
  return v5;
}

uint64_t sub_2198ACB0C(uint64_t a1)
{
  uint64_t v2;
  char *v3;
  const char *v4;
  uint64_t v5;
  int v6;
  uint64_t v7;
  const char *v8;
  unsigned int *v9;
  unsigned int v10;
  char v11;
  uint64_t v12;
  const char *v13;
  unsigned int *v14;
  char v15;
  char v16;
  char v17;
  const char *v18;
  unsigned int *v19;
  const char *v20;
  int v21;
  int v22;
  int v23;
  uint64_t Memory;
  const char *v25;
  unsigned int *v26;
  __int128 v28;
  __int128 v29;

  v28 = 0u;
  v29 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendMfReq");
  if (a1)
  {
    v2 = *(_QWORD *)(a1 + 4512);
    if (v2)
    {
      if (*(_DWORD *)(a1 + 4544))
      {
        v3 = (char *)(a1 + 4524);
        if (*(_DWORD *)(v2 + 12) == 128)
        {
          switch(*(_DWORD *)(a1 + 4520))
          {
            case 0:
              sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_MfCreateXchgDataHdr");
              if (*(_QWORD *)(a1 + 4512))
              {
                phOsalNfc_SetMemory();
                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Creating XchgData Request Header ..");
                *(_DWORD *)(a1 + 4632) = 16;
                *(_WORD *)(a1 + 4636) = -256;
                *(_BYTE *)(a1 + 4638) = -1;
                v4 = "phNciNfc_MfCreateXchgDataHdr";
                goto LABEL_37;
              }
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Device..");
              v18 = "phNciNfc_MfCreateXchgDataHdr";
              goto LABEL_33;
            case 1:
              v6 = *v3;
              sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_MfCreateWriteHdr");
              v7 = *(_QWORD *)(a1 + 4512);
              if (!v7)
              {
                v9 = (unsigned int *)(a1 + 6476);
                v8 = " Invalid Device..";
                goto LABEL_28;
              }
              if ((v6 - 16) <= 0xFFFFFFF1 && *(_DWORD *)(v7 + 4) == 8)
              {
                v8 = " Invalid Block Address ..";
                v9 = (unsigned int *)(a1 + 6476);
LABEL_28:
                sub_219850628(1, v9, 3u, 4u, (uint64_t)v8);
                v18 = "phNciNfc_MfCreateWriteHdr";
                goto LABEL_33;
              }
              phOsalNfc_SetMemory();
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Creating Write Request Header ..");
              *(_DWORD *)(a1 + 4632) = 49;
              *(_BYTE *)(a1 + 4636) = 1;
              *(_BYTE *)(a1 + 4637) = v6;
              *(_BYTE *)(a1 + 4638) = -1;
              v4 = "phNciNfc_MfCreateWriteHdr";
              goto LABEL_37;
            case 2:
              v10 = *v3;
              v11 = *(_BYTE *)(a1 + 4525);
              sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_MfCreateReadHdr");
              v12 = *(_QWORD *)(a1 + 4512);
              if (!v12)
              {
                v14 = (unsigned int *)(a1 + 6476);
                v13 = " Invalid Device..";
                goto LABEL_30;
              }
              if (v10 >= 0x10 && *(_DWORD *)(v12 + 4) == 8)
              {
                v13 = " Invalid Block Address ..";
                v14 = (unsigned int *)(a1 + 6476);
LABEL_30:
                sub_219850628(1, v14, 3u, 4u, (uint64_t)v13);
                v18 = "phNciNfc_MfCreateReadHdr";
                goto LABEL_33;
              }
              phOsalNfc_SetMemory();
              *(_DWORD *)(a1 + 4544) = 0;
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Creating Read Request Header ..");
              *(_DWORD *)(a1 + 4632) = 50;
              *(_BYTE *)(a1 + 4636) = 2;
              *(_BYTE *)(a1 + 4637) = v10;
              *(_BYTE *)(a1 + 4638) = v11;
              v4 = "phNciNfc_MfCreateReadHdr";
LABEL_37:
              sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)v4);
              break;
            case 3:
              v15 = *v3;
              sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_MfCreateSectorSelCmdHdr");
              if (*(_QWORD *)(a1 + 4512))
              {
                phOsalNfc_SetMemory();
                *(_DWORD *)(a1 + 4544) = 0;
                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Creating Write Request Header ..");
                *(_DWORD *)(a1 + 4632) = 51;
                *(_BYTE *)(a1 + 4636) = 1;
                *(_BYTE *)(a1 + 4637) = v15;
                *(_BYTE *)(a1 + 4638) = -1;
                v4 = "phNciNfc_MfCreateSectorSelCmdHdr";
                goto LABEL_37;
              }
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Device..");
              v18 = "phNciNfc_MfCreateSectorSelCmdHdr";
              goto LABEL_33;
            case 4:
              v16 = *v3;
              sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_MfCreateAuthCmdHdr");
              if (*(_QWORD *)(a1 + 4512))
              {
                *(_DWORD *)(a1 + 4544) = 0;
                phOsalNfc_SetMemory();
                sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Creating Write Request Header ..");
                *(_DWORD *)(a1 + 4632) = 64;
                *(_BYTE *)(a1 + 4636) = 2;
                *(_BYTE *)(a1 + 4637) = v16;
                v17 = *(_BYTE *)(*(_QWORD *)(a1 + 4536) + 2);
                *(_BYTE *)(a1 + 4638) = v17;
                if ((v17 & 0x10) != 0)
                {
                  *(_BYTE *)(a1 + 4636) = 3;
                  phOsalNfc_MemCopy();
                }
                v4 = "phNciNfc_MfCreateAuthCmdHdr";
                goto LABEL_37;
              }
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Device..");
              v18 = "phNciNfc_MfCreateAuthCmdHdr";
LABEL_33:
              sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)v18);
LABEL_34:
              v19 = (unsigned int *)(a1 + 6476);
              v20 = " Request Payload Header Creation Failed ..";
              goto LABEL_53;
            default:
              sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Transceive Type received ..");
              goto LABEL_34;
          }
        }
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Creating Request Payload (Header + Data)..");
        if (*(_DWORD *)(v2 + 12) == 128)
        {
          v21 = *(unsigned __int8 *)(a1 + 4636);
          if (*(_DWORD *)(a1 + 4520) == 4 && v21 == 3)
            v22 = 9;
          else
            v22 = v21 + 1;
        }
        else
        {
          v22 = 0;
        }
        v23 = *(_DWORD *)(a1 + 4544);
        *(_DWORD *)(a1 + 4608) = 0;
        *(_QWORD *)(a1 + 4600) = 0;
        Memory = phOsalNfc_GetMemory();
        *(_QWORD *)(a1 + 4600) = Memory;
        if (!Memory)
        {
          v20 = " Payload MemAlloc for Send request Failed..";
          v19 = (unsigned int *)(a1 + 6476);
LABEL_53:
          sub_219850628(1, v19, 3u, 4u, (uint64_t)v20);
          v26 = (unsigned int *)(a1 + 6476);
          v25 = " Extension Payload Packet creation Failed..";
          goto LABEL_54;
        }
        *(_DWORD *)(a1 + 4608) = v23 + v22;
        phOsalNfc_SetMemory();
        if (*(_DWORD *)(v2 + 12) == 128)
        {
          **(_BYTE **)(a1 + 4600) = *(_DWORD *)(a1 + 4632);
          if (*(_BYTE *)(a1 + 4636))
            phOsalNfc_MemCopy();
        }
        if (v23)
          phOsalNfc_MemCopy();
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Payload (Header + Data) created successfully..");
        phOsalNfc_SetMemory();
        LODWORD(v28) = 0;
        if (sub_219878C88((unsigned int *)a1, v2, (_BYTE *)((unint64_t)&v28 | 0xC)))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(a1 + 4600) = 0;
          *(_DWORD *)(a1 + 4608) = 0;
          v25 = " Couldn't Get ConnId..";
          v26 = (unsigned int *)(a1 + 6476);
LABEL_54:
          sub_219850628(1, v26, 3u, 4u, (uint64_t)v25);
          v5 = 255;
          goto LABEL_55;
        }
        *(_QWORD *)&v29 = *(_QWORD *)(a1 + 4600);
        DWORD2(v29) = *(_DWORD *)(a1 + 4608);
        if (sub_2198F2D0C(a1 + 888, (uint64_t)&v28, a1 + 3760, *(unsigned __int16 *)(a1 + 4526), (uint64_t)sub_2198F135C, a1) == 13)
        {
          v5 = 13;
        }
        else
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(a1 + 4600) = 0;
          *(_DWORD *)(a1 + 4608) = 0;
          v5 = 255;
        }
        *(_WORD *)(a1 + 4526) = 0;
      }
      else
      {
        v5 = 1;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Length..");
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Invalid Device..");
      v5 = 6;
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v5 = 1;
  }
LABEL_55:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendMfReq");
  return v5;
}

uint64_t sub_2198AD2CC(uint64_t a1, int a2)
{
  unsigned int v4;
  unsigned __int8 *v5;
  uint64_t v6;
  unsigned int v7;
  int v8;
  unsigned int *v9;
  __int16 v10;
  const char *v11;
  unsigned int *v12;
  const char *v13;
  unsigned int v14;
  unsigned int v15;
  unsigned int v16;
  unsigned int *v17;
  const char *v18;
  int v19;
  int v20;
  int v21;
  unsigned int *v22;
  int v23;
  unsigned int v24;
  const char *v25;
  unsigned int v26;
  unsigned int *v27;
  const char *v28;
  unsigned __int16 v30;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RecvMfResp");
  if (!a1)
  {
    v30 = 1;
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    goto LABEL_88;
  }
  if (a2 || (v4 = *(_DWORD *)(a1 + 3768)) == 0 || (v5 = *(unsigned __int8 **)(a1 + 3760)) == 0)
  {
    v10 = 255;
    v30 = 255;
    v12 = (unsigned int *)(a1 + 6476);
    v13 = " Mf Data Receive Failed..";
LABEL_15:
    sub_219850628(1, v12, 3u, 4u, (uint64_t)v13);
    goto LABEL_86;
  }
  v6 = *(_QWORD *)(a1 + 4512);
  if (!v6 || *(_DWORD *)(v6 + 12) != 128)
  {
    v14 = *(_DWORD *)(a1 + 4560);
    v15 = v4 - 1;
    v16 = v5[v4 - 1];
    if (v16 <= 0xAF)
    {
      if (!v5[v4 - 1])
      {
        v30 = 0;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Mf XchgData Request is Successful!! ..");
        if (v15 <= v14)
        {
          phOsalNfc_MemCopy();
          *(_DWORD *)(a1 + 4560) = v15;
        }
        else
        {
          v30 = 8;
          sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Mf XchgData,More Data available than requested  ..");
        }
        goto LABEL_38;
      }
      if (v16 != 2)
      {
LABEL_39:
        v30 = 185;
        sub_219886108(*(_QWORD *)(a1 + 6480), v16);
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)" Mf XchgData,Unknown RF related error Detected by NFCC during Data Exchange ");
        if (v4 <= v14)
        {
          phOsalNfc_MemCopy();
          *(_DWORD *)(a1 + 4560) = v4;
        }
        goto LABEL_38;
      }
      v30 = 181;
      v17 = (unsigned int *)(a1 + 6476);
      v18 = " Mf XchgData,PH_NCINFC_STATUS_RF_FRAME_CORRUPTED Detected by NFCC during Data Exchange ";
    }
    else
    {
      switch(v5[v4 - 1])
      {
        case 0xB0u:
          v30 = 182;
          v17 = (unsigned int *)(a1 + 6476);
          v18 = " Mf XchgData,PH_NCINFC_STATUS_RF_TRANSMISSION_ERROR Detected by NFCC during Data Exchange ";
          break;
        case 0xB1u:
          v30 = 183;
          v17 = (unsigned int *)(a1 + 6476);
          v18 = " Mf XchgData,PH_NCINFC_STATUS_RF_PROTOCOL_ERROR Detected by NFCC during Data Exchange ";
          break;
        case 0xB2u:
          v30 = 178;
          v17 = (unsigned int *)(a1 + 6476);
          v18 = " Mf XchgData,PH_NCINFC_STATUS_RF_TIMEOUT_ERROR Detected by NFCC during Data Exchange ";
          break;
        case 0xB3u:
          v30 = 184;
          v17 = (unsigned int *)(a1 + 6476);
          v18 = " Mf XchgData,PH_NCINFC_STATUS_RF_UNEXPECTED_DAT Detected by NFCC during Data Exchange ";
          break;
        default:
          if (v16 == 190)
          {
            v30 = 187;
            v17 = (unsigned int *)(a1 + 6476);
            v18 = " Mf XchgData,PH_NCINFC_STATUS_HRM_SE_INIT_REQUIRED Detected by NFCC during Data Exchange ";
          }
          else
          {
            if (v16 != 191)
              goto LABEL_39;
            v30 = 186;
            v17 = (unsigned int *)(a1 + 6476);
            v18 = " Mf XchgData,PH_NCINFC_STATUS_HRM_TIMER_RUNNING Detected by NFCC during Data Exchange ";
          }
          break;
      }
    }
    sub_219850628(1, v17, 3u, 2u, (uint64_t)v18);
LABEL_38:
    sub_2198F1654(a1, &v30);
    v10 = v30;
    goto LABEL_86;
  }
  v7 = *v5;
  if (v7 <= 0x31)
  {
    if (v7 != 16)
    {
      if (v7 == 49)
      {
        if (*(_DWORD *)(a1 + 4632) == 49)
        {
          *(_DWORD *)(a1 + 4632) = 49;
          v19 = v5[1];
          *(_BYTE *)(a1 + 4637) = v19;
          v9 = (unsigned int *)(a1 + 6476);
          if (v19)
          {
            v10 = 255;
            v30 = 255;
            v11 = " Mf WriteN Request Failed ..";
            goto LABEL_69;
          }
          v30 = 0;
          v25 = " Mf WriteN Request is Successful!! ..";
          goto LABEL_59;
        }
LABEL_47:
        v10 = 255;
        v30 = 255;
        v9 = (unsigned int *)(a1 + 6476);
        v11 = " Unexpected Mf Write Response Received ..";
        goto LABEL_69;
      }
LABEL_53:
      v10 = 255;
      v30 = 255;
      v9 = (unsigned int *)(a1 + 6476);
      v11 = " Unknown RespId Received ..";
      goto LABEL_69;
    }
    if (*(_DWORD *)(a1 + 4632) != 16)
    {
      v10 = 255;
      v30 = 255;
      v9 = (unsigned int *)(a1 + 6476);
      v11 = " Unexpected Mf XchgData Response Received ..";
      goto LABEL_69;
    }
    *(_DWORD *)(a1 + 4632) = 16;
    v23 = v5[v4 - 1];
    *(_BYTE *)(a1 + 4637) = v23;
    if (v23 == 178)
    {
      if (*(_DWORD *)(v6 + 16) == 128)
      {
        v10 = 178;
        v30 = 178;
        v9 = (unsigned int *)(a1 + 6476);
        v11 = " Mf XchgData Request Failed RF Time out..";
        goto LABEL_69;
      }
    }
    else if (!v23)
    {
      v30 = 0;
      v22 = (unsigned int *)(a1 + 6476);
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Mf XchgData Request is Successful!! ..");
      v24 = *(_DWORD *)(a1 + 3768) - 2;
      if (v24 > *(_DWORD *)(a1 + 4560))
        goto LABEL_64;
      goto LABEL_89;
    }
    v10 = 255;
    v30 = 255;
    v9 = (unsigned int *)(a1 + 6476);
    v11 = " Mf XchgData Request Failed ..";
    goto LABEL_69;
  }
  if (v7 == 50)
  {
    if (*(_DWORD *)(a1 + 4632) != 50)
    {
      v10 = 255;
      v30 = 255;
      v9 = (unsigned int *)(a1 + 6476);
      v11 = " Unexpected Mf Read Response Received ..";
      goto LABEL_69;
    }
    *(_DWORD *)(a1 + 4632) = 50;
    v20 = v5[1];
    *(_BYTE *)(a1 + 4637) = v20;
    v9 = (unsigned int *)(a1 + 6476);
    if (v20)
    {
      v10 = 255;
      v30 = 255;
      v11 = " Mf ReadN Request Failed ..";
      goto LABEL_69;
    }
    v30 = 0;
    sub_219850628(1, v9, 3u, 4u, (uint64_t)" Mf ReadN Request is Successful!! ..");
    v10 = 0;
    if ((*(_DWORD *)(a1 + 3768) - 2) > *(_DWORD *)(a1 + 4560))
      goto LABEL_70;
    phOsalNfc_MemCopy();
LABEL_60:
    v10 = 0;
    goto LABEL_70;
  }
  if (v7 != 51)
  {
    if (v7 == 64)
    {
      if (*(_DWORD *)(a1 + 4632) == 64)
      {
        *(_DWORD *)(a1 + 4632) = 64;
        v8 = v5[1];
        *(_BYTE *)(a1 + 4637) = v8;
        v9 = (unsigned int *)(a1 + 6476);
        if (v8)
        {
          v10 = 255;
          v30 = 255;
          v11 = " Mf Auth Fail ..";
LABEL_69:
          sub_219850628(1, v9, 3u, 4u, (uint64_t)v11);
          goto LABEL_70;
        }
        v30 = 0;
        v25 = " Mf Auth Pass ..";
LABEL_59:
        sub_219850628(1, v9, 3u, 4u, (uint64_t)v25);
        goto LABEL_60;
      }
      goto LABEL_47;
    }
    goto LABEL_53;
  }
  if (*(_DWORD *)(a1 + 4632) != 51)
    goto LABEL_47;
  *(_DWORD *)(a1 + 4632) = 51;
  v21 = v5[1];
  *(_BYTE *)(a1 + 4637) = v21;
  v22 = (unsigned int *)(a1 + 6476);
  if (v21)
  {
    v10 = 255;
    v30 = 255;
    v11 = " Mf WriteN Request Failed ..";
LABEL_65:
    v9 = v22;
    goto LABEL_69;
  }
  v30 = 0;
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Mf Sector select Request is Successful!! ..");
  v24 = *(_DWORD *)(a1 + 3768) - 2;
  if (v24 > *(_DWORD *)(a1 + 4560))
  {
LABEL_64:
    v10 = 8;
    v30 = 8;
    v11 = " Mf XchgData,More Data available than requested  ..";
    goto LABEL_65;
  }
LABEL_89:
  phOsalNfc_MemCopy();
  v10 = 0;
  *(_DWORD *)(a1 + 4560) = v24;
LABEL_70:
  v26 = *(unsigned __int8 *)(a1 + 4637);
  if (v26 <= 0xAF)
  {
    if (!*(_BYTE *)(a1 + 4637))
      goto LABEL_86;
    if (v26 == 2)
    {
      v10 = 181;
      v30 = 181;
      v27 = (unsigned int *)(a1 + 6476);
      v28 = "PH_NCINFC_STATUS_RF_FRAME_CORRUPTED Detected by NFCC during Data Exchange ";
    }
    else
    {
LABEL_83:
      if (v7 == 64)
        goto LABEL_86;
      v10 = 185;
      v30 = 185;
      sub_219886108(*(_QWORD *)(a1 + 6480), v26);
      v27 = (unsigned int *)(a1 + 6476);
      v28 = "Unknown RF related error Detected by NFCC during Data Exchange ";
    }
  }
  else
  {
    switch(*(_BYTE *)(a1 + 4637))
    {
      case 0xB0:
        v10 = 182;
        v30 = 182;
        v27 = (unsigned int *)(a1 + 6476);
        v28 = "PH_NCINFC_STATUS_RF_TRANSMISSION_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB1:
        v10 = 183;
        v30 = 183;
        v27 = (unsigned int *)(a1 + 6476);
        v28 = "PH_NCINFC_STATUS_RF_PROTOCOL_ERROR Detected by NFCC during Data Exchange ";
        break;
      case 0xB2:
        v10 = 178;
        v30 = 178;
        v12 = (unsigned int *)(a1 + 6476);
        v13 = "PH_NCINFC_STATUS_RF_TIMEOUT_ERROR Detected by NFCC during Data Exchange ";
        goto LABEL_15;
      case 0xB3:
        v10 = 184;
        v30 = 184;
        v27 = (unsigned int *)(a1 + 6476);
        v28 = "PH_NCINFC_STATUS_RF_UNEXPECTED_DAT Detected by NFCC during Data Exchange ";
        break;
      default:
        if (v26 == 190)
        {
          v10 = 187;
          v30 = 187;
          v27 = (unsigned int *)(a1 + 6476);
          v28 = "PH_NCINFC_STATUS_HRM_SE_INIT_REQUIRED Detected by NFCC during Data Exchange ";
        }
        else
        {
          if (v26 != 191)
            goto LABEL_83;
          v10 = 186;
          v30 = 186;
          v27 = (unsigned int *)(a1 + 6476);
          v28 = "PH_NCINFC_STATUS_HRM_TIMER_RUNNING Detected by NFCC during Data Exchange ";
        }
        break;
    }
  }
  sub_219850628(1, v27, 3u, 2u, (uint64_t)v28);
LABEL_86:
  *(_WORD *)(a1 + 4592) = v10;
  if (*(_QWORD *)(a1 + 4600))
  {
    *(_DWORD *)(a1 + 4608) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Freeing Send Request Payload Buffer..");
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 4600) = 0;
  }
LABEL_88:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_RecvMfResp");
  return v30;
}

uint64_t sub_2198ADAA0(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreInitRecverStateMachine");
  if (a1)
  {
    *(_QWORD *)(a1 + 2264) = off_2550A2AA0;
    *(_QWORD *)(a1 + 2272) = &unk_2550A41E0;
    *(_QWORD *)(a1 + 2280) = &unk_2550A2AC0;
    *(_QWORD *)(a1 + 2256) = 0x500000000;
    v2 = *(_QWORD *)(a1 + 984);
    if (v2 && v2 != 0xFFFFFFFFFFFFLL)
      phOsalNfc_Timer_Delete();
    *(_QWORD *)(a1 + 984) = 0xFFFFFFFFFFFFLL;
    v3 = phOsalNfc_Timer_Create();
    if (v3 != 0xFFFFFFFFFFFFLL)
    {
      v4 = v3;
      if (v3)
      {
        sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Response Timer Created Successfully");
        *(_QWORD *)(a1 + 984) = v4;
        *(_BYTE *)(a1 + 992) = 0;
        sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"InitRecverStateMachine: SUCCESS");
        v5 = 0;
        goto LABEL_11;
      }
    }
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Response Timer Create failed");
    v5 = 12;
  }
  else
  {
    v5 = 1;
  }
  sub_219850628(3, (unsigned int *)a1, 3u, 1u, (uint64_t)"InitRecverStateMachine: FAILED");
LABEL_11:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreInitRecverStateMachine");
  return v5;
}

uint64_t sub_2198ADC00(uint64_t a1)
{
  uint64_t v2;
  BOOL v3;
  uint64_t v4;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReleaseRecverStateMachine");
  if (a1)
  {
    v2 = *(_QWORD *)(a1 + 984);
    if (v2)
      v3 = v2 == 0xFFFFFFFFFFFFLL;
    else
      v3 = 1;
    if (v3)
    {
      v4 = 0;
    }
    else
    {
      phOsalNfc_Timer_Delete();
      v4 = 0;
      *(_QWORD *)(a1 + 984) = 0xFFFFFFFFFFFFLL;
      *(_BYTE *)(a1 + 992) = 0;
    }
  }
  else
  {
    v4 = 1;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReleaseRecverStateMachine");
  return v4;
}

uint64_t sub_2198ADC9C(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  int v6;
  char v7;
  BOOL v8;
  unsigned __int8 v10;

  v10 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvChkExptdPktType");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 == a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Connector - Check Expected Packet Type");
    v6 = sub_2198C6618(a1, &v10);
    v7 = v10;
    if (v6)
      v8 = 1;
    else
      v8 = v10 > 2u;
    v5 = v8;
    if ((_DWORD)v5)
      v7 = -1;
    *(_BYTE *)(a1 + 952) = v7;
  }
  else
  {
LABEL_6:
    v5 = 255;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvChkExptdPktType");
  return v5;
}

uint64_t sub_2198ADD88(uint64_t a1)
{
  int v2;
  unsigned __int8 v3;
  BOOL v4;
  uint64_t v5;
  unsigned __int8 v7;

  v7 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvChkNewEntry");
  if (a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Connector - Check New Entry");
    v2 = sub_2198C6740((unsigned int *)a1, &v7);
    v3 = v7;
    if (v2)
      v4 = 1;
    else
      v4 = v7 > 2u;
    v5 = v4;
    if ((_DWORD)v5)
      v3 = 0;
    *(_BYTE *)(a1 + 952) = v3;
  }
  else
  {
    v5 = 0;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreRecvChkNewEntry");
  return v5;
}

uint64_t sub_2198ADE3C(unsigned int *a1)
{
  char v2;
  uint64_t v3;
  uint64_t *v4;
  uint64_t v5;
  unsigned int v6;
  uint64_t v7;
  uint64_t (**v8)(uint64_t);
  uint64_t (*v9)(uint64_t);
  _BOOL4 v11;
  int *v13;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateRecv2Recv");
  if (!a1)
    goto LABEL_21;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = (uint64_t *)*((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != (uint64_t *)a1);
  if (v4 != (uint64_t *)a1 || *((_BYTE *)a1 + 992) != 1)
    goto LABEL_21;
  v5 = 0;
  v6 = a1[242];
  if (v6 != a1[228])
    goto LABEL_22;
  v7 = *(_QWORD *)a1;
  if (!*(_QWORD *)a1)
    goto LABEL_22;
  v8 = *(uint64_t (***)(uint64_t))(v7 + 4760);
  if (!v8)
    goto LABEL_21;
  v5 = 0;
  v9 = *v8;
  v11 = v9 == sub_2198DB9A8 || v9 == sub_21989B6B4;
  if (v6 || !v11)
    goto LABEL_22;
  if (*((unsigned __int8 *)a1 + 980) != *((unsigned __int8 *)a1 + 924))
  {
LABEL_21:
    v5 = 0;
    goto LABEL_22;
  }
  phOsalNfc_Timer_Stop();
  *(_BYTE *)(v7 + 6464) = 0;
  v5 = phOsalNfc_Timer_Start();
  if ((_DWORD)v5)
  {
    *((_BYTE *)a1 + 992) = 0;
    sub_219850628(1, a1 + 617, 3u, 1u, (uint64_t)"Response Timer ReStart failed!!!");
  }
  else
  {
    v13 = &dword_253E47158;
    if (!a1[617])
      v13 = &dword_253E47070;
    v13[1] &= ~0x10u;
    sub_219850628(1, a1 + 617, 3u, 4u, (uint64_t)"Response timer re-started");
    *((_BYTE *)a1 + 992) = 1;
  }
LABEL_22:
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateRecv2Recv");
  return v5;
}

uint64_t sub_2198ADFF8(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  char v8;
  uint64_t v9;
  uint64_t v10;
  int v11;
  unsigned int *v12;
  const char *v13;
  char v14;
  __int16 v15;
  int *v16;
  char v17;

  v17 = 0;
  sub_219850718(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_RspTimeOutCb");
  if (a2)
  {
    v3 = 0;
    v4 = 0;
    do
    {
      v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 5);
      if ((v3 & 1) != 0)
        break;
      v3 = 1;
      v4 = 1;
    }
    while (v5 != a2);
    if (v5 == a2)
    {
      v7 = *(_QWORD *)a2;
      if (*(_QWORD *)a2)
      {
        v8 = 0;
        v9 = 0;
        do
        {
          v10 = *((_QWORD *)&unk_253E46700 + 14 * v9 + 4);
          if ((v8 & 1) != 0)
            break;
          v8 = 1;
          v9 = 1;
        }
        while (v10 != v7);
        if (v10 == v7)
        {
          if (!*(_BYTE *)(v7 + 6464))
          {
            phOsalNfc_Timer_Stop();
            if (!phOsalNfc_Timer_Start())
            {
              sub_219850628(1, (unsigned int *)(a2 + 2468), 3u, 4u, (uint64_t)"Response timer re-started with extended time");
              *(_BYTE *)(v7 + 6464) = 1;
              return sub_219850808(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_RspTimeOutCb");
            }
            sub_219850628(1, (unsigned int *)(a2 + 2468), 3u, 1u, (uint64_t)"Response Timer extended time ReStart failed!!!");
          }
          *(_BYTE *)(v7 + 6464) = 0;
          *(_BYTE *)(a2 + 992) = 0;
          v11 = *(_DWORD *)(a2 + 968);
          if (v11)
          {
            if (v11 != 2)
            {
              v15 = 1;
              sub_219850628(1, (unsigned int *)(a2 + 2468), 3u, 1u, (uint64_t)"Timer expired - Should never enter here");
              sub_219886108(*(_QWORD *)(a2 + 632), 1);
              v14 = 0;
              goto LABEL_22;
            }
            v12 = (unsigned int *)(a2 + 2468);
            v13 = "NCI RSP : Timer expired before response is received!";
          }
          else
          {
            v12 = (unsigned int *)(a2 + 2468);
            v13 = "NCI DATA RSP : Timer expired before data is received!";
          }
          v14 = 1;
          sub_219850628(1, v12, 3u, 1u, (uint64_t)v13);
          sub_219879C68(v7, 0);
          v15 = 44;
          sub_219886108(*(_QWORD *)(a2 + 632), 44);
          phTmlNfc_ReadAbort();
          phTmlNfc_FlushTxRxBuffers();
          *(_DWORD *)(a2 + 2440) = 0;
          *(_QWORD *)(a2 + 2448) = 0;
          sub_219853908(a2);
          if (sub_219851DC0(a2, 0, 3) != 13)
            sub_219850628(1, v12, 3u, 1u, (uint64_t)"phNciNfc_RspTimeOutCb: Tml Read request failed!");
LABEL_22:
          if (*(_BYTE *)(v7 + 6568) != 1)
          {
            if (sub_21988F5D4(*(_QWORD *)(v7 + 6480), &v17))
            {
              sub_219850628(1, (unsigned int *)(a2 + 2468), 3u, 1u, (uint64_t)"phNciNfc_CoreRecvManager4-Failed to retrieve bIgnoreWkUpRet");
LABEL_25:
              v15 = 255;
              sub_219886108(*(_QWORD *)(a2 + 632), 255);
              goto LABEL_26;
            }
            if (sub_2198B00C4(*(_QWORD *)(a2 + 632), 20))
            {
              if (v17 != 1)
              {
                sub_219850628(1, (unsigned int *)(a2 + 2468), 3u, 1u, (uint64_t)"phNciNfc_CoreRecvManager4-Fialed to De-Assert Wake Up Line");
                if ((v14 & 1) == 0)
                  goto LABEL_25;
              }
            }
          }
LABEL_26:
          if (*(_DWORD *)(a2 + 2468))
            v16 = &dword_253E47158;
          else
            v16 = &dword_253E47070;
          v16[1] |= 0x10u;
          *(_WORD *)(a2 + 2288) = v15;
          sub_219851308(a2, 2u);
        }
      }
    }
  }
  return sub_219850808(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_RspTimeOutCb");
}

uint64_t sub_2198AE320(unsigned int *a1)
{
  char v2;
  uint64_t v3;
  uint64_t *v4;
  uint64_t v5;
  unsigned int v6;
  uint64_t v7;
  uint64_t (**v8)(uint64_t);
  uint64_t (*v9)(uint64_t);
  _BOOL4 v11;
  int *v13;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateIdle2Recv");
  if (!a1)
    goto LABEL_21;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = (uint64_t *)*((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != (uint64_t *)a1);
  if (v4 != (uint64_t *)a1 || *((_BYTE *)a1 + 992) != 1)
    goto LABEL_21;
  v5 = 0;
  v6 = a1[242];
  if (v6 != a1[228])
    goto LABEL_22;
  v7 = *(_QWORD *)a1;
  if (!*(_QWORD *)a1)
    goto LABEL_22;
  v8 = *(uint64_t (***)(uint64_t))(v7 + 4760);
  if (!v8)
    goto LABEL_21;
  v5 = 0;
  v9 = *v8;
  v11 = v9 == sub_2198DB9A8 || v9 == sub_21989B6B4;
  if (v6 || !v11)
    goto LABEL_22;
  if (*((unsigned __int8 *)a1 + 980) != *((unsigned __int8 *)a1 + 924))
  {
LABEL_21:
    v5 = 0;
    goto LABEL_22;
  }
  phOsalNfc_Timer_Stop();
  *(_BYTE *)(v7 + 6464) = 0;
  v5 = phOsalNfc_Timer_Start();
  if ((_DWORD)v5)
  {
    *((_BYTE *)a1 + 992) = 0;
    sub_219850628(1, a1 + 617, 3u, 1u, (uint64_t)"Response Timer ReStart failed!!!");
  }
  else
  {
    v13 = &dword_253E47158;
    if (!a1[617])
      v13 = &dword_253E47070;
    v13[1] &= ~0x10u;
    sub_219850628(1, a1 + 617, 3u, 4u, (uint64_t)"Response timer re-started");
    *((_BYTE *)a1 + 992) = 1;
  }
LABEL_22:
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateIdle2Recv");
  return v5;
}

uint64_t sub_2198AE4DC(unsigned int *a1)
{
  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateRecv2Dummy");
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateRecv2Dummy");
  return 0;
}

uint64_t sub_2198AE534(unsigned int *a1)
{
  uint64_t v2;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateDummy2Recv");
  sub_219850628(3, a1, 3u, 4u, (uint64_t)"Dummy to Receive Transition");
  v2 = sub_2198519D8((uint64_t)a1);
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_StateDummy2Recv");
  return v2;
}

uint64_t sub_2198AE5BC(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  const char *v4;
  int v5;
  unsigned int *v6;
  uint64_t v7;
  const char *v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreInitialise");
  if (!a1)
  {
    v4 = "Invalid input parameter";
    v3 = 1;
    v5 = 3;
    v6 = 0;
    goto LABEL_5;
  }
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  *(_BYTE *)(a1 + 2352) = 0;
  v2 = sub_219860A4C(a1);
  if ((_DWORD)v2)
  {
    v3 = v2;
    v4 = "CoreRecvMgr Init failed!";
    v5 = 1;
    v6 = (unsigned int *)(a1 + 2468);
LABEL_5:
    sub_219850628(v5, v6, 3u, 1u, (uint64_t)v4);
    goto LABEL_11;
  }
  v7 = sub_2198C7B30(*(_QWORD *)a1);
  if ((_DWORD)v7)
  {
    v3 = v7;
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Logical connection Init failed!");
    v8 = "Releasing CoreRecvMgr...";
LABEL_10:
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)v8);
    sub_219860B08((unsigned int *)a1);
    goto LABEL_11;
  }
  v9 = sub_2198ADAA0(a1);
  if ((_DWORD)v9)
  {
    v3 = v9;
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"NCI Core Receiver State Machine Init Failed");
    v8 = "Releasing RecvMgr...";
    goto LABEL_10;
  }
  v11 = sub_21987FEF8(*(unsigned int **)a1);
  if (!(_DWORD)v11)
  {
    v12 = sub_2198AE858((unsigned int *)a1);
    if ((_DWORD)v12 == 13)
    {
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"NCI Core Initialization success!");
    }
    else
    {
      v3 = v12;
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Releasing RecvMgr...");
      sub_219860B08((unsigned int *)a1);
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Recever State machine release...");
      sub_2198ADC00(a1);
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Sender State machine release...");
      sub_21987FEF8(*(unsigned int **)a1);
      if ((_DWORD)v3)
        goto LABEL_11;
    }
    v3 = sub_2198F31D0(a1, 32);
    goto LABEL_11;
  }
  v3 = v11;
  sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"NCI Core Sender State Machine Init Failed");
  sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Releasing RecvMgr...");
  sub_219860B08((unsigned int *)a1);
  sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Recever State machine release...");
  sub_2198ADC00(a1);
LABEL_11:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreInitialise");
  return v3;
}

uint64_t sub_2198AE858(unsigned int *a1)
{
  uint64_t v2;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReceiveManager_Init");
  if (a1)
  {
    v2 = sub_219851DC0((uint64_t)a1, 0, 3);
    if ((_DWORD)v2 != 13)
    {
      sub_219850628(1, a1 + 617, 3u, 1u, (uint64_t)"Tml Read request failed!");
      sub_219853908((uint64_t)a1);
    }
  }
  else
  {
    v2 = 1;
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"Invalid Core context!");
  }
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReceiveManager_Init");
  return v2;
}

uint64_t sub_2198AE918(uint64_t a1)
{
  unsigned int v2;
  unint64_t v3;
  _QWORD *v4;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReleaseNfceeCntx");
  v2 = *(unsigned __int8 *)(a1 + 3944);
  if (*(_BYTE *)(a1 + 3944))
  {
    v3 = 0;
    v4 = (_QWORD *)(a1 + 3984);
    do
    {
      if (*v4)
      {
        phOsalNfc_FreeMemory();
        *v4 = 0;
        v2 = *(unsigned __int8 *)(a1 + 3944);
      }
      ++v3;
      v4 += 13;
    }
    while (v3 < v2);
  }
  return sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ReleaseNfceeCntx");
}

uint64_t sub_2198AE9A8(unsigned int *a1)
{
  uint64_t v1;
  char v2;
  uint64_t v3;
  _BYTE *v4;
  uint64_t v5;
  unsigned int *v6;
  unsigned int *v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  int *v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;
  char v17;
  uint64_t v18;
  uint64_t v19;
  uint64_t v20;
  uint64_t v21;
  unsigned int **v22;
  uint64_t v23;
  uint64_t v25;

  v1 = (uint64_t)a1;
  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_ReleaseNciHandle");
  if (!v1)
  {
    sub_2198C82D4(0);
LABEL_40:
    sub_219850628(2, (unsigned int *)v1, 3u, 4u, (uint64_t)"Releasing NCI context has already been done");
    v20 = 49;
    goto LABEL_71;
  }
  v2 = 0;
  v3 = 0;
  v4 = (_BYTE *)(v1 + 6464);
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v5 != v1);
  v6 = sub_2198C82D4((unsigned int *)v1);
  if (v5 != v1)
    goto LABEL_40;
  v7 = v6;
  v8 = *(_QWORD *)(v1 + 1440);
  if (v8 && v8 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(v1 + 1440) = 0xFFFFFFFFFFFFLL;
  }
  v9 = *(_QWORD *)(v1 + 3344);
  if (v9 && v9 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(v1 + 3344) = 0xFFFFFFFFFFFFLL;
  }
  v10 = *(_QWORD *)(v1 + 1872);
  if (v10 && v10 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    phOsalNfc_Timer_Delete();
    *v4 = 0;
    *(_QWORD *)(v1 + 1872) = 0xFFFFFFFFFFFFLL;
    *(_BYTE *)(v1 + 1880) = 0;
  }
  v11 = *(_QWORD *)(v1 + 4664);
  if (v11 && v11 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    sub_21988629C(1, (unsigned int *)(v1 + 6476), *(_QWORD *)(v1 + 4664), 3u, 4u, (uint64_t)"phNciNfc_ReleaseNciHandle");
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(v1 + 4664) = 0xFFFFFFFFFFFFLL;
  }
  if (v7)
  {
    v12 = *((_QWORD *)v7 + 7);
    if (v12)
    {
      if (v12 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Stop();
        phOsalNfc_Timer_Delete();
        *(_BYTE *)(v1 + 6465) = 0;
        *((_BYTE *)v7 + 64) = 0;
        *((_QWORD *)v7 + 7) = 0;
        v13 = &dword_253E47158;
        if (!*(_DWORD *)(v1 + 6476))
          v13 = &dword_253E47070;
        v13[1] &= ~8u;
      }
    }
  }
  v14 = *(_QWORD *)(v1 + 4656);
  if (v14 && v14 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(v1 + 4656) = 0xFFFFFFFFFFFFLL;
  }
  v15 = *(_QWORD *)(v1 + 6456);
  if (v15 && v15 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    *v4 = 0;
    sub_21988629C(1, (unsigned int *)(v1 + 6476), *(_QWORD *)(v1 + 6456), 3u, 4u, (uint64_t)"phNciNfc_ReleaseNciHandle");
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(v1 + 6456) = 0xFFFFFFFFFFFFLL;
  }
  v16 = *(_QWORD *)(v1 + 4832);
  if (v16 && v16 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    *v4 = 0;
    sub_21988629C(1, (unsigned int *)(v1 + 6476), *(_QWORD *)(v1 + 4832), 3u, 4u, (uint64_t)"phNciNfc_ReleaseNciHandle");
    phOsalNfc_Timer_Delete();
    *(_QWORD *)(v1 + 4832) = 0xFFFFFFFFFFFFLL;
  }
  sub_21985DC44(v1);
  *(_DWORD *)(v1 + 172) = 0;
  sub_2198636E8(v1);
  sub_2198AE918(v1);
  v25 = 0;
  sub_219850718(2, (unsigned int *)v1, 3u, 5u, (uint64_t)"phNciNfc_ReleaseMemory");
  v17 = 0;
  v18 = 0;
  do
  {
    v19 = *((_QWORD *)&unk_253E46700 + 14 * v18 + 4);
    if ((v17 & 1) != 0)
      break;
    v17 = 1;
    v18 = 1;
  }
  while (v19 != v1);
  if (v19 == v1)
  {
    v21 = *(_QWORD *)(v1 + 6480);
    v25 = v21;
    v22 = (unsigned int **)(v1 + 888);
    sub_219850718(3, (unsigned int *)(v1 + 888), 3u, 5u, (uint64_t)"phNciNfc_CoreRelease");
    if (sub_219860B08((unsigned int *)(v1 + 888)))
    {
      sub_219850628(1, (unsigned int *)(v1 + 3356), 3u, 1u, (uint64_t)"Ntf Handler release failed");
      sub_219850808(3, (unsigned int *)(v1 + 888), 3u, 5u, (uint64_t)"phNciNfc_CoreRelease");
      sub_219850628(1, (unsigned int *)(v1 + 6476), 3u, 1u, (uint64_t)"Nci Core release failed!");
      v20 = 255;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(v1 + 3356), 3u, 4u, (uint64_t)"Notification manager release success");
      phTmlNfc_ReadAbort();
      phTmlNfc_FlushTxRxBuffers();
      if (sub_21988F8B8(*(_QWORD *)(v1 + 1520)) == 1)
      {
        phTmlNfc_WriteAbort();
        sub_21988F804(*(_QWORD *)(v1 + 1520), 0);
      }
      sub_219850718(3, (unsigned int *)(v1 + 888), 3u, 5u, (uint64_t)"phNciNfc_CoreReleaseSendRecvStateMachines");
      if (*v22)
      {
        if (sub_21987FEF8(*v22))
          sub_219850628(1, (unsigned int *)(v1 + 3356), 3u, 1u, (uint64_t)"Release Sender State Machine failed!");
        if (sub_2198ADC00(v1 + 888))
          sub_219850628(1, (unsigned int *)(v1 + 3356), 3u, 1u, (uint64_t)"Release Recever State Machine failed!");
      }
      sub_219850808(3, (unsigned int *)(v1 + 888), 3u, 5u, (uint64_t)"phNciNfc_CoreReleaseSendRecvStateMachines");
      sub_219853908(v1 + 888);
      v23 = *(_QWORD *)(v1 + 1440);
      if (v23 && v23 != 0xFFFFFFFFFFFFLL)
      {
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(v1 + 1440) = 0xFFFFFFFFFFFFLL;
      }
      sub_219850808(3, (unsigned int *)(v1 + 888), 3u, 5u, (uint64_t)"phNciNfc_CoreRelease");
      if (*(_QWORD *)(v1 + 3256))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v1 + 3256) = 0;
      }
      if (*(_QWORD *)(v1 + 3272))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v1 + 3272) = 0;
      }
      if (*(_QWORD *)(v1 + 3296))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v1 + 3296) = 0;
      }
      if (*(_QWORD *)(v1 + 848))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v1 + 848) = 0;
      }
      if (*(_QWORD *)(v1 + 160))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v1 + 160) = 0;
      }
      if (*(_QWORD *)(v1 + 4760))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v1 + 4760) = 0;
      }
      if (*(_QWORD *)(v1 + 4600))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v1 + 4600) = 0;
      }
      if (*(_QWORD *)(v1 + 4616))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v1 + 4616) = 0;
      }
      sub_219850628(1, (unsigned int *)(v1 + 6476), 3u, 4u, (uint64_t)"Nci Release invoked - Release Nci Context handle");
      phOsalNfc_FreeMemory();
      sub_21988F25C(v21, 0);
      sub_21988F310(v21, 0);
      v20 = 0;
    }
  }
  else
  {
    v20 = 1;
    sub_219850628(2, (unsigned int *)v1, 3u, 1u, (uint64_t)"Invalid input parameter");
  }
  sub_219850808(0, (unsigned int *)&v25, 3u, 5u, (uint64_t)"phNciNfc_ReleaseMemory");
  v1 = 0;
LABEL_71:
  sub_219850808(2, (unsigned int *)v1, 3u, 5u, (uint64_t)"phNciNfc_ReleaseNciHandle");
  return v20;
}

uint64_t sub_2198AF020(uint64_t a1, _DWORD *a2)
{
  uint64_t v4;
  int v5;
  int v6;
  int v7;
  _BYTE *v8;
  int v10;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreBuildCmdPkt");
  v4 = 1;
  if (!a1 || !a2)
    goto LABEL_19;
  v5 = a2[1];
  v6 = a2[2];
  if (v5 > 1)
  {
    if (v5 == 2)
    {
      v7 = sub_2198AF490((unsigned int *)a1, (uint64_t)a2, a2[2]);
    }
    else
    {
      if (v5 != 15)
        goto LABEL_16;
      v7 = sub_2198AF530((unsigned int *)a1, (uint64_t)a2, a2[2]);
    }
  }
  else
  {
    if (v5)
    {
      if (v5 == 1)
      {
        v7 = sub_2198AF34C((unsigned int *)a1, (uint64_t)a2, a2[2]);
        goto LABEL_12;
      }
LABEL_16:
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Build Comand packet: Invalid GID");
      if (*(_BYTE *)(a1 + 624))
        goto LABEL_18;
LABEL_17:
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Max Control Paload Length is not available !!!!!");
      v4 = 244;
      goto LABEL_18;
    }
    v7 = sub_2198AF254((unsigned int *)a1, (uint64_t)a2, a2[2]);
  }
LABEL_12:
  if (!*(_BYTE *)(a1 + 624))
    goto LABEL_17;
  if (v7)
  {
LABEL_18:
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"Build Comand packet failed!");
    goto LABEL_19;
  }
  v8 = (_BYTE *)(a1 + 276);
  phOsalNfc_SetMemory();
  *(_BYTE *)(a1 + 276) = *(_BYTE *)(a1 + 276) & 0x10 | v5 | 0x20;
  *(_BYTE *)(a1 + 277) = *(_BYTE *)(a1 + 277) & 0xC0 | v6 & 0x3F;
  *(_BYTE *)(a1 + 278) = a2[6];
  if (a2[6] <= *(unsigned __int8 *)(a1 + 624))
  {
    *v8 = v5 | 0x20;
    if (a2[6])
    {
      phOsalNfc_MemCopy();
      v10 = a2[6] + 3;
    }
    else
    {
      v10 = 3;
    }
    *(_DWORD *)(a1 + 540) = v10;
    sub_219851FF8(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Comand packet:", a1 + 276);
    v4 = 0;
  }
  else
  {
    *v8 = v5 | 0x30;
    sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)" Segmentation on Comand not allowed!, Max Cntrl Payload");
    v4 = 255;
  }
LABEL_19:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreBuildCmdPkt");
  return v4;
}

BOOL sub_2198AF254(unsigned int *a1, uint64_t a2, int a3)
{
  _BOOL8 v6;
  unsigned int v7;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreValidateNciCoreCmd");
  switch(a3)
  {
    case 0:
      if (*(_DWORD *)(a2 + 24) != 1)
        goto LABEL_7;
      goto LABEL_17;
    case 1:
      if (*(_DWORD *)(a2 + 24))
        goto LABEL_17;
      v6 = 0;
      break;
    case 2:
      if (*(_DWORD *)(a2 + 24) <= 2u)
        goto LABEL_7;
      goto LABEL_17;
    case 3:
      if (*(_DWORD *)(a2 + 24) > 1u)
        goto LABEL_17;
      goto LABEL_7;
    case 4:
      v7 = *(_DWORD *)(a2 + 24);
      if (v7 <= 3 && v7 != 2)
        goto LABEL_7;
      goto LABEL_17;
    case 5:
      if (!*(_DWORD *)(a2 + 24))
        goto LABEL_7;
LABEL_17:
      v6 = *(_QWORD *)(a2 + 16) == 0;
      break;
    default:
LABEL_7:
      v6 = 1;
      break;
  }
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreValidateNciCoreCmd");
  return v6;
}

BOOL sub_2198AF34C(unsigned int *a1, uint64_t a2, int a3)
{
  _BOOL8 v6;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreValidateRfMgtCmd");
  v6 = 1;
  switch(a3)
  {
    case 0:
      if (*(_DWORD *)(a2 + 24) >= 4u)
        goto LABEL_17;
      break;
    case 1:
      if (*(_DWORD *)(a2 + 24) >= 7u)
        goto LABEL_17;
      break;
    case 2:
      v6 = *(_DWORD *)(a2 + 24) != 0;
      break;
    case 3:
      if (*(_DWORD *)(a2 + 24) >= 3u && *(_QWORD *)(a2 + 16))
        v6 = 0;
      else
        sub_219850628(3, a1, 3u, 1u, (uint64_t)"Discovery command payload empty!!");
      break;
    case 4:
      if (*(_DWORD *)(a2 + 24) == 3)
        goto LABEL_17;
      break;
    case 6:
      if (*(_DWORD *)(a2 + 24) == 1)
        goto LABEL_17;
      break;
    case 8:
      if (*(_DWORD *)(a2 + 24) == 4)
        goto LABEL_17;
      break;
    case 11:
      if (*(_DWORD *)(a2 + 24) >= 3u)
LABEL_17:
        v6 = *(_QWORD *)(a2 + 16) == 0;
      break;
    default:
      break;
  }
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreValidateRfMgtCmd");
  return v6;
}

BOOL sub_2198AF490(unsigned int *a1, uint64_t a2, int a3)
{
  _BOOL8 v6;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreValidateNfceeMgtCmd");
  if (a3 != 1)
  {
    if (a3 || *(_DWORD *)(a2 + 24) != 1)
      goto LABEL_4;
LABEL_6:
    v6 = *(_QWORD *)(a2 + 16) == 0;
    goto LABEL_7;
  }
  if (*(_DWORD *)(a2 + 24) == 2)
    goto LABEL_6;
LABEL_4:
  v6 = 1;
LABEL_7:
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreValidateNfceeMgtCmd");
  return v6;
}

uint64_t sub_2198AF530(unsigned int *a1, uint64_t a2, int a3)
{
  uint64_t v6;
  BOOL v7;
  BOOL v8;
  BOOL v9;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreValidateNciPropCmd");
  v6 = 1;
  switch(a3)
  {
    case 0:
      if (*(_DWORD *)(a2 + 24) == 1)
        goto LABEL_12;
      break;
    case 2:
    case 6:
    case 8:
    case 13:
    case 17:
    case 25:
    case 28:
    case 29:
    case 33:
    case 42:
    case 46:
    case 57:
    case 60:
      v7 = *(_DWORD *)(a2 + 24) == 0;
      goto LABEL_16;
    case 3:
    case 7:
    case 34:
    case 43:
    case 44:
    case 50:
      v8 = *(_DWORD *)(a2 + 24) == 0;
      goto LABEL_4;
    case 16:
      if ((*(_DWORD *)(a2 + 24) | 4) != 5)
        break;
LABEL_12:
      v8 = *(_QWORD *)(a2 + 16) == 0;
LABEL_4:
      v6 = v8;
      break;
    case 20:
      v7 = *(_DWORD *)(a2 + 24) == 2;
      goto LABEL_16;
    case 31:
    case 37:
    case 40:
    case 62:
      v7 = *(_DWORD *)(a2 + 24) == 1;
      goto LABEL_16;
    case 41:
      v9 = __CFADD__(*(_DWORD *)(a2 + 24) - 3, 2);
      goto LABEL_21;
    case 48:
      v7 = *(_DWORD *)(a2 + 24) == 4;
      goto LABEL_16;
    case 51:
    case 59:
      v7 = ((*(_DWORD *)(a2 + 24) - 1) & 0xFFFFFFFD) == 0;
LABEL_16:
      v6 = !v7;
      break;
    case 61:
      v9 = __CFADD__(*(_DWORD *)(a2 + 24) - 5, 3);
LABEL_21:
      v6 = !v9;
      break;
    default:
      break;
  }
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreValidateNciPropCmd");
  return v6;
}

uint64_t sub_2198AF660(uint64_t a1, int a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v9;
  _BYTE *v10;
  uint64_t v11;
  unsigned __int8 *v12;
  int v13;
  uint64_t v14;
  int v15;
  uint64_t v16;
  const char *v17;
  int *v18;
  unsigned int v19;
  int v20;
  unsigned int *v21;
  const char *v22;
  char v23;

  v23 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CorePktSendToTml");
  if (!a1)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a1);
  if (v6 != a1)
  {
LABEL_6:
    sub_219850628(3, (unsigned int *)a1, 3u, 4u, (uint64_t)"Invalid input parameter");
    v7 = 0;
    goto LABEL_7;
  }
  v9 = *(_QWORD *)a1;
  v10 = (_BYTE *)(*(_QWORD *)a1 + 6240);
  if (a2)
  {
    if (a2 != 1)
    {
      v7 = 1;
      goto LABEL_7;
    }
    v11 = sub_2198AFA2C(a1);
    if (!(_DWORD)v11)
      goto LABEL_25;
    v7 = v11;
    if (sub_21988F5D4(*(_QWORD *)(v9 + 6480), &v23))
    {
      sub_219850628(1, (unsigned int *)(v9 + 6476), 3u, 1u, (uint64_t)"phNciNfc_CorePktSendToTml-Failed to retrieve bIgnoreWkUpRet");
      v7 = 255;
      goto LABEL_7;
    }
    if (v23 == 1)
    {
LABEL_25:
      v12 = (unsigned __int8 *)(a1 + 276);
      v13 = *(_DWORD *)(a1 + 540);
      goto LABEL_26;
    }
    v21 = (unsigned int *)(v9 + 6476);
    v22 = "phNciNfc_CorePktSendToTml- Wakeup failed";
LABEL_47:
    sub_219850628(1, v21, 3u, 1u, (uint64_t)v22);
    goto LABEL_7;
  }
  v12 = (unsigned __int8 *)(a1 + 8);
  v13 = *(_DWORD *)(a1 + 272);
  if (*(_BYTE *)(*(_QWORD *)a1 + 6568) == 1)
    goto LABEL_26;
  v14 = *(_QWORD *)(a1 + 2456);
  if (v14 && v14 != 0xFFFFFFFFFFFFLL)
  {
    if (phOsalNfc_Timer_Stop())
      sub_219850628(1, (unsigned int *)(v9 + 6476), 3u, 1u, (uint64_t)"phNciNfc_CorePktSendToTml-Failed to Stop De-Assert Wake Up Line Timer");
    v15 = phOsalNfc_Timer_Delete();
    *(_QWORD *)(a1 + 2456) = 0xFFFFFFFFFFFFLL;
    if (v15)
      sub_219850628(1, (unsigned int *)(v9 + 6476), 3u, 1u, (uint64_t)"phNciNfc_CorePktSendToTml-Failed to Delete De-Assert Wake Up Line Timer");
  }
  v16 = sub_2198AFA2C(a1);
  if ((_DWORD)v16)
  {
    v7 = v16;
    if (sub_21988F5D4(*(_QWORD *)(v9 + 6480), &v23))
    {
      v7 = 255;
      v17 = "phNciNfc_CoreSend2-Failed to retrieve bIgnoreWkUpRet";
LABEL_45:
      sub_219850628(1, (unsigned int *)(v9 + 6476), 3u, 1u, (uint64_t)v17);
      goto LABEL_46;
    }
    if (v23 != 1)
    {
      v17 = "phNciNfc_CoreSend2-Failed to Assert Wake Up Line";
      goto LABEL_45;
    }
LABEL_46:
    v21 = (unsigned int *)(v9 + 6476);
    v22 = "phNciNfc_CorePktSendToTml-Failed to Start De-Assert Wake Up Line Timer";
    goto LABEL_47;
  }
  *(_QWORD *)(a1 + 2456) = phOsalNfc_Timer_Create();
  v7 = phOsalNfc_Timer_Start();
  if ((_DWORD)v7)
    goto LABEL_46;
LABEL_26:
  if (*(_DWORD *)(v9 + 6476))
    v18 = &dword_253E47158;
  else
    v18 = &dword_253E47070;
  v18[1] |= 0x8000000u;
  if (*v10)
    sub_21988C3F8(a1, v12, (unsigned __int16)v13);
  sub_219853B08(*(unsigned int *)(a1 + 2468), 3u, 3u, (uint64_t)"Write", (uint64_t)v12);
  v7 = phTmlNfc_Write();
  if (*(_DWORD *)(v9 + 6476))
  {
    dword_253E4715C &= ~0x8000000u;
    if (v7 != 13)
      goto LABEL_38;
  }
  else
  {
    v19 = dword_253E47074 & 0xF7FFFFFF;
    dword_253E47074 &= ~0x8000000u;
    if (v7 != 13)
    {
LABEL_38:
      sub_219886108(*(_QWORD *)(v9 + 6480), 194);
      goto LABEL_7;
    }
    dword_253E47074 = v19 | 1;
  }
  v20 = 32 * (sub_21985BF08((unsigned int *)v9, v12) & 0x1F);
  if (*(_DWORD *)(v9 + 6476))
    dword_253E4715C = dword_253E4715C & 0xFFFFFC1F | v20;
  else
    dword_253E47074 = dword_253E47074 & 0xFFFFFC1F | v20;
LABEL_7:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CorePktSendToTml");
  return v7;
}

uint64_t sub_2198AFA2C(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v5;
  uint64_t v6;
  char v7;

  v7 = 0;
  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreWakeupMgmt");
  if (a1)
  {
    v2 = sub_21988F5D4(*(_QWORD *)(a1 + 632), &v7);
    if ((_DWORD)v2)
    {
      v3 = v2;
      sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"phNciNfc_SpmiRetryWakeup-Failed to retrieve gbIgnoreWkUpRet");
    }
    else
    {
      v5 = sub_2198B00C4(*(_QWORD *)(a1 + 632), 21);
      if (v7 == 1)
        v3 = 0;
      else
        v3 = v5;
      if ((_DWORD)v3)
      {
        if ((_DWORD)v3 == 179)
        {
          sub_219851790(1, (unsigned int *)(a1 + 2468), 3u, 1u, (uint64_t)"phNciNfc_CoreWakeupMgmt SPMI wakeup Retry Status =");
          phOsalNfc_Delay();
          v3 = sub_2198B00C4(*(_QWORD *)(a1 + 632), 21);
          if ((_DWORD)v3 == 179)
          {
            phOsalNfc_Delay();
            v3 = sub_2198B00C4(*(_QWORD *)(a1 + 632), 21);
            if ((_DWORD)v3)
              sub_219886108(*(_QWORD *)(a1 + 632), 193);
          }
        }
        else
        {
          v6 = v5;
          sub_219886108(*(_QWORD *)(a1 + 632), 192);
          v3 = v6;
        }
      }
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 1u, (uint64_t)"phNciNfc_SpmiRetryWakeup-Invalid NCI context");
    v3 = 255;
  }
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CoreWakeupMgmt");
  return v3;
}

uint64_t sub_2198AFBA0(uint64_t a1, unsigned int *a2)
{
  char v4;
  uint64_t v5;
  uint64_t *v6;
  const char *v7;
  uint64_t v9;
  int v10;
  int v11;
  char v12;

  v12 = 0;
  sub_219850718(3, a2, 3u, 5u, (uint64_t)"phNciNfc_DeAssertWakeUpTimerCb");
  if (!a2)
    goto LABEL_6;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = (uint64_t *)*((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != (uint64_t *)a2);
  if (v6 != (uint64_t *)a2)
  {
LABEL_6:
    v7 = "phNciNfc_DeAssertWakeUpTimerCb-Invalid LIBNFC context";
LABEL_7:
    sub_219850628(3, a2, 3u, 1u, (uint64_t)v7);
    return sub_219850808(3, a2, 3u, 5u, (uint64_t)"phNciNfc_DeAssertWakeUpTimerCb");
  }
  if (sub_21988F5D4(*((_QWORD *)a2 + 79), &v12))
  {
    v7 = "phNciNfc_DeAssertWakeUpTimerCb-Failed to retrieve gbIgnoreWkUpRet";
    goto LABEL_7;
  }
  v9 = *(_QWORD *)a2;
  if (*(_QWORD *)a2)
  {
    v10 = *(_BYTE *)(v9 + 6568) == 1 ? 0 : sub_2198B00C4(*((_QWORD *)a2 + 79), 20);
    v11 = v12 == 1 ? 0 : v10;
    if (v11)
    {
      if (v11 == 179)
      {
        sub_219886108(*((_QWORD *)a2 + 79), 193);
        sub_219850628(1, (unsigned int *)(v9 + 6476), 3u, 1u, (uint64_t)"phNciNfc_DeAssertWakeUpTimerCb-Fialed to De-Assert Wake Up Line");
      }
      else
      {
        sub_219886108(*((_QWORD *)a2 + 79), 192);
      }
    }
  }
  if (a1 && a1 != 0xFFFFFFFFFFFFLL)
  {
    phOsalNfc_Timer_Stop();
    phOsalNfc_Timer_Delete();
    *((_QWORD *)a2 + 307) = 0xFFFFFFFFFFFFLL;
  }
  return sub_219850808(3, a2, 3u, 5u, (uint64_t)"phNciNfc_DeAssertWakeUpTimerCb");
}

uint64_t sub_2198AFD2C(unsigned int *a1, unsigned __int8 *a2)
{
  unsigned int v4;
  char v5;
  uint64_t v6;
  uint64_t *v7;
  unsigned int *v9;
  char v10;
  uint64_t v11;
  unsigned int *v12;
  unsigned int *v13;
  int v14;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreSendCb");
  if (a2)
  {
    v4 = *((_DWORD *)a2 + 1);
    if (v4 <= 1)
      sub_21988F804(*((_QWORD *)&unk_253E46700 + 14 * v4), 0);
  }
  if (!a1)
    goto LABEL_9;
  v5 = 0;
  v6 = 0;
  do
  {
    v7 = (uint64_t *)*((_QWORD *)&unk_253E46700 + 14 * v6 + 5);
    if ((v5 & 1) != 0)
      break;
    v5 = 1;
    v6 = 1;
  }
  while (v7 != (uint64_t *)a1);
  if (v7 != (uint64_t *)a1)
    goto LABEL_9;
  v9 = *(unsigned int **)a1;
  if (!*(_QWORD *)a1)
    goto LABEL_9;
  v10 = 0;
  v11 = 0;
  do
  {
    v12 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v11 + 4);
    if ((v10 & 1) != 0)
      break;
    v10 = 1;
    v11 = 1;
  }
  while (v12 != v9);
  if (v12 == v9)
  {
    *((_BYTE *)v9 + 5952) = 0;
    v13 = v9 + 1619;
    if (!v9[1619])
      dword_253E47074 &= ~1u;
    if (a2)
    {
      sub_219851888(1, v13, 3u, 4u, (uint64_t)"Send status");
      v14 = *a2;
      if (v14 == 179)
      {
        sub_219850628(1, v13, 3u, 2u, (uint64_t)"phNciNfc_CoreSendCb: SPMI Nack");
      }
      else if (*a2)
      {
        sub_219850628(1, v13, 3u, 1u, (uint64_t)"Tml write error!");
        *((_BYTE *)a1 + 617) = 1;
      }
      else
      {
        sub_219850628(1, v13, 3u, 4u, (uint64_t)"Send succes");
      }
      *((_WORD *)a1 + 298) = v14;
      sub_2198801C4(*(unsigned int **)a1, (uint64_t)a2);
    }
    else
    {
      sub_219850628(1, v13, 3u, 1u, (uint64_t)"Invalid 'pInfo' from TML!");
    }
  }
  else
  {
LABEL_9:
    sub_219850628(2, 0, 3u, 2u, (uint64_t)"Nci context cleared, received send CB!");
  }
  return sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreSendCb");
}

uint64_t sub_2198AFF40(uint64_t a1)
{
  uint64_t v1;
  uint64_t v2;
  uint64_t v4;
  uint64_t v5;
  char v6;
  uint64_t v7;
  uint64_t v8;

  v7 = 0;
  v8 = a1;
  v6 = 0;
  sub_219850718(0, (unsigned int *)&v8, 3u, 5u, (uint64_t)"phNciNfc_SpmiRetryWakeup");
  v1 = sub_21988F5D4(v8, &v6);
  if ((_DWORD)v1)
  {
    v2 = v1;
    sub_219850628(0, (unsigned int *)&v8, 3u, 1u, (uint64_t)"phNciNfc_SpmiRetryWakeup-Failed to retrieve gbIgnoreWkUpRet");
  }
  else
  {
    v4 = sub_2198B00C4(v8, 21);
    if (v6 == 1)
      v2 = 0;
    else
      v2 = v4;
    if ((_DWORD)v2)
    {
      if ((_DWORD)v2 == 179)
      {
        sub_219851790(0, (unsigned int *)&v8, 3u, 4u, (uint64_t)"phNciNfc_SpmiRetryWakeup: SPMI wakeup Retry Status =");
        sub_21988F0DC(v8, &v7);
        phOsalNfc_Delay();
        v2 = sub_2198B00C4(v8, 21);
        if ((_DWORD)v2 == 179)
        {
          phOsalNfc_Delay();
          v2 = sub_2198B00C4(v8, 21);
          if ((_DWORD)v2)
            sub_219886108(v8, 193);
        }
      }
      else
      {
        v5 = v4;
        sub_219886334(0, (unsigned int *)&v8, 3u, 3u, (uint64_t)"phNciNfc_SpmiRetryWakeup: SPMI wakeup Retry Status =");
        sub_219886108(v8, 192);
        v2 = v5;
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v8, 3u, 5u, (uint64_t)"phNciNfc_SpmiRetryWakeup");
  return v2;
}

uint64_t sub_2198B00C4(uint64_t a1, int a2)
{
  uint64_t v3;
  uint64_t v5;
  uint64_t v6;

  v5 = 0;
  v6 = a1;
  sub_219850718(0, (unsigned int *)&v6, 3u, 5u, (uint64_t)"phNciNfc_ConfigureSpmiWakeup");
  sub_21988F19C(v6, &v5);
  if ((a2 & 0xFFFFFFFE) == 0x14 && v5)
  {
    v3 = phTmlNfc_IoCtl();
  }
  else
  {
    sub_219850628(0, (unsigned int *)&v6, 3u, 1u, (uint64_t)"phNciNfc_ConfigureSpmiWakeup-Invalid NCI context or input parameters");
    v3 = 255;
  }
  sub_219850808(0, (unsigned int *)&v6, 3u, 5u, (uint64_t)"phNciNfc_ConfigureSpmiWakeup");
  return v3;
}

uint64_t sub_2198B017C(unsigned int *a1, unsigned int a2)
{
  char v4;
  uint64_t v5;
  uint64_t *v6;
  uint64_t v7;
  unsigned int *v9;
  unsigned int *v10;
  unsigned int *v11;
  uint64_t v12;
  int *v13;
  uint64_t v14;
  const char *v15;
  uint64_t v16;
  int v17;
  char v18;
  uint64_t v19;
  uint64_t v20;
  int *v21;
  int *v22;
  char v23;
  unsigned int v24;
  uint64_t v25;
  char v26;

  v26 = 0;
  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReSend");
  if (a1)
  {
    v4 = 0;
    v5 = 0;
    do
    {
      v6 = (uint64_t *)*((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
      if ((v4 & 1) != 0)
        break;
      v4 = 1;
      v5 = 1;
    }
    while (v6 != (uint64_t *)a1);
    if (v6 == (uint64_t *)a1)
    {
      v9 = *(unsigned int **)a1;
      v10 = sub_2198C82D4(*(unsigned int **)a1);
      v7 = sub_2198804FC(*(unsigned int **)a1);
      if ((_DWORD)v7)
        goto LABEL_7;
      if (a1[136] <= 4)
      {
        *((_BYTE *)v9 + 6448) = 0;
        a1[140] = a2;
        v11 = v9 + 1619;
        sub_219850628(1, v9 + 1619, 3u, 4u, (uint64_t)"Syntax/Interface error received, Re-transmitting pkt..");
        if (*((_BYTE *)v10 + 49) == 1)
        {
          *((_BYTE *)v9 + 6233) = 1;
          if (*((_BYTE *)v10 + 64) == 1)
          {
            sub_219850628(1, v9 + 1619, 3u, 1u, (uint64_t)"Resend - Stopping Credit await timer..");
            v12 = *((_QWORD *)v10 + 7);
            if (v12 && v12 != 0xFFFFFFFFFFFFLL)
            {
              phOsalNfc_Timer_Stop();
              phOsalNfc_Timer_Delete();
            }
            *((_BYTE *)v9 + 6465) = 0;
            *((_BYTE *)v10 + 64) = 0;
            *((_QWORD *)v10 + 7) = 0;
            *((_BYTE *)v10 + 9) = -1;
            *((_QWORD *)v10 + 4) = 0;
            *((_QWORD *)v10 + 5) = 0;
            v13 = &dword_253E47158;
            if (!v9[1619])
              v13 = &dword_253E47070;
            v13[1] &= ~8u;
          }
          *((_BYTE *)v10 + 49) = 0;
        }
        if (*((_QWORD *)a1 + 69) == 0xFFFFFFFFFFFFLL)
        {
          sub_219850628(1, a1 + 617, 3u, 4u, (uint64_t)"Creating resend timer");
        }
        else
        {
          sub_219850628(1, a1 + 617, 3u, 4u, (uint64_t)"Resend timer active, restarting resend timer");
          if (!phOsalNfc_Timer_Stop())
          {
            v14 = *((_QWORD *)a1 + 69);
LABEL_30:
            if (v14 != 0xFFFFFFFFFFFFLL)
            {
              if (!phOsalNfc_Timer_Start())
              {
                sub_219850628(1, a1 + 617, 3u, 4u, (uint64_t)"Resend timer started");
                v7 = 13;
                goto LABEL_7;
              }
              sub_219850628(1, v11, 3u, 1u, (uint64_t)"Failed to start resend timer");
              phOsalNfc_Timer_Delete();
              *((_QWORD *)a1 + 69) = 0xFFFFFFFFFFFFLL;
LABEL_59:
              v7 = 255;
              goto LABEL_7;
            }
LABEL_31:
            sub_219850628(1, v11, 3u, 1u, (uint64_t)"Failed to created resend timer");
            goto LABEL_59;
          }
          sub_219850628(1, v11, 3u, 1u, (uint64_t)"Failed to stop resend timer, proceed deleting and creating it");
          if (phOsalNfc_Timer_Delete())
          {
            sub_219850628(1, v11, 3u, 1u, (uint64_t)"Unable to delete resend timer");
            *((_QWORD *)a1 + 69) = 0xFFFFFFFFFFFFLL;
            goto LABEL_31;
          }
        }
        v14 = phOsalNfc_Timer_Create();
        *((_QWORD *)a1 + 69) = v14;
        goto LABEL_30;
      }
      if (*((_BYTE *)v9 + 6568) == 1)
      {
LABEL_44:
        sub_21987FEF8(*(unsigned int **)a1);
        v18 = 1;
        sub_219850628(1, v9 + 1619, 3u, 1u, (uint64_t)"Resend Count Reached");
        v19 = *((_QWORD *)v10 + 7);
        if (v19 && v19 != 0xFFFFFFFFFFFFLL)
        {
          phOsalNfc_Timer_Stop();
          phOsalNfc_Timer_Delete();
        }
        v20 = 0;
        *((_BYTE *)v9 + 6465) = 0;
        *((_BYTE *)v10 + 64) = 0;
        *((_QWORD *)v10 + 7) = 0;
        *((_BYTE *)v10 + 49) = 0;
        v21 = &dword_253E47158;
        if (v9[1619])
          v22 = &dword_253E47158;
        else
          v22 = &dword_253E47070;
        v22[1] &= ~8u;
        *((_BYTE *)v9 + 6448) = 1;
        if (!a1[617])
          v21 = &dword_253E47070;
        v21[1] = v21[1] & 0xFFFFFFFB | (4 * (a1[136] & 1));
        v7 = 255;
        while (*((_QWORD *)&unk_253E46700 + 14 * v20) != *((_QWORD *)a1 + 79))
        {
          v23 = v18;
          v18 = 0;
          v20 = 1;
          if ((v23 & 1) == 0)
            goto LABEL_7;
        }
        v24 = *((_DWORD *)&unk_253E46700 + 28 * v20 + 2);
        if (v24 <= 1)
        {
          v25 = *((_QWORD *)&unk_253E46700 + 14 * v24 + 10);
          if (v25)
            *(_WORD *)(v25 + 152) = 80;
        }
        goto LABEL_59;
      }
      if (sub_2198B00C4(*((_QWORD *)a1 + 79), 20))
      {
        if (sub_21988F5D4(*((_QWORD *)a1 + 79), &v26))
        {
          v15 = "phNciNfc_CoreReSend-Failed to retrieve bIgnoreWkUpRet";
LABEL_37:
          sub_219850628(1, v9 + 1619, 3u, 1u, (uint64_t)v15);
          goto LABEL_38;
        }
        if (v26 != 1)
        {
          v15 = "phNciNfc_CoreReSend-Fialed to De-Assert Wake Up Line";
          goto LABEL_37;
        }
      }
LABEL_38:
      v16 = *((_QWORD *)a1 + 307);
      if (v16 && v16 != 0xFFFFFFFFFFFFLL)
      {
        if (phOsalNfc_Timer_Stop())
          sub_219850628(1, v9 + 1619, 3u, 1u, (uint64_t)"phNciNfc_CoreReSend Failed to Stop Timer");
        v17 = phOsalNfc_Timer_Delete();
        *((_QWORD *)a1 + 307) = 0xFFFFFFFFFFFFLL;
        if (v17)
          sub_219850628(1, v9 + 1619, 3u, 1u, (uint64_t)"Failed to Delete De-Assert Wake Up Line Timer");
      }
      goto LABEL_44;
    }
  }
  sub_219850628(3, a1, 3u, 4u, (uint64_t)"Invalid input parameter");
  v7 = 1;
LABEL_7:
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReSend");
  return v7;
}

uint64_t sub_2198B06B4(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  unsigned int *v6;
  int v7;
  int v8;
  unsigned __int8 *v9;
  _DWORD *v10;
  int *v11;
  const char *v12;
  unsigned int *v13;
  const char *v14;
  uint64_t v15;
  int v16;
  uint64_t v18;
  int *v19;
  char v20;
  unsigned int v21;
  int *v22;
  char v23;
  char v24;
  char v25;
  int *v26;
  const char *v27;
  int *v28;
  const char *v29;
  int v30;
  unsigned int v31;
  char v32;
  int *v33;
  char v34;

  v34 = 0;
  sub_219850718(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_ResendTimerCb");
  if (!a2)
    return sub_219850808(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_ResendTimerCb");
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 5);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != a2);
  if (v5 != a2)
    return sub_219850808(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_ResendTimerCb");
  v6 = *(unsigned int **)a2;
  phOsalNfc_Timer_Stop();
  phOsalNfc_Timer_Delete();
  *(_QWORD *)(a2 + 552) = 0xFFFFFFFFFFFFLL;
  v7 = *(_DWORD *)(a2 + 560);
  if (v7 == 1)
  {
    v9 = (unsigned __int8 *)(a2 + 276);
    v8 = 2;
  }
  else
  {
    if (v7)
    {
      sub_219851790(1, (unsigned int *)(a2 + 2468), 3u, 1u, (uint64_t)"Unknown Msg Type");
      v13 = v6 + 1619;
      v14 = "Resend Failed, Unknown Msg Type";
LABEL_28:
      sub_219850628(1, v13, 3u, 1u, (uint64_t)v14);
      return sub_219850808(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_ResendTimerCb");
    }
    v8 = 0;
    v9 = (unsigned __int8 *)(a2 + 8);
  }
  v10 = v6 + 1619;
  if (v6[1619])
    v11 = &dword_253E47158;
  else
    v11 = &dword_253E47070;
  v11[1] |= 0x8000000u;
  sub_219851FF8(1, (unsigned int *)(a2 + 2468), 3u, 4u, (uint64_t)"Re Sending packet->->", (uint64_t)v9);
  if (sub_2198AFA2C(a2))
  {
    if (sub_21988F5D4(*((_QWORD *)v6 + 810), &v34))
    {
      v12 = "phNciNfc_ResendTimerCb1-Failed to retrieve bIgnoreWkUpRet";
LABEL_19:
      sub_219850628(1, v6 + 1619, 3u, 1u, (uint64_t)v12);
      goto LABEL_20;
    }
    if (v34 != 1)
    {
      v12 = "phNciNfc_ResendTimerCb1-Failed to Assert Wake Up Line";
      goto LABEL_19;
    }
  }
LABEL_20:
  v15 = *(_QWORD *)(a2 + 2456);
  if (v15 && v15 != 0xFFFFFFFFFFFFLL)
  {
    if (phOsalNfc_Timer_Stop())
      sub_219850628(1, v6 + 1619, 3u, 1u, (uint64_t)"phNciNfc_ResendTimerCb Failed to Stop Timer");
    v16 = phOsalNfc_Timer_Delete();
    *(_QWORD *)(a2 + 2456) = 0xFFFFFFFFFFFFLL;
    if (v16)
      sub_219850628(1, v6 + 1619, 3u, 1u, (uint64_t)"Failed to Delete De-Assert Wake Up Line Timer");
  }
  *(_QWORD *)(a2 + 2456) = phOsalNfc_Timer_Create();
  if (phOsalNfc_Timer_Start())
  {
    v14 = "phNciNfc_ResendTimerCb-Failed to Start De-Assert Wake Up Timer";
    v13 = v6 + 1619;
    goto LABEL_28;
  }
  if (!*(_BYTE *)(a2 + 616))
  {
    v18 = *(_QWORD *)(a2 + 984);
    if (v18 != 0xFFFFFFFFFFFFLL && *(_BYTE *)(a2 + 992) == 1)
    {
      sub_21988C4AC(*(_DWORD *)(a2 + 2468), v18);
      *((_BYTE *)v6 + 6464) = 0;
      if (phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a2 + 2468), 3u, 4u, (uint64_t)"Response timer start failed");
      }
      else
      {
        sub_219850628(1, (unsigned int *)(a2 + 2468), 3u, 4u, (uint64_t)"Response timer started");
        phOsalNfc_MemCopy();
        *(_BYTE *)(a2 + 992) = 1;
        if (*(_DWORD *)(a2 + 2468))
          v19 = &dword_253E47158;
        else
          v19 = &dword_253E47070;
        v19[1] &= ~0x10u;
        *(_DWORD *)(a2 + 968) = v8;
      }
    }
  }
  v20 = phTmlNfc_Write();
  v21 = v6[1619];
  if (v21)
    v22 = &dword_253E47158;
  else
    v22 = &dword_253E47070;
  v22[1] &= ~0x8000000u;
  if (v20 == 13)
  {
    v24 = v20;
    if (!v21)
      dword_253E47074 |= 1u;
    v25 = sub_21985BF08(v6, v9);
    if (v6[1619])
      v26 = &dword_253E47158;
    else
      v26 = &dword_253E47070;
    v26[1] = v26[1] & 0xFFFFFC1F | (32 * (v25 & 0x1F));
    ++*(_DWORD *)(a2 + 544);
    if (v24 == -1)
      goto LABEL_55;
    return sub_219850808(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_ResendTimerCb");
  }
  if (v20 != 111)
  {
    v27 = "TML Write failed";
LABEL_54:
    sub_219850628(1, v6 + 1619, 3u, 1u, (uint64_t)v27);
    sub_219886108(*((_QWORD *)v6 + 810), 194);
LABEL_55:
    *(_DWORD *)(a2 + 544) = 0;
    if (!*(_DWORD *)(a2 + 568))
      sub_2198799F4(*(unsigned int **)a2, *(unsigned __int8 *)(a2 + 580), 1);
    return sub_219850808(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_ResendTimerCb");
  }
  v23 = phTmlNfc_WriteAbort();
  sub_21988F804(*(_QWORD *)(a2 + 632), 0);
  if (v23)
  {
    sub_219850628(1, v6 + 1619, 3u, 1u, (uint64_t)"TML Write Abort Failed");
    goto LABEL_55;
  }
  if (*v10)
    v28 = &dword_253E47158;
  else
    v28 = &dword_253E47070;
  v28[1] |= 0x8000000u;
  if (sub_2198AFA2C(a2))
  {
    if (sub_21988F5D4(*((_QWORD *)v6 + 810), &v34))
    {
      v29 = "phNciNfc_ResendTimerCb1-Failed to retrieve bIgnoreWkUpRet";
LABEL_65:
      sub_219850628(1, v6 + 1619, 3u, 1u, (uint64_t)v29);
      goto LABEL_66;
    }
    if (v34 != 1)
    {
      v29 = "phNciNfc_ResendTimerCb1-Failed to Assert Wake Up Line";
      goto LABEL_65;
    }
  }
LABEL_66:
  v30 = phTmlNfc_Write();
  if (*v10)
  {
    dword_253E4715C &= ~0x8000000u;
    if (v30 != 13)
      goto LABEL_75;
  }
  else
  {
    v31 = dword_253E47074 & 0xF7FFFFFF;
    dword_253E47074 &= ~0x8000000u;
    if (v30 != 13)
    {
LABEL_75:
      v27 = "TML Write Failed";
      goto LABEL_54;
    }
    dword_253E47074 = v31 | 1;
  }
  v32 = sub_21985BF08(v6, v9);
  if (*(_DWORD *)(a2 + 2468))
    v33 = &dword_253E47158;
  else
    v33 = &dword_253E47070;
  v33[1] = v33[1] & 0xFFFFFC1F | (32 * (v32 & 0x1F));
  sub_219850628(1, (unsigned int *)(a2 + 2468), 3u, 4u, (uint64_t)"Re Sending packet when TML BUSY");
  ++*(_DWORD *)(a2 + 544);
  return sub_219850808(3, (unsigned int *)a2, 3u, 5u, (uint64_t)"phNciNfc_ResendTimerCb");
}

uint64_t sub_2198B0C8C(unsigned int *a1, unsigned __int8 *a2)
{
  unsigned int v4;
  char v5;
  uint64_t v6;
  unsigned int *v7;
  const char *v9;

  if (a2)
  {
    v4 = *((_DWORD *)a2 + 1);
    if (v4 <= 1)
      sub_21988F804(*((_QWORD *)&unk_253E46700 + 14 * v4), 0);
  }
  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReSendCb");
  if (a1)
  {
    v5 = 0;
    v6 = 0;
    do
    {
      v7 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v6 + 5);
      if ((v5 & 1) != 0)
        break;
      v5 = 1;
      v6 = 1;
    }
    while (v7 != a1);
    if (v7 == a1 && *(_QWORD *)a1)
    {
      sub_219850628(1, a1 + 617, 3u, 4u, (uint64_t)"ReSend Cmd Send Cb Received");
      *(_BYTE *)(*(_QWORD *)a1 + 5952) = 0;
      if (a1[617])
      {
        if (a2)
        {
LABEL_14:
          sub_219851888(1, a1 + 617, 3u, 4u, (uint64_t)"phNciNfc_CoreReSendCb: Send status");
          if (*a2 == 179)
          {
            sub_219850628(1, a1 + 617, 3u, 2u, (uint64_t)"phNciNfc_CoreReSendCb: SPMI Nack");
            goto LABEL_22;
          }
          if (!*a2)
          {
            sub_219850628(1, a1 + 617, 3u, 4u, (uint64_t)"phNciNfc_CoreReSendCb: Send succes");
LABEL_22:
            sub_2198801C4(*(unsigned int **)a1, (uint64_t)a2);
            return sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReSendCb");
          }
          v9 = "phNciNfc_CoreSendCb: Tml write error!";
LABEL_21:
          sub_219850628(1, a1 + 617, 3u, 1u, (uint64_t)v9);
          goto LABEL_22;
        }
      }
      else
      {
        dword_253E47074 &= ~1u;
        if (a2)
          goto LABEL_14;
      }
      v9 = "phNciNfc_CoreReSendCb:Invalid 'pInfo' from TML!";
      goto LABEL_21;
    }
  }
  sub_219850628(3, a1, 3u, 2u, (uint64_t)"Nci context cleared, received send CB!");
  return sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_CoreReSendCb");
}

uint64_t sub_2198B0E68(uint64_t a1)
{
  int v2;
  unsigned int v3;
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HGetMaximumBlksToRead");
  v2 = *(unsigned __int8 *)(a1 + 700);
  v3 = (v2 | (*(unsigned __int8 *)(a1 + 699) << 8)) >> 4;
  if ((v2 & 0xF) != 0)
    v4 = v3 + 1;
  else
    v4 = v3;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HGetMaximumBlksToRead");
  return v4;
}

uint64_t sub_2198B0EE0(uint64_t a1, uint64_t a2, unsigned int *a3, unsigned int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  unsigned int *v12;
  unsigned int *v13;
  _BYTE *v14;
  unsigned int v15;
  int v17;
  unsigned int *v18;
  int v19;
  unsigned int *v21;
  uint64_t v22;

  v21 = 0;
  v22 = a1;
  sub_219850718(0, (unsigned int *)&v22, 8u, 5u, (uint64_t)"phFriNfc_Felica_RdNdef");
  sub_21988EF68(v22, &v21);
  v11 = 1;
  if (a4 <= 1)
  {
    if (a3)
    {
      if (a2)
      {
        if (a5)
        {
          v12 = v21;
          if (v21)
          {
            if (a4 == 1 || *((_BYTE *)v21 + 540) != 3)
            {
              *((_QWORD *)v21 + 2) = a5;
              *((_QWORD *)v12 + 5) = a6;
              v12[62] = *a3;
              *((_QWORD *)v12 + 30) = a2;
              *((_QWORD *)v12 + 69) = a3;
              *a3 = 0;
              *((_WORD *)v12 + 126) = 0;
              *((_BYTE *)v12 + 540) = 2;
              *((_BYTE *)v12 + 686) = a4;
              if (a4 == 1)
              {
                *((_BYTE *)v12 + 640) = 0;
                *((_WORD *)v12 + 338) = 0;
                *((_BYTE *)v12 + 659) = 0;
                *(unsigned int *)((char *)v12 + 682) = 285212672;
                sub_2198B115C(v12, v12 + 165);
                v13 = v21;
                if (*((_BYTE *)v21 + 65))
                {
                  sub_219850718(2, v21, 8u, 5u, (uint64_t)"phFriNfc_Felica_HNdefRdAttrInfo");
                  v13[58] = 240;
                  *((_BYTE *)v13 + 204) &= 0xFCu;
                  *((_WORD *)v13 + 133) = 1536;
                  phOsalNfc_MemCopy();
                  v13[69] = 251660545;
                  v14 = (char *)v13 + 281;
                  v15 = 1;
                  do
                  {
                    *(v14 - 1) = 0x80;
                    *v14 = v15;
                    v14 += 2;
                  }
                  while (v15++ < 0xF);
                  *((_BYTE *)v13 + 266) = 44;
                  *((_WORD *)v13 + 132) = 260;
                  *((_WORD *)v13 + 263) = 44;
                  *(_BYTE *)v13 = 4;
                  *((_QWORD *)v13 + 6) = sub_2198B1AC8;
                  *((_QWORD *)v13 + 7) = v13;
                  v11 = sub_219888630((uint64_t)v13, (uint64_t)sub_2198B2060);
                  sub_219850808(2, v13, 8u, 5u, (uint64_t)"phFriNfc_Felica_HNdefRdAttrInfo");
                }
                else
                {
                  v11 = sub_2198B11BC((uint64_t)v21);
                }
                if (v11 != 13)
                  sub_2198B12A0(v21, 0, v11);
              }
              else
              {
                v17 = sub_2198B0E68((uint64_t)v12);
                v18 = v21;
                v19 = *((unsigned __int8 *)v21 + 640);
                if (v17 == v19 && *((_BYTE *)v21 + 684) == 4)
                {
                  v11 = 26;
                }
                else
                {
                  *((_WORD *)v21 + 341) = 16 * v19 - *((unsigned __int8 *)v21 + 659);
                  v11 = sub_2198B13EC((uint64_t)v18, *((unsigned __int8 *)v18 + 686));
                }
              }
            }
            else
            {
              v11 = 245;
            }
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v22, 8u, 5u, (uint64_t)"phFriNfc_Felica_RdNdef");
  return v11;
}

uint64_t sub_2198B115C(unsigned int *a1, _QWORD *a2)
{
  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HInitInternalBuf");
  *a2 = 0;
  a2[1] = 0;
  return sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HInitInternalBuf");
}

uint64_t sub_2198B11BC(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HRdAttrInfo");
  *(_DWORD *)(a1 + 232) = 240;
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_WORD *)(a1 + 266) = 1536;
  phOsalNfc_MemCopy();
  *(_DWORD *)(a1 + 276) = 16780033;
  *(_WORD *)(a1 + 280) = 128;
  *(_BYTE *)(a1 + 266) = 16;
  *(_WORD *)(a1 + 264) = 260;
  *(_WORD *)(a1 + 526) = 16;
  *(_BYTE *)a1 = 4;
  *(_QWORD *)(a1 + 48) = sub_2198B1AC8;
  *(_QWORD *)(a1 + 56) = a1;
  v2 = sub_219888630(a1, (uint64_t)sub_2198B2060);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HRdAttrInfo");
  return v2;
}

uint64_t sub_2198B12A0(unsigned int *a1, int a2, uint64_t a3)
{
  int v6;
  int v7;
  char v8;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;
  int v13;

  v13 = 0;
  v11 = 0;
  v12 = 0;
  v10 = 0;
  v6 = *(unsigned __int8 *)a1;
  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HCrHandler");
  *(_BYTE *)a1 = 0;
  if (a2 == 4)
  {
    (*((void (**)(_QWORD, uint64_t))a1 + 4))(*((_QWORD *)a1 + 5), a3);
  }
  else if ((v6 - 1) < 4)
  {
    if ((_DWORD)a3 != 157)
    {
      if ((_DWORD)a3)
      {
        *((_BYTE *)a1 + 546) = 0;
        v8 = 3;
      }
      else
      {
        *((_BYTE *)a1 + 546) = 1;
        v7 = 16 * *((unsigned __int16 *)a1 + 347);
        HIDWORD(v12) = (*((unsigned __int8 *)a1 + 698) << 24) | (*((unsigned __int8 *)a1 + 699) << 8) | *((unsigned __int8 *)a1 + 700);
        v13 = v7;
        v8 = *((_BYTE *)a1 + 545);
      }
      LOBYTE(v12) = v8;
    }
    (*((void (**)(_QWORD, uint64_t, uint64_t *))a1 + 1))(*((_QWORD *)a1 + 5), a3, &v12);
  }
  else if ((v6 - 6) >= 3)
  {
    if (v6 == 5)
    {
      if (!(_DWORD)a3)
      {
        LODWORD(v11) = **((_DWORD **)a1 + 69);
        v10 = *((_QWORD *)a1 + 30);
      }
      (*((void (**)(_QWORD, uint64_t, uint64_t *))a1 + 2))(*((_QWORD *)a1 + 5), a3, &v10);
    }
  }
  else
  {
    (*((void (**)(_QWORD, uint64_t))a1 + 3))(*((_QWORD *)a1 + 5), a3);
  }
  return sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HCrHandler");
}

uint64_t sub_2198B13EC(uint64_t a1, int a2)
{
  unsigned int v4;
  unsigned int v5;
  uint64_t v6;
  unsigned int v7;
  unsigned int v8;
  int v9;
  uint64_t v10;
  _BYTE *v11;
  __int16 v12;
  int v13;
  uint64_t v14;
  _BYTE *v15;
  BOOL v16;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HReadData");
  v4 = sub_2198B0E68(a1);
  v5 = v4;
  if (*(_DWORD *)(a1 + 248) != *(unsigned __int16 *)(a1 + 252) && v4 > *(unsigned __int8 *)(a1 + 640))
  {
    if (!*(_BYTE *)(a1 + 659))
      goto LABEL_7;
    sub_2198B15F0(a1);
  }
  v6 = sub_2198B18E4(a1);
  if ((_DWORD)v6 && *(_BYTE *)(a1 + 680) == 1)
  {
LABEL_7:
    v7 = sub_2198B1A10(a1, v5);
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HSetTransceiveForRead");
    *(_DWORD *)(a1 + 232) = 240;
    *(_BYTE *)a1 = 5;
    *(_QWORD *)(a1 + 48) = sub_2198B1AC8;
    *(_QWORD *)(a1 + 56) = a1;
    *(_BYTE *)(a1 + 204) &= 0xFCu;
    *(_WORD *)(a1 + 266) = 1536;
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 276) = 2817;
    *(_BYTE *)(a1 + 278) = 0;
    v8 = v7 >> 4;
    *(_BYTE *)(a1 + 279) = v7 >> 4;
    if (a2 == 1)
    {
      if (v7 >= 0x10)
      {
        v9 = 0;
        v10 = 281;
        do
        {
          v11 = (_BYTE *)(a1 + v10);
          *(v11 - 1) = 0x80;
          *v11 = ++v9;
          v10 += 2;
        }
        while (v8 > (unsigned __int16)v9);
        v12 = v10 - 267;
        goto LABEL_17;
      }
    }
    else if (v7 >= 0x10)
    {
      v13 = 1;
      v14 = 281;
      do
      {
        v15 = (_BYTE *)(a1 + v14);
        *(v15 - 1) = 0x80;
        *v15 = *(_BYTE *)(a1 + 640) + v13;
        v16 = v8 > (unsigned __int16)v13++;
        v14 += 2;
      }
      while (v16);
      v12 = v14 - 267;
      goto LABEL_17;
    }
    v12 = 14;
LABEL_17:
    *(_BYTE *)(a1 + 266) = v12;
    *(_WORD *)(a1 + 526) = v12;
    *(_WORD *)(a1 + 264) = 260;
    v6 = sub_219888630(a1, (uint64_t)sub_2198B2060);
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HSetTransceiveForRead");
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HReadData");
  return v6;
}

uint64_t sub_2198B15F0(uint64_t a1)
{
  unsigned int v2;
  unsigned int v3;
  int v4;
  __int16 v5;
  int v6;
  unsigned int v7;
  unsigned int v8;
  int v9;
  unsigned int v10;
  __int16 v11;
  int v12;
  __int16 v13;
  __int16 v14;
  __int16 v15;
  __int16 v16;
  unsigned __int8 v17;
  int v18;
  __int16 v19;
  unsigned __int16 v20;
  __int16 v21;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HAfterRead_CopyDataToBuff");
  v2 = *(unsigned __int8 *)(a1 + 659);
  v3 = *(_DWORD *)(a1 + 248) - *(unsigned __int16 *)(a1 + 252);
  if (!*(_BYTE *)(a1 + 659))
  {
    v6 = *(unsigned __int8 *)(a1 + 700);
    v7 = (*(unsigned __int8 *)(a1 + 698) << 24) | (*(unsigned __int8 *)(a1 + 699) << 8) | v6;
    v8 = *(unsigned __int16 *)(a1 + 688);
    v9 = *(unsigned __int16 *)(a1 + 682);
    v10 = v9 + v8;
    if (v8 <= v3)
    {
      if (v10 <= v7)
      {
        phOsalNfc_MemCopy();
        v21 = *(_WORD *)(a1 + 688);
        *(_WORD *)(a1 + 252) += v21;
        *(_WORD *)(a1 + 682) += v21;
        return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HAfterRead_CopyDataToBuff");
      }
    }
    else
    {
      if (v10 <= v7)
      {
        *(_BYTE *)(a1 + 659) = v8 - v3;
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
        *(_BYTE *)(a1 + 676) = 1;
        v18 = *(_DWORD *)(a1 + 248);
        v19 = *(_WORD *)(a1 + 252);
        *(_WORD *)(a1 + 682) += v18 - v19;
        v20 = v19 + (v18 - v19);
        *(_WORD *)(a1 + 252) = v20;
        if (v7 > v18 - v20)
          return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HAfterRead_CopyDataToBuff");
LABEL_19:
        *(_BYTE *)(a1 + 684) = 4;
        return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HAfterRead_CopyDataToBuff");
      }
      if (v3 <= v7 - v9)
      {
        phOsalNfc_MemCopy();
        v11 = *(_WORD *)(a1 + 682);
        v12 = *(_DWORD *)(a1 + 248);
        v13 = *(_WORD *)(a1 + 252);
        *(_BYTE *)(a1 + 659) = v13 - v12 + v6 - v11;
        if ((_BYTE)v13 - (_BYTE)v12 + (_BYTE)v6 - (_BYTE)v11)
        {
          phOsalNfc_MemCopy();
          *(_BYTE *)(a1 + 676) = 1;
          v12 = *(_DWORD *)(a1 + 248);
          v13 = *(_WORD *)(a1 + 252);
          v11 = *(_WORD *)(a1 + 682);
        }
        v14 = v12 - v13;
        *(_WORD *)(a1 + 682) = v14 + v11;
        v15 = v13 + v14;
        goto LABEL_17;
      }
    }
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 252) += v7 - *(_WORD *)(a1 + 682);
    *(_WORD *)(a1 + 682) = v7;
    goto LABEL_19;
  }
  if (v3 < v2)
  {
    *(_BYTE *)(a1 + 659) = v2 - v3;
    if (*(_BYTE *)(a1 + 676) == 1)
    {
      phOsalNfc_MemCopy();
      v4 = *(_DWORD *)(a1 + 248);
      v5 = *(_WORD *)(a1 + 252);
      *(_BYTE *)(a1 + 677) += v4 - v5;
      *(_BYTE *)(a1 + 676) = 1;
      if (!*(_BYTE *)(a1 + 659))
        *(_BYTE *)(a1 + 684) = 4;
    }
    else
    {
      phOsalNfc_MemCopy();
      v4 = *(_DWORD *)(a1 + 248);
      v5 = *(_WORD *)(a1 + 252);
    }
    v17 = v4 - v5;
    *(_WORD *)(a1 + 682) += v17;
    v15 = v5 + v17;
LABEL_17:
    *(_WORD *)(a1 + 252) = v15;
    return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HAfterRead_CopyDataToBuff");
  }
  phOsalNfc_MemCopy();
  v16 = *(unsigned __int8 *)(a1 + 659);
  *(_WORD *)(a1 + 252) += v16;
  *(_WORD *)(a1 + 682) += v16;
  *(_BYTE *)(a1 + 659) = 0;
  *(_WORD *)(a1 + 676) = 0;
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HAfterRead_CopyDataToBuff");
}

uint64_t sub_2198B18E4(uint64_t a1)
{
  unsigned int v2;
  int v3;
  int v4;
  unsigned int v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HChkApduBuff_Size");
  v2 = sub_2198B0E68(a1);
  v3 = *(_DWORD *)(a1 + 248);
  v4 = *(unsigned __int16 *)(a1 + 252);
  if (v3 == v4)
  {
    v5 = *(unsigned __int8 *)(a1 + 640);
    if (v2 <= v5)
    {
      if (v2 == v5)
      {
        if (!*(_BYTE *)(a1 + 659))
          goto LABEL_8;
        goto LABEL_17;
      }
      if (v3 != 16 * v2)
      {
        v6 = 0;
        goto LABEL_19;
      }
      goto LABEL_8;
    }
LABEL_17:
    v6 = 0;
    **(_DWORD **)(a1 + 552) = v3;
    goto LABEL_18;
  }
  if (v4 == 16 * v2)
    goto LABEL_7;
  if (v2 != *(unsigned __int8 *)(a1 + 640))
  {
    *(_BYTE *)(a1 + 680) = 1;
    v6 = 13;
    goto LABEL_19;
  }
  if (!*(_BYTE *)(a1 + 659))
  {
LABEL_7:
    v3 = *(unsigned __int16 *)(a1 + 252);
    goto LABEL_8;
  }
  if (*(_BYTE *)(a1 + 684) == 1)
  {
    v6 = 0;
    **(_DWORD **)(a1 + 552) = v4;
LABEL_18:
    *(_WORD *)(a1 + 252) = 0;
    goto LABEL_19;
  }
  sub_2198B15F0(a1);
  v3 = *(unsigned __int16 *)(a1 + 252);
  if (*(_BYTE *)(a1 + 659))
    goto LABEL_17;
LABEL_8:
  v6 = 0;
  **(_DWORD **)(a1 + 552) = v3;
  *(_WORD *)(a1 + 252) = 0;
  *(_BYTE *)(a1 + 659) = 0;
  *(_BYTE *)(a1 + 684) = 4;
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HChkApduBuff_Size");
  return v6;
}

uint64_t sub_2198B1A10(uint64_t a1, unsigned int a2)
{
  unsigned int v4;
  BOOL v5;
  unsigned int v6;
  int v7;
  uint64_t v8;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HSetTrxLen");
  v4 = *(_DWORD *)(a1 + 248) - *(unsigned __int16 *)(a1 + 252);
  v5 = (v4 & 0xF) == 0;
  v6 = v4 >> 4;
  if (!v5)
    LOWORD(v6) = v6 + 1;
  if (a2 >= (unsigned __int16)v6)
  {
    v7 = *(unsigned __int8 *)(a1 + 640);
    if ((int)(a2 - v7) >= (unsigned __int16)v6)
      goto LABEL_7;
  }
  else
  {
    LOWORD(v7) = *(unsigned __int8 *)(a1 + 640);
  }
  LOWORD(v6) = a2 - v7;
LABEL_7:
  v6 = (unsigned __int16)v6;
  if ((unsigned __int16)v6 >= *(unsigned __int8 *)(a1 + 691))
    v6 = *(unsigned __int8 *)(a1 + 691);
  if (v6 >= a2)
    v6 = a2;
  v8 = 16 * v6;
  *(_WORD *)(a1 + 688) = 16 * v6;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HSetTrxLen");
  return v8;
}

uint64_t sub_2198B1AC8(uint64_t a1, unsigned int *a2, uint64_t a3)
{
  unsigned int *v5;
  int v6;
  unsigned int v7;
  int v8;
  uint64_t v9;
  unsigned int v11;
  unsigned int v12;
  char v13;
  __int16 v14;
  unsigned __int16 v15;
  uint64_t v16;
  unsigned __int16 v17;
  unsigned int v18;
  unsigned int v19;
  int v20;
  uint64_t v21;
  int v22;
  uint64_t v23;
  uint64_t v24;

  sub_219850718(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_Process");
  if (!(_DWORD)a3)
  {
    switch(*(_BYTE *)a2)
    {
      case 2:
        sub_219850718(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateManufIdDetails");
        v7 = *((unsigned __int16 *)a2 + 132);
        if (*((_BYTE *)a2 + 65))
        {
          if (v7 <= 0x11)
            goto LABEL_51;
        }
        else if (v7 < 0x14)
        {
          goto LABEL_51;
        }
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
        if (*((_BYTE *)a2 + 65))
        {
          *(_BYTE *)(*((_QWORD *)a2 + 28) + 28) = 18;
          v13 = -4;
        }
        else
        {
          *(_BYTE *)(*((_QWORD *)a2 + 28) + 28) = *((_BYTE *)a2 + 284);
          v13 = *((_BYTE *)a2 + 285);
        }
        *(_BYTE *)(*((_QWORD *)a2 + 28) + 27) = v13;
        *(_BYTE *)(*((_QWORD *)a2 + 28) + 18) = 8;
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
        v16 = *((_QWORD *)a2 + 28);
        if (*(_BYTE *)(v16 + 28) == 18 && *(unsigned __int8 *)(v16 + 27) == 252)
        {
          sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateManufIdDetails");
          *((_BYTE *)a2 + 685) = 18;
          v9 = sub_2198B11BC((uint64_t)a2);
          if (v9 == 13)
            return sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_Process");
LABEL_52:
          v5 = a2;
          v6 = 0;
          goto LABEL_13;
        }
LABEL_51:
        sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateManufIdDetails");
        v9 = 22;
        goto LABEL_52;
      case 4:
        if (*((_BYTE *)a2 + 276))
        {
          v9 = 20;
        }
        else
        {
          v9 = sub_2198B3384(a2);
          if (!(_DWORD)v9)
          {
            v9 = sub_2198B3448((uint64_t)a2);
            if (!(_DWORD)v9)
            {
              v9 = 245;
              v22 = (*((unsigned __int8 *)a2 + 698) << 24) | (*((unsigned __int8 *)a2 + 699) << 8) | *((unsigned __int8 *)a2 + 700);
              switch(*((_BYTE *)a2 + 685))
              {
                case 0x10:
                  v21 = sub_2198B2788((uint64_t)a2);
                  goto LABEL_67;
                case 0x11:
                  if (!v22 && !*((_BYTE *)a2 + 65))
                  {
                    v5 = a2;
                    v6 = 1;
                    v9 = 157;
                    goto LABEL_13;
                  }
                  v23 = sub_2198B28A4((uint64_t)a2, v22);
                  if (v23 == 13)
                    return sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_Process");
                  v9 = v23;
                  break;
                case 0x12:
                  v9 = sub_21988B840((uint64_t)a2, v22);
                  *((_BYTE *)a2 + 544) = 3;
                  *((_WORD *)a2 + 126) = 0;
                  *((_BYTE *)a2 + 685) = 15;
                  goto LABEL_52;
                case 0x14:
                  v24 = sub_2198B25E8((uint64_t)a2);
                  if (v24 == 13)
                    return sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_Process");
                  v9 = v24;
                  goto LABEL_43;
                default:
                  goto LABEL_40;
              }
              goto LABEL_41;
            }
          }
        }
LABEL_40:
        if (*((_BYTE *)a2 + 540) != 6)
          goto LABEL_41;
LABEL_43:
        v5 = a2;
        v6 = 4;
        goto LABEL_13;
      case 5:
        v9 = sub_2198B3384(a2);
        if ((_DWORD)v9)
          goto LABEL_41;
        if (*((_BYTE *)a2 + 267) == 7
          && (v11 = sub_2198B0E68((uint64_t)a2), v12 = sub_2198B1A10((uint64_t)a2, v11), !*((_BYTE *)a2 + 276)))
        {
          if (v12 == 16 * *((unsigned __int8 *)a2 + 278))
          {
            *((_BYTE *)a2 + 640) += v12 >> 4;
            sub_2198B15F0((uint64_t)a2);
            v9 = sub_2198B13EC((uint64_t)a2, 0);
            if (v9 == 13)
              return sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_Process");
          }
          else
          {
            *((_WORD *)a2 + 126) = 0;
            *((_BYTE *)a2 + 659) = 0;
            v9 = 27;
          }
        }
        else
        {
          *((_WORD *)a2 + 126) = 0;
          v9 = 20;
        }
LABEL_41:
        v5 = a2;
        v6 = 1;
        goto LABEL_13;
      case 6:
        if (*((_BYTE *)a2 + 267) != 9 || *((_BYTE *)a2 + 276))
        {
          *((_WORD *)a2 + 126) = 0;
          *((_BYTE *)a2 + 642) = 0;
          a2[62] = 0;
LABEL_28:
          v5 = a2;
          v6 = 2;
          v9 = 21;
          goto LABEL_13;
        }
        if (*((_BYTE *)a2 + 679) == 1)
        {
          phOsalNfc_MemCopy();
          v14 = *((_WORD *)a2 + 106);
          *((_BYTE *)a2 + 642) += v14;
          v15 = *((_WORD *)a2 + 126) + v14;
          *((_WORD *)a2 + 126) = v15;
          **((_DWORD **)a2 + 32) = v15;
          *((_BYTE *)a2 + 679) = 0;
          sub_2198B2940((uint64_t)a2);
          return sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_Process");
        }
        v17 = *((_WORD *)a2 + 126) + *((_WORD *)a2 + 106);
        *((_WORD *)a2 + 126) = v17;
        **((_DWORD **)a2 + 32) = v17;
        if (*((_BYTE *)a2 + 684))
        {
          v18 = *((unsigned __int8 *)a2 + 640);
          v19 = *((unsigned __int16 *)a2 + 347);
          if (v19 > v18)
          {
            LOBYTE(v18) = *((_BYTE *)a2 + 641) + v18;
            *((_BYTE *)a2 + 640) = v18;
            v18 = v18;
          }
          if (v19 == v18)
          {
            v20 = 16 * v19;
            if (v20 == v17
              || ((*((unsigned __int8 *)a2 + 698) << 24) | (*((unsigned __int8 *)a2 + 699) << 8) | *((unsigned __int8 *)a2 + 700))
               + v17 == v20)
            {
              *((_BYTE *)a2 + 684) = 4;
              v21 = sub_2198B2424((uint64_t)a2, 1);
              goto LABEL_67;
            }
          }
        }
        else
        {
          *((_BYTE *)a2 + 640) += *((_BYTE *)a2 + 641);
        }
LABEL_66:
        v21 = sub_2198B2940((uint64_t)a2);
LABEL_67:
        if (v21 == 13)
          return sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_Process");
        v9 = v21;
LABEL_32:
        v5 = a2;
        v6 = 2;
        goto LABEL_13;
      case 7:
        if (*((_BYTE *)a2 + 276))
          goto LABEL_28;
        goto LABEL_66;
      case 8:
        if (*((_BYTE *)a2 + 276))
          v9 = 21;
        else
          v9 = 0;
        goto LABEL_32;
      case 0xA:
        if (*((_BYTE *)a2 + 276))
        {
          v9 = 21;
        }
        else
        {
          v9 = 0;
          *((_BYTE *)a2 + 545) = 1;
        }
        goto LABEL_43;
      default:
        goto LABEL_17;
    }
  }
  if (*((_BYTE *)a2 + 540) == 6)
  {
    v5 = a2;
    v6 = 4;
  }
  else
  {
    v8 = *(unsigned __int8 *)a2;
    if ((v8 - 1) < 4)
    {
      v5 = a2;
      v6 = 0;
    }
    else if ((v8 - 6) >= 3)
    {
      if (v8 != 5)
      {
LABEL_17:
        v5 = a2;
        v6 = 5;
        v9 = 245;
        goto LABEL_13;
      }
      v5 = a2;
      v6 = 1;
    }
    else
    {
      v5 = a2;
      v6 = 2;
    }
  }
  v9 = a3;
LABEL_13:
  sub_2198B12A0(v5, v6, v9);
  return sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_Felica_Process");
}

uint64_t sub_2198B2060(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_Felica_CB_Transceive");
  sub_21988EF68(v10, &v9);
  v7 = v9;
  if (v9)
  {
    if (a4)
      *(_WORD *)(v9 + 264) = *(_DWORD *)(a4 + 8);
    (*(void (**)(_QWORD, uint64_t, uint64_t))(v7 + 48))(*(_QWORD *)(v7 + 2712), v7, a5);
  }
  return sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_Felica_CB_Transceive");
}

uint64_t sub_2198B20F4(uint64_t a1, unsigned int *a2, unsigned int *a3, char a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  unsigned int *v12;
  unsigned int *v13;
  unsigned int *v14;
  uint64_t v15;
  unsigned int *v17;
  __int16 v18;
  char v19;
  uint64_t v20;

  v20 = a1;
  v19 = 0;
  v18 = 208;
  v17 = 0;
  sub_219850718(0, (unsigned int *)&v20, 8u, 5u, (uint64_t)"phFriNfc_Felica_WrNdef");
  sub_21988EF68(v20, &v17);
  v11 = 1;
  if (a3 && a5 && v17)
  {
    phOsalNfc_MemCopy();
    v12 = v17;
    v13 = v17 + 685;
    v17[685] = 3;
    if (*a3)
    {
      v13 = a3;
      v14 = a2;
    }
    else
    {
      v14 = v12 + 684;
    }
    *((_QWORD *)v12 + 3) = a5;
    *((_QWORD *)v12 + 5) = a6;
    *((_WORD *)v12 + 126) = 0;
    **((_WORD **)v12 + 66) = 0;
    v12[62] = *v13;
    *((_QWORD *)v12 + 30) = v14;
    *((_QWORD *)v12 + 32) = v13;
    *v13 = 0;
    *((_BYTE *)v12 + 540) = 3;
    *((_BYTE *)v12 + 686) = a4;
    *((_BYTE *)v12 + 685) = 16;
    if (*((_BYTE *)v12 + 65))
      v15 = sub_2198B224C((uint64_t)v12);
    else
      v15 = sub_2198B11BC((uint64_t)v12);
    v11 = v15;
    if (v15 != 13)
      sub_2198B12A0(v17, 0, v15);
  }
  sub_219850808(0, (unsigned int *)&v20, 8u, 5u, (uint64_t)"phFriNfc_Felica_WrNdef");
  return v11;
}

uint64_t sub_2198B224C(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  v2 = a1 + 276;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HNdefWrAttrInfo");
  *(_DWORD *)(a1 + 232) = 240;
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_WORD *)(a1 + 266) = 2048;
  phOsalNfc_MemCopy();
  *(_QWORD *)v2 = 0xF10008001000901;
  *(_WORD *)(a1 + 284) = 12;
  *(_BYTE *)(a1 + 286) = -109;
  *(_DWORD *)(v2 + 11) = 0;
  *(_DWORD *)(v2 + 15) = 271;
  *(_WORD *)(a1 + 295) = 496;
  *(_BYTE *)(a1 + 297) = -67;
  *(_BYTE *)(a1 + 266) = 32;
  *(_WORD *)(a1 + 264) = 260;
  *(_WORD *)(a1 + 526) = 32;
  *(_BYTE *)a1 = 7;
  *(_QWORD *)(a1 + 48) = sub_2198B1AC8;
  *(_QWORD *)(a1 + 56) = a1;
  v3 = sub_219888630(a1, (uint64_t)sub_2198B2060);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HNdefWrAttrInfo");
  return v3;
}

uint64_t sub_2198B2360(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  unsigned int *v6;
  unsigned int *v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_Felica_ConvertToRdOnlyNdef");
  sub_21988EF68(v9, &v8);
  v5 = 1;
  if (a2)
  {
    v6 = v8;
    if (v8)
    {
      *((_QWORD *)v8 + 4) = a2;
      *((_QWORD *)v6 + 5) = a3;
      *((_BYTE *)v6 + 540) = 6;
      *((_BYTE *)v6 + 685) = 20;
      v5 = sub_2198B11BC((uint64_t)v6);
      if (v5 != 13)
        sub_2198B12A0(v8, 0, v5);
    }
  }
  sub_219850808(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_Felica_ConvertToRdOnlyNdef");
  return v5;
}

uint64_t sub_2198B2424(uint64_t a1, int a2)
{
  char v4;
  __int16 v5;
  __int16 v6;
  __int16 v7;
  __int16 v8;
  unsigned int v9;
  uint64_t i;
  uint64_t v11;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateAttrBlkForWrOp");
  if (a2)
    v4 = 8;
  else
    v4 = 7;
  *(_BYTE *)a1 = v4;
  *(_DWORD *)(a1 + 232) = 240;
  *(_WORD *)(a1 + 266) = 2048;
  phOsalNfc_MemCopy();
  *(_DWORD *)(a1 + 276) = 16779521;
  *(_WORD *)(a1 + 280) = 128;
  *(_BYTE *)(a1 + 282) = *(_BYTE *)(a1 + 690);
  *(_WORD *)(a1 + 283) = *(_WORD *)(a1 + 691);
  v5 = *(_WORD *)(a1 + 694);
  *(_BYTE *)(a1 + 285) = HIBYTE(v5);
  *(_BYTE *)(a1 + 286) = v5;
  *(_DWORD *)(a1 + 287) = 0;
  if (a2)
  {
    v6 = *(unsigned __int8 *)(a1 + 642);
    if (*(_BYTE *)(a1 + 642))
    {
      v7 = *(unsigned __int8 *)(a1 + 640);
      if (!*(_BYTE *)(a1 + 640))
      {
        v11 = 1;
        goto LABEL_14;
      }
      *(_BYTE *)(a1 + 291) = 0;
      *(_BYTE *)(a1 + 292) = *(_BYTE *)(a1 + 697);
      v8 = v6 + 16 * v7 - 16;
    }
    else
    {
      *(_BYTE *)(a1 + 291) = 0;
      *(_BYTE *)(a1 + 292) = *(_BYTE *)(a1 + 697);
      v8 = 16 * *(unsigned __int8 *)(a1 + 640);
    }
    *(_BYTE *)(a1 + 293) = 0;
    *(_BYTE *)(a1 + 294) = HIBYTE(v8);
  }
  else
  {
    *(_BYTE *)(a1 + 291) = 15;
    *(_BYTE *)(a1 + 292) = *(_BYTE *)(a1 + 697);
    *(_WORD *)(a1 + 293) = *(_WORD *)(a1 + 698);
    LOBYTE(v8) = *(_BYTE *)(a1 + 700);
  }
  v9 = 0;
  *(_BYTE *)(a1 + 295) = v8;
  for (i = 282; i != 296; ++i)
    v9 += *(unsigned __int8 *)(a1 + i);
  *(_WORD *)(a1 + 296) = bswap32(v9) >> 16;
  *(_BYTE *)(a1 + 266) = 32;
  *(_WORD *)(a1 + 264) = 260;
  *(_WORD *)(a1 + 526) = 32;
  *(_QWORD *)(a1 + 48) = sub_2198B1AC8;
  *(_QWORD *)(a1 + 56) = a1;
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  v11 = sub_219888630(a1, (uint64_t)sub_2198B2060);
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateAttrBlkForWrOp");
  return v11;
}

uint64_t sub_2198B25E8(uint64_t a1)
{
  int v2;
  __int16 v3;
  int v4;
  unsigned int v5;
  uint64_t i;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateAttrBlkForRdOnlyOp");
  if (!a1)
    goto LABEL_10;
  v2 = *(unsigned __int8 *)(a1 + 697);
  if (v2 != 1)
  {
LABEL_5:
    if (!v2 && sub_21987BA3C(*(_QWORD *)(a1 + 2712)) == 1)
      goto LABEL_7;
LABEL_10:
    v7 = 4341;
    goto LABEL_11;
  }
  if (sub_21987BA3C(*(_QWORD *)(a1 + 2712)))
  {
    v2 = *(unsigned __int8 *)(a1 + 697);
    goto LABEL_5;
  }
LABEL_7:
  *(_BYTE *)a1 = 10;
  *(_DWORD *)(a1 + 232) = 240;
  *(_WORD *)(a1 + 266) = 2048;
  phOsalNfc_MemCopy();
  *(_DWORD *)(a1 + 276) = 16779521;
  *(_WORD *)(a1 + 280) = 128;
  *(_BYTE *)(a1 + 282) = *(_BYTE *)(a1 + 690);
  *(_WORD *)(a1 + 283) = *(_WORD *)(a1 + 691);
  v3 = *(_WORD *)(a1 + 694);
  *(_BYTE *)(a1 + 285) = HIBYTE(v3);
  *(_BYTE *)(a1 + 286) = v3;
  *(_DWORD *)(a1 + 287) = 0;
  *(_BYTE *)(a1 + 291) = 0;
  v4 = sub_21987BA3C(*(_QWORD *)(a1 + 2712));
  v5 = 0;
  *(_BYTE *)(a1 + 292) = v4 == 1;
  *(_BYTE *)(a1 + 293) = *(_BYTE *)(a1 + 698);
  *(_WORD *)(a1 + 294) = *(_WORD *)(a1 + 699);
  for (i = 282; i != 296; ++i)
    v5 += *(unsigned __int8 *)(a1 + i);
  *(_WORD *)(a1 + 296) = bswap32(v5) >> 16;
  *(_BYTE *)(a1 + 266) = 32;
  *(_WORD *)(a1 + 264) = 260;
  *(_WORD *)(a1 + 526) = 32;
  *(_QWORD *)(a1 + 48) = sub_2198B1AC8;
  *(_QWORD *)(a1 + 56) = a1;
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  v7 = sub_219888630(a1, (uint64_t)sub_2198B2060);
LABEL_11:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateAttrBlkForRdOnlyOp");
  return v7;
}

uint64_t sub_2198B2788(uint64_t a1)
{
  uint64_t v2;
  int v4;
  int v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HChkAttrBlkForWrOp");
  if (*(_BYTE *)(a1 + 697))
  {
    if (*(_BYTE *)(a1 + 686) == 1 || *(_BYTE *)(a1 + 540) == 2)
    {
      *(_BYTE *)(a1 + 684) = 2 * (*(_DWORD *)(a1 + 248) > 16 * *(unsigned __int16 *)(a1 + 694));
      *(_BYTE *)(a1 + 642) = 0;
      *(_WORD *)(a1 + 640) = 0;
      sub_2198B115C((unsigned int *)a1, (_QWORD *)(a1 + 643));
    }
    else
    {
      if (*(_BYTE *)(a1 + 686))
      {
        v2 = 13;
        goto LABEL_9;
      }
      v4 = (*(unsigned __int8 *)(a1 + 698) << 24) | (*(unsigned __int8 *)(a1 + 699) << 8) | *(unsigned __int8 *)(a1 + 700);
      v5 = *(unsigned __int16 *)(a1 + 694);
      if (v4 + *(_DWORD *)(a1 + 248) > (16 * v5))
      {
        if (v4 == 16 * v5)
        {
          v2 = 26;
          goto LABEL_9;
        }
        *(_BYTE *)(a1 + 684) = 3;
      }
      *(_WORD *)(a1 + 252) = 0;
      *(_BYTE *)(a1 + 641) = 0;
    }
    v2 = sub_2198B2424(a1, 0);
  }
  else
  {
    v2 = 245;
  }
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HChkAttrBlkForWrOp");
  return v2;
}

uint64_t sub_2198B28A4(uint64_t a1, int a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HChkAttrBlkForRdOp");
  if (*(_BYTE *)(a1 + 696) == 15)
  {
    **(_DWORD **)(a1 + 552) = 0;
    v4 = 20;
  }
  else
  {
    v4 = sub_21988B840(a1, a2);
    if (!(_DWORD)v4)
      v4 = sub_2198B13EC(a1, *(unsigned __int8 *)(a1 + 686));
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HChkAttrBlkForRdOp");
  return v4;
}

uint64_t sub_2198B2940(uint64_t a1)
{
  uint64_t v2;
  int v3;
  int v4;
  int v5;
  int v6;
  unsigned int v7;
  unsigned int v8;
  int v9;
  int v10;
  unsigned int v11;
  unsigned int v12;
  unsigned int v13;
  char v14;
  unsigned __int8 v15;
  int v16;
  unsigned int v17;
  unsigned int v18;
  int v19;
  unsigned int v20;
  int v21;
  unsigned __int8 v22;
  int v23;
  int v24;
  unsigned __int8 v25;
  int v26;
  uint64_t v27;
  __int16 v28;
  int v29;
  int v30;
  char v31;
  unsigned __int8 v32;
  unsigned __int8 v33;
  unsigned int v34;
  char v35;
  char v36;
  int v37;
  unsigned __int8 v38;
  int v39;
  unsigned __int8 v40;
  char v41;
  __int16 v42;
  __int16 v43;
  int v44;
  unsigned __int8 v45;
  int v46;
  uint64_t v47;
  __int16 v49;
  unsigned int v50;
  unsigned int v51;
  __int16 v52;
  int v53;
  char v54;
  uint64_t v55;
  _BYTE *v56;
  char v57;
  __int16 v58;
  int v59;
  unsigned __int8 v60;
  int v61;
  int v63;
  int v64;
  int v65;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateData");
  if (*(_DWORD *)(a1 + 248) != *(unsigned __int16 *)(a1 + 252))
  {
    *(_WORD *)(a1 + 266) = 2048;
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 276) = 2305;
    *(_BYTE *)(a1 + 278) = 0;
    v3 = *(unsigned __int8 *)(a1 + 684);
    if (v3 == 3)
    {
      sub_2198B0E68(a1);
      if (*(_BYTE *)(a1 + 642))
        v5 = 16 - *(unsigned __int8 *)(a1 + 642);
      else
        v5 = 0;
      v4 = v5 - 16 * *(unsigned __int8 *)(a1 + 640) + 16 * *(unsigned __int16 *)(a1 + 694);
    }
    else
    {
      v4 = 0;
      if (v3 == 2)
        v4 = 16 * (*(unsigned __int16 *)(a1 + 694) - *(unsigned __int8 *)(a1 + 640));
    }
    v6 = *(unsigned __int8 *)(a1 + 642);
    if (*(_BYTE *)(a1 + 642))
    {
      *(_BYTE *)(a1 + 279) = 0;
      v7 = *(_DWORD *)(a1 + 248);
      v8 = 16 - v6;
      if (v7 <= 16 - v6)
      {
        v9 = 0;
        v14 = 0;
        v15 = 0;
        *(_BYTE *)(a1 + 641) = 0;
      }
      else
      {
        v9 = *(_DWORD *)(a1 + 248) - v8;
        if (*(_BYTE *)(a1 + 684))
          v10 = v4;
        else
          v10 = *(_DWORD *)(a1 + 248) - v8;
        if (v10)
        {
          if (*(_BYTE *)(a1 + 684))
          {
            v11 = ((v4 + v6 + 4080) >> 4);
            v12 = *(unsigned __int8 *)(a1 + 692);
            if (v11 | v4 & 0xF)
              v13 = (v4 + v6 + 4080) >> 4;
            else
              LOBYTE(v13) = 1;
            if (v11 >= v12)
            {
              v15 = 0;
              *(_BYTE *)(a1 + 641) = v12 - 1;
              v14 = 1;
            }
            else if ((((_BYTE)v4 + (_BYTE)v6) & 0xF) != 0)
            {
              v14 = 0;
              v15 = 16 * (v13 + 1) - v4;
              *(_BYTE *)(a1 + 678) = 1;
              *(_BYTE *)(a1 + 641) = v13 + 1;
              LOBYTE(v12) = v13 + 2;
            }
            else
            {
              if (v6 - 16 + v4)
                LOBYTE(v12) = v13 + 1;
              else
                LOBYTE(v12) = 1;
              v15 = 0;
              v14 = 0;
              if (*(_BYTE *)(a1 + 678))
                *(_BYTE *)(a1 + 641) = v12 - 1;
            }
            v9 = v4;
          }
          else
          {
            v50 = (v7 - v8);
            v12 = *(unsigned __int8 *)(a1 + 692);
            if (v12 > v50 >> 4)
            {
              if ((v9 & 0xF) != 0)
              {
                v14 = 0;
                v51 = v50 >> 4;
                v15 = 16 * (v51 + 1) - (v7 - v8);
                *(_BYTE *)(a1 + 678) = 1;
                *(_BYTE *)(a1 + 641) = v51 + 1;
                LOBYTE(v12) = v51 + 2;
              }
              else
              {
                if (v50 >= 0x10)
                  v65 = (v50 >> 4) + 1;
                else
                  LOBYTE(v65) = 2;
                if (v6 - 16 + v9)
                  LOBYTE(v12) = v65;
                else
                  LOBYTE(v12) = 1;
                v14 = 0;
                v15 = 0;
                if (*(_BYTE *)(a1 + 678))
                  *(_BYTE *)(a1 + 641) = v12 - 1;
              }
              goto LABEL_35;
            }
            v15 = 0;
            *(_BYTE *)(a1 + 641) = v12 - 1;
            v14 = 1;
          }
          if (!(_BYTE)v12)
          {
            LOBYTE(v12) = 0;
            v32 = 14;
            goto LABEL_40;
          }
LABEL_35:
          v29 = 0;
          v30 = *(unsigned __int8 *)(a1 + 678);
          v31 = *(_BYTE *)(a1 + 640);
          v32 = 14;
          do
          {
            *(_BYTE *)(a1 + v32 + 266) = 0x80;
            v33 = v32 | 1;
            if (v30 == 1)
              *(_BYTE *)(a1 + v33 + 266) = v31 + v29++;
            else
              *(_BYTE *)(a1 + v33 + 266) = v31 + ++v29;
            v32 += 2;
          }
          while (v29 < v12);
LABEL_40:
          v34 = v7 - *(unsigned __int16 *)(a1 + 252);
          phOsalNfc_MemCopy();
          v35 = *(_BYTE *)(a1 + 642);
          if (v34 < v8)
          {
            v36 = v35 + v32;
            phOsalNfc_MemCopy();
            v37 = *(_DWORD *)(a1 + 248);
            v38 = v36 + v37;
            if ((*(_BYTE *)(a1 + 642) + v37) != 16)
            {
              v39 = 0;
              v40 = 16 - (*(_BYTE *)(a1 + 642) + v37);
              do
              {
                *(_BYTE *)(a1 + v38++ + 266) = 0;
                ++v39;
              }
              while (v39 < v40);
            }
            *(_WORD *)(a1 + 212) = v37;
            *(_BYTE *)(a1 + 679) = 1;
            if (*(_BYTE *)(a1 + 678))
              *(_BYTE *)(a1 + 641) = 0;
            goto LABEL_54;
          }
          v41 = v35 + v32;
          phOsalNfc_MemCopy();
          v42 = *(unsigned __int8 *)(a1 + 642);
          *(_WORD *)(a1 + 212) = 16 - v42;
          v38 = v41 + 16 - v42;
          if (!v9)
            goto LABEL_53;
          if (*(_BYTE *)(a1 + 684))
          {
            if ((v14 & 1) == 0)
            {
              phOsalNfc_MemCopy();
              v43 = v9 + *(unsigned __int8 *)(a1 + 642);
              *(_WORD *)(a1 + 212) = v43 + *(_WORD *)(a1 + 212) - 16;
              v38 = v43 + v38 - 16;
              if (v15)
              {
                v44 = 0;
                do
                {
                  *(_BYTE *)(a1 + v38++ + 266) = 0;
                  ++v44;
                }
                while (v44 < v15);
LABEL_52:
                *(_BYTE *)(a1 + 642) = 16 - v15;
                phOsalNfc_MemCopy();
LABEL_54:
                *(_BYTE *)(a1 + 266) = v38;
                *(_WORD *)(a1 + 526) = v38;
                *(_BYTE *)(a1 + 279) = v12;
LABEL_80:
                sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HWriteDataBlk");
                *(_BYTE *)(a1 + 204) &= 0xFCu;
                *(_DWORD *)(a1 + 232) = 240;
                *(_BYTE *)a1 = 6;
                *(_WORD *)(a1 + 264) = 260;
                v2 = sub_219888630(a1, (uint64_t)sub_2198B2060);
                sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HWriteDataBlk");
                goto LABEL_81;
              }
LABEL_53:
              *(_BYTE *)(a1 + 642) = 0;
              goto LABEL_54;
            }
          }
          else if ((v14 & 1) == 0)
          {
            phOsalNfc_MemCopy();
            v63 = *(_DWORD *)(a1 + 248) + *(unsigned __int8 *)(a1 + 642);
            *(_WORD *)(a1 + 212) = *(_WORD *)(a1 + 212) + v63 - 16;
            v38 = v63 + v38 - 16;
            if (!v15)
            {
              *(_BYTE *)(a1 + 642) = 0;
              goto LABEL_54;
            }
            v64 = 0;
            do
            {
              *(_BYTE *)(a1 + v38++ + 266) = 0;
              ++v64;
            }
            while (v64 < v15);
            goto LABEL_52;
          }
          phOsalNfc_MemCopy();
          v52 = *(unsigned __int8 *)(a1 + 692);
          v38 = v38 + 16 * v52 - 16;
          *(_BYTE *)(a1 + 642) = 0;
          *(_WORD *)(a1 + 212) = *(_WORD *)(a1 + 212) + 16 * v52 - 16;
          *(_BYTE *)(a1 + 678) = 0;
          goto LABEL_54;
        }
        v9 = 0;
        v14 = 0;
        v15 = 0;
      }
      LOBYTE(v12) = 1;
      goto LABEL_35;
    }
    v16 = *(unsigned __int16 *)(a1 + 252);
    v17 = *(_DWORD *)(a1 + 248) - v16;
    v18 = *(unsigned __int8 *)(a1 + 692);
    if (v17 >= 16 * v18)
    {
      v23 = *(unsigned __int8 *)(a1 + 640);
      v24 = *(unsigned __int16 *)(a1 + 694) - v23;
      if (v24 >= (int)v18)
      {
        *(_BYTE *)(a1 + 279) = v18;
        v45 = 14;
        if (v18)
        {
          v46 = 1;
          do
          {
            v47 = a1 + 266;
            *(_BYTE *)(v47 + v45) = 0x80;
            *(_BYTE *)(v47 + (v45 | 1u)) = v46 + v23;
            v45 += 2;
          }
          while (v18 > v46++);
        }
        phOsalNfc_MemCopy();
        v49 = *(unsigned __int8 *)(a1 + 692);
        *(_BYTE *)(a1 + 266) = v45 + 16 * v49;
        *(_BYTE *)(a1 + 642) = 0;
        *(_WORD *)(a1 + 212) = 16 * v49;
        *(_BYTE *)(a1 + 641) = v49;
        *(_WORD *)(a1 + 526) = (v45 + 16 * v49);
        *(_BYTE *)(a1 + 678) = 0;
      }
      else
      {
        *(_BYTE *)(a1 + 279) = v24;
        v25 = 14;
        if (v24 >= 1)
        {
          v26 = 1;
          do
          {
            v27 = a1 + 266;
            *(_BYTE *)(v27 + v25) = 0x80;
            *(_BYTE *)(v27 + (v25 | 1u)) = v26 + v23;
            v25 += 2;
            ++v26;
          }
          while (v24 >= v26);
        }
        phOsalNfc_MemCopy();
        v28 = *(_WORD *)(a1 + 694) - *(unsigned __int8 *)(a1 + 640);
        *(_BYTE *)(a1 + 266) = v25 + 16 * v28;
        *(_WORD *)(a1 + 212) = 16 * v28;
        *(_BYTE *)(a1 + 641) = v28;
        *(_WORD *)(a1 + 526) = (v25 + 16 * v28);
        *(_BYTE *)(a1 + 678) = 0;
        *(_BYTE *)(a1 + 642) = 0;
      }
      goto LABEL_80;
    }
    v19 = *(unsigned __int8 *)(a1 + 684);
    if (*(_BYTE *)(a1 + 684))
    {
      v20 = v4 >> 4;
      LOBYTE(v21) = v4;
      if ((v4 & 0xF) != 0)
      {
LABEL_26:
        ++v20;
        *(_BYTE *)(a1 + 678) = 1;
        v22 = 16 * v20 - v21;
        *(_BYTE *)(a1 + 279) = v20;
        *(_BYTE *)(a1 + 641) = v20;
        goto LABEL_66;
      }
    }
    else
    {
      v20 = (*(_BYTE *)(a1 + 248) - v16) >> 4;
      v21 = *(_DWORD *)(a1 + 248) - v16;
      if ((v17 & 0xF) != 0)
        goto LABEL_26;
    }
    v22 = 0;
    *(_BYTE *)(a1 + 279) = v20;
    *(_BYTE *)(a1 + 641) = v20;
    if (!v20)
    {
      v57 = 14;
      goto LABEL_69;
    }
LABEL_66:
    v53 = 0;
    v54 = *(_BYTE *)(a1 + 640);
    v55 = 281;
    do
    {
      v56 = (_BYTE *)(a1 + v55);
      *(v56 - 1) = 0x80;
      *v56 = ++v53 + v54;
      v55 += 2;
    }
    while (v20 > v53);
    v57 = v55 - 11;
LABEL_69:
    if (v19)
    {
      phOsalNfc_MemCopy();
      v58 = v4;
      LOBYTE(v59) = v4;
    }
    else
    {
      phOsalNfc_MemCopy();
      v59 = *(_DWORD *)(a1 + 248) - *(unsigned __int16 *)(a1 + 252);
      v58 = (*(_BYTE *)(a1 + 248) - *(_WORD *)(a1 + 252));
    }
    *(_WORD *)(a1 + 212) = v58;
    v60 = v57 + v59;
    if (v22)
    {
      v61 = 0;
      do
      {
        *(_BYTE *)(a1 + v60++ + 266) = 0;
        ++v61;
      }
      while (v61 < v22);
      *(_BYTE *)(a1 + 642) = 16 - v22;
      phOsalNfc_MemCopy();
    }
    else
    {
      *(_BYTE *)(a1 + 642) = 0;
      *(_BYTE *)(a1 + 678) = 0;
    }
    *(_BYTE *)(a1 + 266) = v60;
    *(_WORD *)(a1 + 526) = v60;
    goto LABEL_80;
  }
  v2 = sub_2198B2424(a1, 1);
LABEL_81:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateData");
  return v2;
}

uint64_t sub_2198B31F8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  __int16 v9;
  uint64_t v10;

  v10 = a1;
  v9 = -1006;
  v8 = 0;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_Felica_ChkNdef");
  sub_21988EF68(v10, &v8);
  v5 = 1;
  if (a3)
  {
    if (a2)
    {
      v6 = v8;
      if (v8)
      {
        *(_QWORD *)(v8 + 8) = a2;
        *(_QWORD *)(v6 + 40) = a3;
        v5 = sub_2198B32AC(v6, &v9, 2);
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_Felica_ChkNdef");
  return v5;
}

uint64_t sub_2198B32AC(uint64_t a1, _BYTE *a2, char a3)
{
  char v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HPollCard");
  *(_WORD *)(a1 + 266) = 6;
  *(_BYTE *)(a1 + 268) = *a2;
  *(_BYTE *)(a1 + 269) = a2[1];
  if (*(_BYTE *)(a1 + 65))
    v6 = 0;
  else
    v6 = 3;
  *(_BYTE *)(a1 + 270) = *(_BYTE *)(a1 + 65) == 0;
  *(_BYTE *)(a1 + 271) = v6;
  *(_WORD *)(a1 + 526) = 6;
  *(_QWORD *)(a1 + 48) = sub_2198B1AC8;
  *(_QWORD *)(a1 + 56) = a1;
  *(_BYTE *)a1 = a3;
  *(_DWORD *)(a1 + 232) = 240;
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  v7 = sub_219888630(a1, (uint64_t)sub_2198B2060);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HPollCard");
  return v7;
}

uint64_t sub_2198B3384(unsigned int *a1)
{
  uint64_t v2;
  int v3;
  int v4;

  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HCheckManufId");
  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_MemCompare");
  v2 = 0;
  do
  {
    v3 = *((unsigned __int8 *)a1 + v2 + 268);
    v4 = *((unsigned __int8 *)a1 + v2 + 702);
    if ((_DWORD)v2 == 7)
      break;
    ++v2;
  }
  while (v3 == v4);
  sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_MemCompare");
  sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HCheckManufId");
  if (v3 == v4)
    return 0;
  else
    return 29;
}

uint64_t sub_2198B3448(uint64_t a1)
{
  int v2;
  unsigned int v3;
  unsigned int v4;
  unsigned int v5;
  int v6;
  unsigned int v7;
  int v8;
  unsigned int v9;
  uint64_t v10;
  char v12;
  char v13;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateAttrInfo");
  v2 = sub_21988B8FC(a1, 0xDu);
  if (v2)
    goto LABEL_2;
  v3 = __rev16(*(unsigned __int16 *)(a1 + 282));
  if (!v3)
    goto LABEL_17;
  v4 = *(unsigned __int8 *)(a1 + 280);
  if (v3 < v4)
    goto LABEL_17;
  v5 = *(unsigned __int8 *)(a1 + 281);
  if (v3 < v5)
    goto LABEL_17;
  v6 = *(unsigned __int8 *)(a1 + 288);
  if (v6 != 15)
  {
    if (*(_BYTE *)(a1 + 288))
      goto LABEL_17;
  }
  v7 = *(unsigned __int8 *)(a1 + 289);
  if (v7 > 1 || *(_BYTE *)(a1 + 284) || *(_BYTE *)(a1 + 285) || *(_BYTE *)(a1 + 286) || *(_BYTE *)(a1 + 287))
    goto LABEL_17;
  v8 = *(unsigned __int8 *)(a1 + 292);
  v9 = (v8 | (*(unsigned __int8 *)(a1 + 291) << 8)) >> 4;
  if ((v8 & 0xF) != 0)
    ++v9;
  if (v9 > v3)
    goto LABEL_17;
  *(_BYTE *)(a1 + 690) = *(_BYTE *)(a1 + 279);
  *(_BYTE *)(a1 + 691) = v4;
  *(_BYTE *)(a1 + 692) = v5;
  *(_WORD *)(a1 + 694) = v3;
  *(_BYTE *)(a1 + 696) = v6;
  *(_BYTE *)(a1 + 697) = v7;
  v2 = sub_2198B35C0((unsigned int *)a1, a1 + 266, bswap32(*(unsigned __int16 *)(a1 + 293)) >> 16);
  if (v2)
  {
LABEL_2:
    if (v2 == 28)
      *(_BYTE *)(a1 + 545) = 3;
LABEL_17:
    v10 = 28;
    goto LABEL_18;
  }
  v10 = 0;
  if (*(_BYTE *)(a1 + 697) == 1)
    v12 = 2;
  else
    v12 = 3;
  if (*(_BYTE *)(a1 + 697))
    v13 = v12;
  else
    v13 = 1;
  *(_BYTE *)(a1 + 545) = v13;
  *(_BYTE *)(a1 + 698) = *(_BYTE *)(a1 + 290);
  *(_WORD *)(a1 + 699) = *(_WORD *)(a1 + 291);
LABEL_18:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HUpdateAttrInfo");
  return v10;
}

uint64_t sub_2198B35C0(unsigned int *a1, uint64_t a2, int a3)
{
  uint64_t v6;
  unsigned __int16 v7;

  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HCalCheckSum");
  v6 = 0;
  v7 = 0;
  do
    v7 += *(unsigned __int8 *)(a2 + 13 + v6++);
  while (v6 != 14);
  sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_Felica_HCalCheckSum");
  if (a3 == v7)
    return 0;
  else
    return 28;
}

uint64_t sub_2198B3650(uint64_t a1, uint64_t a2, uint64_t a3)
{
  __int128 v7;
  __int128 v8;
  __int128 v9;
  uint64_t v10;

  v10 = 0;
  v8 = 0u;
  v9 = 0u;
  v7 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FelicaReqResCmd");
  if (a1 && a3)
  {
    phOsalNfc_SetMemory();
    *(_BYTE *)(a1 + 1487) = 4;
    phOsalNfc_MemCopy();
    *(_BYTE *)(a1 + 1486) = *(_BYTE *)(a3 + 18) + 2;
    LODWORD(v7) = 0;
    *(_QWORD *)&v8 = a1 + 1486;
    DWORD2(v8) = *(unsigned __int8 *)(a3 + 18) + 2;
    *(_QWORD *)&v9 = a1 + 2016;
    DWORD2(v9) = 530;
    WORD3(v7) = 500;
    a2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), (uint64_t)&v7, (uint64_t)sub_219865DD0, a1);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FelicaReqResCmd");
  return a2;
}

uint64_t sub_2198B3768(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v5;
  _BYTE *v6;
  uint64_t v7;
  unsigned int *v8;
  const char *v9;
  uint64_t v11;

  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FelicaReqResResp");
  if (!a1)
  {
    v7 = 1;
    goto LABEL_15;
  }
  v5 = sub_2198BE4E4(a1, &v11, (_QWORD *)(a1 + 1456), 0);
  if (!a3 || v5)
  {
    v8 = (unsigned int *)(a1 + 19368);
    v9 = "Felica Request Response no response received";
LABEL_14:
    sub_219850628(1, v8, 4u, 1u, (uint64_t)v9);
    v7 = 255;
    goto LABEL_15;
  }
  if (!v11 || (v6 = *(_BYTE **)a3) == 0 || *(_DWORD *)(a3 + 8) != 11)
  {
    v8 = (unsigned int *)(a1 + 19368);
    v9 = "Felica Invalid response buffer or response length";
    goto LABEL_14;
  }
  v7 = 255;
  if (*v6 == 11)
  {
    if (phOsalNfc_MemCompare())
      v7 = 255;
    else
      v7 = 0;
  }
LABEL_15:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FelicaReqResResp");
  return v7;
}

uint64_t sub_2198B3880(uint64_t a1, uint64_t a2, uint64_t a3)
{
  char v6;
  uint64_t *v7;
  uint64_t v8;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FelicaChkPresComplete");
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Completing T3t Connect sequence");
  if ((_DWORD)a2 == 10 && (a2 = sub_21990201C(*(_QWORD *)(a1 + 3040)), (a2 & 0xFFFE) != 0xBA)
    || (a2 - 186) >= 2 && (_DWORD)a2)
  {
    *(_QWORD *)(a1 + 2912) = &qword_2550A2B08;
    *(_BYTE *)(a1 + 2904) = 0;
    *(_BYTE *)(a1 + 2906) = 0;
    v6 = qword_2550A2B08;
    if (qword_2550A2B08)
    {
      v6 = 0;
      v7 = &qword_2550A2B18;
      do
      {
        ++v6;
        v8 = *v7;
        v7 += 2;
      }
      while (v8);
    }
    *(_BYTE *)(a1 + 2905) = v6;
    if (sub_2198655FC(a1, 0, a3) == 13)
      a2 = 13;
    else
      a2 = 255;
  }
  else
  {
    sub_2198C0014(a1, a2);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FelicaChkPresComplete");
  return a2;
}

uint64_t sub_2198B39A4(uint64_t a1)
{
  uint64_t v2;
  int v4;

  v4 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendT3tPollCmd");
  if (a1 && *(_QWORD *)(a1 + 1456))
  {
    v4 = 0xFFFF;
    v2 = sub_21988ABDC(*(_QWORD *)(a1 + 3040), &v4, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendT3tPollCmd");
  return v2;
}

uint64_t sub_2198B3A40(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_T3tCmdResp");
  if (!a1 || (_DWORD)a2)
  {
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"Discovery select command failed!");
    a2 = 255;
  }
  else
  {
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"Discovery select command success");
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_T3tCmdResp");
  return a2;
}

uint64_t sub_2198B3AE8(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_T3tChkPresComplete");
  if (a1)
  {
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"Completing T3t Connect sequence");
    sub_2198C0014((uint64_t)a1, a2);
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_T3tChkPresComplete");
  return a2;
}

uint64_t sub_2198B3B84(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_T3tConnectComplete");
  if (a1)
  {
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"Completing T3t Connect sequence");
    sub_2198B3C10((uint64_t)a1, a2);
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_T3tConnectComplete");
  return a2;
}

uint64_t sub_2198B3C10(uint64_t a1, uint64_t a2)
{
  _BYTE *v4;
  uint64_t v5;
  const char *v6;
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, _BYTE *, _BYTE *, uint64_t);
  uint64_t v9;
  _BYTE *v11;
  _BYTE *v12;
  uint64_t v13;
  _BYTE *v14;
  _BYTE *v15;

  v14 = 0;
  v15 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ConnectExtensionFelica_Cb");
  if (!a1)
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Lower layer has returned invalid LibNfc context");
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ConnectExtensionFelica_Cb");
  }
  if (!(_DWORD)a2)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"State machine has returned NFCSTATUS_SUCCESS");
    if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1464)))
    {
      v4 = 0;
      *(_QWORD *)(a1 + 1464) = 0;
      *(_QWORD *)(a1 + 1456) = 0;
    }
    else
    {
      v4 = *(_BYTE **)(a1 + 1464);
    }
    v14 = v4;
    v5 = sub_2198BE4E4(a1, &v15, &v14, 0);
    if ((_DWORD)v5)
    {
      a2 = v5;
      v6 = "Mapping of Nci RemoteDev Handle to LibNfc RemoteDev handle Failed";
    }
    else
    {
      a2 = sub_2198C0954(a1, (uint64_t)v15, &v13);
      if (!(_DWORD)a2)
      {
        v11 = v14;
        v12 = v15;
        *(_QWORD *)(a1 + 1456) = v14;
        *v12 = *v11;
        v7 = 145;
        goto LABEL_13;
      }
      v6 = "Getting LibNfc RemoteDev Info by using LibNfc Handle Failed";
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v6);
  }
  sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_ConnectExtensionFelica_Cb: Lower layer has returned failure status");
  *(_QWORD *)(a1 + 1456) = 0;
  v7 = 146;
LABEL_13:
  if (*(_BYTE *)(a1 + 1440) == 1
    && (v8 = *(void (**)(_QWORD, uint64_t, _BYTE *, _BYTE *, uint64_t))(a1 + 6152)) != 0)
  {
    v9 = *(_QWORD *)(a1 + 6160);
    *(_QWORD *)(a1 + 6152) = 0;
    *(_QWORD *)(a1 + 6160) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Invoking upper layer callback");
    sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 15, (uint64_t)"phLibNfc_ConnectExtensionFelica_Cb");
    v8(*(_QWORD *)(a1 + 19360), v9, v15, v15, a2);
  }
  else
  {
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v7, a2, (uint64_t)v15, (uint64_t)v15);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ConnectExtensionFelica_Cb");
}

uint64_t sub_2198B3E30(unsigned int *a1, uint64_t *a2, unsigned int a3, int a4, uint64_t a5)
{
  uint64_t v10;
  const char *v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  char v15;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_TlvUtilsAddTlv");
  if (a1)
  {
    if (a2)
      goto LABEL_3;
  }
  else if (a2)
  {
LABEL_3:
    if (!*a2)
    {
      v11 = "Invalid input parameters";
      v12 = 1;
      goto LABEL_9;
    }
    v10 = *((unsigned int *)a2 + 2);
    if (*((_DWORD *)a2 + 3) - (int)v10 < (a4 + 2))
    {
      v11 = "Not enough memory in TLV buffer";
      v12 = 3;
LABEL_9:
      sub_219850628(2, a1, 3u, 1u, (uint64_t)v11);
      goto LABEL_19;
    }
    *(_BYTE *)(*a2 + v10) = a3;
    v13 = *a2;
    v14 = *((unsigned int *)a2 + 2);
    if (((a3 >> 8) & 0xFE) == 0xA0)
    {
      *(_BYTE *)(v13 + v14) = BYTE1(a3);
      *(_BYTE *)(*a2 + (*((_DWORD *)a2 + 2) + 1)) = a3;
      v15 = a4 - 1;
      *(_BYTE *)(*a2 + (*((_DWORD *)a2 + 2) + 2)) = a4 - 1;
    }
    else
    {
      *(_BYTE *)(v13 + (v14 + 1)) = a4;
      v15 = a4;
    }
    if (v15)
    {
      if (!a5)
      {
        v12 = 1;
        sub_219850628(2, a1, 3u, 1u, (uint64_t)"pointer to Value field of tlv is invalid");
        goto LABEL_18;
      }
      phOsalNfc_MemCopy();
    }
    v12 = 0;
LABEL_18:
    *((_DWORD *)a2 + 2) += a4 + 2;
    goto LABEL_19;
  }
  v12 = 1;
LABEL_19:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_TlvUtilsAddTlv");
  return v12;
}

uint64_t sub_2198B3FD4(unsigned int *a1, uint64_t a2, unsigned int a3)
{
  uint64_t v6;
  const char *v7;
  unsigned int v8;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_TlvUtilsParseTLV");
  v6 = 1;
  v7 = "Invlaid input parameter";
  if (!a2 || a3 < 2)
    goto LABEL_8;
  v8 = 0;
  do
    v8 = (unsigned __int16)(v8 + *(unsigned __int8 *)(a2 + v8 + 1) + 2);
  while (v8 < a3);
  if (v8 != a3)
  {
    v6 = 255;
    v7 = "Inconsistent tlv's!";
LABEL_8:
    sub_219850628(2, a1, 3u, 1u, (uint64_t)v7);
    goto LABEL_9;
  }
  v6 = 0;
LABEL_9:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_TlvUtilsParseTLV");
  return v6;
}

uint64_t sub_2198B40A4(unsigned int *a1, uint64_t *a2, _BYTE *a3, _BYTE *a4, _QWORD *a5)
{
  uint64_t v10;
  unsigned int v11;
  uint64_t v12;
  const char *v13;
  uint64_t v14;
  uint64_t v16;
  uint64_t v17;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_TlvUtilsGetNxtTlv");
  if (a2 && a3 && a4)
  {
    v10 = *a2;
    if (*a2 && (v11 = *((_DWORD *)a2 + 3), v11 >= 2))
    {
      v12 = *((unsigned int *)a2 + 2);
      if ((int)v12 + 2 <= v11)
      {
        v14 = 0;
        *((_DWORD *)a2 + 2) = v12 + 1;
        *a3 = *(_BYTE *)(v10 + v12);
        v16 = *a2;
        v17 = *((unsigned int *)a2 + 2);
        *((_DWORD *)a2 + 2) = v17 + 1;
        *a4 = *(_BYTE *)(v16 + v17);
        *a5 = *a2 + *((unsigned int *)a2 + 2);
        *((_DWORD *)a2 + 2) += *a4;
        goto LABEL_11;
      }
      v13 = "Invalid Tlv buffer offset";
    }
    else
    {
      v13 = "Invalid tlv buffer or its length";
    }
    sub_219850628(2, a1, 3u, 1u, (uint64_t)v13);
    v14 = 255;
  }
  else
  {
    v14 = 1;
    sub_219850628(2, a1, 3u, 1u, (uint64_t)"Invalid input parameter");
  }
LABEL_11:
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_TlvUtilsGetNxtTlv");
  return v14;
}

void *phLibNfc_Mgt_GetMwVersionStr()
{
  phOsalNfc_MemCopy();
  strcpy(byte_253E47051, " 5.1_R3.A");
  return &unk_253E47047;
}

uint64_t phLibNfc_Mgt_ConfigureDriver(uint64_t a1, uint64_t *a2)
{
  const char *v4;
  uint64_t v5;
  unsigned int v7;
  unsigned int *v8;
  const char *v9;
  uint64_t v10;
  char v11;
  uint64_t v12;
  int v13;
  uint64_t v14;
  uint64_t v15;
  int v16;
  uint64_t v17;
  _OWORD v18[3];
  __int128 v19;
  __int128 v20;
  __int128 v21;
  __int128 v22;
  __int128 v23;
  __int128 v24;
  uint64_t v25;
  uint64_t v26;

  v25 = 0;
  v26 = 0;
  v23 = 0u;
  v24 = 0u;
  v21 = 0u;
  v22 = 0u;
  v19 = 0u;
  v20 = 0u;
  memset(v18, 0, sizeof(v18));
  sub_219850718(0, (unsigned int *)&v25, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureDriver");
  if (!a1 || !a2 || *(_DWORD *)(a1 + 8) == 8)
  {
    v4 = "ConfigureDriver:Invalid Parameter";
LABEL_5:
    v5 = 1;
    sub_219850628(0, (unsigned int *)&v25, 4u, 1u, (uint64_t)v4);
LABEL_6:
    sub_2198D2284(v25, 1);
    sub_219886108(v25, v5);
    goto LABEL_7;
  }
  v8 = (unsigned int *)(a1 + 24);
  v7 = *(_DWORD *)(a1 + 24);
  if (v7 >= 2)
  {
    v4 = "ConfigureDriver:Invalid Controller type";
    goto LABEL_5;
  }
  sub_219885CEC(v7);
  sub_219885F70(1, (unsigned int *)(a1 + 24), 4u, 0, (uint64_t)"phLibNfc_Mgt_ConfigureDriver");
  phOsalNfc_SetMemory();
  switch(*(_DWORD *)(a1 + 8))
  {
    case 0:
      v9 = "/dev/tty.p2m";
      *(_QWORD *)&v18[1] = "/dev/tty.p2m";
      break;
    case 1:
      v9 = *(const char **)(a1 + 16);
      v10 = *(_QWORD *)(a1 + 32);
      *(_QWORD *)&v18[1] = v9;
      *((_QWORD *)&v18[1] + 1) = v10;
      v11 = 1;
      goto LABEL_20;
    case 2:
      v9 = *(const char **)(a1 + 16);
      *(_QWORD *)&v18[1] = v9;
      v11 = 2;
      goto LABEL_20;
    case 3:
      v9 = *(const char **)(a1 + 16);
      *(_QWORD *)&v18[1] = v9;
      v11 = 3;
      goto LABEL_20;
    case 4:
      v9 = 0;
      *(_QWORD *)&v18[1] = 0;
      *((_QWORD *)&v18[1] + 1) = "/dev/tty.p2m";
      v11 = 4;
      goto LABEL_20;
    case 5:
      v9 = "/dev/tty.p2m";
      *(_QWORD *)&v18[1] = "/dev/tty.p2m";
      *((_QWORD *)&v18[1] + 1) = "/dev/tty.p2m";
      v11 = 5;
      goto LABEL_20;
    case 6:
      v9 = *(const char **)(a1 + 16);
      *(_QWORD *)&v18[1] = v9;
      *(_OWORD *)((char *)&v18[1] + 8) = *(_OWORD *)(a1 + 32);
      v11 = 6;
      goto LABEL_20;
    case 7:
      v9 = *(const char **)(a1 + 16);
      v12 = *(_QWORD *)(a1 + 32);
      *(_QWORD *)&v18[1] = v9;
      *((_QWORD *)&v18[1] + 1) = v12;
      v11 = 7;
LABEL_20:
      BYTE8(v19) = v11;
      break;
    default:
      v9 = *(const char **)&v18[1];
      break;
  }
  v13 = BYTE8(v19);
  DWORD2(v18[2]) = *v8;
  byte_253E45D58 = 1;
  if (BYTE8(v19) == 1 && v9)
  {
    if (!strcmp(v9, "I2C") || !strcmp(v9, "ZYNQ_SPMI") || !strcmp(v9, "ZYNQ_SPMI_GOANNA") || !strcmp(v9, "SPMI"))
      v13 = 6;
    else
      v13 = 1;
  }
  v14 = *(_QWORD *)(a1 + 48);
  v15 = *(_QWORD *)(a1 + 56);
  *(_QWORD *)&v18[0] = *(_QWORD *)a1;
  *((_QWORD *)&v18[0] + 1) = v14;
  *(_QWORD *)&v19 = v15;
  phOsalNfc_SetMemory();
  *(_QWORD *)((char *)&v23 + 4) = 0;
  LOBYTE(v23) = 1;
  v16 = *(_DWORD *)(a1 + 68);
  LODWORD(v21) = 2;
  DWORD2(v20) = v16;
  sub_2198D0BAC(0, *(_DWORD *)(a1 + 24));
  v17 = sub_2198D1B2C(0, 1, *(unsigned __int16 *)(a1 + 24), (uint64_t)a2, (uint64_t)v18);
  if ((_DWORD)v17)
  {
    v5 = v17;
    sub_219850628(1, (unsigned int *)(a1 + 24), 4u, 1u, (uint64_t)"State Transition failed");
    sub_219885D88(*v8);
    sub_219885F70(0, (unsigned int *)&v25, 4u, 0, (uint64_t)"phLibNfc_Mgt_ConfigureDriver");
    goto LABEL_6;
  }
  sub_219885FF8(1, (unsigned int *)(a1 + 24), 4u, 4u, (uint64_t)"ConfigDriver: Driver Handle Returned");
  v25 = *a2;
  sub_219885FF8(1, (unsigned int *)(a1 + 24), 4u, 4u, (uint64_t)"hDriverHandle");
  sub_21988EAD8(*a2, *v8, v13);
  sub_21987C7D4(*v8);
  sub_21988EB80(*a2, &v26);
  if (v26)
    *(_DWORD *)(v26 + 192) = *(_DWORD *)(a1 + 68);
  else
    sub_219850628(0, (unsigned int *)&v25, 4u, 1u, (uint64_t)"Invalid input parameter");
  sub_219885F70(0, (unsigned int *)&v25, 4u, 0, (uint64_t)"phLibNfc_Mgt_ConfigureDriver");
  v5 = 0;
LABEL_7:
  sub_219850808(0, (unsigned int *)&v25, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureDriver");
  return v5;
}

uint64_t phLibNfc_Mgt_UnConfigureDriver(uint64_t a1)
{
  uint64_t v1;
  BOOL v2;
  int v3;
  uint64_t v5;
  char v6;
  char v7;
  unsigned int v8;
  unsigned int v9;
  uint64_t v10;

  v10 = a1;
  v9 = 0;
  sub_219885F70(0, (unsigned int *)&v10, 4u, 1, (uint64_t)"phLibNfc_Mgt_UnConfigureDriver");
  sub_219850718(0, (unsigned int *)&v10, 4u, 5u, (uint64_t)"phLibNfc_Mgt_UnConfigureDriver");
  sub_219885FF8(0, (unsigned int *)&v10, 4u, 4u, (uint64_t)"##### Unconfiguredriver handle");
  v1 = sub_21988F3C4(v10);
  if (v10)
    v2 = (_DWORD)v1 == 0;
  else
    v2 = 0;
  if (!v2)
  {
    sub_219850628(0, (unsigned int *)&v10, 4u, 1u, (uint64_t)"Invalid input parameter");
    if (!(_DWORD)v1)
      goto LABEL_11;
    goto LABEL_10;
  }
  v3 = sub_2198D1B2C(v10, 2, 0, (uint64_t)&v10, 0);
  if (v3 == 147)
  {
    v1 = 138;
LABEL_10:
    sub_2198D2284(v10, 2);
    sub_219886108(v10, v1);
    goto LABEL_11;
  }
  v1 = v3;
  if ((_BYTE)v3)
    goto LABEL_10;
  v5 = 0;
  v9 = 255;
  v6 = 1;
  while (1)
  {
    v7 = v6;
    if (*((_QWORD *)&unk_253E46700 + 14 * v5) == v10)
      break;
    v6 = 0;
    v5 = 1;
    if ((v7 & 1) == 0)
    {
      v8 = 255;
      goto LABEL_17;
    }
  }
  v8 = *((_DWORD *)&unk_253E46700 + 28 * v5 + 2);
  v9 = v8;
LABEL_17:
  sub_219885D88(v8);
  sub_21987C8E0(v10);
  sub_21988EAD8(0, v8, 8);
  v1 = 0;
LABEL_11:
  sub_219850808(1, &v9, 4u, 5u, (uint64_t)"phLibNfc_Mgt_UnConfigureDriver");
  return v1;
}

uint64_t phLibNfc_Mgt_ConfigureMwLogging(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  char v5;
  unsigned int v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;

  v11 = a1;
  v3 = 1;
  sub_219885F70(0, (unsigned int *)&v11, 4u, 2, (uint64_t)"phLibNfc_Mgt_ConfigureMwLogging");
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureMwLogging");
  v4 = 0;
  while (*((_QWORD *)&unk_253E46700 + 14 * v4) != v11)
  {
    v5 = v3;
    v3 = 0;
    v4 = 1;
    if ((v5 & 1) == 0)
      goto LABEL_11;
  }
  v6 = *((_DWORD *)&unk_253E46700 + 28 * v4 + 2);
  if (v6 > 1)
  {
LABEL_11:
    v8 = 0;
    if (!a2)
    {
LABEL_10:
      v9 = 1;
      sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"Invalid input parameter");
      goto LABEL_13;
    }
  }
  else
  {
    v7 = *((_QWORD *)&unk_253E46700 + 14 * v6 + 10);
    if (v7)
      v8 = v7 + 120;
    else
      v8 = 0;
    if (!a2)
      goto LABEL_10;
  }
  v9 = sub_2198D1B2C(v11, 3, 0, a2, 0);
LABEL_13:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureMwLogging");
  sub_219885F70(0, (unsigned int *)&v11, 4u, 2, (uint64_t)"phLibNfc_Mgt_ConfigureMwLogging");
  if ((_DWORD)v9 && v8)
  {
    *(_DWORD *)(v8 + 36) = 2;
    sub_219886108(v11, v9);
  }
  return v9;
}

uint64_t phLibNfc_Mgt_Initialize(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  char v7;
  uint64_t v8;
  char v9;
  int v10;
  unsigned int v11;
  uint64_t v12;
  const char *v14;
  _BOOL4 v15;
  const char *v16;
  int v17;
  const char *v18;
  const char *v19;
  uint64_t v20;
  uint64_t v21;
  uint64_t v22;
  uint64_t v23;
  int v24;
  uint64_t v25;
  int v26;
  uint64_t v27;
  int v28;
  uint64_t Memory;
  uint64_t v30;

  Memory = 0;
  v30 = a1;
  v28 = 8;
  v27 = 0;
  v7 = 1;
  sub_219885F70(0, (unsigned int *)&v30, 4u, 3, (uint64_t)"phLibNfc_Mgt_Initialize");
  sub_219850718(0, (unsigned int *)&v30, 4u, 5u, (uint64_t)"phLibNfc_Mgt_Initialize");
  v8 = 0;
  while (*((_QWORD *)&unk_253E46700 + 14 * v8) != v30)
  {
    v9 = v7;
    v7 = 0;
    v8 = 1;
    if ((v9 & 1) == 0)
    {
      v10 = 255;
      goto LABEL_6;
    }
  }
  v10 = *((_DWORD *)&unk_253E46700 + 28 * v8 + 2);
LABEL_6:
  sub_21988ED38(v30, &v28);
  sub_21988EDF4(v30, &Memory);
  sub_21988EB80(v30, &v27);
  if (!a2 || !a3 || !v30 || *(_DWORD *)a2 > 0xFu || *(_DWORD *)(a2 + 24) > 1u || (v11 = *(_DWORD *)(a2 + 28), v11 >= 3))
  {
    v12 = 1;
    sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"Invalid input parameter");
    sub_219885F70(0, (unsigned int *)&v30, 4u, 3, (uint64_t)"phLibNfc_Mgt_Initialize");
    goto LABEL_19;
  }
  if (v10 == 1)
  {
    if (v11 != 1)
      goto LABEL_14;
LABEL_22:
    sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"Feature not supported");
    sub_219885F70(0, (unsigned int *)&v30, 4u, 3, (uint64_t)"phLibNfc_Mgt_Initialize");
    v12 = 51;
    goto LABEL_19;
  }
  if (v11 == 2)
    goto LABEL_22;
LABEL_14:
  if (!v27)
  {
    sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"Invalid IOCTL context");
LABEL_40:
    v12 = 255;
    goto LABEL_19;
  }
  if (!Memory)
  {
    sub_219851790(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"**** LibNfc Major version **** ");
    sub_219851790(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"**** LibNfc Minor version **** ");
    sub_219851790(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"**** MW major version **** ");
    sub_219851790(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"**** MW Minor version **** ");
    if ((v28 & 0xFFFFFFFD) != 4 && phTmlNfc_ConfigHsuBaudRate())
    {
      v14 = "Init- Set Default Baud Rate FAILED,ConfigHsuBaudRate Status";
LABEL_39:
      sub_219851790(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)v14);
      sub_219885F70(0, (unsigned int *)&v30, 4u, 3, (uint64_t)"phLibNfc_Mgt_Initialize");
      goto LABEL_40;
    }
    sub_21988F690(v30, 0);
    sub_219851790(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"Init : Success Config Hsu Baud Rate = ");
    if (v10 == 1 && *(_DWORD *)(a2 + 28))
    {
      v15 = 0;
    }
    else
    {
      if (*(_DWORD *)(v27 + 192) == 1)
      {
        v17 = phTmlNfc_IoCtl();
        v15 = 0;
      }
      else
      {
        v17 = phTmlNfc_IoCtl();
        v15 = v17 == 0;
      }
      if (v17)
      {
        v14 = "NFCC Power On Failed!!,phTmlNfc_IoCtl Ret Status =";
        goto LABEL_39;
      }
    }
    if (*(_DWORD *)(a2 + 32))
      phOsalNfc_Delay();
    Memory = phOsalNfc_GetMemory();
    if (Memory)
    {
      if (v10 == 1)
        v18 = "####Secondary NFCC, DriverHandle";
      else
        v18 = "####Primary NFCC, DriverHandle";
      if (v10 == 1)
        v19 = "####Secondary NFCC, LIBNFC context";
      else
        v19 = "####Primary NFCC, LIBNFC context";
      sub_219885FF8(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)v18);
      sub_219885FF8(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)v19);
      sub_21988EEB4(v30, Memory);
      phOsalNfc_SetMemory();
      v20 = Memory;
      v21 = Memory + 19356;
      v22 = Memory + 5400;
      *(_DWORD *)(Memory + 1000) |= 0x40000u;
      *(_BYTE *)(v20 + 1007) = 1;
      *(_BYTE *)(v20 + 1424) = 0;
      *(_DWORD *)(v20 + 988) = 0;
      *(_DWORD *)(v20 + 3148) = 3;
      *(_BYTE *)(v20 + 717) = 3;
      *(_WORD *)v20 = 514;
      v23 = v30;
      *(_QWORD *)(v20 + 2952) = v30;
      *(_DWORD *)(v20 + 3056) = 2;
      *(_DWORD *)(v20 + 3064) = *(_DWORD *)(a2 + 4);
      *(_DWORD *)(v20 + 440) = *(_DWORD *)a2 & 0xB;
      *(_QWORD *)(v20 + 536) = 0xFFFFFFFFFFFFLL;
      *(_WORD *)(v20 + 708) = 0;
      *(_QWORD *)(v20 + 464) = 0;
      *(_WORD *)(v20 + 696) = 0;
      *(_BYTE *)(v20 + 2928) = 0;
      *(_DWORD *)(v20 + 5404) = *(_DWORD *)(a2 + 24);
      *(_DWORD *)(v20 + 3156) = *(_DWORD *)(a2 + 28);
      *(_DWORD *)(v20 + 3176) = *(_DWORD *)(v27 + 192);
      *(_BYTE *)(v20 + 2884) = 1;
      *(_WORD *)v22 = 0;
      *(_BYTE *)(v22 + 8) = 0;
      *(_BYTE *)(v20 + 3161) = 0;
      *(_BYTE *)(v20 + 3216) = 0;
      *(_BYTE *)(v22 + 625) = 0;
      *(_WORD *)v21 = 0;
      *(_QWORD *)(v20 + 19360) = v23;
      *(_DWORD *)(v21 + 12) = v10;
      *(_BYTE *)(v21 + 17) = *(_BYTE *)(a2 + 36);
      v24 = sub_2198D1B2C(v23, 5, 0, (uint64_t)&v30, 0);
      if (v24 == 13)
      {
        v25 = Memory;
        *(_QWORD *)(Memory + 6056) = a3;
        *(_QWORD *)(v25 + 6064) = a4;
        *(_OWORD *)(v25 + 6568) = *(_OWORD *)(a2 + 8);
        sub_2198BBD94(v25);
        *(_QWORD *)(Memory + 19360) = v30;
        v12 = 13;
        goto LABEL_20;
      }
      v26 = v24;
      phTmlNfc_ReadAbort();
      sub_219851790(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"Mgt initialize not returned NFCSTATUS_PENDING, Status Rxd=");
      if (Memory)
      {
        phOsalNfc_FreeMemory();
        sub_21988EEB4(v30, 0);
      }
      Memory = 0;
      if (v26 == 179)
        v12 = 180;
      else
        v12 = 255;
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)"Failed to allocate memory, Insufficient Resources");
      v12 = 12;
    }
    sub_219885F70(0, (unsigned int *)&v30, 4u, 3, (uint64_t)"phLibNfc_Mgt_Initialize");
    if (v15)
      phTmlNfc_IoCtl();
    goto LABEL_19;
  }
  if (*(_QWORD *)(Memory + 6056))
  {
    sub_219850628(0, (unsigned int *)&v30, 4u, 2u, (uint64_t)"Libnfc Stack busy - Init callback pending");
    sub_219885F70(0, (unsigned int *)&v30, 4u, 3, (uint64_t)"phLibNfc_Mgt_Initialize");
    v12 = 111;
  }
  else
  {
    if (*(_BYTE *)(Memory + 6026) == 1 || *(_BYTE *)(Memory + 6027) == 1)
    {
      v16 = "ESE in DNLD mode has to be disabled before MW Init";
    }
    else
    {
      if (*(_BYTE *)(Memory + 6029) != 1 && *(_BYTE *)(Memory + 6030) != 1)
      {
        sub_219850628(0, (unsigned int *)&v30, 4u, 4u, (uint64_t)"Stack already initialized");
        sub_219885F70(0, (unsigned int *)&v30, 4u, 3, (uint64_t)"phLibNfc_Mgt_Initialize");
        v12 = 50;
        goto LABEL_19;
      }
      v16 = "SMB logging in DNLD mode has to be disabled before MW Init";
    }
    sub_219850628(0, (unsigned int *)&v30, 4u, 1u, (uint64_t)v16);
    sub_219885F70(0, (unsigned int *)&v30, 4u, 3, (uint64_t)"phLibNfc_Mgt_Initialize");
    v12 = 147;
  }
LABEL_19:
  sub_2198D2284(v30, 5);
  sub_219886108(v30, v12);
LABEL_20:
  sub_219850808(0, (unsigned int *)&v30, 4u, 5u, (uint64_t)"phLibNfc_Mgt_Initialize");
  return v12;
}

uint64_t phLibNfc_Mgt_DeInitialize(uint64_t a1, uint64_t a2, int a3, uint64_t a4)
{
  uint64_t v7;
  uint64_t v8;
  char v9;
  uint64_t v10;
  uint64_t v11;
  _QWORD *v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;
  unsigned int *v19;
  char v20;
  uint64_t v21;
  uint64_t v22;
  int v23;
  uint64_t v24;
  int v25;
  uint64_t v26;

  v26 = a1;
  v25 = a3;
  v24 = 0;
  v23 = 8;
  sub_219885F70(0, (unsigned int *)&v26, 4u, 116, (uint64_t)"phLibNfc_Mgt_DeInitialize");
  sub_219850718(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_Mgt_DeInitialize");
  sub_21988ED38(v26, &v23);
  v7 = sub_21987AB04(v26, &v24);
  if (!v26)
  {
    v7 = 1;
    sub_219850628(0, (unsigned int *)&v26, 4u, 1u, (uint64_t)"Invalid input parameter");
    goto LABEL_47;
  }
  if (!(_DWORD)v7)
  {
    v8 = v24;
    if (v24)
    {
      if (*(_BYTE *)(v24 + 6026) == 1
        || *(_BYTE *)(v24 + 6029) == 1
        || *(_BYTE *)(v24 + 6030) == 1
        || *(_BYTE *)(v24 + 6027) == 1)
      {
        v7 = 49;
LABEL_47:
        sub_219885F70(0, (unsigned int *)&v26, 4u, 116, (uint64_t)"phLibNfc_Mgt_DeInitialize");
        sub_2198D2284(v26, 139);
        sub_219886108(v26, v7);
        goto LABEL_48;
      }
      if (a3 && (v23 & 0xFFFFFFFD) == 4)
      {
        v7 = 0;
      }
      else
      {
        v16 = sub_2198D1B2C(v26, 139, 0, (uint64_t)&v26, 0);
        if ((_DWORD)v16 == 13)
        {
          v8 = v24;
          if (*(_BYTE *)(v24 + 19374) == 1)
          {
            v7 = 13;
            v9 = 1;
LABEL_42:
            if (!a2 && (v9 & 1) != 0)
            {
              v7 = 0;
              goto LABEL_47;
            }
            if ((v9 & 1) != 0)
              goto LABEL_46;
            v8 = v24;
LABEL_50:
            if (*(_DWORD *)(v8 + 3176) == 1)
              v7 = 288;
            else
              v7 = 0;
            *(_QWORD *)(v8 + 6136) = a2;
            *(_QWORD *)(v8 + 6144) = a4;
            if (sub_2198D1B2C(v26, 140, v7, 0, (uint64_t)&v25))
            {
              sub_219850628(0, (unsigned int *)&v26, 4u, 2u, (uint64_t)"State Machine has rejected the event!!!");
              sub_2198D289C(v26, 1);
              sub_2198D27D4(v26, 0);
              v19 = (unsigned int *)v24;
              if (v24)
              {
                v20 = 0;
                v21 = 0;
                do
                {
                  v22 = *((_QWORD *)&unk_253E46700 + 14 * v21 + 2);
                  if ((v20 & 1) != 0)
                    break;
                  v20 = 1;
                  v21 = 1;
                }
                while (v22 != v24);
                if (v22 == v24)
                {
                  sub_219897050(v24);
                  sub_21988F804(v26, 0);
                  sub_2198FF49C(*(unsigned int **)(v24 + 3040), 2, 0, 0);
                  v19 = (unsigned int *)v24;
                  *(_QWORD *)(v24 + 3040) = 0;
                }
              }
            }
            else
            {
              v19 = (unsigned int *)v24;
            }
            sub_21989A5DC(v19);
            v24 = 0;
            sub_21988EEB4(v26, 0);
            goto LABEL_47;
          }
          *(_QWORD *)(v24 + 6136) = a2;
          *(_QWORD *)(v8 + 6144) = a4;
          *(_DWORD *)(v8 + 440) = 16;
          v7 = 13;
          v9 = 1;
LABEL_15:
          v10 = *(_QWORD *)(v8 + 1448);
          if (v10 && v10 != 0xFFFFFFFFFFFFLL)
          {
            phOsalNfc_Timer_Delete();
            v8 = v24;
            *(_QWORD *)(v24 + 1448) = 0xFFFFFFFFFFFFLL;
          }
          v11 = *(_QWORD *)(v8 + 720);
          if (v11 && v11 != 0xFFFFFFFFFFFFLL)
          {
            phOsalNfc_Timer_Delete();
            v8 = v24;
            *(_QWORD *)(v24 + 720) = 0xFFFFFFFFFFFFLL;
          }
          v12 = *(_QWORD **)(v8 + 464);
          if (v12)
          {
            v13 = v12[105];
            if (v13 && v13 != 0xFFFFFFFFFFFFLL)
            {
              phOsalNfc_Timer_Stop();
              phOsalNfc_Timer_Delete();
              v12[105] = 0xFFFFFFFFFFFFLL;
            }
            v14 = v12[107];
            if (v14 && v14 != 0xFFFFFFFFFFFFLL)
            {
              phOsalNfc_Timer_Stop();
              phOsalNfc_Timer_Delete();
              v12[107] = 0xFFFFFFFFFFFFLL;
            }
            v15 = v12[109];
            if (v15 && v15 != 0xFFFFFFFFFFFFLL)
            {
              phOsalNfc_Timer_Stop();
              phOsalNfc_Timer_Delete();
              sub_219850628(0, (unsigned int *)&v26, 4u, 4u, (uint64_t)"phLibNfc_Mgt_DeInitialize : HCI Command Response timer deleted successfully");
              v12[109] = 0;
            }
          }
          goto LABEL_42;
        }
        v7 = v16;
        if ((_DWORD)v16 == 49)
          goto LABEL_47;
        if ((_DWORD)v16 == 111)
        {
          v17 = v24;
          if (!*(_BYTE *)(v24 + 3160) || *(_BYTE *)(v24 + 19374) == 1)
          {
            v7 = 111;
            goto LABEL_47;
          }
          v9 = 1;
          *(_BYTE *)(v24 + 19374) = 1;
          *(_QWORD *)(v17 + 19376) = a2;
          *(_QWORD *)(v17 + 19384) = a4;
          v7 = 13;
          goto LABEL_42;
        }
        v8 = v24;
      }
      if (*(_BYTE *)(v8 + 19374) == 1)
        goto LABEL_50;
      v9 = 0;
      goto LABEL_15;
    }
  }
LABEL_46:
  if ((_DWORD)v7 != 13)
    goto LABEL_47;
LABEL_48:
  sub_219850808(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_Mgt_DeInitialize");
  return v7;
}

uint64_t phLibNfc_Mgt_VenResetStatus(uint64_t a1, unsigned int a2)
{
  char v3;
  uint64_t v4;
  char v5;
  unsigned int v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  BOOL v11;
  uint64_t v12;
  uint64_t v13;
  unint64_t v15;
  unsigned int *v16;
  uint64_t (*v17)(uint64_t, uint64_t);
  uint64_t v18;
  uint64_t v20;
  uint64_t v21;
  uint64_t v22;

  v21 = 0;
  v22 = a1;
  v20 = 0;
  v3 = 1;
  sub_219885F70(0, (unsigned int *)&v22, 4u, 129, (uint64_t)"phLibNfc_Mgt_VenResetStatus");
  sub_219850718(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_Mgt_VenResetStatus");
  v4 = 0;
  while (*((_QWORD *)&unk_253E46700 + 14 * v4) != v22)
  {
    v5 = v3;
    v3 = 0;
    v4 = 1;
    if ((v5 & 1) == 0)
      goto LABEL_9;
  }
  v6 = *((_DWORD *)&unk_253E46700 + 28 * v4 + 2);
  if (v6 > 1)
  {
LABEL_9:
    v8 = 0;
    goto LABEL_10;
  }
  v7 = *((_QWORD *)&unk_253E46700 + 14 * v6 + 10);
  if (v7)
    v8 = v7 + 120;
  else
    v8 = 0;
LABEL_10:
  sub_21988F460(v22, &v20);
  v9 = 49;
  if (!sub_21987AB04(v22, &v21) && v21)
  {
    v10 = *(_QWORD *)(v21 + 3184);
    if (v10)
      v11 = v10 == 0xFFFFFFFFFFFFLL;
    else
      v11 = 1;
    if (!v11)
    {
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_QWORD *)(v21 + 3184) = 0xFFFFFFFFFFFFLL;
    }
    if (v20)
    {
      v12 = *(_QWORD *)(v20 + 56);
      if (v12)
      {
        v13 = *(_QWORD *)(v12 + 72);
        if (v13 && v13 != 0xFFFFFFFFFFFFLL)
          phOsalNfc_Timer_Stop();
      }
    }
    v15 = 0x133013201310000uLL >> (16 * a2);
    if (a2 >= 4)
      LOWORD(v15) = 1;
    v16 = (unsigned int *)v21;
    v17 = *(uint64_t (**)(uint64_t, uint64_t))(v21 + 3168);
    if (v17 == sub_219899270)
    {
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = sub_219899360(v16, (unsigned __int16)v15);
    }
    else if (v17 == sub_21989949C)
    {
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = sub_21989958C(v16, (unsigned __int16)v15);
    }
    else if (v17 == sub_219876DD0)
    {
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = sub_2198775AC(v16, (unsigned __int16)v15);
    }
    else if (v17 == sub_219876EA8)
    {
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = sub_21987771C(v16, (unsigned __int16)v15);
    }
    else if (v17 == sub_219876F80)
    {
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = sub_21987788C(v16, (unsigned __int16)v15);
    }
    else if (v17 == sub_219877058)
    {
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = sub_2198779FC(v16, (unsigned __int16)v15);
    }
    else if (v17 == sub_219877130)
    {
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = sub_219877B70(v16, (unsigned __int16)v15);
    }
    else if (v17 == phDnldNfc_eSEPwrCfgVenResetTimeoutCb)
    {
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = phDnldNfc_eSEPwrCfgAfterVenReset((uint64_t)v16, (unsigned __int16)v15);
    }
    else
    {
      if (v17 != phDnldNfc_eSESmbCfgVenResetTimeoutCb)
      {
        v9 = 255;
        goto LABEL_46;
      }
      *(_QWORD *)(v21 + 3168) = 0;
      v18 = phDnldNfc_eSESmbCfgAfterVenReset((uint64_t)v16, (unsigned __int16)v15);
    }
    v9 = v18;
  }
LABEL_46:
  sub_219885F70(0, (unsigned int *)&v22, 4u, 129, (uint64_t)"phLibNfc_Mgt_VenResetStatus");
  sub_219850808(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_Mgt_VenResetStatus");
  if ((_DWORD)v9 && v8)
  {
    *(_DWORD *)(v8 + 36) = 129;
    sub_219886108(v22, v9);
  }
  return v9;
}

uint64_t phLibNfc_Mgt_ConfigureHsuParams(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219885F70(0, (unsigned int *)&v12, 4u, 4, (uint64_t)"phLibNfc_Mgt_ConfigureHsuParams");
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureHsuParams");
  v7 = sub_21987AB04(v12, &v11);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v11 == 0;
  if (!v8)
  {
    if (!a2 || !a3)
    {
      sub_219850628(0, (unsigned int *)&v12, 4u, 2u, (uint64_t)"phLibNfc_Mgt_ConfigureHsuParams: Invalid param");
      sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureHsuParams");
      sub_219885F70(0, (unsigned int *)&v12, 4u, 4, (uint64_t)"phLibNfc_Mgt_ConfigureHsuParams");
      v7 = 1;
LABEL_13:
      sub_2198D2284(v12, 6);
      sub_219886108(v12, v7);
      return v7;
    }
    v7 = sub_2198D1B2C(v12, 6, 0, a2, 0);
    if ((_DWORD)v7 == 13)
    {
      v9 = v11;
      *(_QWORD *)(v11 + 6552) = a3;
      *(_QWORD *)(v9 + 6560) = a4;
      sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureHsuParams");
      return v7;
    }
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureHsuParams");
  if ((_DWORD)v7 != 13)
  {
    sub_219885F70(0, (unsigned int *)&v12, 4u, 4, (uint64_t)"phLibNfc_Mgt_ConfigureHsuParams");
    if ((_DWORD)v7)
      goto LABEL_13;
  }
  return v7;
}

uint64_t phLibNfc_Mgt_ConfigurePowerMode(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  BOOL v7;
  _QWORD *v9;
  _QWORD *v10;
  int v11;
  uint64_t v12;

  v12 = a1;
  v11 = a2;
  v10 = 0;
  sub_219885F70(0, (unsigned int *)&v12, 4u, 5, (uint64_t)"phLibNfc_Mgt_ConfigurePowerMode");
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigurePowerMode");
  v6 = sub_21987AB04(v12, &v10);
  if ((_DWORD)v6)
    v7 = 1;
  else
    v7 = v10 == 0;
  if (!v7)
  {
    if (!a3)
    {
      v6 = 1;
      sub_219850628(0, (unsigned int *)&v12, 4u, 1u, (uint64_t)"ConfigureStandByMode: Invalid call back function passed");
      goto LABEL_16;
    }
    if (v10[817] || v10[787] || v10[789] || v10[835])
    {
      sub_219850628(0, (unsigned int *)&v12, 4u, 2u, (uint64_t)"ConfigureStandByMode: Wired mode/SetMode API in progress");
      v6 = 111;
LABEL_16:
      sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigurePowerMode");
      sub_219885F70(0, (unsigned int *)&v12, 4u, 5, (uint64_t)"phLibNfc_Mgt_ConfigurePowerMode");
LABEL_17:
      sub_2198D2284(v12, 7);
      sub_219886108(v12, v6);
      return v6;
    }
    v6 = sub_2198D1B2C(v12, 7, 0, (uint64_t)&v11, 0);
    if ((_DWORD)v6 == 13)
    {
      v9 = v10;
      v10[829] = a3;
      v9[830] = a4;
      sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigurePowerMode");
      return v6;
    }
  }
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigurePowerMode");
  if ((_DWORD)v6 != 13)
  {
    sub_219885F70(0, (unsigned int *)&v12, 4u, 5, (uint64_t)"phLibNfc_Mgt_ConfigurePowerMode");
    if ((_DWORD)v6)
      goto LABEL_17;
  }
  return v6;
}

uint64_t phLibNfc_Mgt_GeneralNtfRegister(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  BOOL v6;
  uint64_t v7;
  const char *v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219885F70(0, (unsigned int *)&v12, 4u, 45, (uint64_t)"phLibNfc_Mgt_GeneralNtfRegister");
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GeneralNtfRegister");
  v5 = sub_21987AB04(v12, &v11);
  if ((_DWORD)v5)
    v6 = 1;
  else
    v6 = v11 == 0;
  if (v6)
  {
    v7 = v5;
    v8 = "GeneralNtfRegister: LIBNFC Not Initialized";
LABEL_11:
    sub_219850628(0, (unsigned int *)&v12, 4u, 1u, (uint64_t)v8);
    goto LABEL_12;
  }
  if (!a2)
  {
    v8 = "GeneralNtfRegister: Invalid input parameters";
    v7 = 1;
    goto LABEL_11;
  }
  v7 = sub_2198D1B2C(v12, 69, 0, 0, 0);
  if (!(_DWORD)v7)
  {
    v9 = v11;
    *(_QWORD *)(v11 + 6568) = a2;
    *(_QWORD *)(v9 + 6576) = a3;
  }
LABEL_12:
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GeneralNtfRegister");
  sub_219885F70(0, (unsigned int *)&v12, 4u, 45, (uint64_t)"phLibNfc_Mgt_GeneralNtfRegister");
  if ((_DWORD)v7)
  {
    sub_2198D2284(v12, 69);
    sub_219886108(v12, v7);
  }
  return v7;
}

uint64_t phLibNfc_Mgt_ConfigRoutingTable(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  BOOL v10;
  uint64_t v12;
  uint64_t v13;
  char v14;
  uint64_t v15;

  v15 = a1;
  v14 = a2;
  v13 = 0;
  sub_219885F70(0, (unsigned int *)&v15, 4u, 40, (uint64_t)"phLibNfc_Mgt_ConfigRoutingTable");
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigRoutingTable");
  v9 = sub_21987AB04(v15, &v13);
  if ((_DWORD)v9)
    v10 = 1;
  else
    v10 = v13 == 0;
  if (v10)
    goto LABEL_6;
  if (!a2 || !a3 || !a4)
  {
    v9 = 1;
    sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"Invalid input parameters received");
    goto LABEL_14;
  }
  if (*(_BYTE *)(v13 + 2946) != 1)
  {
    v9 = sub_2198D1B2C(v15, 41, 0, (uint64_t)&v14, a3);
    if ((_DWORD)v9 == 147)
    {
      sub_219850628(0, (unsigned int *)&v15, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
      v9 = 255;
      goto LABEL_14;
    }
    if ((_DWORD)v9 == 13)
    {
      v12 = v13;
      *(_QWORD *)(v13 + 6456) = a4;
      *(_QWORD *)(v12 + 6464) = a5;
      sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigRoutingTable");
      return v9;
    }
LABEL_6:
    sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigRoutingTable");
    if ((_DWORD)v9 == 13)
      return v9;
    goto LABEL_15;
  }
  sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"phLibNfc_Mgt_ConfigRoutingTable: Feature not supported");
  v9 = 51;
LABEL_14:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigRoutingTable");
LABEL_15:
  sub_219885F70(0, (unsigned int *)&v15, 4u, 40, (uint64_t)"phLibNfc_Mgt_ConfigRoutingTable");
  sub_2198D2284(v15, 41);
  sub_219886108(v15, v9);
  return v9;
}

uint64_t phLibNfc_Mgt_GetstackCapabilities(uint64_t a1, uint64_t a2)
{
  uint64_t v3;
  BOOL v4;
  uint64_t v6;
  uint64_t v7;

  v6 = 0;
  v7 = a1;
  sub_219885F70(0, (unsigned int *)&v7, 4u, 34, (uint64_t)"phLibNfc_Mgt_GetstackCapabilities");
  sub_219850718(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetstackCapabilities");
  v3 = sub_21987AB04(v7, &v6);
  if ((_DWORD)v3)
    v4 = 1;
  else
    v4 = v6 == 0;
  if (!v4)
  {
    if (a2)
    {
      v3 = sub_2198D1B2C(v7, 35, 0, a2, 0);
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v7, 4u, 4u, (uint64_t)"Invalid parameters passed");
      v3 = 1;
    }
  }
  sub_219850808(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetstackCapabilities");
  sub_219885F70(0, (unsigned int *)&v7, 4u, 34, (uint64_t)"phLibNfc_Mgt_GetstackCapabilities");
  if ((_DWORD)v3)
  {
    sub_2198D2284(v7, 35);
    sub_219886108(v7, v3);
  }
  return v3;
}

uint64_t phLibNfc_Mgt_ValidateEepromSettings(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  BOOL v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219885F70(0, (unsigned int *)&v11, 4u, 51, (uint64_t)"phLibNfc_Mgt_ValidateEepromSettings");
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ValidateEepromSettings");
  v5 = sub_21987AB04(v11, &v10);
  if ((_DWORD)v5)
    v6 = 1;
  else
    v6 = v10 == 0;
  if (v6)
  {
    v7 = v5;
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"ValidateEepromSettings: LIBNFC Not Initialized");
    sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ValidateEepromSettings");
    if ((_DWORD)v7 == 13)
      return v7;
    goto LABEL_13;
  }
  if (!a2)
  {
    v7 = 1;
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)"ValidateEepromSettings: Invalid call back function passed");
    goto LABEL_12;
  }
  *(_BYTE *)(v10 + 696) = 0;
  v7 = sub_2198D1B2C(v11, 75, 0, 0, 0);
  if ((_DWORD)v7 != 13)
  {
LABEL_12:
    sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ValidateEepromSettings");
LABEL_13:
    sub_219885F70(0, (unsigned int *)&v11, 4u, 51, (uint64_t)"phLibNfc_Mgt_ValidateEepromSettings");
    sub_2198D2284(v11, 75);
    sub_219886108(v11, v7);
    return v7;
  }
  v8 = v10;
  *(_QWORD *)(v10 + 6664) = a2;
  *(_QWORD *)(v8 + 6672) = a3;
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ValidateEepromSettings");
  return v7;
}

uint64_t phLibNfc_Mgt_SetRfSettings(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  BOOL v10;
  const char *v11;
  uint64_t v13;
  uint64_t v14;
  int v15;
  uint64_t v16;

  v16 = a1;
  v15 = a2;
  v14 = 0;
  sub_219885F70(0, (unsigned int *)&v16, 4u, 42, (uint64_t)"phLibNfc_Mgt_SetRfSettings");
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetRfSettings");
  v9 = sub_21987AB04(v16, &v14);
  if ((_DWORD)v9)
    v10 = 1;
  else
    v10 = v14 == 0;
  if (v10)
  {
LABEL_6:
    sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetRfSettings");
    if ((_DWORD)v9 == 13)
      return v9;
    goto LABEL_16;
  }
  if (a3 && *(_QWORD *)a3)
  {
    v9 = 1;
    v11 = "phLibNfc_Mgt_SetRfSettings: Invalid input parameter";
    if (a4 && *(_DWORD *)(a3 + 8))
    {
      if (*(_BYTE *)(v14 + 2946) != 1
        && (*(_BYTE *)(v14 + 2936) == 1
         || *(_BYTE *)(v14 + 2937) == 1
         || *(_BYTE *)(v14 + 2938) == 1
         || a2 != 1
         || *(_BYTE *)(v14 + 2944) == 1))
      {
        *(_BYTE *)(v14 + 696) = 0;
        v9 = sub_2198D1B2C(v16, 66, 0, (uint64_t)&v15, a3);
        if ((_DWORD)v9 == 13)
        {
          v13 = v14;
          *(_QWORD *)(v14 + 6104) = a4;
          *(_QWORD *)(v13 + 6112) = a5;
          sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetRfSettings");
          return v9;
        }
        goto LABEL_6;
      }
      v9 = 51;
      v11 = "phLibNfc_Mgt_SetRfSettings: Feature Not Supported by NFCC";
    }
  }
  else
  {
    v9 = 1;
    v11 = "phLibNfc_Mgt_SetRfSettings: Invalid input parameter";
  }
  sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v11);
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetRfSettings");
LABEL_16:
  sub_219885F70(0, (unsigned int *)&v16, 4u, 42, (uint64_t)"phLibNfc_Mgt_SetRfSettings");
  sub_2198D2284(v16, 66);
  sub_219886108(v16, v9);
  return v9;
}

uint64_t phLibNfc_Mgt_eSeSvddControl(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  uint64_t v11;
  unsigned int v12;
  uint64_t v13;

  v13 = a1;
  v12 = a2;
  v11 = 0;
  sub_219885F70(0, (unsigned int *)&v13, 4u, 43, (uint64_t)"phLibNfc_Mgt_eSeSvddControl");
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_eSeSvddControl");
  v7 = sub_21987AB04(v13, &v11);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v11 == 0;
  if (v8)
    goto LABEL_6;
  if (a2 > 1 || !a3)
  {
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_eSeSvddControl");
    v7 = 1;
LABEL_13:
    sub_219885F70(0, (unsigned int *)&v13, 4u, 43, (uint64_t)"phLibNfc_Mgt_eSeSvddControl");
    sub_2198D2284(v13, 67);
    sub_219886108(v13, v7);
    return v7;
  }
  v7 = sub_2198D1B2C(v13, 67, 0, (uint64_t)&v12, 0);
  if ((_DWORD)v7 != 13)
  {
LABEL_6:
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_eSeSvddControl");
    if ((_DWORD)v7 == 13)
      return v7;
    goto LABEL_13;
  }
  v9 = v11;
  *(_QWORD *)(v11 + 6088) = a3;
  *(_QWORD *)(v9 + 6096) = a4;
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_eSeSvddControl");
  return v7;
}

uint64_t phLibNfc_Mgt_GetFwVersion(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  int v7;
  uint64_t v8;
  const char *v9;
  _QWORD *v10;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;
  _BYTE *v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  v13 = 0;
  v14 = 0;
  sub_219885F70(0, (unsigned int *)&v16, 4u, 12, (uint64_t)"phLibNfc_Mgt_GetFwVersion");
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetFwVersion");
  v7 = sub_21987AB04(v16, &v15);
  sub_21988EB80(v16, &v14);
  sub_21988F744(v16, &v13);
  if (!v7 && !v13)
  {
    v8 = 147;
    v9 = "This API will only be handled only in the Libnfc uninitialized state";
LABEL_10:
    sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v9);
LABEL_11:
    sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetFwVersion");
    sub_219885F70(0, (unsigned int *)&v16, 4u, 12, (uint64_t)"phLibNfc_Mgt_GetFwVersion");
    sub_2198D2284(v16, 208);
    sub_219886108(v16, v8);
    return v8;
  }
  v8 = 1;
  v9 = "phLibNfc_Mgt_GetFwVersion: Invalid input parameter";
  if (!a2 || !a3 || !v16 || !v14)
    goto LABEL_10;
  v8 = sub_2198D1B2C(v16, 208, 0, (uint64_t)&v16, 0);
  if ((_DWORD)v8 != 13)
  {
    if (v15 && !v15[6026] && !v15[6029] && !v15[6030] && !v15[6027])
    {
      *(_BYTE *)(v14 + 67) = 0;
      phOsalNfc_FreeMemory();
      v15 = 0;
      sub_21988EEB4(v16, 0);
    }
    goto LABEL_11;
  }
  v10 = (_QWORD *)v14;
  *(_QWORD *)(v14 + 32) = a3;
  *v10 = a4;
  v11 = v14;
  *(_QWORD *)(v14 + 56) = a2;
  *(_QWORD *)(v11 + 8) = v16;
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetFwVersion");
  return v8;
}

uint64_t phLibNfc_AntennaSelfTest(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  char v6;
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  const char *v10;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;

  v6 = a2;
  v14 = a1;
  v15 = a2;
  v13 = 0;
  sub_219885F70(0, (unsigned int *)&v14, 4u, 44, (uint64_t)"phLibNfc_AntennaSelfTest");
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_AntennaSelfTest");
  v7 = sub_21987AB04(v14, &v13);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v13 == 0;
  if (v8)
  {
    v9 = v7;
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"phLibNfc_AntennaSelfTest: Stack Not Initialized");
LABEL_7:
    if ((_DWORD)v9 == 13)
      goto LABEL_15;
    goto LABEL_14;
  }
  v9 = 1;
  v10 = "phLibNfc_AntennaSelfTest: Invalid Params";
  if (a3 && (v6 & 1) != 0)
  {
    if (*(_BYTE *)(v13 + 2946) != 1
      && (*(_BYTE *)(v13 + 2937) == 1 || *(_BYTE *)(v13 + 2938) == 1 || *(_BYTE *)(v13 + 2944) == 1))
    {
      v9 = sub_2198D1B2C(v14, 68, 0, (uint64_t)&v15, 0);
      if ((_DWORD)v9 == 13)
      {
        v12 = v13;
        *(_QWORD *)(v13 + 6808) = a3;
        *(_QWORD *)(v12 + 6816) = a4;
        goto LABEL_15;
      }
      goto LABEL_7;
    }
    v9 = 51;
    v10 = "phLibNfc_AntennaSelfTest: Feature Not Supported";
  }
  sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)v10);
LABEL_14:
  sub_219885F70(0, (unsigned int *)&v14, 4u, 44, (uint64_t)"phLibNfc_AntennaSelfTest");
  sub_2198D2284(v14, 68);
  sub_219886108(v14, v9);
LABEL_15:
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_AntennaSelfTest");
  return v9;
}

uint64_t phLibNfc_GetMemoryDump(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  const char *v8;
  uint64_t v9;
  uint64_t v10;
  _QWORD *v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  v13 = 0;
  v14 = 0;
  v7 = 1;
  sub_219885F70(0, (unsigned int *)&v16, 4u, 10, (uint64_t)"phLibNfc_GetMemoryDump");
  sub_219850718(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDump");
  sub_21988EDF4(v16, &v15);
  sub_21988EB80(v16, &v14);
  sub_21988F744(v16, &v13);
  v8 = "phLibNfc_GetMemoryDump: INVALID_PARAMETER ";
  if ((a2 - 3) < 0xFFFFFFFE)
    goto LABEL_8;
  if (!a3)
    goto LABEL_8;
  v9 = v16;
  if (!v16)
    goto LABEL_8;
  v10 = v14;
  if (!v14)
    goto LABEL_8;
  if (v15 && !v13)
  {
    v7 = 147;
    v8 = "phLibNfc_GetMemoryDump: This API will only be handled only in the Libnfc uninitialized state";
LABEL_8:
    sub_219850628(0, (unsigned int *)&v16, 4u, 1u, (uint64_t)v8);
    goto LABEL_9;
  }
  *(_DWORD *)(v14 + 88) = a2;
  *(_QWORD *)(v10 + 8) = v9;
  v7 = sub_2198D1B2C(v9, 210, 0, 0, 0);
  if ((_DWORD)v7 == 13)
  {
    v12 = (_QWORD *)v14;
    *(_QWORD *)(v14 + 24) = a3;
    *v12 = a4;
    sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDump");
    return v7;
  }
LABEL_9:
  sub_219850808(0, (unsigned int *)&v16, 4u, 5u, (uint64_t)"phLibNfc_GetMemoryDump");
  sub_219885F70(0, (unsigned int *)&v16, 4u, 10, (uint64_t)"phLibNfc_GetMemoryDump");
  sub_2198D2284(v16, 210);
  sub_219886108(v16, v7);
  return v7;
}

uint64_t phLibNfc_Mgt_GetClrAssertRegs(uint64_t a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v8;
  BOOL v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v13;
  int v14;
  uint64_t v15;

  v15 = a1;
  v14 = a2;
  v13 = 0;
  sub_219885F70(0, (unsigned int *)&v15, 4u, 47, (uint64_t)"phLibNfc_Mgt_GetClrAssertRegs");
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetClrAssertRegs");
  v8 = sub_21987AB04(v15, &v13);
  if ((_DWORD)v8)
    v9 = 1;
  else
    v9 = v13 == 0;
  if (v9)
  {
    v10 = v8;
    sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"phLibNfc_Mgt_GetClrAssertRegs: LIBNFC Not Initialized");
    sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetClrAssertRegs");
    if ((_DWORD)v10 == 13)
      return v10;
    goto LABEL_13;
  }
  if (!a4)
  {
    v10 = 1;
    goto LABEL_12;
  }
  v10 = sub_2198D1B2C(v15, 71, 0, (uint64_t)&v14, a3);
  if ((_DWORD)v10 != 13)
  {
LABEL_12:
    sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetClrAssertRegs");
LABEL_13:
    sub_219885F70(0, (unsigned int *)&v15, 4u, 47, (uint64_t)"phLibNfc_Mgt_GetClrAssertRegs");
    sub_2198D2284(v15, 71);
    sub_219886108(v15, v10);
    return v10;
  }
  v11 = v13;
  *(_QWORD *)(v13 + 6040) = a4;
  *(_QWORD *)(v11 + 6048) = a5;
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetClrAssertRegs");
  return v10;
}

uint64_t phLibNfc_Mgt_ConfigureLogging(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  const char *v10;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;
  int v15;

  v15 = a2;
  v13 = 0;
  v14 = a1;
  sub_219885F70(0, (unsigned int *)&v14, 4u, 48, (uint64_t)"phLibNfc_Mgt_ConfigureLogging");
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureLogging");
  v7 = sub_21987AB04(v14, &v13);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v13 == 0;
  if (v8)
  {
    v9 = v7;
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"ConfigureLogging: LIBNFC Not Initialized");
    sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureLogging");
    if ((_DWORD)v9 == 13)
      return v9;
    goto LABEL_16;
  }
  if (*(_BYTE *)(v13 + 2946) == 1)
  {
    v9 = 51;
    v10 = "ConfigureLogging: Feature not supported";
LABEL_14:
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)v10);
    goto LABEL_15;
  }
  v9 = 1;
  v10 = "ConfigureLogging: Invalid input parameters";
  if (!a3 || (a2 & 0xFFFF2080) != 0)
    goto LABEL_14;
  v9 = sub_2198D1B2C(v14, 72, 0, (uint64_t)&v15, 0);
  if ((_DWORD)v9 != 13)
  {
LABEL_15:
    sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureLogging");
LABEL_16:
    sub_219885F70(0, (unsigned int *)&v14, 4u, 48, (uint64_t)"phLibNfc_Mgt_ConfigureLogging");
    sub_2198D2284(v14, 72);
    sub_219886108(v14, v9);
    return v9;
  }
  v11 = v13;
  *(_QWORD *)(v13 + 6600) = a3;
  *(_QWORD *)(v11 + 6608) = a4;
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureLogging");
  return v9;
}

uint64_t phLibNfc_Mgt_ConfigureAssertionLogging(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v6;
  BOOL v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;
  int v12;
  uint64_t v13;

  v13 = a1;
  v12 = a2;
  v11 = 0;
  sub_219885F70(0, (unsigned int *)&v13, 4u, 49, (uint64_t)"phLibNfc_Mgt_ConfigureAssertionLogging");
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureAssertionLogging");
  v6 = sub_21987AB04(v13, &v11);
  if ((_DWORD)v6)
    v7 = 1;
  else
    v7 = v11 == 0;
  if (v7)
  {
    v8 = v6;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"ConfigureAssertLogging: LIBNFC Not Initialized");
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureAssertionLogging");
    if ((_DWORD)v8 == 13)
      return v8;
    goto LABEL_13;
  }
  if (!a3)
  {
    v8 = 1;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"ConfigureAssertionLogging: Invalid input parameters");
    goto LABEL_12;
  }
  v8 = sub_2198D1B2C(v13, 73, 0, (uint64_t)&v12, 0);
  if ((_DWORD)v8 != 13)
  {
LABEL_12:
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureAssertionLogging");
LABEL_13:
    sub_219885F70(0, (unsigned int *)&v13, 4u, 49, (uint64_t)"phLibNfc_Mgt_ConfigureAssertionLogging");
    sub_2198D2284(v13, 73);
    sub_219886108(v13, v8);
    return v8;
  }
  v9 = v11;
  *(_QWORD *)(v11 + 6616) = a3;
  *(_QWORD *)(v9 + 6624) = a4;
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_ConfigureAssertionLogging");
  return v8;
}

uint64_t phLibNfc_TriggerRfFieldOnNtf(uint64_t a1, char a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  const char *v10;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  sub_219885F70(0, (unsigned int *)&v14, 4u, 50, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf");
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf");
  v7 = sub_21987AB04(v14, &v13);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v13 == 0;
  if (v8)
  {
    v9 = v7;
    sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf: LIBNFC Not Initialized");
    sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf");
    if ((_DWORD)v9 == 13)
      return v9;
    goto LABEL_14;
  }
  if (a3)
  {
    if (*(_BYTE *)(v13 + 2946) != 1)
    {
      *(_BYTE *)(v13 + 718) = a2;
      v9 = sub_2198D1B2C(v14, 74, 0, 0, 0);
      if ((_DWORD)v9 == 13)
      {
        v12 = v13;
        *(_QWORD *)(v13 + 6648) = a3;
        *(_QWORD *)(v12 + 6656) = a4;
        sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf");
        return v9;
      }
      goto LABEL_13;
    }
    v9 = 51;
    v10 = "phLibNfc_TriggerRfFieldOnNtf: Feature not supported";
  }
  else
  {
    v9 = 1;
    v10 = "phLibNfc_TriggerRfFieldOnNtf: pRspCb not defined";
  }
  sub_219850628(0, (unsigned int *)&v14, 4u, 1u, (uint64_t)v10);
LABEL_13:
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf");
LABEL_14:
  sub_219885F70(0, (unsigned int *)&v14, 4u, 50, (uint64_t)"phLibNfc_TriggerRfFieldOnNtf");
  sub_2198D2284(v14, 74);
  sub_219886108(v14, v9);
  return v9;
}

uint64_t phLibNfc_Mgt_GetDebugInfo(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  const char *v9;
  uint64_t v10;
  char v11;
  uint64_t v12;
  char v13;
  uint64_t v14;
  unsigned int v15;
  _QWORD *v16;
  uint64_t v18;

  v18 = a1;
  sub_219885F70(0, (unsigned int *)&v18, 4u, 52, (uint64_t)"phLibNfc_Mgt_GetDebugInfo");
  sub_219850718(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetDebugInfo");
  if (!a3 && !a2 && !a4 && !a5)
  {
    v9 = "phLibNfc_Mgt_GetDebugInfo: Invalid parameter";
LABEL_14:
    v14 = 1;
    sub_219850628(0, (unsigned int *)&v18, 4u, 1u, (uint64_t)v9);
    goto LABEL_19;
  }
  if (a3 && (!*(_QWORD *)a3 || !*(_DWORD *)(a3 + 8)))
  {
    v9 = "phLibNfc_Mgt_GetDebugInfo: Invalid parameter for Circular buffer";
    goto LABEL_14;
  }
  v10 = 0;
  v11 = 1;
  v12 = v18;
  while (1)
  {
    v13 = v11;
    if (*((_QWORD *)&unk_253E46700 + 14 * v10) == v18)
      break;
    v11 = 0;
    v10 = 1;
    if ((v13 & 1) == 0)
      goto LABEL_18;
  }
  v15 = *((_DWORD *)&unk_253E46700 + 28 * v10 + 2);
  if (v15 <= 1)
  {
    v16 = (_QWORD *)*((_QWORD *)&unk_253E46700 + 14 * v15 + 10);
    if (v16)
    {
      v16[15] = a2;
      v16[16] = a3;
      v16[17] = a4;
      v16[18] = a5;
      v14 = sub_2198D1B2C(v12, 76, 0, a2, a3);
      goto LABEL_19;
    }
  }
LABEL_18:
  v14 = 0;
LABEL_19:
  sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetDebugInfo");
  sub_219885F70(0, (unsigned int *)&v18, 4u, 52, (uint64_t)"phLibNfc_Mgt_GetDebugInfo");
  return v14;
}

uint64_t phLibNfc_RemoteDev_Connect(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  sub_219885F70(0, (unsigned int *)&v13, 4u, 15, (uint64_t)"phLibNfc_RemoteDev_Connect");
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Connect");
  v7 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v12 == 0;
  if (v8)
    goto LABEL_6;
  if (!a2 || !a3)
  {
    v7 = 1;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"Invalid input Parameter");
LABEL_15:
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Connect");
    sub_219885F70(0, (unsigned int *)&v13, 4u, 15, (uint64_t)"phLibNfc_RemoteDev_Connect");
LABEL_16:
    sub_2198D2284(v13, 17);
    sub_219886108(v13, v7);
    return v7;
  }
  *(_BYTE *)(v12 + 1440) = 0;
  v9 = sub_2198D1B2C(v13, 17, 0, a2, 0);
  if ((_DWORD)v9 == 147)
  {
    if (*(_QWORD *)(v12 + 1456))
    {
      v7 = 147;
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v13, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
      v7 = 1;
    }
    goto LABEL_15;
  }
  v7 = v9;
  if ((_DWORD)v9 == 13)
  {
    v10 = v12;
    *(_QWORD *)(v12 + 6152) = a3;
    *(_QWORD *)(v10 + 6160) = a4;
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Connect");
    return v7;
  }
LABEL_6:
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Connect");
  if ((_DWORD)v7 != 13)
  {
    sub_219885F70(0, (unsigned int *)&v13, 4u, 15, (uint64_t)"phLibNfc_RemoteDev_Connect");
    if ((_DWORD)v7)
      goto LABEL_16;
  }
  return v7;
}

uint64_t phLibNfc_GetTagInfo(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  BOOL v10;
  const char *v11;
  uint64_t v12;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  sub_219885F70(0, (unsigned int *)&v15, 4u, 16, (uint64_t)"phLibNfc_GetTagInfo");
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_GetTagInfo");
  v9 = sub_21987AB04(v15, &v14);
  if ((_DWORD)v9)
    v10 = 1;
  else
    v10 = v14 == 0;
  if (v10)
  {
LABEL_6:
    sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_GetTagInfo");
    if ((_DWORD)v9 == 13)
      return v9;
    goto LABEL_20;
  }
  v9 = 1;
  v11 = "phLibNfc_GetTagInfo: Invalid param";
  if (!a3 || !a2 || !a4 || !*(_QWORD *)(a3 + 8))
    goto LABEL_18;
  v9 = sub_2198D1B2C(v15, 18, 0, a2, a3);
  if ((_DWORD)v9 == 147)
  {
    if (*(_QWORD *)(v14 + 1456))
    {
      v9 = 147;
LABEL_19:
      sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_GetTagInfo");
LABEL_20:
      sub_219885F70(0, (unsigned int *)&v15, 4u, 16, (uint64_t)"phLibNfc_GetTagInfo");
      sub_2198D2284(v15, 18);
      sub_219886108(v15, v9);
      return v9;
    }
    v9 = 148;
    v11 = "State machine status is NFCSTATUS_REJECTED";
LABEL_18:
    sub_219850628(0, (unsigned int *)&v15, 4u, 2u, (uint64_t)v11);
    goto LABEL_19;
  }
  if ((_DWORD)v9 != 13)
    goto LABEL_6;
  v12 = v14;
  *(_QWORD *)(v14 + 6168) = a4;
  *(_QWORD *)(v12 + 6176) = a5;
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_GetTagInfo");
  return v9;
}

uint64_t phLibNfc_RemoteDev_Transceive(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  BOOL v10;
  const char *v11;
  uint64_t v12;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  sub_219885F70(0, (unsigned int *)&v15, 4u, 17, (uint64_t)"phLibNfc_RemoteDev_Transceive");
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Transceive");
  v9 = sub_21987AB04(v15, &v14);
  if ((_DWORD)v9)
    v10 = 1;
  else
    v10 = v14 == 0;
  if (v10)
  {
LABEL_6:
    sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Transceive");
    if ((_DWORD)v9 == 13)
      return v9;
    goto LABEL_19;
  }
  v9 = 1;
  v11 = "phLibNfc_RemoteDev_Transceive: Invalid param";
  if (!a2 || !a3 || !a4)
    goto LABEL_17;
  v9 = sub_2198D1B2C(v15, 19, 0, a2, a3);
  if ((_DWORD)v9 == 147)
  {
    if (*(_QWORD *)(v14 + 1456))
    {
      v9 = 147;
LABEL_18:
      sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Transceive");
LABEL_19:
      sub_219885F70(0, (unsigned int *)&v15, 4u, 17, (uint64_t)"phLibNfc_RemoteDev_Transceive");
      sub_2198D2284(v15, 19);
      sub_219886108(v15, v9);
      return v9;
    }
    v9 = 148;
    v11 = "phLibNfc_RemoteDev_Transceive: State machine status is NFCSTATUS_REJECTED";
LABEL_17:
    sub_219850628(0, (unsigned int *)&v15, 4u, 2u, (uint64_t)v11);
    goto LABEL_18;
  }
  if ((_DWORD)v9 != 13)
    goto LABEL_6;
  v12 = v14;
  *(_QWORD *)(v14 + 6184) = a4;
  *(_QWORD *)(v12 + 6192) = a5;
  *(_OWORD *)(v12 + 2552) = *(_OWORD *)(a3 + 48);
  *(_BYTE *)(v12 + 1480) = 0;
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Transceive");
  return v9;
}

uint64_t phLibNfc_RemoteDev_Disconnect(uint64_t a1, _BYTE *a2, unsigned int a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  char v10;
  char v11;
  unsigned int v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  unsigned int *v16;
  unsigned int v17;
  const char *v18;
  uint64_t v19;
  int v20;
  uint64_t v22;
  uint64_t v23;
  int v24;
  uint64_t v25;
  uint64_t v26;

  v9 = 0;
  v25 = 0;
  v26 = a1;
  v10 = 1;
  while (1)
  {
    v11 = v10;
    if (*((_QWORD *)&unk_253E46700 + 14 * v9) == a1)
      break;
    v10 = 0;
    v9 = 1;
    if ((v11 & 1) == 0)
      goto LABEL_9;
  }
  v12 = *((_DWORD *)&unk_253E46700 + 28 * v9 + 2);
  if (v12 > 1)
  {
LABEL_9:
    v14 = 0;
    goto LABEL_10;
  }
  v13 = *((_QWORD *)&unk_253E46700 + 14 * v12 + 10);
  if (v13)
    v14 = v13 + 120;
  else
    v14 = 0;
LABEL_10:
  v24 = 0;
  sub_219885F70(0, (unsigned int *)&v26, 4u, 130, (uint64_t)"phLibNfc_RemoteDev_Disconnect");
  sub_219850718(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Disconnect");
  v15 = sub_21987AB04(v26, &v25);
  if ((_DWORD)v15 || (v16 = (unsigned int *)v25) == 0)
  {
    if (v14)
    {
      *(_DWORD *)(v14 + 36) = 130;
      sub_219886108(v26, v15);
      LODWORD(v14) = 0;
    }
LABEL_24:
    sub_219850808(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Disconnect");
    if ((_DWORD)v15 == 13)
      return v15;
    goto LABEL_33;
  }
  if (!a2 || !a4)
  {
    v18 = "Invalid parameters passed by upper layer";
LABEL_27:
    v15 = 1;
    sub_219850628(0, (unsigned int *)&v26, 4u, 1u, (uint64_t)v18);
    if (!v14)
      goto LABEL_32;
    *(_DWORD *)(v14 + 36) = 130;
    v19 = v26;
    v20 = 1;
LABEL_31:
    sub_219886108(v19, v20);
    LODWORD(v14) = 0;
    goto LABEL_32;
  }
  if (!*(_QWORD *)(v25 + 1456))
  {
    sub_219850628(0, (unsigned int *)&v26, 4u, 1u, (uint64_t)"Target not connected");
    if (!v14)
    {
      v15 = 148;
      goto LABEL_32;
    }
    *(_DWORD *)(v14 + 36) = 130;
    v19 = v26;
    v15 = 148;
    v20 = 148;
    goto LABEL_31;
  }
  if ((a3 & 0xFFFFFFFB) == 0)
  {
    v18 = "Invalid Release type passed ";
    goto LABEL_27;
  }
  if ((a3 & 0xFFFFFFFE) == 6
    && *(_BYTE *)(v25 + 2937) != 1
    && *(_BYTE *)(v25 + 2938) != 1
    && *(_BYTE *)(v25 + 2944) != 1)
  {
    sub_219850628(0, (unsigned int *)&v26, 4u, 1u, (uint64_t)"Feature not supported for this platform ");
    if (!v14)
    {
      v15 = 51;
      goto LABEL_32;
    }
    *(_DWORD *)(v14 + 36) = 130;
    v19 = v26;
    v15 = 51;
    v20 = 51;
    goto LABEL_31;
  }
  switch(a3)
  {
    case 1u:
      v17 = 3;
      goto LABEL_42;
    case 2u:
      if (*a2 == 1)
        v17 = 4;
      else
        v17 = 3;
      goto LABEL_42;
    case 5u:
      v24 = 5;
      v14 = 22;
      goto LABEL_48;
    case 6u:
      v24 = 5;
      v14 = 23;
      goto LABEL_48;
    case 7u:
      v24 = 5;
      v14 = 24;
LABEL_48:
      *(_DWORD *)(v25 + 984) = 5;
      v16[247] = a3;
      break;
    default:
      v17 = 5;
LABEL_42:
      v24 = v17;
      *(_DWORD *)(v25 + 984) = v17;
      v16[247] = a3;
      if (sub_2198DB69C(v16, v17))
        v14 = 20;
      else
        v14 = 21;
      break;
  }
  v15 = sub_2198D1B2C(v26, v14, 0, (uint64_t)&v24, (uint64_t)a2);
  if (v15 - 111 <= 0x26 && ((1 << (v15 - 111)) & 0x4500000001) != 0
    || v15 == 1)
  {
    sub_219851888(0, (unsigned int *)&v26, 4u, 1u, (uint64_t)"State machine has returned ");
    goto LABEL_24;
  }
  if (v15 == 13)
  {
    sub_219850628(0, (unsigned int *)&v26, 4u, 4u, (uint64_t)"State machine has returned NFCSTATUS_PENDING");
    v22 = v25;
    *(_QWORD *)(v25 + 6216) = a4;
    *(_QWORD *)(v22 + 6224) = a5;
    v23 = *(_QWORD *)(v22 + 3040);
    if (v23)
      *(_BYTE *)(v23 + 6466) = (_DWORD)v14 == 21;
    goto LABEL_24;
  }
  sub_219850628(0, (unsigned int *)&v26, 4u, 1u, (uint64_t)"State machine has returned NFCSTATUS_FAILED");
  v15 = 255;
LABEL_32:
  sub_219850808(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Disconnect");
LABEL_33:
  sub_219885F70(0, (unsigned int *)&v26, 4u, 130, (uint64_t)"phLibNfc_RemoteDev_Disconnect");
  if ((_DWORD)v14)
  {
    sub_2198D2284(v26, v14);
    sub_219886108(v26, v15);
  }
  return v15;
}

uint64_t phLibNfc_RemoteDev_NtfRegister(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  unsigned __int8 v9;
  uint64_t v10;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  sub_219885F70(0, (unsigned int *)&v13, 4u, 13, (uint64_t)"phLibNfc_RemoteDev_NtfRegister");
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_NtfRegister");
  v7 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v12 == 0;
  if (!v8)
  {
    if (a2 && a3)
    {
      v9 = sub_2198D1B2C(v13, 15, 0, a2, 0);
      v7 = v9;
      if (!v9)
      {
        v10 = v12;
        *(_QWORD *)(v12 + 6232) = a3;
        *(_QWORD *)(v10 + 6240) = a4;
      }
    }
    else
    {
      v7 = 1;
      sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"Invalid input parameter");
    }
  }
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_NtfRegister");
  sub_219885F70(0, (unsigned int *)&v13, 4u, 13, (uint64_t)"phLibNfc_RemoteDev_NtfRegister");
  if ((_DWORD)v7)
  {
    sub_2198D2284(v13, 15);
    sub_219886108(v13, v7);
  }
  return v7;
}

uint64_t phLibNfc_RemoteDev_NtfUnregister(uint64_t a1)
{
  uint64_t v1;
  BOOL v2;
  unsigned __int8 v3;
  uint64_t v4;
  uint64_t v6;
  uint64_t v7;

  v6 = 0;
  v7 = a1;
  sub_219885F70(0, (unsigned int *)&v7, 4u, 14, (uint64_t)"phLibNfc_RemoteDev_NtfUnregister");
  sub_219850718(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_NtfUnregister");
  v1 = sub_21987AB04(v7, &v6);
  if ((_DWORD)v1)
    v2 = 1;
  else
    v2 = v6 == 0;
  if (!v2)
  {
    v3 = sub_2198D1B2C(v7, 16, 0, 0, 0);
    v1 = v3;
    if (!v3)
    {
      v4 = v6;
      *(_QWORD *)(v6 + 6240) = 0;
      *(_QWORD *)(v4 + 6232) = 0;
    }
  }
  sub_219850808(0, (unsigned int *)&v7, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_NtfUnregister");
  sub_219885F70(0, (unsigned int *)&v7, 4u, 14, (uint64_t)"phLibNfc_RemoteDev_NtfUnregister");
  if ((_DWORD)v1)
  {
    sub_2198D2284(v7, 16);
    sub_219886108(v7, v1);
  }
  return v1;
}

uint64_t phLibNfc_RemoteDev_CheckPresence(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  sub_219885F70(0, (unsigned int *)&v13, 4u, 22, (uint64_t)"phLibNfc_RemoteDev_CheckPresence");
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_CheckPresence");
  v7 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v12 == 0;
  if (v8)
    goto LABEL_6;
  if (!a2 || !a3)
  {
    v7 = 1;
    sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)"Invalid parameters passed by upper layer");
LABEL_15:
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_CheckPresence");
    sub_219885F70(0, (unsigned int *)&v13, 4u, 22, (uint64_t)"phLibNfc_RemoteDev_CheckPresence");
LABEL_16:
    sub_2198D2284(v13, 25);
    sub_219886108(v13, v7);
    return v7;
  }
  *(_BYTE *)(v12 + 1441) = 0;
  v9 = sub_2198D1B2C(v13, 25, 0, a2, 0);
  if ((_DWORD)v9 == 147)
  {
    if (*(_QWORD *)(v12 + 1456))
    {
      v7 = 147;
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v13, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
      v7 = 148;
    }
    goto LABEL_15;
  }
  v7 = v9;
  if ((_DWORD)v9 == 13)
  {
    v10 = v12;
    *(_QWORD *)(v12 + 6424) = a3;
    *(_QWORD *)(v10 + 6432) = a4;
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_CheckPresence");
    return v7;
  }
LABEL_6:
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_CheckPresence");
  if ((_DWORD)v7 != 13)
  {
    sub_219885F70(0, (unsigned int *)&v13, 4u, 22, (uint64_t)"phLibNfc_RemoteDev_CheckPresence");
    if ((_DWORD)v7)
      goto LABEL_16;
  }
  return v7;
}

uint64_t phLibNfc_RemoteDev_FormatNdef(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  BOOL v10;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  sub_219885F70(0, (unsigned int *)&v14, 4u, 26, (uint64_t)"phLibNfc_RemoteDev_FormatNdef");
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_FormatNdef");
  v9 = sub_21987AB04(v14, &v13);
  if ((_DWORD)v9)
    v10 = 1;
  else
    v10 = v13 == 0;
  if (v10)
    goto LABEL_6;
  v9 = 1;
  if (!a2 || !a3 || !a4 || !a5)
    goto LABEL_25;
  v9 = sub_2198D1B2C(v14, 29, 0, a2, a3);
  if (v9 > 0x6E)
  {
    if ((_DWORD)v9 != 111 && (_DWORD)v9 != 145)
    {
      if ((_DWORD)v9 == 147)
      {
        if (*(_QWORD *)(v13 + 1456))
        {
          v9 = 147;
        }
        else
        {
          sub_219850628(0, (unsigned int *)&v14, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
          v9 = 148;
        }
        goto LABEL_25;
      }
LABEL_23:
      sub_219851888(0, (unsigned int *)&v14, 4u, 2u, (uint64_t)"Internal LibNfc status = ");
      v9 = 255;
LABEL_25:
      sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_FormatNdef");
LABEL_26:
      sub_219885F70(0, (unsigned int *)&v14, 4u, 26, (uint64_t)"phLibNfc_RemoteDev_FormatNdef");
      sub_2198D2284(v14, 29);
      sub_219886108(v14, v9);
      return v9;
    }
LABEL_6:
    sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_FormatNdef");
    if ((_DWORD)v9 == 13)
      return v9;
    goto LABEL_26;
  }
  if (!(_DWORD)v9)
    goto LABEL_6;
  if ((_DWORD)v9 != 13)
  {
    if ((_DWORD)v9 != 49)
      goto LABEL_23;
    goto LABEL_6;
  }
  v11 = v13;
  *(_QWORD *)(v13 + 6904) = a4;
  *(_QWORD *)(v11 + 6912) = a5;
  *(_BYTE *)(v11 + 2886) = 1;
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_FormatNdef");
  return v9;
}

uint64_t phLibNfc_Ndef_CheckNdef(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  unsigned __int8 v9;
  uint64_t v10;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  sub_219885F70(0, (unsigned int *)&v13, 4u, 23, (uint64_t)"phLibNfc_Ndef_CheckNdef");
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ndef_CheckNdef");
  v7 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v12 == 0;
  if (v8)
    goto LABEL_6;
  v7 = 1;
  if (!a2 || !a3)
    goto LABEL_26;
  v9 = sub_2198D1B2C(v13, 26, 0, a2, 0);
  v7 = v9;
  if (v9 > 0x6Eu)
  {
    if (v9 <= 0x90u)
    {
      if (v9 != 111 && v9 != 143)
        goto LABEL_24;
LABEL_6:
      sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ndef_CheckNdef");
      if ((_DWORD)v7 == 13)
        return v7;
      goto LABEL_27;
    }
    if (v9 == 145)
      goto LABEL_6;
    if (v9 == 147)
    {
      if (*(_QWORD *)(v12 + 1456))
      {
        v7 = 147;
      }
      else
      {
        sub_219850628(0, (unsigned int *)&v13, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
        v7 = 148;
      }
      goto LABEL_26;
    }
LABEL_24:
    sub_219851888(0, (unsigned int *)&v13, 4u, 2u, (uint64_t)"Internal LibNfc status = ");
    v7 = 255;
LABEL_26:
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ndef_CheckNdef");
LABEL_27:
    sub_219885F70(0, (unsigned int *)&v13, 4u, 23, (uint64_t)"phLibNfc_Ndef_CheckNdef");
    sub_2198D2284(v13, 26);
    sub_219886108(v13, v7);
    return v7;
  }
  if (!v9)
    goto LABEL_6;
  if (v9 != 13)
  {
    if (v9 == 49)
      goto LABEL_6;
    goto LABEL_24;
  }
  v10 = v12;
  *(_QWORD *)(v12 + 6264) = a3;
  *(_QWORD *)(v10 + 6272) = a4;
  *(_BYTE *)(v10 + 2886) = 1;
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Ndef_CheckNdef");
  return v7;
}

uint64_t phLibNfc_Ndef_Read(uint64_t a1, uint64_t a2, uint64_t a3, int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  BOOL v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v16;
  uint64_t v17;

  v16 = 0;
  v17 = a1;
  sub_219885F70(0, (unsigned int *)&v17, 4u, 24, (uint64_t)"phLibNfc_Ndef_Read");
  sub_219850718(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Read");
  v11 = sub_21987AB04(v17, &v16);
  if ((_DWORD)v11)
    v12 = 1;
  else
    v12 = v16 == 0;
  if (v12)
    goto LABEL_6;
  v11 = 1;
  if (!a3 || !a5 || !*(_QWORD *)a3 || !a2 || !*(_DWORD *)(a3 + 8))
    goto LABEL_31;
  *(_BYTE *)(v16 + 6824) = a4 == 1;
  v13 = sub_2198D1B2C(v17, 27, 0, a2, a3);
  v11 = v13;
  if ((int)v13 > 110)
  {
    if ((int)v13 > 144)
    {
      if ((_DWORD)v13 != 145)
      {
        if ((_DWORD)v13 == 147)
        {
          if (*(_QWORD *)(v16 + 1456))
          {
            v11 = 147;
          }
          else
          {
            sub_219850628(0, (unsigned int *)&v17, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
            v11 = 148;
          }
          goto LABEL_31;
        }
LABEL_29:
        sub_219851888(0, (unsigned int *)&v17, 4u, 2u, (uint64_t)"Internal LibNfc status = ");
        v11 = 255;
LABEL_31:
        sub_219850808(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Read");
LABEL_32:
        sub_219885F70(0, (unsigned int *)&v17, 4u, 24, (uint64_t)"phLibNfc_Ndef_Read");
        sub_2198D2284(v17, 27);
        sub_219886108(v17, v11);
        return v11;
      }
    }
    else if ((_DWORD)v13 != 111 && (_DWORD)v13 != 143)
    {
      goto LABEL_29;
    }
LABEL_6:
    sub_219850808(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Read");
    if ((_DWORD)v11 == 13)
      return v11;
    goto LABEL_32;
  }
  if ((int)v13 > 25)
  {
    if ((_DWORD)v13 != 26 && (_DWORD)v13 != 49)
      goto LABEL_29;
    goto LABEL_6;
  }
  if (!(_DWORD)v13)
    goto LABEL_6;
  if ((_DWORD)v13 != 13)
    goto LABEL_29;
  v14 = v16;
  *(_QWORD *)(v16 + 6360) = a5;
  *(_QWORD *)(v14 + 6368) = a6;
  *(_BYTE *)(v14 + 2886) = 1;
  sub_219850808(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Read");
  return v11;
}

uint64_t phLibNfc_Ndef_Write(uint64_t a1, uint64_t a2, uint64_t a3, int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  BOOL v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v17;
  uint64_t v18;

  v17 = 0;
  v18 = a1;
  sub_219885F70(0, (unsigned int *)&v18, 4u, 25, (uint64_t)"phLibNfc_Ndef_Write");
  sub_219850718(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Write");
  v11 = sub_21987AB04(v18, &v17);
  if ((_DWORD)v11)
    v12 = 1;
  else
    v12 = v17 == 0;
  if (v12)
    goto LABEL_6;
  v11 = 1;
  if (!a3 || !a5)
    goto LABEL_34;
  v13 = *(_QWORD *)a3;
  if (*(_DWORD *)(a3 + 8))
  {
    if (!a2 || !v13)
      goto LABEL_34;
  }
  else if (!a2 || v13)
  {
    goto LABEL_34;
  }
  *(_DWORD *)(v17 + 6836) = a4;
  v14 = sub_2198D1B2C(v18, 28, 0, a2, a3);
  v11 = v14;
  if ((int)v14 > 110)
  {
    if ((int)v14 > 144)
    {
      if ((_DWORD)v14 != 145)
      {
        if ((_DWORD)v14 == 147)
        {
          if (*(_QWORD *)(v17 + 1456))
          {
            v11 = 147;
          }
          else
          {
            sub_219850628(0, (unsigned int *)&v18, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
            v11 = 148;
          }
          goto LABEL_34;
        }
LABEL_32:
        sub_219851888(0, (unsigned int *)&v18, 4u, 2u, (uint64_t)"Internal LibNfc status = ");
        v11 = 255;
LABEL_34:
        sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Write");
LABEL_35:
        sub_219885F70(0, (unsigned int *)&v18, 4u, 25, (uint64_t)"phLibNfc_Ndef_Write");
        sub_2198D2284(v18, 28);
        sub_219886108(v18, v11);
        return v11;
      }
    }
    else if ((_DWORD)v14 != 111 && (_DWORD)v14 != 143)
    {
      goto LABEL_32;
    }
LABEL_6:
    sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Write");
    if ((_DWORD)v11 == 13)
      return v11;
    goto LABEL_35;
  }
  if ((int)v14 > 30)
  {
    if ((_DWORD)v14 != 31 && (_DWORD)v14 != 49)
      goto LABEL_32;
    goto LABEL_6;
  }
  if (!(_DWORD)v14)
    goto LABEL_6;
  if ((_DWORD)v14 != 13)
    goto LABEL_32;
  v15 = v17;
  *(_QWORD *)(v17 + 6376) = a5;
  *(_QWORD *)(v15 + 6384) = a6;
  *(_BYTE *)(v15 + 2886) = 1;
  sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Write");
  return v11;
}

uint64_t phLibNfc_ConvertToReadOnlyNdef(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  BOOL v10;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  sub_219885F70(0, (unsigned int *)&v15, 4u, 27, (uint64_t)"phLibNfc_ConvertToReadOnlyNdef");
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_ConvertToReadOnlyNdef");
  v9 = sub_21987AB04(v15, &v14);
  if ((_DWORD)v9)
    v10 = 1;
  else
    v10 = v14 == 0;
  if (!v10)
  {
    if (!a2 || !a4)
    {
      v9 = 1;
      sub_219850628(0, (unsigned int *)&v15, 4u, 1u, (uint64_t)"Invalid input parameters");
      goto LABEL_16;
    }
    v9 = sub_2198D1B2C(v15, 30, 0, a2, a3);
    v11 = (v9 - 111);
    if (v11 <= 0x29)
    {
      if (((1 << (v9 - 111)) & 0x24500000001) != 0)
        goto LABEL_6;
      if (v11 == 36)
      {
        if (*(_QWORD *)(v14 + 1456))
        {
          v9 = 147;
        }
        else
        {
          sub_219850628(0, (unsigned int *)&v15, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
          v9 = 148;
        }
        goto LABEL_16;
      }
    }
    if (v9 > 0x3A)
    {
LABEL_22:
      sub_219851888(0, (unsigned int *)&v15, 4u, 2u, (uint64_t)"Internal LibNfc status = ");
      v9 = 255;
      goto LABEL_16;
    }
    if (((1 << v9) & 0x40A000000000001) == 0)
    {
      if (v9 == 13)
      {
        v13 = v14;
        *(_QWORD *)(v14 + 6392) = a4;
        *(_QWORD *)(v13 + 6400) = a5;
        *(_BYTE *)(v13 + 2886) = 1;
        goto LABEL_17;
      }
      goto LABEL_22;
    }
  }
LABEL_6:
  if ((_DWORD)v9 != 13)
  {
LABEL_16:
    sub_219885F70(0, (unsigned int *)&v15, 4u, 27, (uint64_t)"phLibNfc_ConvertToReadOnlyNdef");
    sub_2198D2284(v15, 30);
    sub_219886108(v15, v9);
    goto LABEL_17;
  }
  v9 = 13;
LABEL_17:
  sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_ConvertToReadOnlyNdef");
  return v9;
}

uint64_t phLibNfc_RemoteDev_Receive(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = a1;
  sub_219885F70(0, (unsigned int *)&v12, 4u, 30, (uint64_t)"phLibNfc_RemoteDev_Receive");
  sub_219850718(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Receive");
  v7 = sub_21987AB04(v12, &v11);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v11 == 0;
  if (v8)
  {
LABEL_6:
    sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Receive");
    if ((_DWORD)v7 == 13)
      return v7;
    goto LABEL_15;
  }
  v7 = 1;
  if (!a2 || !a3)
  {
LABEL_14:
    sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Receive");
LABEL_15:
    sub_219885F70(0, (unsigned int *)&v12, 4u, 30, (uint64_t)"phLibNfc_RemoteDev_Receive");
    sub_2198D2284(v12, 32);
    sub_219886108(v12, v7);
    return v7;
  }
  v7 = sub_2198D1B2C(v12, 32, 0, a2, 0);
  if ((_DWORD)v7 == 147)
  {
    sub_219850628(0, (unsigned int *)&v12, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
    v7 = 56;
    goto LABEL_14;
  }
  if ((_DWORD)v7 != 13)
    goto LABEL_6;
  v9 = v11;
  *(_QWORD *)(v11 + 6760) = a3;
  *(_QWORD *)(v9 + 6768) = a4;
  sub_219850808(0, (unsigned int *)&v12, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Receive");
  return v7;
}

uint64_t phLibNfc_RemoteDev_Send(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  BOOL v10;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  sub_219885F70(0, (unsigned int *)&v14, 4u, 31, (uint64_t)"phLibNfc_RemoteDev_Send");
  sub_219850718(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Send");
  v9 = sub_21987AB04(v14, &v13);
  if ((_DWORD)v9)
    v10 = 1;
  else
    v10 = v13 == 0;
  if (v10)
  {
LABEL_6:
    sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Send");
    if ((_DWORD)v9 == 13)
      return v9;
    goto LABEL_18;
  }
  v9 = 1;
  if (!a3 || !a2 || !a4 || !*(_QWORD *)a3 || !*(_DWORD *)(a3 + 8))
  {
LABEL_17:
    sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Send");
LABEL_18:
    sub_219885F70(0, (unsigned int *)&v14, 4u, 31, (uint64_t)"phLibNfc_RemoteDev_Send");
    sub_2198D2284(v14, 33);
    sub_219886108(v14, v9);
    return v9;
  }
  v9 = sub_2198D1B2C(v14, 33, 0, a2, a3);
  if ((_DWORD)v9 == 147)
  {
    sub_219850628(0, (unsigned int *)&v14, 4u, 2u, (uint64_t)"State machine status is NFCSTATUS_REJECTED");
    v9 = 56;
    goto LABEL_17;
  }
  if ((_DWORD)v9 != 13)
    goto LABEL_6;
  v11 = v13;
  *(_QWORD *)(v13 + 6744) = a4;
  *(_QWORD *)(v11 + 6752) = a5;
  sub_219850808(0, (unsigned int *)&v14, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Send");
  return v9;
}

uint64_t phLibNfc_SE_GetSecureElementList(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  BOOL v7;
  unsigned int v9;
  _BYTE *v10;
  uint64_t v11;
  char v12;
  char v13;
  unsigned int v14;
  uint64_t v15;
  uint64_t v16;
  uint64_t v17;

  v16 = 0;
  v17 = a1;
  sub_219885F70(0, (unsigned int *)&v17, 4u, 6, (uint64_t)"phLibNfc_SE_GetSecureElementList");
  sub_219850718(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_SE_GetSecureElementList");
  v5 = sub_21987AB04(v17, &v16);
  v6 = v16;
  if ((_DWORD)v5)
    v7 = 1;
  else
    v7 = v16 == 0;
  if (v7)
    goto LABEL_11;
  v5 = 1;
  if (!a2 || !a3)
    goto LABEL_11;
  if (*(_BYTE *)(v16 + 6027) == 1 || *(_BYTE *)(v16 + 6030) == 1 || *(_BYTE *)(v16 + 6031) == 1)
  {
    v5 = 111;
    goto LABEL_11;
  }
  if (!*(_BYTE *)(v16 + 6026))
  {
    v9 = sub_2198D23DC(v17);
    v6 = v16;
    if (v9 <= 2 && !*(_QWORD *)(v16 + 6056))
    {
LABEL_23:
      v5 = 147;
      goto LABEL_11;
    }
  }
  v10 = (_BYTE *)(v6 + 6026);
  if (*v10 != 1)
  {
    if (v10[3] != 1)
    {
      v5 = sub_2198D1B2C(v17, 8, 0, a2, a3);
      goto LABEL_11;
    }
    goto LABEL_23;
  }
  v5 = sub_2198D1714(v17, 8, 0, a2, a3);
  v11 = 0;
  v12 = 1;
  while (1)
  {
    v13 = v12;
    if (*((_QWORD *)&unk_253E46700 + 14 * v11) == v17)
      break;
    v12 = 0;
    v11 = 1;
    if ((v13 & 1) == 0)
      goto LABEL_11;
  }
  v14 = *((_DWORD *)&unk_253E46700 + 28 * v11 + 2);
  if (v14 <= 1)
  {
    v15 = *((_QWORD *)&unk_253E46700 + 14 * v14 + 10);
    if (v15)
    {
      sub_2198D2284(v17, 8);
      *(_WORD *)(v15 + 152) = v5;
    }
  }
LABEL_11:
  sub_219850808(0, (unsigned int *)&v17, 4u, 5u, (uint64_t)"phLibNfc_SE_GetSecureElementList");
  sub_219885F70(0, (unsigned int *)&v17, 4u, 6, (uint64_t)"phLibNfc_SE_GetSecureElementList");
  if ((_DWORD)v5)
  {
    sub_2198D2284(v17, 8);
    sub_219886108(v17, v5);
  }
  return v5;
}

uint64_t phLibNfc_SE_SetMode(uint64_t a1, uint64_t a2, unsigned int a3, uint64_t a4, uint64_t a5)
{
  char v9;
  uint64_t v10;
  char v11;
  unsigned int v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  char *v16;
  uint64_t v17;
  int v18;
  uint64_t v20;
  char *v21;
  char v22;
  uint64_t v23;
  char *v24;
  unsigned int v25;
  char *v26;
  uint64_t v27;

  v26 = 0;
  v27 = a1;
  v25 = 162;
  v9 = 1;
  sub_219885F70(0, (unsigned int *)&v27, 4u, 134, (uint64_t)"phLibNfc_SE_SetMode");
  sub_219850718(0, (unsigned int *)&v27, 4u, 5u, (uint64_t)"phLibNfc_SE_SetMode");
  v10 = 0;
  while (*((_QWORD *)&unk_253E46700 + 14 * v10) != v27)
  {
    v11 = v9;
    v9 = 0;
    v10 = 1;
    if ((v11 & 1) == 0)
      goto LABEL_9;
  }
  v12 = *((_DWORD *)&unk_253E46700 + 28 * v10 + 2);
  if (v12 > 1)
  {
LABEL_9:
    v14 = 0;
    goto LABEL_10;
  }
  v13 = *((_QWORD *)&unk_253E46700 + 14 * v12 + 10);
  if (v13)
    v14 = v13 + 120;
  else
    v14 = 0;
LABEL_10:
  v15 = sub_21987AB04(v27, &v26);
  if ((_DWORD)v15 || (v16 = v26) == 0)
  {
    if (v14)
    {
      *(_DWORD *)(v14 + 36) = 134;
      sub_219886108(v27, v15);
    }
    goto LABEL_20;
  }
  if (!*((_QWORD *)v26 + 787) && !*((_QWORD *)v26 + 817) && !*((_QWORD *)v26 + 789))
  {
    if (a3 > 4 || !a4)
    {
      if (!v14)
      {
        v15 = 1;
        goto LABEL_23;
      }
      *(_DWORD *)(v14 + 36) = 134;
      v17 = v27;
      v15 = 1;
      v18 = 1;
      goto LABEL_17;
    }
    v20 = 0;
    while (1)
    {
      v21 = &v26[v20];
      if (*(_QWORD *)&v26[v20 + 360] == a2)
        break;
      v20 += 16;
      if (v20 == 80)
      {
        v15 = 1;
        goto LABEL_56;
      }
    }
    *((_QWORD *)v26 + 64) = v21 + 360;
    if (*((_DWORD *)v21 + 92) == 1)
    {
      if (a3 == 2)
      {
        v16[1] = 0;
        v16[507] = 0;
        goto LABEL_51;
      }
      v22 = v16[2] & 1;
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v27, 4u, 4u, (uint64_t)"\nMode set requested for UICC, no change in power state\n");
      v16 = v26;
      v22 = *v26;
    }
    v16[1] = v22;
    v16[507] = 0;
    if (a3 == 3)
    {
      if ((v16[2937] == 1 || v16[2938] == 1 || v16[2944] == 1) && *(_DWORD *)(*((_QWORD *)v16 + 64) + 8) == 1)
        a3 = 3;
      else
        a3 = 1;
    }
LABEL_51:
    *((_DWORD *)v16 + 131) = a3;
    sub_2198E03D8((unsigned int *)v16, *(_DWORD *)(*((_QWORD *)v16 + 64) + 8), a3, (int *)&v25);
    v23 = sub_2198D1B2C(v27, v25, 0, 0, 0);
    v15 = v23;
    if ((_DWORD)v23)
    {
      if ((_DWORD)v23 == 13)
      {
        v24 = v26;
        *((_QWORD *)v26 + 835) = a4;
        *((_QWORD *)v24 + 836) = a5;
        **((_QWORD **)v24 + 64) = a2;
        v16 = v26;
        *((_DWORD *)v26 + 132) = 127;
      }
      else
      {
        v16 = v26;
      }
    }
    else
    {
      v16 = v26;
      *(_DWORD *)(*((_QWORD *)v26 + 64) + 12) = *((_DWORD *)v26 + 131);
    }
LABEL_56:
    if (!*((_QWORD *)v16 + 64))
      sub_219850628(0, (unsigned int *)&v27, 4u, 1u, (uint64_t)"Invalid input Se Handle");
LABEL_20:
    sub_219850808(0, (unsigned int *)&v27, 4u, 5u, (uint64_t)"phLibNfc_SE_SetMode");
    if ((_DWORD)v15 == 13)
      return v15;
    goto LABEL_24;
  }
  if (!v14)
  {
    v15 = 111;
    goto LABEL_23;
  }
  *(_DWORD *)(v14 + 36) = 134;
  v17 = v27;
  v15 = 111;
  v18 = 111;
LABEL_17:
  sub_219886108(v17, v18);
LABEL_23:
  sub_219850808(0, (unsigned int *)&v27, 4u, 5u, (uint64_t)"phLibNfc_SE_SetMode");
LABEL_24:
  sub_219885F70(0, (unsigned int *)&v27, 4u, 134, (uint64_t)"phLibNfc_SE_SetMode");
  if (v25 == 162)
  {
    if (v14)
      *(_DWORD *)(v14 + 36) = 134;
  }
  else
  {
    sub_2198D2284(v27, v25);
  }
  sub_219886108(v27, v15);
  return v15;
}

uint64_t phLibNfc_eSE_Transceive(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  const char *v16;
  int v17;
  int v18;
  uint64_t v20;
  uint64_t v21;
  uint64_t v22;
  _QWORD *v24;
  _QWORD *v25;
  _QWORD *v26;
  _QWORD *v27;
  uint64_t v28;
  uint64_t v29;

  v28 = 0;
  v29 = a1;
  v27 = 0;
  sub_219885F70(0, (unsigned int *)&v29, 4u, 124, (uint64_t)"phLibNfc_eSE_Transceive");
  sub_219850718(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_eSE_Transceive");
  sub_21988F744(v29, &v27);
  v11 = sub_21987AB04(v29, &v28);
  v12 = v11;
  v13 = v28;
  if (!v28)
  {
    LODWORD(v14) = 162;
    goto LABEL_18;
  }
  LODWORD(v14) = 162;
  if ((_DWORD)v11 == 49 || (_DWORD)v11 == 145)
    goto LABEL_25;
  v15 = 1;
  v16 = "phLibNfc_eSE_Transceive: Invalid input parameters";
  if (!a3 || !a2 || !a4)
    goto LABEL_24;
  if (!*(_QWORD *)a3 && !*(_DWORD *)(a3 + 8) && !*(_QWORD *)(a3 + 16) && !*(_DWORD *)(a3 + 24))
  {
    v16 = "phLibNfc_eSE_Transceive: Send or Receive data invalid";
    goto LABEL_24;
  }
  if (*(_BYTE *)(v28 + 507) != 1
    && *(_BYTE *)(v28 + 6027) != 1
    && *(_BYTE *)(v28 + 6031) != 1
    && *(_BYTE *)(v28 + 6030) != 1
    && *(_BYTE *)(v28 + 6028) != 1)
  {
    v17 = *(unsigned __int8 *)(v28 + 6026);
    if (v17 == 1)
    {
      if (*(_QWORD *)(v28 + 392) != a2)
      {
        v16 = "phLibNfc_eSE_Transceive: Invalid SE Handle";
LABEL_24:
        sub_219850628(0, (unsigned int *)&v29, 4u, 1u, (uint64_t)v16);
        v12 = v15;
        goto LABEL_25;
      }
      v14 = 214;
      if (!(_DWORD)v11)
      {
LABEL_45:
        v22 = sub_2198D1B2C(v29, v14, 0, a3, 0);
        v12 = v22;
        if ((v22 - 111) <= 0x24 && ((1 << (v22 - 111)) & 0x1500000001) != 0)
          goto LABEL_25;
        if ((_DWORD)v22 != 13)
        {
          v15 = 255;
          v16 = "phLibNfc_eSE_Transceive:Hci Transceive sequence could not start!";
          goto LABEL_24;
        }
        if (v17 == 1 && (v24 = v27) != 0)
        {
          v27[81] = a4;
          v24[82] = a6;
          if (a5)
          {
            v24[83] = a5;
            v25 = v24 + 84;
LABEL_60:
            *v25 = a6;
          }
        }
        else
        {
          v26 = (_QWORD *)v28;
          *(_QWORD *)(v28 + 6296) = a4;
          v26[788] = a6;
          if (a5)
          {
            v26[793] = a5;
            v25 = v26 + 794;
            goto LABEL_60;
          }
        }
        sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_eSE_Transceive");
        return 13;
      }
    }
    else
    {
      if (*(_BYTE *)(v28 + 6029) == 1)
      {
        v12 = 147;
        goto LABEL_25;
      }
      v20 = 0;
      *(_QWORD *)(v28 + 512) = 0;
      v16 = "phLibNfc_eSE_Transceive: Invalid SE Handle";
      while (1)
      {
        v21 = v13 + v20;
        if (*(_QWORD *)(v13 + v20 + 360) == a2)
          break;
        v20 += 16;
        if (v20 == 64)
          goto LABEL_24;
      }
      *(_QWORD *)(v13 + 512) = v21 + 360;
      if (*(_DWORD *)(v21 + 368) == 1)
      {
        if (*(_BYTE *)(a3 + 40) == 1 && !*(_DWORD *)(v13 + v20 + 372))
        {
          v14 = 170;
          if (!(_DWORD)v11)
            goto LABEL_45;
        }
        else
        {
          v14 = 169;
          if (!(_DWORD)v11)
            goto LABEL_45;
        }
      }
      else
      {
        v14 = 162;
        if (!(_DWORD)v11)
          goto LABEL_45;
      }
    }
LABEL_18:
    sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_eSE_Transceive");
    if ((_DWORD)v12 == 13)
      return v12;
    goto LABEL_26;
  }
  v12 = 111;
LABEL_25:
  sub_219850808(0, (unsigned int *)&v29, 4u, 5u, (uint64_t)"phLibNfc_eSE_Transceive");
LABEL_26:
  sub_219885F70(0, (unsigned int *)&v29, 4u, 124, (uint64_t)"phLibNfc_eSE_Transceive");
  if ((_DWORD)v14 == 162)
    v18 = 169;
  else
    v18 = v14;
  sub_2198D2284(v29, v18);
  sub_219886108(v29, v12);
  return v12;
}

uint64_t phLibNfc_SE_RawTranseive(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  const char *v13;
  uint64_t i;
  uint64_t v15;
  uint64_t v16;
  _QWORD *v17;
  uint64_t v19;
  uint64_t v20;

  v19 = 0;
  v20 = a1;
  sub_219885F70(0, (unsigned int *)&v20, 4u, 125, (uint64_t)"phLibNfc_SE_RawTranseive");
  sub_219850718(0, (unsigned int *)&v20, 4u, 5u, (uint64_t)"phLibNfc_SE_RawTranseive");
  v11 = sub_21987AB04(v20, &v19);
  v12 = v11;
  if (!v19)
    goto LABEL_25;
  if ((_DWORD)v11 == 49 || (_DWORD)v11 == 145)
    goto LABEL_29;
  v12 = 1;
  v13 = "phLibNfc_SE_RawTranseive: Invalid input parameters";
  if (!a2 || !a3 || !a4)
    goto LABEL_28;
  if (*(_DWORD *)(a3 + 16) && (!*(_QWORD *)(a3 + 32) || *(unsigned __int16 *)(a3 + 28) < 2u))
  {
    v13 = "phLibNfc_SE_RawTranseive: Receive data invalid";
LABEL_28:
    sub_219850628(0, (unsigned int *)&v20, 4u, 1u, (uint64_t)v13);
    goto LABEL_29;
  }
  if (*(_BYTE *)(v19 + 507) == 1)
  {
    v12 = 111;
LABEL_29:
    sub_219850808(0, (unsigned int *)&v20, 4u, 5u, (uint64_t)"phLibNfc_SE_RawTranseive");
LABEL_30:
    sub_219885F70(0, (unsigned int *)&v20, 4u, 125, (uint64_t)"phLibNfc_SE_RawTranseive");
    sub_2198D2284(v20, 171);
    sub_219886108(v20, v12);
    return v12;
  }
  for (i = 0; i != 64; i += 16)
  {
    if (*(_QWORD *)(v19 + 360 + i) == a2)
    {
      v15 = v19 + i + 360;
      *(_QWORD *)(v19 + 512) = v15;
      goto LABEL_19;
    }
  }
  v15 = *(_QWORD *)(v19 + 512);
  if (!v15)
  {
    v12 = 255;
    v13 = "phLibNfc_SE_RawTranseive: Invalid SE Handle";
    goto LABEL_28;
  }
LABEL_19:
  if (*(_DWORD *)(v15 + 8) != 1)
  {
    v12 = 51;
    v13 = "phLibNfc_SE_RawTranseive:Wrong handle, eSE is supported in raw mode";
    goto LABEL_28;
  }
  if ((v16 = sub_2198D1B2C(v20, 171, 0, a3, 0), v12 = v16, (v16 - 111) <= 0x24)
    && ((1 << (v16 - 111)) & 0x1500000001) != 0
    || (_DWORD)v16 == 1)
  {
LABEL_25:
    sub_219850808(0, (unsigned int *)&v20, 4u, 5u, (uint64_t)"phLibNfc_SE_RawTranseive");
    if ((_DWORD)v12 == 13)
      return v12;
    goto LABEL_30;
  }
  if ((_DWORD)v16 != 13)
  {
    v12 = 255;
    v13 = "phLibNfc_SE_RawTranseive:Hci Transceive sequence could not start!";
    goto LABEL_28;
  }
  v17 = (_QWORD *)v19;
  *(_QWORD *)(v19 + 6312) = a4;
  v17[790] = a6;
  v17[793] = a5;
  v17[794] = a6;
  sub_219850808(0, (unsigned int *)&v20, 4u, 5u, (uint64_t)"phLibNfc_SE_RawTranseive");
  return v12;
}

uint64_t phLibNfc_SE_NtfRegister(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  BOOL v6;
  unsigned __int8 v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219885F70(0, (unsigned int *)&v11, 4u, 8, (uint64_t)"phLibNfc_SE_NtfRegister");
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SE_NtfRegister");
  v5 = sub_21987AB04(v11, &v10);
  if ((_DWORD)v5)
    v6 = 1;
  else
    v6 = v10 == 0;
  if (!v6)
  {
    if (a2)
    {
      v7 = sub_2198D1B2C(v11, 13, 0, 0, 0);
      v5 = v7;
      if (!v7)
      {
        v8 = v10;
        *(_QWORD *)(v10 + 6696) = a2;
        *(_QWORD *)(v8 + 6704) = a3;
      }
    }
    else
    {
      v5 = 1;
    }
  }
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_SE_NtfRegister");
  sub_219885F70(0, (unsigned int *)&v11, 4u, 8, (uint64_t)"phLibNfc_SE_NtfRegister");
  if ((_DWORD)v5)
  {
    sub_2198D2284(v11, 13);
    sub_219886108(v11, v5);
  }
  return v5;
}

uint64_t phLibNfc_SE_NtfUnregister(uint64_t a1)
{
  uint64_t v1;
  BOOL v2;
  unsigned __int8 v3;
  uint64_t v5;
  uint64_t v6;

  v5 = 0;
  v6 = a1;
  sub_219885F70(0, (unsigned int *)&v6, 4u, 9, (uint64_t)"phLibNfc_SE_NtfUnregister");
  sub_219850718(0, (unsigned int *)&v6, 4u, 5u, (uint64_t)"phLibNfc_SE_NtfUnregister");
  v1 = sub_21987AB04(v6, &v5);
  if ((_DWORD)v1)
    v2 = 1;
  else
    v2 = v5 == 0;
  if (!v2)
  {
    v3 = sub_2198D1B2C(v6, 14, 0, 0, 0);
    v1 = v3;
    if (!v3)
      *(_OWORD *)(v5 + 6696) = 0u;
  }
  sub_219850808(0, (unsigned int *)&v6, 4u, 5u, (uint64_t)"phLibNfc_SE_NtfUnregister");
  sub_219885F70(0, (unsigned int *)&v6, 4u, 9, (uint64_t)"phLibNfc_SE_NtfUnregister");
  if ((_DWORD)v1)
  {
    sub_2198D2284(v6, 14);
    sub_219886108(v6, v1);
  }
  return v1;
}

uint64_t phLibNfc_Mgt_SetCE_ConfigParams(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  BOOL v8;
  const char *v9;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a1;
  sub_219885F70(0, (unsigned int *)&v13, 4u, 37, (uint64_t)"phLibNfc_Mgt_SetCE_ConfigParams");
  sub_219850718(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetCE_ConfigParams");
  v7 = sub_21987AB04(v13, &v12);
  if ((_DWORD)v7)
    v8 = 1;
  else
    v8 = v12 == 0;
  if (v8)
  {
LABEL_6:
    sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetCE_ConfigParams");
    if ((_DWORD)v7 == 13)
      return v7;
    goto LABEL_13;
  }
  v7 = 1;
  v9 = "Invalid input Parameter";
  if (!a2 || !a3)
    goto LABEL_12;
  if (*(_BYTE *)(v12 + 2946) != 1)
  {
    v7 = sub_2198D1B2C(v13, 38, 0, a2, 0);
    if ((_DWORD)v7 == 13)
    {
      v11 = v12;
      *(_QWORD *)(v12 + 6440) = a3;
      *(_QWORD *)(v11 + 6448) = a4;
      sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetCE_ConfigParams");
      return v7;
    }
    goto LABEL_6;
  }
  v7 = 51;
  v9 = "Feature not supported";
LABEL_12:
  sub_219850628(0, (unsigned int *)&v13, 4u, 1u, (uint64_t)v9);
  sub_219850808(0, (unsigned int *)&v13, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetCE_ConfigParams");
LABEL_13:
  sub_219885F70(0, (unsigned int *)&v13, 4u, 37, (uint64_t)"phLibNfc_Mgt_SetCE_ConfigParams");
  sub_2198D2284(v13, 38);
  sub_219886108(v13, v7);
  return v7;
}

uint64_t phLibNfc_CardEmulation_NtfRegister(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  BOOL v6;
  unsigned __int8 v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219885F70(0, (unsigned int *)&v11, 4u, 38, (uint64_t)"phLibNfc_CardEmulation_NtfRegister");
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_CardEmulation_NtfRegister");
  v5 = sub_21987AB04(v11, &v10);
  if ((_DWORD)v5)
    v6 = 1;
  else
    v6 = v10 == 0;
  if (!v6)
  {
    if (a2)
    {
      v7 = sub_2198D1B2C(v11, 39, 0, 0, 0);
      v5 = v7;
      if (!v7)
      {
        v8 = v10;
        *(_QWORD *)(v10 + 6712) = a2;
        *(_QWORD *)(v8 + 6720) = a3;
      }
    }
    else
    {
      v5 = 1;
    }
  }
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_CardEmulation_NtfRegister");
  sub_219885F70(0, (unsigned int *)&v11, 4u, 38, (uint64_t)"phLibNfc_CardEmulation_NtfRegister");
  if ((_DWORD)v5)
  {
    sub_2198D2284(v11, 39);
    sub_219886108(v11, v5);
  }
  return v5;
}

uint64_t phLibNfc_eSE_GetAtr(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  const char *v12;
  uint64_t v13;
  unsigned int v14;
  uint64_t v15;
  unsigned int v16;
  uint64_t v19;
  uint64_t v21;
  uint64_t v22;

  v21 = 0;
  v22 = a1;
  sub_219885F70(0, (unsigned int *)&v22, 4u, 126, (uint64_t)"phLibNfc_eSE_GetAtr");
  sub_219850718(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_eSE_GetAtr");
  v9 = sub_21987AB04(v22, &v21);
  v10 = v9;
  if (!v21)
    goto LABEL_33;
  if ((_DWORD)v9 == 49 || (_DWORD)v9 == 145)
  {
LABEL_17:
    sub_219850808(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_eSE_GetAtr");
LABEL_34:
    sub_219885F70(0, (unsigned int *)&v22, 4u, 126, (uint64_t)"phLibNfc_eSE_GetAtr");
    sub_2198D2284(v22, 172);
    sub_219886108(v22, v10);
    return v10;
  }
  if (!a3 || !a2 || !a4 || !*(_QWORD *)a3 || !*(_DWORD *)(a3 + 8))
  {
    v12 = "phLibNfc_eSE_GetAtr: Invalid input parameters";
LABEL_16:
    v10 = 1;
    sub_219850628(0, (unsigned int *)&v22, 4u, 1u, (uint64_t)v12);
    goto LABEL_17;
  }
  v11 = 0;
  while (*(_QWORD *)(v21 + v11 + 360) != a2 || *(_DWORD *)(v21 + v11 + 368) != 1 || *(_DWORD *)(v21 + v11 + 372) != 2)
  {
    v11 += 16;
    if (v11 == 64)
      goto LABEL_14;
  }
  v13 = *(_QWORD *)(v21 + 464);
  if (!v13)
  {
LABEL_14:
    v12 = "phLibNfc_eSE_GetAtr: Invalid Hci context received or Invalid SE Handle!";
    goto LABEL_16;
  }
  v14 = sub_2198D1B2C(v22, 172, 0, 0, 0);
  if (v14 != 13)
  {
    v16 = v14;
    sub_219850628(0, (unsigned int *)&v22, 4u, 1u, (uint64_t)"phLibNfc_eSE_GetAtr Failed!");
    if (v16 == 145 || v16 == 111 || v16 == 143)
      v10 = v16;
    else
      v10 = 255;
    goto LABEL_17;
  }
  sub_219850628(0, (unsigned int *)&v22, 4u, 4u, (uint64_t)"phLibNfc_eSE_GetAtr Cmd Sent to lower layer");
  v15 = v21;
  *(_QWORD *)(v21 + 6536) = a4;
  *(_QWORD *)(v15 + 6544) = a5;
  *(_QWORD *)(v15 + 552) = a3;
  if (sub_2198E1F68(v13)
    || (v19 = *(_QWORD *)(v21 + 464), *(_DWORD *)(v19 + 868) = 2000, !phOsalNfc_Timer_Start()))
  {
    sub_219850808(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_eSE_GetAtr");
    return 13;
  }
  v10 = phOsalNfc_Timer_Delete();
  *(_QWORD *)(v19 + 856) = 0xFFFFFFFFFFFFLL;
  sub_219850628(0, (unsigned int *)&v22, 4u, 1u, (uint64_t)"phLibNfc_eSE_GetAtr: SE Get Atr Timer Start Failed");
LABEL_33:
  sub_219850808(0, (unsigned int *)&v22, 4u, 5u, (uint64_t)"phLibNfc_eSE_GetAtr");
  if ((_DWORD)v10 != 13)
    goto LABEL_34;
  return v10;
}

uint64_t phLibNfc_Mgt_GetNfccParams(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  char v7;
  uint64_t v8;
  char v9;
  unsigned int v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  int v15;
  uint64_t v16;
  uint64_t v17;
  uint64_t v18;
  _QWORD *v19;
  uint64_t v21;
  uint64_t v22;
  uint64_t v23;
  uint64_t v24;

  v23 = 0;
  v24 = a1;
  v21 = 0;
  v22 = 0;
  v7 = 1;
  sub_219885F70(0, (unsigned int *)&v24, 4u, 131, (uint64_t)"phLibNfc_Mgt_GetNfccParams");
  sub_219850718(0, (unsigned int *)&v24, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetNfccParams");
  v8 = 0;
  while (*((_QWORD *)&unk_253E46700 + 14 * v8) != v24)
  {
    v9 = v7;
    v7 = 0;
    v8 = 1;
    if ((v9 & 1) == 0)
      goto LABEL_9;
  }
  v10 = *((_DWORD *)&unk_253E46700 + 28 * v8 + 2);
  if (v10 > 1)
  {
LABEL_9:
    v12 = 0;
    goto LABEL_10;
  }
  v11 = *((_QWORD *)&unk_253E46700 + 14 * v10 + 10);
  if (v11)
    v12 = v11 + 120;
  else
    v12 = 0;
LABEL_10:
  sub_21988F744(v24, &v22);
  sub_21988F460(v24, &v21);
  v13 = sub_21987AB04(v24, &v23);
  if ((_DWORD)v13 || !v23)
  {
    sub_219850628(0, (unsigned int *)&v24, 4u, 1u, (uint64_t)"phLibNfc_Mgt_GetNfccParams: LIBNFC Not Initialized");
    if (v12)
    {
      *(_DWORD *)(v12 + 36) = 131;
      sub_219886108(v24, v13);
    }
    sub_219850808(0, (unsigned int *)&v24, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetNfccParams");
    if ((_DWORD)v13 != 13)
      sub_219885F70(0, (unsigned int *)&v24, 4u, 131, (uint64_t)"phLibNfc_Mgt_GetNfccParams");
  }
  else if (a3)
  {
    switch(a2)
    {
      case 0:
        v14 = v24;
        v15 = 77;
        v16 = 77;
        goto LABEL_50;
      case 1:
        if (!v21)
        {
          v14 = v24;
          v15 = 78;
          v16 = 78;
          goto LABEL_50;
        }
        if (*(_BYTE *)(v23 + 6027) == 1
          || *(_BYTE *)(v23 + 6028) == 1
          || *(_BYTE *)(v23 + 6030) == 1
          || *(_BYTE *)(v23 + 6031) == 1)
        {
          sub_219850628(0, (unsigned int *)&v24, 4u, 2u, (uint64_t)"Previous API in progress");
          v15 = 235;
          v13 = 111;
          goto LABEL_60;
        }
        if (*(_BYTE *)(v23 + 6029) == 1)
        {
          v14 = v24;
          v15 = 216;
          v16 = 216;
          goto LABEL_50;
        }
        sub_219850628(0, (unsigned int *)&v24, 4u, 1u, (uint64_t)"phLibNfc_Mgt_GetNfccParams: SMB logging not enabled ");
        v15 = 235;
        v13 = 147;
        goto LABEL_60;
      case 3:
        if (*(_BYTE *)(v23 + 2946) == 1)
          goto LABEL_45;
        v14 = v24;
        v15 = 79;
        v16 = 79;
        goto LABEL_50;
      case 4:
        if (*(_BYTE *)(v23 + 2946) == 1)
          goto LABEL_45;
        v14 = v24;
        v15 = 81;
        v16 = 81;
        goto LABEL_50;
      case 5:
        if (*(_BYTE *)(v23 + 2946) == 1)
          goto LABEL_45;
        v14 = v24;
        v15 = 80;
        v16 = 80;
        goto LABEL_50;
      case 6:
        if (*(_BYTE *)(v23 + 2946) == 1)
          goto LABEL_45;
        v14 = v24;
        v15 = 82;
        v16 = 82;
        goto LABEL_50;
      case 7:
        if (*(_BYTE *)(v23 + 2946) == 1)
          goto LABEL_45;
        v14 = v24;
        v15 = 83;
        v16 = 83;
        goto LABEL_50;
      case 8:
        if (*(_BYTE *)(v23 + 2946) == 1)
          goto LABEL_45;
        v14 = v24;
        v15 = 85;
        v16 = 85;
        goto LABEL_50;
      case 9:
        v14 = v24;
        v15 = 86;
        v16 = 86;
        goto LABEL_50;
      case 10:
        v14 = v24;
        v15 = 87;
        v16 = 87;
        goto LABEL_50;
      case 11:
        if (*(_BYTE *)(v23 + 2946) == 1
          || *(_BYTE *)(v23 + 2942) == 1
          || *(_BYTE *)(v23 + 2943) == 1
          || *(_BYTE *)(v23 + 2939) == 1 && *(_BYTE *)(v23 + 3088) == 2)
        {
LABEL_45:
          v15 = 235;
          v13 = 51;
          goto LABEL_60;
        }
        v14 = v24;
        v15 = 84;
        v16 = 84;
LABEL_50:
        v13 = sub_2198D1B2C(v14, v16, 0, 0, 0);
        if ((_DWORD)v13 != 13)
          goto LABEL_60;
        v17 = v23;
        if (v23 && *(_BYTE *)(v23 + 6029) == 1 && (v18 = v22) != 0)
        {
          *(_BYTE *)(v23 + 6031) = 1;
          *(_QWORD *)(v18 + 728) = a3;
          v19 = (_QWORD *)(v18 + 736);
        }
        else
        {
          *(_QWORD *)(v23 + 6776) = a3;
          v19 = (_QWORD *)(v17 + 6784);
        }
        *v19 = a4;
        sub_219850808(0, (unsigned int *)&v24, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetNfccParams");
        v13 = 13;
        break;
      default:
        goto LABEL_19;
    }
  }
  else
  {
LABEL_19:
    v13 = 1;
    sub_219850628(0, (unsigned int *)&v24, 4u, 1u, (uint64_t)"phLibNfc_Mgt_GetNfccParams: Invalid input parameters");
    if (v12)
    {
      *(_DWORD *)(v12 + 36) = 131;
      sub_219886108(v24, 1);
    }
    v15 = 235;
LABEL_60:
    sub_219850808(0, (unsigned int *)&v24, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetNfccParams");
    sub_219885F70(0, (unsigned int *)&v24, 4u, 131, (uint64_t)"phLibNfc_Mgt_GetNfccParams");
    if (v15 != 235)
    {
      sub_2198D2284(v24, v15);
      sub_219886108(v24, v13);
    }
  }
  return v13;
}

uint64_t phLibNfc_Mgt_SetNfccParams(uint64_t a1, _DWORD *a2, uint64_t a3, uint64_t a4)
{
  char v7;
  uint64_t v8;
  char v9;
  unsigned int v10;
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  BOOL v14;
  int v15;
  char v16;
  int v17;
  uint64_t v18;
  uint64_t v19;
  uint64_t v20;
  int *v21;
  uint64_t v22;
  uint64_t v23;
  uint64_t v24;
  _QWORD *v25;
  uint64_t v27;
  uint64_t v28;
  uint64_t v29;
  int v30;
  uint64_t v31;
  uint64_t v32;

  v31 = 0;
  v32 = a1;
  v30 = 2;
  v28 = 0;
  v29 = 0;
  v27 = 0;
  v7 = 1;
  sub_219885F70(0, (unsigned int *)&v32, 4u, 132, (uint64_t)"phLibNfc_Mgt_SetNfccParams");
  sub_219850718(0, (unsigned int *)&v32, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetNfccParams");
  sub_21988EB80(v32, &v28);
  sub_21988F744(v32, &v29);
  sub_21988F460(v32, &v27);
  v8 = 0;
  while (*((_QWORD *)&unk_253E46700 + 14 * v8) != v32)
  {
    v9 = v7;
    v7 = 0;
    v8 = 1;
    if ((v9 & 1) == 0)
      goto LABEL_9;
  }
  v10 = *((_DWORD *)&unk_253E46700 + 28 * v8 + 2);
  if (v10 > 1)
  {
LABEL_9:
    v12 = 0;
    goto LABEL_10;
  }
  v11 = *((_QWORD *)&unk_253E46700 + 14 * v10 + 10);
  if (v11)
    v12 = v11 + 120;
  else
    v12 = 0;
LABEL_10:
  v13 = sub_21987AB04(v32, &v31);
  if ((_DWORD)v13)
    v14 = 1;
  else
    v14 = v31 == 0;
  v15 = v14;
  if (a2 && v15 && *a2)
  {
    v16 = 1;
    sub_219850628(0, (unsigned int *)&v32, 4u, 1u, (uint64_t)"phLibNfc_Mgt_SetNfccParams: LIBNFC Not Initialized");
    if (v12)
    {
      *(_DWORD *)(v12 + 36) = 132;
      sub_219886108(v32, v13);
    }
    v17 = 235;
  }
  else
  {
    if (!a2 || !a3)
    {
LABEL_30:
      v16 = 1;
      sub_219850628(0, (unsigned int *)&v32, 4u, 1u, (uint64_t)"phLibNfc_Mgt_SetNfccParams: Invalid input parameters");
      if (v12)
      {
        *(_DWORD *)(v12 + 36) = 132;
        sub_219886108(v32, 1);
      }
      v17 = 235;
      v13 = 1;
      goto LABEL_63;
    }
    switch(*a2)
    {
      case 0:
        if (!v31)
          goto LABEL_55;
        if (!v27)
        {
          phOsalNfc_MemCopy();
          v18 = v32;
          v17 = 88;
          v19 = 88;
          goto LABEL_57;
        }
        if (v28 && *(_BYTE *)(v28 + 836) == 1)
        {
          sub_219850628(0, (unsigned int *)&v32, 4u, 2u, (uint64_t)"Degraded FW update on going");
          v13 = 147;
          goto LABEL_48;
        }
        if (*(_BYTE *)(v31 + 6030) == 1
          || *(_BYTE *)(v31 + 6031) == 1
          || *(_BYTE *)(v31 + 6027) == 1
          || *(_BYTE *)(v31 + 6028) == 1)
        {
          sub_219850628(0, (unsigned int *)&v32, 4u, 2u, (uint64_t)"Previous API in progress");
          v13 = 111;
          goto LABEL_48;
        }
LABEL_55:
        v18 = v32;
        v20 = (uint64_t)(a2 + 2);
        v17 = 215;
        v21 = &v30;
        v19 = 215;
        v22 = v13;
        goto LABEL_58;
      case 1:
        if (*(_BYTE *)(v31 + 2946) == 1)
          goto LABEL_47;
        phOsalNfc_MemCopy();
        v18 = v32;
        v17 = 89;
        v19 = 89;
        goto LABEL_57;
      case 3:
        if (*(_BYTE *)(v31 + 2946) == 1)
          goto LABEL_47;
        phOsalNfc_MemCopy();
        v18 = v32;
        v17 = 90;
        v19 = 90;
        goto LABEL_57;
      case 4:
        if (*(_BYTE *)(v31 + 2946) == 1)
          goto LABEL_47;
        phOsalNfc_MemCopy();
        v18 = v32;
        v17 = 91;
        v19 = 91;
        goto LABEL_57;
      case 5:
        phOsalNfc_MemCopy();
        v18 = v32;
        v17 = 92;
        v19 = 92;
        goto LABEL_57;
      case 6:
        if (*(_BYTE *)(v31 + 2946) == 1)
          goto LABEL_47;
        phOsalNfc_MemCopy();
        v18 = v32;
        v17 = 93;
        v19 = 93;
        goto LABEL_57;
      case 7:
        if (*(_BYTE *)(v31 + 2946) == 1)
          goto LABEL_47;
        phOsalNfc_MemCopy();
        v18 = v32;
        v17 = 94;
        v19 = 94;
        goto LABEL_57;
      case 8:
        if (*(_BYTE *)(v31 + 2946) == 1)
          goto LABEL_47;
        phOsalNfc_MemCopy();
        v18 = v32;
        v17 = 95;
        v19 = 95;
        goto LABEL_57;
      case 9:
        if (*(_BYTE *)(v31 + 2946) == 1)
        {
LABEL_47:
          v13 = 51;
LABEL_48:
          v16 = 1;
          v17 = 235;
          goto LABEL_63;
        }
        phOsalNfc_MemCopy();
        v18 = v32;
        v17 = 96;
        v19 = 96;
LABEL_57:
        v22 = v13;
        v20 = 0;
        v21 = 0;
LABEL_58:
        v13 = sub_2198D1B2C(v18, v19, v22, v20, (uint64_t)v21);
        v16 = 0;
        break;
      default:
        goto LABEL_30;
    }
  }
  if ((_DWORD)v13 == 13)
  {
    sub_21988EDF4(v32, &v31);
    sub_21988F744(v32, &v29);
    v23 = v31;
    if (v31 && (v24 = v29) != 0)
    {
      *(_BYTE *)(v31 + 6030) = 1;
      *(_QWORD *)(v24 + 712) = a3;
      v25 = (_QWORD *)(v24 + 720);
    }
    else
    {
      if (!v31)
      {
LABEL_68:
        sub_219850808(0, (unsigned int *)&v32, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetNfccParams");
        return 13;
      }
      *(_QWORD *)(v31 + 6792) = a3;
      v25 = (_QWORD *)(v23 + 6800);
    }
    *v25 = a4;
    goto LABEL_68;
  }
LABEL_63:
  sub_219850808(0, (unsigned int *)&v32, 4u, 5u, (uint64_t)"phLibNfc_Mgt_SetNfccParams");
  sub_219885F70(0, (unsigned int *)&v32, 4u, 132, (uint64_t)"phLibNfc_Mgt_SetNfccParams");
  if ((v16 & 1) == 0)
  {
    sub_2198D2284(v32, v17);
    sub_219886108(v32, v13);
  }
  return v13;
}

uint64_t phLibNfc_Mgt_eSeCfgDnldMode(uint64_t a1, unsigned int a2, uint64_t a3, uint64_t a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  const char *v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v16;
  int v17;
  _QWORD *v18;
  int v20;
  _QWORD *v21;
  _BYTE *v22;
  uint64_t v23;
  uint64_t v24;
  unsigned int v25;
  uint64_t v26;

  v26 = a1;
  v25 = a2;
  v23 = 0;
  v24 = 0;
  v21 = 0;
  v22 = 0;
  v20 = 1;
  sub_219885F70(0, (unsigned int *)&v26, 4u, 85, (uint64_t)"phLibNfc_Mgt_eSeCfgDnldMode");
  sub_219850718(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_Mgt_eSeCfgDnldMode");
  sub_21988EB80(v26, &v23);
  sub_21988F460(v26, &v24);
  sub_21988F744(v26, &v21);
  v11 = sub_21987AB04(v26, &v22);
  if (!(_DWORD)v11 && v22)
  {
    if (v24)
    {
      if (v22[6027] == 1 || v22[6030] == 1 || v22[6031] == 1)
      {
        sub_219850628(0, (unsigned int *)&v26, 4u, 2u, (uint64_t)"Previous API call in progress");
        v11 = 111;
        goto LABEL_10;
      }
      if (*(_BYTE *)(v23 + 836) != 1)
      {
        v11 = 0;
        goto LABEL_10;
      }
      sub_219850628(0, (unsigned int *)&v26, 4u, 2u, (uint64_t)"Degraded FW update on going");
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v26, 4u, 1u, (uint64_t)"This API will only be handled only in the Libnfc uninitialized state");
    }
    v11 = 147;
  }
LABEL_10:
  v12 = 1;
  v13 = "phLibNfc_Mgt_eSeCfgDnldMode: Invalid input parameters";
  if (a2 > 2)
    goto LABEL_45;
  if (!a5)
    goto LABEL_45;
  if (!a3)
    goto LABEL_45;
  v14 = v26;
  if (!v26)
    goto LABEL_45;
  if ((_DWORD)v11 != 49)
  {
    if ((_DWORD)v11 == 13)
      goto LABEL_36;
    if ((_DWORD)v11)
    {
LABEL_22:
      LODWORD(v15) = 212;
LABEL_46:
      sub_219885F70(0, (unsigned int *)&v26, 4u, 85, (uint64_t)"phLibNfc_Mgt_eSeCfgDnldMode");
      sub_2198D2284(v26, v15);
      sub_219886108(v26, v11);
      goto LABEL_47;
    }
  }
  if (a2 == 1 && !(_DWORD)v11 && v22)
  {
    if (v22[6026] == 1)
    {
      v11 = 0;
      goto LABEL_22;
    }
  }
  else if (a2 == 2)
  {
    if (!v22 || !v22[6026])
    {
      v12 = 147;
      v13 = "eSE not enabled";
      goto LABEL_45;
    }
    v16 = v23;
    if (v23)
    {
      v17 = *(unsigned __int8 *)(v23 + 92);
      if ((v17 - 209) >= 3 && v17 != 96)
      {
        LODWORD(v15) = 212;
        v11 = 51;
        goto LABEL_46;
      }
      goto LABEL_31;
    }
LABEL_41:
    v12 = 255;
    v13 = "phLibNfc_Mgt_eSeCfgDnldMode: Invalid IOCTL context!!";
LABEL_45:
    sub_219850628(0, (unsigned int *)&v26, 4u, 1u, (uint64_t)v13);
    LODWORD(v15) = 212;
    v11 = v12;
    goto LABEL_46;
  }
  v16 = v23;
  if (!v23)
    goto LABEL_41;
LABEL_31:
  *(_QWORD *)(v16 + 8) = v26;
  if (a2 == 1)
    v15 = 212;
  else
    v15 = 213;
  v11 = sub_2198D1B2C(v14, v15, v11, (uint64_t)&v25, (uint64_t)&v20);
  if ((_DWORD)v11 != 13)
    goto LABEL_46;
  v14 = v26;
LABEL_36:
  sub_21988EDF4(v14, &v22);
  if (v22)
    v22[6027] = 1;
  sub_21988F744(v26, &v21);
  v18 = v21;
  if (v21)
  {
    v21[87] = a3;
    v18[88] = a4;
    v18[85] = a5;
    v11 = 13;
    v18[86] = a6;
  }
  else
  {
    v11 = 13;
  }
LABEL_47:
  sub_219850808(0, (unsigned int *)&v26, 4u, 5u, (uint64_t)"phLibNfc_Mgt_eSeCfgDnldMode");
  return v11;
}

uint64_t phLibNfc_Mgt_DnldGeneralNtfRegister(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  const char *v6;
  uint64_t v8;
  _BYTE *v9;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  v9 = 0;
  v5 = 1;
  sub_219885F70(0, (unsigned int *)&v11, 4u, 84, (uint64_t)"phLibNfc_Mgt_DnldGeneralNtfRegister");
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_DnldGeneralNtfRegister");
  if (!a2)
  {
    v6 = "phLibNfc_Mgt_DnldGeneralNtfRegister: Invalid input parameters";
LABEL_11:
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)v6);
    goto LABEL_12;
  }
  sub_21988EB80(v11, &v10);
  sub_21988EDF4(v11, &v9);
  if (!v10)
  {
    v5 = 255;
    v6 = "phLibNfc_Mgt_DnldGeneralNtfRegister: Invalid IOCTL context!!";
    goto LABEL_11;
  }
  if (v9 && (v9[6027] == 1 || v9[6028] == 1 || v9[6031] == 1 || v9[6030] == 1))
  {
    v5 = 111;
  }
  else
  {
    v5 = sub_2198D1B2C(v11, 206, 0, 0, 0);
    if (!(_DWORD)v5)
    {
      v8 = v10;
      *(_QWORD *)(v10 + 200) = a2;
      *(_QWORD *)(v8 + 208) = a3;
      sub_219885F70(0, (unsigned int *)&v11, 4u, 84, (uint64_t)"phLibNfc_Mgt_DnldGeneralNtfRegister");
      goto LABEL_13;
    }
  }
LABEL_12:
  sub_219885F70(0, (unsigned int *)&v11, 4u, 84, (uint64_t)"phLibNfc_Mgt_DnldGeneralNtfRegister");
  sub_2198D2284(v11, 206);
  sub_219886108(v11, v5);
LABEL_13:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_DnldGeneralNtfRegister");
  return v5;
}

uint64_t phLibNfc_Mgt_GetTagID(uint64_t a1, unsigned int a2)
{
  int v3;
  BOOL v4;
  int v5;
  const char *v6;
  int v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219885F70(0, (unsigned int *)&v11, 4u, 135, (uint64_t)"phLibNfc_Mgt_GetTagID");
  sub_219850718(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetTagID");
  v3 = sub_21987AB04(v11, &v10);
  if (v3)
    v4 = 1;
  else
    v4 = v10 == 0;
  if (v4)
  {
    v5 = v3;
    v6 = " Invalid driver handle or libctx";
LABEL_9:
    sub_219850628(0, (unsigned int *)&v11, 4u, 1u, (uint64_t)v6);
    v8 = 0;
    goto LABEL_11;
  }
  v7 = sub_2198D1B2C(v11, 9, 0, 0, 0);
  v5 = v7;
  if (v7)
  {
    v6 = "Get tag id is not allowed in this state";
    goto LABEL_9;
  }
  v8 = sub_219896814(v10, a2);
LABEL_11:
  sub_219850808(0, (unsigned int *)&v11, 4u, 5u, (uint64_t)"phLibNfc_Mgt_GetTagID");
  sub_219885F70(0, (unsigned int *)&v11, 4u, 135, (uint64_t)"phLibNfc_Mgt_GetTagID");
  if (v5)
  {
    sub_2198D2284(v11, 9);
    sub_219886108(v11, v5);
  }
  return v8;
}

uint64_t sub_2198BB544(uint64_t a1, _OWORD *a2, uint64_t a3, int a4, uint64_t a5, _BYTE *a6, int a7, uint64_t a8, unsigned __int16 *a9)
{
  uint64_t v16;
  BOOL v17;
  BOOL v18;
  BOOL v19;
  BOOL v20;
  BOOL v21;
  uint64_t v22;
  int v24;
  int v25;
  int v26;

  sub_219850718(4, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_Transceive");
  if (a1
    && ((v16 = *(_QWORD *)(a1 + 256), a9) ? (v17 = a8 == 0) : (v17 = 1),
        !v17 ? (v18 = a6 == 0) : (v18 = 1),
        !v18 ? (v19 = a3 == 0) : (v19 = 1),
        !v19 ? (v20 = a2 == 0) : (v20 = 1),
        !v20 ? (v21 = v16 == 0) : (v21 = 1),
        !v21 && (a7 || *(_DWORD *)(a3 + 4) == 22)))
  {
    *(_DWORD *)(a1 + 120) = a4;
    v24 = *(_DWORD *)(a3 + 4);
    if (v24 == 16 || v24 == 12)
    {
      *(_BYTE *)(a1 + 124) = *a6;
      v25 = a7 - 1;
      if ((a4 & 0xFFFFFFFE) == 0x60)
      {
        v26 = *(unsigned __int8 *)(a3 + 18);
        *(_QWORD *)(a1 + 152) = a1 + 264;
        if (v26 != 7 && v26 != 4)
        {
          *(_DWORD *)(a1 + 160) = v25;
          v22 = 20;
          goto LABEL_21;
        }
        phOsalNfc_MemCopy();
        phOsalNfc_MemCopy();
        v25 = a7 + 3;
      }
      else
      {
        *(_QWORD *)(a1 + 152) = a6 + 1;
      }
    }
    else
    {
      *(_QWORD *)(a1 + 152) = a6;
      v25 = a7;
    }
    *(_DWORD *)(a1 + 160) = v25;
    *(_QWORD *)(a1 + 168) = a8;
    *(_DWORD *)(a1 + 176) = *a9;
    *(_QWORD *)(a1 + 232) = a9;
    sub_2198BB720((unsigned int *)a1, a2, 8);
    *(_WORD *)(a1 + 126) = 500;
    *(_BYTE *)(v16 + 1484) = 0;
    v22 = sub_2198914A0(a3, a1 + 120, (uint64_t)sub_2198BB7A8, v16);
  }
  else
  {
    v22 = 1;
  }
LABEL_21:
  sub_219850808(4, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_Transceive");
  return v22;
}

uint64_t sub_2198BB720(unsigned int *a1, _OWORD *a2, int a3)
{
  unsigned int *v6;
  unsigned int *v7;

  *(_BYTE *)a1 = a3;
  sub_219850718(4, a1, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_SetComplInfo");
  v6 = a1 + 10;
  v7 = a1 + 2;
  if (a3 == 11)
    v7 = a1 + 6;
  if (a3 != 10)
    v6 = v7;
  *(_OWORD *)v6 = *a2;
  return sub_219850808(4, a1, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_SetComplInfo");
}

uint64_t sub_2198BB7A8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  void (*v8)(uint64_t, _QWORD, uint64_t);
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_CB_Transceive");
  sub_21988EDF4(v11, &v10);
  if (v10)
  {
    v7 = *(_QWORD *)(v10 + 6936);
    if (v7)
    {
      if (a4)
        **(_WORD **)(v7 + 232) = *(_DWORD *)(a4 + 8);
      v8 = *(void (**)(uint64_t, _QWORD, uint64_t))(v7 + 8);
      if (v8)
        v8(v11, *(_QWORD *)(v7 + 16), a5);
    }
  }
  return sub_219850808(0, (unsigned int *)&v11, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_CB_Transceive");
}

uint64_t sub_2198BB850(uint64_t a1, _OWORD *a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t *v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  sub_219850718(4, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_Reconnect");
  v6 = 1;
  if (a1)
  {
    if (a3)
    {
      if (a2)
      {
        v7 = *(_QWORD *)(a1 + 256);
        if (v7)
        {
          sub_2198BB720((unsigned int *)a1, a2, 7);
          v8 = (uint64_t *)(v7 + 1456);
          if (sub_219902600(*(unsigned int **)(v7 + 3040), *(_QWORD *)(v7 + 1456)))
          {
            v9 = 0;
            *v8 = 0;
            *(_QWORD *)(v7 + 1464) = 0;
          }
          else
          {
            v9 = *v8;
          }
          v12 = v9;
          if (sub_2198BE4E4(v7, &v11, &v12, 0))
            v6 = 255;
          else
            v6 = sub_2198BE2B4(*(_QWORD *)(v7 + 19360), v11, (uint64_t)sub_2198BB950, a1);
        }
      }
    }
  }
  sub_219850808(4, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_Reconnect");
  return v6;
}

uint64_t sub_2198BB950(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v7;

  v7 = a1;
  sub_219850718(0, (unsigned int *)&v7, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_CB_ConnectDisconnect");
  if (a2)
  {
    if (a3)
      v5 = 0;
    else
      v5 = 255;
    (*(void (**)(uint64_t, _QWORD, uint64_t))(a2 + 8))(v7, *(_QWORD *)(a2 + 16), v5);
  }
  return sub_219850808(0, (unsigned int *)&v7, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_CB_ConnectDisconnect");
}

uint64_t sub_2198BB9D0(uint64_t a1, _OWORD *a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8;
  uint64_t v9;
  uint64_t *v10;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = a3;
  sub_219850718(4, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_Connect");
  v8 = 1;
  if (a1)
  {
    if (a4)
    {
      if (a3)
      {
        if (a2)
        {
          v9 = *(_QWORD *)(a1 + 256);
          if (v9)
          {
            sub_2198BB720((unsigned int *)a1, a2, 6);
            v10 = (uint64_t *)(v9 + 1456);
            if (sub_219902600(*(unsigned int **)(v9 + 3040), *(_QWORD *)(v9 + 1456)))
            {
              *v10 = 0;
              *(_QWORD *)(v9 + 1464) = 0;
              v8 = 255;
              v12 = 0;
            }
            else
            {
              v12 = *v10;
              if (v12 && sub_2198BE4E4(v9, &v13, &v12, 0) != 255)
                v8 = sub_2198BE2B4(*(_QWORD *)(v9 + 19360), v13, (uint64_t)sub_2198BB950, a1);
              else
                v8 = 255;
            }
          }
        }
      }
    }
  }
  sub_219850808(4, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_OvrHal_Connect");
  return v8;
}

uint64_t sub_2198BBAEC(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;
  __int128 v6;
  uint64_t v7;

  v7 = 0;
  v5 = 0u;
  v6 = 0u;
  v4 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Send_ISO_14443_3B_AttribCmd");
  if (a1)
  {
    phOsalNfc_SetMemory();
    *(_BYTE *)(a1 + 1486) = 29;
    phOsalNfc_MemCopy();
    *(_DWORD *)(a1 + 1491) = 3840;
    phOsalNfc_MemCopy();
    *(_QWORD *)&v5 = a1 + 1486;
    DWORD2(v5) = 13;
    *(_QWORD *)&v6 = a1 + 2016;
    DWORD2(v6) = 530;
    WORD3(v4) = 500;
    v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), (uint64_t)&v4, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Send_ISO_14443_3B_AttribCmd");
  return v2;
}

uint64_t sub_2198BBC20(unsigned int *a1, int a2, unsigned __int8 *a3)
{
  uint64_t v3;
  int v5;
  const char *v6;

  LODWORD(v3) = a2;
  v5 = *a3;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ISO_14443_3B_AttribResp");
  if (a1)
  {
    if (v5 == 1)
      v6 = "Invalid Attrib response!!";
    else
      v6 = "Valid Attrib response!!";
    if (v5 == 1)
      v3 = 1;
    else
      v3 = v3;
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)v6);
  }
  else
  {
    v3 = 1;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ISO_14443_3B_AttribResp");
  return v3;
}

uint64_t sub_2198BBCC8(uint64_t a1, uint64_t a2)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ISO_14443_3B_PresChkConnComplete");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 6152))
    {
      sub_2198B3C10(a1, a2);
    }
    else if (*(_QWORD *)(a1 + 6432))
    {
      sub_2198C0014(a1, a2);
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"ISO_14443_3B Connect CB and Presence Check CB unavilable!!");
    }
  }
  else
  {
    a2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ISO_14443_3B_PresChkConnComplete");
  return a2;
}

uint64_t sub_2198BBD94(uint64_t a1)
{
  uint64_t v2;
  uint64_t Memory;
  uint64_t v4;
  unsigned int v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Init");
  if (!a1)
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Init");
  *(_BYTE *)(a1 + 2886) = 0;
  if (*(_QWORD *)(a1 + 6840) || (v2 = phOsalNfc_GetMemory(), (*(_QWORD *)(a1 + 6840) = v2) != 0))
  {
    phOsalNfc_SetMemory();
    *(_WORD *)(a1 + 6848) = 252;
    *(_QWORD *)(*(_QWORD *)(a1 + 6840) + 184) = 0;
    Memory = phOsalNfc_GetMemory();
    v4 = *(_QWORD *)(a1 + 6840);
    *(_QWORD *)(v4 + 184) = Memory;
    if (Memory)
    {
      phOsalNfc_SetMemory();
      *(_QWORD *)(a1 + 6936) = 0;
      *(_QWORD *)(a1 + 6936) = phOsalNfc_GetMemory();
      v4 = *(_QWORD *)(a1 + 6840);
    }
    *(_QWORD *)(v4 + 2632) = *(_QWORD *)(a1 + 2952);
    v5 = *(_DWORD *)(a1 + 19368);
    *(_DWORD *)(v4 + 2640) = v5;
  }
  else
  {
    v5 = *(_DWORD *)(a1 + 19368);
  }
  if (!*(_QWORD *)(a1 + 6936))
    goto LABEL_13;
  phOsalNfc_SetMemory();
  v6 = *(_QWORD *)(a1 + 6936);
  *(_QWORD *)(v6 + 256) = a1;
  *(_QWORD *)(v6 + 80) = a1 + 2952;
  if (!*(_QWORD *)(a1 + 6928))
  {
    v7 = phOsalNfc_GetMemory();
    *(_QWORD *)(a1 + 6928) = v7;
    if (!v7)
    {
      v5 = *(_DWORD *)(a1 + 19368);
LABEL_13:
      sub_2198EEA6C(v5);
      phOsalNfc_RaiseException();
      goto LABEL_14;
    }
  }
  *(_BYTE *)(a1 + 6872) = 2;
LABEL_14:
  if (*(_QWORD *)(a1 + 6880) || (v8 = phOsalNfc_GetMemory(), (*(_QWORD *)(a1 + 6880) = v8) != 0))
  {
    phOsalNfc_SetMemory();
    v9 = *(_QWORD *)(a1 + 6880);
    v10 = *(_QWORD *)(a1 + 2952);
    *(_QWORD *)(v9 + 400) = a1;
    *(_QWORD *)(v9 + 408) = v10;
    *(_DWORD *)(v9 + 416) = *(_DWORD *)(a1 + 19368);
  }
  else
  {
    sub_2198EEA6C(*(_DWORD *)(a1 + 19368));
    phOsalNfc_RaiseException();
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_Init");
}

uint64_t sub_2198BBF5C(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  _QWORD *v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t i;
  uint64_t v9;
  uint64_t v10;
  uint64_t v11;
  uint64_t v12;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_DeInit");
  if (a1)
  {
    v2 = *(_QWORD *)(a1 + 6840);
    if (v2)
    {
      if (*(_QWORD *)(v2 + 424))
      {
        phOsalNfc_FreeMemory();
        v2 = *(_QWORD *)(a1 + 6840);
        *(_QWORD *)(v2 + 424) = 0;
      }
      *(_DWORD *)(v2 + 2640) = 255;
      if (*(_QWORD *)(v2 + 184))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 6840) + 184) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 6840) = 0;
    }
    v3 = *(_QWORD *)(a1 + 6880);
    if (v3)
    {
      *(_QWORD *)(v3 + 16) = 0;
      *(_QWORD *)(v3 + 40) = 0;
      *(_QWORD *)(v3 + 56) = 0;
      *(_QWORD *)(v3 + 72) = 0;
      *(_QWORD *)(v3 + 400) = 0;
      *(_QWORD *)(v3 + 88) = 0;
      *(_QWORD *)(v3 + 96) = 0;
      *(_WORD *)(v3 + 104) = 0;
      *(_DWORD *)(v3 + 416) = 255;
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 6880) = 0;
    }
    v4 = *(_QWORD **)(a1 + 6936);
    if (v4)
    {
      v4[32] = 0;
      if (v4[9])
      {
        phOsalNfc_FreeMemory();
        v4 = *(_QWORD **)(a1 + 6936);
        v4[9] = 0;
      }
      if (v4[13])
      {
        phOsalNfc_FreeMemory();
        v4 = *(_QWORD **)(a1 + 6936);
        v4[13] = 0;
      }
      if (v4[14])
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 6936) + 112) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 6936) = 0;
    }
    if (*(_QWORD *)(a1 + 6928))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 6928) = 0;
    }
    v5 = 0;
    v6 = a1 + 7344;
    do
    {
      if (*(_QWORD *)(v6 + v5))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v6 + v5) = 0;
      }
      v5 += 8;
    }
    while (v5 != 64);
    if (*(_QWORD *)(a1 + 7448))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 7448) = 0;
    }
    v7 = *(_QWORD *)(a1 + 7480);
    if (v7 && *(_QWORD *)(v7 + 24))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(*(_QWORD *)(a1 + 7480) + 24) = 0;
    }
    if (*(_QWORD *)(a1 + 7488))
    {
      for (i = 400; i != 464; i += 8)
      {
        if (*(_QWORD *)(*(_QWORD *)(a1 + 7488) + i))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(*(_QWORD *)(a1 + 7488) + i) = 0;
        }
      }
    }
    if (*(_QWORD *)(a1 + 8352))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 8352) = 0;
    }
    v9 = 0;
    v10 = a1 + 8640;
    do
    {
      if (*(_QWORD *)(v10 + v9))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(v10 + v9) = 0;
      }
      v9 += 8;
    }
    while (v9 != 1024);
    v11 = *(_QWORD *)(a1 + 9664);
    if (v11)
    {
      do
      {
        if (*(_QWORD *)(v11 + 656))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(v11 + 656) = 0;
        }
        v12 = *(_QWORD *)(v11 + 672);
        phOsalNfc_FreeMemory();
        v11 = v12;
      }
      while (v12);
    }
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_DeInit");
}

uint64_t sub_2198BC1F8(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t *a4, int a5)
{
  uint64_t v7;
  int v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t *v11;
  _QWORD *v12;
  _QWORD v14[2];
  uint64_t v15;
  uint64_t v16;
  int v17;
  uint64_t v18;

  v18 = a1;
  v17 = 0;
  v15 = 0;
  v16 = 0;
  sub_219850718(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Reconnect_Mifare_Cb");
  if (a5)
    v7 = 146;
  else
    v7 = 255;
  sub_21988EDF4(v18, &v15);
  if (v15)
  {
    v8 = *(_DWORD *)(v15 + 6888);
    if ((v8 - 1) < 4)
    {
      v9 = *(_QWORD *)(v15 + 19360);
      v10 = v7;
      v11 = 0;
LABEL_10:
      v12 = 0;
LABEL_11:
      sub_2198D1B2C(v9, 146, v10, (uint64_t)v11, (uint64_t)v12);
      return sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Reconnect_Mifare_Cb");
    }
    if (v8 == 5)
    {
      v14[0] = 0;
      v14[1] = 0;
      v9 = *(_QWORD *)(v15 + 19360);
      v12 = v14;
      v10 = v7;
      v11 = a4;
      goto LABEL_11;
    }
    if (!v8)
    {
      HIDWORD(v16) = 0;
      v17 = 0;
      v9 = *(_QWORD *)(v15 + 19360);
      v11 = &v16;
      v10 = v7;
      goto LABEL_10;
    }
  }
  return sub_219850808(0, (unsigned int *)&v18, 4u, 5u, (uint64_t)"phLibNfc_Reconnect_Mifare_Cb");
}

uint64_t sub_2198BC2F0(uint64_t a1, unsigned int a2)
{
  uint64_t v4;
  char v5;
  uint64_t v6;
  unsigned int v7;
  uint64_t v12;

  v12 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_ReadOnly_Cb");
  if (a1)
  {
    if (sub_21987AB98(a1))
    {
      *(_BYTE *)(a1 + 2886) = 0;
      sub_21988EF68(*(_QWORD *)(a1 + 19360), &v12);
      if (a2 || !v12)
      {
        if (a2 == 10)
        {
          v7 = sub_21990201C(*(_QWORD *)(a1 + 3040));
          if (v7 <= 1)
            v4 = 10;
          else
            v4 = v7;
        }
        else if ((a2 & 0xFFFFFFFD) == 0xB5 || (a2 & 0xFFFFFFFB) == 178 || (a2 & 0xFFFE) == 184 || a2 == 143)
        {
          v4 = a2;
        }
        else
        {
          v4 = 255;
        }
        v6 = 146;
      }
      else
      {
        v4 = 0;
        if (*(_BYTE *)(a1 + 19372) == 1)
          v5 = 2;
        else
          v5 = 1;
        *(_BYTE *)(v12 + 545) = v5;
        v6 = 145;
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc Stack Shut Down in progress");
      v6 = 146;
      v4 = 145;
    }
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v6, v4, 0, 0);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_ReadOnly_Cb");
}

uint64_t sub_2198BC440(uint64_t a1, uint64_t a2, int a3)
{
  uint64_t *v5;
  uint64_t v6;
  int v7;
  int v8;
  uint64_t v9;
  uint64_t v10;
  int v11;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = a1;
  v13 = 0;
  sub_219850718(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Ndef_format_Cb");
  if (a2)
  {
    v5 = (uint64_t *)(a2 + 1456);
    if (sub_219902600(*(unsigned int **)(a2 + 3040), *(_QWORD *)(a2 + 1456)))
    {
      v6 = 0;
      *v5 = 0;
      *(_QWORD *)(a2 + 1464) = 0;
    }
    else
    {
      v6 = *v5;
    }
    v13 = v6;
    v7 = sub_2198BE4E4(a2, &v14, &v13, 0);
    LOBYTE(v8) = -1;
    v9 = 146;
    if (v7)
      goto LABEL_18;
    v10 = v14;
    if (!v14)
      goto LABEL_18;
    *(_BYTE *)(a2 + 2886) = 0;
    if (!a3)
    {
      LOBYTE(v8) = 0;
      v9 = 145;
      goto LABEL_18;
    }
    if ((_BYTE)a3 != 0xFF)
    {
      if ((unsigned __int16)(a3 - 178) < 8u)
        LOBYTE(v8) = byte_21990ACD0[2 * (__int16)(a3 - 178)];
      goto LABEL_18;
    }
    v11 = *(_DWORD *)(v10 + 4);
    if (v11 != 16 && v11 != 12 || (*(_BYTE *)(v10 + 68) & 8) == 0)
    {
LABEL_18:
      sub_2198D1B2C(*(_QWORD *)(a2 + 19360), v9, v8, 0, 0);
      return sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Ndef_format_Cb");
    }
    v8 = sub_2198BE2B4(*(_QWORD *)(a2 + 19360), v10, (uint64_t)sub_2198BC1F8, a2);
    if (v8 != 13)
    {
      v9 = 146;
      goto LABEL_18;
    }
  }
  else
  {
    sub_2198EEA6C(0xFFu);
    phOsalNfc_RaiseException();
  }
  return sub_219850808(0, (unsigned int *)&v15, 4u, 5u, (uint64_t)"phLibNfc_Ndef_format_Cb");
}

uint64_t sub_2198BC5C4(uint64_t a1, uint64_t a2, unsigned __int8 *a3)
{
  uint64_t *v6;
  uint64_t v7;
  uint64_t v8;
  unint64_t v9;
  unsigned __int8 v10;
  int v12;
  int v13;
  uint64_t v14;
  uint64_t v15;

  v14 = 0;
  v15 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_CheckNdefRsp_Cb");
  if (!a1)
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_CheckNdefRsp_Cb");
  v6 = (uint64_t *)(a1 + 1456);
  if (!sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    v14 = *v6;
    if (!v14)
    {
      v7 = 255;
      v8 = 146;
      goto LABEL_4;
    }
    v12 = sub_2198BE4E4(a1, &v15, &v14, 0);
    v7 = 255;
    v8 = 146;
    if (v12 || !v15)
      goto LABEL_4;
    v13 = sub_21987AB98(a1);
    if ((_DWORD)a2 != 145 && v13)
    {
      if ((_DWORD)a2 != 157)
      {
        if (!(_DWORD)a2)
        {
          v7 = 0;
          *(_BYTE *)(a1 + 6872) = 1;
          *(_DWORD *)(a1 + 6828) = *((_DWORD *)a3 + 1);
          *(_DWORD *)(a1 + 6868) = *((_DWORD *)a3 + 2);
          v8 = 145;
LABEL_24:
          *(_BYTE *)(a1 + 2886) = 0;
          goto LABEL_4;
        }
        *(_BYTE *)(a1 + 6872) = 0;
        v7 = 255;
        v8 = 146;
        if ((a2 - 143) > 0x2C || ((1 << (a2 + 113)) & 0x1FC800000209) == 0)
          goto LABEL_24;
      }
      v8 = 146;
      v7 = a2;
      goto LABEL_24;
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc Stack Shut Down in progress");
    v7 = 145;
    v8 = 146;
    goto LABEL_24;
  }
  *v6 = 0;
  *(_QWORD *)(a1 + 1464) = 0;
  v7 = 255;
  v8 = 146;
  v14 = 0;
LABEL_4:
  if (a3)
  {
    v9 = *a3;
    if (v9 >= 3)
      v10 = 0;
    else
      v10 = 0x20301u >> (8 * v9);
    *a3 = v10;
  }
  sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v8, v7, (uint64_t)a3, 0);
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_CheckNdefRsp_Cb");
}

uint64_t sub_2198BC788(uint64_t a1, uint64_t a2)
{
  uint64_t *v4;
  uint64_t v5;
  int v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_ReadNdefRsp_Cb");
  if (a1)
  {
    v4 = (uint64_t *)(a1 + 1456);
    if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
    {
      v5 = 0;
      *v4 = 0;
      *(_QWORD *)(a1 + 1464) = 0;
    }
    else
    {
      v5 = *v4;
    }
    v11 = v5;
    v6 = sub_2198BE4E4(a1, &v12, &v11, 0);
    v7 = 0;
    v8 = 146;
    if (v6 || !v12)
      goto LABEL_23;
    if (!sub_21987AB98(a1))
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc Stack Shut Down in progress");
      a2 = 0;
      goto LABEL_21;
    }
    if ((int)a2 <= 144)
    {
      if (!(_DWORD)a2)
      {
        *(_BYTE *)(*(_QWORD *)(a1 + 6840) + 209) = *(_BYTE *)(*(_QWORD *)(a1 + 6840) + 210);
        v8 = 145;
LABEL_22:
        *(_BYTE *)(a1 + 2886) = 0;
        v7 = a2;
LABEL_23:
        sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v8, v7, 0, 0);
        return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_ReadNdefRsp_Cb");
      }
      if ((_DWORD)a2 == 24)
        goto LABEL_11;
    }
    else
    {
      if ((a2 - 145) <= 0x28 && ((1 << (a2 + 111)) & 0x1F200001001) != 0)
      {
LABEL_11:
        *(_BYTE *)(*(_QWORD *)(a1 + 6840) + 209) = -1;
LABEL_21:
        v8 = 146;
        goto LABEL_22;
      }
      if ((_DWORD)a2 == 255)
      {
        v9 = *(_QWORD *)(a1 + 6840);
LABEL_20:
        *(_BYTE *)(v9 + 209) = a2;
        goto LABEL_21;
      }
    }
    v9 = *(_QWORD *)(a1 + 6840);
    a2 = 255;
    goto LABEL_20;
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_ReadNdefRsp_Cb");
}

uint64_t sub_2198BC914(uint64_t a1, int a2)
{
  uint64_t *v4;
  uint64_t v5;
  int v6;
  uint64_t v7;
  int v11;
  uint64_t v12;
  uint64_t v13;

  v12 = 0;
  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_WriteNdefRsp_Cb");
  if (a1)
  {
    v4 = (uint64_t *)(a1 + 1456);
    if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
    {
      v5 = 0;
      *v4 = 0;
      *(_QWORD *)(a1 + 1464) = 0;
    }
    else
    {
      v5 = *v4;
    }
    v12 = v5;
    v6 = sub_2198BE4E4(a1, &v13, &v12, 0);
    v7 = 146;
    if (v6 || !v13)
      goto LABEL_23;
    if (sub_21987AB98(a1))
    {
      if (a2 != 145)
      {
        if (!a2)
        {
          if (*(_DWORD *)(a1 + 6832) <= *(_DWORD *)(a1 + 6868))
          {
            LOBYTE(a2) = 0;
            v11 = *(_DWORD *)(a1 + 6864);
            *(_DWORD *)(*(_QWORD *)(a1 + 6856) + 8) = v11;
            *(_DWORD *)(a1 + 6828) = v11;
            v7 = 145;
          }
          else
          {
            v7 = 146;
            LOBYTE(a2) = 31;
          }
          goto LABEL_22;
        }
        if ((a2 & 0xFFFFFFFD) != 0xB5 && (a2 & 0xFFFFFFFB) != 178 && (unsigned __int16)(a2 - 186) < 0xFFFEu)
          LOBYTE(a2) = -1;
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"LibNfc Stack Shut Down in progress");
    }
    v7 = 146;
LABEL_22:
    *(_BYTE *)(a1 + 2886) = 0;
LABEL_23:
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v7, a2, 0, 0);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Ndef_WriteNdefRsp_Cb");
}

uint64_t sub_2198BCA8C(uint64_t a1)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ClearNdefInfo");
  if (a1)
    *(_BYTE *)(a1 + 6872) = 2;
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ClearNdefInfo");
}

uint64_t sub_2198BCAEC(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Pending_Ndeftransv_Cb");
  if (a1)
  {
    phOsalNfc_SetMemory();
    if (*(_QWORD *)(a1 + 6136))
    {
      if (*(_QWORD *)(a1 + 6264))
      {
        v2 = *(_QWORD *)(a1 + 6272);
        sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 23, (uint64_t)"phLibNfc_Pending_Ndeftransv_Cb");
        (*(void (**)(_QWORD, uint64_t, _QWORD, _QWORD, uint64_t))(a1 + 6264))(*(_QWORD *)(a1 + 19360), v2, 0, 0, 145);
      }
      else if (*(_QWORD *)(a1 + 6360))
      {
        v3 = *(_QWORD *)(a1 + 6368);
        sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 24, (uint64_t)"phLibNfc_Pending_Ndeftransv_Cb");
        (*(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 6360))(*(_QWORD *)(a1 + 19360), v3, 145);
      }
      else if (*(_QWORD *)(a1 + 6376))
      {
        v4 = *(_QWORD *)(a1 + 6384);
        sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 25, (uint64_t)"phLibNfc_Pending_Ndeftransv_Cb");
        (*(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 6376))(*(_QWORD *)(a1 + 19360), v4, 145);
      }
      else if (*(_QWORD *)(a1 + 6392))
      {
        *(_BYTE *)(a1 + 19372) = 0;
        v5 = *(_QWORD *)(a1 + 6400);
        sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 27, (uint64_t)"phLibNfc_Pending_Ndeftransv_Cb");
        (*(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 6392))(*(_QWORD *)(a1 + 19360), v5, 145);
      }
      else if (*(_QWORD *)(a1 + 6408))
      {
        v7 = *(_QWORD *)(a1 + 6416);
        sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 29, (uint64_t)"phLibNfc_Pending_Ndeftransv_Cb");
        (*(void (**)(_QWORD, uint64_t, _QWORD, _QWORD, uint64_t))(a1 + 6408))(*(_QWORD *)(a1 + 19360), v7, 0, 0, 145);
      }
    }
  }
  else
  {
    phOsalNfc_SetMemory();
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_Pending_Ndeftransv_Cb");
  return 0;
}

uint64_t sub_2198BCCEC(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeInit");
  if (a1)
  {
    *(_WORD *)(a1 + 2784) = 0;
    v2 = sub_2198C1334(a1, *(_QWORD *)(a1 + 2776), a1 + 2712, 0);
    if ((_DWORD)v2 == 13)
      v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), a1 + 2712, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeInit");
  return v2;
}

uint64_t sub_2198BCDA0(uint64_t a1, int a2, unsigned __int8 **a3)
{
  uint64_t v6;
  unsigned int v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeResp");
  v6 = 255;
  if (a1 && !a2 && a3)
  {
    v7 = sub_2198C1334(a1, *(_QWORD *)(a1 + 2776), a1 + 2712, a3);
    if (**(_DWORD **)(a1 + 2776) == 5)
      v6 = v7;
    else
      v6 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeResp");
  return v6;
}

uint64_t sub_2198BCE3C(uint64_t a1)
{
  uint64_t v2;
  int *v4;
  uint64_t v5;
  int v6;
  __int16 v7;
  int v8;
  uint64_t v9;
  int v10;
  _OWORD v11[2];
  __int128 v12;
  __int128 v13;
  uint64_t v14;

  v14 = 0;
  v12 = 0u;
  v13 = 0u;
  memset(v11, 0, sizeof(v11));
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeMoreInfo");
  if (!a1)
    goto LABEL_4;
  if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    *(_QWORD *)(a1 + 1456) = 0;
    *(_QWORD *)(a1 + 1464) = 0;
LABEL_4:
    v2 = 1;
    goto LABEL_5;
  }
  v4 = (int *)(a1 + 1486);
  v5 = *(_QWORD *)(a1 + 1456);
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  v2 = 0;
  *(_QWORD *)&v13 = a1 + 2016;
  DWORD2(v13) = 530;
  v6 = **(_DWORD **)(a1 + 2776);
  switch(v6)
  {
    case 5:
      *(_WORD *)(a1 + 1486) = 26;
      LODWORD(v11[0]) = 0;
      *(_QWORD *)&v12 = a1 + 1486;
      DWORD2(v12) = 2;
      sub_2198BF34C(a1, *(_DWORD *)(v5 + 4), (uint64_t)v11, a1 + 2712);
      v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), v5, a1 + 2712, (uint64_t)sub_219865DD0, a1);
      if ((_DWORD)v2 == 13)
        *(_BYTE *)(a1 + 2786) = 1;
      break;
    case 6:
    case 7:
    case 8:
    case 9:
    case 10:
    case 12:
    case 13:
    case 16:
    case 17:
    case 20:
    case 21:
    case 24:
    case 25:
      break;
    case 11:
    case 19:
      v7 = 32680;
      goto LABEL_10;
    case 14:
    case 22:
      v8 = 20987760;
      goto LABEL_12;
    case 15:
    case 23:
      v7 = -88;
LABEL_10:
      *(_WORD *)(a1 + 1486) = v7;
      *(_BYTE *)(a1 + 1488) = 0;
      LODWORD(v11[0]) = 0;
      *(_QWORD *)&v12 = a1 + 1486;
      DWORD2(v12) = 19;
      *(_BYTE *)(a1 + 2784) = 1;
      v9 = a1 + 2712;
      v10 = *(_DWORD *)(v5 + 4);
      goto LABEL_14;
    case 18:
    case 26:
      v8 = 20991856;
LABEL_12:
      *v4 = v8;
      *(_BYTE *)(a1 + 1490) = 0;
      LODWORD(v11[0]) = 0;
      *(_QWORD *)&v12 = a1 + 1486;
      DWORD2(v12) = 5;
      *(_BYTE *)(a1 + 2784) = 4;
      goto LABEL_13;
    default:
      if (v6 != 54)
        break;
      *v4 = 24720;
      *(_BYTE *)(a1 + 1490) = 0;
      LODWORD(v11[0]) = 0;
      *(_QWORD *)&v12 = a1 + 1486;
      DWORD2(v12) = 5;
LABEL_13:
      v10 = *(_DWORD *)(v5 + 4);
      v9 = a1 + 2712;
LABEL_14:
      sub_2198BF34C(a1, v10, (uint64_t)v11, v9);
      v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), v5, v9, (uint64_t)sub_219865DD0, a1);
      break;
  }
LABEL_5:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeMoreInfo");
  return v2;
}

uint64_t sub_2198BD08C(uint64_t a1, int a2, uint64_t a3)
{
  unsigned __int8 *v6;
  unsigned int v7;
  int v8;
  int *v9;
  uint64_t v10;
  uint64_t v11;
  int v12;
  int v13;
  int v15;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeMoreInfoResp");
  if (!a1)
    goto LABEL_18;
  if (a2 || !a3 || (v6 = *(unsigned __int8 **)a3) == 0)
  {
    **(_DWORD **)(a1 + 2776) = 55;
LABEL_18:
    v11 = 255;
    goto LABEL_19;
  }
  v7 = *(_DWORD *)(a3 + 8);
  if (!v7)
  {
    v9 = *(int **)(a1 + 2776);
    LODWORD(v10) = *v9;
    if (*v9 == 54)
      goto LABEL_39;
LABEL_27:
    if ((int)v10 > 22)
    {
      if ((_DWORD)v10 == 23)
      {
        v15 = 19;
      }
      else
      {
        if ((_DWORD)v10 != 26)
          goto LABEL_34;
        v15 = 22;
      }
    }
    else if ((_DWORD)v10 == 15)
    {
      v15 = 11;
    }
    else
    {
      if ((_DWORD)v10 != 18)
        goto LABEL_34;
      v15 = 14;
    }
    *v9 = v15;
    sub_219866158(a1, *(_QWORD *)(a1 + 2912), 1u);
    goto LABEL_39;
  }
  v8 = *v6;
  v9 = *(int **)(a1 + 2776);
  v10 = *v9;
  if (v8 != 144)
  {
    if ((_DWORD)v10 == 54)
      goto LABEL_10;
    goto LABEL_23;
  }
  if (v10 > 0x36)
    goto LABEL_23;
  if (((1 << v10) & 0x4CCC800) != 0)
    goto LABEL_39;
  if (v10 != 54)
  {
LABEL_23:
    if (v7 >= 8 && v8 == 175 && (_DWORD)v10 == 5)
    {
      v11 = 0;
      v13 = 7;
      goto LABEL_35;
    }
    goto LABEL_27;
  }
LABEL_10:
  if (v7 < 9)
    goto LABEL_39;
  v11 = 0;
  if (v8 == 4 && v6[8] == 175)
  {
    v12 = v6[1];
    if (v12 != 4)
    {
      if (v12 == 8 && v6[5] == 19)
      {
        v11 = 0;
        v13 = 53;
LABEL_35:
        *v9 = v13;
        goto LABEL_19;
      }
LABEL_39:
      v11 = 0;
      goto LABEL_19;
    }
LABEL_34:
    v11 = 0;
    v13 = 55;
    goto LABEL_35;
  }
LABEL_19:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeMoreInfoResp");
  return v11;
}

uint64_t sub_2198BD258(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  unsigned int v4;
  BOOL v5;
  int v6;
  _OWORD v9[2];
  __int128 v10;
  __int128 v11;
  uint64_t v12;
  _BYTE v13[19];
  uint64_t v14;

  v14 = *MEMORY[0x24BDAC8D0];
  v12 = 0;
  v10 = 0u;
  v11 = 0u;
  memset(v9, 0, sizeof(v9));
  *(_OWORD *)v13 = xmmword_21990AD6B;
  *(_DWORD *)&v13[15] = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CheckMfpEVxSl");
  if (!a1)
    goto LABEL_4;
  if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    *(_QWORD *)(a1 + 1456) = 0;
    *(_QWORD *)(a1 + 1464) = 0;
LABEL_4:
    v2 = 1;
    goto LABEL_10;
  }
  v3 = *(_QWORD *)(a1 + 1456);
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  *(_QWORD *)&v11 = a1 + 2016;
  DWORD2(v11) = 530;
  v4 = **(_DWORD **)(a1 + 2776);
  v5 = v4 > 0x1A;
  v6 = (1 << v4) & 0x4CCC800;
  if (v5 || v6 == 0)
  {
    v2 = 0;
  }
  else
  {
    phOsalNfc_MemCopy();
    LODWORD(v9[0]) = 0;
    *(_QWORD *)&v10 = a1 + 1486;
    DWORD2(v10) = 19;
    sub_2198BF34C(a1, *(_DWORD *)(v3 + 4), (uint64_t)v9, a1 + 2712);
    v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), v3, a1 + 2712, (uint64_t)sub_219865DD0, a1);
  }
LABEL_10:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CheckMfpEVxSl");
  return v2;
}

uint64_t sub_2198BD410(uint64_t a1, uint64_t a2, unsigned __int8 **a3)
{
  int v6;
  char v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CheckMfpEVxSlResp");
  if (a1)
  {
    if (!(_DWORD)a2 && a3)
    {
      if (*a3 && *(_QWORD *)(a1 + 2776) && *((_DWORD *)a3 + 2))
      {
        v6 = **a3;
        if (v6 == 144)
        {
          v7 = 1;
          goto LABEL_14;
        }
        if (v6 == 11)
        {
          v7 = 4;
LABEL_14:
          a2 = 0;
          *(_BYTE *)(a1 + 2784) = v7;
          goto LABEL_12;
        }
      }
      a2 = 0;
    }
  }
  else
  {
    a2 = 255;
  }
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CheckMfpEVxSlResp");
  return a2;
}

uint64_t sub_2198BD4D4(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  char v4;
  unsigned int v5;
  _OWORD v7[2];
  __int128 v8;
  __int128 v9;
  uint64_t v10;

  v10 = 0;
  v8 = 0u;
  v9 = 0u;
  memset(v7, 0, sizeof(v7));
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CheckTagTypeMfpEV1");
  if (!a1)
    goto LABEL_4;
  if (!sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    v3 = *(_QWORD *)(a1 + 1456);
    v4 = *(_BYTE *)(v3 + 96);
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
    v2 = 0;
    *(_QWORD *)&v9 = a1 + 2016;
    DWORD2(v9) = 530;
    v5 = **(_DWORD **)(a1 + 2776);
    if (v5 > 0x1B)
      goto LABEL_11;
    if (((1 << v5) & 0x4CCC800) != 0)
      goto LABEL_7;
    if (((1 << v5) & 0x1111000) == 0)
    {
      if (v5 != 27)
        goto LABEL_11;
      if ((v4 & 0x20) != 0)
      {
LABEL_7:
        *(_BYTE *)(a1 + 1486) = 96;
        LODWORD(v7[0]) = 0;
        *(_QWORD *)&v8 = a1 + 1486;
        DWORD2(v8) = 1;
LABEL_10:
        sub_2198BF34C(a1, *(_DWORD *)(v3 + 4), (uint64_t)v7, a1 + 2712);
        v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), v3, a1 + 2712, (uint64_t)sub_219865DD0, a1);
        goto LABEL_11;
      }
      if ((v4 & 8) == 0)
      {
        v2 = 0;
        goto LABEL_11;
      }
    }
    *(_WORD *)(a1 + 1486) = 24578;
    LODWORD(v7[0]) = 0;
    *(_QWORD *)&v8 = a1 + 1486;
    DWORD2(v8) = 2;
    *(_BYTE *)(a1 + 2784) = 2;
    goto LABEL_10;
  }
  *(_QWORD *)(a1 + 1456) = 0;
  *(_QWORD *)(a1 + 1464) = 0;
LABEL_4:
  v2 = 1;
LABEL_11:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CheckTagTypeMfpEV1");
  return v2;
}

uint64_t sub_2198BD680(uint64_t a1, uint64_t a2, unsigned __int8 **a3)
{
  unsigned __int8 *v6;
  int *v7;
  int v8;
  int v9;
  int v10;
  int v11;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CheckTagTypeMfpEV1Resp");
  if (a1)
  {
    if (!(_DWORD)a2 && a3)
    {
      v6 = *a3;
      if (*a3)
      {
        v7 = *(int **)(a1 + 2776);
        if (v7)
        {
          v8 = *(unsigned __int8 *)(a1 + 2784);
          if (v8 == 4)
          {
            if (*((_DWORD *)a3 + 2) >= 8u && *v6 == 175 && v6[1] == 4)
            {
              v11 = v6[2];
              if ((v11 | 0x80) == 0x82)
              {
                if ((v6[4] & 0xF) == 1 && v6[6] == 22)
                {
                  v10 = 30;
                  goto LABEL_67;
                }
                if ((v11 | 0x80) == 0x82)
                {
                  if ((v6[4] & 0xF) == 1 && v6[6] == 24)
                  {
                    v10 = 33;
                    goto LABEL_67;
                  }
                  if ((v11 | 0x80) == 0x82)
                  {
                    if ((v6[4] & 0xF) == 2 && v6[6] == 22)
                    {
                      v10 = 36;
                      goto LABEL_67;
                    }
                    if ((v11 | 0x80) == 0x82 && (v6[4] & 0xF) == 2 && v6[6] == 24)
                    {
                      v10 = 39;
                      goto LABEL_67;
                    }
                  }
                }
              }
            }
          }
          else if (v8 == 2)
          {
            if (*((_DWORD *)a3 + 2) >= 9u && v6[1] == 175 && v6[2] == 4)
            {
              if ((v6[3] | 0x80) == 0x82 && (v6[5] & 0xF) == 1 && v6[7] == 22)
              {
                v10 = 29;
                goto LABEL_67;
              }
              if ((v6[3] | 0x80) == 0x82 && (v6[5] & 0xF) == 1 && v6[7] == 24)
              {
                v10 = 32;
                goto LABEL_67;
              }
              if ((v6[3] | 0x80) == 0x82 && (v6[5] & 0xF) == 2 && v6[7] == 22)
              {
                v10 = 35;
                goto LABEL_67;
              }
              if ((v6[3] | 0x80) == 0x82 && (v6[5] & 0xF) == 2 && v6[7] == 24)
              {
                v10 = 38;
                goto LABEL_67;
              }
            }
          }
          else if (v8 == 1 && *((_DWORD *)a3 + 2) >= 8u && *v6 == 175 && v6[1] == 4)
          {
            v9 = v6[2];
            if ((v9 | 0x80) == 0x82)
            {
              if ((v6[4] & 0xF) == 1 && v6[6] == 22)
              {
                v10 = 28;
LABEL_67:
                a2 = 0;
                *v7 = v10;
                goto LABEL_69;
              }
              if ((v9 | 0x80) == 0x82)
              {
                if ((v6[4] & 0xF) == 1 && v6[6] == 24)
                {
                  v10 = 31;
                  goto LABEL_67;
                }
                if ((v9 | 0x80) == 0x82)
                {
                  if ((v6[4] & 0xF) == 2 && v6[6] == 22)
                  {
                    v10 = 34;
                    goto LABEL_67;
                  }
                  if ((v9 | 0x80) == 0x82 && (v6[4] & 0xF) == 2 && v6[6] == 24)
                  {
                    v10 = 37;
                    goto LABEL_67;
                  }
                }
              }
            }
          }
        }
      }
      a2 = 0;
    }
  }
  else
  {
    a2 = 255;
  }
LABEL_69:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_CheckTagTypeMfpEV1Resp");
  return a2;
}

uint64_t sub_2198BD9F8(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  char v4;
  int v5;
  _OWORD v9[2];
  __int128 v10;
  __int128 v11;
  uint64_t v12;

  v12 = 0;
  v10 = 0u;
  v11 = 0u;
  memset(v9, 0, sizeof(v9));
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeselectCmdMfpSL1");
  if (!a1)
    goto LABEL_4;
  if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    *(_QWORD *)(a1 + 1456) = 0;
    *(_QWORD *)(a1 + 1464) = 0;
LABEL_4:
    v2 = 1;
    goto LABEL_18;
  }
  v3 = *(_QWORD *)(a1 + 1456);
  v4 = *(_BYTE *)(v3 + 96);
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  *(_QWORD *)&v11 = a1 + 2016;
  DWORD2(v11) = 530;
  v5 = **(_DWORD **)(a1 + 2776);
  if (v5 > 23)
  {
    switch(v5)
    {
      case 24:
      case 29:
      case 32:
        goto LABEL_17;
      case 27:
        if ((v4 & 8) == 0)
          goto LABEL_19;
        goto LABEL_17;
      default:
        goto LABEL_19;
    }
  }
  if (v5 != 12 && v5 != 16 && v5 != 20)
  {
LABEL_19:
    if (*(_BYTE *)(a1 + 2785) != 1 || (v5 | 2) != 3)
    {
      v2 = 0;
      goto LABEL_18;
    }
  }
LABEL_17:
  *(_BYTE *)(a1 + 1486) = -62;
  LODWORD(v9[0]) = 0;
  *(_QWORD *)&v10 = a1 + 1486;
  DWORD2(v10) = 1;
  sub_2198BF34C(a1, *(_DWORD *)(v3 + 4), (uint64_t)v9, a1 + 2712);
  v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), v3, a1 + 2712, (uint64_t)sub_219865DD0, a1);
LABEL_18:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeselectCmdMfpSL1");
  return v2;
}

uint64_t sub_2198BDBA0(uint64_t a1, uint64_t a2, _DWORD *a3)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeselectCmdMfpSL1Resp");
  if (a1)
  {
    if (!(_DWORD)a2 && a3)
    {
      if (*(_QWORD *)a3 && *(_QWORD *)(a1 + 2776) && a3[2] && *(unsigned __int8 *)(*(_QWORD *)a3 + 1) == 194)
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_DeselectCmdMfpSL1Resp : Deselect Cmd succeeded");
      a2 = 0;
    }
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"phLibNfc_DeselectCmdMfpSL1Resp : Invalid Lib Ctx");
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DeselectCmdMfpSL1Resp");
  return a2;
}

uint64_t sub_2198BDC80(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int *v6;
  int v7;
  char v8;
  uint64_t (**v9)();
  uint64_t (*v10)();
  unsigned int v11;
  uint64_t v12;
  uint64_t v13;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeSeqComplete");
  if (a1)
  {
    v6 = *(int **)(a1 + 2776);
    v7 = *v6;
    if ((_DWORD)a2 == 44 && v7 == 5)
    {
      *(_QWORD *)(a1 + 2912) = &qword_2550A2C68;
      *(_BYTE *)(a1 + 2904) = 0;
      *(_BYTE *)(a1 + 2906) = 0;
      v8 = qword_2550A2C68;
      if (qword_2550A2C68)
      {
        v8 = 0;
        v9 = off_2550A2C78;
        do
        {
          ++v8;
          v10 = *v9;
          v9 += 2;
        }
        while (v10);
      }
      *(_BYTE *)(a1 + 2905) = v8;
      LODWORD(a2) = sub_2198655FC(a1, 0, a3);
      if ((_DWORD)a2 == 13)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetTagTypeSeqComplete ; Success");
        a2 = 0;
        goto LABEL_37;
      }
    }
    else
    {
      if ((_DWORD)a2 == 150 && v7 == 5)
        goto LABEL_22;
      if ((_DWORD)a2 == 44 && v7 == 40)
      {
        *v6 = 54;
        goto LABEL_22;
      }
      if (*(_BYTE *)(a1 + 2785) == 1 && (v7 | 2) == 3)
      {
        *(_BYTE *)(a1 + 2785) = 0;
        goto LABEL_22;
      }
    }
    if ((_DWORD)a2)
    {
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_GetTagTypeSeqComplete : Failed with Status code");
      if ((_DWORD)a2 == 10)
      {
        v11 = sub_21990201C(*(_QWORD *)(a1 + 3040));
        if (v11 <= 1)
          v12 = 10;
        else
          v12 = v11;
      }
      else if ((a2 & 0xFFFFFFFD) == 0xB5 || (a2 & 0xFFFFFFFB) == 178 || (a2 & 0xFFFE) == 184 || (_DWORD)a2 == 143)
      {
        v12 = a2;
      }
      else
      {
        v12 = 255;
      }
      **(_DWORD **)(a1 + 2776) = 55;
      v13 = 146;
      goto LABEL_36;
    }
LABEL_22:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_GetTagTypeSeqComplete ; Success");
    v12 = 0;
    v13 = 145;
LABEL_36:
    a2 = sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v13, v12, 0, 0);
  }
LABEL_37:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetTagTypeSeqComplete");
  return a2;
}

uint64_t sub_2198BDE98(uint64_t a1)
{
  uint64_t v2;
  uint64_t v4;
  _OWORD v5[2];
  __int128 v6;
  __int128 v7;
  uint64_t v8;

  v8 = 0;
  v6 = 0u;
  v7 = 0u;
  memset(v5, 0, sizeof(v5));
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetMfUlcReadPage");
  if (!a1)
    goto LABEL_4;
  if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    *(_QWORD *)(a1 + 1456) = 0;
    *(_QWORD *)(a1 + 1464) = 0;
LABEL_4:
    v2 = 255;
    goto LABEL_5;
  }
  v4 = *(_QWORD *)(a1 + 1456);
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  v2 = 0;
  *(_QWORD *)&v7 = a1 + 2016;
  DWORD2(v7) = 530;
  if (**(_DWORD **)(a1 + 2776) == 7)
  {
    *(_WORD *)(a1 + 1486) = 560;
    LODWORD(v5[0]) = 0;
    *(_QWORD *)&v6 = a1 + 1486;
    DWORD2(v6) = 2;
    sub_2198BF34C(a1, *(_DWORD *)(v4 + 4), (uint64_t)v5, a1 + 2712);
    v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), v4, a1 + 2712, (uint64_t)sub_219865DD0, a1);
  }
LABEL_5:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetMfUlcReadPage");
  return v2;
}

uint64_t sub_2198BDFE4(uint64_t a1, uint64_t a2, uint64_t a3)
{
  _DWORD *v6;
  _BYTE *v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetMfUlcReadPageResp");
  if (a1 && (v6 = *(_DWORD **)(a1 + 2776)) != 0)
  {
    *v6 = 7;
    if (!(_DWORD)a2 && a3)
    {
      v7 = *(_BYTE **)a3;
      if (*(_QWORD *)a3
        && *(_DWORD *)(a3 + 8) == 16
        && !v7[16]
        && v7[2] == 9
        && v7[4] == 225
        && v7[5] >= 0x10u
        && v7[6] == 18
        && !v7[7])
      {
        a2 = 0;
        *v6 = 8;
      }
      else
      {
        a2 = 0;
      }
    }
  }
  else
  {
    a2 = 255;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetMfUlcReadPageResp");
  return a2;
}

uint64_t sub_2198BE0D8(uint64_t a1, uint64_t a2, uint64_t a3)
{
  char v6;
  uint64_t (**v7)();
  uint64_t (*v8)();
  unsigned int v9;
  uint64_t v12;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MifareULTagTypeSeqComplete");
  if (a1)
  {
    if ((_DWORD)a2 == 44 && **(_DWORD **)(a1 + 2776) == 5)
    {
      if (*(_BYTE *)(a1 + 2786) != 1)
      {
        LODWORD(a2) = 44;
        goto LABEL_16;
      }
      *(_QWORD *)(a1 + 2912) = &qword_2550A2CD8;
      *(_BYTE *)(a1 + 2904) = 0;
      *(_BYTE *)(a1 + 2906) = 0;
      v6 = qword_2550A2CD8;
      if (qword_2550A2CD8)
      {
        v6 = 0;
        v7 = off_2550A2CE8;
        do
        {
          ++v6;
          v8 = *v7;
          v7 += 2;
        }
        while (v8);
      }
      *(_BYTE *)(a1 + 2905) = v6;
      a2 = sub_2198655FC(a1, 0, a3);
      if ((_DWORD)a2 == 13)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_MifareULTagTypeSeqComplete ; Success");
        a2 = 0;
        *(_BYTE *)(a1 + 2786) = 0;
        goto LABEL_28;
      }
    }
    if (!(_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"phLibNfc_MifareULTagTypeSeqComplete ; Success");
      v12 = 145;
      goto LABEL_27;
    }
    if ((_DWORD)a2 == 10)
    {
      v9 = sub_21990201C(*(_QWORD *)(a1 + 3040));
      if (v9 <= 1)
        a2 = 10;
      else
        a2 = v9;
LABEL_25:
      sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_MifareULTagTypeSeqComplete : Failed with Status code");
      **(_DWORD **)(a1 + 2776) = 55;
      v12 = 146;
LABEL_27:
      *(_BYTE *)(a1 + 2786) = 0;
      a2 = sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v12, a2, 0, 0);
      goto LABEL_28;
    }
LABEL_16:
    if ((unsigned __int16)(a2 - 186) >= 0xFFFBu || (_DWORD)a2 == 178 || (_DWORD)a2 == 121)
      a2 = a2;
    else
      a2 = 255;
    goto LABEL_25;
  }
LABEL_28:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MifareULTagTypeSeqComplete");
  return a2;
}

uint64_t sub_2198BE2B4(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4)
{
  uint64_t v7;
  unsigned int *v8;
  BOOL v9;
  unsigned int *v10;
  const char *v11;
  _DWORD *v13;
  int v14;
  uint64_t v15;
  _DWORD *v16;
  unsigned int *v17;
  unsigned int *v18;
  unsigned int *v19;
  _DWORD *v20;
  uint64_t v21;
  int v22;
  uint64_t v23;

  v23 = a1;
  v22 = 1;
  v20 = 0;
  v21 = 0;
  v19 = 0;
  sub_219850718(0, (unsigned int *)&v23, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_InternalConnect");
  v7 = sub_21987AB04(v23, &v19);
  v8 = v19;
  if ((_DWORD)v7)
    v9 = 1;
  else
    v9 = v19 == 0;
  if (v9)
    goto LABEL_13;
  if (!a2 || !a3)
  {
    v7 = 1;
    sub_219850628(0, (unsigned int *)&v23, 4u, 1u, (uint64_t)"Invalid input Parameter");
    goto LABEL_13;
  }
  *((_BYTE *)v19 + 1440) = 1;
  v21 = a2;
  if (sub_2198BE4E4((uint64_t)v8, &v21, &v20, 1))
  {
    v10 = v19 + 4842;
    v11 = "Mapping of LibNfc RemoteDev Handle to NCI RemoteDev Handle Failed";
LABEL_12:
    sub_219850628(1, v10, 4u, 1u, (uint64_t)v11);
    v7 = 149;
    goto LABEL_13;
  }
  if (sub_21987B7E4(v19, (uint64_t)v20))
  {
    v10 = v19 + 4842;
    v11 = "Validation of NCI RemoteDev Handle Failed";
    goto LABEL_12;
  }
  v13 = (_DWORD *)*((_QWORD *)v19 + 182);
  if (v20 == v13)
  {
    if (!v20)
    {
LABEL_24:
      sub_219850628(1, v19 + 4842, 4u, 1u, (uint64_t)"Connected Handle is not same as passed handle");
      v7 = 255;
      goto LABEL_13;
    }
    if (*((_DWORD **)v19 + 183) == v20)
    {
      v15 = sub_2198BE5D8((uint64_t)v19, v21, v20);
      goto LABEL_32;
    }
  }
  else if (!v20 || v13)
  {
    goto LABEL_24;
  }
  v14 = v20[4];
  if (v14 > 127)
  {
    if (v14 == 128 || v14 == 129)
      goto LABEL_30;
LABEL_27:
    v14 = 1;
    goto LABEL_30;
  }
  if (v14 == 4)
  {
    v14 = 2;
    goto LABEL_30;
  }
  if (v14 != 5)
    goto LABEL_27;
  v14 = 3;
LABEL_30:
  v22 = v14;
  v7 = sub_2198D89F4((uint64_t)v20, (_BYTE *)v19 + 712, (_BYTE *)v19 + 713);
  v17 = v19;
  v16 = v20;
  *((_QWORD *)v19 + 182) = v20;
  if ((_DWORD)v7)
    goto LABEL_33;
  v15 = sub_2198BE740(v21, (uint64_t)v16, &v22, (uint64_t)v17);
LABEL_32:
  v7 = v15;
LABEL_33:
  if ((_DWORD)v7 == 13)
  {
    v18 = v19;
    *((_QWORD *)v19 + 769) = a3;
    *((_QWORD *)v18 + 770) = a4;
  }
LABEL_13:
  sub_219850808(0, (unsigned int *)&v23, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_InternalConnect");
  return v7;
}

uint64_t sub_2198BE4E4(uint64_t a1, _QWORD *a2, _QWORD *a3, int a4)
{
  uint64_t v8;
  uint64_t v9;
  _QWORD *v10;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemoteDevHandle");
  v8 = 255;
  if (a1 && a2 && a3)
  {
    v9 = *(unsigned __int8 *)(a1 + 714);
    if (a4 == 1)
    {
      if (*(_BYTE *)(a1 + 714))
      {
        v10 = (_QWORD *)(a1 + 1200);
        while (*(v10 - 1) != *a2)
        {
          v10 += 2;
          if (!--v9)
            goto LABEL_14;
        }
        a2 = a3;
LABEL_16:
        v8 = 0;
        *a2 = *v10;
        goto LABEL_17;
      }
    }
    else if (*(_BYTE *)(a1 + 714))
    {
      v10 = (_QWORD *)(a1 + 1192);
      while (v10[1] != *a3)
      {
        v10 += 2;
        if (!--v9)
          goto LABEL_14;
      }
      goto LABEL_16;
    }
LABEL_14:
    v8 = 149;
  }
LABEL_17:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemoteDevHandle");
  return v8;
}

uint64_t sub_2198BE5D8(uint64_t a1, uint64_t a2, _DWORD *a3)
{
  uint64_t v6;
  int v7;
  unsigned int v8;
  uint64_t v9;
  int v11;

  v6 = 1;
  v11 = 1;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RfConnect_Twice");
  if (!a1 || !a2 || !a3)
    goto LABEL_23;
  v7 = a3[4];
  if (v7 > 127)
  {
    if (v7 == 128)
    {
      LODWORD(v6) = 128;
      goto LABEL_13;
    }
    if (v7 == 129)
    {
      LODWORD(v6) = 129;
      goto LABEL_13;
    }
    goto LABEL_20;
  }
  if (v7 == 4)
  {
    LODWORD(v6) = 2;
    v11 = 2;
    goto LABEL_21;
  }
  if (v7 != 5)
  {
LABEL_20:
    v11 = 1;
    if (v7 != 2)
      goto LABEL_14;
LABEL_21:
    v9 = sub_2198BFBD4(a1, a3, v6);
    goto LABEL_22;
  }
  LODWORD(v6) = 3;
LABEL_13:
  v11 = v6;
LABEL_14:
  if (!sub_2198D0904((unsigned int *)a1, (uint64_t)a3) || a3[1] == 25)
    goto LABEL_21;
  v8 = a3[4];
  v6 = 255;
  if (v8 <= 6 && ((1 << v8) & 0x4A) != 0)
  {
    v6 = sub_2198D89F4((uint64_t)a3, (_BYTE *)(a1 + 712), (_BYTE *)(a1 + 713));
    *(_QWORD *)(a1 + 1456) = a3;
    if (!(_DWORD)v6)
    {
      v9 = sub_2198BE740(a2, (uint64_t)a3, &v11, a1);
LABEL_22:
      v6 = v9;
    }
  }
LABEL_23:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RfConnect_Twice");
  return v6;
}

uint64_t sub_2198BE740(uint64_t a1, uint64_t a2, _DWORD *a3, uint64_t a4)
{
  uint64_t v8;
  int v9;
  char v10;
  uint64_t *v11;
  uint64_t v12;
  unsigned int v13;
  uint64_t v15;
  unsigned int *v16;

  sub_219850718(2, (unsigned int *)a4, 4u, 5u, (uint64_t)"phLibNfc_PrepareConnect");
  v8 = 1;
  if (a3 && a2 && a1 && a4)
  {
    if (*(_BYTE *)a2 == 1)
    {
      if (sub_2198D23DC(*(_QWORD *)(a4 + 19360)) == 5
        && **(_DWORD **)(a4 + 808) == 1
        && !*(_BYTE *)(a4 + 2885))
      {
        sub_2198BF078(a4, 0, (char *)a2);
        v8 = 0;
        goto LABEL_42;
      }
      v9 = *(_DWORD *)(a2 + 16);
      if (v9 != 3)
      {
        if (v9 == 138)
        {
          if (!*(_BYTE *)(a4 + 2885))
          {
            sub_219850628(1, (unsigned int *)(a4 + 19368), 4u, 2u, (uint64_t)"Starting timer for phLibNfc_RemoteDev_ConnectTimer_Cb");
            sub_2198EF82C(*(_DWORD *)(a4 + 19368), *(_QWORD *)(a4 + 1448));
            if (phOsalNfc_Timer_Start())
              goto LABEL_35;
            v15 = *(_QWORD *)(a4 + 1448);
            v16 = (unsigned int *)(a4 + 19368);
            goto LABEL_37;
          }
        }
        else if (v9 == 4 && !*(_BYTE *)(a4 + 2885))
        {
          if (sub_2198FFE8C(*(_QWORD *)(a4 + 3040), (uint64_t)sub_2198B3C10, a4) == 13)
            v8 = 13;
          else
            v8 = 255;
          goto LABEL_42;
        }
        goto LABEL_31;
      }
      if (*(_BYTE *)(a4 + 2885))
      {
LABEL_31:
        if (*(_DWORD *)(a2 + 4) != 23 && sub_2198D0904((unsigned int *)a4, a2) && !*(_BYTE *)(a4 + 2885))
        {
          v8 = sub_2198BEB14(a4, a1, a2);
          goto LABEL_42;
        }
        goto LABEL_34;
      }
      *(_QWORD *)(a4 + 2912) = &qword_2550A2B28;
      *(_BYTE *)(a4 + 2904) = 0;
      *(_BYTE *)(a4 + 2906) = 0;
      v10 = qword_2550A2B28;
      if (qword_2550A2B28)
      {
        v10 = 0;
        v11 = &qword_2550A2B38;
        do
        {
          ++v10;
          v12 = *v11;
          v11 += 2;
        }
        while (v12);
      }
      *(_BYTE *)(a4 + 2905) = v10;
      v13 = sub_2198655FC(a4, 0, 0);
      if (v13 == 143 || v13 == 13)
        v8 = v13;
      else
        v8 = 255;
    }
    else
    {
      if (*(_BYTE *)(a4 + 2885) && *(_BYTE *)(a4 + 714) == 1)
      {
LABEL_34:
        sub_2198EF82C(*(_DWORD *)(a4 + 19368), *(_QWORD *)(a4 + 1448));
        if (phOsalNfc_Timer_Start())
        {
LABEL_35:
          v8 = 255;
          goto LABEL_42;
        }
        v15 = *(_QWORD *)(a4 + 1448);
        v16 = (unsigned int *)(a4 + 19368);
LABEL_37:
        sub_21988629C(1, v16, v15, 4u, 4u, (uint64_t)"phLibNfc_PrepareConnect");
        v8 = 13;
        goto LABEL_42;
      }
      v8 = sub_2198FD114(*(_QWORD *)(a4 + 3040), a2, *a3, (uint64_t)sub_2198BF078, a4);
      if ((_DWORD)v8 == 13)
        *(_BYTE *)(a4 + 19352) = 1;
    }
  }
LABEL_42:
  sub_219850808(2, (unsigned int *)a4, 4u, 5u, (uint64_t)"phLibNfc_PrepareConnect");
  return v8;
}

uint64_t sub_2198BEA48(uint64_t a1, unsigned int *a2)
{
  char v3;
  uint64_t v4;
  unsigned int *v5;
  uint64_t v6;

  sub_21988629C(2, a2, a1, 4u, 4u, (uint64_t)"phLibNfc_RemoteDev_ConnectTimer_Cb");
  sub_219850718(2, a2, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ConnectTimer_Cb");
  if (!a2)
    goto LABEL_6;
  v3 = 0;
  v4 = 0;
  do
  {
    v5 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
    if ((v3 & 1) != 0)
      break;
    v3 = 1;
    v4 = 1;
  }
  while (v5 != a2);
  if (v5 == a2)
    v6 = 0;
  else
LABEL_6:
    v6 = 255;
  sub_2198BF078((uint64_t)a2, v6, 0);
  return sub_219850808(2, a2, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ConnectTimer_Cb");
}

uint64_t sub_2198BEB14(uint64_t a1, uint64_t a2, uint64_t a3)
{
  int v6;
  uint64_t v7;
  const char *v8;
  void *v9;
  unsigned int *v10;
  const char *v11;
  char v12;
  uint64_t *v13;
  uint64_t v14;
  uint64_t i;
  char v17;
  unsigned int v18;
  char v19;
  int v20;
  unsigned int v21;
  unsigned int v22;
  __int128 v23;
  __int128 v24;
  __int128 v25;
  __int128 v26;
  uint64_t v27;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InternalPrepareConnect");
  phOsalNfc_SetMemory();
  v6 = *(_DWORD *)(a2 + 4);
  v7 = 1;
  switch(v6)
  {
    case 11:
    case 13:
    case 14:
    case 15:
    case 19:
      v27 = 0;
      v25 = 0u;
      v26 = 0u;
      v23 = 0u;
      v24 = 0u;
      v8 = "phLibNfc_PrepareConnect_ISO14443_4A";
      sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrepareConnect_ISO14443_4A");
      phOsalNfc_SetMemory();
      LODWORD(v23) = 0;
      *(_QWORD *)&v26 = &unk_2550A4212;
      DWORD2(v26) = 2;
      v9 = &unk_253E467E0;
      goto LABEL_3;
    case 12:
    case 16:
      v27 = 0;
      v25 = 0u;
      v26 = 0u;
      v23 = 0u;
      v24 = 0u;
      v8 = "phLibNfc_PrepareConnect_MifareUL";
      sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrepareConnect_MifareUL");
      phOsalNfc_SetMemory();
      BYTE4(v23) = 2;
      BYTE10(v23) = 1;
      LODWORD(v23) = 48;
      *(_QWORD *)&v26 = &unk_2550A4239;
      DWORD2(v26) = 19;
      *(_QWORD *)&v25 = 0;
      DWORD2(v25) = 0;
      goto LABEL_7;
    case 18:
      v27 = 0;
      v25 = 0u;
      v26 = 0u;
      v23 = 0u;
      v24 = 0u;
      v8 = "phLibNfc_PrepareConnect_14443_3B";
      sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrepareConnect_14443_3B");
      phOsalNfc_SetMemory();
      LODWORD(v23) = 0;
      byte_2550A421C = 29;
      phOsalNfc_MemCopy();
      unk_2550A4221 = 3840;
      phOsalNfc_MemCopy();
      DWORD2(v25) = 13;
      *(_QWORD *)&v25 = &byte_2550A421C;
      *(_QWORD *)&v26 = &unk_2550A4214;
      DWORD2(v26) = 2;
      goto LABEL_7;
    case 21:
      v27 = 0;
      v25 = 0u;
      v26 = 0u;
      v23 = 0u;
      v24 = 0u;
      sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrepareConnect_Felica");
      for (i = 0; i != 8; ++i)
        *((_BYTE *)&unk_253E467E0 + i + 16) = *(_BYTE *)(a3 + 36 + i);
      phOsalNfc_SetMemory();
      LODWORD(v23) = 240;
      *(_QWORD *)&v26 = &unk_2550A424C;
      DWORD2(v26) = 27;
      *(_QWORD *)&v25 = &unk_253E467EE;
      DWORD2(v25) = 16;
      v7 = sub_2198BF34C(a1, *(_DWORD *)(a3 + 4), (uint64_t)&v23, a1 + 5328);
      v11 = "phLibNfc_PrepareConnect_Felica";
      goto LABEL_26;
    case 22:
      v27 = 0;
      v25 = 0u;
      v26 = 0u;
      v23 = 0u;
      v24 = 0u;
      v8 = "phLibNfc_PrepareConnect_Jewel";
      sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrepareConnect_Jewel");
      phOsalNfc_SetMemory();
      LODWORD(v23) = 0;
      *(_QWORD *)&v26 = &unk_2550A4216;
      DWORD2(v26) = 6;
      v9 = &unk_253E467E7;
LABEL_3:
      *(_QWORD *)&v25 = v9;
      DWORD2(v25) = 7;
LABEL_7:
      v7 = sub_2198BF34C(a1, *(_DWORD *)(a3 + 4), (uint64_t)&v23, a1 + 5328);
      v10 = (unsigned int *)a1;
      v11 = v8;
      goto LABEL_8;
    case 23:
      v27 = 0;
      v25 = 0u;
      v26 = 0u;
      v23 = 0u;
      v24 = 0u;
      sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PrepareConnect_Iso15693");
      phOsalNfc_SetMemory();
      v17 = 32 * (*(_BYTE *)(a3 + 44) != 0);
      if (*(_BYTE *)(a3 + 42) == 2)
      {
        v18 = ((32 * ((*(_BYTE *)(a3 + 41) & 0xFC) - 44)) | (((*(_BYTE *)(a3 + 41) & 0xFC)
                                                                                              - 44) >> 3));
        if (v18 <= 6 && ((1 << v18) & 0x59) != 0)
          v17 |= 8u;
      }
      v19 = v17 | 2;
      v20 = DWORD2(v25);
      v21 = DWORD2(v25) + 1;
      byte_2550A4229[DWORD2(v25)] = v19;
      v22 = v20 + 2;
      DWORD2(v25) = v22;
      byte_2550A4229[v21] = 32;
      if ((v19 & 0x20) != 0)
      {
        phOsalNfc_MemCopy();
        v22 = DWORD2(v25) + 8;
      }
      DWORD2(v25) = v22 + 1;
      *((_BYTE *)&unk_2550A4212 + v22 + 23) = 0;
      if ((v19 & 8) != 0)
      {
        DWORD2(v25) = v22 + 2;
        *((_BYTE *)&unk_2550A4212 + v22 + 24) = 0;
      }
      LODWORD(v23) = 0;
      *(_QWORD *)&v25 = byte_2550A4229;
      *(_QWORD *)&v26 = &unk_2550A4267;
      DWORD2(v26) = 38;
      v7 = sub_2198BF34C(a1, *(_DWORD *)(a3 + 4), (uint64_t)&v23, a1 + 5328);
      v11 = "phLibNfc_PrepareConnect_Iso15693";
LABEL_26:
      v10 = (unsigned int *)a1;
LABEL_8:
      sub_219850808(2, v10, 4u, 5u, (uint64_t)v11);
      if (!(_DWORD)v7)
      {
        *(_WORD *)(a1 + 5334) = 500;
        *(_QWORD *)(a1 + 2912) = off_2550A0E18;
        *(_BYTE *)(a1 + 2904) = 0;
        *(_BYTE *)(a1 + 2906) = 0;
        v12 = (char)off_2550A0E18[0];
        if (off_2550A0E18[0])
        {
          v12 = 0;
          v13 = &qword_2550A0E28;
          do
          {
            ++v12;
            v14 = *v13;
            v13 += 2;
          }
          while (v14);
        }
        *(_BYTE *)(a1 + 2905) = v12;
        v7 = sub_2198655FC(a1, 0, a1 + 5328);
      }
      break;
    default:
      break;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_InternalPrepareConnect");
  return v7;
}

uint64_t sub_2198BF078(uint64_t a1, uint64_t a2, char *a3)
{
  char *v6;
  unsigned int *v7;
  const char *v8;
  uint64_t v9;
  char *v10;
  char **v11;
  void (*v12)(_QWORD, uint64_t, char *, char *, uint64_t);
  uint64_t v13;
  char *v14;
  uint64_t v15;
  unsigned int v17;
  char v18;
  char *v19;
  char *v20;

  v19 = 0;
  v20 = 0;
  v18 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Connect_Cb");
  if (a1)
  {
    if ((_DWORD)a2 != 121)
    {
      if ((_DWORD)a2 == 10)
      {
        v11 = (char **)(a1 + 1456);
        if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
        {
          LODWORD(v10) = 0;
          *v11 = 0;
          *(_QWORD *)(a1 + 1464) = 0;
          v9 = 146;
          a2 = 10;
          v20 = 0;
          goto LABEL_20;
        }
        v10 = *v11;
        v20 = v10;
        if (!v10)
        {
          v9 = 146;
          a2 = 10;
          goto LABEL_20;
        }
        a2 = 10;
        if (*((_DWORD *)v10 + 1) == 20)
        {
          v17 = sub_21990201C(*(_QWORD *)(a1 + 3040));
          LODWORD(v10) = 0;
          if (v17 <= 1)
            a2 = 10;
          else
            a2 = v17;
        }
        else
        {
          LODWORD(v10) = 0;
        }
      }
      else
      {
        if (!(_DWORD)a2)
        {
          v6 = *(char **)(a1 + 1464);
          if (!v6)
          {
            *(_QWORD *)(a1 + 1464) = a3;
            v6 = a3;
          }
          v20 = v6;
          *(_QWORD *)(a1 + 1456) = v6;
          if (sub_2198BE4E4(a1, &v19, &v20, 0))
          {
            v7 = (unsigned int *)(a1 + 19368);
            v8 = "Mapping on NCI RemoteDev Handle to LibNfc RemoteDev Handle Failed";
          }
          else
          {
            if (!sub_2198D7B28(a1, (uint64_t)v19, (uint64_t)v20))
            {
              a2 = 0;
              LODWORD(v10) = 0;
              *v19 = *v20;
              *(_BYTE *)(a1 + 1483) = 0;
              v9 = 145;
              goto LABEL_20;
            }
            v7 = (unsigned int *)(a1 + 19368);
            v8 = "Getting LibNfc RemoteDev Info by using LibNfc RemoteDev Handle Failed";
          }
          sub_219850628(1, v7, 4u, 1u, (uint64_t)v8);
          LODWORD(v10) = 0;
          v9 = 146;
          a2 = 255;
LABEL_20:
          if (*(_BYTE *)(a1 + 1440) == 1
            && (v12 = *(void (**)(_QWORD, uint64_t, char *, char *, uint64_t))(a1 + 6152)) != 0)
          {
            v13 = *(_QWORD *)(a1 + 6160);
            *(_QWORD *)(a1 + 6152) = 0;
            *(_QWORD *)(a1 + 6160) = 0;
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Invoking upper layer callback");
            sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 15, (uint64_t)"phLibNfc_RemoteDev_Connect_Cb");
            v12(*(_QWORD *)(a1 + 19360), v13, v19, v19, a2);
            if (!(_DWORD)a2)
              goto LABEL_29;
          }
          else
          {
            if ((_DWORD)v10)
            {
              v14 = &v18;
              v9 = 150;
              v15 = a2;
            }
            else
            {
              v15 = a2;
              v14 = v19;
            }
            if (!sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v9, v15, (uint64_t)v19, (uint64_t)v14))
              goto LABEL_29;
          }
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_RemoteDev_Connect_Cb: Lower layer has returned failure status");
          *(_QWORD *)(a1 + 1456) = 0;
LABEL_29:
          *(_BYTE *)(a1 + 19352) = 0;
          return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Connect_Cb");
        }
        LODWORD(v10) = 0;
        if ((_DWORD)a2 == 143)
          a2 = 143;
        else
          a2 = 255;
      }
      v9 = 146;
      goto LABEL_20;
    }
    v9 = 150;
    LODWORD(v10) = 1;
    goto LABEL_20;
  }
  sub_219850628(2, 0, 4u, 1u, (uint64_t)"Lower layer has returned Invalid LibNfc context");
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_Connect_Cb");
}

uint64_t sub_2198BF34C(uint64_t a1, int a2, uint64_t a3, uint64_t a4)
{
  uint64_t v8;
  int v9;
  uint64_t v10;
  char v11;
  unsigned __int8 *v12;
  int v13;
  uint64_t v14;
  char v15;
  char v16;
  int v17;
  uint64_t v18;
  char v19;
  int *v20;
  int v21;
  char v22;
  uint64_t v23;
  uint64_t v24;
  const char *v25;
  char v27;
  char v28;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MapCmds");
  v8 = 1;
  if (a1 && a3 && a4)
  {
    v8 = 0;
    *(_WORD *)(a4 + 6) = *(_WORD *)(a3 + 6);
    switch(a2)
    {
      case 3:
      case 5:
      case 6:
      case 7:
      case 16:
        if (*(_QWORD *)(a3 + 32)
          && *(_DWORD *)(a3 + 40)
          && *(_QWORD *)(a3 + 48)
          && *(_DWORD *)(a3 + 56)
          && !*(_DWORD *)a3)
        {
          goto LABEL_45;
        }
        goto LABEL_46;
      case 4:
      case 8:
      case 9:
      case 10:
      case 11:
      case 12:
      case 13:
      case 14:
        v28 = 0;
        sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MifareMap");
        v9 = *(_DWORD *)a3;
        v8 = 1;
        if (*(int *)a3 > 127)
        {
          if (v9 <= 175)
          {
            if ((v9 - 128) < 2)
            {
              v28 = *(_BYTE *)(a3 + 4);
              sub_2198BFF98((unsigned int *)a1, &v28);
              *(_BYTE *)(a1 + 1486) = *(_DWORD *)a3;
              v15 = v28;
              *(_BYTE *)(a1 + 1487) = v28;
              if (*(_DWORD *)a3 == 129)
                v16 = *(_BYTE *)(a3 + 5) | 0x80;
              else
                v16 = *(_BYTE *)(a3 + 5);
              *(_BYTE *)(a1 + 1488) = v16;
              *(_QWORD *)(a4 + 16) = a1 + 1486;
              *(_DWORD *)(a4 + 24) = 3;
              *(_DWORD *)a4 = 4;
              *(_BYTE *)(a4 + 4) = v15;
              *(_BYTE *)(a4 + 5) = *(_BYTE *)(a3 + 10);
              *(_QWORD *)(a4 + 32) = *(_QWORD *)(a3 + 48);
              v17 = *(unsigned __int16 *)(a3 + 56);
              goto LABEL_83;
            }
            if (v9 == 160)
            {
              if (*(_QWORD *)(a3 + 32) && *(_DWORD *)(a3 + 40))
              {
                v10 = a1 + 1486;
                v11 = -96;
                goto LABEL_71;
              }
            }
            else if (v9 == 162 && *(_QWORD *)(a3 + 32) && *(_DWORD *)(a3 + 40))
            {
              v10 = a1 + 1486;
              v11 = -94;
LABEL_71:
              *(_BYTE *)(a1 + 1486) = v11;
              *(_BYTE *)(a1 + 1487) = *(_BYTE *)(a3 + 4);
              phOsalNfc_MemCopy();
              *(_QWORD *)(a4 + 16) = v10;
              *(_DWORD *)(a4 + 24) = *(_DWORD *)(a3 + 40) + 2;
              *(_DWORD *)a4 = 0;
              *(_QWORD *)(a4 + 32) = a1 + 2016;
              v17 = 530;
              goto LABEL_83;
            }
LABEL_89:
            v25 = "phLibNfc_MifareMap";
LABEL_90:
            sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)v25);
            break;
          }
          if ((v9 - 192) >= 3)
          {
            if (v9 != 176 || !*(_QWORD *)(a3 + 48) || !*(_DWORD *)(a3 + 56))
              goto LABEL_89;
            v18 = a1 + 1486;
            v19 = -80;
LABEL_65:
            *(_BYTE *)(a1 + 1486) = v19;
            *(_BYTE *)(a1 + 1487) = *(_BYTE *)(a3 + 4);
            *(_QWORD *)(a4 + 16) = v18;
            v13 = 2;
          }
          else
          {
            if (!*(_QWORD *)(a3 + 32) || !*(_DWORD *)(a3 + 40))
              goto LABEL_89;
            *(_BYTE *)(a1 + 1486) = v9;
            *(_BYTE *)(a1 + 1487) = *(_BYTE *)(a3 + 4);
            phOsalNfc_MemCopy();
            *(_QWORD *)(a4 + 16) = a1 + 1486;
            v13 = *(_DWORD *)(a3 + 40) + 2;
          }
          *(_DWORD *)(a4 + 24) = v13;
          *(_DWORD *)a4 = 0;
LABEL_67:
          *(_QWORD *)(a4 + 32) = *(_QWORD *)(a3 + 48);
          v17 = *(_DWORD *)(a3 + 56);
LABEL_83:
          *(_DWORD *)(a4 + 40) = v17;
          goto LABEL_84;
        }
        switch(v9)
        {
          case 0:
            if (*(_QWORD *)(a3 + 32) && *(_DWORD *)(a3 + 40) && *(_QWORD *)(a3 + 48) && *(_DWORD *)(a3 + 56))
            {
              *(_DWORD *)a4 = 0;
              *(_QWORD *)(a4 + 16) = *(_QWORD *)(a3 + 32);
              *(_QWORD *)(a4 + 32) = *(_QWORD *)(a3 + 48);
              *(_DWORD *)(a4 + 24) = *(_DWORD *)(a3 + 40);
              *(_DWORD *)(a4 + 40) = *(_DWORD *)(a3 + 56);
              if (!sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456))
                && *(_DWORD *)(*(_QWORD *)(a1 + 1456) + 4) == 8)
              {
                v12 = *(unsigned __int8 **)(a3 + 32);
                if (*v12 == 194 && v12[1] == 255)
                  *(_BYTE *)(a1 + 1482) = 3;
              }
              goto LABEL_84;
            }
            goto LABEL_89;
          case 1:
            if (*(_QWORD *)(a3 + 48))
            {
              v20 = (int *)(a3 + 56);
              if (*(_DWORD *)(a3 + 56))
              {
                v21 = 2;
                goto LABEL_81;
              }
            }
            goto LABEL_89;
          case 2:
            if (*(_QWORD *)(a3 + 32) && *(_DWORD *)(a3 + 40))
            {
              *(_DWORD *)a4 = 1;
              *(_BYTE *)(a4 + 4) = *(_BYTE *)(a3 + 4);
              *(_QWORD *)(a4 + 16) = *(_QWORD *)(a3 + 32);
              *(_DWORD *)(a4 + 24) = *(_DWORD *)(a3 + 40);
              *(_QWORD *)(a4 + 32) = *(_QWORD *)(a3 + 48);
              v20 = (int *)(a3 + 56);
              goto LABEL_82;
            }
            goto LABEL_89;
          case 3:
            if (*(_QWORD *)(a3 + 48))
            {
              v20 = (int *)(a3 + 56);
              if (*(_DWORD *)(a3 + 56))
              {
                v21 = 3;
LABEL_81:
                *(_DWORD *)a4 = v21;
                *(_BYTE *)(a4 + 4) = *(_BYTE *)(a3 + 4);
                *(_BYTE *)(a4 + 5) = *(_BYTE *)(a3 + 10);
                *(_QWORD *)(a4 + 16) = *(_QWORD *)(a3 + 32);
                *(_DWORD *)(a4 + 24) = *(_DWORD *)(a3 + 40);
                *(_QWORD *)(a4 + 32) = *(_QWORD *)(a3 + 48);
LABEL_82:
                v17 = *v20;
                goto LABEL_83;
              }
            }
            goto LABEL_89;
          default:
            if ((v9 - 96) >= 2)
            {
              if (v9 == 48 && *(_QWORD *)(a3 + 48) && *(_DWORD *)(a3 + 56))
              {
                v18 = a1 + 1486;
                v19 = 48;
                goto LABEL_65;
              }
              goto LABEL_89;
            }
            if (!*(_QWORD *)(a3 + 32) || !*(_DWORD *)(a3 + 40))
              goto LABEL_89;
            sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ChkT2Ttag");
            v14 = a1 + 1456;
            if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
            {
              *(_QWORD *)v14 = 0;
              *(_QWORD *)(a1 + 1464) = 0;
            }
            else if (*(_DWORD *)(*(_QWORD *)v14 + 16) == 2 && !*(_BYTE *)(*(_QWORD *)v14 + 96))
            {
              sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ChkT2Ttag");
              *(_WORD *)(a1 + 1486) = 26;
              *(_QWORD *)(a4 + 16) = a1 + 1486;
              *(_DWORD *)(a4 + 24) = 2;
              *(_QWORD *)(a4 + 32) = *(_QWORD *)(a3 + 48);
              *(_DWORD *)(a4 + 40) = *(_DWORD *)(a3 + 56);
              *(_DWORD *)a4 = 0;
LABEL_84:
              v22 = 0;
              v23 = 0;
              do
              {
                v24 = *((_QWORD *)&unk_253E46700 + 14 * v23 + 2);
                if ((v22 & 1) != 0)
                  break;
                v22 = 1;
                v23 = 1;
              }
              while (v24 != a1);
              v8 = 0;
              if (v24 == a1)
                *(_BYTE *)(a1 + 1481) = *(_DWORD *)a4;
              goto LABEL_89;
            }
            sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ChkT2Ttag");
            sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ChkAuthCmdMFC");
            if (!*(_QWORD *)(a3 + 32) || !*(_DWORD *)(a3 + 40))
              goto LABEL_106;
            if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
            {
              *(_QWORD *)v14 = 0;
              *(_QWORD *)(a1 + 1464) = 0;
            }
            else if (*(_QWORD *)v14 && (*(_DWORD *)a3 & 0xFFFFFFFE) == 0x60 && *(_DWORD *)(a3 + 40) == 10)
            {
              phOsalNfc_MemCopy();
              if (!phOsalNfc_MemCompare())
              {
                sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ChkAuthCmdMFC");
                v28 = *(_BYTE *)(a3 + 4);
                sub_2198BFF98((unsigned int *)a1, &v28);
                *(_BYTE *)(a1 + 1486) = *(_DWORD *)a3;
                *(_BYTE *)(a1 + 1487) = v28;
                if (*(_DWORD *)a3 == 97)
                  v27 = -112;
                else
                  v27 = 16;
                *(_BYTE *)(a1 + 1488) = v27;
                phOsalNfc_MemCopy();
                *(_QWORD *)(a4 + 16) = a1 + 1486;
                *(_DWORD *)(a4 + 24) = 9;
                *(_DWORD *)a4 = 4;
                *(_BYTE *)(a4 + 4) = v28;
                *(_BYTE *)(a4 + 5) = *(_BYTE *)(a3 + 10);
                goto LABEL_67;
              }
              sub_2198EF82C(*(_DWORD *)(a1 + 19368), *(_QWORD *)(a1 + 1448));
              if (!phOsalNfc_Timer_Start())
                sub_21988629C(1, (unsigned int *)(a1 + 19368), *(_QWORD *)(a1 + 1448), 4u, 4u, (uint64_t)"phLibNfc_ChkAuthCmdMFC");
            }
LABEL_106:
            sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ChkAuthCmdMFC");
            goto LABEL_84;
        }
      case 18:
        if (*(_QWORD *)(a3 + 32)
          && *(_DWORD *)(a3 + 40)
          && *(_QWORD *)(a3 + 48)
          && *(_DWORD *)(a3 + 56)
          && *(_DWORD *)a3 == 240)
        {
LABEL_45:
          v8 = 0;
          *(_DWORD *)a4 = 0;
LABEL_34:
          *(_QWORD *)(a4 + 16) = *(_QWORD *)(a3 + 32);
          *(_QWORD *)(a4 + 32) = *(_QWORD *)(a3 + 48);
          *(_DWORD *)(a4 + 24) = *(_DWORD *)(a3 + 40);
          *(_DWORD *)(a4 + 40) = *(_DWORD *)(a3 + 56);
        }
        else
        {
LABEL_46:
          v8 = 1;
        }
        break;
      case 19:
        sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_JewelMap");
        if (*(_DWORD *)a3)
        {
          if (*(_DWORD *)a3 == 1 && *(_QWORD *)(a3 + 32))
          {
            v8 = 1;
            if (!*(_DWORD *)(a3 + 40))
              goto LABEL_99;
            *(_DWORD *)a4 = 1;
            *(_BYTE *)(a4 + 4) = *(_BYTE *)(a3 + 4);
            *(_BYTE *)(a4 + 5) = *(_BYTE *)(a3 + 10);
            *(_QWORD *)(a4 + 16) = *(_QWORD *)(a3 + 32);
            *(_DWORD *)(a4 + 24) = *(_DWORD *)(a3 + 40);
            goto LABEL_97;
          }
        }
        else if (*(_QWORD *)(a3 + 32) && *(_DWORD *)(a3 + 40) && *(_QWORD *)(a3 + 48) && *(_DWORD *)(a3 + 56))
        {
          *(_DWORD *)a4 = 0;
          *(_QWORD *)(a4 + 16) = *(_QWORD *)(a3 + 32);
          *(_QWORD *)(a4 + 32) = *(_QWORD *)(a3 + 48);
          *(_DWORD *)(a4 + 24) = *(_DWORD *)(a3 + 40);
          *(_DWORD *)(a4 + 40) = *(_DWORD *)(a3 + 56);
LABEL_97:
          v8 = 0;
          *(_BYTE *)(a4 + 48) = 0;
          goto LABEL_99;
        }
        v8 = 1;
LABEL_99:
        v25 = "phLibNfc_JewelMap";
        goto LABEL_90;
      case 20:
        v8 = sub_2198625B4((unsigned int *)a1, a3, a4);
        break;
      case 23:
      case 25:
        v8 = 0;
        goto LABEL_34;
      default:
        break;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MapCmds");
  return v8;
}

uint64_t sub_2198BFBD4(uint64_t a1, _DWORD *a2, int a3)
{
  int v6;
  char v7;
  uint64_t (**v8)();
  uint64_t (*v9)();
  char v10;
  uint64_t (**v11)();
  uint64_t (*v12)();
  uint64_t v13;
  uint64_t (**v14)();
  uint64_t (*v15)();
  uint64_t *v17;
  uint64_t v18;
  uint64_t (**v19)();
  uint64_t (*v20)();

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ReActivate");
  if (!a1 || !a2)
  {
    v13 = 1;
    sub_219850628(2, (unsigned int *)a1, 4u, 1u, (uint64_t)"Invalid input Parameter");
    goto LABEL_24;
  }
  *(_BYTE *)(a1 + 1472) = 1;
  *(_DWORD *)(a1 + 1476) = a3;
  v6 = a2[4];
  if (v6 == 2)
  {
    *(_QWORD *)(a1 + 2912) = &qword_2550A2BD8;
    *(_BYTE *)(a1 + 2904) = 0;
    *(_BYTE *)(a1 + 2906) = 0;
    v10 = qword_2550A2BD8;
    if (qword_2550A2BD8)
    {
      v10 = 0;
      v14 = off_2550A2BE8;
      do
      {
        ++v10;
        v15 = *v14;
        v14 += 2;
      }
      while (v15);
    }
    goto LABEL_19;
  }
  if (v6 == 4)
  {
    *(_QWORD *)(a1 + 2912) = &qword_2550A2B68;
    *(_BYTE *)(a1 + 2904) = 0;
    *(_BYTE *)(a1 + 2906) = 0;
    v7 = qword_2550A2B68;
    if (qword_2550A2B68)
    {
      v7 = 0;
      v8 = off_2550A2B78;
      do
      {
        ++v7;
        v9 = *v8;
        v8 += 2;
      }
      while (v9);
    }
    *(_BYTE *)(a1 + 2905) = v7;
  }
  if (a2[3] == 1 || a2[1] == 25)
  {
    *(_QWORD *)(a1 + 2912) = &qword_2550A2B98;
    *(_BYTE *)(a1 + 2904) = 0;
    *(_BYTE *)(a1 + 2906) = 0;
    v10 = qword_2550A2B98;
    if (qword_2550A2B98)
    {
      v10 = 0;
      v11 = off_2550A2BA8;
      do
      {
        ++v10;
        v12 = *v11;
        v11 += 2;
      }
      while (v12);
    }
LABEL_19:
    *(_BYTE *)(a1 + 2905) = v10;
    goto LABEL_20;
  }
  if (!sub_2198D0904((unsigned int *)a1, (uint64_t)a2))
  {
    if (*(_BYTE *)(a1 + 1483) == 1)
    {
      *(_QWORD *)(a1 + 2912) = &qword_2550A0E38;
      *(_BYTE *)(a1 + 2904) = 0;
      *(_BYTE *)(a1 + 2906) = 0;
      v10 = qword_2550A0E38;
      if (qword_2550A0E38)
      {
        v10 = 0;
        v17 = &qword_2550A0E48;
        do
        {
          ++v10;
          v18 = *v17;
          v17 += 2;
        }
        while (v18);
      }
    }
    else
    {
      *(_QWORD *)(a1 + 2912) = &qword_2550A2BD8;
      *(_BYTE *)(a1 + 2904) = 0;
      *(_BYTE *)(a1 + 2906) = 0;
      v10 = qword_2550A2BD8;
      if (qword_2550A2BD8)
      {
        v10 = 0;
        v19 = off_2550A2BE8;
        do
        {
          ++v10;
          v20 = *v19;
          v19 += 2;
        }
        while (v20);
      }
    }
    goto LABEL_19;
  }
LABEL_20:
  v13 = sub_2198655FC(a1, 0, 0);
  if ((_DWORD)v13 != 13)
  {
    sub_219851790(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Reactivate 4A request Failed!! wStatus");
    if ((_DWORD)v13 == 143)
      v13 = 143;
    else
      v13 = 255;
  }
LABEL_24:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ReActivate");
  return v13;
}

uint64_t sub_2198BFE30(uint64_t a1, uint64_t a2, uint64_t a3)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendTranscvCmd");
  if (a1)
    a2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), a3, (uint64_t)sub_219865DD0, a1);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendTranscvCmd");
  return a2;
}

uint64_t sub_2198BFEBC(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetTranscvResp");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_GetTranscvResp");
  return a2;
}

uint64_t sub_2198BFF20(unsigned int *a1, uint64_t a2, char *a3)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_InvokeNciTranscvComplete");
  sub_2198BF078((uint64_t)a1, a2, a3);
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_InvokeNciTranscvComplete");
  return a2;
}

uint64_t sub_2198BFF98(unsigned int *a1, _BYTE *a2)
{
  unsigned int v4;
  int v5;
  unsigned int v6;
  unsigned int v7;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_CalSectorAddress");
  if (a2)
  {
    v4 = *a2;
    v5 = (char)v4;
    v6 = ((v4 + 3968) >> 4) + 32;
    v7 = v4 >> 2;
    if (v5 < 0)
      LOBYTE(v7) = v6;
    *a2 = v7;
  }
  return sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_CalSectorAddress");
}

uint64_t sub_2198C0014(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  void (*v6)(_QWORD, uint64_t, uint64_t);
  uint64_t v7;
  void (*v8)(_QWORD, uint64_t, _QWORD, uint64_t, uint64_t);
  uint64_t v9;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IsoDepFelicaPresChk_Cb");
  if (!a1)
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IsoDepFelicaPresChk_Cb");
  if ((int)a2 > 146)
  {
    switch((_DWORD)a2)
    {
      case 0x93:
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Nfcc rejected pres chk command sent");
LABEL_14:
        v4 = 146;
        a2 = 255;
        v5 = 255;
        goto LABEL_19;
      case 0xBA:
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Host reader mode prohibit timer is running");
        v4 = 146;
        v5 = 186;
        break;
      case 0xBB:
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Host reader mode SE Initialization required");
        v4 = 146;
        v5 = 187;
        break;
      default:
        goto LABEL_17;
    }
    a2 = 255;
  }
  else
  {
    if ((_DWORD)a2)
    {
      if ((_DWORD)a2 != 44)
      {
        if ((_DWORD)a2 == 146)
        {
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Target is no more in the Rf field");
LABEL_18:
          v5 = 146;
          v4 = 146;
          goto LABEL_19;
        }
LABEL_17:
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"pres chk failed");
        a2 = 146;
        goto LABEL_18;
      }
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"NFCC not responded for Iso-Dep pres chk command");
      goto LABEL_14;
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Target is still in the Rf field");
    v5 = 0;
    v4 = 145;
    a2 = 152;
  }
LABEL_19:
  if (*(_BYTE *)(a1 + 1441) == 1 && (v6 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 6424)) != 0)
  {
    v7 = *(_QWORD *)(a1 + 6432);
    *(_QWORD *)(a1 + 6424) = 0;
    *(_QWORD *)(a1 + 6432) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Invoke the upper layer callback function");
    sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 22, (uint64_t)"phLibNfc_IsoDepFelicaPresChk_Cb");
    v6(*(_QWORD *)(a1 + 19360), v7, v5);
  }
  else if (*(_QWORD *)(a1 + 6264))
  {
    v8 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t, uint64_t))(a1 + 6200);
    if (v8)
    {
      if (*(_QWORD *)(a1 + 2616))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 2616) = 0;
        v8 = *(void (**)(_QWORD, uint64_t, _QWORD, uint64_t, uint64_t))(a1 + 6200);
      }
      v9 = *(_QWORD *)(a1 + 6208);
      *(_QWORD *)(a1 + 6200) = 0;
      *(_QWORD *)(a1 + 6208) = 0;
      sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 17, (uint64_t)"phLibNfc_IsoDepFelicaPresChk_Cb");
      v8(*(_QWORD *)(a1 + 19360), v9, 0, a1 + 2552, a2);
    }
  }
  else
  {
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v4, v5, 0, 0);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IsoDepFelicaPresChk_Cb");
}

uint64_t sub_2198C02F4(uint64_t a1, unsigned int *a2)
{
  _QWORD v4[2];

  v4[1] = 0;
  sub_219850718(2, a2, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ChkPresenceTimer_Cb");
  v4[0] = 0;
  sub_2198C0364((uint64_t)a2, (uint64_t)v4, 0);
  return sub_219850808(2, a2, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ChkPresenceTimer_Cb");
}

uint64_t sub_2198C0364(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  BOOL v9;
  void (*v10)(_QWORD, uint64_t, uint64_t);
  uint64_t v11;
  char v13;
  unsigned int v14;

  v14 = 0;
  v13 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ChkPresence_Cb");
  if (!a1)
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ChkPresence_Cb");
  v6 = *(_QWORD *)(a1 + 1456);
  if (!v6)
  {
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"No target is connected");
    LODWORD(a3) = 148;
LABEL_19:
    v9 = (unsigned __int16)(a3 - 188) >= 0xFFFEu || (_DWORD)a3 == 143;
    v7 = 146;
    if (v9)
      a3 = a3;
    else
      a3 = 146;
    goto LABEL_25;
  }
  switch((_DWORD)a3)
  {
    case 0x96:
      v7 = 146;
      break;
    case 0x79:
      v7 = 150;
      break;
    case 0x2C:
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 2u, (uint64_t)"Target Lost!!");
LABEL_18:
      LODWORD(a3) = 146;
      goto LABEL_19;
    default:
      if (!a2 || (_DWORD)a3)
      {
        if ((_DWORD)a3)
          goto LABEL_19;
      }
      else
      {
        if (sub_219902600(*(unsigned int **)(a1 + 3040), v6))
        {
          *(_QWORD *)(a1 + 1456) = 0;
          *(_QWORD *)(a1 + 1464) = 0;
LABEL_17:
          sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Lower layer has returned Fail status!!");
          goto LABEL_18;
        }
        v8 = *(_QWORD *)(a1 + 1456);
        if (sub_21987B880((unsigned int *)a1, *(_DWORD *)(v8 + 4), (int *)&v14))
          goto LABEL_17;
        LODWORD(a3) = 146;
        if (v14 > 0x1A)
          goto LABEL_19;
        if (((1 << v14) & 0x2E8E800) != 0)
        {
          if (!*(_DWORD *)(a2 + 8))
          {
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Lower layer has returned Invalid BuffLen!!");
            goto LABEL_19;
          }
        }
        else if (((1 << v14) & 0x11000) != 0)
        {
          if (!*(_BYTE *)(v8 + 96) && !*(_DWORD *)(a2 + 8))
          {
            sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Lower layer has returned Invalid BuffLen!!");
            LODWORD(a3) = 255;
            goto LABEL_19;
          }
        }
        else if (v14 != 26)
        {
          goto LABEL_19;
        }
      }
      a3 = 0;
      v7 = 145;
      break;
  }
LABEL_25:
  if (*(_BYTE *)(a1 + 1441) == 1 && (v10 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 6424)) != 0)
  {
    v11 = *(_QWORD *)(a1 + 6432);
    *(_QWORD *)(a1 + 6424) = 0;
    *(_QWORD *)(a1 + 6432) = 0;
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Invoke the upper layer callback function");
    sub_219885F70(1, (unsigned int *)(a1 + 19368), 4u, 22, (uint64_t)"phLibNfc_RemoteDev_ChkPresence_Cb");
    v10(*(_QWORD *)(a1 + 19360), v11, a3);
  }
  else
  {
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v7, a3, 0, (uint64_t)&v13);
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ChkPresence_Cb");
}

uint64_t sub_2198C0630(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v9;

  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_ChkPresence_Trcv_Cb");
  sub_2198C0364(a2, a4, a5);
  return sub_219850808(0, (unsigned int *)&v9, 4u, 5u, (uint64_t)"phLibNfc_ChkPresence_Trcv_Cb");
}

uint64_t sub_2198C06B0(uint64_t a1, uint64_t a2)
{
  char v3;
  uint64_t v4;
  uint64_t v5;
  void (*v6)(_QWORD, uint64_t, uint64_t, _QWORD, uint64_t);
  uint64_t v7;
  uint64_t *v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_Transceive_Auth_TimerCb");
  if (a2)
  {
    v3 = 0;
    v4 = 0;
    do
    {
      v5 = *((_QWORD *)&unk_253E46700 + 14 * v4 + 2);
      if ((v3 & 1) != 0)
        break;
      v3 = 1;
      v4 = 1;
    }
    while (v5 != a2);
    if (v5 == a2)
    {
      sub_219850628(1, (unsigned int *)(a2 + 19368), 4u, 1u, (uint64_t)"phLibNfc_UIDNotMatchingCb");
      v6 = *(void (**)(_QWORD, uint64_t, uint64_t, _QWORD, uint64_t))(a2 + 6184);
      v7 = *(_QWORD *)(a2 + 6192);
      v8 = (uint64_t *)(a2 + 1456);
      if (sub_219902600(*(unsigned int **)(a2 + 3040), *(_QWORD *)(a2 + 1456)))
      {
        v9 = 0;
        *v8 = 0;
        *(_QWORD *)(a2 + 1464) = 0;
      }
      else
      {
        v9 = *v8;
      }
      v12 = v9;
      sub_2198BE4E4(a2, &v11, &v12, 0);
      if (*(_QWORD *)(a2 + 2616))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a2 + 2616) = 0;
      }
      if (v6)
        v6(*(_QWORD *)(a2 + 19360), v7, v11, 0, 255);
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_Transceive_Auth_TimerCb");
}

uint64_t sub_2198C07F0(uint64_t a1)
{
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MfcAuthInfo_Clear");
  if (a1)
  {
    *(_DWORD *)(a1 + 2568) = 255;
    *(_WORD *)(a1 + 2572) = 0;
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MfcAuthInfo_Clear");
}

uint64_t sub_2198C0850(uint64_t a1)
{
  __int128 v2;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ClearInfo");
  sub_2198C07F0(a1);
  v2 = 0uLL;
  *(_OWORD *)(a1 + 776) = 0u;
  *(_OWORD *)(a1 + 792) = 0u;
  *(_OWORD *)(a1 + 744) = 0u;
  *(_OWORD *)(a1 + 760) = 0u;
  *(_OWORD *)(a1 + 728) = 0u;
  *(_QWORD *)(a1 + 1464) = 0;
  *(_QWORD *)(a1 + 1456) = 0;
  if (*(_QWORD *)(a1 + 832))
  {
    phOsalNfc_FreeMemory();
    v2 = 0uLL;
  }
  *(_OWORD *)(a1 + 952) = v2;
  *(_OWORD *)(a1 + 968) = v2;
  *(_OWORD *)(a1 + 920) = v2;
  *(_OWORD *)(a1 + 936) = v2;
  *(_OWORD *)(a1 + 888) = v2;
  *(_OWORD *)(a1 + 904) = v2;
  *(_OWORD *)(a1 + 856) = v2;
  *(_OWORD *)(a1 + 872) = v2;
  *(_OWORD *)(a1 + 824) = v2;
  *(_OWORD *)(a1 + 840) = v2;
  *(_OWORD *)(a1 + 1192) = v2;
  *(_OWORD *)(a1 + 1208) = v2;
  *(_OWORD *)(a1 + 1224) = v2;
  *(_OWORD *)(a1 + 1240) = v2;
  *(_OWORD *)(a1 + 1256) = v2;
  *(_OWORD *)(a1 + 1272) = v2;
  *(_OWORD *)(a1 + 1288) = v2;
  *(_OWORD *)(a1 + 1304) = v2;
  *(_OWORD *)(a1 + 1320) = v2;
  *(_OWORD *)(a1 + 1336) = v2;
  if (*(_QWORD *)(a1 + 808))
    *(_QWORD *)(a1 + 808) = 0;
  if (*(_QWORD *)(a1 + 1352))
    *(_QWORD *)(a1 + 1352) = 0;
  *(_BYTE *)(a1 + 714) = 0;
  *(_BYTE *)(a1 + 1483) = 0;
  phOsalNfc_SetMemory();
  *(_BYTE *)(a1 + 1426) = 0;
  sub_219865494(*(_QWORD *)(a1 + 3040), 0);
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_RemoteDev_ClearInfo");
}

uint64_t sub_2198C0954(uint64_t a1, uint64_t a2, _QWORD *a3)
{
  uint64_t v6;
  uint64_t v7;
  _QWORD *v8;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetRemoteDevInfo");
  v6 = 255;
  if (a1)
  {
    if (a2)
    {
      v7 = *(unsigned __int8 *)(a1 + 714);
      if (*(_BYTE *)(a1 + 714))
      {
        v8 = (_QWORD *)(a1 + 832);
        while (*(v8 - 1) != a2)
        {
          v8 += 2;
          if (!--v7)
          {
            v6 = 255;
            goto LABEL_9;
          }
        }
        v6 = 0;
        *a3 = *v8;
      }
    }
  }
LABEL_9:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_GetRemoteDevInfo");
  return v6;
}

uint64_t sub_2198C0A00(uint64_t a1, uint64_t a2)
{
  const char *v4;
  char v5;
  int v6;
  uint64_t v7;
  uint64_t v8;
  int v9;
  char v10;
  uint64_t v11;
  int v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v17;
  uint64_t v18;
  __int16 v19;
  char v20;
  __int128 v21;
  uint64_t v22;

  v22 = *MEMORY[0x24BDAC8D0];
  v17 = 0;
  v18 = a2;
  v21 = xmmword_21990ADD0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DataExPresenceCheck");
  if (!a2)
  {
LABEL_24:
    v15 = 255;
    goto LABEL_25;
  }
  if (sub_2198BE4E4(a1, &v18, &v17, 1))
  {
    v4 = "Mapping of LibNfc RemoteDev Handle to NCI RemoteDev Handle Failed";
LABEL_6:
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)v4);
    v5 = 0;
    goto LABEL_7;
  }
  if (sub_21987B7E4((unsigned int *)a1, v17))
  {
    v4 = "Validation of NCI RemoteDev Handle Failed";
    goto LABEL_6;
  }
  v5 = 1;
LABEL_7:
  v6 = *(_DWORD *)(v18 + 4);
  switch(v6)
  {
    case 11:
    case 13:
    case 14:
    case 15:
    case 19:
      v7 = a1 + 2624;
      phOsalNfc_SetMemory();
      *(_DWORD *)(a1 + 2624) = 0;
      *(_QWORD *)(a1 + 2672) = a1 + 2807;
      *(_DWORD *)(a1 + 2680) = 2;
      v8 = a1 + 2787;
      v9 = 7;
      goto LABEL_9;
    case 12:
    case 16:
      v7 = a1 + 2624;
      phOsalNfc_SetMemory();
      *(_BYTE *)(a1 + 2628) = 2;
      *(_BYTE *)(a1 + 2634) = 1;
      *(_DWORD *)(a1 + 2624) = 48;
      *(_QWORD *)(a1 + 2672) = a1 + 2807;
      *(_DWORD *)(a1 + 2680) = 19;
      *(_QWORD *)(a1 + 2656) = 0;
      *(_DWORD *)(a1 + 2664) = 0;
      goto LABEL_22;
    case 21:
      v13 = 0;
      v14 = v18 + 8;
      do
      {
        *((_BYTE *)&v21 + v13 + 2) = *(_BYTE *)(v14 + v13);
        ++v13;
      }
      while (v13 != 8);
      v7 = a1 + 2624;
      phOsalNfc_SetMemory();
      *(_DWORD *)(a1 + 2624) = 240;
      *(_QWORD *)(a1 + 2672) = a1 + 2807;
      *(_DWORD *)(a1 + 2680) = 27;
      v8 = a1 + 2787;
      v9 = 16;
      goto LABEL_9;
    case 22:
      v7 = a1 + 2624;
      phOsalNfc_SetMemory();
      *(_DWORD *)(a1 + 2624) = 0;
      *(_QWORD *)(a1 + 2672) = a1 + 2807;
      *(_DWORD *)(a1 + 2680) = 6;
      v8 = a1 + 2787;
      v9 = 7;
LABEL_9:
      phOsalNfc_MemCopy();
      *(_QWORD *)(a1 + 2656) = v8;
      *(_DWORD *)(a1 + 2664) = v9;
      goto LABEL_22;
    case 24:
      v7 = a1 + 2624;
      phOsalNfc_SetMemory();
      *(_DWORD *)(a1 + 2624) = 0;
      v11 = a1 + 2787;
      v12 = 3;
      goto LABEL_21;
    default:
      v10 = v5 ^ 1;
      if (v6 != 23)
        v10 = 1;
      if ((v10 & 1) != 0)
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"RemoteDev is other than Mifare PICC or SAK byte is 0");
        goto LABEL_24;
      }
      v19 = 8226;
      phOsalNfc_MemCopy();
      v20 = 0;
      v7 = a1 + 2624;
      phOsalNfc_SetMemory();
      *(_DWORD *)(a1 + 2624) = 0;
      v11 = a1 + 2787;
      v12 = 11;
LABEL_21:
      phOsalNfc_MemCopy();
      *(_QWORD *)(a1 + 2656) = v11;
      *(_DWORD *)(a1 + 2664) = v12;
      *(_QWORD *)(a1 + 2672) = a1 + 2807;
      *(_DWORD *)(a1 + 2680) = 68;
LABEL_22:
      v15 = sub_2198914A0(v18, v7, (uint64_t)sub_2198C0630, a1);
      break;
  }
LABEL_25:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_DataExPresenceCheck");
  return v15;
}

uint64_t sub_2198C0DF0(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  unsigned int *v5;
  const char *v6;
  int v8;
  int v9;
  uint64_t v10;
  char v11;
  uint64_t *v12;
  uint64_t v13;
  uint64_t (**v14)();
  uint64_t (*v15)();
  uint64_t v16;
  uint64_t v17;
  unsigned int v18;
  char v19;
  uint64_t *v20;
  uint64_t v21;
  uint64_t *v22;
  uint64_t v23;
  uint64_t (**v24)();
  uint64_t (*v25)();
  _DWORD *v26;
  uint64_t v27;

  v26 = 0;
  v27 = a2;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PreparePresenceCheck");
  v4 = 1;
  if (a1 && a2)
  {
    if (!*(_QWORD *)(a1 + 1456))
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"No target is connected");
      v4 = 148;
      goto LABEL_14;
    }
    if (*(_BYTE *)(a1 + 2885))
    {
      sub_2198EF82C(*(_DWORD *)(a1 + 19368), *(_QWORD *)(a1 + 1448));
      if (phOsalNfc_Timer_Start())
      {
        sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"phLibNfc_PreparePresenceCheck : Timer Failed");
      }
      else
      {
        sub_21988629C(1, (unsigned int *)(a1 + 19368), *(_QWORD *)(a1 + 1448), 4u, 4u, (uint64_t)"phLibNfc_PreparePresenceCheck");
        v4 = 13;
      }
      goto LABEL_14;
    }
    if (sub_2198BE4E4(a1, &v27, &v26, 1))
    {
      v5 = (unsigned int *)(a1 + 19368);
      v6 = "Mapping of LibNfc RemoteDev Handle to NCI RemoteDev Handle Failed";
LABEL_13:
      sub_219850628(1, v5, 4u, 1u, (uint64_t)v6);
      v4 = 149;
      goto LABEL_14;
    }
    if (sub_219879D44(a1, (uint64_t)v26))
    {
      v5 = (unsigned int *)(a1 + 19368);
      v6 = "NCI RemoteDev Handle is not same as Connected Handle";
      goto LABEL_13;
    }
    if (!v26)
      goto LABEL_39;
    v8 = v26[4];
    if (v8 == 4)
    {
      if (v26[3] == 1)
      {
        v9 = v26[1];
        if ((v9 == 25 || v9 == 4) && *(_BYTE *)(a1 + 1422) == 1)
          goto LABEL_25;
      }
    }
    else
    {
      if (!v8)
      {
        if (v26[3] == 1)
        {
          if (*(_BYTE *)(a1 + 1422) != 1)
          {
LABEL_34:
            if (v26[1] == 25)
            {
              *(_QWORD *)(a1 + 2912) = &qword_2550A2B98;
              *(_BYTE *)(a1 + 2904) = 0;
              *(_BYTE *)(a1 + 2906) = 0;
              v11 = qword_2550A2B98;
              if (qword_2550A2B98)
              {
                v11 = 0;
                v14 = off_2550A2BA8;
                do
                {
                  ++v11;
                  v15 = *v14;
                  v14 += 2;
                }
                while (v15);
              }
LABEL_38:
              *(_BYTE *)(a1 + 2905) = v11;
              v16 = v27;
              v17 = a1;
LABEL_47:
              v10 = sub_2198655FC(v17, 0, v16);
              goto LABEL_48;
            }
            goto LABEL_39;
          }
LABEL_25:
          v4 = 147;
          goto LABEL_14;
        }
LABEL_39:
        if (!sub_2198D0904((unsigned int *)a1, (uint64_t)v26))
        {
          v18 = *(_DWORD *)(a1 + 2568) - 96;
          if (v18 <= 0x21 && ((1 << v18) & 0x300000003) != 0)
          {
            *(_QWORD *)(a1 + 2912) = &qword_2550A30B8;
            *(_BYTE *)(a1 + 2904) = 0;
            *(_BYTE *)(a1 + 2906) = 0;
            v19 = qword_2550A30B8;
            if (qword_2550A30B8)
            {
              v19 = 0;
              v20 = &qword_2550A30C8;
              do
              {
                ++v19;
                v21 = *v20;
                v20 += 2;
              }
              while (v21);
            }
          }
          else if (*(_BYTE *)(a1 + 1483) == 1)
          {
            *(_QWORD *)(a1 + 2912) = &qword_2550A0E58;
            *(_BYTE *)(a1 + 2904) = 0;
            *(_BYTE *)(a1 + 2906) = 0;
            v19 = qword_2550A0E58;
            if (qword_2550A0E58)
            {
              v19 = 0;
              v22 = &qword_2550A0E68;
              do
              {
                ++v19;
                v23 = *v22;
                v22 += 2;
              }
              while (v23);
            }
          }
          else
          {
            *(_QWORD *)(a1 + 2912) = &qword_2550A2D08;
            *(_BYTE *)(a1 + 2904) = 0;
            *(_BYTE *)(a1 + 2906) = 0;
            v19 = qword_2550A2D08;
            if (qword_2550A2D08)
            {
              v19 = 0;
              v24 = off_2550A2D18;
              do
              {
                ++v19;
                v25 = *v24;
                v24 += 2;
              }
              while (v25);
            }
          }
          *(_BYTE *)(a1 + 2905) = v19;
          v17 = a1;
          v16 = 0;
          goto LABEL_47;
        }
        v10 = sub_2198C0A00(a1, v27);
LABEL_48:
        v4 = v10;
        goto LABEL_14;
      }
      if ((v8 & 0xFFFFFFFE) != 4)
      {
        if (v8 == 3)
        {
          *(_QWORD *)(a1 + 2912) = &qword_2550A2B48;
          *(_BYTE *)(a1 + 2904) = 0;
          *(_BYTE *)(a1 + 2906) = 0;
          v11 = qword_2550A2B48;
          if (qword_2550A2B48)
          {
            v11 = 0;
            v12 = &qword_2550A2B58;
            do
            {
              ++v11;
              v13 = *v12;
              v12 += 2;
            }
            while (v13);
          }
          goto LABEL_38;
        }
        if (v26[3] != 1)
          goto LABEL_39;
        goto LABEL_34;
      }
    }
    v10 = sub_2198FFE8C(*(_QWORD *)(a1 + 3040), (uint64_t)sub_2198C0014, a1);
    goto LABEL_48;
  }
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_PreparePresenceCheck");
  return v4;
}

uint64_t sub_2198C11C8(unsigned int *a1, int *a2, unsigned __int8 **a3)
{
  unsigned __int8 *v6;
  int v7;
  int v8;
  unint64_t v9;
  _DWORD *v10;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapDesfireTagType");
  v6 = *a3;
  if (!*a3 || *((_DWORD *)a3 + 2) < 8u || *v6 != 175 || v6[1] != 4)
    goto LABEL_19;
  v7 = v6[2];
  if (v7 != 131 && v7 != 129)
  {
    if (v7 == 1)
    {
      switch(v6[4] & 0xF)
      {
        case 0:
          if (v6[6] != 24)
            goto LABEL_19;
          v8 = 40;
          goto LABEL_20;
        case 1:
          goto LABEL_12;
        case 2:
          LODWORD(v6) = v6[6] - 22;
          if (v6 >= 9)
            goto LABEL_19;
          v6 = (unsigned __int8 *)(char)v6;
          v10 = &unk_21990AD80;
          goto LABEL_14;
        case 3:
          LODWORD(v6) = v6[6] - 22;
          if (v6 >= 5)
            goto LABEL_19;
          v6 = (unsigned __int8 *)(char)v6;
          v10 = &unk_21990ADA4;
          goto LABEL_14;
        default:
          goto LABEL_19;
      }
    }
    goto LABEL_19;
  }
  if ((v6[4] & 0xF) != 1)
  {
LABEL_19:
    v8 = 54;
    goto LABEL_20;
  }
LABEL_12:
  HIDWORD(v9) = v6[6];
  LODWORD(v9) = (HIDWORD(v9) << 24) - 0x10000000;
  LOBYTE(v6) = v9 >> 25;
  if (v6 >= 6u)
    goto LABEL_19;
  v6 = (unsigned __int8 *)(char)v6;
  v10 = &unk_21990ADB8;
LABEL_14:
  v8 = v10[(_QWORD)v6];
LABEL_20:
  *a2 = v8;
  return sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapDesfireTagType");
}

uint64_t sub_2198C1334(uint64_t a1, uint64_t a2, uint64_t a3, unsigned __int8 **a4)
{
  uint64_t v8;
  uint64_t v10;
  char v11;
  unsigned __int8 *v12;
  int *v13;
  int v14;
  int v15;
  int v16;
  unsigned __int8 *v17;
  int v18;
  int v19;
  unsigned __int8 *v20;
  unsigned int v21;
  int v22;
  int v23;
  uint64_t v24;
  uint64_t v25;
  _OWORD v26[2];
  __int128 v27;
  __int128 v28;
  uint64_t v29;
  _BYTE v30[19];
  uint64_t v31;

  v31 = *MEMORY[0x24BDAC8D0];
  v29 = 0;
  v27 = 0u;
  v28 = 0u;
  memset(v26, 0, sizeof(v26));
  *(_OWORD *)v30 = xmmword_21990AD6B;
  *(_DWORD *)&v30[15] = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FindTagTypeFromSak");
  if (sub_219902600(*(unsigned int **)(a1 + 3040), *(_QWORD *)(a1 + 1456)))
  {
    *(_QWORD *)(a1 + 1456) = 0;
    *(_QWORD *)(a1 + 1464) = 0;
    v8 = 1;
    goto LABEL_3;
  }
  v8 = 1;
  if (a2 && a3)
  {
    v10 = *(_QWORD *)(a1 + 1456);
    v11 = *(_BYTE *)(v10 + 96);
    *(_DWORD *)a2 = 55;
    *(_QWORD *)(a2 + 8) = 0;
    phOsalNfc_SetMemory();
    *(_QWORD *)&v28 = a1 + 2016;
    DWORD2(v28) = 530;
    if ((v11 & 2) != 0)
    {
      v8 = 0;
      *(_DWORD *)a2 = 55;
      goto LABEL_3;
    }
    if ((v11 & 8) == 0)
    {
      if ((v11 & 0x10) != 0)
      {
        v8 = 0;
        if ((v11 & 1) != 0)
          v19 = 25;
        else
          v19 = 21;
        goto LABEL_101;
      }
      if ((v11 & 0x20) == 0)
      {
        if ((v11 & 1) == 0 && *(_BYTE *)(v10 + 36) == 4)
        {
          *(_DWORD *)a2 = 5;
          if (a4)
          {
            v12 = *a4;
            if (!*a4 || (v13 = *(int **)(a1 + 2776)) == 0)
            {
              v8 = 255;
              goto LABEL_3;
            }
            if (*((_DWORD *)a4 + 2) < 8u)
            {
              v8 = 44;
              goto LABEL_3;
            }
            v14 = v12[2];
            if (v14 == 4)
            {
              *v13 = 5;
              sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"NTAG 2xx is considered as Mifare UL");
              v8 = 150;
              goto LABEL_3;
            }
            if (v14 != 3)
              goto LABEL_102;
            v15 = v12[4];
            if ((v15 - 2) < 2)
            {
              v8 = 0;
              v16 = 10;
              goto LABEL_109;
            }
            if (v15 == 4)
            {
              v8 = 0;
              v16 = 6;
              goto LABEL_109;
            }
            if (v15 == 1)
            {
              v8 = 0;
              v16 = 9;
            }
            else
            {
LABEL_102:
              v8 = 0;
              v16 = 55;
            }
LABEL_109:
            *v13 = v16;
            goto LABEL_3;
          }
          goto LABEL_84;
        }
        v8 = 0;
        v19 = 55;
        goto LABEL_101;
      }
      v21 = *(unsigned __int8 *)(v10 + 104);
      if (v21 < 0xB)
      {
LABEL_79:
        if (v21 >= 4)
        {
          if (a4)
          {
            sub_2198C11C8((unsigned int *)a1, (int *)a2, a4);
            v8 = 0;
            goto LABEL_3;
          }
          *(_DWORD *)a2 = 40;
LABEL_84:
          *(_BYTE *)(a1 + 1486) = 96;
          LODWORD(v26[0]) = 0;
          *(_QWORD *)&v27 = a1 + 1486;
          v22 = 1;
          goto LABEL_85;
        }
        v8 = 0;
        v19 = 54;
LABEL_101:
        *(_DWORD *)a2 = v19;
        goto LABEL_3;
      }
      if (*(unsigned __int8 *)(v10 + 110) == 193 && *(_BYTE *)(v10 + 111) == 5)
      {
        if (*(_BYTE *)(v10 + 114) == 1)
        {
          if (*(unsigned __int8 *)(v10 + 115) == 188 && *(unsigned __int8 *)(v10 + 116) == 214)
          {
            if (a4)
            {
              if (*a4 && *((_DWORD *)a4 + 2) == 1 && **a4 == 144)
              {
                v8 = 0;
                v19 = 23;
              }
              else
              {
                v8 = 0;
                v19 = 26;
              }
              goto LABEL_101;
            }
            goto LABEL_104;
          }
        }
        else if (!*(_BYTE *)(v10 + 114) && *(_BYTE *)(v10 + 115) == 53 && *(unsigned __int8 *)(v10 + 116) == 199)
        {
          if (a4)
          {
            if (*a4 && *((_DWORD *)a4 + 2) == 1 && **a4 == 144)
            {
              v8 = 0;
              v19 = 15;
            }
            else
            {
              v8 = 0;
              v19 = 18;
            }
            goto LABEL_101;
          }
LABEL_104:
          phOsalNfc_MemCopy();
          LODWORD(v26[0]) = 0;
          *(_QWORD *)&v27 = a1 + 1486;
          DWORD2(v27) = 19;
          v23 = *(_DWORD *)(v10 + 4);
          v25 = a1 + 2712;
          v24 = a1;
          goto LABEL_86;
        }
      }
      if (phOsalNfc_MemCompare()
        && phOsalNfc_MemCompare()
        && phOsalNfc_MemCompare())
      {
        v21 = *(unsigned __int8 *)(v10 + 104);
        goto LABEL_79;
      }
LABEL_100:
      v8 = 0;
      v19 = 27;
      goto LABEL_101;
    }
    if ((v11 & 0x10) == 0)
    {
      if ((v11 & 1) != 0)
      {
        v8 = 0;
        v19 = 4;
        goto LABEL_101;
      }
      if ((v11 & 0x20) != 0)
      {
        v8 = 0;
        v19 = 1;
        goto LABEL_101;
      }
      if (a4)
      {
        v17 = *a4;
        if (!*a4 || *((_DWORD *)a4 + 2) != 12)
          goto LABEL_99;
        if (v17[5] == 193 && v17[6] == 5)
        {
          v18 = v17[10];
          if (v17[9] || v18 != 53)
          {
            if (v18 == 188 && v17[11] == 214)
            {
              v8 = 0;
              v19 = 20;
              goto LABEL_101;
            }
          }
          else if (v17[11] == 199)
          {
            v8 = 0;
            v19 = 12;
            goto LABEL_101;
          }
        }
        if (phOsalNfc_MemCompare()
          && phOsalNfc_MemCompare()
          && phOsalNfc_MemCompare())
        {
LABEL_99:
          v8 = 0;
          v19 = 1;
          *(_BYTE *)(a1 + 2785) = 1;
          goto LABEL_101;
        }
        goto LABEL_100;
      }
LABEL_66:
      *(_WORD *)(a1 + 1486) = -32544;
      LODWORD(v26[0]) = 0;
      *(_QWORD *)&v27 = a1 + 1486;
      v22 = 2;
LABEL_85:
      DWORD2(v27) = v22;
      v23 = *(_DWORD *)(v10 + 4);
      v24 = a1;
      v25 = a3;
LABEL_86:
      sub_2198BF34C(v24, v23, (uint64_t)v26, v25);
      v8 = 13;
      goto LABEL_3;
    }
    if ((v11 & 1) != 0)
    {
      v8 = 0;
      v19 = 2;
      goto LABEL_101;
    }
    if ((v11 & 0x20) != 0)
    {
      v8 = 0;
    }
    else
    {
      if (!a4)
        goto LABEL_66;
      v20 = *a4;
      if (*a4 && *((_DWORD *)a4 + 2) == 12 && v20[5] == 193 && v20[6] == 5)
      {
        if (!v20[9] && v20[10] == 53 && v20[11] == 199)
        {
          v8 = 0;
          v19 = 16;
          goto LABEL_101;
        }
        if (v20[10] == 188 && v20[11] == 214)
        {
          v8 = 0;
          v19 = 24;
          goto LABEL_101;
        }
      }
      v8 = 0;
      *(_BYTE *)(a1 + 2785) = 1;
    }
    v19 = 3;
    goto LABEL_101;
  }
LABEL_3:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_FindTagTypeFromSak");
  return v8;
}

uint64_t sub_2198C1984(uint64_t a1, char a2)
{
  uint64_t v3;
  char v4;
  char v5;
  int v6;
  _QWORD *v7;
  uint64_t v8;
  uint64_t v9;
  const char *v10;
  uint64_t v12;
  _QWORD *Memory;
  uint64_t v14;

  Memory = 0;
  v14 = a1;
  v12 = 0;
  sub_219850718(0, (unsigned int *)&v14, 6u, 5u, (uint64_t)"phDnldNfc_SetHwDevHandle");
  v3 = 0;
  v4 = 1;
  while (1)
  {
    v5 = v4;
    if (*((_QWORD *)&unk_253E46700 + 14 * v3) == v14)
      break;
    v4 = 0;
    v3 = 1;
    if ((v5 & 1) == 0)
    {
      v6 = 255;
      goto LABEL_6;
    }
  }
  v6 = *((_DWORD *)&unk_253E46700 + 28 * v3 + 2);
LABEL_6:
  sub_21988F460(v14, &Memory);
  sub_21988F744(v14, &v12);
  if (!Memory)
  {
    sub_219850628(0, (unsigned int *)&v14, 6u, 4u, (uint64_t)"Allocating Mem for Dnld Context..");
    Memory = (_QWORD *)phOsalNfc_GetMemory();
    if (Memory)
    {
      phOsalNfc_SetMemory();
      sub_21988F520(v14, (uint64_t)Memory);
      sub_219885FF8(0, (unsigned int *)&v14, 6u, 4u, (uint64_t)"####Primary NFCC, DriverHandle");
      sub_219885FF8(0, (unsigned int *)&v14, 6u, 4u, (uint64_t)"####Primary NFCC, DOWNLOAD context");
    }
    else
    {
      sub_219850628(0, (unsigned int *)&v14, 6u, 1u, (uint64_t)"phDnldNfc_SetHwDevHandle Insufficient resource!!");
    }
  }
  if (!v14 || (v7 = Memory) == 0)
  {
    v10 = "Invalid Input Parameters!!";
    goto LABEL_19;
  }
  Memory[3] = v14;
  *((_DWORD *)v7 + 12) = v6;
  sub_219850628(0, (unsigned int *)&v14, 6u, 4u, (uint64_t)"Dev Handle updated successfully");
  if (!v12)
  {
    phTmlNfc_ReadAbort();
    phTmlNfc_FlushTxRxBuffers();
    if (sub_21988F8B8(v14) == 1)
    {
      phTmlNfc_WriteAbort();
      sub_21988F804(v14, 0);
    }
    sub_219905450((uint64_t)Memory, a2);
    v8 = Memory[7];
    if (v8)
    {
      v9 = sub_2198FB9B4(v14);
      if (v9)
      {
        Memory[5] = v9;
        *(_QWORD *)(v8 + 8496) = v9;
        sub_2199022EC(v9, v8);
        return sub_219850808(0, (unsigned int *)&v14, 6u, 5u, (uint64_t)"phDnldNfc_SetHwDevHandle");
      }
      v10 = "Failed to create NCI Handle";
LABEL_20:
      sub_219850628(v9, (unsigned int *)&v14, 6u, 1u, (uint64_t)v10);
      return sub_219850808(0, (unsigned int *)&v14, 6u, 5u, (uint64_t)"phDnldNfc_SetHwDevHandle");
    }
    v10 = "Failed to create Download Core Context";
LABEL_19:
    LODWORD(v9) = 0;
    goto LABEL_20;
  }
  return sub_219850808(0, (unsigned int *)&v14, 6u, 5u, (uint64_t)"phDnldNfc_SetHwDevHandle");
}

uint64_t sub_2198C1BDC(uint64_t a1)
{
  uint64_t v3;

  v3 = 0;
  sub_219850718(2, (unsigned int *)a1, 6u, 5u, (uint64_t)"phDnldNfc_FreeDnldContext");
  if (a1)
  {
    v3 = *(_QWORD *)(a1 + 24);
    phOsalNfc_FreeMemory();
    sub_21988F520(v3, 0);
  }
  return sub_219850808(0, (unsigned int *)&v3, 6u, 5u, (uint64_t)"phDnldNfc_FreeDnldContext");
}

uint64_t sub_2198C1C60(uint64_t a1, unsigned __int8 **a2, int a3)
{
  int v6;
  uint64_t v7;
  const char *v8;
  int v9;
  unsigned int *v10;
  uint64_t Library;
  uint64_t v12;
  uint64_t v13;
  unsigned __int8 *v14;
  int v15;
  int v16;
  int v17;
  int v18;
  int v19;
  int v20;
  int v21;
  int v22;
  int v23;
  int v24;
  uint64_t v26;
  int v27;
  unsigned __int8 *v28;

  v28 = 0;
  v27 = 0;
  v26 = 0;
  sub_219850718(2, (unsigned int *)a1, 6u, 5u, (uint64_t)"phDnldNfc_InitImgInfo");
  if (!a1)
  {
    v8 = "phDnldNfc_InitImgInfo: Invalid DNLD context!!";
    v9 = 2;
    v10 = 0;
LABEL_23:
    sub_219850628(v9, v10, 6u, 1u, (uint64_t)v8);
    v12 = 255;
    goto LABEL_24;
  }
  sub_21988EB80(*(_QWORD *)(a1 + 24), &v26);
  *(_QWORD *)a1 = "";
  if (a2)
  {
    v6 = *((_DWORD *)a2 + 2);
    v7 = (uint64_t)*a2;
    if (v6)
    {
      if (v7)
      {
        v28 = *a2;
        v27 = v6;
        goto LABEL_12;
      }
    }
    else if (v7)
    {
      *(_QWORD *)a1 = v7;
    }
  }
  Library = phOsalNfc_LoadLibrary();
  if (!v28 || !v27)
  {
    sub_219850628(1, (unsigned int *)(a1 + 48), 6u, 1u, (uint64_t)"phDnldNfc_InitImgInfo Image extraction Failed - invalid imginfo or imginfolen!!");
    v12 = 255;
    goto LABEL_19;
  }
  v12 = Library;
  if ((_DWORD)Library)
  {
LABEL_19:
    sub_219850628(1, (unsigned int *)(a1 + 48), 6u, 1u, (uint64_t)"phDnldNfc_InitImgInfo Error loading firmware !!\n");
    goto LABEL_24;
  }
LABEL_12:
  if (v26)
  {
    sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"MW Major Version Num - ");
    sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"MW Minor Version Num - ");
    v13 = v26;
    *(_WORD *)(v26 + 834) = 778;
    v14 = v28;
    *(_QWORD *)(a1 + 8) = v28;
    v15 = v27;
    *(_DWORD *)(a1 + 16) = v27;
    if (!v14 || !v15)
    {
      v8 = "Image details extraction Failed!!";
      goto LABEL_22;
    }
    if ((a3 - 8) > 2)
    {
      sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW Major Version Num - ");
      sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW Minor Version Num - ");
      sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW Image Length - ");
      sub_219885FF8(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW Image Info Pointer - ");
      v12 = 0;
      *(_WORD *)(v26 + 832) = *(_WORD *)(*(_QWORD *)(a1 + 8) + 4);
      goto LABEL_24;
    }
    *(_DWORD *)(a1 + 16) = v15 - 12;
    *(_DWORD *)(v13 + 840) = 0;
    v16 = *v14;
    *(_DWORD *)(v13 + 840) = v16;
    v17 = v16 | (v14[1] << 8);
    *(_DWORD *)(v13 + 840) = v17;
    v18 = v17 | (v14[2] << 16);
    *(_DWORD *)(v13 + 840) = v18;
    *(_DWORD *)(v13 + 840) = v18 | (v14[3] << 24);
    *(_DWORD *)(v13 + 844) = 0;
    v19 = v14[4];
    *(_DWORD *)(v13 + 844) = v19;
    v20 = v19 | (v14[5] << 8);
    *(_DWORD *)(v13 + 844) = v20;
    v21 = v20 | (v14[6] << 16);
    *(_DWORD *)(v13 + 844) = v21;
    *(_DWORD *)(v13 + 844) = v21 | (v14[7] << 24);
    *(_DWORD *)(v13 + 828) = 0;
    v22 = v14[8];
    *(_DWORD *)(v13 + 828) = v22;
    v23 = v22 | (v14[9] << 8);
    *(_DWORD *)(v13 + 828) = v23;
    v24 = v23 | (v14[10] << 16);
    *(_DWORD *)(v13 + 828) = v24;
    *(_DWORD *)(v13 + 828) = v24 | (v14[11] << 24);
    *(_WORD *)(v13 + 832) = *(_WORD *)&v14[__rev16(*((unsigned __int16 *)v14 + 6)) + 18];
    sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW Major Version Num");
    sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW Minor Version Num");
    sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW Image Length");
    sub_219885FF8(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW Image Info Pointer");
    sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"FW SVN Revision");
    sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"Regular FW Offset");
    sub_219851888(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"Degraded FW Offset");
    v12 = 0;
    if (*(_DWORD *)(v26 + 844) <= 0xBu)
    {
      v8 = "Degraded FW offset is invalid!!";
LABEL_22:
      v9 = 1;
      v10 = (unsigned int *)(a1 + 48);
      goto LABEL_23;
    }
  }
  else
  {
    v12 = 0;
  }
LABEL_24:
  sub_219850808(2, (unsigned int *)a1, 6u, 5u, (uint64_t)"phDnldNfc_InitImgInfo");
  return v12;
}

uint64_t sub_2198C20AC(uint64_t a1)
{
  int v2;

  sub_219850718(2, (unsigned int *)a1, 6u, 5u, (uint64_t)"phDnldNfc_CloseFwLibHandle");
  if (a1)
  {
    v2 = phOsalNfc_FreeLibrary();
    *(_DWORD *)(a1 + 16) = 0;
    *(_QWORD *)(a1 + 8) = 0;
    if (v2)
      sub_219850628(1, (unsigned int *)(a1 + 48), 6u, 1u, (uint64_t)"free FW image memory FAILED !!\n");
    else
      sub_219850628(1, (unsigned int *)(a1 + 48), 6u, 4u, (uint64_t)"free FW image memory SUCCESS !!\n");
  }
  return sub_219850808(2, (unsigned int *)a1, 6u, 5u, (uint64_t)"phDnldNfc_CloseFwLibHandle");
}

uint64_t sub_2198C2154(uint64_t a1, uint64_t a2, int *a3, unsigned int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  int v13;
  uint64_t v15;
  uint64_t v16;

  v15 = 0;
  v16 = a1;
  sub_219850718(0, (unsigned int *)&v16, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_RdNdef");
  sub_21988EF68(v16, &v15);
  v11 = 1;
  if (a3)
  {
    if (a2)
    {
      if (a5)
      {
        v12 = v15;
        if (v15)
        {
          if (a4 <= 1)
          {
            if (a4 || *(_BYTE *)(v15 + 540) == 2)
            {
              *(_QWORD *)(v15 + 16) = a5;
              *(_QWORD *)(v12 + 40) = a6;
              *(_BYTE *)(v12 + 547) = 2;
              v13 = *a3;
              if (*a3 && *(_BYTE *)(v12 + 545) != 3 && (*(_BYTE *)(v12 + 545) || *(_BYTE *)(v12 + 65) != 1))
              {
                *(_QWORD *)(v12 + 240) = a2;
                *(_DWORD *)(v12 + 248) = v13;
                *(_QWORD *)(v12 + 552) = a3;
                *a3 = 0;
                if (a4 == 1)
                {
                  *(_WORD *)(v12 + 647) = 260;
                  *(_BYTE *)(v12 + 66) = 0;
                  *(_WORD *)(v12 + 68) = 0;
                  *(_BYTE *)(v12 + 70) = 4;
                  *(_WORD *)(v12 + 650) = *(_WORD *)(v12 + 202);
                  *(_BYTE *)(v12 + 72) = 0;
                  *(_BYTE *)(v12 + 75) = 0;
                  *(_DWORD *)(v12 + 2700) = 0;
                  *(_BYTE *)(v12 + 2704) = 0;
                  *(_WORD *)(v12 + 2710) = 0;
                  *(_BYTE *)(v12 + 540) = 2;
                  *(_BYTE *)(v12 + 560) = 1;
                  v11 = sub_2198C22F0(v12, 4);
                }
                else
                {
                  *(_BYTE *)(v12 + 540) = 2;
                  *(_BYTE *)(v12 + 648) = 1;
                  if (*(_BYTE *)(v12 + 2704) == 1)
                  {
                    v11 = 26;
                  }
                  else
                  {
                    *(_BYTE *)(v12 + 560) = a4;
                    sub_2198C23D8(v12);
                    v11 = 0;
                  }
                }
              }
            }
            else
            {
              v11 = 245;
            }
          }
        }
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v16, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_RdNdef");
  return v11;
}

uint64_t sub_2198C22F0(uint64_t a1, char a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_RdCardfindNdefTLV");
  *(_BYTE *)a1 = 4;
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_BYTE *)(a1 + 208) = 0;
  *(_BYTE *)(a1 + 266) = a2;
  *(_WORD *)(a1 + 526) = 1;
  *(_WORD *)(a1 + 264) = 260;
  *(_DWORD *)(a1 + 232) = 48;
  sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Sending Read command to finc Ndef Tlv...");
  sub_2198C3384((unsigned int *)a1, *(_DWORD *)(a1 + 232), a1 + 266, *(unsigned __int16 *)(a1 + 526), a1 + 264);
  v4 = sub_219888630(a1, (uint64_t)sub_2198C3648);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_RdCardfindNdefTLV");
  return v4;
}

uint64_t sub_2198C23D8(uint64_t a1)
{
  __int16 v2;
  __int16 v3;
  int v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_CpDataToUserBuf");
  if (*(_DWORD *)(a1 + 248) >= *(unsigned __int16 *)(a1 + 78))
  {
    phOsalNfc_MemCopy();
    v3 = 0;
    v4 = *(unsigned __int16 *)(a1 + 78);
    **(_DWORD **)(a1 + 552) = v4;
    *(_WORD *)(a1 + 2702) = 0;
    *(_BYTE *)(a1 + 2704) = 1;
    *(_WORD *)(a1 + 650) -= v4;
  }
  else
  {
    phOsalNfc_MemCopy();
    **(_DWORD **)(a1 + 552) = *(_DWORD *)(a1 + 248);
    v2 = *(_WORD *)(a1 + 248);
    *(_WORD *)(a1 + 2702) += v2;
    *(_WORD *)(a1 + 650) -= v2;
    v3 = *(_WORD *)(a1 + 78) - v2;
  }
  *(_WORD *)(a1 + 78) = v3;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_CpDataToUserBuf");
  return 0;
}

uint64_t sub_2198C24C0(uint64_t a1, uint64_t a2, _DWORD *a3, unsigned int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  _DWORD *v15;
  int v16;
  __int16 v17;
  uint64_t v18;
  uint64_t v20;
  __int16 v21;
  char v22;
  uint64_t v23;

  v23 = a1;
  v22 = 0;
  v21 = 208;
  v20 = 0;
  sub_219850718(0, (unsigned int *)&v23, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_WrNdef");
  sub_21988EF68(v23, &v20);
  v11 = 1;
  if (a3 && a5 && v20)
  {
    phOsalNfc_MemCopy();
    v12 = v20;
    *(_DWORD *)(v20 + 2740) = 3;
    *(_QWORD *)(v12 + 24) = a5;
    *(_QWORD *)(v12 + 40) = a6;
    *(_BYTE *)(v12 + 547) = 3;
    *(_WORD *)(v12 + 252) = 0;
    **(_WORD **)(v12 + 528) = 0;
    v13 = v20;
    v14 = v20 + 2736;
    v15 = (_DWORD *)(v20 + 2740);
    if (*a3)
    {
      v15 = a3;
      v14 = a2;
    }
    v11 = 1;
    if (v20)
    {
      if (v14 && a4 <= 1 && *v15 && (*(unsigned __int8 *)(v20 + 545) | 2) != 3)
      {
        *(_BYTE *)(v20 + 648) = 2;
        *(_QWORD *)(v13 + 240) = v14;
        *(_DWORD *)(v13 + 248) = *v15;
        *(_QWORD *)(v13 + 256) = v15;
        *v15 = 0;
        if (a4 == 1 || *(_BYTE *)(v13 + 540) == 2)
        {
          v16 = *(unsigned __int8 *)(v13 + 67);
          *(_BYTE *)(v13 + 646) = v16;
          v17 = *(unsigned __int8 *)(v13 + 70);
          *(_BYTE *)(v13 + 647) = v17;
          *(_BYTE *)(v13 + 72) = 0;
          *(_BYTE *)(v13 + 75) = 0;
          *(_WORD *)(v13 + 2700) = 0;
          *(_BYTE *)(v13 + 2704) = 0;
          *(_BYTE *)(v13 + 82) = 0;
          *(_WORD *)(v13 + 644) = 0;
          *(_WORD *)(v13 + 650) = *(_WORD *)(v13 + 202)
                                - (*(unsigned __int8 *)(v13 + 131)
                                 + *(unsigned __int8 *)(v13 + 185))
                                - (*(_WORD *)(v13 + 68)
                                 + 4 * v17)
                                + 15;
          *(_BYTE *)(v13 + 540) = 3;
          *(_BYTE *)(v13 + 648) = 2;
          if (a4)
          {
            *(_BYTE *)(v13 + 560) = 1;
            if (v16 != 1)
            {
              v18 = sub_2198C2808(v13);
LABEL_22:
              v11 = v18;
              goto LABEL_23;
            }
LABEL_20:
            *(_BYTE *)(v13 + 646) = 1;
            v18 = sub_2198C26F4(v13, 1, 1, 19);
            goto LABEL_22;
          }
LABEL_19:
          *(_BYTE *)(v13 + 560) = a4;
          if (v16 != 1)
          {
            v18 = sub_2198C2AA4(v13);
            goto LABEL_22;
          }
          goto LABEL_20;
        }
        *(_BYTE *)(v13 + 540) = 3;
        *(_BYTE *)(v13 + 648) = 2;
        if (*(_BYTE *)(v13 + 2704) != 1)
        {
          v16 = *(unsigned __int8 *)(v13 + 67);
          goto LABEL_19;
        }
        v11 = 26;
      }
    }
  }
LABEL_23:
  sub_219850808(0, (unsigned int *)&v23, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_WrNdef");
  return v11;
}

uint64_t sub_2198C26F4(uint64_t a1, char a2, int a3, char a4)
{
  __int16 v8;
  char v9;
  uint64_t v10;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_SelectSector");
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_BYTE *)(a1 + 208) = 0;
  *(_BYTE *)a1 = a4;
  if (a3 == 1)
  {
    v8 = 3;
    v9 = -1;
    a2 = -62;
  }
  else
  {
    v9 = 0;
    *(_WORD *)(a1 + 269) = 0;
    v8 = 5;
  }
  *(_BYTE *)(a1 + 266) = 0;
  *(_BYTE *)(a1 + 267) = a2;
  *(_BYTE *)(a1 + 268) = v9;
  *(_WORD *)(a1 + 526) = v8;
  *(_WORD *)(a1 + 264) = 260;
  *(_DWORD *)(a1 + 232) = 0;
  sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Sending sector command...");
  sub_2198C3384((unsigned int *)a1, *(_DWORD *)(a1 + 232), a1 + 266, *(unsigned __int16 *)(a1 + 526), a1 + 264);
  v10 = sub_219888630(a1, (uint64_t)sub_2198C3648);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_SelectSector");
  return v10;
}

uint64_t sub_2198C2808(uint64_t a1)
{
  unsigned int v2;
  int v3;
  char v4;
  uint64_t v5;
  char v6;
  uint64_t v7;
  int v8;
  char v9;
  int v10;
  int v11;
  unsigned int v12;
  unsigned int v13;
  int v14;
  unsigned __int8 v15;
  unsigned int v16;
  uint64_t v17;
  char v18;
  uint64_t v19;
  char v20;
  uint64_t v21;

  v2 = *(unsigned __int8 *)(a1 + 70);
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_RdBeforeWrite");
  v3 = *(unsigned __int16 *)(a1 + 68);
  if ((v3 - 2) < 2)
  {
    v7 = sub_2198C22F0(a1, *(_BYTE *)(a1 + 70));
LABEL_7:
    v5 = v7;
    v6 = 0;
    goto LABEL_15;
  }
  if (v3 != 4)
  {
    if (v3 == 1)
    {
      v4 = *(_BYTE *)(a1 + 70);
      *(_BYTE *)(a1 + 647) = v4;
      *(_BYTE *)(a1 + 266) = v4;
      *(_BYTE *)(a1 + 267) = 3;
      v5 = 0;
      if (*(_DWORD *)(a1 + 248) < 0xFFu)
      {
        *(_BYTE *)(a1 + 268) = 0;
        v6 = 3;
      }
      else
      {
        *(_WORD *)(a1 + 268) = 255;
        *(_BYTE *)(a1 + 270) = 0;
        v6 = 5;
      }
    }
    else
    {
      v6 = 0;
      v5 = 29;
    }
    goto LABEL_15;
  }
  v8 = *(unsigned __int8 *)(a1 + 647);
  v2 = v8 + 1;
  if (v8 == 255)
  {
    v9 = *(_BYTE *)(a1 + 646) + 1;
    *(_BYTE *)(a1 + 646) = v9;
    v7 = sub_2198C26F4(a1, v9, 1, 17);
    goto LABEL_7;
  }
  *(_BYTE *)(a1 + 647) = v2;
  *(_BYTE *)(a1 + 266) = v2;
  v5 = 0;
  if (*(_DWORD *)(a1 + 248) < 0xFFu)
  {
    *(_BYTE *)(a1 + 267) = 0;
    v6 = 2;
  }
  else
  {
    *(_WORD *)(a1 + 267) = 255;
    *(_BYTE *)(a1 + 269) = 0;
    v6 = 4;
  }
LABEL_15:
  v10 = *(unsigned __int16 *)(a1 + 68);
  if (v10 == 1)
  {
    if (v2 > 0xFF)
      goto LABEL_37;
  }
  else if (v10 != 4 || v2 >= 0x100)
  {
    goto LABEL_37;
  }
  if (v10 == 1)
    v11 = 2;
  else
    v11 = 3;
  v12 = *(_DWORD *)(a1 + 248);
  if (v12 <= 0xFE)
    v13 = v11;
  else
    v13 = v11 - 2;
  if (v12 >= v13)
  {
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 212) = v13;
    if (v6 + (_BYTE)v13)
      **(_WORD **)(a1 + 528) = (v6 + v13) - 1;
  }
  else
  {
    phOsalNfc_MemCopy();
    v14 = *(_DWORD *)(a1 + 248);
    *(_WORD *)(a1 + 212) = v14;
    v15 = v6 + v14;
    v16 = (v6 + v14);
    **(_WORD **)(a1 + 528) = v16 - 1;
    if (v16 <= 4)
    {
      v17 = 0;
      *(_BYTE *)(a1 + 74) = 1;
      v18 = v15 + 1;
      v19 = a1 + v15 + 266;
      do
      {
        if (v17)
          v20 = 0;
        else
          v20 = -2;
        *(_BYTE *)(v19 + v17) = v20;
        v21 = (v18 + v17++);
      }
      while (v21 != 5);
    }
  }
  phOsalNfc_MemCopy();
  phOsalNfc_MemCopy();
  *(_BYTE *)a1 = 2;
  v5 = sub_2198C556C(a1);
LABEL_37:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_RdBeforeWrite");
  return v5;
}

uint64_t sub_2198C2AA4(uint64_t a1)
{
  unsigned int v2;
  int v3;
  unsigned __int16 v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  int v8;
  unsigned int v9;
  unsigned int v10;
  unsigned __int16 *v11;
  uint64_t v12;
  unsigned int v13;
  int v14;
  uint64_t v16;
  unsigned int v17;
  BOOL v20;
  char v21;
  int v22;
  uint64_t v23;
  int v24;
  unsigned int v25;
  unsigned int v26;
  unsigned __int16 *v27;
  unsigned int v28;
  unsigned int v29;
  uint64_t v31;
  uint64_t v32;
  unsigned int v33;
  char v36;
  uint64_t v37;
  unsigned int v38;
  unint64_t v39;
  unint64_t v40;
  unint64_t v41;
  unsigned int v42;
  unsigned int v43;
  unsigned __int8 v44;
  unint64_t v45;
  uint64_t v46;
  unint64_t v47;
  uint64x2_t v48;
  uint64_t v49;
  uint64_t v50;
  int32x2_t v51;
  char v52;
  char v53;
  int v54;
  int v55;
  int v56;
  int v57;
  int v58;
  int v59;
  uint64_t v60;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_fillSendBufToWr");
  phOsalNfc_MemCopy();
  phOsalNfc_MemCopy();
  v2 = *(_DWORD *)(a1 + 248) - *(unsigned __int16 *)(a1 + 252);
  if (v2 > *(unsigned __int16 *)(a1 + 650))
    LOWORD(v2) = *(_WORD *)(a1 + 650);
  *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 647);
  v3 = *(unsigned __int16 *)(a1 + 644);
  if (4 - v3 >= (unsigned __int16)v2)
    v4 = v2;
  else
    v4 = 4 - v3;
  if (*(_WORD *)(a1 + 212) || (v22 = *(unsigned __int16 *)(a1 + 214), !*(_WORD *)(a1 + 214)))
  {
    v5 = 0;
  }
  else
  {
    v4 -= v22;
    *(_BYTE *)(a1 + 267) = 0;
    if (v22 == 1)
    {
      v5 = 8;
    }
    else
    {
      *(_BYTE *)(a1 + 268) = 0;
      v5 = 12;
    }
  }
  if (v3)
    phOsalNfc_MemCopy();
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"FindLockBytePosition");
  v6 = *(unsigned __int8 *)(a1 + 130);
  if (*(_BYTE *)(a1 + 130))
  {
    v7 = 0;
    v8 = 4 * *(unsigned __int8 *)(a1 + 647);
    v9 = v8 & 0xFFFF03FF | ((*(_BYTE *)(a1 + 646) & 0x3F) << 10);
    v10 = v9 + 4;
    v11 = (unsigned __int16 *)(a1 + 98);
    v12 = v5;
    do
    {
      v13 = *(v11 - 1);
      v14 = *v11;
      if (v9 <= (unsigned __int16)(v13 + v14 - 1) && v10 > v13)
      {
        v17 = (unsigned __int16)(v13 + v14 - 1);
        if (v13 < v9 && v10 > v17)
        {
          v5 = (15 << (v10 - (v13 + v14))) & 0xF | v12;
          v16 = v7 + v17 - v8 + 1;
        }
        else if (v13 < v9 || v10 > v17)
        {
          v16 = 4;
          v5 = 15;
          v20 = v13 >= v9;
          v21 = v13 - 4 * *(_BYTE *)(a1 + 647);
          if (v20 && v10 >= v17)
          {
            v5 = v12 | (15 << (v10 + ~(_BYTE)v17)) & (0xFu >> v21);
            v16 = (v7 + v14);
          }
        }
        else
        {
          v5 = v12 | (0xFu >> (v13 - v8));
          v16 = v7 + v8 + 4 - v13;
        }
      }
      else
      {
        v5 = v12;
        v16 = v7;
      }
      v11 += 2;
      v12 = v5;
      v7 = v16;
      --v6;
    }
    while (v6);
  }
  else
  {
    v16 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"FindLockBytePosition");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"FindResBytePosition");
  v23 = *(unsigned __int8 *)(a1 + 184);
  if (*(_BYTE *)(a1 + 184))
  {
    v24 = 4 * *(unsigned __int8 *)(a1 + 647);
    v25 = v24 & 0xFFFF03FF | ((*(_BYTE *)(a1 + 646) & 0x3F) << 10);
    v26 = v25 + 4;
    v27 = (unsigned __int16 *)(a1 + 152);
    while (1)
    {
      v28 = *(v27 - 1);
      v29 = *v27;
      if (v25 <= (unsigned __int16)(v28 + v29 - 1) && v26 > v28)
      {
        v33 = (unsigned __int16)(v28 + v29 - 1);
        if (v28 < v25 && v26 > v33)
        {
          v31 = (15 << (v26 - (v28 + v29))) & 0xF | v5;
          v32 = v16 + v33 - v24 + 1;
        }
        else
        {
          if (v28 < v25 || v26 > v33)
          {
            v32 = 4;
            v31 = 15;
            v20 = v28 >= v25;
            v36 = v28 - 4 * *(_BYTE *)(a1 + 647);
            if (!v20 || v26 < v33)
              goto LABEL_59;
            v31 = v5 | (15 << (v26 + ~(_BYTE)v33)) & (0xFu >> v36);
          }
          else
          {
            v31 = v5 | (0xFu >> (v28 - v24));
            v29 = v24 + 4 - v28;
          }
          v32 = v16 + v29;
        }
      }
      else
      {
        v31 = v5;
        v32 = v16;
      }
LABEL_59:
      v27 += 2;
      v5 = v31;
      v16 = v32;
      if (!--v23)
        goto LABEL_62;
    }
  }
  LOBYTE(v31) = v5;
  LOBYTE(v32) = v16;
LABEL_62:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"FindResBytePosition");
  if (!(_BYTE)v32)
  {
    v38 = v4;
    phOsalNfc_MemCopy();
    goto LABEL_78;
  }
  if ((v31 & 8) != 0 || (v37 = *(unsigned __int16 *)(a1 + 252), *(_DWORD *)(a1 + 248) <= v37))
  {
    v38 = 0;
    if ((v31 & 4) != 0)
      goto LABEL_70;
LABEL_68:
    v39 = *(unsigned __int16 *)(a1 + 252) + (unint64_t)v38;
    if (*(_DWORD *)(a1 + 248) > v39)
    {
      *(_BYTE *)(a1 + 268) = *(_BYTE *)(*(_QWORD *)(a1 + 240) + v39);
      ++v38;
    }
    goto LABEL_70;
  }
  *(_BYTE *)(a1 + 267) = *(_BYTE *)(*(_QWORD *)(a1 + 240) + v37);
  v38 = 1;
  if ((v31 & 4) == 0)
    goto LABEL_68;
LABEL_70:
  if ((v31 & 2) == 0)
  {
    v40 = *(unsigned __int16 *)(a1 + 252) + (unint64_t)v38;
    if (*(_DWORD *)(a1 + 248) > v40)
    {
      *(_BYTE *)(a1 + 269) = *(_BYTE *)(*(_QWORD *)(a1 + 240) + v40);
      ++v38;
    }
  }
  if ((v31 & 1) == 0)
  {
    v41 = *(unsigned __int16 *)(a1 + 252) + (unint64_t)v38;
    if (*(_DWORD *)(a1 + 248) > v41)
    {
      *(_BYTE *)(a1 + 270) = *(_BYTE *)(*(_QWORD *)(a1 + 240) + v41);
      ++v38;
    }
  }
  v4 = v38;
LABEL_78:
  *(_WORD *)(a1 + 212) = v4;
  **(_WORD **)(a1 + 528) = v4 + v32 + *(_WORD *)(a1 + 644) + *(_WORD *)(a1 + 214);
  v42 = v38 + *(unsigned __int16 *)(a1 + 644);
  if (v42 + v32 <= 3)
  {
    v43 = v42 + *(unsigned __int16 *)(a1 + 214);
    v44 = v32 + v43 + 1;
    if ((v32 + v42 + *(_WORD *)(a1 + 214) + 1) <= 4u)
    {
      v45 = 0;
      v46 = v32 + v43 + 1;
      *(_BYTE *)(a1 + 74) = 1;
      v47 = (6 - v44) & 0xFFFFFFFFFFFFFFFELL;
      v48 = (uint64x2_t)vdupq_n_s64(4 - (unint64_t)v44);
      v49 = v46 - v44;
      v50 = a1 + v44;
      do
      {
        v51 = vmovn_s64((int64x2_t)vcgeq_u64(v48, (uint64x2_t)vorrq_s8((int8x16_t)vdupq_n_s64(v45), (int8x16_t)xmmword_21990ADE0)));
        if ((v51.i8[0] & 1) != 0)
        {
          if (v49 == v45)
            v52 = -2;
          else
            v52 = 0;
          *(_BYTE *)(v50 + v45 + 266) = v52;
        }
        if ((v51.i8[4] & 1) != 0)
        {
          if (v49 - 1 == v45)
            v53 = -2;
          else
            v53 = 0;
          *(_BYTE *)(v50 + v45 + 267) = v53;
        }
        v45 += 2;
      }
      while (v47 != v45);
    }
  }
  phOsalNfc_MemCopy();
  v54 = *(unsigned __int8 *)(a1 + 67);
  v55 = *(unsigned __int8 *)(a1 + 646);
  if (*(unsigned __int16 *)(a1 + 68) <= 3u)
  {
    if (v54 == v55)
    {
      v56 = *(unsigned __int8 *)(a1 + 647);
      v57 = *(unsigned __int8 *)(a1 + 70);
      if (v56 != v57)
      {
LABEL_98:
        v58 = v57 + 1;
        goto LABEL_105;
      }
      phOsalNfc_MemCopy();
      v54 = *(unsigned __int8 *)(a1 + 67);
      v55 = *(unsigned __int8 *)(a1 + 646);
    }
    if (v54 != v55)
      goto LABEL_107;
    v57 = *(unsigned __int8 *)(a1 + 70);
    v56 = *(unsigned __int8 *)(a1 + 647);
    goto LABEL_98;
  }
  if (v54 != v55)
    goto LABEL_102;
  v56 = *(unsigned __int8 *)(a1 + 647);
  v59 = *(unsigned __int8 *)(a1 + 70);
  if (v59 + 1 == v56)
  {
    phOsalNfc_MemCopy();
    v54 = *(unsigned __int8 *)(a1 + 67);
    v55 = *(unsigned __int8 *)(a1 + 646);
LABEL_102:
    if (v54 != v55)
      goto LABEL_107;
    v59 = *(unsigned __int8 *)(a1 + 70);
    v56 = *(unsigned __int8 *)(a1 + 647);
  }
  v58 = v59 + 2;
LABEL_105:
  if (v58 == v56)
    phOsalNfc_MemCopy();
LABEL_107:
  *(_BYTE *)a1 = 2;
  *(_WORD *)(a1 + 214) = 0;
  v60 = sub_2198C556C(a1);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_fillSendBufToWr");
  return v60;
}

uint64_t sub_2198C30FC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_ChkNdef");
  sub_21988EF68(v9, &v8);
  v5 = 1;
  if (a3)
  {
    if (a2)
    {
      v6 = v8;
      if (v8)
      {
        *(_QWORD *)(v8 + 8) = a2;
        *(_BYTE *)(v6 + 204) &= 0xFCu;
        *(_BYTE *)(v6 + 70) = 4;
        *(_WORD *)(v6 + 647) = 2;
        *(_BYTE *)(v6 + 547) = 1;
        *(_BYTE *)(v6 + 208) = 0;
        *(_WORD *)(v6 + 2710) = 0;
        *(_BYTE *)(v6 + 540) = 1;
        *(_BYTE *)(v6 + 266) = 2;
        *(_BYTE *)v6 = 3;
        *(_WORD *)(v6 + 526) = 1;
        *(_BYTE *)(v6 + 544) = 1;
        *(_DWORD *)(v6 + 232) = 48;
        *(_QWORD *)(v6 + 40) = a3;
        *(_QWORD *)(v6 + 48) = sub_2198C3220;
        *(_QWORD *)(v6 + 56) = v6;
        *(_WORD *)(v6 + 264) = 16;
        sub_2198C3384((unsigned int *)v6, 48, v6 + 266, 1, v6 + 264);
        v5 = sub_219888630(v8, (uint64_t)sub_2198C3648);
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_ChkNdef");
  return v5;
}

uint64_t sub_2198C3220(uint64_t a1, unsigned int *a2, uint64_t a3)
{
  uint64_t v5;
  unsigned __int8 v6;
  char *v7;
  int v8;
  uint64_t (*v9)(unsigned int *, char *);
  uint64_t v11;

  v11 = a1;
  sub_219850718(0, (unsigned int *)&v11, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_Process");
  byte_2550A428D = 0;
  sub_219850628(0, a2 + 678, 8u, 4u, (uint64_t)"Received response from card!");
  if ((_DWORD)a3)
    goto LABEL_12;
  sub_219850718(2, a2, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_GetNdefFuncIndex");
  v5 = 0;
  v6 = -1;
  v7 = &byte_24DB722A8;
  do
  {
    v8 = *v7;
    v7 += 16;
    if (*(unsigned __int8 *)a2 == v8)
      v6 = v5;
    ++v5;
  }
  while (v5 != 20);
  sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_GetNdefFuncIndex");
  if (v6 == 0xFF)
  {
    a3 = 245;
    sub_2198C5F98((uint64_t)a2, 245);
  }
  else
  {
    v9 = (uint64_t (*)(unsigned int *, char *))*(&off_24DB722A0 + 2 * v6);
    a3 = v9 ? v9(a2, &byte_2550A428D) : 0;
  }
  if (byte_2550A428D == 1)
LABEL_12:
    sub_2198C5F98((uint64_t)a2, a3);
  return sub_219850808(0, (unsigned int *)&v11, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_Process");
}

uint64_t sub_2198C3384(unsigned int *a1, int a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  const char *v9;

  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phLibNfc_PrintSendData");
  sub_219850628(2, a1, 8u, 4u, (uint64_t)"==============================================");
  if (a2 > 96)
  {
    if (a2 <= 175)
    {
      if (a2 > 161)
      {
        if (a2 == 162)
        {
          v9 = "Mif Cmd: phHal_eMifareWrite4";
          goto LABEL_41;
        }
        if (a2 == 168)
        {
          v9 = "Mif Cmd: phHal_eMifareWriteSector";
          goto LABEL_41;
        }
        goto LABEL_40;
      }
      if (a2 == 97)
      {
        v9 = "Mif Cmd: phHal_eMifareAuthentB";
        goto LABEL_41;
      }
      if (a2 != 160)
        goto LABEL_40;
      v9 = "Mif Cmd: phHal_eMifareWrite16";
    }
    else
    {
      if (a2 <= 192)
      {
        if (a2 == 176)
        {
          v9 = "Mif Cmd: phHal_eMifareTransfer";
          goto LABEL_41;
        }
        if (a2 == 192)
        {
          v9 = "Mif Cmd: phHal_eMifareDec";
          goto LABEL_41;
        }
        goto LABEL_40;
      }
      if (a2 == 193)
      {
        v9 = "Mif Cmd: phHal_eMifareInc";
        goto LABEL_41;
      }
      if (a2 == 194)
      {
        v9 = "Mif Cmd: phHal_eMifareRestore";
        goto LABEL_41;
      }
      if (a2 != 255)
        goto LABEL_40;
      v9 = "Mif Cmd: phHal_eMifareInvalidCmd";
    }
LABEL_41:
    sub_219850628(2, a1, 8u, 4u, (uint64_t)v9);
    goto LABEL_42;
  }
  if (a2 <= 47)
  {
    switch(a2)
    {
      case 0:
        v9 = "Mif Cmd: phHal_eMifareRaw";
        break;
      case 1:
        v9 = "Mif Cmd: phHal_eMifareReadN";
        break;
      case 2:
        v9 = "Mif Cmd: phHal_eMifareWriteN";
        break;
      case 3:
        v9 = "Mif Cmd: phHal_eMifareSectorSel";
        break;
      case 4:
        v9 = "Mif Cmd: phHal_eMifareAuth";
        break;
      case 5:
        v9 = "Mif Cmd: phHal_eMifareProxCheck";
        break;
      default:
        goto LABEL_40;
    }
    goto LABEL_41;
  }
  if (a2 != 48)
  {
    if (a2 == 56)
    {
      v9 = "Mif Cmd: phHal_eMifareReadSector";
      goto LABEL_41;
    }
    if (a2 == 96)
    {
      v9 = "Mif Cmd: phHal_eMifareAuthentA";
      goto LABEL_41;
    }
LABEL_40:
    v9 = "Mif Cmd: Invalid";
    goto LABEL_41;
  }
  sub_219850628(2, a1, 8u, 4u, (uint64_t)"Mif Cmd: phHal_eMifareRead16/phHal_eMifareRead");
  if (a3)
  {
    sub_219851888(2, a1, 8u, 4u, (uint64_t)"Block address");
    sub_219851888(2, a1, 8u, 4u, (uint64_t)"Length of Send buffer");
  }
  if (a5)
    sub_219851888(2, a1, 8u, 4u, (uint64_t)"Length of receive buffer");
LABEL_42:
  sub_219850628(2, a1, 8u, 4u, (uint64_t)"==============================================");
  return sub_219850808(2, a1, 8u, 5u, (uint64_t)"phLibNfc_PrintSendData");
}

uint64_t sub_2198C3648(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_CB_Transceive");
  sub_21988EF68(v10, &v9);
  v7 = v9;
  if (v9)
  {
    if (a4)
      *(_WORD *)(v9 + 264) = *(_DWORD *)(a4 + 8);
    (*(void (**)(_QWORD, uint64_t, uint64_t))(v7 + 48))(*(_QWORD *)(v7 + 2712), v7, a5);
  }
  return sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_CB_Transceive");
}

uint64_t sub_2198C36DC(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = a1;
  sub_219850718(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_MfUL_ConvertToReadOnly");
  sub_21988EF68(v9, &v8);
  v5 = 1;
  if (a2)
  {
    v6 = v8;
    if (v8)
    {
      *(_QWORD *)(v8 + 32) = a2;
      *(_QWORD *)(v6 + 40) = a3;
      *(_BYTE *)(v6 + 547) = 6;
      *(_WORD *)(v6 + 647) = 1027;
      *(_WORD *)(v6 + 2710) = 0;
      *(_BYTE *)(v6 + 540) = 1;
      *(_BYTE *)(v6 + 266) = 3;
      *(_WORD *)(v6 + 526) = 1;
      *(_BYTE *)v6 = 7;
      *(_BYTE *)(v6 + 544) = 1;
      *(_DWORD *)(v6 + 232) = 48;
      *(_QWORD *)(v6 + 48) = sub_2198C3220;
      *(_QWORD *)(v6 + 56) = v6;
      *(_WORD *)(v6 + 264) = 16;
      sub_2198C3384((unsigned int *)v6, 48, v6 + 266, 1, v6 + 264);
      v5 = sub_219888630(v8, (uint64_t)sub_2198C3648);
    }
  }
  sub_219850808(0, (unsigned int *)&v9, 8u, 5u, (uint64_t)"phFriNfc_MfUL_ConvertToReadOnly");
  return v5;
}

uint64_t sub_2198C37E8(uint64_t a1, BOOL *a2)
{
  int v4;
  const char *v5;
  uint64_t v6;
  unsigned int v7;
  __int16 v8;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iChkNdefComp");
  if (*(_WORD *)(a1 + 264) != 16)
  {
    *a2 = 1;
    v6 = 27;
    goto LABEL_23;
  }
  sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Checking CC in the response");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_ChkCCBytes");
  sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Verifying Capability container (CC) of the card...");
  v4 = *(unsigned __int8 *)(a1 + 273);
  if (*(_BYTE *)(a1 + 273))
  {
    if (v4 != 15)
    {
      sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Invalid Read/Write state");
      *(_BYTE *)(a1 + 545) = 3;
      goto LABEL_11;
    }
    LOBYTE(v4) = 1;
    v5 = "Card is Read-Only";
  }
  else
  {
    v5 = "Card is Read-Writable";
  }
  sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)v5);
  *(_BYTE *)(a1 + 545) = v4;
  if (*(unsigned __int8 *)(a1 + 270) == 225)
  {
    sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"NFC Forum defined data is stored in the data area (Byte 0 of CC is 0xE1)");
    v6 = sub_21988B8FC(a1, 5u);
    if ((_DWORD)v6)
      v7 = *(unsigned __int16 *)(a1 + 202);
    else
      v7 = 8 * *(unsigned __int8 *)(a1 + 272);
    *(_WORD *)(a1 + 202) = v7;
    *(_WORD *)(a1 + 650) = v7;
    if (v7 >= 0x101)
    {
      v8 = v7 - 2;
      *(_WORD *)(a1 + 202) = v8;
      *(_WORD *)(a1 + 650) = v8;
    }
    sub_219851888(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Memory size:)");
    goto LABEL_16;
  }
LABEL_11:
  sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Failed: Either E1 byte check failed or card is in invalid state");
  *(_BYTE *)(a1 + 545) = 3;
  v6 = 22;
LABEL_16:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_ChkCCBytes");
  *a2 = (_DWORD)v6 != 0;
  if ((_DWORD)v6)
  {
    *(_BYTE *)(a1 + 647) = 4;
  }
  else
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_ChkLockBits");
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_ChkLockBits");
    *(_BYTE *)(a1 + 647) = 4;
    v6 = sub_2198C22F0(a1, 4);
  }
  if ((_DWORD)v6 == 13)
  {
    *a2 = *a2;
  }
  else
  {
    *a2 = 1;
    if ((_DWORD)v6)
      *(_BYTE *)(a1 + 545) = 3;
  }
LABEL_23:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iChkNdefComp");
  return v6;
}

uint64_t sub_2198C3A90(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  unsigned int v5;
  int v6;
  int v7;
  unsigned int v8;
  uint64_t v9;
  unsigned __int8 v10;
  int v11;
  __int16 v12;
  unsigned int v13;
  __int16 v14;
  unsigned __int16 *v15;
  unsigned int v16;
  unsigned int v17;
  _WORD *v19;
  unint64_t v20;
  __int16 v21;
  uint64_t v22;
  BOOL v23;
  uint64_t v24;
  int v25;
  __int16 v26;
  unsigned int v27;
  __int16 v28;
  unsigned __int16 *v29;
  unsigned int v30;
  unsigned int v31;
  _WORD *v33;
  unint64_t v34;
  __int16 v35;
  unint64_t v36;
  __int16 v37;
  __int16 v38;
  __int16 v39;
  __int16 v40;
  __int16 *v41;
  unsigned __int8 v42;
  __int16 v43;
  __int16 v44;
  unsigned int v45;
  int v46;
  unsigned int v47;
  uint64_t v48;
  uint64_t v49;
  int v50;
  int v51;
  BOOL v52;
  uint64_t v53;
  __int16 v54;
  int v56;
  char v57;
  _OWORD v58[4];
  uint64_t v59;

  v59 = *MEMORY[0x24BDAC8D0];
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iRead");
  if (*(_WORD *)(a1 + 264) != 16)
  {
    v22 = 27;
    v23 = 1;
    goto LABEL_79;
  }
  v4 = *(unsigned __int16 *)(a1 + 80);
  v5 = *(unsigned __int16 *)(a1 + 2700);
  if (v4 >= 0xFF)
    v6 = 4;
  else
    v6 = 2;
  v7 = v4 + v6 - 1;
  v8 = v7 + *(unsigned __int16 *)(a1 + 68) + 4 * (*(_BYTE *)(a1 + 70) & 3) + *(unsigned __int16 *)(a1 + 2710);
  if (v8 > v5)
  {
    memset(v58, 0, sizeof(v58));
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_CopyRdBytes");
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"cpDynLockBytes");
    v9 = *(unsigned __int8 *)(a1 + 130);
    if (*(_BYTE *)(a1 + 130))
    {
      v10 = 0;
      v11 = 4 * *(unsigned __int8 *)(a1 + 647);
      v12 = v11 & 0xC;
      v13 = v11 & 0xFFFF03FF | ((*(_BYTE *)(a1 + 646) & 0x3F) << 10);
      v14 = 16 - v12;
      v15 = (unsigned __int16 *)(a1 + 98);
      do
      {
        v16 = *(v15 - 1);
        v17 = *v15;
        if (v13 <= (unsigned __int16)(v16 + v17 - 1) && v13 + 16 > v16)
        {
          v19 = (_WORD *)v58 + 2 * v10;
          if (v16 <= v13)
          {
            *v19 = v13;
            if ((unsigned __int16)(v16 + v17 - v13) <= 0x10u)
              v21 = v16 + v17 - v13;
            else
              v21 = v14;
            *((_WORD *)v58 + 2 * v10 + 1) = v21;
          }
          else
          {
            *v19 = v16;
            v20 = (unint64_t)v58 + 4 * v10;
            *(_WORD *)(v20 + 2) = v17;
            if (v17 >= 0x11)
              *(_WORD *)(v20 | 2) = 16 - (v16 & 0xF);
          }
          ++v10;
        }
        v15 += 2;
        --v9;
      }
      while (v9);
    }
    else
    {
      v10 = 0;
    }
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"cpDynLockBytes");
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"cpReservedBytes");
    v24 = *(unsigned __int8 *)(a1 + 184);
    if (*(_BYTE *)(a1 + 184))
    {
      v25 = 4 * *(unsigned __int8 *)(a1 + 647);
      v26 = v25 & 0xC;
      v27 = v25 & 0xFFFF03FF | ((*(_BYTE *)(a1 + 646) & 0x3F) << 10);
      v28 = 16 - v26;
      v29 = (unsigned __int16 *)(a1 + 152);
      do
      {
        v30 = *(v29 - 1);
        v31 = *v29;
        if (v27 <= (unsigned __int16)(v30 + v31 - 1) && v27 + 16 > v30)
        {
          v33 = (_WORD *)v58 + 2 * v10;
          if (v30 <= v27)
          {
            *v33 = v27;
            if ((unsigned __int16)(v30 + v31 - v27) <= 0x10u)
              v35 = v30 + v31 - v27;
            else
              v35 = v28;
            *((_WORD *)v58 + 2 * v10 + 1) = v35;
          }
          else
          {
            *v33 = v30;
            v34 = (unint64_t)v58 + 4 * v10;
            *(_WORD *)(v34 + 2) = v31;
            if (v31 >= 0x11)
              *(_WORD *)(v34 | 2) = 16 - (v30 & 0xF);
          }
          ++v10;
        }
        v29 += 2;
        --v24;
      }
      while (v24);
    }
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"cpReservedBytes");
    sub_21988BA0C((unsigned int *)a1, v58, v10);
    if (v10)
    {
      v56 = v7;
      v36 = 0;
      v37 = 0;
      v38 = 0;
      LOBYTE(v39) = 0;
      v57 = v58[0];
      v40 = v5;
      v41 = (__int16 *)v58;
      v42 = v10;
      v43 = v40;
      do
      {
        if (v36)
          v44 = *v41 - (v38 + v37);
        else
          LOBYTE(v44) = v57 - 4 * *(_BYTE *)(a1 + 647);
        if ((_BYTE)v44)
        {
          phOsalNfc_MemCopy();
          v43 += v44;
          v42 = v10;
        }
        v38 = *v41;
        v37 = v41[1];
        v39 = (v44 + v39 + v37);
        ++v36;
        v41 += 2;
      }
      while (v36 < v42);
      LOWORD(v5) = v43;
      v7 = v56;
    }
    else
    {
      v39 = 0;
    }
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 2700) = v5 - v39 + 16;
    v45 = *(unsigned __int16 *)(a1 + 80);
    if (v45 >= 0xFF)
      v46 = 4;
    else
      v46 = 2;
    v47 = *(unsigned __int8 *)(a1 + 647)
        + 4 * (v46 + v45 + *(unsigned __int16 *)(a1 + 2710) > (unsigned __int16)(v5 - v39 + 16));
    if (v47 > 0xFF)
    {
      if (!*(_BYTE *)(a1 + 646))
      {
        *(_WORD *)(a1 + 646) = -255;
        v22 = sub_2198C26F4(a1, 1, 1, 13);
        sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_CopyRdBytes");
        if ((_DWORD)v22)
        {
          v23 = 0;
          goto LABEL_79;
        }
        goto LABEL_58;
      }
    }
    else
    {
      *(_BYTE *)(a1 + 647) = v47;
    }
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_CopyRdBytes");
LABEL_58:
    v5 = *(unsigned __int16 *)(a1 + 2700);
    v8 = v7 + *(unsigned __int16 *)(a1 + 68) + 4 * (*(_BYTE *)(a1 + 70) & 3) + *(unsigned __int16 *)(a1 + 2710);
  }
  if (v8 <= v5)
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_CalcByteNum");
    v49 = 652;
    while (1)
    {
      if (*(_BYTE *)(a1 + v49) == 3)
      {
        v50 = *(unsigned __int8 *)(a1 + v49 + 1);
        v51 = *(unsigned __int16 *)(a1 + 80);
        v52 = v50 == 255 || v51 == v50;
        if (v52 && (v50 != 255 || v51 == bswap32(*(unsigned __int16 *)(a1 + v49 + 2)) >> 16))
          break;
      }
      if (++v49 == 668)
        goto LABEL_73;
    }
    *(_WORD *)(a1 + 2702) = v49 - 651;
LABEL_73:
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_CalcByteNum");
    v53 = *(unsigned __int16 *)(a1 + 2702);
    if (*(unsigned __int8 *)(a1 + 652 + v53) == 255)
      v54 = v53 + 3;
    else
      v54 = v53 + 1;
    *(_WORD *)(a1 + 2702) = v54;
    sub_2198C23D8(a1);
    v23 = 1;
    if (!*(_BYTE *)(a1 + 646))
    {
      v22 = 0;
      goto LABEL_79;
    }
    *(_BYTE *)(a1 + 646) = 0;
    *(_BYTE *)(a1 + 543) = 1;
    v48 = sub_2198C26F4(a1, 0, 1, 11);
  }
  else
  {
    v48 = sub_2198C4084(a1);
  }
  v22 = v48;
  v23 = (_DWORD)v48 != 13;
LABEL_79:
  *a2 = v23;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iRead");
  return v22;
}

uint64_t sub_2198C4084(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_Rd16Bytes");
  v2 = 1;
  *(_BYTE *)a1 = 1;
  *(_BYTE *)(a1 + 540) = 2;
  if (*(_DWORD *)(a1 + 248) > *(unsigned __int16 *)(a1 + 252))
  {
    *(_BYTE *)(a1 + 204) &= 0xFCu;
    *(_BYTE *)(a1 + 208) = 0;
    *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 647);
    *(_WORD *)(a1 + 526) = 1;
    *(_WORD *)(a1 + 264) = 260;
    *(_DWORD *)(a1 + 232) = 48;
    v2 = sub_219888630(a1, (uint64_t)sub_2198C3648);
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_Rd16Bytes");
  return v2;
}

uint64_t sub_2198C4144(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  unsigned int v5;
  int v6;
  unsigned __int16 v7;
  int v8;
  uint64_t v9;
  int v10;
  int v11;
  int v12;
  uint64_t v13;
  BOOL v14;
  char v15;
  uint64_t v16;
  char v17;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iWrite");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_ProWrittenBytes");
  v4 = *(unsigned __int16 *)(a1 + 252);
  v5 = *(_DWORD *)(a1 + 248);
  if (v5 <= v4)
  {
    v9 = 29;
  }
  else
  {
    v6 = *(unsigned __int16 *)(a1 + 212);
    v7 = v6 + v4;
    *(_WORD *)(a1 + 252) = v6 + v4;
    if (**(unsigned __int16 **)(a1 + 528) > 3u)
    {
      v8 = 0;
    }
    else
    {
      phOsalNfc_MemCopy();
      v8 = **(unsigned __int16 **)(a1 + 528);
      v6 = *(unsigned __int16 *)(a1 + 212);
      v7 = *(_WORD *)(a1 + 252);
      v5 = *(_DWORD *)(a1 + 248);
    }
    *(_WORD *)(a1 + 644) = v8;
    v10 = *(unsigned __int16 *)(a1 + 650);
    *(_WORD *)(a1 + 650) = v10 - v6;
    if (v5 == v7 || v10 == v6)
    {
      *(_BYTE *)(a1 + 2704) = v10 == v6;
      v14 = v10 == v6 || *(_BYTE *)(a1 + 74) == 1;
      *(_BYTE *)(a1 + 74) = v14;
      if (v8)
        v15 = *(_BYTE *)(a1 + 647);
      else
        v15 = *(_BYTE *)(a1 + 647) + 1;
      *(_BYTE *)(a1 + 647) = v15;
      **(_DWORD **)(a1 + 256) = v7;
      if (!v14)
        goto LABEL_27;
      goto LABEL_19;
    }
    v11 = *(unsigned __int8 *)(a1 + 647);
    v12 = sub_2198C6460(a1, (unsigned __int16)v11 + 1, *(unsigned __int8 *)(a1 + 646));
    if (v11 == 255)
    {
      if (!v12 || !sub_2198C653C(a1, 256, *(unsigned __int8 *)(a1 + 646)))
        *(_BYTE *)(a1 + 540) = 5;
      v17 = *(_BYTE *)(a1 + 646) + 1;
      *(_BYTE *)(a1 + 646) = v17;
      v13 = sub_2198C26F4(a1, v17, 1, 15);
    }
    else if (v12 && sub_2198C653C(a1, (unsigned __int16)v11 + 1, *(unsigned __int8 *)(a1 + 646)))
    {
      ++*(_BYTE *)(a1 + 647);
      v13 = sub_2198C2AA4(a1);
    }
    else
    {
      *(_BYTE *)(a1 + 540) = 5;
      v13 = sub_2198C22F0(a1, v11 + 1);
    }
    v9 = v13;
    if (!(_DWORD)v13)
    {
      if (*(_BYTE *)(a1 + 74) != 1)
      {
LABEL_27:
        if (!*(_WORD *)(a1 + 650))
        {
          v9 = 0;
          goto LABEL_31;
        }
        v16 = sub_2198C4A80(a1);
        goto LABEL_29;
      }
LABEL_19:
      v16 = sub_2198C4B08(a1);
LABEL_29:
      v9 = v16;
    }
  }
LABEL_31:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_ProWrittenBytes");
  *a2 = (_DWORD)v9 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iWrite");
  return v9;
}

uint64_t sub_2198C4398(uint64_t a1, _BYTE *a2)
{
  int v4;
  BOOL v5;
  unsigned __int16 v6;
  unsigned __int16 v7;
  int v8;
  int v9;
  int v10;
  int v11;
  int v12;
  uint64_t v13;
  unsigned __int16 v14;
  uint64_t v15;
  unsigned int v16;
  __int16 v17;
  int v18;
  uint64_t v19;
  __int16 v20;
  int v21;
  uint64_t v22;
  unsigned int v23;
  unsigned int v24;
  unsigned int v25;
  int v26;
  int v27;
  int v28;
  uint64_t v29;
  __int16 v30;
  unsigned __int8 v31;
  char v32;
  unsigned int *v34;
  const char *v35;
  unsigned int v36;
  uint64_t v37;
  unsigned int v38;
  int v39;
  unsigned __int16 v40;
  uint64_t v41;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_findNDEFTLV");
  if (*(_BYTE *)(a1 + 72) == 1
    || ((v4 = *(unsigned __int16 *)(a1 + 68), v5 = v4 != 0, v6 = v4 - 1, v5) ? (v7 = v6) : (v7 = 0),
        *(_BYTE *)(a1 + 73) == 1))
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"procSplitTlv");
    if (*(_BYTE *)(a1 + 72) == 1)
    {
      v7 = *(unsigned __int8 *)(a1 + 266) + 1;
      v8 = *(unsigned __int8 *)(a1 + 2709);
      if (v8 == 2)
      {
        v9 = sub_2198C6308(a1, 1u);
      }
      else
      {
        if (v8 != 1)
        {
          v12 = 255;
          goto LABEL_18;
        }
        v9 = sub_2198C6190(a1, 1u);
      }
      v12 = v9;
LABEL_18:
      *(_BYTE *)(a1 + 72) = 0;
      goto LABEL_23;
    }
    if (*(_BYTE *)(a1 + 73) != 1)
    {
      sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"procSplitTlv");
LABEL_24:
      v13 = 255;
      goto LABEL_71;
    }
    v10 = *(unsigned __int8 *)(a1 + 2709);
    if (v10 == 2)
    {
      v11 = sub_2198C6308(a1, 0);
    }
    else
    {
      if (v10 != 1)
      {
        v12 = 255;
        goto LABEL_22;
      }
      v11 = sub_2198C6190(a1, 0);
    }
    v12 = v11;
LABEL_22:
    *(_BYTE *)(a1 + 73) = 0;
    v7 = 3;
LABEL_23:
    *(_BYTE *)(a1 + 75) = 0;
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"procSplitTlv");
    if (v12 != 255)
      goto LABEL_25;
    goto LABEL_24;
  }
  while (1)
  {
    while (1)
    {
LABEL_25:
      v14 = v7;
      v15 = a1 + v7;
      v16 = *(unsigned __int8 *)(v15 + 266);
      if (v16 > 0xFC)
      {
        if (v16 == 253)
          goto LABEL_34;
        if (v16 == 254)
        {
LABEL_64:
          *a2 = 1;
          goto LABEL_65;
        }
LABEL_66:
        *(_BYTE *)(a1 + 66) = v16 == 3;
        if (v16 != 3)
        {
          v34 = (unsigned int *)(a1 + 2712);
          v35 = "No NDEF TLV found!";
          goto LABEL_73;
        }
        *(_WORD *)(a1 + 68) = (v7 & 3) + 1;
        v31 = (*(_BYTE *)(a1 + 70) & 0xFC) + (v7 >> 2);
        *(_BYTE *)(a1 + 70) = v31;
        *(_BYTE *)(a1 + 67) = *(_BYTE *)(a1 + 646);
        *(_WORD *)(a1 + 650) = *(_WORD *)(a1 + 202)
                             - (v7 & 3 | (4 * v31))
                             - (*(unsigned __int8 *)(a1 + 131)
                              + *(unsigned __int8 *)(a1 + 185))
                             + 14;
        v19 = sub_2198C60DC(a1, v7);
        if ((_DWORD)v19)
          goto LABEL_69;
        if (!*(_WORD *)(a1 + 650))
          goto LABEL_65;
        v19 = sub_2198C60DC(a1, (unsigned __int16)(v7 + 1));
        if ((_DWORD)v19)
        {
LABEL_69:
          v13 = v19;
          *(_BYTE *)(a1 + 72) = 1;
          v32 = 3;
LABEL_70:
          *(_BYTE *)(a1 + 75) = v32;
          goto LABEL_71;
        }
        v36 = *(unsigned __int8 *)(a1 + (unsigned __int16)(v7 + 1) + 266);
        if (v36 == 255)
        {
          v37 = sub_2198C60DC(a1, (unsigned __int16)(v7 + 2));
          if ((_DWORD)v37)
          {
            v13 = v37;
            *(_BYTE *)(a1 + 72) = 1;
            v32 = 2;
            goto LABEL_70;
          }
          v39 = *(unsigned __int8 *)(a1 + (unsigned __int16)(v7 + 2) + 266);
          v40 = v7 + 3;
          v41 = sub_2198C60DC(a1, (unsigned __int16)(v7 + 3));
          if ((_DWORD)v41)
          {
            v13 = v41;
            *(_BYTE *)(a1 + 72) = 1;
            *(_BYTE *)(a1 + 75) = 1;
            *(_WORD *)(a1 + 76) = *(unsigned __int8 *)(a1 + v40 + 265);
            goto LABEL_71;
          }
          v36 = *(unsigned __int8 *)(a1 + v40 + 266) | (v39 << 8);
          if (v36 > *(unsigned __int16 *)(a1 + 650))
          {
            v13 = 1;
            *a2 = 1;
            goto LABEL_71;
          }
          *(_WORD *)(a1 + 78) = v36;
          *(_WORD *)(a1 + 80) = v36;
          *(_BYTE *)(a1 + 66) = 1;
          *(_BYTE *)(a1 + 67) = *(_BYTE *)(a1 + 646);
LABEL_94:
          if (*(_BYTE *)(a1 + 75))
          {
            v13 = 0;
            goto LABEL_71;
          }
          v29 = sub_21988B840(a1, v36);
LABEL_61:
          v13 = v29;
          goto LABEL_71;
        }
        *(_WORD *)(a1 + 78) = v36;
        *(_WORD *)(a1 + 80) = v36;
        v38 = *(unsigned __int16 *)(a1 + 650);
        if (v38 < v36 || v38 < 2)
        {
          if (v36)
            goto LABEL_86;
        }
        else if (v36 || *(_BYTE *)(a1 + 540) != 2)
        {
          goto LABEL_94;
        }
        if (!*(_BYTE *)(a1 + 65))
        {
          v13 = 157;
          goto LABEL_87;
        }
LABEL_86:
        v13 = 22;
LABEL_87:
        *a2 = 1;
        goto LABEL_71;
      }
      if (v16 - 1 >= 2)
        break;
LABEL_34:
      *(_WORD *)(a1 + 2710) += *(unsigned __int8 *)(v7 + a1 + 267) + 2;
      *(_BYTE *)(a1 + 2709) = *(_BYTE *)(v15 + 266);
      *(_WORD *)(a1 + 68) = (v7 & 3) + 1;
      v19 = sub_2198C60DC(a1, v7);
      if ((_DWORD)v19)
        goto LABEL_69;
      v20 = *(_WORD *)(a1 + 650) - 1;
      *(_WORD *)(a1 + 650) = v20;
      if (!v20)
        goto LABEL_65;
      v21 = v7 + 1;
      v19 = sub_2198C60DC(a1, (unsigned __int16)(v7 + 1));
      if ((_DWORD)v19)
        goto LABEL_69;
      v22 = a1 + (unsigned __int16)v21;
      v23 = *(unsigned __int8 *)(v22 + 266);
      if (*(_BYTE *)(v22 + 266))
      {
        if (v23 == 255)
          goto LABEL_64;
      }
      else if (*(_BYTE *)(a1 + 66) != 1)
      {
        goto LABEL_64;
      }
      *(_WORD *)(a1 + 78) = v23;
      *(_WORD *)(a1 + 80) = v23;
      v24 = *(unsigned __int16 *)(a1 + 650);
      if (v24 < v23 || v24 < 2 || !v23 && *(_BYTE *)(a1 + 540) == 2)
      {
        sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"No NDEF TLV found!");
        goto LABEL_64;
      }
      ++v7;
      if (*(_BYTE *)(a1 + 66) != 1)
      {
        *(_WORD *)(a1 + 68) = (((_BYTE)v14 + 2 + (_BYTE)v23) & 3) + 1;
        v25 = (*(_BYTE *)(a1 + 70) & 0xFC) + ((v21 + v23 + 1) >> 2);
        *(_BYTE *)(a1 + 70) = v25;
        if ((unsigned __int16)(v14 + 1) != 15 || (v26 = *(unsigned __int8 *)(a1 + 280), v26 != 2) && v26 != 1)
        {
          v27 = *(unsigned __int8 *)((unsigned __int16)(v14 + 1) + a1 + 265);
          if (v27 == 2)
          {
            v28 = sub_2198C6308(a1, (unsigned __int16)(v14 + 2));
          }
          else
          {
            if (v27 != 1)
              goto LABEL_59;
            v28 = sub_2198C6190(a1, (unsigned __int16)(v14 + 2));
          }
          if (v28 == 255)
            goto LABEL_24;
          LOWORD(v24) = *(_WORD *)(a1 + 650);
          goto LABEL_59;
        }
        *(_BYTE *)(a1 + 73) = 1;
        *(_BYTE *)(a1 + 647) = v25;
LABEL_59:
        v30 = *(unsigned __int8 *)(v22 + 266);
        *(_WORD *)(a1 + 650) = v24 + ~v30;
        v7 = v21 + v30 + 1;
        if ((unsigned __int16)(v21 + v30) >= 0x10u)
        {
          v29 = sub_2198C22F0(a1, *(_BYTE *)(a1 + 70));
          goto LABEL_61;
        }
      }
    }
    if (*(_BYTE *)(v15 + 266))
      goto LABEL_66;
    v17 = *(_WORD *)(a1 + 650) - 1;
    *(_WORD *)(a1 + 650) = v17;
    if (!v17)
      break;
    v18 = *(unsigned __int16 *)(a1 + 68);
    if (v18 == 4)
    {
      *(_WORD *)(a1 + 68) = 1;
      ++*(_BYTE *)(a1 + 70);
    }
    else
    {
      if (!*(_WORD *)(a1 + 68))
        LOBYTE(v18) = 1;
      *(_WORD *)(a1 + 68) = (v18 & 3) + 1;
    }
    ++v7;
    v29 = sub_2198C60DC(a1, (unsigned __int16)(v14 + 1));
    if ((_DWORD)v29)
      goto LABEL_61;
  }
  v34 = (unsigned int *)(a1 + 2712);
  v35 = "No NDEF TLV found, complete card has been read";
LABEL_73:
  sub_219850628(0, v34, 8u, 4u, (uint64_t)v35);
LABEL_65:
  v13 = 22;
LABEL_71:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_findNDEFTLV");
  return v13;
}

uint64_t sub_2198C4994(uint64_t a1, BOOL *a2)
{
  int v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_NxtOp");
  v4 = *(unsigned __int8 *)(a1 + 540);
  if (v4 == 2)
  {
    if (*(_BYTE *)(a1 + 67) == 1)
    {
      *(_WORD *)(a1 + 646) = 1;
      v6 = sub_2198C26F4(a1, 1, 1, 13);
    }
    else
    {
      *(_BYTE *)(a1 + 647) = *(_BYTE *)(a1 + 70) & 0xFC;
      v6 = sub_2198C4084(a1);
    }
    v5 = v6;
    *a2 = (_DWORD)v6 != 13;
  }
  else if (v4 == 1)
  {
    *a2 = 1;
    if (*(unsigned __int16 *)(a1 + 202) - 2 >= *(unsigned __int16 *)(a1 + 80))
      v5 = 0;
    else
      v5 = 22;
  }
  else
  {
    v5 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_NxtOp");
  return v5;
}

uint64_t sub_2198C4A80(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_WrTermTLV");
  *(_BYTE *)a1 = 5;
  *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 647);
  *(_BYTE *)(a1 + 267) = -2;
  *(_WORD *)(a1 + 268) = 0;
  v2 = sub_2198C556C(a1);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_WrTermTLV");
  return v2;
}

uint64_t sub_2198C4B08(uint64_t a1)
{
  int v2;
  unsigned __int16 v3;
  char v4;
  int v5;
  uint64_t v6;
  unsigned int v7;
  uint64_t v8;
  __int16 v9;
  char v10;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_UpdateWrLen");
  if (*(unsigned __int8 *)(a1 + 67) == *(unsigned __int8 *)(a1 + 646))
  {
    v2 = *(unsigned __int16 *)(a1 + 68);
    if (v2 == 4)
      v3 = 1;
    else
      v3 = v2 + 1;
    if (v2 == 4)
      v4 = *(_BYTE *)(a1 + 70) + 1;
    else
      v4 = *(_BYTE *)(a1 + 70);
  }
  else
  {
    if (*(unsigned __int8 *)(a1 + 70) != 255 || *(_BYTE *)(a1 + 67) || *(_WORD *)(a1 + 68) != 4)
    {
      if (*(_BYTE *)(a1 + 67))
      {
        v6 = 245;
      }
      else
      {
        *(_BYTE *)(a1 + 646) = 0;
        *(_BYTE *)(a1 + 543) = 2;
        v6 = sub_2198C26F4(a1, 0, 1, 11);
      }
      goto LABEL_36;
    }
    v4 = 0;
    v3 = 1;
  }
  if (*(_WORD *)(a1 + 214))
  {
    phOsalNfc_MemCopy();
    v5 = *(unsigned __int16 *)(a1 + 214);
    if (v5 == 2)
    {
      *(_WORD *)(a1 + 267) = bswap32(*(unsigned __int16 *)(a1 + 252)) >> 16;
    }
    else if (v5 == 1)
    {
      *(_BYTE *)(a1 + 267) = *(_BYTE *)(a1 + 252);
    }
    *(_WORD *)(a1 + 214) = 0;
    ++v4;
  }
  else
  {
    phOsalNfc_MemCopy();
    v7 = *(unsigned __int16 *)(a1 + 252);
    if (v7 < 0xFF)
    {
      if (*(_BYTE *)(a1 + 560) != 1)
        LOBYTE(v7) = *(_BYTE *)(a1 + v3 + 266) + v7;
      *(_BYTE *)(a1 + v3 + 266) = v7;
    }
    else if ((unsigned __int16)(v3 - 1) > 1u)
    {
      if ((unsigned __int16)(v3 + 1) == 4)
      {
        *(_BYTE *)(a1 + 270) = BYTE1(v7);
        v9 = 1;
      }
      else
      {
        v9 = 2;
      }
      *(_WORD *)(a1 + 214) = v9;
    }
    else
    {
      v8 = a1 + 266;
      *(_BYTE *)(v8 + (unsigned __int16)(v3 + 1)) = BYTE1(v7);
      *(_BYTE *)(v8 + (unsigned __int16)(v3 + 2)) = v7;
      *(_WORD *)(a1 + 214) = 0;
    }
  }
  phOsalNfc_MemCopy();
  *(_BYTE *)(a1 + 266) = v4;
  v6 = sub_2198C556C(a1);
  if (*(_WORD *)(a1 + 214))
    v10 = 5;
  else
    v10 = 6;
  *(_BYTE *)a1 = v10;
LABEL_36:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_UpdateWrLen");
  return v6;
}

uint64_t sub_2198C4D30(uint64_t a1, BOOL *a2)
{
  int v4;
  uint64_t v5;
  uint64_t v6;
  int v7;
  __int16 v8;
  unsigned __int8 *v9;
  int v10;
  unsigned int v11;
  unsigned int v12;
  uint64_t v13;
  _BYTE *v14;
  __int16 v15;
  unsigned int v16;
  BOOL v17;
  unsigned int v18;
  const char *v19;
  __int16 v20;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iFndNdefComp");
  if (*(_WORD *)(a1 + 264) != 16)
  {
    *a2 = 1;
    v5 = 27;
    goto LABEL_68;
  }
  v4 = *(unsigned __int8 *)(a1 + 540);
  if ((v4 - 1) < 2)
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iFndNdefCompReadOp");
    *a2 = 0;
    if (*(_BYTE *)(a1 + 75))
    {
      sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_ChkRemainTLV");
      v7 = *(unsigned __int8 *)(a1 + 75);
      if ((v7 - 1) > 1)
      {
        v11 = *(unsigned __int8 *)(a1 + 266);
        if (v11 != 255 && (*(_BYTE *)(a1 + 266) || *(_BYTE *)(a1 + 66) == 1))
        {
          v12 = *(unsigned __int16 *)(a1 + 650);
          *(_WORD *)(a1 + 78) = v11;
          *(_WORD *)(a1 + 80) = v11;
          if (v12 >= v11 && *(_BYTE *)(a1 + 66) != 1)
          {
            sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_UpdateLen");
            *(_WORD *)(a1 + 650) -= v11;
            *(_WORD *)(a1 + 68) = ((v11 + 1) & 3) + 1;
            *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 647) + ((v11 + 1) >> 2);
            sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_UpdateLen");
            if (*(unsigned __int8 *)(a1 + 266) > 0xFu)
              sub_2198C22F0(a1, *(_BYTE *)(a1 + 70));
            else
              sub_2198C4398(a1, a2);
          }
        }
        else
        {
          v18 = __rev16(*(unsigned __int16 *)(a1 + 267));
          if (v18 <= *(unsigned __int16 *)(a1 + 650))
            sub_21988B840(a1, v18);
          *(_WORD *)(a1 + 78) = v18;
          *(_WORD *)(a1 + 80) = v18;
        }
      }
      else
      {
        if (v7 == 1)
        {
          v8 = *(_WORD *)(a1 + 76);
          v9 = (unsigned __int8 *)(a1 + 266);
        }
        else
        {
          LOBYTE(v8) = *(_BYTE *)(a1 + 266);
          v9 = (unsigned __int8 *)(a1 + 267);
        }
        v16 = *v9 | (v8 << 8);
        *(_WORD *)(a1 + 78) = *v9 | (v8 << 8);
        *(_WORD *)(a1 + 80) = v16;
        v17 = 1;
        if (v16 >= 0xFF && *(unsigned __int16 *)(a1 + 650) > v16)
          v17 = sub_21988B840(a1, v16) == 1;
        *a2 = v17;
      }
      *(_BYTE *)(a1 + 75) = 0;
      v5 = sub_21988B840(a1, *(unsigned __int16 *)(a1 + 80));
      sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_ChkRemainTLV");
    }
    else
    {
      v10 = *(unsigned __int8 *)(a1 + 66);
      if (v10 == 1)
      {
        v5 = 0;
        goto LABEL_43;
      }
      sub_219850628(0, (unsigned int *)(a1 + 2712), 8u, 4u, (uint64_t)"Checking NDEF TLV (Type: 0x03) in the response");
      v5 = sub_2198C4398(a1, a2);
      *a2 = (_DWORD)v5 != 13;
    }
    if (*(_BYTE *)(a1 + 66) != 1)
      goto LABEL_47;
    v10 = *(_BYTE *)(a1 + 75) == 0;
LABEL_43:
    if (v10 && (_DWORD)v5 != 157)
    {
      *a2 = 0;
      if (!*(_BYTE *)(a1 + 646))
      {
        v5 = sub_2198C4994(a1, a2);
        if ((_DWORD)v5)
          goto LABEL_48;
        goto LABEL_51;
      }
      *(_BYTE *)(a1 + 646) = 0;
      *(_BYTE *)(a1 + 543) = 4;
      v5 = sub_2198C26F4(a1, 0, 1, 11);
      *a2 = (_DWORD)v5 != 13;
    }
LABEL_47:
    if ((_DWORD)v5)
    {
LABEL_48:
      if ((_DWORD)v5 != 13 && *(_BYTE *)(a1 + 540) == 1)
        *(_BYTE *)(a1 + 545) = 3;
    }
LABEL_51:
    v19 = "phFriNfc_MifareUL_iFndNdefCompReadOp";
LABEL_62:
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)v19);
    goto LABEL_68;
  }
  if (v4 == 3)
  {
    if (*(_BYTE *)(a1 + 82) == 1)
    {
      v5 = sub_2198C4B08(a1);
LABEL_67:
      *a2 = (_DWORD)v5 != 13;
      goto LABEL_68;
    }
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_CallWrOp");
    *(_BYTE *)(a1 + 647) = *(_BYTE *)(a1 + 70);
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 647);
    v13 = *(unsigned __int16 *)(a1 + 68);
    v14 = (_BYTE *)(a1 + 267 + v13);
    if (*(_DWORD *)(a1 + 248) < 0xFFu)
    {
      *v14 = 0;
      if (v13 > 2
        || !sub_2198C6460(a1, *(unsigned __int8 *)(a1 + 647), *(unsigned __int8 *)(a1 + 646))
        || !sub_2198C653C(a1, *(unsigned __int8 *)(a1 + 647), *(unsigned __int8 *)(a1 + 646)))
      {
        goto LABEL_66;
      }
      v20 = 1;
      phOsalNfc_MemCopy();
    }
    else
    {
      *v14 = -1;
      if (v13 > 2)
      {
        v15 = 2;
      }
      else
      {
        *(_BYTE *)(v13 + a1 + 268) = 0;
        v15 = 1;
      }
      v20 = 0;
      *(_WORD *)(a1 + 214) = v15;
    }
    *(_WORD *)(a1 + 212) = v20;
LABEL_66:
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    **(_WORD **)(a1 + 528) = 4;
    *(_BYTE *)a1 = 2;
    v5 = sub_2198C556C(a1);
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_CallWrOp");
    goto LABEL_67;
  }
  if (v4 == 5)
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iFndNdefCompIntReadOp");
    if (!*(_BYTE *)(a1 + 646) || *(_BYTE *)(a1 + 647))
      ++*(_BYTE *)(a1 + 647);
    v5 = sub_2198C2AA4(a1);
    if ((_DWORD)v5)
      goto LABEL_61;
    if (*(_BYTE *)(a1 + 74) == 1)
    {
      v6 = sub_2198C4B08(a1);
    }
    else
    {
      if (!*(_WORD *)(a1 + 650))
      {
        v5 = 0;
        goto LABEL_61;
      }
      v6 = sub_2198C4A80(a1);
    }
    v5 = v6;
LABEL_61:
    *a2 = (_DWORD)v5 != 13;
    v19 = "phFriNfc_MifareUL_iFndNdefCompIntReadOp";
    goto LABEL_62;
  }
  *a2 = 1;
  v5 = 29;
LABEL_68:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iFndNdefComp");
  return v5;
}

uint64_t sub_2198C52E4(unsigned int *a1, BOOL *a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iTermTlv");
  v4 = sub_2198C4B08((uint64_t)a1);
  *a2 = (_DWORD)v4 != 13;
  sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iTermTlv");
  return v4;
}

uint64_t sub_2198C5360(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  char v5;
  uint64_t v6;
  BOOL v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iWrLenTlv");
  v4 = *(unsigned __int16 *)(a1 + 68);
  if (v4 == 4)
  {
    if (*(unsigned __int8 *)(a1 + 70) + 1 != *(unsigned __int8 *)(a1 + 647))
      goto LABEL_7;
LABEL_6:
    phOsalNfc_MemCopy();
    goto LABEL_7;
  }
  if (v4 <= 3 && *(unsigned __int8 *)(a1 + 647) == *(unsigned __int8 *)(a1 + 70))
    goto LABEL_6;
LABEL_7:
  phOsalNfc_MemCopy();
  v5 = *(_BYTE *)(a1 + 545);
  if (!v5)
    v5 = 2;
  *(_BYTE *)(a1 + 545) = v5;
  *(_WORD *)(a1 + 252) = 0;
  *(_WORD *)(a1 + 212) = 0;
  if (*(_BYTE *)(a1 + 646))
  {
    *(_BYTE *)(a1 + 646) = 0;
    *(_BYTE *)(a1 + 543) = 6;
    v6 = sub_2198C26F4(a1, 0, 1, 11);
    v7 = (_DWORD)v6 != 13;
  }
  else
  {
    v6 = 0;
    v7 = 1;
  }
  *a2 = v7;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iWrLenTlv");
  return v6;
}

uint64_t sub_2198C5488(uint64_t a1, BOOL *a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iRoNdefComp");
  if (a1)
  {
    if (*(_WORD *)(a1 + 264) == 16)
    {
      phOsalNfc_MemCopy();
      *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 647);
      phOsalNfc_MemCopy();
      *(_BYTE *)(a1 + 270) = 15;
      *(_BYTE *)a1 = 8;
      v4 = sub_2198C556C(a1);
      v5 = v4;
      if (a2)
        *a2 = (_DWORD)v4 != 13;
    }
    else
    {
      v5 = 27;
    }
  }
  else
  {
    v5 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iRoNdefComp");
  return v5;
}

uint64_t sub_2198C556C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_Wr4bytes");
  *(_WORD *)(a1 + 264) = 260;
  *(_BYTE *)(a1 + 540) = 3;
  *(_DWORD *)(a1 + 232) = 162;
  *(_QWORD *)(a1 + 48) = sub_2198C3220;
  *(_QWORD *)(a1 + 56) = a1;
  *(_WORD *)(a1 + 526) = 5;
  v2 = sub_219888630(a1, (uint64_t)sub_2198C3648);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_Wr4bytes");
  return v2;
}

uint64_t sub_2198C560C(uint64_t a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iRoNdefWriteCC");
  if (!a1)
  {
    v4 = 255;
    if (!a2)
      goto LABEL_8;
    goto LABEL_7;
  }
  if (*(_BYTE *)(a1 + 266) == 10 && *(_WORD *)(a1 + 264) == 1)
  {
    v4 = 0;
    if (!a2)
      goto LABEL_8;
    goto LABEL_7;
  }
  v4 = 28;
  if (a2)
LABEL_7:
    *a2 = 1;
LABEL_8:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iRoNdefWriteCC");
  return v4;
}

uint64_t sub_2198C56B4(uint64_t a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorChk1");
  if (*(_WORD *)(a1 + 264) == 1)
  {
    if (*(_BYTE *)(a1 + 266) == 10)
    {
      v4 = sub_2198C26F4(a1, *(_BYTE *)(a1 + 646), 2, 10);
    }
    else
    {
      *a2 = 1;
      v4 = 28;
    }
  }
  else
  {
    *a2 = 1;
    v4 = 27;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorChk1");
  return v4;
}

uint64_t sub_2198C5760(uint64_t a1, char *a2)
{
  uint64_t v4;
  char v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorRd1");
  if (*(_WORD *)(a1 + 264) != 1)
  {
    v4 = 27;
LABEL_6:
    v5 = 1;
    goto LABEL_7;
  }
  if (*(_BYTE *)(a1 + 266) != 10)
  {
    v4 = 28;
    goto LABEL_6;
  }
  v4 = sub_2198C26F4(a1, *(_BYTE *)(a1 + 646), 2, 14);
  v5 = 0;
LABEL_7:
  *a2 = v5;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorRd1");
  return v4;
}

uint64_t sub_2198C5810(uint64_t a1, BOOL *a2)
{
  char v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorRd2");
  if (*(unsigned __int8 *)(a1 + 647) == 255)
    v4 = 0;
  else
    v4 = *(_BYTE *)(a1 + 70) & 0xFC;
  *(_BYTE *)(a1 + 647) = v4;
  v5 = sub_2198C4084(a1);
  *a2 = (_DWORD)v5 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorRd2");
  return v5;
}

uint64_t sub_2198C58AC(uint64_t a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorWrite1");
  if (*(_WORD *)(a1 + 264) == 1)
  {
    if (*(_BYTE *)(a1 + 266) == 10)
    {
      v4 = sub_2198C26F4(a1, *(_BYTE *)(a1 + 646), 2, 16);
    }
    else
    {
      *a2 = 1;
      v4 = 28;
    }
  }
  else
  {
    *a2 = 1;
    v4 = 27;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorWrite1");
  return v4;
}

uint64_t sub_2198C5958(uint64_t a1, BOOL *a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorWrite2");
  *(_BYTE *)(a1 + 647) = 0;
  if (*(_BYTE *)(a1 + 540) == 5)
  {
    v4 = sub_2198C22F0(a1, 0);
  }
  else
  {
    v5 = sub_2198C2AA4(a1);
    if ((_DWORD)v5)
      goto LABEL_5;
    if (*(_BYTE *)(a1 + 74) == 1)
    {
      v4 = sub_2198C4B08(a1);
    }
    else
    {
      if (!*(_WORD *)(a1 + 650))
      {
        v5 = 0;
        goto LABEL_5;
      }
      v4 = sub_2198C4A80(a1);
    }
  }
  v5 = v4;
LABEL_5:
  *a2 = (_DWORD)v5 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorWrite2");
  return v5;
}

uint64_t sub_2198C5A2C(uint64_t a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorWrInit1");
  if (*(_WORD *)(a1 + 264) == 1)
  {
    if (*(_BYTE *)(a1 + 266) == 10)
    {
      v4 = sub_2198C26F4(a1, *(_BYTE *)(a1 + 646), 2, 20);
    }
    else
    {
      *a2 = 1;
      v4 = 28;
    }
  }
  else
  {
    *a2 = 1;
    v4 = 27;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorWrInit1");
  return v4;
}

uint64_t sub_2198C5AD8(uint64_t a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorRW1");
  if (*(_WORD *)(a1 + 264) == 1)
  {
    if (*(_BYTE *)(a1 + 266) == 10)
    {
      v4 = sub_2198C26F4(a1, *(_BYTE *)(a1 + 646), 2, 18);
    }
    else
    {
      *a2 = 1;
      v4 = 28;
    }
  }
  else
  {
    *a2 = 1;
    v4 = 27;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorRW1");
  return v4;
}

uint64_t sub_2198C5B84(uint64_t a1, BOOL *a2)
{
  int v4;
  unsigned int v6;
  int v7;
  unsigned __int8 v8;
  unsigned int v9;
  uint64_t v10;
  char v11;
  uint64_t v12;
  char v13;
  uint64_t v14;
  uint64_t v15;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorRW2");
  *(_BYTE *)(a1 + 647) = 0;
  *(_WORD *)(a1 + 266) = 0;
  v4 = *(unsigned __int16 *)(a1 + 68);
  if (v4 == 4 || v4 == 1)
  {
    if (v4 == 1)
      v6 = 2;
    else
      v6 = 3;
    if (*(_DWORD *)(a1 + 248) >= v6)
    {
      phOsalNfc_MemCopy();
      *(_WORD *)(a1 + 212) = v6;
      **(_WORD **)(a1 + 528) = v6 + 1;
    }
    else
    {
      phOsalNfc_MemCopy();
      v7 = *(_DWORD *)(a1 + 248);
      *(_WORD *)(a1 + 212) = v7;
      v8 = v7 + 2;
      v9 = (v7 + 2);
      **(_WORD **)(a1 + 528) = v9 - 1;
      if (v9 <= 4)
      {
        v10 = 0;
        *(_BYTE *)(a1 + 74) = 1;
        v11 = v8 + 1;
        v12 = a1 + v8 + 266;
        do
        {
          if (v10)
            v13 = 0;
          else
            v13 = -2;
          *(_BYTE *)(v12 + v10) = v13;
          v14 = (v11 + v10++);
        }
        while (v14 != 5);
      }
    }
    phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    *(_BYTE *)a1 = 2;
    v15 = sub_2198C556C(a1);
  }
  else
  {
    v15 = 0;
  }
  *a2 = (_DWORD)v15 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorRW2");
  return v15;
}

uint64_t sub_2198C5D0C(uint64_t a1, _BYTE *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorReset1");
  if (*(_WORD *)(a1 + 264) == 1)
  {
    if (*(_BYTE *)(a1 + 266) == 10)
    {
      v4 = sub_2198C26F4(a1, *(_BYTE *)(a1 + 646), 2, 12);
    }
    else
    {
      *a2 = 1;
      v4 = 28;
    }
  }
  else
  {
    *a2 = 1;
    v4 = 27;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorReset1");
  return v4;
}

uint64_t sub_2198C5DB8(uint64_t a1, BOOL *a2)
{
  uint64_t v4;
  BOOL v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorReset2");
  switch(*(_BYTE *)(a1 + 543))
  {
    case 1:
    case 6:
      v4 = 0;
      v5 = 1;
      goto LABEL_4;
    case 2:
      v4 = sub_2198C4B08(a1);
      v5 = (_DWORD)v4 != 13;
LABEL_4:
      *a2 = v5;
      break;
    case 4:
      v4 = sub_2198C4994(a1, a2);
      break;
    default:
      *a2 = 1;
      v4 = 20;
      break;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorReset2");
  return v4;
}

uint64_t sub_2198C5E8C(uint64_t a1)
{
  char v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorChk2");
  v2 = *(_BYTE *)(a1 + 647) + 4;
  *(_BYTE *)(a1 + 647) = v2;
  v3 = sub_2198C22F0(a1, v2);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorChk2");
  return v3;
}

uint64_t sub_2198C5F08(uint64_t a1, BOOL *a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorWrInit2");
  if (*(_BYTE *)(a1 + 560) == 1)
    v4 = sub_2198C2808(a1);
  else
    v4 = sub_2198C2AA4(a1);
  v5 = v4;
  *a2 = (_DWORD)v4 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_iSelSectorWrInit2");
  return v5;
}

uint64_t sub_2198C5F98(uint64_t a1, uint64_t a2)
{
  int v4;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  int v9;

  v9 = 0;
  v7 = 0;
  v8 = 0;
  v6 = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_H_Complete");
  *(_BYTE *)a1 = 0;
  switch(*(_BYTE *)(a1 + 547))
  {
    case 1:
      if ((_DWORD)a2)
      {
        *(_BYTE *)(a1 + 546) = 0;
        LOBYTE(v8) = 3;
        if (a2 == 28 || a2 == 22)
          a2 = 152;
      }
      else
      {
        *(_BYTE *)(a1 + 546) = 1;
        v4 = *(unsigned __int16 *)(a1 + 650);
        HIDWORD(v8) = *(unsigned __int16 *)(a1 + 80);
        v9 = v4;
        LOBYTE(v8) = *(_BYTE *)(a1 + 545);
      }
      (*(void (**)(_QWORD, uint64_t, uint64_t *))(a1 + 8))(*(_QWORD *)(a1 + 40), a2, &v8);
      break;
    case 2:
      if ((_DWORD)a2)
      {
        *(_BYTE *)(a1 + 540) = 1;
      }
      else
      {
        LODWORD(v7) = **(_DWORD **)(a1 + 552);
        v6 = *(_QWORD *)(a1 + 240);
      }
      (*(void (**)(_QWORD, uint64_t, uint64_t *))(a1 + 16))(*(_QWORD *)(a1 + 40), a2, &v6);
      break;
    case 3:
      (*(void (**)(_QWORD, uint64_t))(a1 + 24))(*(_QWORD *)(a1 + 40), a2);
      break;
    case 6:
      (*(void (**)(_QWORD, uint64_t))(a1 + 32))(*(_QWORD *)(a1 + 40), a2);
      break;
    default:
      return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_H_Complete");
  }
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareUL_H_Complete");
}

uint64_t sub_2198C60DC(uint64_t a1, int a2)
{
  unsigned int v4;
  char v5;
  uint64_t v6;
  uint64_t v7;
  char v8;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_Chk16Bytes");
  if (a2 == 16)
  {
    v4 = *(unsigned __int8 *)(a1 + 647);
    if (v4 > 0xFB)
    {
      v8 = *(_BYTE *)(a1 + 646) + 1;
      *(_BYTE *)(a1 + 646) = v8;
      v6 = sub_2198C26F4(a1, v8, 1, 9);
    }
    else
    {
      v5 = v4 + 4;
      *(_BYTE *)(a1 + 647) = v5;
      v6 = sub_2198C22F0(a1, v5);
    }
    v7 = v6;
  }
  else
  {
    v7 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_Chk16Bytes");
  return v7;
}

uint64_t sub_2198C6190(uint64_t a1, unsigned int a2)
{
  unsigned int v4;
  unsigned int v5;
  unsigned int v6;
  int v7;
  unsigned int v8;
  int v9;
  unsigned int *v10;
  const char *v11;
  uint64_t v12;
  uint64_t v13;
  unsigned __int8 v14;
  _DWORD *v15;
  _WORD *v16;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_findDynLockBytes");
  if (!a1)
  {
    sub_219850628(2, 0, 8u, 4u, (uint64_t)"Invalid Parameter");
    v12 = 1;
    goto LABEL_16;
  }
  v4 = *(unsigned __int8 *)(a1 + 266 + a2);
  v5 = *(unsigned __int8 *)(a1 + 266 + a2 + 1);
  v6 = v4 >> 4;
  v7 = v4 & 0xF;
  v8 = v5 >> 3;
  if ((v5 & 7) != 0)
    LOBYTE(v8) = v8 + 1;
  v9 = (v6 << (*(_BYTE *)(a1 + 266 + a2 + 2) & 0xF)) + v7;
  if ((unsigned __int16)v9 > 0x3Fu)
  {
    if ((unsigned __int16)v9 + v8 < *(unsigned __int16 *)(a1 + 202) + 16)
    {
      v13 = *(unsigned __int8 *)(a1 + 130);
      if (v13 > 7)
      {
        v10 = (unsigned int *)(a1 + 2712);
        v11 = "Lock control tlv count exceeds the limit";
        goto LABEL_6;
      }
      v14 = 0;
      v15 = (_DWORD *)(a1 + 96);
      while (LOWORD(v15[v14]) != (unsigned __int16)v9)
      {
        if (v13 < ++v14)
        {
          v16 = &v15[v13];
          *v16 = v9;
          v16[1] = v8;
          *(_BYTE *)(a1 + 130) = v13 + 1;
          *(_BYTE *)(a1 + 131) += v8;
          sub_21988BA0C((unsigned int *)a1, v15, (v13 + 1));
          break;
        }
      }
    }
    v12 = 0;
    goto LABEL_16;
  }
  v10 = (unsigned int *)(a1 + 2712);
  v11 = "Incorrect Lock control TLV values";
LABEL_6:
  sub_219850628(0, v10, 8u, 4u, (uint64_t)v11);
  v12 = 255;
LABEL_16:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_findDynLockBytes");
  return v12;
}

uint64_t sub_2198C6308(uint64_t a1, unsigned int a2)
{
  unsigned int v4;
  int v5;
  unsigned int *v6;
  const char *v7;
  uint64_t v8;
  int v9;
  uint64_t v10;
  _DWORD *v11;
  _WORD *v12;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_findReservedBytes");
  if (a1)
  {
    v4 = *(unsigned __int8 *)(a1 + 266 + a2);
    v5 = (v4 >> 4 << (*(_BYTE *)(a1 + 266 + a2 + 2) & 0xF)) + (v4 & 0xF);
    if ((unsigned __int16)v5 <= 0x3Fu)
    {
      v6 = (unsigned int *)(a1 + 2712);
      v7 = "Incorrect Memory control TLV values";
LABEL_8:
      sub_219850628(0, v6, 8u, 4u, (uint64_t)v7);
      v8 = 255;
      goto LABEL_13;
    }
    v9 = *(unsigned __int8 *)(a1 + 266 + a2 + 1);
    if (v9 + (unsigned __int16)v5 < *(unsigned __int16 *)(a1 + 202) + 16)
    {
      v10 = *(unsigned __int8 *)(a1 + 184);
      if (v10 > 1)
      {
        v6 = (unsigned int *)(a1 + 2712);
        v7 = "Memory control tlv count exceeds the limit";
        goto LABEL_8;
      }
      v11 = (_DWORD *)(a1 + 150);
      if ((_DWORD)v10 != 1 || *(unsigned __int16 *)v11 != (unsigned __int16)v5)
      {
        v12 = &v11[v10];
        *v12 = v5;
        v12[1] = v9;
        *(_BYTE *)(a1 + 184) = v10 + 1;
        *(_BYTE *)(a1 + 185) += v9;
        sub_21988BA0C((unsigned int *)a1, v11, (v10 + 1));
      }
    }
    v8 = 0;
    goto LABEL_13;
  }
  sub_219850628(2, 0, 8u, 4u, (uint64_t)"Invalid Parameter");
  v8 = 1;
LABEL_13:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MfUL_H_findReservedBytes");
  return v8;
}

uint64_t sub_2198C6460(uint64_t a1, __int16 a2, __int16 a3)
{
  uint64_t v6;
  unsigned int v7;
  _WORD *v8;
  unsigned int v9;
  uint64_t v11;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"chkDynLockBytes");
  if (!a1)
  {
    sub_219850628(2, 0, 8u, 4u, (uint64_t)"Invalid Parameter");
    goto LABEL_11;
  }
  v6 = *(unsigned __int8 *)(a1 + 130);
  if (!*(_BYTE *)(a1 + 130))
  {
LABEL_11:
    v11 = 255;
    goto LABEL_12;
  }
  v7 = (unsigned __int16)((a3 << 10) + 4 * a2);
  v8 = (_WORD *)(a1 + 98);
  while (1)
  {
    v9 = (unsigned __int16)*(v8 - 1);
    if (v7 <= (unsigned __int16)(v9 + *v8 - 1) && v7 + 4 > v9)
      break;
    v8 += 2;
    if (!--v6)
      goto LABEL_11;
  }
  v11 = 0;
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"chkDynLockBytes");
  return v11;
}

uint64_t sub_2198C653C(uint64_t a1, __int16 a2, __int16 a3)
{
  uint64_t v6;
  unsigned int v7;
  _WORD *v8;
  unsigned int v9;
  uint64_t v11;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"chkReservedBytes");
  if (!a1)
  {
    sub_219850628(2, 0, 8u, 4u, (uint64_t)"Invalid Parameter");
    goto LABEL_11;
  }
  v6 = *(unsigned __int8 *)(a1 + 184);
  if (!*(_BYTE *)(a1 + 184))
  {
LABEL_11:
    v11 = 255;
    goto LABEL_12;
  }
  v7 = (unsigned __int16)((a3 << 10) + 4 * a2);
  v8 = (_WORD *)(a1 + 152);
  while (1)
  {
    v9 = (unsigned __int16)*(v8 - 1);
    if (v7 <= (unsigned __int16)(v9 + *v8 - 1) && v7 + 4 > v9)
      break;
    v8 += 2;
    if (!--v6)
      goto LABEL_11;
  }
  v11 = 0;
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"chkReservedBytes");
  return v11;
}

uint64_t sub_2198C6618(uint64_t a1, _BYTE *a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t i;
  unsigned __int8 *v8;
  unsigned int v9;
  unsigned int v10;
  uint64_t v11;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetCurrentHeadIndex");
  if (a1)
  {
    v4 = 0;
    v5 = 0;
    do
    {
      v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
      if ((v4 & 1) != 0)
        break;
      v4 = 1;
      v5 = 1;
    }
    while (v6 != a1);
    if (v6 == a1)
    {
      for (i = 0; i != 3; ++i)
      {
        v8 = *(unsigned __int8 **)(a1 + 928 + 8 * i);
        if (v8)
        {
          v9 = *v8;
          v10 = v9 >> 5;
          if (v9 >> 5 == *(unsigned __int8 *)(a1 + 912))
          {
            if (v10 - 2 >= 2)
            {
              if (!v10 && (v9 & 0xF) == *(_BYTE *)(a1 + 924))
              {
LABEL_18:
                v11 = 0;
                *a2 = i;
                goto LABEL_17;
              }
            }
            else if ((v9 & 0xF) == *(_BYTE *)(a1 + 916) && *(_DWORD *)(a1 + 920) == (v8[1] & 0x3F))
            {
              goto LABEL_18;
            }
          }
        }
      }
    }
  }
  v11 = 255;
LABEL_17:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetCurrentHeadIndex");
  return v11;
}

uint64_t sub_2198C6740(unsigned int *a1, _BYTE *a2)
{
  char v4;
  uint64_t v5;
  unsigned int *v6;
  uint64_t v7;
  uint64_t v8;

  sub_219850718(3, a1, 3u, 5u, (uint64_t)"phNciNfc_GetAvailableHead");
  if (!a1)
    goto LABEL_9;
  v4 = 0;
  v5 = 0;
  do
  {
    v6 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v5 + 5);
    if ((v4 & 1) != 0)
      break;
    v4 = 1;
    v5 = 1;
  }
  while (v6 != a1);
  if (v6 == a1)
  {
    v7 = 0;
    while (*(_QWORD *)&a1[2 * v7 + 232])
    {
      if (++v7 == 3)
        goto LABEL_9;
    }
    v8 = 0;
    *a2 = v7;
  }
  else
  {
LABEL_9:
    v8 = 255;
  }
  sub_219850808(3, a1, 3u, 5u, (uint64_t)"phNciNfc_GetAvailableHead");
  return v8;
}

uint64_t sub_2198C680C(uint64_t a1)
{
  char v2;
  uint64_t v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t Memory;
  uint64_t v9;
  uint64_t v10;

  sub_219850718(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateDataToNode");
  if (!a1)
    goto LABEL_6;
  v2 = 0;
  v3 = 0;
  do
  {
    v4 = *((_QWORD *)&unk_253E46700 + 14 * v3 + 5);
    if ((v2 & 1) != 0)
      break;
    v2 = 1;
    v3 = 1;
  }
  while (v4 != a1);
  if (v4 != a1)
    goto LABEL_6;
  v7 = a1 + 8 * *(unsigned __int8 *)(a1 + 952);
  v5 = *(_QWORD *)(v7 + 928);
  Memory = phOsalNfc_GetMemory();
  if (!Memory)
  {
    sub_219850628(1, (unsigned int *)(a1 + 2468), 3u, 4u, (uint64_t)"Memory allcation failed while creating new node!");
LABEL_6:
    v5 = 255;
    goto LABEL_7;
  }
  v9 = Memory;
  phOsalNfc_MemCopy();
  *(_WORD *)(v9 + 260) = *(_WORD *)(a1 + 2344);
  *(_QWORD *)(v9 + 264) = 0;
  if (v5)
  {
    do
    {
      v10 = v5;
      v5 = *(_QWORD *)(v5 + 264);
    }
    while (v5);
    *(_QWORD *)(v10 + 264) = v9;
  }
  else
  {
    *(_QWORD *)(v7 + 928) = v9;
  }
LABEL_7:
  sub_219850808(3, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_UpdateDataToNode");
  return v5;
}

uint64_t sub_2198C6930(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pConfig");
  if (a1 && (v2 = *(_QWORD *)(a1 + 5392)) != 0)
    v3 = sub_2198FD4A4(*(_QWORD *)(a1 + 3040), v2, (uint64_t)sub_219865DD0, a1);
  else
    v3 = 1;
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pConfig");
  return v3;
}

uint64_t sub_2198C69B4(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_P2pConfigResp");
  if (!a1 || (_DWORD)a2)
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"phLibNfc_P2pConfigResp: Configure P2p params failed");
  else
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"phLibNfc_P2pConfigResp: Configure P2p params success");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_P2pConfigResp");
  return a2;
}

uint64_t sub_2198C6A58(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  uint64_t v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pConfigComp");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 5392))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 5392) = 0;
    }
    v4 = (unsigned int *)(a1 + 19368);
    if ((_DWORD)a2)
    {
      sub_219850628(1, v4, 4u, 1u, (uint64_t)"phLibNfc_P2pConfigResp: Configure P2p params failed");
      v5 = 146;
    }
    else
    {
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"phLibNfc_P2pConfigResp: Configure P2p params success");
      v5 = 145;
    }
    v6 = sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v5, a2, 0, 0);
  }
  else
  {
    v6 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pConfigComp");
  return v6;
}

uint64_t sub_2198C6B38(unsigned int *a1, uint64_t a2, uint64_t a3, int a4)
{
  uint64_t v8;
  char v10;
  __int16 v11;
  unsigned int v12;
  unsigned int v13;
  int v14;
  int v15;
  __int16 v16;
  unsigned int v17;
  __int16 v18;
  unsigned int *v19;
  unsigned int v20;
  __int16 v21;
  unsigned int v22;
  unsigned int v23;

  v23 = 0;
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemoteDevNfcIp1");
  if (!a2 || !a3)
  {
    v8 = 1;
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"Invalid input parameter!");
    goto LABEL_6;
  }
  if (sub_2198D8570(a1, *(_DWORD *)(a3 + 36), &v23))
  {
LABEL_4:
    v8 = 255;
    goto LABEL_6;
  }
  v10 = 1;
  if (a4 > 130)
  {
    if (a4 != 131 && a4 != 133)
      goto LABEL_13;
  }
  else if (a4 != 3 && a4 != 5)
  {
LABEL_13:
    v10 = *(_BYTE *)(a3 + 32);
  }
  *(_BYTE *)(a2 + 63) = v10;
  *(_DWORD *)(a2 + 68) = v23;
  v8 = 255;
  switch(a4)
  {
    case 0:
    case 3:
      v13 = *(unsigned __int8 *)(a3 + 10);
      *(_BYTE *)(a2 + 10) = v13;
      if (!v13)
        goto LABEL_26;
      if (v13 > 0xA)
      {
        sub_219850628(1, a1 + 4842, 4u, 1u, (uint64_t)"Received NFCID length exceeded max UID length");
        v8 = 255;
      }
      else
      {
        phOsalNfc_SetMemory();
        phOsalNfc_MemCopy();
LABEL_26:
        v8 = 0;
      }
      *(_WORD *)(a2 + 61) = 0;
      if (*(_BYTE *)(a3 + 31) == 2)
        phOsalNfc_MemCopy();
      *(_BYTE *)(a2 + 60) = 0;
      if (*(_BYTE *)(a3 + 12))
        *(_BYTE *)(a2 + 60) = *(_BYTE *)(a3 + 11);
      if (*(unsigned __int8 *)(a3 + 103) >= 0xFu)
      {
        v16 = *(unsigned __int8 *)(a3 + 54);
        *(_WORD *)(a2 + 64) = (4 * v16) & 0xC0;
        phOsalNfc_SetMemory();
        *(_BYTE *)(a2 + 59) = 0;
        if ((v16 & 2) != 0)
        {
          v17 = *(unsigned __int8 *)(a3 + 103);
          if (v17 >= 0x10)
          {
            *(_BYTE *)(a2 + 59) = v17 - 15;
            if (v17 > 0x30)
            {
              sub_219850628(1, a1 + 4842, 4u, 1u, (uint64_t)"Received ATRInfo length exceeded max ATR length");
              v8 = 255;
            }
            else
            {
              phOsalNfc_MemCopy();
            }
          }
        }
        if (!*(_BYTE *)(a2 + 10))
          goto LABEL_66;
      }
      break;
    case 1:
    case 4:
      break;
    case 2:
    case 5:
      v14 = *(unsigned __int8 *)(a3 + 10);
      *(_BYTE *)(a2 + 10) = v14;
      if (!v14)
        goto LABEL_30;
      phOsalNfc_SetMemory();
      if (*(unsigned __int8 *)(a2 + 10) > 0xAu)
      {
        sub_219850628(1, a1 + 4842, 4u, 1u, (uint64_t)"Received NFCID length exceeded max UID length");
        v8 = 255;
      }
      else
      {
        phOsalNfc_MemCopy();
LABEL_30:
        v8 = 0;
      }
      if (*(unsigned __int8 *)(a3 + 103) < 0xFu)
        break;
      if (!*(_BYTE *)(a2 + 10))
      {
        *(_BYTE *)(a2 + 10) = 8;
        phOsalNfc_SetMemory();
        phOsalNfc_MemCopy();
      }
      v18 = *(unsigned __int8 *)(a3 + 54);
      *(_WORD *)(a2 + 64) = (4 * v18) & 0xC0;
      v19 = a1 + 4842;
      phOsalNfc_SetMemory();
      *(_BYTE *)(a2 + 59) = 0;
      if ((v18 & 2) == 0)
        break;
      v20 = *(unsigned __int8 *)(a3 + 103);
      if (v20 < 0x10)
        break;
      *(_BYTE *)(a2 + 59) = v20 - 15;
      if (v20 <= 0x30)
        goto LABEL_67;
LABEL_61:
      sub_219850628(1, v19, 4u, 1u, (uint64_t)"Received ATRInfo length exceeded max ATR length");
      goto LABEL_4;
    default:
      switch(a4)
      {
        case 128:
        case 131:
          if (*(unsigned __int8 *)(a3 + 103) < 0xEu)
          {
            v8 = 0;
            goto LABEL_6;
          }
          v11 = *(unsigned __int8 *)(a3 + 53);
          *(_WORD *)(a2 + 64) = (4 * v11) & 0xC0;
          phOsalNfc_SetMemory();
          v8 = 0;
          *(_BYTE *)(a2 + 59) = 0;
          if ((v11 & 2) == 0)
            goto LABEL_66;
          v12 = *(unsigned __int8 *)(a3 + 103);
          if (v12 < 0xF)
            goto LABEL_21;
          *(_BYTE *)(a2 + 59) = v12 - 14;
          if (v12 <= 0x30)
          {
            phOsalNfc_MemCopy();
LABEL_21:
            v8 = 0;
            goto LABEL_66;
          }
          sub_219850628(1, a1 + 4842, 4u, 1u, (uint64_t)"Received ATRInfo length exceeded max ATR length");
          v8 = 255;
LABEL_66:
          *(_BYTE *)(a2 + 10) = 10;
          phOsalNfc_SetMemory();
LABEL_67:
          phOsalNfc_MemCopy();
          break;
        case 130:
        case 133:
          v15 = *(unsigned __int8 *)(a3 + 10);
          *(_BYTE *)(a2 + 10) = v15;
          if (!v15)
            goto LABEL_34;
          phOsalNfc_SetMemory();
          if (*(unsigned __int8 *)(a2 + 10) > 0xAu)
          {
            sub_219850628(1, a1 + 4842, 4u, 1u, (uint64_t)"Received NFCID length exceeded max UID length");
            v8 = 255;
          }
          else
          {
            phOsalNfc_MemCopy();
LABEL_34:
            v8 = 0;
          }
          if (*(unsigned __int8 *)(a3 + 103) < 0xEu)
            goto LABEL_6;
          if (!*(_BYTE *)(a2 + 10))
          {
            *(_BYTE *)(a2 + 10) = 8;
            phOsalNfc_SetMemory();
            phOsalNfc_MemCopy();
          }
          v21 = *(unsigned __int8 *)(a3 + 53);
          *(_WORD *)(a2 + 64) = (4 * v21) & 0xC0;
          v19 = a1 + 4842;
          phOsalNfc_SetMemory();
          *(_BYTE *)(a2 + 59) = 0;
          if ((v21 & 2) == 0)
            goto LABEL_6;
          v22 = *(unsigned __int8 *)(a3 + 103);
          if (v22 < 0xF)
            goto LABEL_6;
          *(_BYTE *)(a2 + 59) = v22 - 14;
          if (v22 > 0x30)
            goto LABEL_61;
          goto LABEL_67;
        default:
          goto LABEL_6;
      }
      break;
  }
LABEL_6:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MapRemoteDevNfcIp1");
  return v8;
}

uint64_t sub_2198C7138(unsigned int *a1, uint64_t a2, unsigned int a3)
{
  uint64_t v6;
  uint64_t v7;
  _DWORD *v8;
  uint64_t v9;
  uint64_t i;
  uint64_t v11;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_CoreDeleteList");
  if (a2)
  {
    if (a3 < 6)
    {
      v6 = a3;
      v7 = a2 + 64 + 4 * a3;
      *(_DWORD *)(v7 + 60) = 0;
      v8 = (_DWORD *)(v7 + 60);
      v9 = *(_QWORD *)(a2 + 64 + 8 * a3);
      if (v9)
      {
        for (i = *(_QWORD *)(v9 + 264); i; i = *(_QWORD *)(v11 + 264))
        {
          v11 = i;
          phOsalNfc_FreeMemory();
        }
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a2 + 64 + 8 * v6) = 0;
        *(_WORD *)(a2 + 2 * v6 + 112) = 1;
        *v8 = 0;
      }
      else
      {
        sub_219850628(2, a1, 7u, 4u, (uint64_t)"phHciNfc_CoreDeleteList:List is empty");
        *v8 = 0;
        *(_WORD *)(a2 + 2 * a3 + 112) = 1;
      }
    }
    else
    {
      sub_219850628(2, a1, 7u, 4u, (uint64_t)"phHciNfc_CoreDeleteList : Index out of boundary ");
    }
  }
  else
  {
    sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_CoreDeleteList:NULL HCI Core context!");
  }
  return sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_CoreDeleteList");
}

uint64_t sub_2198C7294(unsigned int *a1, uint64_t a2, int a3, unsigned int a4)
{
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  uint64_t Memory;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;

  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_CoreGetNewNode");
  if (!a2)
    goto LABEL_8;
  v8 = a2 + 64;
  v9 = *(_QWORD *)(a2 + 64 + 8 * a4);
  if (!v9)
  {
    *(_QWORD *)(v8 + 8 * a4) = phOsalNfc_GetMemory();
    phOsalNfc_SetMemory();
    v15 = *(_QWORD *)(v8 + 8 * a4);
    *(_QWORD *)(v15 + 264) = 0;
    v14 = *(_QWORD *)(v8 + 8 * a4);
    *(_DWORD *)(v15 + 260) = 0;
    *(_QWORD *)(v14 + 264) = 0;
    *(_DWORD *)(v14 + 260) = a3;
    *(_DWORD *)(a2 + 4 * a4 + 124) = a3 - 2;
    goto LABEL_9;
  }
  do
  {
    v10 = v9;
    v9 = *(_QWORD *)(v9 + 264);
  }
  while (v9);
  Memory = phOsalNfc_GetMemory();
  *(_QWORD *)(v10 + 264) = Memory;
  if (!Memory)
  {
    sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_CoreGetNewNode:Memory allcation failed while creating new node!");
LABEL_8:
    v14 = 0;
    goto LABEL_9;
  }
  v12 = a2 + 64;
  ++*(_WORD *)(v12 + 2 * a4 + 48);
  phOsalNfc_SetMemory();
  v13 = *(_QWORD *)(v10 + 264);
  *(_DWORD *)(v13 + 260) = 254;
  *(_QWORD *)(v13 + 264) = 0;
  v14 = *(_QWORD *)(v10 + 264);
  *(_DWORD *)(v14 + 260) += a3;
  *(_DWORD *)(v12 + 4 * a4 + 60) = a3 + *(_DWORD *)(v12 + 4 * a4 + 60) - 1;
LABEL_9:
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_CoreGetNewNode");
  return v14;
}

uint64_t sub_2198C7418(unsigned int *a1, uint64_t a2, uint64_t a3, unsigned int a4)
{
  uint64_t v8;
  uint64_t v9;
  uint64_t v10;
  unsigned int v11;
  unsigned int v12;
  uint64_t v13;
  uint64_t v14;
  unsigned int i;
  int v16;
  unsigned int v17;
  uint64_t v18;
  int v19;
  uint64_t v20;
  uint64_t v22;
  uint64_t v23;

  v8 = *(_QWORD *)(a3 + 8);
  sub_219850718(2, a1, 7u, 5u, (uint64_t)"phHciNfc_HciCoreExtractData");
  v9 = a4;
  v10 = *(_QWORD *)(a2 + 64 + 8 * a4);
  v11 = *(unsigned __int16 *)(a2 + 64 + 2 * a4 + 48);
  *(_BYTE *)a3 = *(_BYTE *)v10 & 0x7F;
  *(_BYTE *)(a3 + 2) = *(_BYTE *)(v10 + 1) >> 6;
  *(_BYTE *)(a3 + 1) = *(_BYTE *)(v10 + 1) & 0x3F;
  v12 = *(_DWORD *)(v10 + 260) - 2;
  phOsalNfc_MemCopy();
  v13 = *(_QWORD *)(a3 + 8);
  if (v13)
    *(_QWORD *)(a3 + 8) = v13 + v12;
  v22 = v9;
  v23 = a2;
  if (v11 >= 2)
  {
    v14 = *(_QWORD *)(v10 + 264);
    for (i = 1; i < v11; ++i)
    {
      v16 = *(_DWORD *)(v14 + 260);
      v17 = v16 - 1;
      if (v16 == 1)
      {
        sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_HciCoreExtractData: HCI Core Receive- Zero Payload Len");
      }
      else
      {
        phOsalNfc_MemCopy();
        v18 = *(_QWORD *)(a3 + 8);
        if (v18)
          *(_QWORD *)(a3 + 8) = v18 + v17;
        v14 = *(_QWORD *)(v14 + 264);
        v12 += v17;
        if (!v14)
          break;
      }
    }
  }
  v19 = *(_DWORD *)(v23 + 4 * v22 + 124);
  *(_WORD *)(a3 + 4) = v19;
  *(_QWORD *)(a3 + 8) = v8;
  if (v12 == v19)
  {
    v20 = 0;
  }
  else
  {
    sub_219850628(2, a1, 7u, 1u, (uint64_t)"phHciNfc_HciCoreExtractData:HCI Core Receive- Mismatch in Number of Payload Bytes Processed and Stored");
    v20 = 255;
  }
  sub_219850808(2, a1, 7u, 5u, (uint64_t)"phHciNfc_HciCoreExtractData");
  return v20;
}

uint64_t sub_2198C75E0(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;

  v4 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendConnOpenCmd");
  if (a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Setting up commandInfo to be sent to lower layer ..");
    phOsalNfc_SetMemory();
    *(_QWORD *)&v4 = 1;
    DWORD2(v4) = 4;
    *(_QWORD *)&v5 = *(_QWORD *)(a1 + 848);
    DWORD2(v5) = *(_DWORD *)(a1 + 856);
    *(_DWORD *)(a1 + 3768) = 0;
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v4, a1 + 3760, 2000, (uint64_t)sub_219878950, a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendConnOpenCmd");
  return v2;
}

uint64_t sub_2198C76F0(uint64_t a1, int a2)
{
  unsigned __int8 *v4;
  uint64_t v5;
  _BYTE *v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnResp");
  if (a1)
  {
    if (!a2 && *(_DWORD *)(a1 + 3768) && (v4 = *(unsigned __int8 **)(a1 + 3760)) != 0)
    {
      if (*v4 == 241)
      {
        v5 = 81;
      }
      else
      {
        v5 = 0;
        if (!*v4)
        {
          v6 = (_BYTE *)(a1 + 32 * *(unsigned __int8 *)(a1 + 3778));
          v6[3794] = v4[1];
          v6[3793] = v4[2];
          v6[3792] = v4[3];
          v6[3808] = 1;
        }
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Conn Response invalid..");
      v5 = 255;
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v5 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnResp");
  return v5;
}

uint64_t sub_2198C77F4(uint64_t a1, uint64_t a2)
{
  void (*v4)(_QWORD, uint64_t, uint64_t);
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteConnOpenSequence");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 848) = 0;
    }
    v4 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 3920);
    if (v4)
    {
      v5 = a1 + 32 * *(unsigned __int8 *)(a1 + 3778);
      *(_QWORD *)(a1 + 3920) = 0;
      v4(*(_QWORD *)(a1 + 3912), v5 + 3792, a2);
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteConnOpenSequence");
  return a2;
}

uint64_t sub_2198C788C(uint64_t a1)
{
  uint64_t v2;
  char v4;
  __int128 v5;
  __int128 v6;

  v5 = 0u;
  v6 = 0u;
  v4 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendConnCloseCmd");
  if (a1)
  {
    v4 = *(_BYTE *)(a1 + 32 * *(unsigned __int8 *)(a1 + 3778) + 3792);
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Setting up commandInfo to be sent to lower layer ..");
    phOsalNfc_SetMemory();
    *(_QWORD *)&v5 = 1;
    DWORD2(v5) = 5;
    *(_QWORD *)&v6 = &v4;
    DWORD2(v6) = 1;
    *(_DWORD *)(a1 + 3768) = 0;
    v2 = sub_2198F2D0C(a1 + 888, (uint64_t)&v5, a1 + 3760, 2000, (uint64_t)sub_219878950, a1);
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_SendConnCloseCmd");
  return v2;
}

uint64_t sub_2198C79B8(uint64_t a1, int a2)
{
  unsigned __int8 *v4;
  int v5;
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnCloseResp");
  if (a1)
  {
    if (!a2 && *(_DWORD *)(a1 + 3768) && (v4 = *(unsigned __int8 **)(a1 + 3760)) != 0)
    {
      v5 = *v4;
      if (v5 == 241)
      {
        v6 = 81;
      }
      else
      {
        v6 = 0;
        if (!v5)
          *(_BYTE *)(a1 + 32 * *(unsigned __int8 *)(a1 + 3778) + 3808) = 0;
      }
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Conn Response invalid..");
      v6 = 255;
    }
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v6 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnCloseResp");
  return v6;
}

uint64_t sub_2198C7AA0(uint64_t a1, uint64_t a2)
{
  void (*v4)(_QWORD, uint64_t, uint64_t);
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteConnCloseSequence");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 848))
      *(_QWORD *)(a1 + 848) = 0;
    v4 = *(void (**)(_QWORD, uint64_t, uint64_t))(a1 + 3920);
    if (v4)
    {
      v5 = a1 + 32 * *(unsigned __int8 *)(a1 + 3778);
      *(_QWORD *)(a1 + 3920) = 0;
      v4(*(_QWORD *)(a1 + 3912), v5 + 3792, a2);
    }
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_CompleteConnCloseSequence");
  return a2;
}

uint64_t sub_2198C7B30(uint64_t a1)
{
  uint64_t v2;
  const char *v3;
  uint64_t v5;
  uint64_t v6;

  v5 = 0;
  v6 = 0;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnInit");
  if (a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Initializing ConnInfo..");
    *(_WORD *)(a1 + 3792) = 0;
    *(_BYTE *)(a1 + 3794) = 0;
    *(_BYTE *)(a1 + 3784) = -1;
    *(_DWORD *)(a1 + 3788) = 255;
    *(_BYTE *)(a1 + 3808) = 0;
    *(_BYTE *)(a1 + 3778) = -1;
    *(_WORD *)(a1 + 3776) = 256;
    *(_BYTE *)(a1 + 3929) = 0;
    phOsalNfc_SetMemory();
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Registering for Conn Credits Notification");
    BYTE5(v6) = 2;
    v5 = 3;
    LODWORD(v6) = 6;
    v2 = sub_2198F2F98((unsigned int *)(a1 + 888), (uint64_t)&v5, (uint64_t)sub_2198C7CA8, a1);
    if ((_DWORD)v2)
      v3 = "Conn Credits Ntf Registration failed";
    else
      v3 = "Conn Credits Ntf successfully Registered";
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)v3);
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnInit");
  return v2;
}

uint64_t sub_2198C7CA8(uint64_t a1, uint64_t a2, int a3)
{
  unsigned int *v6;
  unsigned int *v7;
  unsigned int *v8;
  const char *v9;
  uint64_t v10;
  unsigned __int8 *v12;
  unsigned int v13;
  int v14;
  int v15;
  int v16;
  _BYTE *v17;
  uint64_t v18;
  _BYTE *v19;
  char v20;
  uint64_t v21;
  unsigned int *v22;
  const char *v23;
  uint64_t v24;
  int *v25;
  void (*v26)(uint64_t, _QWORD, uint64_t);
  uint64_t v27;
  int *v28;
  uint64_t v29;
  int v30;
  unsigned __int8 v31;

  v31 = -1;
  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnNotifCB");
  v6 = sub_2198C82D4((unsigned int *)a1);
  if (!a1 || (v7 = v6) == 0)
  {
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v10 = 1;
LABEL_11:
    sub_219850628(2, (unsigned int *)a1, 3u, 4u, (uint64_t)"None is waiting for Credit Ntf or Wait Credit recevied on different loggical connection ");
    goto LABEL_12;
  }
  if (!a2 || !*(_QWORD *)(a2 + 8) || a3 || !*(_DWORD *)(a2 + 16))
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Conn Notification invalid..");
    v10 = 255;
    goto LABEL_11;
  }
  if (*(_DWORD *)(a1 + 1804))
  {
    v8 = (unsigned int *)(a1 + 6476);
    v9 = " Invalid Gid received..";
    v10 = 1;
LABEL_41:
    sub_219850628(1, v8, 3u, 4u, (uint64_t)v9);
    goto LABEL_11;
  }
  if (*(_DWORD *)(a1 + 1808) != 6)
  {
    v9 = " Invalid Oid received..";
    v10 = 1;
    v8 = (unsigned int *)(a1 + 6476);
    goto LABEL_41;
  }
  sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Core ConnCredits Notification received..");
  v12 = *(unsigned __int8 **)(a2 + 8);
  v13 = *v12;
  *(_BYTE *)(a1 + 3776) = 1;
  *(_BYTE *)(a1 + 3929) = 0;
  if (!v13)
  {
LABEL_54:
    v10 = 0;
    *(_BYTE *)(a1 + 3776) = 0;
    goto LABEL_11;
  }
  v14 = 0;
  v15 = 0;
  LOBYTE(v16) = 0;
  v30 = 0;
  v17 = (_BYTE *)(a1 + 4736);
  while (1)
  {
    v10 = sub_2198C8378(a1, v12[1], &v31);
    if ((_DWORD)v10)
      break;
    v18 = *(_QWORD *)(a2 + 8);
    v19 = (_BYTE *)(a1 + 32 * v31 + 3793);
    v20 = *v19 + *(_BYTE *)(v18 + 2);
    *v19 = v20;
    v30 = *(unsigned __int8 *)(v18 + 1);
    if (v20 == -1)
    {
      *v19 = -2;
      v22 = (unsigned int *)(a1 + 6476);
      v23 = " Credits Limit xceeded for this Conn,Ignoring notif value ..";
LABEL_26:
      sub_219850628(1, v22, 3u, 4u, (uint64_t)v23);
      goto LABEL_27;
    }
    sub_219851888(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Credits updated for ConnId");
    *(_BYTE *)(a1 + 6433) = 0;
    if (*v17 == 1)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Using timer with 10mSec to send EOF data packet\n");
      v21 = *(_QWORD *)(a1 + 4656);
      if (v21 != 0xFFFFFFFFFFFFLL)
      {
        sub_21988C4AC(*(_DWORD *)(a1 + 6476), v21);
        *(_BYTE *)(a1 + 6464) = 0;
        if (!phOsalNfc_Timer_Start())
        {
          sub_21988629C(1, (unsigned int *)(a1 + 6476), *(_QWORD *)(a1 + 4656), 3u, 4u, (uint64_t)"phNciNfc_LogConnNotifCB");
          v22 = (unsigned int *)(a1 + 6476);
          v23 = "EOF timer started\n";
          goto LABEL_26;
        }
        *v17 = 0;
        sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 1u, (uint64_t)"EOF timer start failed\n");
      }
    }
LABEL_27:
    v16 = *v19;
    if (*(_BYTE *)(a1 + 5206) == 1 || *(_BYTE *)(a1 + 5574) == 1)
      v14 = 1;
    if (v14 != 1 || v16)
      goto LABEL_18;
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 2u, (uint64_t)" No more Credits available..waiting for Credit Ntf");
    v24 = *((_QWORD *)v7 + 7);
    if (v24 && v24 != 0xFFFFFFFFFFFFLL)
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Stopping Credit await timer as zero credit recvd..");
      phOsalNfc_Timer_Stop();
      phOsalNfc_Timer_Delete();
      *(_BYTE *)(a1 + 6465) = 0;
      *((_BYTE *)v7 + 64) = 0;
      *((_QWORD *)v7 + 7) = 0;
      v25 = &dword_253E47158;
      if (!*(_DWORD *)(a1 + 6476))
        v25 = &dword_253E47070;
      v25[1] &= ~8u;
    }
    v14 = 1;
    *(_BYTE *)(a1 + 3929) = 1;
    if (++v15 >= v13)
      goto LABEL_54;
    LOBYTE(v16) = 0;
LABEL_19:
    v12 = *(unsigned __int8 **)(a2 + 8);
  }
  sub_219851888(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Failed to get Conn details for index..");
LABEL_18:
  if (++v15 < v13)
    goto LABEL_19;
  *(_BYTE *)(a1 + 3776) = 0;
  if (!(_BYTE)v16)
    goto LABEL_11;
  if (v30 != *(unsigned __int8 *)(a1 + 6497))
    goto LABEL_11;
  v26 = *(void (**)(uint64_t, _QWORD, uint64_t))(a1 + 6520);
  if (!v26)
    goto LABEL_11;
  if (v14 == 1)
    *(_WORD *)(a1 + 6610) = 0;
  v27 = *(_QWORD *)(a1 + 6544);
  if (v27 && v27 != 0xFFFFFFFFFFFFLL && *(_BYTE *)(a1 + 6552) == 1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Stopping Credit await timer..");
    phOsalNfc_Timer_Stop();
    phOsalNfc_Timer_Delete();
    *(_BYTE *)(a1 + 6465) = 0;
    *(_BYTE *)(a1 + 6552) = 0;
    *(_QWORD *)(a1 + 6544) = 0;
    v28 = &dword_253E47158;
    if (!*(_DWORD *)(a1 + 6476))
      v28 = &dword_253E47070;
    v28[1] &= ~8u;
    v26 = *(void (**)(uint64_t, _QWORD, uint64_t))(a1 + 6520);
  }
  *(_BYTE *)(a1 + 6537) = 0;
  v29 = *(_QWORD *)(a1 + 6528);
  *(_BYTE *)(a1 + 6497) = -1;
  *(_QWORD *)(a1 + 6520) = 0;
  *(_QWORD *)(a1 + 6528) = 0;
  v26(v29, v16, v10);
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnNotifCB");
  return v10;
}

uint64_t sub_2198C81DC(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ResetLogConn");
  if (a1)
  {
    sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)"Resetting Logical conn");
    phOsalNfc_SetMemory();
    *(_WORD *)(a1 + 3792) = 0;
    *(_BYTE *)(a1 + 3794) = 0;
    *(_BYTE *)(a1 + 3784) = -1;
    *(_DWORD *)(a1 + 3788) = 255;
    *(_BYTE *)(a1 + 3808) = 0;
    *(_BYTE *)(a1 + 3778) = -1;
    *(_WORD *)(a1 + 3776) = 256;
    *(_BYTE *)(a1 + 3929) = 0;
    phOsalNfc_SetMemory();
    v2 = 0;
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)"Reset Logical conn: Invalid Context Param");
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_ResetLogConn");
  return v2;
}

unsigned int *sub_2198C82D4(unsigned int *a1)
{
  char v2;
  uint64_t v3;
  unsigned int *v4;
  unsigned int *v5;

  sub_219850718(2, a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnGetCtxt");
  if (a1)
  {
    v2 = 0;
    v3 = 0;
    do
    {
      v4 = (unsigned int *)*((_QWORD *)&unk_253E46700 + 14 * v3 + 4);
      if ((v2 & 1) != 0)
        break;
      v2 = 1;
      v3 = 1;
    }
    while (v4 != a1);
    if (v4 == a1)
      v5 = a1 + 1622;
    else
      v5 = 0;
  }
  else
  {
    v5 = 0;
  }
  sub_219850808(2, a1, 3u, 5u, (uint64_t)"phNciNfc_LogConnGetCtxt");
  return v5;
}

uint64_t sub_2198C8378(uint64_t a1, int a2, _BYTE *a3)
{
  uint64_t v6;
  unsigned __int8 *v7;
  int v8;
  uint64_t v9;
  unsigned __int8 *v10;
  int v11;

  sub_219850718(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetConnInfo");
  if (a1)
  {
    if (*(_BYTE *)(a1 + 3776))
    {
      sub_219850628(1, (unsigned int *)(a1 + 6476), 3u, 4u, (uint64_t)" Notification Case..");
      v6 = 0;
      v7 = (unsigned __int8 *)(a1 + 3792);
      while (1)
      {
        v8 = *v7;
        v7 += 32;
        if (v8 == a2)
          break;
        if (++v6 == 4)
          goto LABEL_14;
      }
    }
    else
    {
      v10 = (unsigned __int8 *)(a1 + 3824);
      v6 = 1;
      while (1)
      {
        v11 = *(_BYTE *)(a1 + 6536) ? *v10 : *(v10 - 8);
        if (v11 == a2)
          break;
        ++v6;
        v10 += 32;
        if (v6 == 4)
        {
LABEL_14:
          v9 = 255;
          goto LABEL_16;
        }
      }
    }
    v9 = 0;
    *a3 = v6;
  }
  else
  {
    sub_219850628(2, 0, 3u, 4u, (uint64_t)" Invalid Context Param..");
    v9 = 1;
  }
LABEL_16:
  sub_219850808(2, (unsigned int *)a1, 3u, 5u, (uint64_t)"phNciNfc_GetConnInfo");
  return v9;
}

uint64_t sub_2198C849C(uint64_t a1)
{
  uint64_t i;
  uint64_t v2;
  uint64_t v4;
  uint64_t v5;

  v4 = 0;
  v5 = a1;
  sub_219850718(0, (unsigned int *)&v5, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_H_Reset");
  sub_21988EF68(v5, &v4);
  if (v4)
  {
    for (i = 697; i != 737; ++i)
      *(_BYTE *)(v4 + i) = 1;
    v2 = 0;
  }
  else
  {
    v2 = 49;
  }
  sub_219850808(0, (unsigned int *)&v5, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_H_Reset");
  return v2;
}

uint64_t sub_2198C8538(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  char v7;
  __int16 v8;
  unsigned int v9;
  uint64_t v11;
  uint64_t v13;
  uint64_t v14;

  v13 = 0;
  v14 = a1;
  sub_219850718(0, (unsigned int *)&v14, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_ChkNdef");
  sub_21988EF68(v14, &v13);
  v5 = 1;
  if (!a3)
    goto LABEL_20;
  if (!a2)
    goto LABEL_20;
  v6 = v13;
  if (!v13)
    goto LABEL_20;
  *(_QWORD *)(v13 + 8) = a2;
  *(_QWORD *)(v6 + 40) = a3;
  *(_BYTE *)(v6 + 547) = 1;
  *(_BYTE *)(v6 + 204) &= 0xFCu;
  *(_BYTE *)(v6 + 208) = 0;
  *(_BYTE *)(v6 + 540) = 1;
  *(_BYTE *)(v6 + 753) = 0;
  if ((*(_BYTE *)(*(_QWORD *)(v6 + 224) + 68) & 0x18) == 8)
  {
    *(_WORD *)(v6 + 668) = 45;
    v7 = 7;
    if (!*(_BYTE *)(v6 + 544))
    {
      v8 = 720;
      goto LABEL_10;
    }
    goto LABEL_8;
  }
  *(_WORD *)(v6 + 668) = 210;
  v7 = 8;
  if (*(_BYTE *)(v6 + 544))
  {
LABEL_8:
    v8 = *(_WORD *)(v6 + 740);
    goto LABEL_10;
  }
  v8 = 3360;
LABEL_10:
  *(_WORD *)(v6 + 740) = v8;
  *(_BYTE *)(v6 + 544) = v7;
  v9 = *(unsigned __int8 *)(v6 + 666);
  if (v9 - 64 < 3 || v9 <= 2)
  {
    if (*(_BYTE *)(v6 + 677))
    {
      *(_BYTE *)v6 = 4;
      *(_BYTE *)(v6 + 540) = 1;
      *(_BYTE *)(v6 + 739) = 1;
      *(_QWORD *)(v6 + 48) = sub_2198C8800;
      *(_QWORD *)(v6 + 56) = v6;
      *(_DWORD *)(v6 + 232) = 48;
      *(_WORD *)(v6 + 264) = 260;
      *(_BYTE *)(v6 + 266) = v9;
      *(_WORD *)(v6 + 526) = 1;
      v11 = sub_219888630(v6, (uint64_t)sub_2198C8BA0);
    }
    else
    {
      if (!*(_BYTE *)(v6 + 666))
        *(_BYTE *)(v6 + 666) = 1;
      v11 = sub_2198C86C0(v6);
    }
    v5 = v11;
  }
LABEL_20:
  sub_219850808(0, (unsigned int *)&v14, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_ChkNdef");
  return v5;
}

uint64_t sub_2198C86C0(uint64_t a1)
{
  int v2;
  uint64_t v3;
  unsigned int v4;
  uint64_t v7;
  __int16 v8;
  uint64_t v9;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_AuthSector");
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_BYTE *)(a1 + 208) = 0;
  *(_QWORD *)(a1 + 48) = sub_2198C8800;
  *(_QWORD *)(a1 + 56) = a1;
  *(_WORD *)(a1 + 264) = 260;
  *(_BYTE *)a1 = 3;
  *(_DWORD *)(a1 + 232) = 96;
  v2 = *(unsigned __int8 *)(a1 + 71);
  v3 = 666;
  if (v2 == 1)
    v3 = 70;
  *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + v3);
  v4 = *(unsigned __int8 *)(a1 + 666);
  if ((v4 - 64 < 3 || v4 <= 2) && v2 != 1)
  {
    v7 = a1 + 266;
    *(_DWORD *)(a1 + 267) = -1549622880;
    v8 = -23132;
LABEL_14:
    *(_WORD *)(v7 + 5) = v8;
    goto LABEL_15;
  }
  if (*(_BYTE *)(a1 + 540) != 6)
  {
    v7 = a1 + 266;
    *(_DWORD *)(a1 + 267) = -137103405;
    v8 = -2093;
    goto LABEL_14;
  }
  *(_DWORD *)(a1 + 232) = 97;
  phOsalNfc_MemCopy();
LABEL_15:
  *(_WORD *)(a1 + 526) = 7;
  *(_WORD *)(a1 + 264) = 260;
  v9 = sub_219888630(a1, (uint64_t)sub_2198C8BA0);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_AuthSector");
  return v9;
}

uint64_t sub_2198C8800(uint64_t a1, unsigned int *a2, uint64_t a3)
{
  uint64_t v5;
  unsigned __int8 v6;
  char *v7;
  int v8;
  uint64_t (*v9)(unsigned int *, char *);
  uint64_t v10;
  uint64_t v11;
  int v12;
  unsigned int v13;
  unint64_t v14;
  char v15;
  int v16;
  unsigned int v17;
  unsigned __int16 v18;
  BOOL v19;
  __int16 v20;
  int v21;
  int v22;
  int v23;
  char v25;
  uint64_t v26;
  uint64_t v27;
  uint64_t v28;
  uint64_t v29;
  int v30;

  v26 = a1;
  v25 = 0;
  sub_219850718(0, (unsigned int *)&v26, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_Process");
  if ((_BYTE)a3)
  {
    if (*(_BYTE *)a2 == 3)
    {
      if (a3 - 146 <= 0x29
        && ((1 << (a3 + 110)) & 0x3F900000041) != 0)
      {
        sub_2198CC9D4((uint64_t)a2, (BOOL *)&v25);
        goto LABEL_14;
      }
      v10 = sub_2198CC9D4((uint64_t)a2, (BOOL *)&v25);
      goto LABEL_13;
    }
    if (a3 - 146 > 0x29 || ((1 << (a3 + 110)) & 0x37900000001) == 0)
    {
      if (a3 == 185)
        a3 = a3;
      else
        a3 = 245;
    }
    v25 = 1;
  }
  else
  {
    sub_219850718(2, a2, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_GetNdefFuncIndex");
    v5 = 0;
    v6 = -1;
    v7 = &byte_24DB723E8;
    do
    {
      v8 = *v7;
      v7 += 16;
      if (*(unsigned __int8 *)a2 == v8)
        v6 = v5;
      ++v5;
    }
    while (v5 != 16);
    sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_GetNdefFuncIndex");
    if (v6 != 0xFF)
    {
      v9 = (uint64_t (*)(unsigned int *, char *))*(&off_24DB723E0 + 2 * v6);
      if (!v9)
        goto LABEL_14;
      v10 = v9(a2, &v25);
LABEL_13:
      a3 = v10;
LABEL_14:
      if (v25 != 1)
        return sub_219850808(0, (unsigned int *)&v26, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_Process");
      goto LABEL_20;
    }
    v25 = 1;
    a3 = 245;
  }
LABEL_20:
  v30 = 0;
  v28 = 0;
  v29 = 0;
  v27 = 0;
  sub_219850718(2, a2, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Complete");
  *(_BYTE *)a2 = 0;
  switch(*((_BYTE *)a2 + 547))
  {
    case 1:
      if ((_DWORD)a3)
      {
        *((_BYTE *)a2 + 546) = 0;
        LOBYTE(v29) = 3;
        if (a3 <= 0x1Du && ((1 << a3) & 0x34400002) != 0)
        {
          v11 = *((_QWORD *)a2 + 341);
          if (v11)
          {
            v12 = sub_21990201C(*(_QWORD *)(v11 + 3040));
            if (v12 == 187)
              v13 = 187;
            else
              v13 = 152;
            if (v12 == 186)
              a3 = 186;
            else
              a3 = v13;
          }
        }
      }
      else
      {
        v14 = 0;
        *((_BYTE *)a2 + 546) = 1;
        do
        {
          v15 = v14 + 1;
          if (v14 > 0x27)
            break;
          v16 = *((unsigned __int8 *)a2 + v14++ + 697);
        }
        while (v16 == 1);
        v17 = (v15 - 1);
        if (v17 > 0x27)
        {
          v22 = -2;
        }
        else
        {
          v18 = 0;
          do
          {
            if (*((_BYTE *)a2 + v17 + 697))
              break;
            v19 = *((_BYTE *)a2 + 544) == 8 && v17 > 0x1F;
            v20 = v19 ? 240 : 48;
            v18 += v20;
            if (v17 == 15)
              v17 += 2;
            else
              ++v17;
          }
          while (v17 < 0x28);
          if ((v18 & 0xFF00) != 0)
            v21 = -4;
          else
            v21 = -2;
          v22 = v21 + v18;
        }
        a3 = 0;
        v23 = v22 - *((unsigned __int16 *)a2 + 43);
        HIDWORD(v29) = *((unsigned __int16 *)a2 + 39);
        v30 = v23;
        LOBYTE(v29) = *((_BYTE *)a2 + 545);
      }
      (*((void (**)(_QWORD, uint64_t, uint64_t *))a2 + 1))(*((_QWORD *)a2 + 5), a3, &v29);
      break;
    case 2:
      if (!(_DWORD)a3)
      {
        LODWORD(v28) = **((_DWORD **)a2 + 69);
        v27 = *((_QWORD *)a2 + 30);
      }
      (*((void (**)(_QWORD, uint64_t, uint64_t *))a2 + 2))(*((_QWORD *)a2 + 5), a3, &v27);
      break;
    case 3:
      (*((void (**)(_QWORD, uint64_t))a2 + 3))(*((_QWORD *)a2 + 5), a3);
      break;
    case 6:
      (*((void (**)(_QWORD, uint64_t))a2 + 4))(*((_QWORD *)a2 + 5), a3);
      break;
    default:
      break;
  }
  sub_219850808(2, a2, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Complete");
  return sub_219850808(0, (unsigned int *)&v26, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_Process");
}

uint64_t sub_2198C8BA0(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_CB_Transceive");
  sub_21988EF68(v10, &v9);
  v7 = v9;
  if (v9)
  {
    if (a4)
      *(_WORD *)(v9 + 264) = *(_DWORD *)(a4 + 8);
    (*(void (**)(_QWORD, uint64_t, uint64_t))(v7 + 48))(*(_QWORD *)(v7 + 2712), v7, a5);
  }
  return sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_CB_Transceive");
}

uint64_t sub_2198C8C34(uint64_t a1, uint64_t a2, _DWORD *a3, unsigned int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  _DWORD *v13;
  uint64_t v14;
  uint64_t v15;
  uint64_t v17;
  __int16 v18;
  char v19;
  uint64_t v20;

  v20 = a1;
  v19 = 0;
  v18 = 208;
  v17 = 0;
  sub_219850718(0, (unsigned int *)&v20, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_RdNdef");
  sub_21988EF68(v20, &v17);
  v11 = 1;
  if (a4 <= 1 && a3 && a2 && a5 && v17)
  {
    if (a4 == 1 || *(_BYTE *)(v17 + 540) != 3)
    {
      phOsalNfc_MemCopy();
      v12 = v17;
      v13 = (_DWORD *)(v17 + 2740);
      *(_DWORD *)(v17 + 2740) = 3;
      *(_QWORD *)(v12 + 16) = a5;
      *(_QWORD *)(v12 + 40) = a6;
      *(_BYTE *)(v12 + 547) = 2;
      if (*a3)
        v13 = a3;
      else
        a2 = v12 + 2736;
      *(_DWORD *)(v12 + 248) = *v13;
      *(_QWORD *)(v12 + 552) = v13;
      *v13 = 0;
      *(_WORD *)(v12 + 252) = 0;
      *(_BYTE *)(v12 + 540) = 2;
      v11 = 1;
      *(_BYTE *)(v12 + 753) = 1;
      if (*(_BYTE *)(v12 + 545) && *(_BYTE *)(v12 + 545) != 3)
      {
        if (a4 == 1)
        {
          sub_2198C8DF0(v12);
          v12 = v17;
          *(_BYTE *)(v17 + 738) = 1;
          *(_BYTE *)(v12 + 66) = 0;
        }
        else if (*(_BYTE *)(v12 + 672) == 1)
        {
          v11 = 26;
          goto LABEL_23;
        }
        *(_BYTE *)(v12 + 560) = a4;
        if (!sub_2198C8E80(v12))
        {
          v14 = v17;
          *(_QWORD *)(v17 + 240) = a2;
          *(_BYTE *)(v14 + 672) = 0;
          if (*(_BYTE *)(v14 + 677) == 1)
            v15 = sub_2198C8FC4(v14);
          else
            v15 = sub_2198C86C0(v14);
          v11 = v15;
        }
      }
    }
    else
    {
      v11 = 245;
    }
  }
LABEL_23:
  sub_219850808(0, (unsigned int *)&v20, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_RdNdef");
  return v11;
}

uint64_t sub_2198C8DF0(uint64_t a1)
{
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdWrReset");
  *(_WORD *)(a1 + 78) = 0;
  *(_BYTE *)(a1 + 75) = 0;
  *(_WORD *)(a1 + 84) = 0;
  *(_DWORD *)(a1 + 664) = 17039360;
  *(_BYTE *)(a1 + 677) = 0;
  *(_WORD *)(a1 + 746) = 0;
  *(_DWORD *)(a1 + 68) = 0;
  *(_WORD *)(a1 + 72) = 0;
  *(_BYTE *)(a1 + 758) = 1;
  *(_BYTE *)(a1 + 672) = 0;
  *(_WORD *)(a1 + 740) = 16 * *(_WORD *)(a1 + 668);
  *(_WORD *)(a1 + 754) = 1;
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdWrReset");
}

uint64_t sub_2198C8E80(uint64_t a1)
{
  unsigned int v2;
  int v3;
  uint64_t v4;
  char v6;

  v6 = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_BlkChk");
  while (1)
  {
    v2 = sub_2198CCC80((unsigned int *)a1, *(unsigned __int8 *)(a1 + 666));
    if (*(_BYTE *)(a1 + 544) != 7)
      break;
    if (v2 >= 0x10)
    {
      sub_2198CCC80((unsigned int *)a1, *(unsigned __int8 *)(a1 + 666));
      v4 = 1;
      goto LABEL_17;
    }
LABEL_4:
    sub_2198CCCF4(a1, v2, &v6);
LABEL_14:
    if (v6 == 1)
      goto LABEL_15;
  }
  v3 = *(unsigned __int8 *)(a1 + 666);
  if (v3 == 64)
  {
    *(_BYTE *)(a1 + 666) = 68;
    goto LABEL_14;
  }
  if (v2 <= 0x1F)
  {
    if (v3 == 63)
    {
      *(_BYTE *)(a1 + 666) = 67;
      goto LABEL_14;
    }
    goto LABEL_4;
  }
  if ((((_BYTE)v3 + 1) & 0xF) == 0)
  {
    *(_BYTE *)(a1 + 666) = v3 + 1;
    goto LABEL_14;
  }
  if (*(_BYTE *)(a1 + v2 + 697))
  {
    *(_BYTE *)(a1 + 666) = v3 + 16;
    goto LABEL_14;
  }
  if (16 * v2 - 384 != v3 || *(_WORD *)(a1 + 664))
  {
LABEL_15:
    v4 = 0;
    goto LABEL_17;
  }
  v4 = 0;
  *(_BYTE *)(a1 + 677) = 0;
LABEL_17:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_BlkChk");
  return v4;
}

uint64_t sub_2198C8FC4(uint64_t a1)
{
  unsigned int v2;
  int v3;
  uint64_t v4;
  int v5;
  int v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdABlock");
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_BYTE *)(a1 + 208) = 0;
  *(_BYTE *)a1 = 1;
  *(_BYTE *)(a1 + 540) = 2;
  *(_QWORD *)(a1 + 48) = sub_2198C8800;
  *(_QWORD *)(a1 + 56) = a1;
  v2 = *(unsigned __int16 *)(a1 + 252);
  v3 = *(_DWORD *)(a1 + 248);
  if (v2 >= (unsigned __int16)v3)
  {
    v5 = *(unsigned __int16 *)(a1 + 668);
    v6 = *(unsigned __int8 *)(a1 + 667);
    if (v3 == v2 || v5 == v6)
    {
      v7 = 0;
      *(_BYTE *)(a1 + 672) = v5 == v6;
      **(_DWORD **)(a1 + 552) = v2;
    }
    else
    {
      v7 = 255;
    }
  }
  else
  {
    if (*(_WORD *)(a1 + 664))
    {
      v4 = sub_2198CCA98(a1);
    }
    else
    {
      *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 666);
      *(_WORD *)(a1 + 526) = 1;
      *(_WORD *)(a1 + 264) = 260;
      *(_DWORD *)(a1 + 232) = 48;
      v4 = sub_219888630(a1, (uint64_t)sub_2198C8BA0);
    }
    v7 = v4;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdABlock");
  return v7;
}

uint64_t sub_2198C90DC(uint64_t a1, uint64_t a2, _DWORD *a3, int a4, uint64_t a5, uint64_t a6)
{
  uint64_t v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  _DWORD *v15;
  int v17;
  _BYTE *v18;
  uint64_t v19;
  uint64_t v20;
  uint64_t v21;

  v20 = 0;
  v21 = a1;
  sub_219850718(0, (unsigned int *)&v21, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_WrNdef");
  sub_21988EF68(v21, &v20);
  v11 = 1;
  if (a3 && a5 && v20)
  {
    phOsalNfc_MemCopy();
    v12 = v20;
    *(_DWORD *)(v20 + 2740) = 3;
    *(_QWORD *)(v12 + 24) = a5;
    *(_QWORD *)(v12 + 40) = a6;
    *(_BYTE *)(v12 + 547) = 3;
    *(_WORD *)(v12 + 252) = 0;
    **(_WORD **)(v12 + 528) = 0;
    v13 = v20;
    v14 = v20 + 2736;
    if (*a3)
      v15 = a3;
    else
      v15 = (_DWORD *)(v20 + 2740);
    if (*a3)
      v14 = a2;
    *(_QWORD *)(v20 + 240) = v14;
    *(_DWORD *)(v13 + 248) = *v15;
    *(_WORD *)(v13 + 252) = 0;
    *(_QWORD *)(v13 + 256) = v15;
    *v15 = 0;
    *(_BYTE *)(v13 + 540) = 3;
    *(_BYTE *)(v13 + 753) = 2;
    if ((*(unsigned __int8 *)(v13 + 545) | 2) == 3)
      goto LABEL_10;
    if (a4 == 1)
    {
      *(_BYTE *)(v13 + 66) = 0;
      *(_WORD *)(v13 + 676) = 1;
      *(_BYTE *)(v13 + 737) = 1;
      *(_DWORD *)(v13 + 664) = 17039360;
      *(_WORD *)(v13 + 84) = 0;
      *(_WORD *)(v13 + 68) = 0;
      *(_BYTE *)(v13 + 71) = 0;
      *(_WORD *)(v13 + 740) = 16 * *(_WORD *)(v13 + 668);
      *(_WORD *)(v13 + 746) = 0;
      *(_WORD *)(v13 + 754) = 0;
      *(_DWORD *)(v13 + 756) = 0x1000000;
    }
    else if (!a4 && (*(_BYTE *)(v13 + 672) == 1 || *(_BYTE *)(v13 + 757) == 1))
    {
      v11 = 26;
      goto LABEL_11;
    }
    *(_BYTE *)(v13 + 560) = a4;
    *(_BYTE *)(v13 + 677) = 0;
    v17 = sub_2198C8E80(v13);
    v18 = (_BYTE *)v20;
    *(_BYTE *)(v20 + 672) = 0;
    if (v17)
    {
LABEL_10:
      v11 = 1;
    }
    else
    {
      if (v18[757] == 1)
      {
        v19 = sub_2198C92E8((uint64_t)v18);
      }
      else if (v18[677] == 1)
      {
        if (v18[560] == 1)
          v19 = sub_2198C9374((uint64_t)v18);
        else
          v19 = sub_2198C93F4((uint64_t)v18);
      }
      else
      {
        v19 = sub_2198C86C0((uint64_t)v18);
      }
      v11 = v19;
    }
  }
LABEL_11:
  sub_219850808(0, (unsigned int *)&v21, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_WrNdef");
  return v11;
}

uint64_t sub_2198C92E8(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_CallDisCon");
  *(_BYTE *)a1 = 15;
  *(_QWORD *)(a1 + 48) = sub_2198C8800;
  *(_QWORD *)(a1 + 56) = a1;
  v2 = sub_21988879C(a1, (uint64_t)sub_2198CD61C, *(_QWORD *)(a1 + 224));
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_CallDisCon");
  return v2;
}

uint64_t sub_2198C9374(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdBeforeWr");
  *(_BYTE *)a1 = 9;
  *(_BYTE *)(a1 + 540) = 3;
  v2 = sub_2198CCE3C(a1, *(_BYTE *)(a1 + 666));
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdBeforeWr");
  return v2;
}

uint64_t sub_2198C93F4(uint64_t a1)
{
  unsigned int v2;
  unsigned int v3;
  unsigned int v4;
  unsigned int v5;
  unsigned __int8 v6;
  int v7;
  uint64_t v8;
  uint64_t v9;
  uint64x2_t v10;
  int64x2_t v11;
  uint64_t v12;
  int64x2_t v13;
  int32x2_t v14;
  char v15;
  uint64_t v16;
  unint64_t v17;
  uint64x2_t v18;
  uint64_t v19;
  int32x2_t v20;
  char v21;
  char v22;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_WrABlock");
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_BYTE *)(a1 + 208) = 0;
  *(_QWORD *)(a1 + 48) = sub_2198C8800;
  *(_QWORD *)(a1 + 56) = a1;
  *(_BYTE *)(a1 + 540) = 3;
  *(_BYTE *)a1 = 2;
  v2 = *(unsigned __int16 *)(a1 + 252);
  v3 = *(unsigned __int16 *)(a1 + 248);
  if (v3 > v2)
  {
    v4 = (unsigned __int16)(v3 - v2);
    if (v4 >= *(unsigned __int16 *)(a1 + 740))
      v5 = *(unsigned __int16 *)(a1 + 740);
    else
      v5 = v4;
    *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 666);
    if (*(_WORD *)(a1 + 664))
    {
      phOsalNfc_MemCopy();
      v6 = *(_BYTE *)(a1 + 664) + 1;
      v7 = 17 - v6;
      if (v7 > (int)v5)
      {
        phOsalNfc_MemCopy();
        *(_BYTE *)(a1 + 670) = 1;
        *(_WORD *)(a1 + 212) = v5;
        **(_WORD **)(a1 + 528) = (v6 + v5) - 1;
        v8 = (unsigned __int16)(17 - (v6 + v5));
        if (17 != (v6 + v5))
        {
          v9 = 0;
          *(_BYTE *)(a1 + 74) = 1;
          v10 = (uint64x2_t)vdupq_n_s64(v8 - 1);
          v11 = (int64x2_t)xmmword_21990ADE0;
          v12 = a1 + (v6 + v5);
          v13 = vdupq_n_s64(2uLL);
          do
          {
            v14 = vmovn_s64((int64x2_t)vcgeq_u64(v10, (uint64x2_t)v11));
            if ((v14.i8[0] & 1) != 0)
            {
              if (v9)
                v15 = 0;
              else
                v15 = -2;
              *(_BYTE *)(v12 + v9 + 266) = v15;
            }
            if ((v14.i8[4] & 1) != 0)
              *(_BYTE *)(v12 + v9 + 267) = 0;
            v9 += 2;
            v11 = vaddq_s64(v11, v13);
          }
          while ((((_DWORD)v8 + 1) & 0x1FFFE) != v9);
        }
        goto LABEL_38;
      }
    }
    else
    {
      if (v5 < 0x10)
      {
        phOsalNfc_MemCopy();
        v17 = 0;
        *(_BYTE *)(a1 + 671) = 1;
        *(_WORD *)(a1 + 212) = v5;
        **(_WORD **)(a1 + 528) = v5;
        *(_BYTE *)(a1 + 74) = 1;
        v18 = (uint64x2_t)vdupq_n_s64(16 - (unint64_t)(unsigned __int16)(v5 + 1));
        v19 = a1 + (unsigned __int16)(v5 + 1);
        do
        {
          v20 = vmovn_s64((int64x2_t)vcgeq_u64(v18, (uint64x2_t)vorrq_s8((int8x16_t)vdupq_n_s64(v17), (int8x16_t)xmmword_21990ADE0)));
          if ((v20.i8[0] & 1) != 0)
          {
            if (v17)
              v21 = 0;
            else
              v21 = -2;
            *(_BYTE *)(v19 + v17 + 266) = v21;
          }
          if ((v20.i8[4] & 1) != 0)
          {
            if (v17 == -1)
              v22 = -2;
            else
              v22 = 0;
            *(_BYTE *)(v19 + v17 + 267) = v22;
          }
          v17 += 2;
        }
        while (((18 - (unsigned __int16)(v5 + 1)) & 0xFFFFFFFFFFFFFFFELL) != v17);
        goto LABEL_38;
      }
      LOWORD(v7) = 16;
    }
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 212) = v7;
    **(_WORD **)(a1 + 528) = 16;
LABEL_38:
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 526) = 17;
    *(_DWORD *)(a1 + 232) = 160;
    *(_WORD *)(a1 + 264) = 260;
    v16 = sub_219888630(a1, (uint64_t)sub_2198C8BA0);
    goto LABEL_39;
  }
  if (*(unsigned __int16 *)(a1 + 668) >= *(unsigned __int8 *)(a1 + 667))
  {
    if (v3 == v2)
      v16 = 0;
    else
      v16 = 255;
  }
  else
  {
    v16 = 0;
    *(_BYTE *)(a1 + 672) = 1;
  }
LABEL_39:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_WrABlock");
  return v16;
}

uint64_t sub_2198C96F8(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  uint64_t v5;
  int v6;
  int v8;
  char v9;
  unint64_t v10;
  unint64_t v11;
  __int16 v12;
  uint64_t i;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iChkNdefComp");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProChkNdef");
  v4 = *(unsigned __int8 *)(a1 + 666);
  if (v4 != 1)
  {
    v6 = *(unsigned __int8 *)(a1 + 544);
    if (v4 == 2 && v6 == 7)
      goto LABEL_10;
    if (v4 == 66)
    {
      if (v6 != 8)
      {
        v5 = 1;
        goto LABEL_23;
      }
LABEL_10:
      sub_2198CCB20(a1);
      v5 = 0;
      *(_WORD *)(a1 + 744) = 1;
      goto LABEL_23;
    }
    v5 = 1;
    if (v4 < 2 || v6 != 8)
      goto LABEL_23;
    sub_2198CCB20(a1);
    if (*(_WORD *)(a1 + 744) == 1)
      goto LABEL_3;
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd4k_H_CheckNdef");
    v8 = *(unsigned __int8 *)(a1 + 666);
    if (v8 == 64)
    {
      v9 = 65;
    }
    else
    {
      if (v8 == 2)
      {
        *(_BYTE *)(a1 + 666) = 64;
        *(_BYTE *)(a1 + 677) = 0;
LABEL_22:
        v5 = sub_2198C8538(*(_QWORD *)(a1 + 2712), *(_QWORD *)(a1 + 8), *(_QWORD *)(a1 + 40));
        sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd4k_H_CheckNdef");
        goto LABEL_23;
      }
      v9 = 66;
    }
    *(_BYTE *)(a1 + 666) = v9;
    goto LABEL_22;
  }
  sub_2198CCB20(a1);
  *(_BYTE *)(a1 + 666) = 2;
  if (*(_WORD *)(a1 + 744) == 1)
  {
LABEL_3:
    v5 = 0;
    goto LABEL_23;
  }
  v5 = sub_2198C8538(*(_QWORD *)(a1 + 2712), *(_QWORD *)(a1 + 8), *(_QWORD *)(a1 + 40));
LABEL_23:
  if (*(_WORD *)(a1 + 744) == 1)
  {
    *(_WORD *)(a1 + 750) = 1;
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkNdefCmpltSects");
    if (*(_BYTE *)(a1 + 544) == 8)
    {
      v10 = 0;
      do
      {
        v11 = v10 + 1;
        if (v10 != 15 && *(_BYTE *)(a1 + 698 + v10) == 1)
        {
          if (v11 >= 0x20)
            v12 = -15;
          else
            v12 = -3;
          *(_WORD *)(a1 + 668) += v12;
        }
        v10 = v11;
      }
      while (v11 != 39);
    }
    else
    {
      for (i = 0; i != 15; ++i)
      {
        if (*(_BYTE *)(a1 + 698 + i) == 1)
          *(_WORD *)(a1 + 668) -= 3;
      }
    }
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkNdefCmpltSects");
    if (*(unsigned __int16 *)(a1 + 668) - 256 >= 0xFFFFFF01)
    {
      *(_DWORD *)(a1 + 744) = 0;
      *(_BYTE *)(a1 + 666) = 4;
      if (sub_2198C8E80(a1))
        v5 = 1;
      else
        v5 = sub_2198C86C0(a1);
    }
    else
    {
      v5 = 22;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProChkNdef");
  *a2 = (_DWORD)v5 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iChkNdefComp");
  return v5;
}

uint64_t sub_2198C99E0(uint64_t a1, BOOL *a2)
{
  uint64_t v4;
  BOOL v5;
  char v7;
  char v8;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRead");
  if (*(_WORD *)(a1 + 264) == 16 && *(unsigned __int16 *)(a1 + 248) > *(unsigned __int16 *)(a1 + 252))
  {
    v7 = 0;
    if (!*(_WORD *)(a1 + 78))
    {
      v4 = 0;
      goto LABEL_7;
    }
    *a2 = 0;
    v4 = sub_2198C9AAC(a1, &v8, &v7);
    v5 = (_DWORD)v4 != 13;
  }
  else
  {
    v4 = 27;
    v5 = 1;
  }
  *a2 = v5;
LABEL_7:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRead");
  return v4;
}

uint64_t sub_2198C9AAC(uint64_t a1, _BYTE *a2, _BYTE *a3)
{
  int v6;
  int v7;
  int v8;
  __int16 v9;
  uint64_t v10;
  int v11;
  BOOL v12;
  int v13;
  BOOL v14;
  char v15;
  uint64_t v16;
  BOOL v17;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RemainTLV");
  if (*(unsigned __int16 *)(a1 + 740) >= (unsigned __int16)(*(_WORD *)(a1 + 248) - *(_WORD *)(a1 + 252)))
    v6 = (unsigned __int16)(*(_WORD *)(a1 + 248) - *(_WORD *)(a1 + 252));
  else
    v6 = *(unsigned __int16 *)(a1 + 740);
  v7 = *(unsigned __int16 *)(a1 + 78);
  v8 = 16 - *a3;
  if (v8 < v7)
  {
    if (v8 < v6)
    {
      *a2 = 0;
      phOsalNfc_MemCopy();
      *(_WORD *)(a1 + 252) = *(_WORD *)(a1 + 252) - *a3 + 16;
      *(_WORD *)(a1 + 740) = *a3 + *(_WORD *)(a1 + 740) - 16;
      *(_WORD *)(a1 + 78) = *a3 + *(_WORD *)(a1 + 78) - 16;
      *a3 = 16;
      if (*(_WORD *)(a1 + 78))
        *(_BYTE *)(a1 + 66) = 0;
      goto LABEL_11;
    }
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 252) += v6;
    *(_WORD *)(a1 + 740) -= v6;
    *(_WORD *)(a1 + 78) -= v6;
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 664) = 16 - *a3 - v6;
    v11 = *a3;
    if (16 - v11 == v6)
    {
      if (*(_WORD *)(a1 + 740))
        v12 = *(_WORD *)(a1 + 78) == 0;
      else
        v12 = 1;
      *(_BYTE *)(a1 + 672) = v12;
      ++*(_BYTE *)(a1 + 666);
      ++*(_BYTE *)(a1 + 667);
      LOBYTE(v11) = *a3;
    }
    *a3 = v11 + v6;
    *(_BYTE *)(a1 + 66) = 0;
    goto LABEL_36;
  }
  if (v6 <= v7)
  {
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 252) += v6;
    *(_WORD *)(a1 + 740) -= v6;
    if (v6 != *(unsigned __int16 *)(a1 + 78))
    {
      phOsalNfc_MemCopy();
      *(_WORD *)(a1 + 664) = 16 - *a3 - v6;
    }
    *a3 += v6;
    v13 = *(unsigned __int16 *)(a1 + 78);
    *(_WORD *)(a1 + 78) = v13 - v6;
    if (!*(_WORD *)(a1 + 664))
    {
      if (*(_WORD *)(a1 + 740))
        v14 = v13 == v6;
      else
        v14 = 1;
      v15 = v14;
      *(_BYTE *)(a1 + 672) = v15;
      ++*(_BYTE *)(a1 + 666);
      ++*(_BYTE *)(a1 + 667);
    }
    if (v13 == v6)
    {
      *(_BYTE *)(a1 + 66) = 1;
      *(_WORD *)(a1 + 72) = 0;
    }
LABEL_36:
    *a2 = 0;
    goto LABEL_37;
  }
  phOsalNfc_MemCopy();
  v9 = *(_WORD *)(a1 + 78);
  *(_WORD *)(a1 + 252) += v9;
  *(_WORD *)(a1 + 740) -= v9;
  *(_BYTE *)(a1 + 66) = 1;
  *a3 += v9;
  *(_WORD *)(a1 + 78) = 0;
  *a2 = 1;
  *(_WORD *)(a1 + 72) = 0;
  if (*(_WORD *)(a1 + 78) == 16)
  {
    *a2 = 0;
    *(_WORD *)(a1 + 78) = 0;
LABEL_11:
    ++*(_BYTE *)(a1 + 666);
    ++*(_BYTE *)(a1 + 667);
    if (sub_2198C8E80(a1))
    {
      v10 = 1;
    }
    else
    {
      if (*(_BYTE *)(a1 + 677) == 1)
        v16 = sub_2198C8FC4(a1);
      else
        v16 = sub_2198C86C0(a1);
      v10 = v16;
    }
    goto LABEL_41;
  }
  *(_WORD *)(a1 + 78) = 0;
LABEL_37:
  **(_DWORD **)(a1 + 552) = *(unsigned __int16 *)(a1 + 252);
  if (*(_WORD *)(a1 + 740))
    v17 = *(_WORD *)(a1 + 78) == 0;
  else
    v17 = 1;
  v10 = 0;
  *(_BYTE *)(a1 + 672) = v17;
LABEL_41:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RemainTLV");
  return v10;
}

uint64_t sub_2198C9E5C(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  int v5;
  int v6;
  int v7;
  BOOL *v8;
  int v9;
  uint64_t v10;
  int v11;
  int v12;
  BOOL v13;
  BOOL v14;
  uint64_t v15;
  int v17;
  unsigned __int16 v18;
  int v19;
  __int16 v20;
  BOOL v21;
  uint64_t v22;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iWrite");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProWrABlock");
  *(_WORD *)(a1 + 754) = 0;
  v4 = *(unsigned __int16 *)(a1 + 252);
  v5 = *(_DWORD *)(a1 + 248);
  if (v4 >= (unsigned __int16)v5)
  {
    v10 = 245;
    goto LABEL_14;
  }
  if (*(_BYTE *)(a1 + 671) == 1)
  {
    *(_WORD *)(a1 + 664) = **(_WORD **)(a1 + 528);
    phOsalNfc_MemCopy();
    v6 = *(unsigned __int16 *)(a1 + 212);
    *(_WORD *)(a1 + 252) += v6;
    v7 = *(unsigned __int16 *)(a1 + 740);
    *(_BYTE *)(a1 + 671) = 0;
    v8 = (BOOL *)(a1 + 74);
    v9 = v7 - v6;
    *(_WORD *)(a1 + 740) = v9;
    *(_BYTE *)(a1 + 672) = v9 == 0;
    if (!v9)
    {
LABEL_4:
      *v8 = 1;
LABEL_12:
      *(_BYTE *)(a1 + 752) = *(_BYTE *)(a1 + 666);
      sub_2198CC4D0(a1);
      *(_BYTE *)(a1 + 666) = *(_BYTE *)(a1 + 70);
      v15 = sub_2198CC550(a1);
LABEL_13:
      v10 = v15;
      goto LABEL_14;
    }
    goto LABEL_10;
  }
  if (*(_BYTE *)(a1 + 670) == 1)
  {
    phOsalNfc_MemCopy();
    v11 = *(unsigned __int16 *)(a1 + 212);
    v12 = *(unsigned __int16 *)(a1 + 740);
    v13 = v12 == v11;
    if (**(_WORD **)(a1 + 528))
      v13 = 0;
    *(_WORD *)(a1 + 664) = **(_WORD **)(a1 + 528);
    *(_WORD *)(a1 + 252) += v11;
    *(_BYTE *)(a1 + 670) = 0;
    *(_BYTE *)(a1 + 672) = v13;
    v8 = (BOOL *)(a1 + 74);
    LOWORD(v9) = v12 - v11;
    *(_WORD *)(a1 + 740) = v12 - v11;
    if (v12 == v11)
      goto LABEL_4;
LABEL_10:
    v14 = *v8;
    *v8 = v14;
    if (v14)
      goto LABEL_12;
    goto LABEL_35;
  }
  *(_WORD *)(a1 + 664) = 0;
  v17 = *(unsigned __int16 *)(a1 + 212);
  v18 = v17 + v4;
  *(_WORD *)(a1 + 252) = v17 + v4;
  v19 = *(unsigned __int16 *)(a1 + 740);
  v20 = v19 - v17;
  *(_WORD *)(a1 + 740) = v19 - v17;
  if (v19 == v17 || v5 == v18)
  {
    ++*(_BYTE *)(a1 + 666);
    *(_BYTE *)(a1 + 672) = v19 == v17;
    if (v19 == v17)
    {
      v10 = 0;
    }
    else
    {
      v10 = sub_2198C8E80(a1);
      v20 = *(_WORD *)(a1 + 740);
    }
    ++*(_BYTE *)(a1 + 667);
    if (v20)
      v21 = *(_BYTE *)(a1 + 74) == 1;
    else
      v21 = 1;
    *(_BYTE *)(a1 + 74) = v21;
    if ((_DWORD)v10)
      goto LABEL_14;
  }
  else
  {
    ++*(_BYTE *)(a1 + 666);
    *(_WORD *)(a1 + 754) = v5 - v18;
    if (sub_2198C8E80(a1))
    {
      v10 = 1;
      goto LABEL_14;
    }
    ++*(_BYTE *)(a1 + 667);
    if (*(_BYTE *)(a1 + 677) == 1)
      v22 = sub_2198C93F4(a1);
    else
      v22 = sub_2198C86C0(a1);
    v10 = v22;
    if ((_DWORD)v22)
      goto LABEL_14;
  }
  if (*(_BYTE *)(a1 + 74) == 1)
    goto LABEL_12;
  LOWORD(v9) = *(_WORD *)(a1 + 740);
LABEL_35:
  if ((_WORD)v9)
  {
    v15 = sub_2198CD588(a1);
    goto LABEL_13;
  }
  v10 = 0;
LABEL_14:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProWrABlock");
  *a2 = (_DWORD)v10 != 13;
  if ((_DWORD)v10 != 13)
    **(_DWORD **)(a1 + 256) = *(unsigned __int16 *)(a1 + 252);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iWrite");
  return v10;
}

uint64_t sub_2198CA150(uint64_t a1, BOOL *a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iAuth");
  *(_BYTE *)(a1 + 758) = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProAuth");
  if (*(_BYTE *)(a1 + 71) == 1)
  {
    *(_BYTE *)(a1 + 71) = 0;
    *(_BYTE *)(a1 + 677) = 1;
    v4 = sub_2198CC550(a1);
  }
  else
  {
    *(_BYTE *)(a1 + 677) = 1;
    *(_BYTE *)(a1 + 679) = 1;
    v4 = sub_2198CCDA0(a1);
  }
  v5 = v4;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProAuth");
  *a2 = (_DWORD)v5 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iAuth");
  return v5;
}

uint64_t sub_2198CA234(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  uint64_t v5;
  int v6;
  __int16 v7;
  __int16 v8;
  __int16 v9;
  unsigned int v10;
  _BOOL4 v11;
  unsigned int v12;
  uint64_t v13;
  int v14;
  char v15;
  char v16;
  char v17;
  unint64_t v19;
  uint64_t v20;
  uint64_t v21;

  v21 = *MEMORY[0x24BDAC8D0];
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRdACSBit");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProAcsBits");
  if (*(_WORD *)(a1 + 264) != 16)
  {
    v5 = 1;
    goto LABEL_86;
  }
  if (*(_BYTE *)(a1 + 679) != 1)
  {
    *(_BYTE *)(a1 + 739) = 0;
    v5 = sub_2198CB700(a1, (BOOL *)&v19);
    goto LABEL_86;
  }
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkAcsBit");
  v4 = *(unsigned __int8 *)(a1 + 666);
  if (v4 < 4 || v4 - 64 <= 2)
  {
    v5 = 0;
    *(_BYTE *)(a1 + 545) = 0;
    goto LABEL_6;
  }
  v14 = *(unsigned __int8 *)(a1 + 272);
  if (v14 == 7)
  {
    if (*(unsigned __int8 *)(a1 + 273) == 143 && *(_BYTE *)(a1 + 274) == 15)
    {
      v15 = 0;
      goto LABEL_67;
    }
LABEL_68:
    v15 = 0;
    v16 = 0;
    goto LABEL_69;
  }
  if (v14 != 127 || *(_BYTE *)(a1 + 273) != 7 || *(unsigned __int8 *)(a1 + 274) != 136)
    goto LABEL_68;
  v15 = 1;
LABEL_67:
  v16 = 1;
LABEL_69:
  *(_BYTE *)(a1 + 674) = v15;
  *(_BYTE *)(a1 + 675) = v16;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_GPBChk");
  v5 = sub_21988B8FC(a1, 9u);
  if (!(_DWORD)v5)
  {
    if ((*(_BYTE *)(a1 + 275) & 0xF) != 0)
    {
      if ((*(_BYTE *)(a1 + 275) & 3) == 0 || (*(_BYTE *)(a1 + 275) & 0xC) != 0)
        v17 = 3;
      else
        v17 = 1;
    }
    else if (*(_BYTE *)(a1 + 739) == 1 || *(_BYTE *)(a1 + 738) == 1)
    {
      v17 = 0;
    }
    else
    {
      v17 = 2 * (*(_BYTE *)(a1 + 737) != 1);
    }
    *(_BYTE *)(a1 + 545) = v17;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_GPBChk");
LABEL_6:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkAcsBit");
  if (!(_DWORD)v5 && *(_BYTE *)(a1 + 739) == 1)
  {
    v6 = *(char *)(a1 + 666);
    if (*(_BYTE *)(a1 + 545) == 3)
    {
      v7 = v6 >= 0 ? -3 : -15;
      *(_WORD *)(a1 + 668) += v7;
      v8 = *(_WORD *)(a1 + 746) == 1 ? 1 : 2;
      *(_WORD *)(a1 + 748) = v8;
      v5 = sub_2198CC834(a1);
    }
    else
    {
      v9 = v6 == 64 && *(_BYTE *)(a1 + 544) == 8 ? *(_WORD *)(a1 + 746) : 1;
      v5 = 0;
      *(_WORD *)(a1 + 746) = v9;
    }
    if (*(_WORD *)(a1 + 748) != 1)
    {
      *(_BYTE *)(a1 + 679) = 0;
      v10 = *(unsigned __int8 *)(a1 + 666);
      v11 = v10 >= 0x3B && *(_BYTE *)(a1 + 544) == 7 && !*(_BYTE *)(a1 + 673) || *(unsigned __int8 *)(a1 + 673) == 1;
      if (v10 >= 0xFA && *(_BYTE *)(a1 + 544) == 8 && !v11)
      {
        *(_BYTE *)(a1 + 673) = 1;
        *(_BYTE *)(a1 + 666) = 4;
LABEL_35:
        v5 = sub_2198C8E80(a1);
        goto LABEL_36;
      }
      *(_BYTE *)(a1 + 673) = v11;
      if (v11)
        LOBYTE(v10) = 4;
      *(_BYTE *)(a1 + 666) = v10;
      if (v11)
        goto LABEL_35;
    }
  }
LABEL_36:
  if (!(_DWORD)v5)
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkRdWr");
    v5 = 1;
    switch(*(_BYTE *)(a1 + 540))
    {
      case 1:
        if (*(_BYTE *)(a1 + 545) == 3)
          goto LABEL_58;
        v12 = *(unsigned __int8 *)(a1 + 666);
        if (v12 >= 4 && v12 - 65 >= 2 && *(_WORD *)(a1 + 750) == 1)
        {
          if (*(_BYTE *)(a1 + 679))
            v13 = sub_2198C86C0(a1);
          else
            v13 = sub_2198CCDA0(a1);
        }
        else
        {
          v13 = sub_2198C8538(*(_QWORD *)(a1 + 2712), *(_QWORD *)(a1 + 8), *(_QWORD *)(a1 + 40));
        }
        goto LABEL_75;
      case 2:
        if (*(_BYTE *)(a1 + 545) == 3)
          goto LABEL_58;
        if (*(_BYTE *)(a1 + 738) == 1)
          goto LABEL_57;
        v13 = sub_2198C8FC4(a1);
        goto LABEL_75;
      case 3:
        if ((*(unsigned __int8 *)(a1 + 545) | 2) == 3)
          goto LABEL_63;
        if (*(_BYTE *)(a1 + 737) == 1)
        {
LABEL_57:
          v13 = sub_2198CCEDC(a1);
        }
        else
        {
          if (*(_BYTE *)(a1 + 676) == 1)
          {
LABEL_52:
            v13 = sub_2198C9374(a1);
            goto LABEL_75;
          }
          if (*(_BYTE *)(a1 + 756) == 1)
          {
            v13 = sub_2198CC550(a1);
          }
          else
          {
            if (*(unsigned __int8 *)(a1 + 70) == *(unsigned __int8 *)(a1 + 666) && *(_BYTE *)(a1 + 560) == 1)
              goto LABEL_52;
            v13 = sub_2198C93F4(a1);
          }
        }
LABEL_75:
        v5 = v13;
LABEL_85:
        sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkRdWr");
        break;
      case 4:
        if (*(_BYTE *)(a1 + 675))
          goto LABEL_57;
LABEL_58:
        v5 = 20;
        goto LABEL_85;
      case 6:
        if (*(_BYTE *)(a1 + 545) == 2)
        {
          *(_BYTE *)a1 = 13;
          v19 = 0;
          v20 = 0;
          sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProWrACSbitsRdOnly");
          if (*(_WORD *)(a1 + 264) == 16)
          {
            phOsalNfc_MemCopy();
            v19 = 0x8F07F7D3F7D3F7D3;
            LOBYTE(v20) = 15;
            BYTE1(v20) |= 3u;
            phOsalNfc_MemCopy();
            if (*(char *)(a1 + 666) < 0)
              sub_2198CA858(a1);
            else
              sub_2198CA948(a1);
            phOsalNfc_MemCopy();
            *(_BYTE *)a1 = 13;
            v5 = sub_2198CA9C0(a1);
          }
          else
          {
            v5 = 255;
          }
          sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProWrACSbitsRdOnly");
        }
        else
        {
LABEL_63:
          v5 = 21;
        }
        goto LABEL_85;
      default:
        goto LABEL_85;
    }
  }
LABEL_86:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProAcsBits");
  *a2 = (_DWORD)v5 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRdACSBit");
  return v5;
}

uint64_t sub_2198CA858(uint64_t a1)
{
  char v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Get4kStTrail");
  v2 = *(_BYTE *)(a1 + 666);
  switch(v2 & 0xF)
  {
    case 0:
      v2 += 15;
      break;
    case 1:
      v2 += 14;
      break;
    case 2:
      v2 += 13;
      break;
    case 3:
      v2 += 12;
      break;
    case 4:
      v2 += 11;
      break;
    case 5:
      v2 += 10;
      break;
    case 6:
      v2 += 9;
      break;
    case 7:
      v2 += 8;
      break;
    case 8:
      v2 += 7;
      break;
    case 9:
      v2 += 6;
      break;
    case 0xA:
      v2 += 5;
      break;
    case 0xB:
      v2 += 4;
      break;
    case 0xC:
      v2 += 3;
      break;
    case 0xD:
      v2 += 2;
      break;
    case 0xE:
      ++v2;
      break;
    default:
      break;
  }
  *(_BYTE *)(a1 + 266) = v2;
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Get4kStTrail");
}

uint64_t sub_2198CA948(uint64_t a1)
{
  char v2;
  int v3;
  char v4;
  char v5;
  char v6;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Get1kStTrail");
  v2 = *(_BYTE *)(a1 + 666);
  v3 = v2 & 3;
  v4 = v2 + 2;
  v5 = v2 + 3;
  if ((v2 & 3) != 0)
    v5 = *(_BYTE *)(a1 + 666);
  if (v3 != 1)
    v4 = v5;
  if (v3 == 2)
    v6 = v2 + 1;
  else
    v6 = v4;
  *(_BYTE *)(a1 + 266) = v6;
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Get1kStTrail");
}

uint64_t sub_2198CA9C0(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_WrTLV");
  *(_BYTE *)(a1 + 204) &= 0xFCu;
  *(_BYTE *)(a1 + 208) = 0;
  *(_QWORD *)(a1 + 48) = sub_2198C8800;
  *(_QWORD *)(a1 + 56) = a1;
  *(_WORD *)(a1 + 526) = 17;
  *(_DWORD *)(a1 + 232) = 160;
  *(_WORD *)(a1 + 264) = 260;
  v2 = sub_219888630(a1, (uint64_t)sub_2198C8BA0);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_WrTLV");
  return v2;
}

uint64_t sub_2198CAA68(uint64_t a1, _BYTE *a2)
{
  int v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iWrACSBit");
  v4 = *(unsigned __int8 *)(a1 + 545);
  if (v4 == 2)
    LOBYTE(v4) = 1;
  *(_BYTE *)(a1 + 545) = v4;
  *a2 = 1;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iWrACSBit");
  return 0;
}

uint64_t sub_2198CAAE4(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  char v5;
  unsigned int v6;
  int v7;
  BOOL v8;
  int v9;
  uint64_t v10;
  char v11;
  BOOL v12;
  char v13;
  unsigned int v14;
  int v15;
  int v16;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iWrNdefLen");
  if (*(_BYTE *)(a1 + 756) == 1)
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_CallWrNdefLen");
    v4 = *(unsigned __int16 *)(a1 + 68);
    if (*(unsigned __int16 *)(a1 + 84) < 2u)
    {
      if (v4 - 13 > 2)
        goto LABEL_27;
      v13 = *(_BYTE *)(a1 + 666) + 1;
    }
    else
    {
      v5 = *(_BYTE *)(a1 + 666);
      if (v4 <= 1)
      {
        *(_BYTE *)(a1 + 666) = v5 - 1;
        sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_BlkChk_1");
        v6 = sub_2198CCC80((unsigned int *)a1, *(unsigned __int8 *)(a1 + 666));
        if (*(_BYTE *)(a1 + v6 + 697)
          || ((v7 = *(unsigned __int8 *)(a1 + 544), v7 == 7) ? (v8 = v6 >= 0x10) : (v8 = 1), v8 && v7 != 8))
        {
          v9 = 1;
        }
        else
        {
          v9 = 0;
          v14 = *(unsigned __int8 *)(a1 + 666);
          if (v14 >= 0x81)
            v15 = 15;
          else
            v15 = 3;
          v16 = (v14 + 1) & v15;
          *(_BYTE *)(a1 + 71) = v16 == 0;
          *(_BYTE *)(a1 + 666) = v14 - (v16 == v14 < 0x81);
        }
        sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_BlkChk_1");
        if (!v9)
          goto LABEL_27;
LABEL_21:
        v10 = 1;
LABEL_28:
        sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_CallWrNdefLen");
        v12 = (_DWORD)v10 != 13;
        goto LABEL_29;
      }
      v13 = v5 + 1;
    }
    *(_BYTE *)(a1 + 666) = v13;
    if (sub_2198C8E80(a1))
      goto LABEL_21;
LABEL_27:
    v10 = sub_2198CC550(a1);
    goto LABEL_28;
  }
  if (*(unsigned __int8 *)(a1 + 752) == *(unsigned __int8 *)(a1 + 666))
    phOsalNfc_MemCopy();
  v10 = 0;
  **(_DWORD **)(a1 + 256) = *(unsigned __int16 *)(a1 + 252);
  *(_BYTE *)(a1 + 666) = *(_BYTE *)(a1 + 752);
  v11 = *(_BYTE *)(a1 + 545);
  if (!v11)
    v11 = 2;
  *(_BYTE *)(a1 + 545) = v11;
  v12 = 1;
LABEL_29:
  *a2 = v12;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iWrNdefLen");
  return v10;
}

uint64_t sub_2198CAD08(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  __int16 v5;
  unsigned __int8 v6;
  unsigned int v7;
  uint64_t v8;
  unsigned __int16 v9;
  int v10;
  int v11;
  int v12;
  _BYTE *v13;
  _BYTE *v14;
  unsigned __int8 v15;
  const char *v16;
  unsigned int v17;
  unsigned int v18;
  unsigned int v19;
  uint64_t v20;
  _BYTE *v21;
  unsigned int v22;
  _BYTE *v23;
  unsigned int v24;
  _BYTE *v25;
  _BYTE *v26;
  uint64_t v27;
  uint64_t v28;
  uint64_t v29;
  char v30;
  char v31;
  char v32;
  uint64_t v33;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRdToWrNdefLen");
  *a2 = 1;
  if (*(_WORD *)(a1 + 264) == 16)
  {
    *(_OWORD *)(a1 + 267) = *(_OWORD *)(a1 + 266);
    *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 666);
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_WriteNdefLen");
    *(_BYTE *)a1 = 6;
    v4 = *(unsigned __int16 *)(a1 + 84);
    if (*(unsigned __int8 *)(a1 + 666) != *(unsigned __int8 *)(a1 + 70))
    {
      if (v4 < 2)
      {
        sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillTLV2_1");
        v10 = *(unsigned __int16 *)(a1 + 68);
        if (v10 == 14)
        {
          v17 = *(unsigned __int16 *)(a1 + 76);
          if (v17 < 0xFF)
          {
            *(_WORD *)(a1 + 84) = 2;
            *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
            *(_WORD *)(a1 + 68) = 0;
            LOBYTE(v18) = 3;
          }
          else
          {
            v18 = v17 >> 8;
          }
          *(_BYTE *)(a1 + 267) = v18;
          *(_BYTE *)(a1 + 268) = v17;
        }
        else if (v10 == 13)
        {
          *(_BYTE *)(a1 + 267) = *(_BYTE *)(a1 + 76);
        }
        else
        {
          v19 = *(unsigned __int16 *)(a1 + 76);
          if (v19 < 0xFF)
          {
            *(_WORD *)(a1 + 267) = 768;
            *(_WORD *)(a1 + 84) = 2;
            *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
            *(_WORD *)(a1 + 68) = 1;
          }
          else
          {
            *(_BYTE *)(a1 + 267) = -1;
            *(_BYTE *)(a1 + 268) = BYTE1(v19);
          }
          *(_BYTE *)(a1 + 269) = v19;
        }
        *(_BYTE *)(a1 + 756) = 0;
        v16 = "phFriNfc_MifStd_H_fillTLV2_1";
      }
      else
      {
        sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillTLV1_1");
        if (*(_WORD *)(a1 + 68) == 1)
        {
          *(_WORD *)(a1 + 84) = 0;
          *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
          *(_WORD *)(a1 + 68) = 15;
          *(_BYTE *)(a1 + 282) = 3;
        }
        else if (*(_WORD *)(a1 + 68))
        {
          *(_BYTE *)(a1 + 267) = *(_BYTE *)(a1 + 76);
        }
        else
        {
          *(_WORD *)(a1 + 84) = 0;
          *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
          *(_WORD *)(a1 + 68) = 14;
          *(_WORD *)(a1 + 281) = -253;
        }
        *(_BYTE *)(a1 + 756) = 0;
        v16 = "phFriNfc_MifStd_H_fillTLV1_1";
      }
      goto LABEL_64;
    }
    v5 = *(_WORD *)(a1 + 68);
    v6 = v5 + 1;
    if (v4 < 2)
    {
      sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillTLV2");
      if (*(_BYTE *)(a1 + 560))
        v9 = *(_WORD *)(a1 + 252);
      else
        v9 = *(_WORD *)(a1 + 252) + *(_WORD *)(a1 + 76);
      *(_WORD *)(a1 + 76) = v9;
      *(_BYTE *)(a1 + 756) = 1;
      v12 = *(unsigned __int16 *)(a1 + 68);
      switch(v12)
      {
        case 15:
          v22 = v9;
          v23 = (_BYTE *)(a1 + v6 + 266);
          if (v22 < 0xFF)
            *v23 = 0;
          else
            *v23 = 3;
          break;
        case 14:
          v24 = v9;
          v25 = (_BYTE *)(a1 + 266 + v6);
          v26 = (_BYTE *)(a1 + 266 + (v5 + 2));
          if (v24 < 0xFF)
          {
            *v25 = 0;
            *v26 = 0;
          }
          else
          {
            *v25 = 3;
            *v26 = -1;
          }
          break;
        case 13:
          v13 = (_BYTE *)(a1 + 266 + v6);
          v14 = (_BYTE *)(a1 + 266 + (v5 + 2));
          v15 = v5 + 3;
          if (v9 < 0xFFu)
          {
            *v13 = 0;
            *v14 = 0;
            *(_WORD *)(a1 + 84) = 2;
            *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
            *(_WORD *)(a1 + 68) = (v5 + 3) - 1;
            *(_BYTE *)(a1 + v15 + 266) = 3;
          }
          else
          {
            *v13 = 3;
            *v14 = -1;
            *(_BYTE *)(a1 + v15 + 266) = HIBYTE(v9);
          }
          break;
        default:
          if (v9 < 0xFFu)
          {
            v32 = 0;
            v31 = 0;
            *(_WORD *)(a1 + 84) = 2;
            *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
            *(_WORD *)(a1 + 68) = (v5 + 3) - 1;
            v30 = 3;
          }
          else
          {
            v30 = HIBYTE(v9);
            v31 = -1;
            v32 = 3;
          }
          *(_BYTE *)(a1 + 266 + v6) = v32;
          *(_BYTE *)(a1 + 266 + (v5 + 2)) = v31;
          v33 = a1 + 266;
          *(_BYTE *)(v33 + (v5 + 3)) = v30;
          *(_BYTE *)(v33 + (v5 + 4)) = v9;
          *(_BYTE *)(a1 + 756) = 0;
          break;
      }
      v16 = "phFriNfc_MifStd_H_fillTLV2";
      goto LABEL_64;
    }
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillTLV1");
    if (*(_BYTE *)(a1 + 560))
      v7 = *(unsigned __int16 *)(a1 + 252);
    else
      v7 = *(unsigned __int16 *)(a1 + 252) + *(unsigned __int16 *)(a1 + 76);
    *(_WORD *)(a1 + 76) = v7;
    *(_BYTE *)(a1 + 756) = 1;
    v11 = *(unsigned __int16 *)(a1 + 68);
    if (v11 == 15)
    {
      if ((unsigned __int16)v7 < 0xFFu)
      {
        *(_BYTE *)(a1 + v6 + 266) = 3;
      }
      else
      {
        *(_WORD *)(a1 + 84) = 0;
        *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
        *(_WORD *)(a1 + 68) = (v5 + 1) - 3;
        v20 = a1 + v6;
        *(_WORD *)(v20 + 264) = -253;
        *(_BYTE *)(v20 + 266) = BYTE1(v7);
      }
      goto LABEL_60;
    }
    if (v11 == 1)
    {
      if ((unsigned __int16)v7 >= 0xFFu)
      {
        v21 = (_BYTE *)(a1 + 266 + v6);
        *(v21 - 1) = -1;
        *v21 = BYTE1(v7);
        *(_BYTE *)(a1 + 266 + (v5 + 1) + 1) = v7;
        goto LABEL_60;
      }
    }
    else
    {
      if (*(_WORD *)(a1 + 68))
      {
        if ((unsigned __int16)v7 < 0xFFu)
        {
          *(_BYTE *)(a1 + v6 + 266) = 3;
          v29 = (v5 + 1) + 1;
        }
        else
        {
          *(_WORD *)(a1 + 84) = 0;
          *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
          *(_WORD *)(a1 + 68) = (v5 + 1) - 3;
          v28 = a1 + v6;
          *(_WORD *)(v28 + 264) = -253;
          *(_BYTE *)(v28 + 266) = BYTE1(v7);
          v29 = (v5 + 1) + 1;
        }
        *(_BYTE *)(a1 + v29 + 266) = v7;
        goto LABEL_59;
      }
      if ((unsigned __int16)v7 >= 0xFFu)
      {
        *(_WORD *)(a1 + v6 + 266) = bswap32(v7) >> 16;
LABEL_60:
        v16 = "phFriNfc_MifStd_H_fillTLV1";
LABEL_64:
        sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)v16);
        phOsalNfc_MemCopy();
        *(_WORD *)(a1 + 526) = 17;
        *(_DWORD *)(a1 + 232) = 160;
        *(_WORD *)(a1 + 264) = 260;
        v8 = sub_219888630(a1, (uint64_t)sub_2198C8BA0);
        sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_WriteNdefLen");
        *a2 = (_DWORD)v8 != 13;
        goto LABEL_65;
      }
    }
    v27 = a1 + v6;
    *(_BYTE *)(v27 + 266) = 3;
    *(_BYTE *)(v27 + 267) = v7;
LABEL_59:
    *(_BYTE *)(a1 + 756) = 0;
    goto LABEL_60;
  }
  v8 = 245;
LABEL_65:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRdToWrNdefLen");
  return v8;
}

uint64_t sub_2198CB2FC(uint64_t a1, BOOL *a2)
{
  int v4;
  _BOOL4 v5;
  _BYTE *v6;
  uint64_t v7;
  __int16 v8;
  unsigned __int8 *v9;
  int v10;
  unsigned __int16 v11;
  unsigned int v12;
  unsigned __int16 v13;
  unsigned __int16 v15;
  unint64_t v16;
  uint64_t v17;
  char v19;
  unsigned __int16 v20;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iGetACTCardSize");
  if (*(_BYTE *)(a1 + 75))
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkRemainTLVs");
    v4 = *(unsigned __int8 *)(a1 + 75);
    switch(v4)
    {
      case 1:
        v8 = *(_WORD *)(a1 + 76);
        v9 = (unsigned __int8 *)(a1 + 266);
        break;
      case 2:
        LOBYTE(v8) = *(_BYTE *)(a1 + 266);
        v9 = (unsigned __int8 *)(a1 + 267);
        break;
      case 3:
        v5 = *(_BYTE *)(a1 + 66) != 1 || sub_21988B840(a1, *(unsigned __int8 *)(a1 + 266)) == 0;
        v12 = *(unsigned __int8 *)(a1 + 266);
        if (v12 != 255 && v5)
        {
          v13 = *(_WORD *)(a1 + 740) - 2;
          *(_WORD *)(a1 + 740) = v13;
          v19 = 0;
          if (*(_BYTE *)(a1 + 66) == 1 && v12 <= v13)
          {
            v7 = 0;
LABEL_35:
            *(_WORD *)(a1 + 78) = v12;
LABEL_36:
            *a2 = 1;
            goto LABEL_46;
          }
          if (v12 <= v13)
          {
            v20 = 1;
            v7 = sub_2198CD3E0(a1, &v20, &v19);
            v16 = v20;
            *(_WORD *)(a1 + 740) -= *(unsigned __int8 *)(a1 + v20 + 266);
            if (v16 < 0x10 || *a2)
              goto LABEL_46;
            goto LABEL_43;
          }
LABEL_45:
          v7 = 28;
          goto LABEL_46;
        }
        if (v12 != 255 || !v5)
          goto LABEL_44;
        v15 = *(_WORD *)(a1 + 740) - 4;
        *(_WORD *)(a1 + 740) = v15;
        v19 = 0;
        v12 = *(unsigned __int8 *)(a1 + 268) | (*(unsigned __int8 *)(a1 + 267) << 8);
        if (*(_BYTE *)(a1 + 66) == 1 && v12 <= v15)
        {
          v7 = 0;
          *(_WORD *)(a1 + 84) = 0;
          goto LABEL_35;
        }
        if (v12 > v15)
        {
LABEL_44:
          *a2 = 1;
          goto LABEL_45;
        }
        v20 = 2;
        sub_2198CD3E0(a1, &v20, &v19);
        *(_WORD *)(a1 + 740) -= bswap32(*(unsigned __int16 *)(a1 + v20 + 266)) >> 16;
LABEL_43:
        v7 = sub_2198CCEDC(a1);
        goto LABEL_46;
      default:
        v7 = 0;
        goto LABEL_46;
    }
    v10 = *v9 | (v8 << 8);
    if (16 * (*(unsigned __int16 *)(a1 + 668) - *(unsigned __int8 *)(a1 + 667)) + 16 >= v10)
    {
      v11 = *(_WORD *)(a1 + 740) - 2;
      *(_WORD *)(a1 + 740) = v11;
      if (*(_BYTE *)(a1 + 66) == 1)
      {
        *(_WORD *)(a1 + 78) = v10;
        if (v10 <= v11)
          v7 = 0;
        else
          v7 = 28;
        goto LABEL_36;
      }
      *(_WORD *)(a1 + 740) = v11 - v10;
      *a2 = 0;
      v20 = 2;
      v19 = 1;
      if (*(_BYTE *)(a1 + 66) != 1)
        sub_2198CD3E0(a1, &v20, &v19);
      goto LABEL_43;
    }
    v7 = 1;
    *a2 = 1;
LABEL_46:
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkRemainTLVs");
    *(_BYTE *)(a1 + 75) = 0;
    goto LABEL_47;
  }
  if (*a2)
  {
    v6 = (_BYTE *)(a1 + 738);
    if (*(_BYTE *)(a1 + 738) == 1)
      goto LABEL_50;
    v7 = 0;
LABEL_48:
    if (*(_BYTE *)(a1 + 737) != 1)
      goto LABEL_57;
    goto LABEL_49;
  }
  v7 = sub_2198CB700(a1, a2);
LABEL_47:
  v6 = (_BYTE *)(a1 + 738);
  if (*(_BYTE *)(a1 + 738) != 1)
    goto LABEL_48;
LABEL_49:
  if ((_DWORD)v7 != 13)
  {
LABEL_50:
    *(_WORD *)(a1 + 746) = 1;
    *a2 = 0;
    if (*(_BYTE *)(a1 + 677))
    {
      if (*v6 == 1)
      {
        sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdTLV");
        *(_BYTE *)a1 = 11;
        *(_BYTE *)(a1 + 540) = 2;
        v7 = sub_2198CCE3C(a1, *(_BYTE *)(a1 + 666));
        sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdTLV");
LABEL_56:
        *(_WORD *)(a1 + 737) = 0;
        goto LABEL_57;
      }
      v17 = sub_2198C9374(a1);
    }
    else
    {
      v17 = sub_2198C86C0(a1);
    }
    v7 = v17;
    goto LABEL_56;
  }
LABEL_57:
  if (*(_BYTE *)(a1 + 739) == 1 || *(_WORD *)(a1 + 750) == 1)
    *a2 = (_DWORD)v7 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iGetACTCardSize");
  return v7;
}

uint64_t sub_2198CB700(uint64_t a1, BOOL *a2)
{
  int v4;
  int v5;
  __int16 v6;
  uint64_t v7;
  int v8;
  unsigned __int16 v9;
  uint64_t v10;
  int v11;
  unsigned __int16 v12;
  int v13;
  uint64_t v14;
  int v15;
  _BYTE *v16;
  int v17;
  int v18;
  __int16 v19;
  int v20;
  int v21;
  BOOL v22;
  uint64_t v23;
  int v25;
  unsigned __int16 v26;
  int v27;
  __int16 v28;
  int v29;
  uint64_t v30;
  char v31;
  unsigned __int16 v32;

  v31 = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkTLVs");
  *(_BYTE *)(a1 + 540) = 4;
  v4 = *(unsigned __int16 *)(a1 + 68);
  while (1)
  {
LABEL_2:
    while (1)
    {
      v5 = *(unsigned __int8 *)(a1 + (unsigned __int16)v4 + 266);
      while (v5 == 254)
      {
        if (*(_BYTE *)(a1 + 66) == 1)
        {
          v32 = ++v4;
          --*(_WORD *)(a1 + 740);
          goto LABEL_2;
        }
        if (!*(_BYTE *)(a1 + 66))
        {
          v23 = 1;
          *(_BYTE *)(a1 + 672) = 1;
          goto LABEL_42;
        }
      }
      if (*(_BYTE *)(a1 + (unsigned __int16)v4 + 266))
        break;
      v32 = ++v4;
      v6 = *(_WORD *)(a1 + 84) + 1;
      *(_WORD *)(a1 + 84) = v6;
      *(_WORD *)(a1 + 86) = v6;
      v7 = a1 + (unsigned __int16)v4;
      v8 = *(unsigned __int8 *)(v7 + 265);
      v9 = *(_WORD *)(a1 + 740) - 1;
      *(_WORD *)(a1 + 740) = v9;
      if ((*(unsigned __int8 *)(v7 + 266) | (v8 << 8)) > v9)
        goto LABEL_55;
      v10 = sub_2198CD334(a1, (unsigned __int16)v4);
      if ((_DWORD)v10)
      {
        v23 = v10;
        *(_WORD *)(a1 + 68) = 0;
        goto LABEL_42;
      }
    }
    if (v5 == 3)
    {
      *(_BYTE *)(a1 + 70) = *(_BYTE *)(a1 + 666);
      *(_WORD *)(a1 + 68) = v4;
      *(_BYTE *)(a1 + 66) = 1;
      v11 = *(unsigned __int16 *)(a1 + 84);
      if (v11 == 1)
        LOWORD(v11) = 0;
    }
    else
    {
      if (!*(_BYTE *)(a1 + 66))
      {
        *(_WORD *)(a1 + 78) = 0;
        *(_BYTE *)(a1 + 545) = 3;
        *a2 = 1;
        v23 = 22;
        goto LABEL_42;
      }
      LOWORD(v11) = 0;
    }
    *(_WORD *)(a1 + 84) = v11;
    v12 = v4 + 1;
    v13 = (unsigned __int16)(v4 + 1);
    v32 = v4 + 1;
    if (v13 == 16)
    {
      *(_BYTE *)(a1 + 72) = 1;
      *(_BYTE *)(a1 + 75) = 3;
    }
    v14 = sub_2198CD334(a1, v13);
    if ((_DWORD)v14)
      goto LABEL_40;
    v15 = 16 * (*(unsigned __int16 *)(a1 + 668) - *(unsigned __int8 *)(a1 + 667)) - v12 + 16;
    v16 = (_BYTE *)(a1 + v12 + 266);
    v17 = *v16;
    v18 = *(unsigned __int8 *)(a1 + 66);
    if (v17 == 255 || v15 >= v17)
    {
      if (!*v16 && v15 < 0)
      {
        if (v18 == 1)
          goto LABEL_47;
        goto LABEL_33;
      }
    }
    else if (v18 != 1 || !*v16 && v15 < 0)
    {
      goto LABEL_47;
    }
    if (v17 != 255 && v18 == 1)
    {
      v23 = sub_21988B840(a1, v17);
      *(_WORD *)(a1 + 78) = *v16;
      *(_WORD *)(a1 + 740) -= 2;
      *(_BYTE *)(a1 + 742) = *(unsigned __int16 *)(a1 + 84) < 2u;
      goto LABEL_57;
    }
LABEL_33:
    v19 = v17 + 2;
    if (v17 == 255)
      v19 = 0;
    *(_WORD *)(a1 + 740) -= v19;
    v20 = *v16;
    if (!*v16)
    {
LABEL_47:
      v23 = 1;
      *a2 = 1;
      goto LABEL_42;
    }
    v31 = 0;
    if (v20 == 255)
      break;
    v21 = sub_2198CD3E0(a1, &v32, &v31);
    v4 = v32;
    if (v32 >= 0x10u && !v21)
    {
      *(_BYTE *)(a1 + 72) = 0;
      *(_BYTE *)(a1 + 75) = 0;
      v14 = sub_2198CCEDC(a1);
LABEL_40:
      v23 = v14;
      v22 = (_DWORD)v14 != 13;
      goto LABEL_58;
    }
  }
  v31 = 1;
  *(_WORD *)(a1 + 84) = 0;
  v25 = (unsigned __int16)(v4 + 2);
  if (v25 == 16)
  {
    *(_BYTE *)(a1 + 72) = 1;
    *(_BYTE *)(a1 + 75) = 2;
  }
  v23 = sub_2198CD334(a1, v25);
  if (!(_DWORD)v23)
  {
    v26 = v4 + 3;
    v27 = (unsigned __int16)(v4 + 3);
    if (v27 == 16)
    {
      *(_BYTE *)(a1 + 72) = 1;
      *(_BYTE *)(a1 + 75) = 1;
      *(_WORD *)(a1 + 76) = *(unsigned __int8 *)(a1 + 281);
    }
    v28 = *(unsigned __int8 *)(a1 + (unsigned __int16)(v4 + 2) + 266);
    v23 = sub_2198CD334(a1, v27);
    if (!(_DWORD)v23)
    {
      v29 = *(unsigned __int8 *)(a1 + v26 + 266) | (v28 << 8);
      if (16 * (*(unsigned __int16 *)(a1 + 668) - *(unsigned __int8 *)(a1 + 667)) - v26 + 16 < v29)
      {
LABEL_55:
        v23 = 29;
        goto LABEL_42;
      }
      if (*(_BYTE *)(a1 + 66) == 1)
      {
        *(_WORD *)(a1 + 78) = *(unsigned __int8 *)(a1 + v26 + 266) | (v28 << 8);
        v23 = sub_21988B840(a1, v29);
        *(_WORD *)(a1 + 740) -= 4;
LABEL_57:
        v22 = 1;
LABEL_58:
        *a2 = v22;
        goto LABEL_42;
      }
      *(_WORD *)(a1 + 740) -= (v28 << 8) | *(unsigned __int8 *)(a1 + (unsigned __int16)(v4 + 3) + 1 + 266);
      v32 = v4 + 4;
      v30 = sub_2198CD3E0(a1, &v32, &v31);
      v23 = v30;
      if (v32 >= 0x10u && !(_DWORD)v30)
      {
        *(_BYTE *)(a1 + 72) = 0;
        *(_BYTE *)(a1 + 75) = 0;
        v23 = sub_2198CCEDC(a1);
      }
    }
  }
LABEL_42:
  if (*(unsigned __int16 *)(a1 + 78) <= *(unsigned __int16 *)(a1 + 740))
  {
    if (!*(_WORD *)(a1 + 740))
      v23 = *(unsigned __int8 *)(a1 + 66) != 1;
  }
  else
  {
    v23 = 28;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkTLVs");
  return v23;
}

uint64_t sub_2198CBB5C(uint64_t a1, BOOL *a2)
{
  unsigned __int8 *v4;
  int v5;
  __int16 v6;
  unsigned __int8 v7;
  uint64_t v8;
  __int16 v9;
  int v10;
  int v11;
  unsigned int v12;
  _BYTE *v13;
  uint64_t v14;
  int v15;
  const char *v16;
  _BYTE *v17;
  int v18;
  uint64_t v19;
  int v20;
  __int16 v21;
  __int16 v22;
  unsigned __int8 v23;
  unsigned int v24;
  int v25;
  int v26;
  int v27;
  unsigned __int16 v28;
  unsigned int v29;
  unint64_t v30;
  unint64_t v31;
  uint64x2_t v32;
  uint64_t v33;
  int32x2_t v34;
  char v35;
  char v36;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRdBefWrNdefLen");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProBytesToWr");
  if (*(_WORD *)(a1 + 264) != 16)
  {
    v8 = 20;
    goto LABEL_62;
  }
  phOsalNfc_MemCopy();
  v4 = (unsigned __int8 *)(a1 + 267);
  phOsalNfc_MemCopy();
  v5 = *(unsigned __int8 *)(a1 + 666);
  *(_BYTE *)(a1 + 266) = v5;
  if (v5 != *(unsigned __int8 *)(a1 + 70))
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_UpdRemTLV");
    if (*(unsigned __int16 *)(a1 + 84) < 2u)
    {
      v11 = 16 - *(unsigned __int16 *)(a1 + 68);
      if (v11 == 2)
      {
        v15 = *v4;
        if (v15 == 255)
          LOWORD(v15) = *(unsigned __int8 *)(a1 + 268) | 0xFF00;
        *(_WORD *)(a1 + 76) = v15;
        *(_BYTE *)(a1 + 267) = 3;
        v13 = (_BYTE *)(a1 + 268);
        v7 = 2;
        goto LABEL_24;
      }
      if (v11 == 1)
      {
        v12 = *v4;
        if (v12 == 255)
          v12 = bswap32(*(unsigned __int16 *)(a1 + 268)) >> 16;
        *(_WORD *)(a1 + 76) = v12;
        *(_WORD *)(a1 + 267) = 768;
        v13 = (_BYTE *)(a1 + 269);
        v7 = 3;
        goto LABEL_24;
      }
      v9 = *(unsigned __int8 *)(a1 + 267) | (unsigned __int16)(*(_WORD *)(a1 + 76) << 8);
    }
    else
    {
      v9 = *(unsigned __int8 *)(a1 + 267);
    }
    *(_WORD *)(a1 + 76) = v9;
    v7 = 1;
    v13 = (_BYTE *)(a1 + 267);
LABEL_24:
    *v13 = 0;
    v16 = "phFriNfc_MifStd_H_UpdRemTLV";
    goto LABEL_36;
  }
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_UpdateTLV");
  v6 = *(_WORD *)(a1 + 68);
  v7 = v6 + 1;
  if (*(unsigned __int16 *)(a1 + 84) >= 2u)
  {
    if ((v6 + 1) == 16)
    {
      *(_BYTE *)(a1 + 282) = 3;
      v7 = 16;
LABEL_28:
      v16 = "phFriNfc_MifStd_H_UpdateTLV";
      goto LABEL_36;
    }
    v14 = a1 + 266;
    *(_BYTE *)(a1 + 266 + (v6 + 1)) = 3;
    v7 = v6 + 2;
    goto LABEL_33;
  }
  v10 = 16 - v7;
  if (v10 == 2)
  {
    *(_BYTE *)(a1 + 266 + (v6 + 1)) = 0;
    v17 = (_BYTE *)(a1 + 266 + (v6 + 2));
    v18 = *v17;
    if (v18 == 255)
      LOWORD(v18) = *(unsigned __int8 *)((v6 + 2) + a1 + 267);
    *(_WORD *)(a1 + 76) = v18;
    *v17 = 0;
    v7 = v6 + 3;
    *(_BYTE *)(a1 + (v6 + 3) + 266) = 3;
    goto LABEL_28;
  }
  if (v10 == 1)
  {
    v14 = a1 + 266;
    *(_BYTE *)(a1 + 266 + (v6 + 1)) = 0;
    v7 = v6 + 2;
    v19 = (v6 + 2);
    v20 = *(unsigned __int8 *)(a1 + 266 + v19);
    if (v20 == 255)
      LOWORD(v20) = 0;
    *(_WORD *)(a1 + 76) = v20;
    goto LABEL_34;
  }
  if (v10)
  {
    v14 = a1 + 266;
    v21 = *(unsigned __int8 *)(a1 + 266 + (v6 + 1));
    *(_BYTE *)(v14 + (v6 + 1)) = 0;
    *(_WORD *)(a1 + 76) = v21;
    *(_BYTE *)(v14 + (v6 + 2)) = 0;
    *(_BYTE *)(v14 + (v6 + 3)) = 3;
    v7 = v6 + 4;
LABEL_33:
    v19 = v7;
LABEL_34:
    *(_BYTE *)(v14 + v19) = 0;
    goto LABEL_35;
  }
  *(_BYTE *)(a1 + v7 + 266) = 0;
LABEL_35:
  v16 = "phFriNfc_MifStd_H_UpdateTLV";
LABEL_36:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)v16);
  if (*(_BYTE *)(a1 + 742) == 1)
    v22 = -2;
  else
    v22 = 0;
  *(_WORD *)(a1 + 740) += v22;
  *(_BYTE *)(a1 + 742) = 0;
  *(_BYTE *)a1 = 10;
  if (v7 == 16)
  {
    v8 = sub_2198CA9C0(a1);
  }
  else
  {
    sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillSendBuf");
    v23 = v7 + 1;
    v24 = *(unsigned __int16 *)(a1 + 740);
    v25 = *(unsigned __int16 *)(a1 + 252);
    if (v24 >= (unsigned __int16)(*(_WORD *)(a1 + 248) - v25))
      v24 = *(_DWORD *)(a1 + 248) - v25;
    *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 666);
    v26 = (v7 + 1);
    v27 = 17 - (*(unsigned __int16 *)(a1 + 664) + v23);
    if (v27 <= (unsigned __int16)v24)
      v28 = v27;
    else
      v28 = v24;
    if (*(_WORD *)(a1 + 664))
      phOsalNfc_MemCopy();
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 212) = v28;
    **(_WORD **)(a1 + 528) = v26 + v28 + *(_WORD *)(a1 + 664) - 1;
    v29 = v26 + v28 + *(unsigned __int16 *)(a1 + 664);
    if (v29 <= 0x10)
    {
      v30 = 0;
      v31 = (18 - v29) & 0xFFFFFFFFFFFFFFFELL;
      v32 = (uint64x2_t)vdupq_n_s64(16 - (unint64_t)v29);
      v33 = a1 + v29;
      do
      {
        v34 = vmovn_s64((int64x2_t)vcgeq_u64(v32, (uint64x2_t)vorrq_s8((int8x16_t)vdupq_n_s64(v30), (int8x16_t)xmmword_21990ADE0)));
        if ((v34.i8[0] & 1) != 0)
        {
          if (v30)
            v35 = 0;
          else
            v35 = -2;
          *(_BYTE *)(v33 + v30 + 266) = v35;
        }
        if ((v34.i8[4] & 1) != 0)
        {
          if (v30 == -1)
            v36 = -2;
          else
            v36 = 0;
          *(_BYTE *)(v33 + v30 + 267) = v36;
        }
        v30 += 2;
      }
      while (v31 != v30);
    }
    *(_BYTE *)(a1 + 74) = 1;
    phOsalNfc_MemCopy();
    *(_BYTE *)a1 = 10;
    v8 = sub_2198CA9C0(a1);
    sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillSendBuf");
  }
LABEL_62:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProBytesToWr");
  *a2 = (_DWORD)v8 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRdBefWrNdefLen");
  return v8;
}

uint64_t sub_2198CC0A4(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  int v5;
  uint64_t v6;
  uint64_t v7;
  unsigned int v8;
  unsigned int v9;
  int v10;
  unsigned __int16 v11;
  int v12;
  __int16 v13;
  BOOL v14;
  uint64_t v15;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iWrTlv");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProWrTLV");
  v4 = *(unsigned __int16 *)(a1 + 68);
  if (v4 == 15)
  {
    if (*(_WORD *)(a1 + 84) == 1)
      goto LABEL_10;
  }
  else if (v4 < 0xD || *(_WORD *)(a1 + 84))
  {
    goto LABEL_10;
  }
  v5 = *(unsigned __int8 *)(a1 + 666);
  if (v5 == *(unsigned __int8 *)(a1 + 70))
  {
    v6 = 1;
    *(_BYTE *)(a1 + 676) = 1;
    *(_BYTE *)(a1 + 666) = v5 + 1;
    ++*(_BYTE *)(a1 + 667);
    if (sub_2198C8E80(a1))
      goto LABEL_34;
    if (*(_BYTE *)(a1 + 677))
    {
      v7 = sub_2198C9374(a1);
      goto LABEL_28;
    }
    goto LABEL_27;
  }
LABEL_10:
  *(_BYTE *)(a1 + 676) = 0;
  v8 = *(unsigned __int16 *)(a1 + 252);
  if (*(unsigned __int16 *)(a1 + 248) > v8)
  {
    v9 = **(unsigned __int16 **)(a1 + 528);
    if (v9 <= 0xF)
    {
      *(_WORD *)(a1 + 664) = v9;
      phOsalNfc_MemCopy();
      LOWORD(v8) = *(_WORD *)(a1 + 252);
    }
    v10 = *(unsigned __int16 *)(a1 + 212);
    v11 = v10 + v8;
    *(_WORD *)(a1 + 252) = v10 + v8;
    v12 = *(unsigned __int16 *)(a1 + 740);
    v13 = v12 - v10;
    *(_WORD *)(a1 + 740) = v12 - v10;
    if (v12 == v10 || *(_DWORD *)(a1 + 248) == v11)
    {
      *(_BYTE *)(a1 + 672) = v12 == v10;
      if (*(_WORD *)(a1 + 664))
      {
        v6 = 0;
      }
      else
      {
        ++*(_BYTE *)(a1 + 666);
        v6 = sub_2198C8E80(a1);
        ++*(_BYTE *)(a1 + 667);
        v13 = *(_WORD *)(a1 + 740);
      }
      if (v13)
        v14 = *(_BYTE *)(a1 + 74) == 1;
      else
        v14 = 1;
      *(_BYTE *)(a1 + 74) = v14;
      if ((_DWORD)v6)
        goto LABEL_34;
      goto LABEL_29;
    }
    ++*(_BYTE *)(a1 + 666);
    if (sub_2198C8E80(a1))
    {
      v6 = 1;
      goto LABEL_34;
    }
    ++*(_BYTE *)(a1 + 667);
    if (*(_BYTE *)(a1 + 677) == 1)
    {
      v7 = sub_2198C93F4(a1);
      goto LABEL_28;
    }
LABEL_27:
    v7 = sub_2198C86C0(a1);
LABEL_28:
    v6 = v7;
    if ((_DWORD)v7)
      goto LABEL_34;
  }
LABEL_29:
  if (*(_BYTE *)(a1 + 74) == 1)
  {
    *(_BYTE *)(a1 + 752) = *(_BYTE *)(a1 + 666);
    sub_2198CC4D0(a1);
    *(_BYTE *)(a1 + 666) = *(_BYTE *)(a1 + 70);
    v15 = sub_2198CC550(a1);
  }
  else
  {
    if (!*(_WORD *)(a1 + 740))
    {
      v6 = 0;
      goto LABEL_34;
    }
    v15 = sub_2198CD588(a1);
  }
  v6 = v15;
LABEL_34:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProWrTLV");
  *a2 = (_DWORD)v6 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iWrTlv");
  return v6;
}

uint64_t sub_2198CC338(uint64_t a1, BOOL *a2)
{
  unsigned int v4;
  char v5;
  uint64_t v6;
  char v8;
  char v9;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRdTlv");
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProRdTLV");
  v4 = *(unsigned __int16 *)(a1 + 78);
  if (v4 >= 0xFF)
    v5 = 4;
  else
    v5 = 2;
  v9 = (v5 + *(_BYTE *)(a1 + 68)) & 0xF;
  v6 = 245;
  if (*(_WORD *)(a1 + 264) == 16 && v4 && *(_DWORD *)(a1 + 248) > *(unsigned __int16 *)(a1 + 252))
    v6 = sub_2198C9AAC(a1, &v8, &v9);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProRdTLV");
  *a2 = (_DWORD)v6 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iRdTlv");
  return v6;
}

uint64_t sub_2198CC444(uint64_t a1, BOOL *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iTermTlv");
  sub_2198CC4D0(a1);
  *(_BYTE *)(a1 + 666) = *(_BYTE *)(a1 + 70);
  v4 = sub_2198CC550(a1);
  *a2 = (_DWORD)v4 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iTermTlv");
  return v4;
}

uint64_t sub_2198CC4D0(uint64_t a1)
{
  int v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_SetNdefBlkAuth");
  v2 = sub_2198CCC80((unsigned int *)a1, *(unsigned __int8 *)(a1 + 70));
  *(_BYTE *)(a1 + 71) = v2 != sub_2198CCC80((unsigned int *)a1, *(unsigned __int8 *)(a1 + 666));
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_SetNdefBlkAuth");
}

uint64_t sub_2198CC550(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdtoWrNdefLen");
  *(_BYTE *)a1 = 7;
  if (*(_BYTE *)(a1 + 71) == 1)
  {
    *(_BYTE *)(a1 + 677) = 0;
    v2 = sub_2198C86C0(a1);
  }
  else
  {
    *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 666);
    *(_WORD *)(a1 + 526) = 1;
    *(_WORD *)(a1 + 264) = 260;
    *(_DWORD *)(a1 + 232) = 48;
    v2 = sub_219888630(a1, (uint64_t)sub_2198C8BA0);
  }
  v3 = v2;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdtoWrNdefLen");
  return v3;
}

uint64_t sub_2198CC600(uint64_t a1, BOOL *a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iDisconnect");
  *(_BYTE *)(a1 + 757) = 0;
  v4 = sub_2198CC680(a1);
  *a2 = (_DWORD)v4 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iDisconnect");
  return v4;
}

uint64_t sub_2198CC680(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_CallConnect");
  *(_BYTE *)a1 = 16;
  v2 = sub_219888888(a1, (uint64_t)sub_2198CD61C, *(_QWORD *)(a1 + 224));
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_CallConnect");
  return v2;
}

uint64_t sub_2198CC700(unsigned int *a1, BOOL *a2)
{
  uint64_t v4;

  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iPoll");
  v4 = sub_2198CC680((uint64_t)a1);
  *a2 = (_DWORD)v4 != 13;
  sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iPoll");
  return v4;
}

uint64_t sub_2198CC77C(uint64_t a1, BOOL *a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iConnect");
  if (*(_BYTE *)(a1 + 758) == 1)
  {
    *(_BYTE *)(a1 + 758) = 0;
LABEL_7:
    v4 = sub_2198C86C0(a1);
    goto LABEL_8;
  }
  if ((*(_BYTE *)(a1 + 560) || *(_BYTE *)(a1 + 540) != 3) && !*(_WORD *)(a1 + 754))
    goto LABEL_7;
  v4 = sub_2198CC834(a1);
LABEL_8:
  v5 = v4;
  *a2 = (_DWORD)v4 != 13;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iConnect");
  return v5;
}

uint64_t sub_2198CC834(uint64_t a1)
{
  int v3;
  uint64_t v4;
  unsigned int v5;
  char v6;
  __int16 v7;
  int v8;
  uint64_t v9;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProStatNotValid");
  if (!*(_WORD *)(a1 + 746))
  {
    *(_WORD *)(a1 + 748) = 2;
    v5 = *(unsigned __int8 *)(a1 + 666);
    if ((v5 & 0x80) != 0)
    {
      if (v5 > 0xEF)
        goto LABEL_27;
      v6 = 16;
      v7 = -240;
    }
    else
    {
      if (v5 > 3)
      {
        v8 = *(unsigned __int8 *)(a1 + 544);
        if (v5 <= 0x43)
        {
          if (v8 == 8)
            goto LABEL_27;
          v6 = 4;
          v7 = -48;
          if (v5 >= 0x3C && v8 == 7)
            goto LABEL_27;
          goto LABEL_26;
        }
        if (v8 == 7)
          goto LABEL_27;
      }
      else if (*(unsigned __int8 *)(a1 + 544) - 7 < 2)
      {
        goto LABEL_27;
      }
      v6 = 4;
      v7 = -48;
    }
LABEL_26:
    *(_WORD *)(a1 + 740) += v7;
    *(_BYTE *)(a1 + 666) = v6 + v5;
    if (!sub_2198C8E80(a1))
    {
      v9 = sub_2198C86C0(a1);
      goto LABEL_30;
    }
LABEL_27:
    v4 = 22;
    goto LABEL_28;
  }
  if (*(_WORD *)(a1 + 746) == 1 && *(_WORD *)(a1 + 748) == 2)
    goto LABEL_27;
  *(_WORD *)(a1 + 748) = 1;
  v3 = *(unsigned __int8 *)(a1 + 540);
  v4 = 22;
  if (v3 == 1 || v3 == 4)
    goto LABEL_28;
  if (v3 != 2)
  {
    *(_BYTE *)(a1 + 672) = 1;
    *(_BYTE *)(a1 + 752) = *(_BYTE *)(a1 + 666);
    sub_2198CC4D0(a1);
    *(_BYTE *)(a1 + 666) = *(_BYTE *)(a1 + 70);
    v9 = sub_2198CC550(a1);
LABEL_30:
    v4 = v9;
    goto LABEL_28;
  }
  if (*(_BYTE *)(a1 + 66) == 1 && !*(_BYTE *)(a1 + 75))
  {
    v4 = 0;
    **(_DWORD **)(a1 + 552) = *(unsigned __int16 *)(a1 + 252);
  }
LABEL_28:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ProStatNotValid");
  return v4;
}

uint64_t sub_2198CC9D4(uint64_t a1, BOOL *a2)
{
  int v4;
  uint64_t v5;
  BOOL v6;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iAuthFail");
  *(_BYTE *)(a1 + 757) = 1;
  if (*(_BYTE *)(a1 + 759) == 1)
  {
    *(_BYTE *)(a1 + 759) = 0;
    if (*(_WORD *)(a1 + 746))
      v4 = *(unsigned __int16 *)(a1 + 754);
    else
      v4 = 1;
    *(_WORD *)(a1 + 754) = v4;
    if (!v4)
      goto LABEL_8;
  }
  else if (!*(_WORD *)(a1 + 754))
  {
LABEL_8:
    v5 = 26;
    v6 = 1;
    goto LABEL_9;
  }
  v5 = sub_2198C92E8(a1);
  v6 = (_DWORD)v5 != 13;
LABEL_9:
  *a2 = v6;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifareStd_iAuthFail");
  return v5;
}

uint64_t sub_2198CCA98(uint64_t a1)
{
  uint64_t v2;
  char v4;
  char v5;

  v4 = 0;
  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkIntLen");
  if (*(_WORD *)(a1 + 78))
    v2 = sub_2198CCF68(a1, &v5, &v4);
  else
    v2 = 0;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_ChkIntLen");
  return v2;
}

uint64_t sub_2198CCB20(uint64_t a1)
{
  int v2;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  unsigned __int8 v8;
  int v9;
  unint64_t v10;
  int v11;
  char v12;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillAIDarray");
  v2 = *(unsigned __int8 *)(a1 + 666);
  if (v2 == 64 || v2 == 1)
  {
    v4 = *(unsigned __int8 *)(a1 + 678);
    *(_BYTE *)(a1 + v4 + 697) = 1;
    *(_BYTE *)(a1 + 678) = v4 + 1;
    v5 = 2;
  }
  else
  {
    v5 = 0;
  }
  v6 = v5 + 267;
  do
  {
    if (*(_BYTE *)(a1 + v6 - 1) == 3)
    {
      v7 = *(unsigned __int8 *)(a1 + 678);
      if (*(unsigned __int8 *)(a1 + v6) == 225)
      {
        *(_WORD *)(a1 + 746) = 1;
        *(_BYTE *)(a1 + v7 + 697) = 0;
        v8 = v7 + 1;
        *(_BYTE *)(a1 + 678) = v8;
        goto LABEL_13;
      }
    }
    else
    {
      LODWORD(v7) = *(unsigned __int8 *)(a1 + 678);
    }
    *(_BYTE *)(a1 + v7 + 697) = 1;
    v8 = v7 + 1;
    *(_BYTE *)(a1 + 678) = v8;
    v9 = *(unsigned __int16 *)(a1 + 746);
    *(_WORD *)(a1 + 746) = 0;
    *(_WORD *)(a1 + 744) = v9 == 1;
    if (v9 == 1)
      goto LABEL_15;
LABEL_13:
    v10 = v6 - 267;
    v6 += 2;
  }
  while (v10 < 0xE);
  if (*(_WORD *)(a1 + 744) != 1)
    return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillAIDarray");
LABEL_15:
  v11 = *(unsigned __int8 *)(a1 + 544);
  if (v11 == 8)
  {
    if (v8 <= 0x27u)
    {
      v12 = 39;
LABEL_21:
      memset((void *)(a1 + v8 + 697), 1, (v12 - v8) + 1);
    }
  }
  else if (v11 == 7 && v8 < 0x10u)
  {
    v12 = 15;
    goto LABEL_21;
  }
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_fillAIDarray");
}

uint64_t sub_2198CCC80(unsigned int *a1, unsigned int a2)
{
  unsigned __int8 v4;

  sub_219850718(2, a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_GetSect");
  if ((a2 & 0x80) != 0)
    v4 = ((a2 + 3968) >> 4) + 32;
  else
    v4 = a2 >> 2;
  sub_219850808(2, a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_GetSect");
  return v4;
}

uint64_t sub_2198CCCF4(uint64_t a1, unsigned int a2, _BYTE *a3)
{
  int v6;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd1k_H_BlkChk");
  v6 = *(unsigned __int8 *)(a1 + 666);
  if ((((_BYTE)v6 + 1) & 3) != 0)
  {
    if (*(_BYTE *)(a1 + a2 + 697))
    {
      *(_BYTE *)(a1 + 666) = v6 + 4;
    }
    else
    {
      if (v6 == 4 * a2 && !*(_WORD *)(a1 + 664))
        *(_BYTE *)(a1 + 677) = 0;
      *a3 = 1;
    }
  }
  else
  {
    *(_BYTE *)(a1 + 666) = v6 + 1;
  }
  return sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd1k_H_BlkChk");
}

uint64_t sub_2198CCDA0(uint64_t a1)
{
  int v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdAcsBit");
  *(_BYTE *)a1 = 5;
  v2 = *(char *)(a1 + 666);
  if (*(_BYTE *)(a1 + 679) == 1)
  {
    if (v2 < 0)
      sub_2198CA858(a1);
    else
      sub_2198CA948(a1);
  }
  else
  {
    *(_BYTE *)(a1 + 266) = v2;
  }
  v3 = sub_2198CCE3C(a1, *(_BYTE *)(a1 + 266));
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_RdAcsBit");
  return v3;
}

uint64_t sub_2198CCE3C(uint64_t a1, char a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Rd16Bytes");
  *(_BYTE *)(a1 + 266) = a2;
  *(_WORD *)(a1 + 526) = 1;
  *(_WORD *)(a1 + 264) = 260;
  *(_DWORD *)(a1 + 232) = 48;
  *(_QWORD *)(a1 + 48) = sub_2198C8800;
  *(_QWORD *)(a1 + 56) = a1;
  v4 = sub_219888630(a1, (uint64_t)sub_2198C8BA0);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Rd16Bytes");
  return v4;
}

uint64_t sub_2198CCEDC(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_GetActCardLen");
  *(_BYTE *)a1 = 8;
  *(_BYTE *)(a1 + 540) = 4;
  if (*(_BYTE *)(a1 + 677))
    v2 = sub_2198CCE3C(a1, *(_BYTE *)(a1 + 666));
  else
    v2 = sub_2198C86C0(a1);
  v3 = v2;
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_GetActCardLen");
  return v3;
}

uint64_t sub_2198CCF68(uint64_t a1, _BYTE *a2, _BYTE *a3)
{
  unsigned int v6;
  unsigned int v7;
  unsigned int v8;
  __int16 v10;
  int v11;
  uint64_t v12;
  int v13;
  int v14;
  int v15;
  BOOL v16;
  char v17;
  BOOL v18;
  unsigned int v20;
  int v21;
  int v22;
  uint64_t v23;
  uint64_t v24;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_IntLenWioutNdef");
  if (*(unsigned __int16 *)(a1 + 740) >= (unsigned __int16)(*(_WORD *)(a1 + 248) - *(_WORD *)(a1 + 252)))
    v6 = (unsigned __int16)(*(_WORD *)(a1 + 248) - *(_WORD *)(a1 + 252));
  else
    v6 = *(unsigned __int16 *)(a1 + 740);
  v7 = *(unsigned __int16 *)(a1 + 78);
  v8 = *(unsigned __int16 *)(a1 + 664);
  if (v7 <= v8 && v6 <= v7)
  {
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 252) += v6;
    *(_WORD *)(a1 + 740) -= v6;
    *a3 += v6;
    phOsalNfc_MemCopy();
    v13 = *(unsigned __int16 *)(a1 + 664);
    v14 = *(unsigned __int16 *)(a1 + 78);
    *(_WORD *)(a1 + 78) = v14 - v6;
    v15 = v13 - v6;
    *(_WORD *)(a1 + 664) = v15;
    if (!v15)
    {
      if (*(_WORD *)(a1 + 740))
        v16 = v14 == v6;
      else
        v16 = 1;
      v17 = v16;
      *(_BYTE *)(a1 + 672) = v17;
      ++*(_BYTE *)(a1 + 666);
      ++*(_BYTE *)(a1 + 667);
    }
    if (v14 == v6)
    {
      *(_BYTE *)(a1 + 66) = 1;
      *(_WORD *)(a1 + 72) = 0;
    }
    v12 = 0;
LABEL_24:
    *a2 = 0;
LABEL_25:
    if (*(_WORD *)(a1 + 740))
      v18 = *(_WORD *)(a1 + 78) == 0;
    else
      v18 = 1;
    *(_BYTE *)(a1 + 672) = v18;
    **(_DWORD **)(a1 + 552) = *(unsigned __int16 *)(a1 + 252);
    goto LABEL_29;
  }
  if (v7 <= v8 && v6 > v7)
  {
    phOsalNfc_MemCopy();
    v10 = *(_WORD *)(a1 + 78);
    *(_WORD *)(a1 + 252) += v10;
    *(_WORD *)(a1 + 740) -= v10;
    *(_BYTE *)(a1 + 66) = 1;
    *a3 += v10;
    *a2 = 1;
    *(_WORD *)(a1 + 72) = 0;
    *(_BYTE *)(a1 + 672) = 1;
    v11 = *(unsigned __int16 *)(a1 + 664);
    *(_WORD *)(a1 + 78) = 0;
    if (v11)
    {
      v12 = 0;
      *a2 = 1;
    }
    else
    {
      *(_WORD *)(a1 + 664) = 0;
      *a2 = 0;
      ++*(_BYTE *)(a1 + 666);
      ++*(_BYTE *)(a1 + 667);
      if (sub_2198C8E80(a1))
      {
        v12 = 1;
      }
      else
      {
        if (*(_BYTE *)(a1 + 677) == 1)
          v23 = sub_2198C8FC4(a1);
        else
          v23 = sub_2198C86C0(a1);
        v12 = v23;
      }
    }
    goto LABEL_25;
  }
  if (v7 > v8 && v6 <= v8)
  {
    phOsalNfc_MemCopy();
    *(_WORD *)(a1 + 252) += v6;
    *(_WORD *)(a1 + 740) -= v6;
    *a3 += v6;
    *(_WORD *)(a1 + 78) -= v6;
    phOsalNfc_MemCopy();
    v20 = *(unsigned __int16 *)(a1 + 664) - v6;
    *(_WORD *)(a1 + 664) = v20;
    if (!v20)
    {
      ++*(_BYTE *)(a1 + 666);
      ++*(_BYTE *)(a1 + 667);
    }
    v12 = 0;
    *(_BYTE *)(a1 + 66) = 0;
    goto LABEL_24;
  }
  v12 = 0;
  if (v7 > v8 && v6 > v8)
  {
    phOsalNfc_MemCopy();
    *a2 = 0;
    v21 = *(unsigned __int16 *)(a1 + 664);
    *(_WORD *)(a1 + 252) += v21;
    *(_WORD *)(a1 + 740) -= v21;
    v22 = *(unsigned __int16 *)(a1 + 78) - v21;
    *(_WORD *)(a1 + 78) = v22;
    if (v22)
      *(_BYTE *)(a1 + 66) = 0;
    *(_WORD *)(a1 + 664) = 0;
    ++*(_BYTE *)(a1 + 666);
    ++*(_BYTE *)(a1 + 667);
    if (sub_2198C8E80(a1))
    {
      v12 = 1;
    }
    else
    {
      if (*(_BYTE *)(a1 + 677) == 1)
        v24 = sub_2198C8FC4(a1);
      else
        v24 = sub_2198C86C0(a1);
      v12 = v24;
    }
  }
LABEL_29:
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_IntLenWioutNdef");
  return v12;
}

uint64_t sub_2198CD334(uint64_t a1, int a2)
{
  uint64_t v4;
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Chk16Bytes");
  if (a2 == 16)
  {
    ++*(_BYTE *)(a1 + 666);
    ++*(_BYTE *)(a1 + 667);
    sub_2198C8E80(a1);
    if (*(_BYTE *)(a1 + 677) == 1)
      v4 = sub_2198CCEDC(a1);
    else
      v4 = sub_2198C86C0(a1);
    v5 = v4;
  }
  else
  {
    v5 = 0;
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_Chk16Bytes");
  return v5;
}

uint64_t sub_2198CD3E0(uint64_t a1, unsigned __int16 *a2, _BYTE *a3)
{
  uint64_t v6;
  __int16 v7;
  unsigned __int16 v8;
  __int16 v9;
  uint64_t v10;
  unsigned __int8 v11;
  unsigned __int16 v12;
  unsigned __int8 v13;
  uint64_t v14;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_GetNxtTLV");
  v6 = *a2;
  if (*a3)
  {
    *a3 = 0;
    if (*(_BYTE *)(a1 + 75) == 1)
    {
      v7 = *(_WORD *)(a1 + 76);
      v8 = *a2 + (*(unsigned __int8 *)(a1 + v6 + 266) | (unsigned __int16)(v7 << 8)) + 1;
      *a2 = v8;
      v9 = *(unsigned __int8 *)(a1 + v6 + 266) | (unsigned __int16)(v7 << 8);
    }
    else
    {
      v11 = *(_BYTE *)(a1 + v6 + 265);
      v8 = *a2 + _byteswap_ushort(*(_WORD *)(a1 + v6 + 265)) + 1;
      *a2 = v8;
      v9 = *(unsigned __int8 *)(a1 + v6 + 266) | (v11 << 8);
    }
  }
  else
  {
    v8 = v6 + *(unsigned __int8 *)(a1 + v6 + 266) + 1;
    *a2 = v8;
    if (v8 <= 0xFu)
    {
      v10 = 0;
      *(_WORD *)(a1 + 68) = v8;
      goto LABEL_17;
    }
    v9 = *(unsigned __int8 *)(a1 + v6 + 266);
  }
  v12 = v6 - 15 + v9;
  v13 = v12 & 0xF;
  if ((v8 & 0xFFF0) == 0)
    v13 = v8;
  v8 = v13;
  *(_WORD *)(a1 + 68) = v13;
  if (v12)
  {
    do
    {
      ++*(_BYTE *)(a1 + 666);
      ++*(_BYTE *)(a1 + 667);
      v14 = sub_2198C8E80(a1);
      if (v12 >= 0x11u)
        v12 -= 16;
      else
        v12 = 0;
    }
    while (v12);
    v10 = v14;
    v8 = *(_WORD *)(a1 + 68);
  }
  else
  {
    v10 = 0;
  }
LABEL_17:
  if (!v8)
  {
    ++*(_BYTE *)(a1 + 666);
    ++*(_BYTE *)(a1 + 667);
    v10 = sub_2198C8E80(a1);
  }
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_GetNxtTLV");
  return v10;
}

uint64_t sub_2198CD588(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_WrTermTLV");
  *(_BYTE *)a1 = 12;
  *(_BYTE *)(a1 + 266) = *(_BYTE *)(a1 + 666);
  *(_BYTE *)(a1 + 267) = -2;
  *(_QWORD *)(a1 + 268) = 0;
  *(_QWORD *)(a1 + 275) = 0;
  *(_BYTE *)(a1 + 74) = 0;
  v2 = sub_2198CA9C0(a1);
  sub_219850808(2, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_MifStd_H_WrTermTLV");
  return v2;
}

uint64_t sub_2198CD61C(uint64_t a1, uint64_t a2, uint64_t a3, uint64_t a4, uint64_t a5)
{
  uint64_t v8;

  v8 = a1;
  sub_219850718(0, (unsigned int *)&v8, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_CB_ConnectDisconnect");
  if (a2)
    (*(void (**)(_QWORD, uint64_t, uint64_t))(a2 + 48))(*(_QWORD *)(a2 + 2712), a2, a5);
  return sub_219850808(0, (unsigned int *)&v8, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_CB_ConnectDisconnect");
}

uint64_t sub_2198CD698(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = a1;
  sub_219850718(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_ConvertToReadOnly");
  sub_21988EF68(v10, &v9);
  v5 = 1;
  if (a2)
  {
    v6 = v9;
    if (v9)
    {
      *(_QWORD *)(v9 + 32) = a2;
      *(_QWORD *)(v6 + 40) = a3;
      *(_BYTE *)(v6 + 547) = 6;
      *(_BYTE *)(v6 + 540) = 6;
      *(_BYTE *)(v6 + 753) = 4;
      *(_BYTE *)(v6 + 66) = 0;
      *(_WORD *)(v6 + 676) = 1;
      *(_BYTE *)(v6 + 737) = 0;
      *(_DWORD *)(v6 + 664) = 17039360;
      *(_WORD *)(v6 + 84) = 0;
      *(_WORD *)(v6 + 68) = 0;
      *(_BYTE *)(v6 + 71) = 0;
      *(_WORD *)(v6 + 740) = 16 * *(_WORD *)(v6 + 668);
      *(_WORD *)(v6 + 746) = 0;
      *(_WORD *)(v6 + 754) = 0;
      *(_DWORD *)(v6 + 756) = 0x1000000;
      if (!sub_2198C8E80(v6))
      {
        v7 = v9;
        *(_BYTE *)(v9 + 672) = 0;
        v5 = sub_2198C86C0(v7);
      }
    }
  }
  sub_219850808(0, (unsigned int *)&v10, 8u, 5u, (uint64_t)"phFriNfc_MifareStdMap_ConvertToReadOnly");
  return v5;
}

uint64_t sub_2198CD790(uint64_t a1)
{
  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Reset");
  phOsalNfc_SetMemory();
  phOsalNfc_SetMemory();
  *(_BYTE *)(a1 + 204) = 0;
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Reset");
}

uint64_t sub_2198CD80C(uint64_t a1, int a2)
{
  char v4;
  __int16 v5;
  char v6;
  char v7;
  char v8;
  char v9;
  unsigned int v10;
  char v11;
  char v12;
  uint64_t v13;
  unsigned int v14;
  char v15;
  uint64_t v16;
  uint64_t v17;
  char v18;
  uint64_t v19;
  char v20;
  char v21;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HWrapISONativeCmds");
  **(_BYTE **)(a1 + 96) = -112;
  *(_BYTE *)(*(_QWORD *)(a1 + 96) + 2) = 0;
  *(_BYTE *)(*(_QWORD *)(a1 + 96) + 3) = 0;
  v4 = 96;
  switch(a2)
  {
    case 0:
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = -54;
      if (*(_BYTE *)(a1 + 24) == 1)
        v6 = 14;
      else
        v6 = 5;
      if (*(_BYTE *)(a1 + 24) == 1)
        v7 = 1;
      else
        v7 = 16;
      if (*(_BYTE *)(a1 + 24) == 1)
        v8 = 0;
      else
        v8 = -18;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 4) = v6;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 5) = v7;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 6) = v8;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 7) = v8;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 8) = 15;
      if (*(_BYTE *)(a1 + 24) == 1)
        v9 = 33;
      else
        v9 = 1;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 9) = v9;
      if (*(_BYTE *)(a1 + 24) == 1)
      {
        *(_BYTE *)(*(_QWORD *)(a1 + 96) + 10) = 5;
        *(_BYTE *)(*(_QWORD *)(a1 + 96) + 11) = -31;
        phOsalNfc_MemCopy();
        v10 = 19;
      }
      else
      {
        v10 = 10;
      }
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v10) = 0;
      if (*(_BYTE *)(a1 + 24) == 1)
        v5 = v10 + 1;
      else
        v5 = 11;
      goto LABEL_48;
    case 1:
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = 90;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 4) = 3;
      if (*(_BYTE *)(a1 + 24) == 1)
        v11 = 1;
      else
        v11 = 16;
      if (*(_BYTE *)(a1 + 24) == 1)
        v12 = 0;
      else
        v12 = -18;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 5) = v11;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 6) = v12;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 7) = v12;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 8) = 0;
      v5 = 9;
      goto LABEL_48;
    case 2:
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = -51;
      v13 = *(_QWORD *)(a1 + 96);
      if (*(_BYTE *)(a1 + 24) == 1)
      {
        *(_BYTE *)(v13 + 4) = 9;
        *(_BYTE *)(*(_QWORD *)(a1 + 96) + 5) = 1;
        *(_BYTE *)(*(_QWORD *)(a1 + 96) + 6) = 3;
        v14 = 8;
        v15 = -31;
        v16 = 7;
      }
      else
      {
        *(_BYTE *)(v13 + 4) = 7;
        v14 = 6;
        v15 = 3;
        v16 = 5;
      }
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v16) = v15;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + (v14 | 1)) = -18;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14 + 2) = -18;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14 + 3) = 15;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14 + 4) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14 + 5) = 0;
      goto LABEL_45;
    case 3:
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = -51;
      v17 = *(_QWORD *)(a1 + 96);
      if (*(_BYTE *)(a1 + 24) == 1)
      {
        *(_BYTE *)(v17 + 4) = 9;
        *(_BYTE *)(*(_QWORD *)(a1 + 96) + 5) = 2;
        *(_BYTE *)(*(_QWORD *)(a1 + 96) + 6) = 4;
        v14 = 8;
        v18 = -31;
        v19 = 7;
      }
      else
      {
        *(_BYTE *)(v17 + 4) = 7;
        v14 = 6;
        v18 = 4;
        v19 = 5;
      }
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v19) = v18;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + (v14 | 1)) = -18;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14 + 2) = -18;
      *(_WORD *)(*(_QWORD *)(a1 + 96) + v14 + 3) = *(_DWORD *)(a1 + 208);
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14 + 5) = *(_WORD *)(a1 + 210);
LABEL_45:
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + v14 + 6) = 0;
      if (*(_BYTE *)(a1 + 24) == 1)
        v5 = v14 + 7;
      else
        v5 = 13;
      goto LABEL_48;
    case 4:
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = 61;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 4) = 22;
      if (*(_BYTE *)(a1 + 24) == 1)
        v20 = 1;
      else
        v20 = 3;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 5) = v20;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 6) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 7) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 8) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 9) = 15;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 10) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 11) = 0;
      phOsalNfc_MemCopy();
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 27) = 0;
      v5 = 28;
      goto LABEL_48;
    case 5:
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = 61;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 4) = 9;
      if (*(_BYTE *)(a1 + 24) == 1)
        v21 = 2;
      else
        v21 = 4;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 5) = v21;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 6) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 7) = 0;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 8) = 0;
      *(_WORD *)(*(_QWORD *)(a1 + 96) + 9) = 2;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 11) = 0;
      phOsalNfc_MemCopy();
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 14) = 0;
      v5 = 15;
      goto LABEL_48;
    case 6:
      goto LABEL_3;
    case 7:
    case 8:
      v4 = -81;
LABEL_3:
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = v4;
      *(_BYTE *)(*(_QWORD *)(a1 + 96) + 4) = 0;
      v5 = 5;
LABEL_48:
      *(_WORD *)(a1 + 104) = v5;
      break;
    default:
      return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HWrapISONativeCmds");
  }
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HWrapISONativeCmds");
}

uint64_t sub_2198CDD40(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HGetHWVersion");
  *(_BYTE *)(a1 + 25) = 11;
  sub_2198CD80C(a1, 6);
  v2 = sub_2198CDDC0(a1);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HGetHWVersion");
  return v2;
}

uint64_t sub_2198CDDC0(uint64_t a1)
{
  _BYTE *v2;
  unsigned __int16 *v3;
  uint64_t v4;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HSendTransCmd");
  *(_DWORD *)(a1 + 80) = 0;
  *(_BYTE *)(a1 + 8) &= 0xFCu;
  *(_QWORD *)(a1 + 64) = sub_2198911F8;
  *(_QWORD *)(a1 + 72) = a1;
  v3 = *(unsigned __int16 **)(a1 + 88);
  v2 = *(_BYTE **)(a1 + 96);
  *v3 = 252;
  v4 = sub_2198BB544(*(_QWORD *)a1, (_OWORD *)(a1 + 64), *(_QWORD *)(a1 + 16), *(_DWORD *)(a1 + 80), a1 + 8, v2, *(unsigned __int16 *)(a1 + 104), (uint64_t)v2, v3);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HSendTransCmd");
  return v4;
}

uint64_t sub_2198CDE7C(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HGetUIDDetails");
  if (*(unsigned __int8 *)(**(unsigned __int16 **)(a1 + 88) + *(_QWORD *)(a1 + 96) - 1) == 175)
  {
    *(_BYTE *)(a1 + 25) = 9;
    sub_2198CD80C(a1, 8);
    v2 = sub_2198CDDC0(a1);
  }
  else
  {
    v2 = 13;
  }
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HGetUIDDetails");
  return v2;
}

uint64_t sub_2198CDF14(uint64_t a1)
{
  uint64_t v2;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Format");
  *(_BYTE *)(a1 + 24) = 0;
  v2 = sub_2198CDD40(a1);
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desfire_Format");
  return v2;
}

uint64_t sub_2198CDF84(uint64_t a1)
{
  _BYTE *v2;
  _BYTE *v3;
  uint64_t v4;
  char v5;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HReadOnlyReadCCFile");
  v2 = *(_BYTE **)(a1 + 96);
  v3 = &v2[**(unsigned __int16 **)(a1 + 88)];
  if (*(v3 - 2) == 145 && !*(v3 - 1))
  {
    *(_BYTE *)(a1 + 25) = 103;
    *v2 = -112;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = -67;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 2) = 0;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 3) = 0;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 4) = 7;
    if (*(_BYTE *)(a1 + 24) == 1)
      v5 = 1;
    else
      v5 = 3;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 5) = v5;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 6) = 0;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 7) = 0;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 8) = 0;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 9) = 15;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 10) = 0;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 11) = 0;
    *(_BYTE *)(*(_QWORD *)(a1 + 96) + 12) = 0;
    *(_WORD *)(a1 + 104) = 13;
    v4 = sub_2198CDDC0(a1);
  }
  else
  {
    v4 = 35;
  }
  sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HReadOnlyReadCCFile");
  return v4;
}

uint64_t sub_2198CE0A4(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  unsigned __int8 *v5;
  const char *v6;
  uint64_t v7;
  unsigned int *v8;
  uint64_t v9;
  unsigned __int8 *v10;
  unsigned __int8 *v11;
  unsigned __int8 *v12;
  unsigned __int8 *v13;
  unsigned __int8 *v14;
  uint64_t v15;
  unsigned __int8 *v16;
  int v17;
  int v18;
  BOOL v19;
  int v20;
  uint64_t v21;
  uint64_t v22;
  int v24;
  int v25;
  char v26;

  sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_Process");
  if (!(_BYTE)a2)
  {
    v4 = 245;
    switch(*(_BYTE *)(a1 + 25))
    {
      case 0:
        sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HSelectApp");
        v5 = *(unsigned __int8 **)(a1 + 96);
        if (*v5 == 145 && !v5[1])
        {
          *(_BYTE *)(a1 + 25) = 1;
          sub_2198CD80C(a1, 1);
          a2 = sub_2198CDDC0(a1);
        }
        else
        {
          a2 = 35;
        }
        v6 = "phFriNfc_Desf_HSelectApp";
        goto LABEL_56;
      case 1:
        sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HCreatCCFile");
        v10 = *(unsigned __int8 **)(a1 + 96);
        if (*v10 == 145 && !v10[1])
        {
          *(_BYTE *)(a1 + 25) = 2;
          sub_2198CD80C(a1, 2);
          a2 = sub_2198CDDC0(a1);
        }
        else
        {
          a2 = 35;
        }
        v6 = "phFriNfc_Desf_HCreatCCFile";
        goto LABEL_56;
      case 2:
        sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HCreatNDEFFile");
        v11 = *(unsigned __int8 **)(a1 + 96);
        if (*v11 == 145 && !v11[1])
        {
          *(_BYTE *)(a1 + 25) = 3;
          sub_2198CD80C(a1, 3);
          a2 = sub_2198CDDC0(a1);
        }
        else
        {
          a2 = 35;
        }
        v6 = "phFriNfc_Desf_HCreatNDEFFile";
        goto LABEL_56;
      case 3:
        sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HWrCCBytes");
        v12 = *(unsigned __int8 **)(a1 + 96);
        if (*v12 == 145 && !v12[1])
        {
          *(_BYTE *)(a1 + 25) = 4;
          sub_2198CD80C(a1, 4);
          a2 = sub_2198CDDC0(a1);
        }
        else
        {
          a2 = 35;
        }
        v6 = "phFriNfc_Desf_HWrCCBytes";
        goto LABEL_56;
      case 4:
        sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HWrNDEFData");
        v13 = *(unsigned __int8 **)(a1 + 96);
        if (*v13 == 145 && !v13[1])
        {
          *(_BYTE *)(a1 + 25) = 5;
          sub_2198CD80C(a1, 5);
          a2 = sub_2198CDDC0(a1);
        }
        else
        {
          a2 = 35;
        }
        v6 = "phFriNfc_Desf_HWrNDEFData";
        goto LABEL_56;
      case 5:
        v14 = *(unsigned __int8 **)(a1 + 96);
        if (*v14 != 145 || v14[1])
          break;
        v4 = 0;
        *(_BYTE *)(a1 + 26) = 0;
        if (*(_BYTE *)(a1 + 24) != 1)
          goto LABEL_59;
LABEL_78:
        a2 = sub_2198BB850(*(_QWORD *)a1, (_OWORD *)(a1 + 64), *(_QWORD *)(a1 + 16));
        if ((_DWORD)a2 != 13)
          break;
        *(_BYTE *)(a1 + 25) = 15;
        return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_Process");
      case 6:
      case 7:
      case 8:
      case 0xC:
      case 0xD:
      case 0xE:
        goto LABEL_59;
      case 9:
        sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HCreateApp");
        v15 = *(_QWORD *)(a1 + 96);
        if (*(unsigned __int8 *)(v15 + 14) == 145 && !*(_BYTE *)(v15 + 15))
        {
          *(_BYTE *)(a1 + 25) = 0;
          sub_2198CD80C(a1, 0);
          a2 = sub_2198CDDC0(a1);
        }
        else
        {
          a2 = 35;
        }
        v6 = "phFriNfc_Desf_HCreateApp";
        goto LABEL_56;
      case 0xA:
        sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HUpdateVersionDetails");
        v16 = *(unsigned __int8 **)(a1 + 96);
        if (v16[**(unsigned __int16 **)(a1 + 88) - 1] == 175)
        {
          v17 = v16[3];
          *(_WORD *)(a1 + 212) = v17;
          v18 = v16[4];
          *(_WORD *)(a1 + 214) = v18;
          if (v17)
            v19 = 0;
          else
            v19 = v18 == 6;
          if (v19)
          {
            a2 = 0;
            *(_DWORD *)(a1 + 208) = 3806;
            v20 = 1;
          }
          else
          {
            v20 = 0;
            a2 = 29;
            if (v17 == 1 && v18 == 3)
            {
              a2 = 0;
              v20 = 1;
              *(_BYTE *)(a1 + 24) = 1;
            }
          }
          if (*(_BYTE *)(a1 + 24) == 1)
          {
            v24 = v16[5];
            switch(v24)
            {
              case 22:
                v25 = 2048;
                break;
              case 24:
                v25 = 4096;
                break;
              case 26:
                v25 = 7680;
                break;
              default:
                sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HUpdateVersionDetails");
                v4 = 29;
                goto LABEL_59;
            }
            *(_DWORD *)(a1 + 208) = v25;
          }
          sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HUpdateVersionDetails");
          if (!v20)
            break;
        }
        else
        {
          sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HUpdateVersionDetails");
        }
        v9 = sub_2198CDE7C(a1);
LABEL_85:
        a2 = v9;
        break;
      case 0xB:
        sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HGetSWVersion");
        if (*(unsigned __int8 *)(**(unsigned __int16 **)(a1 + 88) + *(_QWORD *)(a1 + 96) - 1) == 175)
        {
          *(_BYTE *)(a1 + 25) = 10;
          sub_2198CD80C(a1, 7);
          a2 = sub_2198CDDC0(a1);
        }
        else
        {
          a2 = 35;
        }
        v6 = "phFriNfc_Desf_HGetSWVersion";
LABEL_56:
        v8 = (unsigned int *)a1;
LABEL_57:
        sub_219850808(3, v8, 8u, 5u, (uint64_t)v6);
        break;
      case 0xF:
        break;
      default:
        switch(*(_BYTE *)(a1 + 25))
        {
          case 'd':
            v7 = **(unsigned __int16 **)(a1 + 88) + *(_QWORD *)(a1 + 96);
            if (*(unsigned __int8 *)(v7 - 2) == 145 && !*(_BYTE *)(v7 - 1))
              goto LABEL_11;
            sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HReadOnlySelectApp");
            *(_WORD *)(a1 + 24) = 25856;
            sub_2198CD80C(a1, 1);
            a2 = sub_2198CDDC0(a1);
            v8 = (unsigned int *)a1;
            v6 = "phFriNfc_Desf_HReadOnlySelectApp";
            goto LABEL_57;
          case 'e':
LABEL_11:
            v9 = sub_2198CDF84(a1);
            goto LABEL_85;
          case 'g':
            sub_219850718(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_HReadOnlyWriteCCFile");
            v21 = **(unsigned __int16 **)(a1 + 88) + *(_QWORD *)(a1 + 96);
            if (*(unsigned __int8 *)(v21 - 2) == 145 && !*(_BYTE *)(v21 - 1))
            {
              *(_BYTE *)(a1 + 25) = 104;
              phOsalNfc_MemCopy();
              **(_BYTE **)(a1 + 96) = -112;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 1) = 61;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 2) = 0;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 3) = 0;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 4) = 22;
              if (*(_BYTE *)(a1 + 24) == 1)
                v26 = 1;
              else
                v26 = 3;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 5) = v26;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 6) = 0;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 7) = 0;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 8) = 0;
              *(_WORD *)(*(_QWORD *)(a1 + 96) + 9) = 15;
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 11) = 0;
              phOsalNfc_MemCopy();
              *(_BYTE *)(*(_QWORD *)(a1 + 96) + 27) = 0;
              *(_WORD *)(a1 + 104) = 28;
              a2 = sub_2198CDDC0(a1);
            }
            else
            {
              a2 = 35;
            }
            v6 = "phFriNfc_Desf_HReadOnlyWriteCCFile";
            goto LABEL_56;
          case 'h':
            v22 = **(unsigned __int16 **)(a1 + 88) + *(_QWORD *)(a1 + 96);
            if (*(unsigned __int8 *)(v22 - 2) != 145 || *(_BYTE *)(v22 - 1))
            {
              v4 = 35;
              goto LABEL_59;
            }
            if (*(_BYTE *)(a1 + 24) == 1)
              goto LABEL_78;
            goto LABEL_58;
          default:
            goto LABEL_59;
        }
    }
  }
LABEL_58:
  v4 = a2;
  if (a2 != 13)
LABEL_59:
    sub_219890E88(a1, v4);
  return sub_219850808(3, (unsigned int *)a1, 8u, 5u, (uint64_t)"phFriNfc_Desf_Process");
}

uint64_t sub_2198CE7FC(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  __int128 v5;
  __int128 v6;
  __int128 v7;
  uint64_t v8;

  v8 = 0;
  v6 = 0u;
  v7 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendRidCmd");
  v2 = 1;
  if (a1)
  {
    v3 = *(_QWORD *)(a1 + 808);
    phOsalNfc_MemCopy();
    phOsalNfc_SetMemory();
    LODWORD(v5) = 0;
    *(_QWORD *)&v6 = a1 + 1486;
    DWORD2(v6) = 7;
    *(_QWORD *)&v7 = a1 + 2016;
    DWORD2(v7) = 530;
    WORD3(v5) = 500;
    LOBYTE(v8) = 1;
    v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(v3 + 8), (uint64_t)&v5, (uint64_t)sub_219865DD0, a1);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendRidCmd");
  return v2;
}

uint64_t sub_2198CE910(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v6;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessRidResp");
  if (a1 && !(_DWORD)a2)
  {
    if (a3 && *(_QWORD *)a3 && *(_DWORD *)(a3 + 8) == 6)
    {
      v6 = *(_QWORD *)(a1 + 808);
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"RID response received");
      a2 = sub_21988B79C(*(unsigned int **)(a1 + 3040), *(_BYTE **)(v6 + 8 * *(unsigned __int8 *)(a1 + 1481) + 8), *(_BYTE **)a3);
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Invalid parameters (phLibNfc_ProcessRidResp)\n");
      a2 = 255;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessRidResp");
  return a2;
}

uint64_t sub_2198CEA00(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  __int128 v5;
  __int128 v6;
  __int128 v7;
  uint64_t v8;

  v8 = 0;
  v6 = 0u;
  v7 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendRallCmd");
  if (a1)
  {
    if (*(_BYTE *)(a1 + 2885) == 1)
    {
      v2 = 0;
    }
    else
    {
      v3 = *(_QWORD *)(a1 + 808);
      phOsalNfc_SetMemory();
      *(_WORD *)(a1 + 1486) = 0;
      *(_BYTE *)(a1 + 1488) = 0;
      phOsalNfc_MemCopy();
      LODWORD(v5) = 0;
      *(_QWORD *)&v6 = a1 + 1486;
      DWORD2(v6) = 7;
      *(_QWORD *)&v7 = a1 + 2016;
      DWORD2(v7) = 530;
      WORD3(v5) = 500;
      LOBYTE(v8) = 1;
      v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(v3 + 8), (uint64_t)&v5, (uint64_t)sub_219865DD0, a1);
    }
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendRallCmd");
  return v2;
}

uint64_t sub_2198CEB28(uint64_t a1, int a2, uint64_t a3)
{
  uint64_t v6;
  uint64_t v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessRallResp");
  v6 = 255;
  if (a1 && !a2)
  {
    if (a3 && *(_QWORD *)a3 && *(_DWORD *)(a3 + 8) == 122)
    {
      v7 = *(_QWORD *)(a1 + 808);
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"RALL response received");
      v6 = sub_21988B79C(*(unsigned int **)(a1 + 3040), *(_BYTE **)(v7 + 8 * *(unsigned __int8 *)(a1 + 1481) + 8), *(_BYTE **)a3);
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Invalid parameters (phLibNfc_ProcessRallResp)\n");
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_ProcessRallResp");
  return v6;
}

uint64_t sub_2198CEC18(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2PSendCmd");
  if (a1)
    v5 = sub_2198619C0(*(_QWORD *)(a1 + 3040), (uint64_t)sub_219865DD0, a1, a3);
  else
    v5 = 1;
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2PSendCmd");
  return v5;
}

uint64_t sub_2198CEC9C(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_P2PSendResp");
  if (!a1 || (_DWORD)a2)
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"P2P send failed!");
  else
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"P2P send success");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_P2PSendResp");
  return a2;
}

uint64_t sub_2198CED40(uint64_t a1, uint64_t a2)
{
  uint64_t v4;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2PSendComplete");
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pRemoteDev_SendCb");
  if (a1)
  {
    if ((_DWORD)a2)
      v4 = 146;
    else
      v4 = 145;
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v4, a2, 0, 0);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pRemoteDev_SendCb");
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2PSendComplete");
  return a2;
}

uint64_t sub_2198CEDF8(uint64_t a1)
{
  uint64_t v2;
  BOOL v3;
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;

  *(_BYTE *)(a1 + 485) = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IsFirstBuffer");
  v2 = phOsalNfc_Timer_Create();
  if (v2)
    v3 = v2 == 0xFFFFFFFFFFFFLL;
  else
    v3 = 1;
  if (v3)
  {
    v4 = 255;
  }
  else
  {
    v5 = v2;
    v6 = phOsalNfc_Timer_Start();
    if (!(_DWORD)v6)
    {
      sub_21988629C(1, (unsigned int *)(a1 + 19368), v5, 4u, 4u, (uint64_t)"phLibNfc_IsFirstBuffer");
      *(_QWORD *)(a1 + 448) = v5;
      v4 = 13;
      goto LABEL_12;
    }
    v4 = v6;
    phOsalNfc_Timer_Delete();
  }
  if (*(_QWORD *)(a1 + 488))
  {
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 488) = 0;
  }
  *(_DWORD *)(a1 + 496) = 0;
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_IsFirstBuffer");
  return v4;
}

uint64_t sub_2198CEF08(uint64_t a1, uint64_t a2)
{
  char v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  uint64_t v8;
  uint64_t v9;
  uint64_t v11;
  uint64_t v12;

  v11 = 0;
  v12 = 0;
  sub_21988629C(2, (unsigned int *)a2, a1, 4u, 4u, (uint64_t)"phLibNfc_TempReceiveCb");
  sub_219850718(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_TempReceiveCb");
  if (a2)
  {
    v4 = 0;
    v5 = 0;
    do
    {
      v6 = *((_QWORD *)&unk_253E46700 + 14 * v5 + 2);
      if ((v4 & 1) != 0)
        break;
      v4 = 1;
      v5 = 1;
    }
    while (v6 != a2);
    if (v6 == a2)
    {
      v7 = *(_QWORD *)(a2 + 448);
      v8 = 146;
      v9 = 255;
      if (v7 && v7 != 0xFFFFFFFFFFFFLL && v7 == a1)
      {
        phOsalNfc_Timer_Stop();
        phOsalNfc_Timer_Delete();
        *(_QWORD *)(a2 + 448) = 0;
        v11 = *(_QWORD *)(a2 + 488);
        LODWORD(v12) = *(_DWORD *)(a2 + 496);
        v8 = 145;
        sub_2198D1B2C(*(_QWORD *)(a2 + 19360), 145, 0, (uint64_t)&v11, 0);
        if (*(_QWORD *)(a2 + 488))
        {
          phOsalNfc_FreeMemory();
          v9 = 0;
          *(_QWORD *)(a2 + 488) = 0;
          *(_DWORD *)(a2 + 496) = 0;
        }
        else
        {
          v9 = 0;
        }
      }
      sub_2198D1B2C(*(_QWORD *)(a2 + 19360), v8, v9, 0, 0);
    }
  }
  return sub_219850808(2, (unsigned int *)a2, 4u, 5u, (uint64_t)"phLibNfc_TempReceiveCb");
}

uint64_t sub_2198CF084(uint64_t a1, int a2, uint64_t a3)
{
  uint64_t v6;
  unsigned int v7;
  uint64_t v9;
  uint64_t v10;

  v9 = 0;
  v10 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pRemoteDev_ReceiveCb");
  if (a1 && a3)
  {
    if (a2)
    {
      LODWORD(v10) = 0;
      v6 = 145;
      if (a2 != 10 || *(_BYTE *)(a1 + 2885))
        goto LABEL_13;
      v7 = sub_21990201C(*(_QWORD *)(a1 + 3040));
      if (v7 <= 1)
        LOBYTE(a2) = 10;
      else
        LOBYTE(a2) = v7;
    }
    else
    {
      v9 = *(_QWORD *)(a3 + 8);
      LODWORD(v10) = *(_DWORD *)(a3 + 16);
    }
    v6 = 145;
LABEL_13:
    sub_2198D1B2C(*(_QWORD *)(a1 + 19360), v6, a2, (uint64_t)&v9, 0);
    return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pRemoteDev_ReceiveCb");
  }
  if (a1)
  {
    LOBYTE(a2) = -1;
    v6 = 146;
    goto LABEL_13;
  }
  return sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_P2pRemoteDev_ReceiveCb");
}

uint64_t sub_2198CF168(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  __int128 v7;
  __int128 v8;
  __int128 v9;
  uint64_t v10;

  v10 = 0;
  v8 = 0u;
  v9 = 0u;
  v7 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendWrt16Cmd");
  v5 = 1;
  if (a1 && a3 && *(_QWORD *)(a3 + 48) && *(_DWORD *)(a3 + 56) && *(_QWORD *)(a3 + 32) && *(_DWORD *)(a3 + 40))
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)(a1 + 2616) = phOsalNfc_GetMemory();
    phOsalNfc_MemCopy();
    *(_BYTE *)(a1 + 1486) = -96;
    *(_BYTE *)(a1 + 1487) = *(_BYTE *)(a3 + 4);
    *(_QWORD *)&v8 = a1 + 1486;
    DWORD2(v8) = 2;
    LODWORD(v7) = 0;
    *(_QWORD *)&v9 = *(_QWORD *)(a3 + 48);
    DWORD2(v9) = *(unsigned __int16 *)(a3 + 56);
    WORD3(v7) = *(_WORD *)(a3 + 6);
    v5 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), (uint64_t)&v7, (uint64_t)sub_219865DD0, a1);
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendWrt16Cmd");
  return v5;
}

uint64_t sub_2198CF2A8(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_SendWrt16CmdResp");
  if (!a1 || (_DWORD)a2)
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"SendWrt16 Command palyload Header failed!");
  else
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"SendWrt16 Command palyload Header success");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_SendWrt16CmdResp");
  return a2;
}

uint64_t sub_2198CF34C(uint64_t a1)
{
  uint64_t v2;
  uint64_t v3;
  __int128 v5;
  __int128 v6;
  __int128 v7;
  uint64_t v8;

  v8 = 0;
  v6 = 0u;
  v7 = 0u;
  v5 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendWrt16CmdPayload");
  if (a1
    && (v2 = *(_QWORD *)(a1 + 2616)) != 0
    && *(_QWORD *)(v2 + 32)
    && *(_DWORD *)(v2 + 40)
    && *(_QWORD *)(v2 + 48)
    && *(_DWORD *)(v2 + 56))
  {
    phOsalNfc_SetMemory();
    *(_QWORD *)&v6 = *(_QWORD *)(v2 + 32);
    DWORD2(v6) = *(unsigned __int16 *)(v2 + 40);
    LODWORD(v5) = 0;
    *(_QWORD *)&v7 = *(_QWORD *)(v2 + 48);
    DWORD2(v7) = *(unsigned __int16 *)(v2 + 56);
    WORD3(v5) = *(_WORD *)(v2 + 6);
    v3 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), (uint64_t)&v5, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v3 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendWrt16CmdPayload");
  return v3;
}

uint64_t sub_2198CF454(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_Wrt16CmdPayloadResp");
  if (!a1 || (_DWORD)a2)
    sub_219850628(2, a1, 4u, 1u, (uint64_t)"SendWrt16 Command palyload failed!");
  else
    sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"SendWrt16 Command palyload success");
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_Wrt16CmdPayloadResp");
  return a2;
}

uint64_t sub_2198CF4F8(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCWrite16Complete");
  if (a1)
  {
    phOsalNfc_SetMemory();
    v4 = *(_QWORD *)(a1 + 2616);
    if (v4 && *(_QWORD *)(v4 + 32) && *(_DWORD *)(v4 + 56))
    {
      v8 = *(_QWORD *)(v4 + 32);
      LODWORD(v9) = 0;
      v5 = *(_QWORD *)(a1 + 2704);
      if (v5)
      {
        if (*(_QWORD *)(v5 + 48))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(*(_QWORD *)(a1 + 2704) + 48) = 0;
        }
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 2704) = 0;
      }
      v6 = *(_QWORD *)(a1 + 2696);
      if (v6)
      {
        if (*(_QWORD *)(v6 + 32))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(*(_QWORD *)(a1 + 2696) + 32) = 0;
        }
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 2696) = 0;
      }
    }
  }
  else
  {
    phOsalNfc_SetMemory();
  }
  sub_219891854(a1, a2, (uint64_t)&v8);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCWrite16Complete");
  return a2;
}

uint64_t sub_2198CF630(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t Memory;
  char v7;
  __int128 v9;
  __int128 v10;
  __int128 v11;
  uint64_t v12;

  v12 = 0;
  v10 = 0u;
  v11 = 0u;
  v9 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecTrRestoreCmd");
  v5 = 1;
  if (a1
    && a3
    && *(_QWORD *)(a3 + 48)
    && *(_DWORD *)(a3 + 56)
    && (*(_QWORD *)(a3 + 32) || *(_DWORD *)(a3 + 40) || *(_DWORD *)a3 == 194 || *(_DWORD *)a3 == 176))
  {
    *(_QWORD *)(a1 + 2616) = 0;
    Memory = phOsalNfc_GetMemory();
    *(_QWORD *)(a1 + 2616) = Memory;
    if (Memory)
    {
      phOsalNfc_SetMemory();
      phOsalNfc_MemCopy();
      if (*(_DWORD *)a3 == 3)
      {
        *(_BYTE *)(a1 + 1486) = -62;
        v7 = -1;
      }
      else
      {
        *(_BYTE *)(a1 + 1486) = *(_DWORD *)a3;
        v7 = *(_BYTE *)(a3 + 4);
      }
      *(_BYTE *)(a1 + 1487) = v7;
      *(_QWORD *)&v10 = a1 + 1486;
      DWORD2(v10) = 2;
      LODWORD(v9) = 0;
      *(_QWORD *)&v11 = *(_QWORD *)(a3 + 48);
      DWORD2(v11) = *(unsigned __int16 *)(a3 + 56);
      WORD3(v9) = *(_WORD *)(a3 + 6);
      v5 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), (uint64_t)&v9, (uint64_t)sub_219865DD0, a1);
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Failed to allocate memory, Insufficient Resources");
      v5 = 12;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecTrRestoreCmd");
  return v5;
}

uint64_t sub_2198CF7D0(uint64_t a1, int a2, _BYTE **a3)
{
  uint64_t v6;
  char v7;
  uint64_t *v8;
  uint64_t v9;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecRestoreResp");
  v6 = 1;
  if (a1 && a3)
  {
    if (a2 || **a3 != 10)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Inc/Dec Command Header failed!");
      v6 = 255;
    }
    else
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Inc/Dec Command Header success");
      *(_QWORD *)(a1 + 2912) = off_2550A3058;
      *(_BYTE *)(a1 + 2904) = 0;
      *(_BYTE *)(a1 + 2906) = 0;
      v7 = (char)off_2550A3058[0];
      if (off_2550A3058[0])
      {
        v7 = 0;
        v8 = &qword_2550A3068;
        do
        {
          ++v7;
          v9 = *v8;
          v8 += 2;
        }
        while (v9);
      }
      v6 = 0;
      *(_BYTE *)(a1 + 2905) = v7;
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecRestoreResp");
  return v6;
}

uint64_t sub_2198CF8DC(uint64_t a1, uint64_t a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t v6;
  uint64_t v8;
  uint64_t v9;

  v8 = 0;
  v9 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecTrRestoreComplete");
  if (a1 && (v4 = *(_QWORD *)(a1 + 2616)) != 0 && *(_QWORD *)(v4 + 32) && *(_DWORD *)(v4 + 56))
  {
    phOsalNfc_SetMemory();
    v8 = *(_QWORD *)(*(_QWORD *)(a1 + 2616) + 32);
    LODWORD(v9) = 0;
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 2616) = 0;
    v5 = *(_QWORD *)(a1 + 2704);
    if (v5)
    {
      if (*(_QWORD *)(v5 + 48))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 2704) + 48) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2704) = 0;
    }
    v6 = *(_QWORD *)(a1 + 2696);
    if (v6)
    {
      if (*(_QWORD *)(v6 + 32))
      {
        phOsalNfc_FreeMemory();
        *(_QWORD *)(*(_QWORD *)(a1 + 2696) + 32) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2696) = 0;
    }
  }
  else
  {
    a2 = 1;
  }
  sub_219891854(a1, a2, (uint64_t)&v8);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecTrRestoreComplete");
  return a2;
}

uint64_t sub_2198CFA18(uint64_t a1)
{
  uint64_t v2;
  int v3;
  int v4;
  uint64_t v5;
  int v7;
  __int128 v8;
  __int128 v9;
  __int128 v10;
  uint64_t v11;

  v11 = 0;
  v9 = 0u;
  v10 = 0u;
  v8 = 0u;
  v7 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecRestorePayload");
  if (!a1)
    goto LABEL_11;
  v2 = *(_QWORD *)(a1 + 2616);
  if (!v2 || !*(_QWORD *)(v2 + 48) || !*(_DWORD *)(v2 + 56))
    goto LABEL_11;
  phOsalNfc_SetMemory();
  if (*(_DWORD *)v2 != 194)
  {
    if (*(_QWORD *)(v2 + 32))
    {
      v4 = *(_DWORD *)(v2 + 40);
      if (v4)
      {
        *(_QWORD *)&v9 = *(_QWORD *)(v2 + 32);
        v3 = (unsigned __int16)v4;
        goto LABEL_10;
      }
    }
LABEL_11:
    v5 = 1;
    goto LABEL_12;
  }
  *(_QWORD *)&v9 = &v7;
  v3 = 4;
LABEL_10:
  DWORD2(v9) = v3;
  LODWORD(v8) = 0;
  *(_QWORD *)&v10 = *(_QWORD *)(v2 + 48);
  DWORD2(v10) = *(unsigned __int16 *)(v2 + 56);
  WORD3(v8) = *(_WORD *)(v2 + 6);
  v5 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), (uint64_t)&v8, (uint64_t)sub_219865DD0, a1);
LABEL_12:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecRestorePayload");
  return v5;
}

uint64_t sub_2198CFB3C(unsigned int *a1, uint64_t a2)
{
  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecRestore_PayloadResp");
  if (a1)
  {
    if ((_DWORD)a2)
      sub_219850628(2, a1, 4u, 1u, (uint64_t)"Inc/Dec Payload Command palyload Header failed!");
    else
      sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"Inc/Dec Payload Command palyload Header success");
  }
  else
  {
    a2 = 1;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecRestore_PayloadResp");
  return a2;
}

uint64_t sub_2198CFBE8(uint64_t a1, unsigned __int8 a2)
{
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecResPayloadComplete");
  if (!a1)
  {
    phOsalNfc_SetMemory();
    v5 = 1;
    goto LABEL_23;
  }
  phOsalNfc_SetMemory();
  v4 = *(_QWORD *)(a1 + 2616);
  if (a2 != 178)
  {
    if (*(_DWORD *)v4 == 3 && a2 == 44)
      v5 = 0;
    else
      v5 = 255;
LABEL_12:
    if (*(_QWORD *)(v4 + 32) && *(_DWORD *)(v4 + 56))
    {
      v10 = *(_QWORD *)(v4 + 32);
      LODWORD(v11) = 0;
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2616) = 0;
    }
    goto LABEL_15;
  }
  v5 = 0;
  if (v4)
    goto LABEL_12;
LABEL_15:
  v7 = *(_QWORD *)(a1 + 2704);
  if (v7)
  {
    if (*(_QWORD *)(v7 + 48))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(*(_QWORD *)(a1 + 2704) + 48) = 0;
    }
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 2704) = 0;
  }
  v8 = *(_QWORD *)(a1 + 2696);
  if (v8)
  {
    if (*(_QWORD *)(v8 + 32))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(*(_QWORD *)(a1 + 2696) + 32) = 0;
    }
    phOsalNfc_FreeMemory();
    *(_QWORD *)(a1 + 2696) = 0;
  }
LABEL_23:
  sub_219891854(a1, v5, (uint64_t)&v10);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCIncDecResPayloadComplete");
  return v5;
}

uint64_t sub_2198CFD5C(unsigned int *a1, int a2, _BYTE **a3)
{
  uint64_t v6;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MFCTransferResp");
  v6 = 1;
  if (a1 && a3)
  {
    if (a2 || **a3 != 10)
    {
      sub_219850628(1, a1 + 4842, 4u, 1u, (uint64_t)"Transfer/Restore Command Header failed!");
      v6 = 255;
    }
    else
    {
      sub_219850628(1, a1 + 4842, 4u, 4u, (uint64_t)"Transfer/Restore Command Header success");
      v6 = 0;
    }
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MFCTransferResp");
  return v6;
}

uint64_t sub_2198CFE30(uint64_t a1, uint64_t a2, uint64_t a3)
{
  uint64_t v5;
  uint64_t v6;
  uint64_t v7;
  _OWORD v9[3];
  uint64_t v10;

  v10 = 0;
  memset(v9, 0, sizeof(v9));
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendAuthCmd");
  v5 = 1;
  if (a1)
  {
    if (a3)
    {
      v6 = *(_QWORD *)(a1 + 1456);
      if (v6)
      {
        if (sub_219902600(*(unsigned int **)(a1 + 3040), v6))
        {
          *(_QWORD *)(a1 + 1456) = 0;
          *(_QWORD *)(a1 + 1464) = 0;
        }
        *(_QWORD *)(a1 + 2616) = phOsalNfc_GetMemory();
        phOsalNfc_MemCopy();
        v7 = *(_QWORD *)(a1 + 1456);
        if (v7 && *(_QWORD *)(a1 + 2616))
        {
          v5 = sub_2198BF34C(a1, *(_DWORD *)(v7 + 4), a3, (uint64_t)v9);
          if (!(_DWORD)v5)
          {
            v5 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), (uint64_t)v9, (uint64_t)sub_219865DD0, a1);
            if ((_DWORD)v5 == 13)
              *(_BYTE *)(*(_QWORD *)(a1 + 2616) + 4) = BYTE4(v9[0]);
          }
        }
        else
        {
          v5 = 1;
        }
      }
    }
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendAuthCmd");
  return v5;
}

uint64_t sub_2198CFF64(uint64_t a1, uint64_t a2)
{
  _DWORD *v4;
  char v5;
  int *v6;
  int v7;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendAuthCmdResp");
  if (a1)
  {
    v4 = *(_DWORD **)(a1 + 2616);
    if (v4)
    {
      if (((*v4 - 97) & 0xFFFFFFDF) != 0)
        v5 = 0;
      else
        v5 = 0x80;
    }
    else
    {
      v5 = 0;
    }
    if (!(_DWORD)a2)
    {
      sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 4u, (uint64_t)"Authentication command success");
      v6 = *(int **)(a1 + 2616);
      if (v6)
      {
        v7 = *v6;
        if ((*v6 & 0xFFFFFFFE) == 0x80)
        {
          a2 = 0;
          *(_DWORD *)(a1 + 2568) = v7;
          *(_BYTE *)(a1 + 2572) = *((_BYTE *)v6 + 4);
          *(_BYTE *)(a1 + 2573) = *((_BYTE *)v6 + 5) | v5;
          goto LABEL_15;
        }
        *(_DWORD *)(a1 + 2568) = v7;
        *(_BYTE *)(a1 + 2572) = *((_BYTE *)v6 + 4);
        *(_BYTE *)(a1 + 2573) = v5 | 0x10;
        phOsalNfc_MemCopy();
      }
      a2 = 0;
      goto LABEL_15;
    }
    sub_219850628(1, (unsigned int *)(a1 + 19368), 4u, 1u, (uint64_t)"Authentication command failed!");
    sub_2198C07F0(a1);
  }
  else
  {
    a2 = 1;
  }
LABEL_15:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_SendAuthCmdResp");
  return a2;
}

uint64_t sub_2198D00B0(uint64_t a1, char a2)
{
  uint64_t v2;
  uint64_t v4;
  uint64_t v5;
  uint64_t v7;
  uint64_t v8;

  LOBYTE(v2) = a2;
  v7 = 0;
  v8 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCSendAuthCmdComplete");
  if (a1)
  {
    v2 = v2;
    phOsalNfc_SetMemory();
    v4 = *(_QWORD *)(a1 + 2616);
    if (v4)
    {
      if (*(_QWORD *)(v4 + 48))
      {
        v7 = *(_QWORD *)(v4 + 48);
        LODWORD(v8) = 0;
      }
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2616) = 0;
      v5 = *(_QWORD *)(a1 + 2696);
      if (v5)
      {
        if (*(_QWORD *)(v5 + 32))
        {
          phOsalNfc_FreeMemory();
          *(_QWORD *)(*(_QWORD *)(a1 + 2696) + 32) = 0;
        }
        phOsalNfc_FreeMemory();
        *(_QWORD *)(a1 + 2696) = 0;
      }
    }
  }
  else
  {
    phOsalNfc_SetMemory();
    v2 = 1;
  }
  sub_219891854(a1, v2, (uint64_t)&v7);
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MFCSendAuthCmdComplete");
  return v2;
}

uint64_t sub_2198D01C4(uint64_t a1)
{
  uint64_t v2;
  __int128 v4;
  __int128 v5;
  __int128 v6;
  uint64_t v7;

  v7 = 0;
  v5 = 0u;
  v6 = 0u;
  v4 = 0u;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MfcChkPresAuth");
  if (a1 && *(_QWORD *)(a1 + 1456))
  {
    *(_BYTE *)(a1 + 1486) = *(_DWORD *)(a1 + 2568);
    *(_WORD *)(a1 + 1487) = *(_WORD *)(a1 + 2572);
    phOsalNfc_MemCopy();
    phOsalNfc_SetMemory();
    LODWORD(v4) = 4;
    BYTE4(v4) = *(_BYTE *)(a1 + 2572);
    *(_QWORD *)&v5 = a1 + 1486;
    DWORD2(v5) = 9;
    *(_QWORD *)&v6 = a1 + 2016;
    DWORD2(v6) = 530;
    v2 = sub_2198FE2D8(*(_QWORD *)(a1 + 3040), *(_QWORD *)(a1 + 1456), (uint64_t)&v4, (uint64_t)sub_219865DD0, a1);
  }
  else
  {
    v2 = 1;
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MfcChkPresAuth");
  return v2;
}

uint64_t sub_2198D02E0(unsigned int *a1, uint64_t a2)
{
  unsigned int *v4;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MfcChkPresAuthProc");
  if (a1)
  {
    v4 = a1 + 4842;
    if ((_DWORD)a2)
    {
      sub_219850628(1, v4, 4u, 1u, (uint64_t)"Authentication command failed!");
      sub_2198C07F0((uint64_t)a1);
    }
    else
    {
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"Authentication command success");
    }
  }
  else
  {
    a2 = 1;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_MfcChkPresAuthProc");
  return a2;
}

uint64_t sub_2198D0390(uint64_t a1, uint64_t a2)
{
  unsigned int *v4;
  uint64_t *v5;
  uint64_t v6;
  uint64_t *v7;
  uint64_t v8;
  uint64_t v10;
  uint64_t v11;

  v10 = 0;
  v11 = 0;
  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MfcChkPresAuthComplete");
  if (a1)
  {
    if (*(_QWORD *)(a1 + 2616))
    {
      phOsalNfc_FreeMemory();
      *(_QWORD *)(a1 + 2616) = 0;
    }
    v4 = (unsigned int *)(a1 + 19368);
    if ((_DWORD)a2)
    {
      sub_219850628(1, v4, 4u, 2u, (uint64_t)"Mifare classic - Auth failed");
      sub_2198C07F0(a1);
      v5 = &qword_2550A2D08;
      if (*(_BYTE *)(a1 + 1483) == 1)
        v5 = &qword_2550A0E58;
      *(_QWORD *)(a1 + 2912) = v5;
      *(_BYTE *)(a1 + 2904) = 0;
      *(_BYTE *)(a1 + 2906) = 0;
      v6 = *v5;
      if (*v5)
      {
        LOBYTE(v6) = 0;
        v7 = v5 + 2;
        do
        {
          LOBYTE(v6) = v6 + 1;
          v8 = *v7;
          v7 += 2;
        }
        while (v8);
      }
      *(_BYTE *)(a1 + 2905) = v6;
      a2 = sub_2198655FC(a1, 0, 0);
    }
    else
    {
      sub_219850628(1, v4, 4u, 4u, (uint64_t)"Auth command of Mifare classic Success");
      v10 = 0;
      LODWORD(v11) = 0;
      sub_2198C0364(a1, (uint64_t)&v10, 0);
    }
  }
  else
  {
    sub_219850628(2, 0, 4u, 1u, (uint64_t)"Invalid LibNfc Context passed by lower layer");
  }
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MfcChkPresAuthComplete");
  return a2;
}

uint64_t sub_2198D04F0(uint64_t a1, uint64_t a2, uint64_t a3, _QWORD *a4)
{
  uint64_t v8;
  _BYTE *v9;
  int v10;
  unsigned int *v11;
  uint64_t v12;
  uint64_t v13;
  uint64_t v14;
  uint64_t v15;
  int v16;
  uint64_t Memory;
  uint64_t v18;
  uint64_t v19;
  uint64_t v20;
  int v21;

  sub_219850718(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MfcRawtoCmd");
  v8 = 255;
  if (!a1)
    goto LABEL_25;
  if (!a3)
    goto LABEL_25;
  v9 = *(_BYTE **)(a3 + 32);
  if (!v9)
    goto LABEL_25;
  v10 = *(_DWORD *)(a3 + 40);
  if (!v10 || !*(_QWORD *)(a3 + 48) || !a2 || !*(_DWORD *)(a3 + 56))
    goto LABEL_25;
  if (v10 == 18)
  {
    if (*v9 != 160)
      goto LABEL_25;
    *(_QWORD *)(a1 + 2696) = 0;
    v11 = (unsigned int *)(a1 + 19368);
    Memory = phOsalNfc_GetMemory();
    *(_QWORD *)(a1 + 2696) = Memory;
    if (Memory)
    {
      *(_QWORD *)(Memory + 32) = 0;
      v18 = phOsalNfc_GetMemory();
      v19 = *(_QWORD *)(a1 + 2696);
      *(_QWORD *)(v19 + 32) = v18;
      if (v18)
      {
        *(_DWORD *)(v19 + 40) = 16;
        v20 = *(_QWORD *)(a3 + 48);
        *(_QWORD *)(v19 + 48) = v20;
        v21 = *(_DWORD *)(a3 + 56);
        *(_DWORD *)(v19 + 56) = v21;
        v8 = 255;
        if (v20 && v21)
          goto LABEL_22;
        goto LABEL_25;
      }
LABEL_24:
      sub_219850628(1, v11, 4u, 1u, (uint64_t)"Failed to allocate memory, Insufficient Resources");
      v8 = 255;
      goto LABEL_25;
    }
LABEL_23:
    sub_219850628(1, v11, 4u, 1u, (uint64_t)"Failed to allocate memory, Insufficient Resources");
    goto LABEL_25;
  }
  if (v10 != 12)
    goto LABEL_25;
  if ((*v9 & 0xFE) != 0x60)
    goto LABEL_25;
  v11 = (unsigned int *)(a1 + 19368);
  if (phOsalNfc_MemCompare())
    goto LABEL_25;
  *(_QWORD *)(a1 + 2696) = 0;
  v12 = phOsalNfc_GetMemory();
  *(_QWORD *)(a1 + 2696) = v12;
  if (!v12)
    goto LABEL_23;
  *(_QWORD *)(v12 + 32) = 0;
  v13 = phOsalNfc_GetMemory();
  v14 = *(_QWORD *)(a1 + 2696);
  *(_QWORD *)(v14 + 32) = v13;
  if (!v13)
    goto LABEL_24;
  *(_DWORD *)(v14 + 40) = 10;
  v15 = *(_QWORD *)(a3 + 48);
  *(_QWORD *)(v14 + 48) = v15;
  v16 = *(_DWORD *)(a3 + 56);
  *(_DWORD *)(v14 + 56) = v16;
  v8 = 255;
  if (v15 && v16)
  {
LABEL_22:
    phOsalNfc_SetMemory();
    phOsalNfc_SetMemory();
    **(_DWORD **)(a1 + 2696) = **(unsigned __int8 **)(a3 + 32);
    *(_BYTE *)(*(_QWORD *)(a1 + 2696) + 4) = *(_BYTE *)(*(_QWORD *)(a3 + 32) + 1);
    phOsalNfc_MemCopy();
    v8 = 0;
    *a4 = *(_QWORD *)(a1 + 2696);
  }
LABEL_25:
  sub_219850808(2, (unsigned int *)a1, 4u, 5u, (uint64_t)"phLibNfc_MfcRawtoCmd");
  return v8;
}

uint64_t sub_2198D07BC(unsigned int *a1, int *a2, uint64_t a3)
{
  uint64_t v6;
  int v7;
  unsigned __int8 *v8;
  int v9;
  int v10;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ChkMFCAuthWrtCmd");
  v6 = 255;
  if (a2)
  {
    if (a3)
    {
      if (!sub_2198D0904(a1, a3))
      {
        v6 = 0;
        v7 = *a2;
        if (((*a2 - 128) > 0x20 || ((1 << (*(_BYTE *)a2 + 0x80)) & 0x100000003) == 0)
          && (v7 - 96) >= 2)
        {
          if (!v7)
          {
            v8 = (unsigned __int8 *)*((_QWORD *)a2 + 4);
            if (!v8)
            {
LABEL_23:
              v6 = 255;
              goto LABEL_24;
            }
            v9 = *v8;
            v10 = a2[10];
            if (v9 == 160)
            {
              if (v10 != 18)
                goto LABEL_23;
            }
            else if ((v9 & 0xFE) != 0x60 || v10 != 12)
            {
              goto LABEL_23;
            }
            goto LABEL_22;
          }
          if ((v7 & 0xFFFFFFFE) == 0xC0 && *((_QWORD *)a2 + 4) && a2[10] == 4)
          {
LABEL_22:
            v6 = 0;
            goto LABEL_24;
          }
          v6 = 0;
          if (v7 != 3 && v7 != 176 && v7 != 194)
            goto LABEL_23;
        }
      }
    }
  }
LABEL_24:
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ChkMFCAuthWrtCmd");
  return v6;
}

uint64_t sub_2198D0904(unsigned int *a1, uint64_t a2)
{
  uint64_t v4;
  unsigned int v5;
  unsigned int v6;

  sub_219850718(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ChkMfCTag");
  if (!a2
    || *(_DWORD *)(a2 + 20)
    || *(_DWORD *)(a2 + 16) != 128
    || ((v4 = 0, v5 = *(unsigned __int8 *)(a2 + 96), v5 > 0x38) || ((1 << v5) & 0x100010003000302) == 0)
    && ((v6 = v5 - 136, v6 > 0x30) || ((1 << v6) & 0x1000000010001) == 0))
  {
    v4 = 255;
  }
  sub_219850808(2, a1, 4u, 5u, (uint64_t)"phLibNfc_ChkMfCTag");
  return v4;
}

